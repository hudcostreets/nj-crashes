(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[960],{5478:function(a,b,c){!function(b){a.exports=b()}(function(){var a;return(function(){function a(e,f,c){function d(b,j){if(!f[b]){if(!e[b]){var k=void 0;if(!j&&k)return require(b,!0);if(g)return g(b,!0);var i=new Error("Cannot find module '"+b+"'");throw i.code="MODULE_NOT_FOUND",i}var h=f[b]={exports:{}};e[b][0].call(h.exports,function(a){return d(e[b][1][a]||a)},h,h.exports,a,e,f,c)}return f[b].exports}for(var g=void 0,b=0;b<c.length;b++)d(c[b]);return d}return a})()({1:[function(c,f,g){"use strict";var d=c("../src/lib"),a={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var b in a){var e=b.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");d.addStyleRule(e,a[b])}},{"../src/lib":515}],2:[function(a,b,c){"use strict";b.exports=a("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(a,b,c){"use strict";b.exports=a("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(a,b,c){"use strict";b.exports=a("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(a,b,c){"use strict";b.exports=a("../src/traces/box")},{"../src/traces/box":688}],6:[function(a,b,c){"use strict";b.exports=a("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(a,b,c){"use strict";b.exports=a("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(a,b,c){"use strict";b.exports=a("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(a,b,c){"use strict";b.exports=a("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(a,b,c){"use strict";b.exports=a("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(a,b,c){"use strict";b.exports=a("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(a,b,c){"use strict";b.exports=a("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(a,b,c){"use strict";b.exports=a("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(a,b,c){"use strict";b.exports=a("../src/core")},{"../src/core":493}],15:[function(a,b,c){"use strict";b.exports=a("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(a,b,c){"use strict";b.exports=a("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(a,b,c){"use strict";b.exports=a("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(a,b,c){"use strict";b.exports=a("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(a,b,c){"use strict";b.exports=a("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(a,b,c){"use strict";b.exports=a("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(a,b,c){"use strict";b.exports=a("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(a,b,c){"use strict";b.exports=a("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(a,b,c){"use strict";b.exports=a("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(a,b,c){"use strict";b.exports=a("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(a,b,c){"use strict";b.exports=a("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(a,b,c){"use strict";b.exports=a("../src/traces/image")},{"../src/traces/image":861}],27:[function(a,c,d){"use strict";var b=a("./core");b.register([a("./bar"),a("./box"),a("./heatmap"),a("./histogram"),a("./histogram2d"),a("./histogram2dcontour"),a("./contour"),a("./scatterternary"),a("./violin"),a("./funnel"),a("./waterfall"),a("./image"),a("./pie"),a("./sunburst"),a("./treemap"),a("./icicle"),a("./funnelarea"),a("./scatter3d"),a("./surface"),a("./isosurface"),a("./volume"),a("./mesh3d"),a("./cone"),a("./streamtube"),a("./scattergeo"),a("./choropleth"),a("./scattergl"),a("./splom"),a("./pointcloud"),a("./heatmapgl"),a("./parcoords"),a("./parcats"),a("./scattermapbox"),a("./choroplethmapbox"),a("./densitymapbox"),a("./sankey"),a("./indicator"),a("./table"),a("./carpet"),a("./scattercarpet"),a("./contourcarpet"),a("./ohlc"),a("./candlestick"),a("./scatterpolar"),a("./scatterpolargl"),a("./barpolar"),a("./scattersmith"),a("./aggregate"),a("./filter"),a("./groupby"),a("./sort"),a("./calendars"),]),c.exports=b},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(a,b,c){"use strict";b.exports=a("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(a,b,c){"use strict";b.exports=a("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(a,b,c){"use strict";b.exports=a("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(a,b,c){"use strict";b.exports=a("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(a,b,c){"use strict";b.exports=a("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(a,b,c){"use strict";b.exports=a("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(a,b,c){"use strict";b.exports=a("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(a,b,c){"use strict";b.exports=a("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(a,b,c){"use strict";b.exports=a("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(a,b,c){"use strict";b.exports=a("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(a,b,c){"use strict";b.exports=a("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(a,b,c){"use strict";b.exports=a("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(a,b,c){"use strict";b.exports=a("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(a,b,c){"use strict";b.exports=a("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(a,b,c){"use strict";b.exports=a("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(a,b,c){"use strict";b.exports=a("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(a,b,c){"use strict";b.exports=a("../src/traces/table")},{"../src/traces/table":1082}],52:[function(a,b,c){"use strict";b.exports=a("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(a,b,c){"use strict";b.exports=a("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(a,b,c){"use strict";b.exports=a("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(a,b,c){"use strict";b.exports=a("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-array"),b("d3-collection"),b("d3-shape"),b("elementary-circuits-directed-graph")):"function"==typeof a&&a.amd?a(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3,null)}(this,function(a,d,e,f,b){"use strict";function g(a){return a.target.depth}function c(a,b){return a.sourceLinks.length?a.depth:b-1}function h(a){return function(){return a}}b=b&&b.hasOwnProperty("default")?b.default:b;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function j(a,b){return l(a.source,b.source)||a.index-b.index}function k(a,b){return l(a.target,b.target)||a.index-b.index}function l(a,b){return a.partOfCycle===b.partOfCycle?a.y0-b.y0:"top"===a.circularLinkType||"bottom"===b.circularLinkType?-1:1}function m(a){return a.value}function n(a){return(a.y0+a.y1)/2}function o(a){return n(a.source)}function p(a){return n(a.target)}function q(a){return a.index}function r(a){return a.nodes}function s(a){return a.links}function t(c,a){var b=c.get(a);if(!b)throw new Error("missing: "+a);return b}function u(a,b){return b(a)}function v(a,b){var c=0,d=0;a.links.forEach(function(e){e.circular&&(e.source.circularLinkType||e.target.circularLinkType?e.circularLinkType=e.source.circularLinkType?e.source.circularLinkType:e.target.circularLinkType:e.circularLinkType=c<d?"top":"bottom","top"==e.circularLinkType?c+=1:d+=1,a.nodes.forEach(function(a){(u(a,b)==u(e.source,b)||u(a,b)==u(e.target,b))&&(a.circularLinkType=e.circularLinkType)}))}),a.links.forEach(function(a){a.circular&&(a.source.circularLinkType==a.target.circularLinkType&&(a.circularLinkType=a.source.circularLinkType),T(a,b)&&(a.circularLinkType=a.source.circularLinkType))})}function w(a){var b=Math.abs(a.y1-a.y0),c=Math.abs(a.target.x0-a.source.x1);return Math.atan(c/b)}function x(a,b){return!(a.source.column<b.target.column)&&!(a.target.column>b.source.column)}function y(a,d){var b=0;a.sourceLinks.forEach(function(a){b=a.circular&&!T(a,d)?b+1:b});var c=0;return a.targetLinks.forEach(function(a){c=a.circular&&!T(a,d)?c+1:c}),b+c}function z(a){var b=a.source.sourceLinks,c=0;b.forEach(function(a){c=a.circular?c+1:c});var d=a.target.targetLinks,e=0;return d.forEach(function(a){e=a.circular?e+1:e}),!(c>1)&&!(e>1)}function A(a,b,c){return a.sort(D),a.forEach(function(d,g){var e=0;if(T(d,c)&&z(d))d.circularPathData.verticalBuffer=e+d.width/2;else{for(var f=0;f<g;f++)if(x(a[g],a[f])){var h=a[f].circularPathData.verticalBuffer+a[f].width/2+b;e=h>e?h:e}d.circularPathData.verticalBuffer=e+d.width/2}}),a}function B(a,b,e,c){var g=d.min(a.links,function(a){return a.source.y0});a.links.forEach(function(a){a.circular&&(a.circularPathData={})}),A(a.links.filter(function(a){return"top"==a.circularLinkType}),b,c),A(a.links.filter(function(a){return"bottom"==a.circularLinkType}),b,c),a.links.forEach(function(d){if(d.circular){if(d.circularPathData.arcRadius=d.width+10,d.circularPathData.leftNodeBuffer=5,d.circularPathData.rightNodeBuffer=5,d.circularPathData.sourceWidth=d.source.x1-d.source.x0,d.circularPathData.sourceX=d.source.x0+d.circularPathData.sourceWidth,d.circularPathData.targetX=d.target.x0,d.circularPathData.sourceY=d.y0,d.circularPathData.targetY=d.y1,T(d,c)&&z(d))d.circularPathData.leftSmallArcRadius=10+d.width/2,d.circularPathData.leftLargeArcRadius=10+d.width/2,d.circularPathData.rightSmallArcRadius=10+d.width/2,d.circularPathData.rightLargeArcRadius=10+d.width/2,"bottom"==d.circularLinkType?(d.circularPathData.verticalFullExtent=d.source.y1+25+d.circularPathData.verticalBuffer,d.circularPathData.verticalLeftInnerExtent=d.circularPathData.verticalFullExtent-d.circularPathData.leftLargeArcRadius,d.circularPathData.verticalRightInnerExtent=d.circularPathData.verticalFullExtent-d.circularPathData.rightLargeArcRadius):(d.circularPathData.verticalFullExtent=d.source.y0-25-d.circularPathData.verticalBuffer,d.circularPathData.verticalLeftInnerExtent=d.circularPathData.verticalFullExtent+d.circularPathData.leftLargeArcRadius,d.circularPathData.verticalRightInnerExtent=d.circularPathData.verticalFullExtent+d.circularPathData.rightLargeArcRadius);else{var i=d.source.column,l=d.circularLinkType,h=a.links.filter(function(a){return a.source.column==i&&a.circularLinkType==l});"bottom"==d.circularLinkType?h.sort(F):h.sort(E);var j=0;h.forEach(function(a,c){a.circularLinkID==d.circularLinkID&&(d.circularPathData.leftSmallArcRadius=10+d.width/2+j,d.circularPathData.leftLargeArcRadius=10+d.width/2+c*b+j),j+=a.width}),i=d.target.column,h=a.links.filter(function(a){return a.target.column==i&&a.circularLinkType==l}),"bottom"==d.circularLinkType?h.sort(H):h.sort(G),j=0,h.forEach(function(a,c){a.circularLinkID==d.circularLinkID&&(d.circularPathData.rightSmallArcRadius=10+d.width/2+j,d.circularPathData.rightLargeArcRadius=10+d.width/2+c*b+j),j+=a.width}),"bottom"==d.circularLinkType?(d.circularPathData.verticalFullExtent=Math.max(e,d.source.y1,d.target.y1)+25+d.circularPathData.verticalBuffer,d.circularPathData.verticalLeftInnerExtent=d.circularPathData.verticalFullExtent-d.circularPathData.leftLargeArcRadius,d.circularPathData.verticalRightInnerExtent=d.circularPathData.verticalFullExtent-d.circularPathData.rightLargeArcRadius):(d.circularPathData.verticalFullExtent=g-25-d.circularPathData.verticalBuffer,d.circularPathData.verticalLeftInnerExtent=d.circularPathData.verticalFullExtent+d.circularPathData.leftLargeArcRadius,d.circularPathData.verticalRightInnerExtent=d.circularPathData.verticalFullExtent+d.circularPathData.rightLargeArcRadius)}d.circularPathData.leftInnerExtent=d.circularPathData.sourceX+d.circularPathData.leftNodeBuffer,d.circularPathData.rightInnerExtent=d.circularPathData.targetX-d.circularPathData.rightNodeBuffer,d.circularPathData.leftFullExtent=d.circularPathData.sourceX+d.circularPathData.leftLargeArcRadius+d.circularPathData.leftNodeBuffer,d.circularPathData.rightFullExtent=d.circularPathData.targetX-d.circularPathData.rightLargeArcRadius-d.circularPathData.rightNodeBuffer}if(d.circular)d.path=C(d);else{var k=f.linkHorizontal().source(function(a){var b=a.source.x0+(a.source.x1-a.source.x0),c=a.y0;return[b,c]}).target(function(a){var b=a.target.x0,c=a.y1;return[b,c]});d.path=k(d)}})}function C(a){return"top"==a.circularLinkType?"M"+a.circularPathData.sourceX+" "+a.circularPathData.sourceY+" L"+a.circularPathData.leftInnerExtent+" "+a.circularPathData.sourceY+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftSmallArcRadius+" 0 0 0 "+a.circularPathData.leftFullExtent+" "+(a.circularPathData.sourceY-a.circularPathData.leftSmallArcRadius)+" L"+a.circularPathData.leftFullExtent+" "+a.circularPathData.verticalLeftInnerExtent+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftLargeArcRadius+" 0 0 0 "+a.circularPathData.leftInnerExtent+" "+a.circularPathData.verticalFullExtent+" L"+a.circularPathData.rightInnerExtent+" "+a.circularPathData.verticalFullExtent+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightLargeArcRadius+" 0 0 0 "+a.circularPathData.rightFullExtent+" "+a.circularPathData.verticalRightInnerExtent+" L"+a.circularPathData.rightFullExtent+" "+(a.circularPathData.targetY-a.circularPathData.rightSmallArcRadius)+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightSmallArcRadius+" 0 0 0 "+a.circularPathData.rightInnerExtent+" "+a.circularPathData.targetY+" L"+a.circularPathData.targetX+" "+a.circularPathData.targetY:"M"+a.circularPathData.sourceX+" "+a.circularPathData.sourceY+" L"+a.circularPathData.leftInnerExtent+" "+a.circularPathData.sourceY+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftSmallArcRadius+" 0 0 1 "+a.circularPathData.leftFullExtent+" "+(a.circularPathData.sourceY+a.circularPathData.leftSmallArcRadius)+" L"+a.circularPathData.leftFullExtent+" "+a.circularPathData.verticalLeftInnerExtent+" A"+a.circularPathData.leftLargeArcRadius+" "+a.circularPathData.leftLargeArcRadius+" 0 0 1 "+a.circularPathData.leftInnerExtent+" "+a.circularPathData.verticalFullExtent+" L"+a.circularPathData.rightInnerExtent+" "+a.circularPathData.verticalFullExtent+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightLargeArcRadius+" 0 0 1 "+a.circularPathData.rightFullExtent+" "+a.circularPathData.verticalRightInnerExtent+" L"+a.circularPathData.rightFullExtent+" "+(a.circularPathData.targetY+a.circularPathData.rightSmallArcRadius)+" A"+a.circularPathData.rightLargeArcRadius+" "+a.circularPathData.rightSmallArcRadius+" 0 0 1 "+a.circularPathData.rightInnerExtent+" "+a.circularPathData.targetY+" L"+a.circularPathData.targetX+" "+a.circularPathData.targetY}function D(a,b){return I(a)==I(b)?"bottom"==a.circularLinkType?F(a,b):E(a,b):I(b)-I(a)}function E(a,b){return a.y0-b.y0}function F(a,b){return b.y0-a.y0}function G(a,b){return a.y1-b.y1}function H(a,b){return b.y1-a.y1}function I(a){return a.target.column-a.source.column}function J(a){return a.target.x0-a.source.x1}function K(a,c){var d=w(a),b=J(c)/Math.tan(d);return"up"==S(a)?a.y1+b:a.y1-b}function L(a,c){var d=w(a),b=J(c)/Math.tan(d);return"up"==S(a)?a.y1-b:a.y1+b}function M(a,b,c,d){a.links.forEach(function(e){if(!e.circular&&e.target.column-e.source.column>1){var f=e.source.column+1,g=e.target.column-1,h=1,i=g-f+1;for(h=1;f<=g;f++,h++)a.nodes.forEach(function(g){if(g.column==f){var j,k=h/(i+1),o=Math.pow(1-k,3),p=3*k*Math.pow(1-k,2),q=3*Math.pow(k,2)*(1-k),r=Math.pow(k,3),n=o*e.y0+p*e.y0+q*e.y1+r*e.y1,m=n-e.width/2,l=n+e.width/2;m>g.y0&&m<g.y1?(j=g.y1-m+10,j="bottom"==g.circularLinkType?j:-j,g=O(g,j,b,c),a.nodes.forEach(function(a){u(a,d)!=u(g,d)&&a.column==g.column&&N(g,a)&&O(a,j,b,c)})):l>g.y0&&l<g.y1?(j=l-g.y0+10,g=O(g,j,b,c),a.nodes.forEach(function(a){u(a,d)!=u(g,d)&&a.column==g.column&&a.y0<g.y1&&a.y1>g.y1&&O(a,j,b,c)})):m<g.y0&&l>g.y1&&(j=l-g.y0+10,g=O(g,j,b,c),a.nodes.forEach(function(a){u(a,d)!=u(g,d)&&a.column==g.column&&a.y0<g.y1&&a.y1>g.y1&&O(a,j,b,c)}))}})}})}function N(a,b){return a.y0>b.y0&&a.y0<b.y1||a.y1>b.y0&&a.y1<b.y1||a.y0<b.y0&&a.y1>b.y1}function O(a,b,c,d){return a.y0+b>=c&&a.y1+b<=d&&(a.y0=a.y0+b,a.y1=a.y1+b,a.targetLinks.forEach(function(a){a.y1=a.y1+b}),a.sourceLinks.forEach(function(a){a.y0=a.y0+b})),a}function P(a,b,c,d){a.nodes.forEach(function(e){d&&e.y+(e.y1-e.y0)>b&&(e.y=e.y-(e.y+(e.y1-e.y0)-b));var f=a.links.filter(function(a){return u(a.source,c)==u(e,c)}),g=f.length;g>1&&f.sort(function(a,b){if(!a.circular&&!b.circular){if(a.target.column==b.target.column)return a.y1-b.y1;if(!R(a,b))return a.y1-b.y1;if(a.target.column>b.target.column){var c=L(b,a);return a.y1-c}if(b.target.column>a.target.column)return L(a,b)-b.y1}return a.circular&&!b.circular?"top"==a.circularLinkType?-1:1:b.circular&&!a.circular?"top"==b.circularLinkType?1:-1:a.circular&&b.circular?a.circularLinkType===b.circularLinkType&&"top"==a.circularLinkType?a.target.column===b.target.column?a.target.y1-b.target.y1:b.target.column-a.target.column:a.circularLinkType!==b.circularLinkType||"bottom"!=a.circularLinkType?"top"==a.circularLinkType?-1:1:a.target.column===b.target.column?b.target.y1-a.target.y1:a.target.column-b.target.column:void 0});var h=e.y0;f.forEach(function(a){a.y0=h+a.width/2,h+=a.width}),f.forEach(function(a,d){if("bottom"==a.circularLinkType){for(var b=d+1,c=0;b<g;b++)c+=f[b].width;a.y0=e.y1-c-a.width/2}})})}function Q(a,b,c){a.nodes.forEach(function(d){var b=a.links.filter(function(a){return u(a.target,c)==u(d,c)}),e=b.length;e>1&&b.sort(function(a,b){if(!a.circular&&!b.circular){if(a.source.column==b.source.column)return a.y0-b.y0;if(!R(a,b))return a.y0-b.y0;if(b.source.column<a.source.column){var c=K(b,a);return a.y0-c}if(a.source.column<b.source.column)return K(a,b)-b.y0}return a.circular&&!b.circular?"top"==a.circularLinkType?-1:1:b.circular&&!a.circular?"top"==b.circularLinkType?1:-1:a.circular&&b.circular?a.circularLinkType===b.circularLinkType&&"top"==a.circularLinkType?a.source.column===b.source.column?a.source.y1-b.source.y1:a.source.column-b.source.column:a.circularLinkType!==b.circularLinkType||"bottom"!=a.circularLinkType?"top"==a.circularLinkType?-1:1:a.source.column===b.source.column?a.source.y1-b.source.y1:b.source.column-a.source.column:void 0});var f=d.y0;b.forEach(function(a){a.y1=f+a.width/2,f+=a.width}),b.forEach(function(a,g){if("bottom"==a.circularLinkType){for(var c=g+1,f=0;c<e;c++)f+=b[c].width;a.y1=d.y1-f-a.width/2}})})}function R(a,b){return S(a)==S(b)}function S(a){return a.y0-a.y1>0?"up":"down"}function T(a,b){return u(a.source,b)==u(a.target,b)}a.sankeyCircular=function(){var f,g,u=0,w=0,x=1,z=1,A=24,C=q,D=c,E=r,F=s,G=32,H=2,I=null;function a(){var a={nodes:E.apply(null,arguments),links:F.apply(null,arguments)};J(a),function(d,l,k){var m=0;if(null===k){for(var a=[],c=0;c<d.links.length;c++){var j=d.links[c],e=j.source.index,f=j.target.index;a[e]||(a[e]=[]),a[f]||(a[f]=[]),-1===a[e].indexOf(f)&&a[e].push(f)}var h=b(a);h.sort(function(a,b){return a.length-b.length});var i={};for(c=0;c<h.length;c++){var g=h[c].slice(-2);i[g[0]]||(i[g[0]]={}),i[g[0]][g[1]]=!0}d.links.forEach(function(a){var c=a.target.index,b=a.source.index;c===b||i[b]&&i[b][c]?(a.circular=!0,a.circularLinkID=m,m+=1):a.circular=!1})}else d.links.forEach(function(a){a.source[k]<a.target[k]?a.circular=!1:(a.circular=!0,a.circularLinkID=m,m+=1)})}(a,C,I),K(a),L(a),v(a,C),N(a,G,C),O(a);for(var c=0;c<4;c++)P(a,z,C),Q(a,z,C),M(a,w,z,C),P(a,z,C),Q(a,z,C);return function(b,e,f){var a=b.nodes,c=b.links,g=!1,h=!1;if(c.forEach(function(a){"top"==a.circularLinkType?g=!0:"bottom"==a.circularLinkType&&(h=!0)}),!1==g|| !1==h){var i=d.min(a,function(a){return a.y0}),j=(f-e)/(d.max(a,function(a){return a.y1})-i);a.forEach(function(a){var b=(a.y1-a.y0)*j;a.y0=(a.y0-i)*j,a.y1=a.y0+b}),c.forEach(function(a){a.y0=(a.y0-i)*j,a.y1=(a.y1-i)*j,a.width=a.width*j})}}(a,w,z),B(a,H,z,C),a}function J(a){a.nodes.forEach(function(a,b){a.index=b,a.sourceLinks=[],a.targetLinks=[]});var b=e.map(a.nodes,C);return a.links.forEach(function(a,e){a.index=e;var c=a.source,d=a.target;(void 0===c?"undefined":i(c))!=="object"&&(c=a.source=t(b,c)),(void 0===d?"undefined":i(d))!=="object"&&(d=a.target=t(b,d)),c.sourceLinks.push(a),d.targetLinks.push(a)}),a}function K(a){a.nodes.forEach(function(a){a.partOfCycle=!1,a.value=Math.max(d.sum(a.sourceLinks,m),d.sum(a.targetLinks,m)),a.sourceLinks.forEach(function(b){b.circular&&(a.partOfCycle=!0,a.circularLinkType=b.circularLinkType)}),a.targetLinks.forEach(function(b){b.circular&&(a.partOfCycle=!0,a.circularLinkType=b.circularLinkType)})})}function L(d){var a,b,c;for(a=d.nodes,b=[],c=0;a.length;++c,a=b,b=[])a.forEach(function(a){a.depth=c,a.sourceLinks.forEach(function(a){0>b.indexOf(a.target)&&!a.circular&&b.push(a.target)})});for(a=d.nodes,b=[],c=0;a.length;++c,a=b,b=[])a.forEach(function(a){a.height=c,a.targetLinks.forEach(function(a){0>b.indexOf(a.source)&&!a.circular&&b.push(a.source)})});d.nodes.forEach(function(a){a.column=Math.floor(D.call(null,a,c))})}function N(c,h,a){var j=e.nest().key(function(a){return a.column}).sortKeys(d.ascending).entries(c.nodes).map(function(a){return a.values});(function(E){if(g){var v=1/0;j.forEach(function(b){var a=z*g/(b.length+1);v=a<v?a:v}),f=v}var l,b,e,h,i,B,r=d.min(j,function(a){return(z-w-(a.length-1)*f)/d.sum(a,m)});r*=.3,c.links.forEach(function(a){a.width=a.value*r});var n,a,C,o,p,s,t,q,k,D=(l=c,b=0,e=0,h=0,i=0,B=d.max(l.nodes,function(a){return a.column}),l.links.forEach(function(a){a.circular&&("top"==a.circularLinkType?b+=a.width:e+=a.width,0==a.target.column&&(i+=a.width),a.source.column==B&&(h+=a.width))}),{top:b=b>0?b+25+10:b,bottom:e=e>0?e+25+10:e,left:i=i>0?i+25+10:i,right:h=h>0?h+25+10:h});r*=(n=c,a=D,C=d.max(n.nodes,function(a){return a.column}),o=x-u,p=z-w,s=o+a.right+a.left,t=p+a.top+a.bottom,q=o/s,k=p/t,u=u*q+a.left,x=0==a.right?x:x*q,w=w*k+a.top,z*=k,n.nodes.forEach(function(a){a.x0=u+a.column*((x-u-A)/C),a.x1=a.x0+A}),k),c.links.forEach(function(a){a.width=a.value*r}),j.forEach(function(a){var b=a.length;a.forEach(function(a,c){a.depth==j.length-1&&1==b?(a.y0=z/2-a.value*r,a.y1=a.y0+a.value*r):0==a.depth&&1==b?(a.y0=z/2-a.value*r,a.y1=a.y0+a.value*r):a.partOfCycle?0==y(a,E)?(a.y0=z/2+c,a.y1=a.y0+a.value*r):"top"==a.circularLinkType?(a.y0=w+c,a.y1=a.y0+a.value*r):(a.y0=z-a.value*r-c,a.y1=a.y0+a.value*r):0==D.top||0==D.bottom?(a.y0=(z-w)/b*c,a.y1=a.y0+a.value*r):(a.y0=(z-w)/2-b/2+c,a.y1=a.y0+a.value*r)})})})(a),q();for(var i=1,b=h;b>0;--b)k(i*=.99,a),q();function k(a,b){var c=j.length;j.forEach(function(e){var f=e.length,g=e[0].depth;e.forEach(function(e){var h;if(e.sourceLinks.length||e.targetLinks.length)if(e.partOfCycle&&y(e,b)>0);else if(0==g&&1==f)h=e.y1-e.y0,e.y0=z/2-h/2,e.y1=z/2+h/2;else if(g==c-1&&1==f)h=e.y1-e.y0,e.y0=z/2-h/2,e.y1=z/2+h/2;else{var i=d.mean(e.sourceLinks,p),j=d.mean(e.targetLinks,o),k=((i&&j?(i+j)/2:i||j)-n(e))*a;e.y0+=k,e.y1+=k}})})}function q(){j.forEach(function(e){var a,b,c,d=w,g=e.length;for(e.sort(l),c=0;c<g;++c)(b=d-(a=e[c]).y0)>0&&(a.y0+=b,a.y1+=b),d=a.y1+f;if((b=d-f-z)>0)for(d=a.y0-=b,a.y1-=b,c=g-2;c>=0;--c)(b=(a=e[c]).y1+f-d)>0&&(a.y0-=b,a.y1-=b),d=a.y0})}}function O(a){a.nodes.forEach(function(a){a.sourceLinks.sort(k),a.targetLinks.sort(j)}),a.nodes.forEach(function(a){var b=a.y0,d=b,c=a.y1,e=c;a.sourceLinks.forEach(function(a){a.circular?(a.y0=c-a.width/2,c-=a.width):(a.y0=b+a.width/2,b+=a.width)}),a.targetLinks.forEach(function(a){a.circular?(a.y1=e-a.width/2,e-=a.width):(a.y1=d+a.width/2,d+=a.width)})})}return a.nodeId=function(b){return arguments.length?(C="function"==typeof b?b:h(b),a):C},a.nodeAlign=function(b){return arguments.length?(D="function"==typeof b?b:h(b),a):D},a.nodeWidth=function(b){return arguments.length?(A=+b,a):A},a.nodePadding=function(b){return arguments.length?(f=+b,a):f},a.nodes=function(b){return arguments.length?(E="function"==typeof b?b:h(b),a):E},a.links=function(b){return arguments.length?(F="function"==typeof b?b:h(b),a):F},a.size=function(b){return arguments.length?(u=w=0,x=+b[0],z=+b[1],a):[x-u,z-w]},a.extent=function(b){return arguments.length?(u=+b[0][0],x=+b[1][0],w=+b[0][1],z=+b[1][1],a):[[u,w],[x,z]]},a.iterations=function(b){return arguments.length?(G=+b,a):G},a.circularLinkGap=function(b){return arguments.length?(H=+b,a):H},a.nodePaddingRatio=function(b){return arguments.length?(g=+b,a):g},a.sortNodes=function(b){return arguments.length?(I=b,a):I},a.update=function(a){return v(a,C),O(a),a.links.forEach(function(a){a.circular&&(a.circularLinkType=a.y0+a.y1<z?"top":"bottom",a.source.circularLinkType=a.circularLinkType,a.target.circularLinkType=a.circularLinkType)}),P(a,z,C,!1),Q(a,z,C),B(a,H,z,C),a},a},a.sankeyCenter=function(a){return a.targetLinks.length?a.depth:a.sourceLinks.length?d.min(a.sourceLinks,g)-1:0},a.sankeyLeft=function(a){return a.depth},a.sankeyRight=function(a,b){return b-1-a.height},a.sankeyJustify=c,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-array"),b("d3-collection"),b("d3-shape")):"function"==typeof a&&a.amd?a(["exports","d3-array","d3-collection","d3-shape"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3)}(this,function(a,c,d,e){"use strict";function f(a){return a.target.depth}function b(a,b){return a.sourceLinks.length?a.depth:b-1}function g(a){return function(){return a}}function h(a,b){return j(a.source,b.source)||a.index-b.index}function i(a,b){return j(a.target,b.target)||a.index-b.index}function j(a,b){return a.y0-b.y0}function k(a){return a.value}function l(a){return(a.y0+a.y1)/2}function m(a){return l(a.source)*a.value}function n(a){return l(a.target)*a.value}function o(a){return a.index}function p(a){return a.nodes}function q(a){return a.links}function r(c,a){var b=c.get(a);if(!b)throw new Error("missing: "+a);return b}function s(a){return[a.source.x1,a.y0]}function t(a){return[a.target.x0,a.y1]}a.sankey=function(){var e=0,f=0,s=1,t=1,u=24,v=8,w=o,x=b,y=p,z=q,A=32,B=2/3;function a(){var a={nodes:y.apply(null,arguments),links:z.apply(null,arguments)};return C(a),D(a),E(a),F(a,A),G(a),a}function C(a){a.nodes.forEach(function(a,b){a.index=b,a.sourceLinks=[],a.targetLinks=[]});var b=d.map(a.nodes,w);a.links.forEach(function(a,e){a.index=e;var c=a.source,d=a.target;"object"!=typeof c&&(c=a.source=r(b,c)),"object"!=typeof d&&(d=a.target=r(b,d)),c.sourceLinks.push(a),d.targetLinks.push(a)})}function D(a){a.nodes.forEach(function(a){a.value=Math.max(c.sum(a.sourceLinks,k),c.sum(a.targetLinks,k))})}function E(a){for(c=a.nodes,d=[],b=0;c.length;++b,c=d,d=[])c.forEach(function(a){a.depth=b,a.sourceLinks.forEach(function(a){0>d.indexOf(a.target)&&d.push(a.target)})});for(c=a.nodes,d=[],b=0;c.length;++b,c=d,d=[])c.forEach(function(a){a.height=b,a.targetLinks.forEach(function(a){0>d.indexOf(a.source)&&d.push(a.source)})});var c,d,b,f=(s-e-u)/(b-1);a.nodes.forEach(function(a){a.x1=(a.x0=e+Math.max(0,Math.min(b-1,Math.floor(x.call(null,a,b))))*f)+u})}function F(b){var e,i,a=d.nest().key(function(a){return a.x0}).sortKeys(c.ascending).entries(b.nodes).map(function(a){return a.values});v>(e=B*(t-f)/(c.max(a,function(a){return a.length})-1))&&(v=e),i=c.min(a,function(a){return(t-f-(a.length-1)*v)/c.sum(a,k)}),a.forEach(function(a){a.forEach(function(a,b){a.y1=(a.y0=b)+a.value*i})}),b.links.forEach(function(a){a.width=a.value*i}),q();for(var g=1,h=A;h>0;--h)p(g*=.99),q(),o(g),q();function o(b){a.forEach(function(a){a.forEach(function(a){if(a.targetLinks.length){var d=(c.sum(a.targetLinks,m)/c.sum(a.targetLinks,k)-l(a))*b;a.y0+=d,a.y1+=d}})})}function p(b){a.slice().reverse().forEach(function(a){a.forEach(function(a){if(a.sourceLinks.length){var d=(c.sum(a.sourceLinks,n)/c.sum(a.sourceLinks,k)-l(a))*b;a.y0+=d,a.y1+=d}})})}function q(){a.forEach(function(e){var a,b,c,d=f,g=e.length;for(e.sort(j),c=0;c<g;++c)(b=d-(a=e[c]).y0)>0&&(a.y0+=b,a.y1+=b),d=a.y1+v;if((b=d-v-t)>0)for(d=a.y0-=b,a.y1-=b,c=g-2;c>=0;--c)(b=(a=e[c]).y1+v-d)>0&&(a.y0-=b,a.y1-=b),d=a.y0})}}function G(a){a.nodes.forEach(function(a){a.sourceLinks.sort(i),a.targetLinks.sort(h)}),a.nodes.forEach(function(a){var b=a.y0,c=b;a.sourceLinks.forEach(function(a){a.y0=b+a.width/2,b+=a.width}),a.targetLinks.forEach(function(a){a.y1=c+a.width/2,c+=a.width})})}return a.update=function(a){return G(a),a},a.nodeId=function(b){return arguments.length?(w="function"==typeof b?b:g(b),a):w},a.nodeAlign=function(b){return arguments.length?(x="function"==typeof b?b:g(b),a):x},a.nodeWidth=function(b){return arguments.length?(u=+b,a):u},a.nodePadding=function(b){return arguments.length?(v=+b,a):v},a.nodes=function(b){return arguments.length?(y="function"==typeof b?b:g(b),a):y},a.links=function(b){return arguments.length?(z="function"==typeof b?b:g(b),a):z},a.size=function(b){return arguments.length?(e=f=0,s=+b[0],t=+b[1],a):[s-e,t-f]},a.extent=function(b){return arguments.length?(e=+b[0][0],s=+b[1][0],f=+b[0][1],t=+b[1][1],a):[[e,f],[s,t]]},a.iterations=function(b){return arguments.length?(A=+b,a):A},a},a.sankeyCenter=function(a){return a.targetLinks.length?a.depth:a.sourceLinks.length?c.min(a.sourceLinks,f)-1:0},a.sankeyLeft=function(a){return a.depth},a.sankeyRight=function(a,b){return b-1-a.height},a.sankeyJustify=b,a.sankeyLinkHorizontal=function(){return e.linkHorizontal().source(s).target(t)},Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(b,c,d){(function(){var b={version:"3.8.0"},an=[].slice,s=function(a){return an.call(a)},h=self.document;function ao(a){return a&&(a.ownerDocument||a.document||a).documentElement}function ap(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}if(h)try{s(h.documentElement.childNodes)[0].nodeType}catch(aq){s=function(b){for(var a=b.length,c=new Array(a);a--;)c[a]=b[a];return c}}if(Date.now||(Date.now=function(){return+new Date}),h)try{h.createElement("DIV").style.setProperty("opacity",0,"")}catch(ar){var i=this.Element.prototype,as=i.setAttribute,at=i.setAttributeNS,t=this.CSSStyleDeclaration.prototype,au=t.setProperty;i.setAttribute=function(a,b){as.call(this,a,b+"")},i.setAttributeNS=function(a,b,c){at.call(this,a,b,c+"")},t.setProperty=function(a,b,c){au.call(this,a,b+"",c)}}function u(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function av(a){return null===a?NaN:+a}function aw(a){return!isNaN(a)}function I(a){return{left:function(e,f,b,c){for(arguments.length<3&&(b=0),arguments.length<4&&(c=e.length);b<c;){var d=b+c>>>1;0>a(e[d],f)?b=d+1:c=d}return b},right:function(e,f,b,c){for(arguments.length<3&&(b=0),arguments.length<4&&(c=e.length);b<c;){var d=b+c>>>1;a(e[d],f)>0?c=d:b=d+1}return b}}}b.ascending=u,b.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},b.min=function(c,f){var d,a,b=-1,e=c.length;if(1===arguments.length){for(;++b<e;)if(null!=(a=c[b])&&a>=a){d=a;break}for(;++b<e;)null!=(a=c[b])&&d>a&&(d=a)}else{for(;++b<e;)if(null!=(a=f.call(c,c[b],b))&&a>=a){d=a;break}for(;++b<e;)null!=(a=f.call(c,c[b],b))&&d>a&&(d=a)}return d},b.max=function(c,f){var d,a,b=-1,e=c.length;if(1===arguments.length){for(;++b<e;)if(null!=(a=c[b])&&a>=a){d=a;break}for(;++b<e;)null!=(a=c[b])&&a>d&&(d=a)}else{for(;++b<e;)if(null!=(a=f.call(c,c[b],b))&&a>=a){d=a;break}for(;++b<e;)null!=(a=f.call(c,c[b],b))&&a>d&&(d=a)}return d},b.extent=function(c,g){var d,a,e,b=-1,f=c.length;if(1===arguments.length){for(;++b<f;)if(null!=(a=c[b])&&a>=a){d=e=a;break}for(;++b<f;)null!=(a=c[b])&&(d>a&&(d=a),e<a&&(e=a))}else{for(;++b<f;)if(null!=(a=g.call(c,c[b],b))&&a>=a){d=e=a;break}for(;++b<f;)null!=(a=g.call(c,c[b],b))&&(d>a&&(d=a),e<a&&(e=a))}return[d,e]},b.sum=function(b,f){var c,d=0,e=b.length,a=-1;if(1===arguments.length)for(;++a<e;)aw(c=+b[a])&&(d+=c);else for(;++a<e;)aw(c=+f.call(b,b[a],a))&&(d+=c);return d},b.mean=function(b,g){var c,e=0,f=b.length,a=-1,d=f;if(1===arguments.length)for(;++a<f;)aw(c=av(b[a]))?e+=c:--d;else for(;++a<f;)aw(c=av(g.call(b,b[a],a)))?e+=c:--d;if(d)return e/d},b.quantile=function(a,f){var d=(a.length-1)*f+1,b=Math.floor(d),c=+a[b-1],e=d-b;return e?c+e*(a[b]-c):c},b.median=function(c,g){var d,e=[],f=c.length,a=-1;if(1===arguments.length)for(;++a<f;)aw(d=av(c[a]))&&e.push(d);else for(;++a<f;)aw(d=av(g.call(c,c[a],a)))&&e.push(d);if(e.length)return b.quantile(e.sort(u),.5)},b.variance=function(d,i){var a,e,h=d.length,b=0,g=0,c=-1,f=0;if(1===arguments.length)for(;++c<h;)aw(a=av(d[c]))&&(b+=(e=a-b)/ ++f,g+=e*(a-b));else for(;++c<h;)aw(a=av(i.call(d,d[c],c)))&&(b+=(e=a-b)/ ++f,g+=e*(a-b));if(f>1)return g/(f-1)},b.deviation=function(){var a=b.variance.apply(this,arguments);return a?Math.sqrt(a):a};var v=I(u);function ax(a){return a.length}b.bisectLeft=v.left,b.bisect=b.bisectRight=v.right,b.bisector=function(a){return I(1===a.length?function(b,c){return u(a(b),c)}:a)},b.shuffle=function(a,b,e){(c=arguments.length)<3&&(e=a.length,c<2&&(b=0));for(var f,d,c=e-b;c;)d=Math.random()*c--|0,f=a[c+b],a[c+b]=a[d+b],a[d+b]=f;return a},b.permute=function(d,b){for(var a=b.length,c=new Array(a);a--;)c[a]=d[b[a]];return c},b.pairs=function(a){for(var b=0,c=a.length-1,d=a[0],e=new Array(c<0?0:c);b<c;)e[b]=[d,d=a[++b]];return e},b.transpose=function(a){if(!(g=a.length))return[];for(var c=-1,e=b.min(a,ax),f=new Array(e);++c<e;)for(var g,d=-1,h=f[c]=new Array(g);++d<g;)h[d]=a[d][c];return f},b.zip=function(){return b.transpose(arguments)},b.keys=function(b){var a=[];for(var c in b)a.push(c);return a},b.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},b.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},b.merge=function(a){for(var b,c,f,d=a.length,g=-1,e=0;++g<d;)e+=a[g].length;for(c=new Array(e);--d>=0;)for(b=(f=a[d]).length;--b>=0;)c[--e]=f[b];return c};var ay=Math.abs;function w(c,a){for(var b in a)Object.defineProperty(c.prototype,b,{value:a[b],enumerable:!1})}function J(){this._=Object.create(null)}function az(a){return"__proto__"==(a+="")||"\0"===a[0]?"\0"+a:a}function aA(a){return"\0"===(a+="")[0]?a.slice(1):a}function x(a){return az(a) in this._}function y(a){return(a=az(a))in this._&&delete this._[a]}function z(){var a=[];for(var b in this._)a.push(aA(b));return a}function A(){var a=0;for(var b in this._)++a;return a}function B(){for(var a in this._)return!1;return!0}function K(){this._=Object.create(null)}function j(a){return a}function aB(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function L(c,a){if(a in c)return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var b=0,e=aC.length;b<e;++b){var d=aC[b]+a;if(d in c)return d}}b.range=function(a,c,b){if(arguments.length<3&&(b=1,arguments.length<2&&(c=a,a=0)),(c-a)/b==1/0)throw new Error("infinite range");var e,f=[],d=function c(b){for(var a=1;b*a%1;)a*=10;return a}(ay(b)),g=-1;if(a*=d,c*=d,(b*=d)<0)for(;(e=a+b* ++g)>c;)f.push(e/d);else for(;(e=a+b* ++g)<c;)f.push(e/d);return f},b.map=function(a,g){var c=new J;if(a instanceof J)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,b=-1,e=a.length;if(1===arguments.length)for(;++b<e;)c.set(b,a[b]);else for(;++b<e;)c.set(g.call(a,d=a[b],b),d)}else for(var f in a)c.set(f,a[f]);return c},w(J,{has:x,get:function(a){return this._[az(a)]},set:function(a,b){return this._[az(a)]=b},remove:y,keys:z,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:aA(b),value:this._[b]});return a},size:A,empty:B,forEach:function(b){for(var a in this._)b.call(this,aA(a),this._[a])}}),b.nest=function(){var c,d,a={},e=[],f=[];function g(j,f,k){if(k>=e.length)return d?d.call(a,f):c?f.sort(c):f;for(var l,b,h,m,n=-1,o=f.length,p=e[k++],i=new J;++n<o;)(m=i.get(l=p(b=f[n])))?m.push(b):i.set(l,[b]);return j?(b=j(),h=function(a,c){b.set(a,g(j,c,k))}):(b={},h=function(a,c){b[a]=g(j,c,k)}),i.forEach(h),b}function h(a,b){if(b>=e.length)return a;var c=[],d=f[b++];return a.forEach(function(a,d){c.push({key:a,values:h(d,b)})}),d?c.sort(function(a,b){return d(a.key,b.key)}):c}return a.map=function(a,b){return g(b,a,0)},a.entries=function(a){return h(g(b.map,a,0),0)},a.key=function(b){return e.push(b),a},a.sortKeys=function(b){return f[e.length-1]=b,a},a.sortValues=function(b){return c=b,a},a.rollup=function(b){return d=b,a},a},b.set=function(a){var c=new K;if(a)for(var b=0,d=a.length;b<d;++b)c.add(a[b]);return c},w(K,{has:x,add:function(a){return this._[az(a+="")]=!0,a},remove:y,values:z,size:A,empty:B,forEach:function(a){for(var b in this._)a.call(this,aA(b))}}),b.behavior={},b.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=aB(a,b,b[c]);return a};var aC=["webkit","ms","moz","Moz","o","O"];function aD(){}function M(){}function aE(b){var c=[],d=new J;function a(){for(var a,d=c,e=-1,f=d.length;++e<f;)(a=d[e].on)&&a.apply(this,arguments);return b}return a.on=function(e,f){var g,a=d.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,c=c.slice(0,g=c.indexOf(a)).concat(c.slice(g+1)),d.remove(e)),f&&c.push(d.set(e,{on:f})),b)},a}function aF(){b.event.preventDefault()}function aG(){for(var c,a=b.event;c=a.sourceEvent;)a=c;return a}function aH(e){for(var a=new M,c=0,d=arguments.length;++c<d;)a[arguments[c]]=aE(a);return a.of=function(c,d){return function(f){try{var g=f.sourceEvent=b.event;f.target=e,b.event=f,a[f.type].apply(c,d)}finally{b.event=g}}},a}b.dispatch=function(){for(var a=new M,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=aE(a);return a},M.prototype.on=function(a,d){var c=a.indexOf("."),b="";if(c>=0&&(b=a.slice(c+1),a=a.slice(0,c)),a)return arguments.length<2?this[a].on(b):this[a].on(b,d);if(2===arguments.length){if(null==d)for(a in this)this.hasOwnProperty(a)&&this[a].on(b,null);return this}},b.event=null,b.requote=function(a){return a.replace(aI,"\\$&")};var aI=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,aJ={}.__proto__?function(a,b){a.__proto__=b}:function(c,a){for(var b in a)c[b]=a[b]};function aK(a){return aJ(a,d),a}var N=function(a,b){return b.querySelector(a)},O=function(a,b){return b.querySelectorAll(a)},P=function(a,b){var c=a.matches||a[L(a,"matchesSelector")];return(P=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(N=function(a,b){return Sizzle(a,b)[0]||null},O=Sizzle,P=Sizzle.matchesSelector),b.selection=function(){return b.select(h.documentElement)};var d=b.selection.prototype=[];function aL(a){return"function"==typeof a?a:function(){return N(a,this)}}function aM(a){return"function"==typeof a?a:function(){return O(a,this)}}d.select=function(c){var b,d,e,a,h=[];c=aL(c);for(var f=-1,i=this.length;++f<i;){h.push(b=[]),b.parentNode=(e=this[f]).parentNode;for(var g=-1,j=e.length;++g<j;)(a=e[g])?(b.push(d=c.call(a,a.__data__,g,f)),d&&"__data__"in a&&(d.__data__=a.__data__)):b.push(null)}return aK(h)},d.selectAll=function(b){var e,a,f=[];b=aM(b);for(var c=-1,h=this.length;++c<h;)for(var g=this[c],d=-1,i=g.length;++d<i;)(a=g[d])&&(f.push(e=s(b.call(a,a.__data__,d,c))),e.parentNode=a);return aK(f)};var Q="http://www.w3.org/1999/xhtml",R={svg:"http://www.w3.org/2000/svg",xhtml:Q,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function aN(a,c){return a=b.ns.qualify(a),null==c?a.local?function(){this.removeAttributeNS(a.space,a.local)}:function(){this.removeAttribute(a)}:"function"==typeof c?a.local?function(){var b=c.apply(this,arguments);null==b?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,b)}:function(){var b=c.apply(this,arguments);null==b?this.removeAttribute(a):this.setAttribute(a,b)}:a.local?function(){this.setAttributeNS(a.space,a.local,c)}:function(){this.setAttribute(a,c)}}function aO(a){return a.trim().replace(/\s+/g," ")}function aP(a){return new RegExp("(?:^|\\s+)"+b.requote(a)+"(?:\\s+|$)","g")}function aQ(a){return(a+"").trim().split(/^|\s+/)}function aR(a,b){var c=(a=aQ(a).map(aS)).length;return"function"==typeof b?function(){for(var d=-1,e=b.apply(this,arguments);++d<c;)a[d](this,e)}:function(){for(var d=-1;++d<c;)a[d](this,b)}}function aS(a){var b=aP(a);return function(c,e){if(d=c.classList)return e?d.add(a):d.remove(a);var d=c.getAttribute("class")||"";e?(b.lastIndex=0,b.test(d)||c.setAttribute("class",aO(d+" "+a))):c.setAttribute("class",aO(d.replace(b," ")))}}function aT(b,a,c){return null==a?function(){this.style.removeProperty(b)}:"function"==typeof a?function(){var d=a.apply(this,arguments);null==d?this.style.removeProperty(b):this.style.setProperty(b,d,c)}:function(){this.style.setProperty(b,a,c)}}function aU(b,a){return null==a?function(){delete this[b]}:"function"==typeof a?function(){var c=a.apply(this,arguments);null==c?delete this[b]:this[b]=c}:function(){this[b]=a}}function aV(a){return"function"==typeof a?a:(a=b.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){var b=this.ownerDocument,c=this.namespaceURI;return c===Q&&b.documentElement.namespaceURI===Q?b.createElement(a):b.createElementNS(c,a)}}function aW(){var a=this.parentNode;a&&a.removeChild(this)}function aX(a){return{__data__:a}}function aY(a){return function(){return P(this,a)}}function aZ(a){return arguments.length||(a=u),function(b,c){return b&&c?a(b.__data__,c.__data__):!b- !c}}function a$(c,f){for(var a=0,g=c.length;a<g;a++)for(var d,e=c[a],b=0,h=e.length;b<h;b++)(d=e[b])&&f(d,b,a);return c}function S(a){return aJ(a,f),a}b.ns={prefix:R,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&"xmlns"!==(c=a.slice(0,b))&&(a=a.slice(b+1)),R.hasOwnProperty(c)?{space:R[c],local:a}:a}},d.attr=function(a,c){if(arguments.length<2){if("string"==typeof a){var d=this.node();return(a=b.ns.qualify(a)).local?d.getAttributeNS(a.space,a.local):d.getAttribute(a)}for(c in a)this.each(aN(c,a[c]));return this}return this.each(aN(a,c))},d.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var d=this.node(),e=(a=aQ(a)).length,c=-1;if(b=d.classList){for(;++c<e;)if(!b.contains(a[c]))return!1}else for(b=d.getAttribute("class");++c<e;)if(!aP(a[c]).test(b))return!1;return!0}for(b in a)this.each(aR(b,a[b]));return this}return this.each(aR(a,b))},d.style=function(a,c,b){var d=arguments.length;if(d<3){if("string"!=typeof a){for(b in d<2&&(c=""),a)this.each(aT(b,a[b],c));return this}if(d<2){var e=this.node();return ap(e).getComputedStyle(e,null).getPropertyValue(a)}b=""}return this.each(aT(a,c,b))},d.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(aU(b,a[b]));return this}return this.each(aU(a,b))},d.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},d.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},d.append=function(a){return a=aV(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},d.insert=function(a,b){return a=aV(a),b=aL(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},d.remove=function(){return this.each(aW)},d.data=function(b,h){var c,f,a=-1,d=this.length;if(!arguments.length){for(b=new Array(d=(c=this[0]).length);++a<d;)(f=c[a])&&(b[a]=f.__data__);return b}function g(c,k){var a,b,d,f=c.length,l=k.length,r=Math.min(f,l),m=new Array(l),g=new Array(l),n=new Array(f);if(h){var o,p=new J,q=new Array(f);for(a=-1;++a<f;)(b=c[a])&&(p.has(o=h.call(b,b.__data__,a))?n[a]=b:p.set(o,b),q[a]=o);for(a=-1;++a<l;)(b=p.get(o=h.call(k,d=k[a],a)))?!0!==b&&(m[a]=b,b.__data__=d):g[a]=aX(d),p.set(o,!0);for(a=-1;++a<f;)a in q&& !0!==p.get(q[a])&&(n[a]=c[a])}else{for(a=-1;++a<r;)b=c[a],d=k[a],b?(b.__data__=d,m[a]=b):g[a]=aX(d);for(;a<l;++a)g[a]=aX(k[a]);for(;a<f;++a)n[a]=c[a]}g.update=m,g.parentNode=m.parentNode=n.parentNode=c.parentNode,i.push(g),e.push(m),j.push(n)}var i=S([]),e=aK([]),j=aK([]);if("function"==typeof b)for(;++a<d;)g(c=this[a],b.call(c,c.parentNode.__data__,a));else for(;++a<d;)g(c=this[a],b);return e.enter=function(){return i},e.exit=function(){return j},e},d.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},d.filter=function(a){var e,f,b,g=[];"function"!=typeof a&&(a=aY(a));for(var c=0,h=this.length;c<h;c++){g.push(e=[]),e.parentNode=(f=this[c]).parentNode;for(var d=0,i=f.length;d<i;d++)(b=f[d])&&a.call(b,b.__data__,d,c)&&e.push(b)}return aK(g)},d.order=function(){for(var e=-1,f=this.length;++e<f;)for(var b,c=this[e],d=c.length-1,a=c[d];--d>=0;)(b=c[d])&&(a&&a!==b.nextSibling&&a.parentNode.insertBefore(b,a),a=b);return this},d.sort=function(a){a=aZ.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},d.each=function(a){return a$(this,function(b,c,d){a.call(b,b.__data__,c,d)})},d.call=function(b){var a=s(arguments);return b.apply(a[0]=this,a),this},d.empty=function(){return!this.node()},d.node=function(){for(var a=0,e=this.length;a<e;a++)for(var c=this[a],b=0,f=c.length;b<f;b++){var d=c[b];if(d)return d}return null},d.size=function(){var a=0;return a$(this,function(){++a}),a};var f=[];function a_(a,d,h){var i="__on"+a,c=a.indexOf("."),f=a0;c>0&&(a=a.slice(0,c));var e=T.get(a);function g(){var b=this[i];b&&(this.removeEventListener(a,b,b.$),delete this[i])}return e&&(a=e,f=a1),c?d?function(){var b=f(d,s(arguments));g.call(this),this.addEventListener(a,this[i]=b,b.$=h),b._=d}:g:d?aD:function(){var d,f=new RegExp("^__on([^.]+)"+b.requote(a)+"$");for(var c in this)if(d=c.match(f)){var e=this[c];this.removeEventListener(d[1],e,e.$),delete this[c]}}}b.selection.enter=S,b.selection.enter.prototype=f,f.append=d.append,f.empty=d.empty,f.node=d.node,f.call=d.call,f.size=d.size,f.select=function(i){for(var b,f,g,a,d,h=[],e=-1,j=this.length;++e<j;){g=(a=this[e]).update,h.push(b=[]),b.parentNode=a.parentNode;for(var c=-1,k=a.length;++c<k;)(d=a[c])?(b.push(g[c]=f=i.call(a.parentNode,d.__data__,c,e)),f.__data__=d.__data__):b.push(null)}return aK(h)},f.insert=function(b,a){var c,e,f;return arguments.length<2&&(a=(c=this,function(i,b,a){var d,g=c[a].update,h=g.length;for(a!=f&&(f=a,e=0),b>=e&&(e=b+1);!(d=g[e])&& ++e<h;);return d})),d.insert.call(this,b,a)},b.select=function(a){var b;return"string"==typeof a?(b=[N(a,h)]).parentNode=h.documentElement:(b=[a]).parentNode=ao(a),aK([b])},b.selectAll=function(a){var b;return"string"==typeof a?(b=s(O(a,h))).parentNode=h.documentElement:(b=s(a)).parentNode=null,aK([b])},d.on=function(a,d,b){var c=arguments.length;if(c<3){if("string"!=typeof a){for(b in c<2&&(d=!1),a)this.each(a_(b,a[b],d));return this}if(c<2)return(c=this.node()["__on"+a])&&c._;b=!1}return this.each(a_(a,d,b))};var T=b.map({mouseenter:"mouseover",mouseleave:"mouseout"});function a0(a,c){return function(d){var e=b.event;b.event=d,c[0]=this.__data__;try{a.apply(this,c)}finally{b.event=e}}}function a1(a,b){var c=a0(a,b);return function(b){var a=b.relatedTarget;a&&(a===this||8&a.compareDocumentPosition(this))||c.call(this,b)}}h&&T.forEach(function(a){"on"+a in h&&T.remove(a)});var a2,a3=0;function a4(a){var c=".dragsuppress-"+ ++a3,e="click"+c,f=b.select(ap(a)).on("touchmove"+c,aF).on("dragstart"+c,aF).on("selectstart"+c,aF);if(null==a2&&(a2=!("onselectstart"in a)&&L(a.style,"userSelect")),a2){var d=ao(a).style,g=d[a2];d[a2]="none"}return function(a){if(f.on(c,null),a2&&(d[a2]=g),a){var b=function(){f.on(e,null)};f.on(e,function(){aF(),b()},!0),setTimeout(b,0)}}}b.mouse=function(a){return a6(a,aG())};var a5=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function a6(c,a){a.changedTouches&&(a=a.changedTouches[0]);var e=c.ownerSVGElement||c;if(e.createSVGPoint){var d=e.createSVGPoint();if(a5<0){var f=ap(c);if(f.scrollX||f.scrollY){var g=(e=b.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();a5=!(g.f||g.e),e.remove()}}return a5?(d.x=a.pageX,d.y=a.pageY):(d.x=a.clientX,d.y=a.clientY),[(d=d.matrixTransform(c.getScreenCTM().inverse())).x,d.y]}var h=c.getBoundingClientRect();return[a.clientX-h.left-c.clientLeft,a.clientY-h.top-c.clientTop]}function a7(){return b.event.changedTouches[0].identifier}b.touch=function(e,a,c){if(arguments.length<3&&(c=a,a=aG().changedTouches),a){for(var d,b=0,f=a.length;b<f;++b)if((d=a[b]).identifier===c)return a6(e,d)}},b.behavior.drag=function(){var c=aH(a,"drag","dragstart","dragend"),d=null,e=g(aD,b.mouse,ap,"mousemove","mouseup"),f=g(a7,b.touch,j,"touchmove","touchend");function a(){this.on("mousedown.drag",e).on("touchstart.drag",f)}function g(a,e,f,g,h){return function(){var i,k=b.event.target.correspondingElement||b.event.target,n=this.parentNode,o=c.of(this,arguments),p=0,j=a(),l=".drag"+(null==j?"":"-"+j),q=b.select(f(k)).on(g+l,function(){var b,c,a=e(n,j);a&&(b=a[0]-m[0],c=a[1]-m[1],p|=b|c,m=a,o({type:"drag",x:a[0]+i[0],y:a[1]+i[1],dx:b,dy:c}))}).on(h+l,function(){e(n,j)&&(q.on(g+l,null).on(h+l,null),r(p),o({type:"dragend"}))}),r=a4(k),m=e(n,j);d?(i=d.apply(this,arguments),i=[i.x-m[0],i.y-m[1]]):i=[0,0],o({type:"dragstart"})}}return a.origin=function(b){return arguments.length?(d=b,a):d},b.rebind(a,c,"on")},b.touches=function(b,a){return arguments.length<2&&(a=aG().touches),a?s(a).map(function(a){var c=a6(b,a);return c.identifier=a.identifier,c}):[]};var a8=1e-6*1e-6,k=Math.PI,U=2*k,a9=U-1e-6,ba=k/2,V=k/180,bb=180/k;function bc(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function bd(a){return a>1?ba:a< -1?-ba:Math.asin(a)}function be(a){return((a=Math.exp(a))+1/a)/2}var bf=Math.SQRT2;b.interpolateZoom=function(e,f){var c,g,m=e[0],n=e[1],a=e[2],o=f[0],p=f[1],b=f[2],j=o-m,k=p-n,d=j*j+k*k;if(d<a8)g=Math.log(b/a)/bf,c=function(b){return[m+b*j,n+b*k,a*Math.exp(bf*b*g)]};else{var l=Math.sqrt(d),h=(b*b-a*a+4*d)/(2*a*2*l),i=(b*b-a*a-4*d)/(2*b*2*l),q=Math.log(Math.sqrt(h*h+1)-h);g=(Math.log(Math.sqrt(i*i+1)-i)-q)/bf,c=function(h){var b,c,d=h*g,e=be(q),f=a/(2*l)*(e*(((b=Math.exp(2*(b=bf*d+q)))-1)/(b+1))-((c=Math.exp(c=q))-1/c)/2);return[m+f*j,n+f*k,a*e/be(bf*d+q)]}}return c.duration=1e3*g,c},b.behavior.zoom=function(){var d,e,f,g,i,j,k,l,m,n={x:0,y:0,k:1},o=[960,500],p=bi,q=250,r=0,s="mousedown.zoom",t="mousemove.zoom",u="mouseup.zoom",v="touchstart.zoom",c=aH(a,"zoomstart","zoom","zoomend");function a(a){a.on(s,E).on(bh+".zoom",G).on("dblclick.zoom",H).on(v,F)}function w(a){return[(a[0]-n.x)/n.k,(a[1]-n.y)/n.k]}function x(a){n.k=Math.max(p[0],Math.min(p[1],a))}function y(b,a){var c;a=[(c=a)[0]*n.k+n.x,c[1]*n.k+n.y],n.x+=b[0]-a[0],n.y+=b[1]-a[1]}function z(c,d,f,g){c.__chart__={x:n.x,y:n.y,k:n.k},x(Math.pow(2,g)),y(e=d,f),c=b.select(c),q>0&&(c=c.transition().duration(q)),c.call(a.event)}function A(){k&&k.domain(j.range().map(function(a){return(a-n.x)/n.k}).map(j.invert)),m&&m.domain(l.range().map(function(a){return(a-n.y)/n.k}).map(l.invert))}function B(a){r++ ||a({type:"zoomstart"})}function C(a){A(),a({type:"zoom",scale:n.k,translate:[n.x,n.y]})}function D(a){--r||(a({type:"zoomend"}),e=null)}function E(){var a=this,d=c.of(a,arguments),e=0,f=b.select(ap(a)).on(t,function(){e=1,y(b.mouse(a),g),C(d)}).on(u,function(){f.on(t,null).on(u,null),h(e),D(d)}),g=w(b.mouse(a)),h=a4(a);el.call(a),B(d)}function F(){var h,a=this,f=c.of(a,arguments),j={},k=0,d=".zoom-"+b.event.changedTouches[0].identifier,l="touchmove"+d,m="touchend"+d,o=[],g=b.select(a),p=a4(a);function q(){var c=b.touches(a);return h=n.k,c.forEach(function(a){a.identifier in j&&(j[a.identifier]=w(a))}),c}function e(){var f=b.event.target;b.select(f).on(l,r).on(m,t),o.push(f);for(var g=b.event.changedTouches,e=0,v=g.length;e<v;++e)j[g[e].identifier]=null;var c=q(),h=Date.now();if(1===c.length){if(h-i<500){var d=c[0];z(a,d,j[d.identifier],Math.floor(Math.log(n.k)/Math.LN2)+1),aF()}i=h}else if(c.length>1){var d=c[0],p=c[1],s=d[0]-p[0],u=d[1]-p[1];k=s*s+u*u}}function r(){var c,d,e,g,n=b.touches(a);el.call(a);for(var m=0,o=n.length;m<o;++m,g=null)if(g=j[(e=n[m]).identifier]){if(d)break;c=e,d=g}if(g){var l=(l=e[0]-c[0])*l+(l=e[1]-c[1])*l,p=k&&Math.sqrt(l/k);c=[(c[0]+e[0])/2,(c[1]+e[1])/2],d=[(d[0]+g[0])/2,(d[1]+g[1])/2],x(p*h)}i=null,y(c,d),C(f)}function t(){if(b.event.touches.length){for(var c=b.event.changedTouches,a=0,e=c.length;a<e;++a)delete j[c[a].identifier];for(var h in j)return void q()}b.selectAll(o).on(d,null),g.on(s,E).on(v,F),p(),D(f)}e(),B(f),g.on(s,null).on(v,e)}function G(){var a=c.of(this,arguments);g?clearTimeout(g):(el.call(this),d=w(e=f||b.mouse(this)),B(a)),g=setTimeout(function(){g=null,D(a)},50),aF(),x(Math.pow(2,.002*bg())*n.k),y(e,d),C(a)}function H(){var a=b.mouse(this),c=Math.log(n.k)/Math.LN2;z(this,a,w(a),b.event.shiftKey?Math.ceil(c)-1:Math.floor(c)+1)}return bh||(bh="onwheel"in h?(bg=function(){return-b.event.deltaY*(b.event.deltaMode?120:1)},"wheel"):"onmousewheel"in h?(bg=function(){return b.event.wheelDelta},"mousewheel"):(bg=function(){return-b.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=c.of(this,arguments),d=n;eo?b.select(this).transition().each("start.zoom",function(){n=this.__chart__||{x:0,y:0,k:1},B(a)}).tween("zoom:zoom",function(){var c=o[0],h=o[1],f=e?e[0]:c/2,g=e?e[1]:h/2,i=b.interpolateZoom([(f-n.x)/n.k,(g-n.y)/n.k,c/n.k],[(f-d.x)/d.k,(g-d.y)/d.k,c/d.k]);return function(e){var b=i(e),d=c/b[2];this.__chart__=n={x:f-b[0]*d,y:g-b[1]*d,k:d},C(a)}}).each("interrupt.zoom",function(){D(a)}).each("end.zoom",function(){D(a)}):(this.__chart__=n,B(a),C(a),D(a))})},a.translate=function(b){return arguments.length?(n={x:+b[0],y:+b[1],k:n.k},A(),a):[n.x,n.y]},a.scale=function(b){return arguments.length?(n={x:n.x,y:n.y,k:null},x(+b),A(),a):n.k},a.scaleExtent=function(b){return arguments.length?(p=null==b?bi:[+b[0],+b[1]],a):p},a.center=function(b){return arguments.length?(f=b&&[+b[0],+b[1]],a):f},a.size=function(b){return arguments.length?(o=b&&[+b[0],+b[1]],a):o},a.duration=function(b){return arguments.length?(q=+b,a):q},a.x=function(b){return arguments.length?(k=b,j=b.copy(),n={x:0,y:0,k:1},a):k},a.y=function(b){return arguments.length?(m=b,l=b.copy(),n={x:0,y:0,k:1},a):m},b.rebind(a,c,"on")};var bg,bh,bi=[0,1/0];function g(){}function C(a,b,c){return this instanceof C?void(this.h=+a,this.s=+b,this.l=+c):arguments.length<2?a instanceof C?new C(a.h,a.s,a.l):bt(""+a,bu,C):new C(a,b,c)}b.color=g,g.prototype.toString=function(){return this.rgb()+""},b.hsl=C;var n=C.prototype=new g;function bj(b,c,a){var f,e;function d(b){var a;return Math.round(255*(((a=b)>360?a-=360:a<0&&(a+=360),a<60)?f+(e-f)*a/60:a<180?e:a<240?f+(e-f)*(240-a)/60:f))}return b=isNaN(b)?0:(b%=360)<0?b+360:b,c=isNaN(c)?0:c<0?0:c>1?1:c,a=a<0?0:a>1?1:a,e=a<=.5?a*(1+c):a+c-a*c,f=2*a-e,new F(d(b+120),d(b),d(b-120))}function D(a,c,d){return this instanceof D?void(this.h=+a,this.c=+c,this.l=+d):arguments.length<2?a instanceof D?new D(a.h,a.c,a.l):a instanceof E?bn(a.l,a.a,a.b):bn((a=bv((a=b.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new D(a,c,d)}n.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new C(this.h,this.s,this.l/a)},n.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new C(this.h,this.s,a*this.l)},n.rgb=function(){return bj(this.h,this.s,this.l)},b.hcl=D;var o=D.prototype=new g;function bk(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new E(c,Math.cos(a*=V)*b,Math.sin(a)*b)}function E(a,b,c){return this instanceof E?void(this.l=+a,this.a=+b,this.b=+c):arguments.length<2?a instanceof E?new E(a.l,a.a,a.b):a instanceof D?bk(a.h,a.c,a.l):bv((a=F(a)).r,a.g,a.b):new E(a,b,c)}o.brighter=function(a){return new D(this.h,this.c,Math.min(100,this.l+bl*(arguments.length?a:1)))},o.darker=function(a){return new D(this.h,this.c,Math.max(0,this.l-bl*(arguments.length?a:1)))},o.rgb=function(){return bk(this.h,this.c,this.l).rgb()},b.lab=E;var bl=18,p=E.prototype=new g;function bm(d,e,f){var a=(d+16)/116,b=a+e/500,c=a-f/200;return b=.95047*bo(b),a=1*bo(a),c=1.08883*bo(c),new F(bq(3.2404542*b-1.5371385*a-.4985314*c),bq(-0.969266*b+1.8760108*a+.041556*c),bq(.0556434*b-.2040259*a+1.0572252*c))}function bn(a,b,c){return a>0?new D(Math.atan2(c,b)*bb,Math.sqrt(b*b+c*c),a):new D(NaN,NaN,a)}function bo(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function bp(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function bq(a){return Math.round(255*(a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function F(a,b,c){return this instanceof F?void(this.r=~~a,this.g=~~b,this.b=~~c):arguments.length<2?a instanceof F?new F(a.r,a.g,a.b):bt(""+a,F,bj):new F(a,b,c)}function br(a){return new F(a>>16,a>>8&255,255&a)}function l(a){return br(a)+""}p.brighter=function(a){return new E(Math.min(100,this.l+bl*(arguments.length?a:1)),this.a,this.b)},p.darker=function(a){return new E(Math.max(0,this.l-bl*(arguments.length?a:1)),this.a,this.b)},p.rgb=function(){return bm(this.l,this.a,this.b)},b.rgb=F;var m=F.prototype=new g;function bs(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function bt(b,g,i){var h,c,a,f=0,d=0,e=0;if(h=/([a-z]+)\((.*)\)/.exec(b=b.toLowerCase()))switch(c=h[2].split(","),h[1]){case"hsl":return i(parseFloat(c[0]),parseFloat(c[1])/100,parseFloat(c[2])/100);case"rgb":return g(bx(c[0]),bx(c[1]),bx(c[2]))}return(a=W.get(b))?g(a.r,a.g,a.b):(null==b||"#"!==b.charAt(0)||isNaN(a=parseInt(b.slice(1),16))||(4===b.length?(f=(f=(3840&a)>>4)>>4|f,d=240&a,d=d>>4|d,e=15&a,e=e<<4|e):7!==b.length||(f=(16711680&a)>>16,d=(65280&a)>>8,e=255&a)),g(f,d,e))}function bu(d,a,e){var f,i,g=Math.min(d/=255,a/=255,e/=255),b=Math.max(d,a,e),c=b-g,h=(b+g)/2;return c?(i=h<.5?c/(b+g):c/(2-b-g),f=d==b?(a-e)/c+(a<e?6:0):a==b?(e-d)/c+2:(d-a)/c+4,f*=60):(f=NaN,i=h>0&&h<1?0:f),new C(f,i,h)}function bv(a,b,c){var e=bp((.4124564*(a=bw(a))+.3575761*(b=bw(b))+.1804375*(c=bw(c)))/.95047),d=bp((.2126729*a+.7151522*b+.072175*c)/1),f=bp((.0193339*a+.119192*b+.9503041*c)/1.08883);return E(116*d-16,500*(e-d),200*(d-f))}function bw(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function bx(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}m.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b;return b||c||d?(b&&b<30&&(b=30),c&&c<30&&(c=30),d&&d<30&&(d=30),new F(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new F(30,30,30)},m.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new F(a*this.r,a*this.g,a*this.b)},m.hsl=function(){return bu(this.r,this.g,this.b)},m.toString=function(){return"#"+bs(this.r)+bs(this.g)+bs(this.b)};var W=b.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function X(a){return"function"==typeof a?a:function(){return a}}function q(a){return function(d,b,c){return 2===arguments.length&&"function"==typeof b&&(c=b,b=null),by(d,b,a,c)}}function by(e,h,i,d){var a={},f=b.dispatch("beforesend","progress","load","error"),j={},c=new XMLHttpRequest,k=null;function g(){var d,b=c.status;if(!b&&bA(c)||b>=200&&b<300||304===b){try{d=i.call(a,c)}catch(e){f.error.call(a,e);return}f.load.call(a,d)}else f.error.call(a,c)}return self.XDomainRequest&&!("withCredentials"in c)&&/^(http(s)?:)?\/\//.test(e)&&(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=g:c.onreadystatechange=function(){c.readyState>3&&g()},c.onprogress=function(d){var e=b.event;b.event=d;try{f.progress.call(a,c)}finally{b.event=e}},a.header=function(b,c){return(b=(b+"").toLowerCase(),arguments.length<2)?j[b]:(null==c?delete j[b]:j[b]=c+"",a)},a.mimeType=function(b){return arguments.length?(h=null==b?null:b+"",a):h},a.responseType=function(b){return arguments.length?(k=b,a):k},a.response=function(b){return i=b,a},["get","post"].forEach(function(b){a[b]=function(){return a.send.apply(a,[b].concat(s(arguments)))}}),a.send=function(i,b,d){if(2===arguments.length&&"function"==typeof b&&(d=b,b=null),c.open(i,e,!0),null==h||"accept"in j||(j.accept=h+",*/*"),c.setRequestHeader)for(var g in j)c.setRequestHeader(g,j[g]);return null!=h&&c.overrideMimeType&&c.overrideMimeType(h),null!=k&&(c.responseType=k),null!=d&&a.on("error",d).on("load",function(a){d(null,a)}),f.beforesend.call(a,c),c.send(null==b?null:b),a},a.abort=function(){return c.abort(),a},b.rebind(a,f,"on"),null==d?a:a.get(bz(d))}function bz(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function bA(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}W.forEach(function(a,b){W.set(a,br(b))}),b.functor=X,b.xhr=q(j),b.dsv=function(b,c){var d=new RegExp('["'+b+"\n]"),e=b.charCodeAt(0);function a(e,a,b){arguments.length<3&&(b=a,a=null);var d=by(e,c,null==a?f:g(a),b);return d.row=function(b){return arguments.length?d.response(null==(a=b)?f:g(b)):a},d}function f(b){return a.parse(b.responseText)}function g(b){return function(c){return a.parse(c.responseText,b)}}function h(a){return a.map(i).join(b)}function i(a){return d.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}return a.parse=function(b,c){var d;return a.parseRows(b,function(a,b){if(d)return d(a,b-1);var e=function(d){for(var c={},e=a.length,b=0;b<e;++b)c[a[b]]=d[b];return c};d=c?function(a,b){return c(e(a),b)}:e})},a.parseRows=function(h,c){var a,k,i={},d={},f=[],l=h.length,m=0,j=0;function g(){if(m>=l)return d;if(k)return k=!1,i;var c=m;if(34===h.charCodeAt(c)){for(var a=c;(a++)<l;)if(34===h.charCodeAt(a)){if(34!==h.charCodeAt(a+1))break;++a}m=a+2;var b=h.charCodeAt(a+1);return 13===b?(k=!0,10===h.charCodeAt(a+2)&& ++m):10===b&&(k=!0),h.slice(c+1,a).replace(/""/g,'"')}for(;m<l;){var b=h.charCodeAt(m++),f=1;if(10===b)k=!0;else if(13===b)k=!0,10===h.charCodeAt(m)&&(++m,++f);else if(b!==e)continue;return h.slice(c,m-f)}return h.slice(c)}for(;(a=g())!==d;){for(var b=[];a!==i&&a!==d;)b.push(a),a=g();c&&null==(b=c(b,j++))||f.push(b)}return f},a.format=function(c){if(Array.isArray(c[0]))return a.formatRows(c);var e=new K,d=[];return c.forEach(function(b){for(var a in b)e.has(a)||d.push(e.add(a))}),[d.map(i).join(b)].concat(c.map(function(a){return d.map(function(b){return i(a[b])}).join(b)})).join("\n")},a.formatRows=function(a){return a.map(h).join("\n")},a},b.csv=b.dsv(",","text/csv"),b.tsv=b.dsv("	","text/tab-separated-values");var bB,bC,bD,bE,bF=this[L(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};function bG(e,b,c){var d=arguments.length;d<2&&(b=0),d<3&&(c=Date.now());var a={c:e,t:c+b,n:null};return bC?bC.n=a:bB=a,bC=a,bD||(bE=clearTimeout(bE),bD=1,bF(bH)),a}function bH(){var b=bI(),a=bJ()-b;a>24?(isFinite(a)&&(clearTimeout(bE),bE=setTimeout(bH,a)),bD=0):(bD=1,bF(bH))}function bI(){for(var b=Date.now(),a=bB;a;)b>=a.t&&a.c(b-a.t)&&(a.c=null),a=a.n;return b}function bJ(){for(var b,a=bB,c=1/0;a;)a.c?(a.t<c&&(c=a.t),a=(b=a).n):a=b?b.n=a.n:bB=a.n;return bC=b,c}function bK(a){return a[0]}function bL(a){return a[1]}function bM(b){for(var e=b.length,c=[0,1],a=2,d=2;d<e;d++){for(;a>1&&0>=bc(b[c[a-2]],b[c[a-1]],b[d]);)--a;c[a++]=d}return c.slice(0,a)}function bN(a,b){return a[0]-b[0]||a[1]-b[1]}b.timer=function(){bG.apply(this,arguments)},b.timer.flush=function(){bI(),bJ()},b.round=function(b,a){return a?Math.round(b*(a=Math.pow(10,a)))/a:Math.round(b)},b.geom={},b.geom.hull=function(b){var c=bK,d=bL;if(arguments.length)return a(b);function a(e){if(e.length<3)return[];var a,k=X(c),l=X(d),i=e.length,b=[],j=[];for(a=0;a<i;a++)b.push([+k.call(this,e[a],a),+l.call(this,e[a],a),a]);for(b.sort(bN),a=0;a<i;a++)j.push([b[a][0],-b[a][1]]);var f=bM(b),g=bM(j),m=g[0]===f[0],n=g[g.length-1]===f[f.length-1],h=[];for(a=f.length-1;a>=0;--a)h.push(e[b[f[a]][2]]);for(a=+m;a<g.length-n;++a)h.push(e[b[g[a]][2]]);return h}return a.x=function(b){return arguments.length?(c=b,a):c},a.y=function(b){return arguments.length?(d=b,a):d},a},b.geom.polygon=function(a){return aJ(a,r),a};var r=b.geom.polygon.prototype=[];function bO(b,a,c){return(c[0]-a[0])*(b[1]-a[1])<(c[1]-a[1])*(b[0]-a[0])}function bP(c,d,e,f){var a=c[0],g=e[0],h=d[0]-a,i=f[0]-g,b=c[1],j=e[1],k=d[1]-b,l=f[1]-j,m=(i*(b-j)-l*(a-g))/(l*h-i*k);return[a+m*h,b+m*k]}function bQ(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}r.area=function(){for(var b,c=-1,d=this.length,a=this[d-1],e=0;++c<d;)b=a,a=this[c],e+=b[1]*a[0]-b[0]*a[1];return .5*e},r.centroid=function(c){var b,d,e=-1,f=this.length,g=0,h=0,a=this[f-1];for(arguments.length||(c=-1/(6*this.area()));++e<f;)b=a,a=this[e],d=b[0]*a[1]-a[0]*b[1],g+=(b[0]+a[0])*d,h+=(b[1]+a[1])*d;return[g*c,h*c]},r.clip=function(a){for(var f,g,h,b,c,e,i=bQ(a),j=-1,k=this.length-bQ(this),d=this[k-1];++j<k;){for(f=a.slice(),a.length=0,b=this[j],c=f[(h=f.length-i)-1],g=-1;++g<h;)bO(e=f[g],d,b)?(bO(c,d,b)||a.push(bP(c,e,d,b)),a.push(e)):bO(c,d,b)&&a.push(bP(c,e,d,b)),c=e;i&&a.push(a[0]),d=b}return a};var bR,bS,bT,bU,bV,bW=[],bX=[];function bY(){cc(this),this.edge=this.site=this.circle=null}function bZ(b){var a=bW.pop()||new bY;return a.site=b,a}function b$(a){b6(a),bT.remove(a),bW.push(a),cc(a)}function b_(d){var j=d.circle,f=j.x,g=j.cy,k={x:f,y:g},h=d.P,i=d.N,c=[d];b$(d);for(var b=h;b.circle&&1e-6>ay(f-b.circle.x)&&1e-6>ay(g-b.circle.cy);)h=b.P,c.unshift(b),b$(b),b=h;c.unshift(b),b6(b);for(var a=i;a.circle&&1e-6>ay(f-a.circle.x)&&1e-6>ay(g-a.circle.cy);)i=a.N,c.push(a),b$(a),a=i;c.push(a),b6(a);var e,l=c.length;for(e=1;e<l;++e)a=c[e],b=c[e-1],cb(a.edge,b.site,a.site,k);b=c[0],a=c[l-1],a.edge=b9(b.site,a.site,null,k),b5(b),b5(a)}function b0(d){for(var a,b,o,p,q=d.x,r=d.y,c=bT._;c;)if((o=b1(c,r)-q)>1e-6)c=c.L;else if((p=q-b2(c,r))>1e-6){if(!c.R){a=c;break}c=c.R}else{o> -0.000001?(a=c.P,b=c):p> -0.000001?(a=c,b=c.N):a=b=c;break}var e=bZ(d);if(bT.insert(a,e),a||b){if(a===b){b6(a),b=bZ(a.site),bT.insert(e,b),e.edge=b.edge=b9(a.site,e.site),b5(a),b5(b);return}if(!b){e.edge=b9(a.site,e.site);return}b6(a),b6(b);var f=a.site,l=f.x,m=f.y,g=d.x-l,h=d.y-m,i=b.site,j=i.x-l,k=i.y-m,s=2*(g*k-h*j),t=g*g+h*h,u=j*j+k*k,n={x:(k*t-h*u)/s+l,y:(g*u-j*t)/s+m};cb(b.edge,f,i,n),e.edge=b9(f,d,null,n),b.edge=b9(d,i,null,n),b5(a),b5(b)}}function b1(i,j){var b=i.site,c=b.x,k=b.y,d=k-j;if(!d)return c;var l=i.P;if(!l)return-1/0;var e=(b=l.site).x,m=b.y,a=m-j;if(!a)return e;var f=e-c,g=1/d-1/a,h=f/a;return g?(-h+Math.sqrt(h*h-2*g*(f*f/(-2*a)-m+a/2+k-d/2)))/g+c:(c+e)/2}function b2(a,b){var c=a.N;if(c)return b1(c,b);var d=a.site;return d.y===b?d.x:1/0}function Y(a){this.site=a,this.edges=[]}function b3(a,b){return b.angle-a.angle}function b4(){cc(this),this.x=this.y=this.arc=this.site=this.cy=null}function b5(d){var q=d.P,r=d.N;if(q&&r){var i=q.site,j=d.site,k=r.site;if(i!==k){var l=j.x,m=j.y,e=i.x-l,f=i.y-m,g=k.x-l,c=k.y-m,n=2*(e*c-f*g);if(!(n>= -a8)){var s=e*e+f*f,t=g*g+c*c,o=(c*s-f*t)/n,p=(e*t-g*s)/n,c=p+m,b=bX.pop()||new b4;b.arc=d,b.site=j,b.x=o+l,b.y=c+Math.sqrt(o*o+p*p),b.cy=c,d.circle=b;for(var h=null,a=bV._;a;)if(b.y<a.y||b.y===a.y&&b.x<=a.x)if(a.L)a=a.L;else{h=a.P;break}else if(a.R)a=a.R;else{h=a;break}bV.insert(h,b),h||(bU=b)}}}}function b6(b){var a=b.circle;a&&(a.P||(bU=a.N),bV.remove(a),bX.push(a),cc(a),b.circle=null)}function b7(h,k){var d=h.b;if(d)return!0;var b,c,a=h.a,i=k[0][0],j=k[1][0],e=k[0][1],f=k[1][1],p=h.l,q=h.r,l=p.x,m=p.y,n=q.x,o=q.y,g=(l+n)/2,r=(m+o)/2;if(o===m){if(g<i||g>=j)return;if(l>n){if(a){if(a.y>=f)return}else a={x:g,y:e};d={x:g,y:f}}else{if(a){if(a.y<e)return}else a={x:g,y:f};d={x:g,y:e}}}else if(c=r-(b=(l-n)/(o-m))*g,b< -1||b>1)if(l>n){if(a){if(a.y>=f)return}else a={x:(e-c)/b,y:e};d={x:(f-c)/b,y:f}}else{if(a){if(a.y<e)return}else a={x:(f-c)/b,y:f};d={x:(e-c)/b,y:e}}else if(m<o){if(a){if(a.x>=j)return}else a={x:i,y:b*i+c};d={x:j,y:b*j+c}}else{if(a){if(a.x<i)return}else a={x:j,y:b*j+c};d={x:i,y:b*i+c}}return h.a=a,h.b=d,!0}function b8(a,b){this.l=a,this.r=b,this.a=this.b=null}function b9(a,b,d,e){var c=new b8(a,b);return bR.push(c),d&&cb(c,a,b,d),e&&cb(c,b,a,e),bS[a.i].edges.push(new Z(c,a,b)),bS[b.i].edges.push(new Z(c,b,a)),c}function ca(b,c,d){var a=new b8(b,null);return a.a=c,a.b=d,bR.push(a),a}function cb(a,d,c,b){a.a||a.b?a.l===c?a.b=b:a.a=b:(a.a=b,a.l=d,a.r=c)}function Z(a,b,e){var c=a.a,d=a.b;this.edge=a,this.site=b,this.angle=e?Math.atan2(e.y-b.y,e.x-b.x):a.l===b?Math.atan2(d.x-c.x,c.y-d.y):Math.atan2(c.x-d.x,d.y-c.y)}function $(){this._=null}function cc(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function cd(e,d){var a=d,b=d.R,c=a.U;c?c.L===a?c.L=b:c.R=b:e._=b,b.U=c,a.U=b,a.R=b.L,a.R&&(a.R.U=a),b.L=a}function ce(e,d){var a=d,b=d.L,c=a.U;c?c.L===a?c.L=b:c.R=b:e._=b,b.U=c,a.U=b,a.L=b.R,a.L&&(a.L.U=a),b.R=a}function cf(a){for(;a.L;)a=a.L;return a}function cg(c,d){var e,f,b,a=c.sort(ch).pop();for(bR=[],bS=new Array(c.length),bT=new $,bV=new $;;)if(b=bU,a&&(!b||a.y<b.y||a.y===b.y&&a.x<b.x))(a.x!==e||a.y!==f)&&(bS[a.i]=new Y(a),b0(a),e=a.x,f=a.y),a=c.pop();else if(b)b_(b.arc);else break;d&&(function(b){for(var e,f,g,h,a,c=bR,i=(e=b[0][0],f=b[0][1],g=b[1][0],h=b[1][1],function(j){var a,m=j.a,n=j.b,k=m.x,l=m.y,o=n.x,p=n.y,b=0,c=1,d=o-k,i=p-l;if(a=e-k,d||!(a>0)){if(a/=d,d<0){if(a<b)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>b&&(b=a)}if(a=g-k,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>b&&(b=a)}else if(d>0){if(a<b)return;a<c&&(c=a)}if(a=f-l,i||!(a>0)){if(a/=i,i<0){if(a<b)return;a<c&&(c=a)}else if(i>0){if(a>c)return;a>b&&(b=a)}if(a=h-l,i||!(a<0)){if(a/=i,i<0){if(a>c)return;a>b&&(b=a)}else if(i>0){if(a<b)return;a<c&&(c=a)}return b>0&&(j.a={x:k+b*d,y:l+b*i}),c<1&&(j.b={x:k+c*d,y:l+c*i}),j}}}}}),d=c.length;d--;)(!b7(a=c[d],b)||!i(a)||1e-6>ay(a.a.x-a.b.x)&&1e-6>ay(a.a.y-a.b.y))&&(a.a=a.b=null,c.splice(d,1))}(d),function(k){for(var a,b,c,d,e,f,l,m,o,n,g=k[0][0],h=k[1][0],i=k[0][1],j=k[1][1],p=bS,q=p.length;q--;)if((e=p[q])&&e.prepare())for(m=(l=e.edges).length,f=0;f<m;)c=(n=l[f].end()).x,d=n.y,a=(o=l[++f%m].start()).x,b=o.y,(ay(c-a)>1e-6||ay(d-b)>1e-6)&&(l.splice(f,0,new Z(ca(e.site,n,1e-6>ay(c-g)&&j-d>1e-6?{x:g,y:1e-6>ay(a-g)?b:j}:1e-6>ay(d-j)&&h-c>1e-6?{x:1e-6>ay(b-j)?a:h,y:j}:1e-6>ay(c-h)&&d-i>1e-6?{x:h,y:1e-6>ay(a-h)?b:i}:1e-6>ay(d-i)&&c-g>1e-6?{x:1e-6>ay(b-i)?a:g,y:i}:null),e.site,null)),++m)}(d));var g={cells:bS,edges:bR};return bT=bV=bR=bS=null,g}function ch(a,b){return b.y-a.y||b.x-a.x}Y.prototype.prepare=function(){for(var c,a=this.edges,b=a.length;b--;)(c=a[b].edge).b&&c.a||a.splice(b,1);return a.sort(b3),a.length},Z.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},$.prototype={insert:function(a,c){var b,d,e;if(a){if(c.P=a,c.N=a.N,a.N&&(a.N.P=c),a.N=c,a.R){for(a=a.R;a.L;)a=a.L;a.L=c}else a.R=c;b=a}else this._?(a=cf(this._),c.P=null,c.N=a,a.P=a.L=c,b=a):(c.P=c.N=null,this._=c,b=null);for(c.L=c.R=null,c.U=b,c.C=!0,a=c;b&&b.C;)d=b.U,b===d.L?(e=d.R)&&e.C?(b.C=e.C=!1,d.C=!0,a=d):(a===b.R&&(cd(this,b),b=(a=b).U),b.C=!1,d.C=!0,ce(this,d)):(e=d.L)&&e.C?(b.C=e.C=!1,d.C=!0,a=d):(a===b.L&&(ce(this,b),b=(a=b).U),b.C=!1,d.C=!0,cd(this,d)),b=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,d,g,c=a.U,f=a.L,e=a.R;if(d=f?e?cf(e):f:e,c?c.L===a?c.L=d:c.R=d:this._=d,f&&e?(g=d.C,d.C=a.C,d.L=f,f.U=d,d!==e?(c=d.U,d.U=a.U,a=d.R,c.L=a,d.R=e,e.U=d):(d.U=c,c=d,a=d.R)):(g=a.C,a=d),a&&(a.U=c),!g){if(a&&a.C){a.C=!1;return}do{if(a===this._)break;if(a===c.L){if((b=c.R).C&&(b.C=!1,c.C=!0,cd(this,c),b=c.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,ce(this,b),b=c.R),b.C=c.C,c.C=b.R.C=!1,cd(this,c),a=this._;break}}else if((b=c.L).C&&(b.C=!1,c.C=!0,ce(this,c),b=c.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,cd(this,b),b=c.L),b.C=c.C,c.C=b.L.C=!1,ce(this,c),a=this._;break}b.C=!0,a=c,c=c.U}while(!a.C)a&&(a.C=!1)}}},b.geom.voronoi=function(b){var c=bK,d=bL,e=c,f=d,g=ci;if(b)return a(b);function a(a){var b=new Array(a.length),c=g[0][0],d=g[0][1],e=g[1][0],f=g[1][1];return cg(h(a),g).cells.forEach(function(h,i){var j=h.edges,g=h.site;(b[i]=j.length?j.map(function(b){var a=b.start();return[a.x,a.y]}):g.x>=c&&g.x<=e&&g.y>=d&&g.y<=f?[[c,f],[e,f],[e,d],[c,d]]:[]).point=a[i]}),b}function h(a){return a.map(function(b,a){return{x:1e-6*Math.round(e(b,a)/1e-6),y:1e-6*Math.round(f(b,a)/1e-6),i:a}})}return a.links=function(a){return cg(h(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},a.triangles=function(a){var b=[];return cg(h(a)).cells.forEach(function(i,f){for(var e,g=i.site,h=i.edges.sort(b3),j=-1,k=h.length,c=h[k-1].edge,d=c.l===g?c.r:c.l;++j<k;)e=d,d=(c=h[j].edge).l===g?c.r:c.l,f<e.i&&f<d.i&&0>cj(g,e,d)&&b.push([a[f],a[e.i],a[d.i]])}),b},a.x=function(b){return arguments.length?(e=X(c=b),a):c},a.y=function(b){return arguments.length?(f=X(d=b),a):d},a.clipExtent=function(b){return arguments.length?(g=null==b?ci:b,a):g===ci?null:g},a.size=function(b){return arguments.length?a.clipExtent(b&&[[0,0],b]):g===ci?null:g&&g[1]},a};var ci=[[-1e6,-1e6],[1e6,1e6]];function cj(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function ck(a){return a.x}function cl(a){return a.y}function cm(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function cn(b,i,c,d,e,f){if(!b(i,c,d,e,f)){var g=(c+e)*.5,h=(d+f)*.5,a=i.nodes;a[0]&&cn(b,a[0],c,d,g,h),a[1]&&cn(b,a[1],g,d,e,h),a[2]&&cn(b,a[2],c,h,g,f),a[3]&&cn(b,a[3],g,h,e,f)}}function _(a,c){a=b.rgb(a),c=b.rgb(c);var d=a.r,e=a.g,f=a.b,g=c.r-d,h=c.g-e,i=c.b-f;return function(a){return"#"+bs(Math.round(d+g*a))+bs(Math.round(e+h*a))+bs(Math.round(f+i*a))}}function aa(b,c){var a,e={},d={};for(a in b)a in c?e[a]=ae(b[a],c[a]):d[a]=b[a];for(a in c)a in b||(d[a]=c[a]);return function(b){for(a in e)d[a]=e[a](b);return d}}function ab(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function ac(i,d){var g,e,c,f=ad.lastIndex=co.lastIndex=0,a=-1,b=[],h=[];for(i+="",d+="";(g=ad.exec(i))&&(e=co.exec(d));)(c=e.index)>f&&(c=d.slice(f,c),b[a]?b[a]+=c:b[++a]=c),(g=g[0])===(e=e[0])?b[a]?b[a]+=e:b[++a]=e:(b[++a]=null,h.push({i:a,x:ab(g,e)})),f=co.lastIndex;return f<d.length&&(c=d.slice(f),b[a]?b[a]+=c:b[++a]=c),b.length<2?h[0]?(d=h[0].x,function(a){return d(a)+""}):function(){return d}:(d=h.length,function(e){for(var c,a=0;a<d;++a)b[(c=h[a]).i]=c.x(e);return b.join("")})}b.geom.delaunay=function(a){return b.geom.voronoi().triangles(a)},b.geom.quadtree=function(e,b,c,f,g){var d,h=bK,i=bL;if(d=arguments.length)return h=ck,i=cl,3===d&&(g=c,f=b,c=b=0),a(e);function a(n){var e,p,q,a,t,j,k,l,m,w=X(h),x=X(i);if(null!=b)j=b,k=c,l=f,m=g;else if(l=m=-(j=k=1/0),p=[],q=[],t=n.length,d)for(a=0;a<t;++a)(e=n[a]).x<j&&(j=e.x),e.y<k&&(k=e.y),e.x>l&&(l=e.x),e.y>m&&(m=e.y),p.push(e.x),q.push(e.y);else for(a=0;a<t;++a){var r=+w(e=n[a],a),s=+x(e,a);r<j&&(j=r),s<k&&(k=s),r>l&&(l=r),s>m&&(m=s),p.push(r),q.push(s)}var u=l-j,v=m-k;function y(a,d,b,c,e,f,g,h){if(!(isNaN(b)||isNaN(c)))if(a.leaf){var i=a.x,j=a.y;if(null!=i)if(ay(i-b)+ay(j-c)<.01)z(a,d,b,c,e,f,g,h);else{var k=a.point;a.x=a.y=a.point=null,z(a,k,i,j,e,f,g,h),z(a,d,b,c,e,f,g,h)}else a.x=b,a.y=c,a.point=d}else z(a,d,b,c,e,f,g,h)}function z(a,m,h,i,b,c,d,e){var f=(b+d)*.5,g=(c+e)*.5,j=h>=f,k=i>=g,l=k<<1|j;a.leaf=!1,a=a.nodes[l]||(a.nodes[l]=cm()),j?b=f:d=f,k?c=g:e=g,y(a,m,h,i,b,c,d,e)}u>v?m=k+u:l=j+v;var o=cm();if(o.add=function(b){y(o,b,+w(b,++a),+x(b,a),j,k,l,m)},o.visit=function(a){cn(a,o,j,k,l,m)},o.find=function(a){var b,g,h,c,d,e,f,i,n;return b=o,g=a[0],h=a[1],c=j,d=k,e=l,f=m,n=1/0,function l(a,m,o,p,q){if(!(m>e)&&!(o>f)&&!(p<c)&&!(q<d)){if(v=a.point){var v,s=g-a.x,t=h-a.y,u=s*s+t*t;if(u<n){var r=Math.sqrt(n=u);c=g-r,d=h-r,e=g+r,f=h+r,i=v}}for(var w=a.nodes,b=(m+p)*.5,j=(o+q)*.5,x=g>=b,y=h>=j,k=y<<1|x,z=k+4;k<z;++k)if(a=w[3&k])switch(3&k){case 0:l(a,m,o,b,j);break;case 1:l(a,b,o,p,j);break;case 2:l(a,m,j,b,q);break;case 3:l(a,b,j,p,q);break}}}(b,c,d,e,f),i},a=-1,null==b){for(;++a<t;)y(o,n[a],p[a],q[a],j,k,l,m);--a}else n.forEach(o.add);return p=q=n=e=null,o}return a.x=function(b){return arguments.length?(h=b,a):h},a.y=function(b){return arguments.length?(i=b,a):i},a.extent=function(d){return arguments.length?(null==d?b=c=f=g=null:(b=+d[0][0],c=+d[0][1],f=+d[1][0],g=+d[1][1]),a):null==b?null:[[b,c],[f,g]]},a.size=function(d){return arguments.length?(null==d?b=c=f=g=null:(b=c=0,f=+d[0],g=+d[1]),a):null==b?null:[f-b,g-c]},a},b.interpolateRgb=_,b.interpolateObject=aa,b.interpolateNumber=ab,b.interpolateString=ac;var ad=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,co=new RegExp(ad.source,"g");function ae(d,e){for(var a,c=b.interpolators.length;--c>=0&&!(a=b.interpolators[c](d,e)););return a}function af(b,c){var a,e=[],d=[],f=b.length,g=c.length,h=Math.min(b.length,c.length);for(a=0;a<h;++a)e.push(ae(b[a],c[a]));for(;a<f;++a)d[a]=b[a];for(;a<g;++a)d[a]=c[a];return function(b){for(a=0;a<h;++a)d[a]=e[a](b);return d}}b.interpolate=ae,b.interpolators=[function(c,a){var b=typeof a;return("string"===b?W.has(a.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(a)?_:ac:a instanceof g?_:Array.isArray(a)?af:"object"===b&&isNaN(a)?aa:ab)(c,a)}],b.interpolateArray=af;var ag=function(){return j},cp=b.map({linear:ag,poly:function(a){return function(b){return Math.pow(b,a)}},quad:function(){return ct},cubic:function(){return cu},sin:function(){return cw},exp:function(){return cx},circle:function(){return cy},elastic:function(b,a){var c;return arguments.length<2&&(a=.45),arguments.length?c=a/U*Math.asin(1/b):(b=1,c=a/4),function(d){return 1+b*Math.pow(2,-10*d)*Math.sin((d-c)*U/a)}},back:function(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}},bounce:function(){return cz}}),cq=b.map({"in":j,out:cr,"in-out":cs,"out-in":function(a){return cs(cr(a))}});function cr(a){return function(b){return 1-a(1-b)}}function cs(a){return function(b){return .5*(b<.5?a(2*b):2-a(2-2*b))}}function ct(a){return a*a}function cu(a){return a*a*a}function cv(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}function cw(a){return 1-Math.cos(a*ba)}function cx(a){return Math.pow(2,10*(a-1))}function cy(a){return 1-Math.sqrt(1-a*a)}function cz(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function ah(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function ai(b){var a=[b.a,b.b],c=[b.c,b.d],d=cB(a),e=cA(a,c),f=cB(cC(c,a,-e))||0;a[0]*c[1]<c[0]*a[1]&&(a[0]*=-1,a[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(a[1],a[0]):Math.atan2(-c[0],c[1]))*bb,this.translate=[b.e,b.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*bb:0}function cA(a,b){return a[0]*b[0]+a[1]*b[1]}function cB(a){var b=Math.sqrt(cA(a,a));return b&&(a[0]/=b,a[1]/=b),b}function cC(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}b.ease=function(a){var e,b=a.indexOf("-"),c=b>=0?a.slice(0,b):a,d=b>=0?a.slice(b+1):"in";return c=cp.get(c)||ag,e=(d=cq.get(d)||j)(c.apply(null,an.call(arguments,1))),function(a){return a<=0?0:a>=1?1:e(a)}},b.interpolateHcl=function(d,a){d=b.hcl(d),a=b.hcl(a);var e=d.h,f=d.c,h=d.l,c=a.h-e,g=a.c-f,i=a.l-h;return isNaN(g)&&(g=0,f=isNaN(f)?a.c:f),isNaN(c)?(c=0,e=isNaN(e)?a.h:e):c>180?c-=360:c< -180&&(c+=360),function(a){return bk(e+c*a,f+g*a,h+i*a)+""}},b.interpolateHsl=function(d,a){d=b.hsl(d),a=b.hsl(a);var e=d.h,f=d.s,h=d.l,c=a.h-e,g=a.s-f,i=a.l-h;return isNaN(g)&&(g=0,f=isNaN(f)?a.s:f),isNaN(c)?(c=0,e=isNaN(e)?a.h:e):c>180?c-=360:c< -180&&(c+=360),function(a){return bj(e+c*a,f+g*a,h+i*a)+""}},b.interpolateLab=function(a,c){a=b.lab(a),c=b.lab(c);var d=a.l,e=a.a,f=a.b,g=c.l-d,h=c.a-e,i=c.b-f;return function(a){return bm(d+g*a,e+h*a,f+i*a)+""}},b.interpolateRound=ah,b.transform=function(a){var c=h.createElementNS(b.ns.prefix.svg,"g");return(b.transform=function(a){if(null!=a){c.setAttribute("transform",a);var b=c.transform.baseVal.consolidate()}return new ai(b?b.matrix:cD)})(a)},ai.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var cD={a:1,b:0,c:0,d:1,e:0,f:0};function cE(a){return a.length?a.pop()+",":""}function aj(c,d){var e,a,f,l,k,g,h,m,i=[],j=[];return c=b.transform(c),d=b.transform(d),!function(b,a,c,e){if(b[0]!==a[0]||b[1]!==a[1]){var d=c.push("translate(",null,",",null,")");e.push({i:d-4,x:ab(b[0],a[0])},{i:d-2,x:ab(b[1],a[1])})}else(a[0]||a[1])&&c.push("translate("+a+")")}(c.translate,d.translate,i,j),e=c.rotate,a=d.rotate,f=i,l=j,e!==a?(e-a>180?a+=360:a-e>180&&(e+=360),l.push({i:f.push(cE(f)+"rotate(",null,")")-2,x:ab(e,a)})):a&&f.push(cE(f)+"rotate("+a+")"),k=c.skew,g=d.skew,h=i,m=j,k!==g?m.push({i:h.push(cE(h)+"skewX(",null,")")-2,x:ab(k,g)}):g&&h.push(cE(h)+"skewX("+g+")"),!function(b,a,c,e){if(b[0]!==a[0]||b[1]!==a[1]){var d=c.push(cE(c)+"scale(",null,",",null,")");e.push({i:d-4,x:ab(b[0],a[0])},{i:d-2,x:ab(b[1],a[1])})}else(1!==a[0]||1!==a[1])&&c.push(cE(c)+"scale("+a+")")}(c.scale,d.scale,i,j),c=d=null,function(c){for(var a,b=-1,d=j.length;++b<d;)i[(a=j[b]).i]=a.x(c);return i.join("")}}function cF(b,a){return a=(a-=b=+b)||1/a,function(c){return(c-b)/a}}function cG(b,a){return a=(a-=b=+b)||1/a,function(c){return Math.max(0,Math.min(1,(c-b)/a))}}function cH(d){for(var a=d.source,b=d.target,e=cJ(a,b),c=[a];a!==e;)a=a.parent,c.push(a);for(var f=c.length;b!==e;)c.splice(f,0,b),b=b.parent;return c}function cI(a){for(var c=[],b=a.parent;null!=b;)c.push(a),a=b,b=b.parent;return c.push(a),c}function cJ(a,c){if(a===c)return a;for(var d=cI(a),e=cI(c),b=d.pop(),f=e.pop(),g=null;b===f;)g=b,b=d.pop(),f=e.pop();return g}function cK(a){a.fixed|=2}function cL(a){a.fixed&=-7}function cM(a){a.fixed|=4,a.px=a.x,a.py=a.y}function cN(a){a.fixed&=-5}function cO(a,f,g){var c=0,d=0;if(a.charge=0,!a.leaf)for(var b,h=a.nodes,j=h.length,i=-1;++i<j;)null!=(b=h[i])&&(cO(b,f,g),a.charge+=b.charge,c+=b.charge*b.cx,d+=b.charge*b.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var e=f*g[a.point.index];a.charge+=a.pointCharge=e,c+=e*a.point.x,d+=e*a.point.y}a.cx=c/a.charge,a.cy=d/a.charge}b.interpolateTransform=aj,b.layout={},b.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(cH(a[c]));return b}},b.layout.chord=function(){var c,d,e,f,g,h,i,a={},j=0;function k(){var o,k,u,a,m,r={},v=[],w=b.range(f),s=[];for(c=[],d=[],o=0,a=-1;++a<f;){for(k=0,m=-1;++m<f;)k+=e[a][m];v.push(k),s.push(b.range(f)),o+=k}for(g&&w.sort(function(a,b){return g(v[a],v[b])}),h&&s.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),o=(U-j*f)/o,k=0,a=-1;++a<f;){for(u=k,m=-1;++m<f;){var n=w[a],t=s[n][m],x=e[n][t],y=k,z=k+=x*o;r[n+"-"+t]={index:n,subindex:t,startAngle:y,endAngle:z,value:x}}d[n]={index:n,startAngle:u,endAngle:k,value:v[n]},k+=j}for(a=-1;++a<f;)for(m=a-1;++m<f;){var p=r[a+"-"+m],q=r[m+"-"+a];(p.value||q.value)&&c.push(p.value<q.value?{source:q,target:p}:{source:p,target:q})}i&&l()}function l(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}return a.matrix=function(b){return arguments.length?(f=(e=b)&&e.length,c=d=null,a):e},a.padding=function(b){return arguments.length?(j=b,c=d=null,a):j},a.sortGroups=function(b){return arguments.length?(g=b,c=d=null,a):g},a.sortSubgroups=function(b){return arguments.length?(h=b,c=null,a):h},a.sortChords=function(b){return arguments.length?(i=b,c&&l(),a):i},a.chords=function(){return c||k(),c},a.groups=function(){return d||k(),d},a},b.layout.force=function(){var d,e,f,g,h,i,a={},c=b.dispatch("start","tick","end"),k=[1,1],l=.9,m=cP,n=cQ,o=-30,p=cR,q=.1,r=.64,s=[],t=[];function u(a){return function(b,h,j,i){if(b.point!==a){var e=b.cx-a.x,f=b.cy-a.y,g=i-h,c=e*e+f*f;if(g*g/r<c){if(c<p){var d=b.charge/c;a.px-=e*d,a.py-=f*d}return!0}if(b.point&&c&&c<p){var d=b.pointCharge/c;a.px-=e*d,a.py-=f*d}}return!b.charge}}function v(c){c.px=b.event.x,c.py=b.event.y,a.resume()}return a.tick=function(){if((f*=.99)<.005)return d=null,c.end({type:"end",alpha:f=0}),!0;var x,e,a,m,r,v,j,n,p,w=s.length,y=t.length;for(e=0;e<y;++e)m=(a=t[e]).source,r=a.target,n=r.x-m.x,p=r.y-m.y,(v=n*n+p*p)&&(n*=v=f*h[e]*((v=Math.sqrt(v))-g[e])/v,p*=v,r.x-=n*(j=m.weight+r.weight?m.weight/(m.weight+r.weight):.5),r.y-=p*j,m.x+=n*(j=1-j),m.y+=p*j);if((j=f*q)&&(n=k[0]/2,p=k[1]/2,e=-1,j))for(;++e<w;)a=s[e],a.x+=(n-a.x)*j,a.y+=(p-a.y)*j;if(o)for(cO(x=b.geom.quadtree(s),f,i),e=-1;++e<w;)(a=s[e]).fixed||x.visit(u(a));for(e=-1;++e<w;)(a=s[e]).fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*l,a.y-=(a.py-(a.py=a.y))*l);c.tick({type:"tick",alpha:f})},a.nodes=function(b){return arguments.length?(s=b,a):s},a.links=function(b){return arguments.length?(t=b,a):t},a.size=function(b){return arguments.length?(k=b,a):k},a.linkDistance=function(b){return arguments.length?(m="function"==typeof b?b:+b,a):m},a.distance=a.linkDistance,a.linkStrength=function(b){return arguments.length?(n="function"==typeof b?b:+b,a):n},a.friction=function(b){return arguments.length?(l=+b,a):l},a.charge=function(b){return arguments.length?(o="function"==typeof b?b:+b,a):o},a.chargeDistance=function(b){return arguments.length?(p=b*b,a):Math.sqrt(p)},a.gravity=function(b){return arguments.length?(q=+b,a):q},a.theta=function(b){return arguments.length?(r=b*b,a):Math.sqrt(r)},a.alpha=function(b){return arguments.length?(b=+b,f?b>0?f=b:(d.c=null,d.t=NaN,d=null,c.end({type:"end",alpha:f=0})):b>0&&(c.start({type:"start",alpha:f=b}),d=bG(a.tick)),a):f},a.start=function(){var b,l,c,e=s.length,d=t.length,f=k[0],j=k[1];for(b=0;b<e;++b)(c=s[b]).index=b,c.weight=0;for(b=0;b<d;++b)"number"==typeof(c=t[b]).source&&(c.source=s[c.source]),"number"==typeof c.target&&(c.target=s[c.target]),++c.source.weight,++c.target.weight;for(b=0;b<e;++b)isNaN((c=s[b]).x)&&(c.x=p("x",f)),isNaN(c.y)&&(c.y=p("y",j)),isNaN(c.px)&&(c.px=c.x),isNaN(c.py)&&(c.py=c.y);if(g=[],"function"==typeof m)for(b=0;b<d;++b)g[b]=+m.call(this,t[b],b);else for(b=0;b<d;++b)g[b]=m;if(h=[],"function"==typeof n)for(b=0;b<d;++b)h[b]=+n.call(this,t[b],b);else for(b=0;b<d;++b)h[b]=n;if(i=[],"function"==typeof o)for(b=0;b<e;++b)i[b]=+o.call(this,s[b],b);else for(b=0;b<e;++b)i[b]=o;function p(h,i){if(!l){for(g=0,l=new Array(e);g<e;++g)l[g]=[];for(g=0;g<d;++g){var a=t[g];l[a.source.index].push(a.target),l[a.target.index].push(a.source)}}for(var c,f=l[b],g=-1,j=f.length;++g<j;)if(!isNaN(c=f[g][h]))return c;return Math.random()*i}return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){if(e||(e=b.behavior.drag().origin(j).on("dragstart.force",cK).on("drag.force",v).on("dragend.force",cL)),!arguments.length)return e;this.on("mouseover.force",cM).on("mouseout.force",cN).call(e)},b.rebind(a,c,"on")};var cP=20,cQ=1,cR=1/0;function cS(a,c){return b.rebind(a,c,"sort","children","value"),a.nodes=a,a.links=cY,a}function cT(a,e){for(var b,c,d=[a];null!=(a=d.pop());)if(e(a),(c=a.children)&&(b=c.length))for(;--b>=0;)d.push(c[b])}function cU(a,e){for(var b=[a],c=[];null!=(a=b.pop());)if(c.push(a),(g=a.children)&&(f=g.length))for(var f,g,d=-1;++d<f;)b.push(g[d]);for(;null!=(a=c.pop());)e(a)}function cV(a){return a.children}function cW(a){return a.value}function cX(a,b){return b.value-a.value}function cY(a){return b.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}b.layout.hierarchy=function(){var b=cX,c=cV,d=cW;function a(g){var h,f,i,e,j=[g],k=[];for(g.depth=0;null!=(e=j.pop());)if(k.push(e),(f=c.call(a,e,e.depth))&&(h=f.length)){for(;--h>=0;)j.push(i=f[h]),i.parent=e,i.depth=e.depth+1;d&&(e.value=0),e.children=f}else d&&(e.value=+d.call(a,e,e.depth)||0),delete e.children;return cU(g,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),k}return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(cT(b,function(a){a.children&&(a.value=0)}),cU(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},b.layout.partition=function(){var c=b.layout.hierarchy(),d=[1,1];function e(a,c,b,d){var f=a.children;if(a.x=c,a.y=a.depth*d,a.dx=b,a.dy=d,f&&(j=f.length)){var j,g,h,i=-1;for(b=a.value?b/a.value:0;++i<j;)e(g=f[i],c,h=g.value*b,d),c+=h}}function f(d){var a=d.children,b=0;if(a&&(e=a.length))for(var e,c=-1;++c<e;)b=Math.max(b,f(a[c]));return 1+b}function a(b,g){var a=c.call(this,b,g);return e(a[0],0,d[0],d[1]/f(a[0])),a}return a.size=function(b){return arguments.length?(d=b,a):d},cS(a,c)},b.layout.pie=function(){var c=Number,d=cZ,e=0,f=U,g=0;function a(j){var r,h=j.length,m=j.map(function(b,d){return+c.call(a,b,d)}),n=+("function"==typeof e?e.apply(this,arguments):e),i=("function"==typeof f?f.apply(this,arguments):f)-n,o=Math.min(Math.abs(i)/h,+("function"==typeof g?g.apply(this,arguments):g)),p=o*(i<0?-1:1),k=b.sum(m),s=k?(i-h*p)/k:0,l=b.range(h),q=[];return null!=d&&l.sort(d===cZ?function(a,b){return m[b]-m[a]}:function(a,b){return d(j[a],j[b])}),l.forEach(function(a){q[a]={data:j[a],value:r=m[a],startAngle:n,endAngle:n+=r*s+p,padAngle:o}}),q}return a.value=function(b){return arguments.length?(c=b,a):c},a.sort=function(b){return arguments.length?(d=b,a):d},a.startAngle=function(b){return arguments.length?(e=b,a):e},a.endAngle=function(b){return arguments.length?(f=b,a):f},a.padAngle=function(b){return arguments.length?(g=b,a):g},a};var cZ={};function c$(a){return a.x}function c_(a){return a.y}function c0(a,b,c){a.y0=b,a.y=c}b.layout.stack=function(){var c=j,d=c3,e=c4,f=c0,g=c$,h=c_;function a(m,n){if(!(q=m.length))return m;var k=m.map(function(b,d){return c.call(a,b,d)}),j=k.map(function(b){return b.map(function(b,c){return[g.call(a,b,c),h.call(a,b,c)]})}),o=d.call(a,j,n);k=b.permute(k,o),j=b.permute(j,o);var q,l,i,p,r=e.call(a,j,n),s=k[0].length;for(i=0;i<s;++i)for(f.call(a,k[0][i],p=r[i],j[0][i][1]),l=1;l<q;++l)f.call(a,k[l][i],p+=j[l-1][i][1],j[l][i][1]);return m}return a.values=function(b){return arguments.length?(c=b,a):c},a.order=function(b){return arguments.length?(d="function"==typeof b?b:c1.get(b)||c3,a):d},a.offset=function(b){return arguments.length?(e="function"==typeof b?b:c2.get(b)||c4,a):e},a.x=function(b){return arguments.length?(g=b,a):g},a.y=function(b){return arguments.length?(h=b,a):h},a.out=function(b){return arguments.length?(f=b,a):f},a};var c1=b.map({"inside-out":function(d){var c,a,e=d.length,l=d.map(c5),f=d.map(c6),k=b.range(e).sort(function(a,b){return l[a]-l[b]}),g=0,h=0,i=[],j=[];for(c=0;c<e;++c)a=k[c],g<h?(g+=f[a],i.push(a)):(h+=f[a],j.push(a));return j.reverse().concat(i)},reverse:function(a){return b.range(a.length).reverse()},"default":c3}),c2=b.map({silhouette:function(d){var c,a,b,i=d.length,f=d[0].length,g=[],e=0,h=[];for(a=0;a<f;++a){for(c=0,b=0;c<i;c++)b+=d[c][a][1];b>e&&(e=b),g.push(b)}for(a=0;a<f;++a)h[a]=(e-g[a])/2;return h},wiggle:function(c){var b,a,d,e,j,k,f,g,h,m=c.length,l=c[0],n=l.length,i=[];for(a=1,i[0]=g=h=0;a<n;++a){for(b=0,e=0;b<m;++b)e+=c[b][a][1];for(b=0,j=0,f=l[a][0]-l[a-1][0];b<m;++b){for(d=0,k=(c[b][a][1]-c[b][a-1][1])/(2*f);d<b;++d)k+=(c[d][a][1]-c[d][a-1][1])/f;j+=k*c[b][a][1]}i[a]=g-=e?j/e*f:0,g<h&&(h=g)}for(a=0;a<n;++a)i[a]-=h;return i},expand:function(c){var a,b,d,e=c.length,f=c[0].length,h=1/e,g=[];for(b=0;b<f;++b){for(a=0,d=0;a<e;a++)d+=c[a][b][1];if(d)for(a=0;a<e;a++)c[a][b][1]/=d;else for(a=0;a<e;a++)c[a][b][1]=h}for(b=0;b<f;++b)g[b]=0;return g},zero:c4});function c3(a){return b.range(a.length)}function c4(c){for(var a=-1,d=c[0].length,b=[];++a<d;)b[a]=0;return b}function c5(b){for(var c,a=1,d=0,e=b[0][1],f=b.length;a<f;++a)(c=b[a][1])>e&&(d=a,e=c);return d}function c6(a){return a.reduce(c7,0)}function c7(a,b){return a+b[1]}function c8(a,b){return c9(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function c9(b,c){for(var a=-1,d=+b[0],f=(b[1]-d)/c,e=[];++a<=c;)e[a]=f*a+d;return e}function da(a){return[b.min(a),b.max(a)]}function db(a,b){return a.value-b.value}function dc(b,a){var c=b._pack_next;b._pack_next=a,a._pack_prev=b,a._pack_next=c,c._pack_prev=a}function dd(a,b){a._pack_next=b,b._pack_prev=a}function de(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return .999*e*e>c*c+d*d}function df(m){if((e=m.children)&&(h=e.length)){var e,b,c,a,d,f,g,h,n=1/0,o=-1/0,p=1/0,q=-1/0;if(e.forEach(dg),(b=e[0]).x=-b.r,b.y=0,t(b),h>1&&((c=e[1]).x=c.r,c.y=0,t(c),h>2))for(dj(b,c,a=e[2]),t(a),dc(b,a),b._pack_prev=a,dc(a,c),c=b._pack_next,d=3;d<h;d++){dj(b,c,a=e[d]);var i=0,j=1,k=1;for(f=c._pack_next;f!==c;f=f._pack_next,j++)if(de(f,a)){i=1;break}if(1==i)for(g=b._pack_prev;g!==f._pack_prev&&!de(g,a);g=g._pack_prev,k++);i?(j<k||j==k&&c.r<b.r?dd(b,c=f):dd(b=g,c),d--):(dc(b,a),c=a,t(a))}var r=(n+o)/2,s=(p+q)/2,l=0;for(d=0;d<h;d++)a=e[d],a.x-=r,a.y-=s,l=Math.max(l,a.r+Math.sqrt(a.x*a.x+a.y*a.y));m.r=l,e.forEach(dh)}function t(a){n=Math.min(a.x-a.r,n),o=Math.max(a.x+a.r,o),p=Math.min(a.y-a.r,p),q=Math.max(a.y+a.r,q)}}function dg(a){a._pack_next=a._pack_prev=a}function dh(a){delete a._pack_next,delete a._pack_prev}function di(a,d,e,b){var c=a.children;if(a.x=d+=b*a.x,a.y=e+=b*a.y,a.r*=b,c)for(var f=-1,g=c.length;++f<g;)di(c[f],d,e,b)}function dj(b,h,c){var a=b.r+c.r,e=h.x-b.x,f=h.y-b.y;if(a&&(e||f)){var d=h.r+c.r,g=e*e+f*f;d*=d,a*=a;var i=.5+(a-d)/(2*g),j=Math.sqrt(Math.max(0,2*d*(a+g)-(a-=g)*a-d*d))/(2*g);c.x=b.x+i*e+j*f,c.y=b.y+i*f-j*e}else c.x=b.x+a,c.y=b.y}function dk(a,b){return a.parent==b.parent?1:2}function dl(a){var b=a.children;return b.length?b[0]:a.t}function dm(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function dn(c,a,b){var d=b/(a.i-c.i);a.c-=d,a.s+=b,c.c+=d,a.z+=b,a.m+=b}function dp(a,b,c){return a.a.parent===b.parent?a.a:c}function dq(b){var a=b.children;return a&&a.length?dq(a[0]):b}function dr(b){var c,a=b.children;return a&&(c=a.length)?dr(a[c-1]):b}function ds(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function dt(b,a){var e=b.x+a[3],f=b.y+a[0],c=b.dx-a[1]-a[3],d=b.dy-a[0]-a[2];return c<0&&(e+=c/2,c=0),d<0&&(f+=d/2,d=0),{x:e,y:f,dx:c,dy:d}}function du(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function dv(a){return a.rangeExtent?a.rangeExtent():du(a.range())}function dw(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function dx(a,g){var b,c=0,d=a.length-1,e=a[c],f=a[d];return f<e&&(b=c,c=d,d=b,b=e,e=f,f=b),a[c]=g.floor(e),a[d]=g.ceil(f),a}function dy(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:dz}b.layout.histogram=function(){var c=!0,d=Number,e=da,f=c8;function a(n,a){for(var g,j,k=[],h=n.map(d,this),l=e.call(this,h,a),i=f.call(this,l,h,a),a=-1,o=h.length,m=i.length-1,p=c?1:1/o;++a<m;)(g=k[a]=[]).dx=i[a+1]-(g.x=i[a]),g.y=0;if(m>0)for(a=-1;++a<o;)(j=h[a])>=l[0]&&j<=l[1]&&(g=k[b.bisect(i,j,1,m)-1],g.y+=p,g.push(n[a]));return k}return a.value=function(b){return arguments.length?(d=b,a):d},a.range=function(b){return arguments.length?(e=X(b),a):e},a.bins=function(b){return arguments.length?(f="number"==typeof b?function(a){return c9(a,b)}:X(b),a):f},a.frequency=function(b){return arguments.length?(c=!!b,a):c},a},b.layout.pack=function(){var d,c=b.layout.hierarchy().sort(db),e=0,f=[1,1];function a(i,j){var h=c.call(this,i,j),a=h[0],b=f[0],g=f[1],k=null==d?Math.sqrt:"function"==typeof d?d:function(){return d};if(a.x=a.y=0,cU(a,function(a){a.r=+k(a.value)}),cU(a,df),e){var l=e*(d?1:Math.max(2*a.r/b,2*a.r/g))/2;cU(a,function(a){a.r+=l}),cU(a,df),cU(a,function(a){a.r-=l})}return di(a,b/2,g/2,d?1:1/Math.max(2*a.r/b,2*a.r/g)),h}return a.size=function(b){return arguments.length?(f=b,a):f},a.radius=function(b){return arguments.length?(d=null==b||"function"==typeof b?b:+b,a):d},a.padding=function(b){return arguments.length?(e=+b,a):e},cS(a,c)},b.layout.tree=function(){var c=b.layout.hierarchy().sort(null).value(null),d=dk,e=[1,1],f=null;function a(n,o){var m=c.call(this,n,o),a=m[0],b=g(a);if(cU(b,h),b.parent.m=-b.z,cT(b,i),f)cT(a,k);else{var j=a,l=a,p=a;cT(a,function(a){a.x<j.x&&(j=a),a.x>l.x&&(l=a),a.depth>p.depth&&(p=a)});var q=d(j,l)/2-j.x,r=e[0]/(l.x+d(l,j)/2+q),s=e[1]/(p.depth||1);cT(a,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return m}function g(g){for(var d,e={A:null,children:[g]},f=[e];null!=(d=f.pop());)for(var b,c=d.children,a=0,h=c.length;a<h;++a)f.push((c[a]=b={_:c[a],parent:d,children:(b=c[a].children)&&b.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=b);return e.children[0]}function h(a){var c=a.children,e=a.parent.children,b=a.i?e[a.i-1]:null;if(c.length){(function(e){for(var a,b=0,f=0,c=e.children,d=c.length;--d>=0;)a=c[d],a.z+=b,a.m+=b,b+=a.s+(f+=a.c)})(a);var f=(c[0].z+c[c.length-1].z)/2;b?(a.z=b.z+d(a._,b._),a.m=a.z-f):a.z=f}else b&&(a.z=b.z+d(a._,b._));a.parent.A=j(a,b,a.parent.A||e[0])}function i(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function j(f,l,i){if(l){for(var g,a=f,c=f,b=l,e=a.parent.children[0],h=a.m,j=c.m,k=b.m,m=e.m;b=dm(b),a=dl(a),b&&a;)e=dl(e),(c=dm(c)).a=f,(g=b.z+k-a.z-h+d(b._,a._))>0&&(dn(dp(b,f,i),f,g),h+=g,j+=g),k+=b.m,h+=a.m,m+=e.m,j+=c.m;b&&!dm(c)&&(c.t=b,c.m+=k-j),a&&!dl(e)&&(e.t=a,e.m+=h-m,i=f)}return i}function k(a){a.x*=e[0],a.y=a.depth*e[1]}return a.separation=function(b){return arguments.length?(d=b,a):d},a.size=function(b){return arguments.length?(f=null==(e=b)?k:null,a):f?null:e},a.nodeSize=function(b){return arguments.length?(f=null==(e=b)?null:k,a):f?e:null},cS(a,c)},b.layout.cluster=function(){var c=b.layout.hierarchy().sort(null).value(null),d=dk,e=[1,1],f=!1;function a(j,k){var l,i=c.call(this,j,k),a=i[0],m=0;cU(a,function(a){var e,f,c=a.children;c&&c.length?(a.x=(e=c).reduce(function(a,b){return a+b.x},0)/e.length,a.y=(f=c,1+b.max(f,function(a){return a.y}))):(a.x=l?m+=d(a,l):0,a.y=0,l=a)});var g=dq(a),h=dr(a),n=g.x-d(g,h)/2,o=h.x+d(h,g)/2;return cU(a,f?function(b){b.x=(b.x-a.x)*e[0],b.y=(a.y-b.y)*e[1]}:function(b){b.x=(b.x-n)/(o-n)*e[0],b.y=(1-(a.y?b.y/a.y:1))*e[1]}),i}return a.separation=function(b){return arguments.length?(d=b,a):d},a.size=function(b){return arguments.length?(f=null==(e=b),a):f?null:e},a.nodeSize=function(b){return arguments.length?(f=null!=(e=b),a):f?e:null},cS(a,c)},b.layout.treemap=function(){var d,c=b.layout.hierarchy(),e=Math.round,f=[1,1],g=null,h=ds,i=!1,j="squarify",k=.5*(1+Math.sqrt(5));function l(b,c){for(var d,a,e=-1,f=b.length;++e<f;)a=(d=b[e]).value*(c<0?0:c),d.area=isNaN(a)||a<=0?0:a}function m(c){var d=c.children;if(d&&d.length){var i,k,n,b=h(c),a=[],e=d.slice(),g=1/0,f="slice"===j?b.dx:"dice"===j?b.dy:"slice-dice"===j?1&c.depth?b.dy:b.dx:Math.min(b.dx,b.dy);for(l(e,b.dx*b.dy/c.value),a.area=0;(n=e.length)>0;)a.push(i=e[n-1]),a.area+=i.area,"squarify"!==j||(k=o(a,f))<=g?(e.pop(),g=k):(a.area-=a.pop().area,p(a,f,b,!1),f=Math.min(b.dx,b.dy),a.length=a.area=0,g=1/0);a.length&&(p(a,f,b,!0),a.length=a.area=0),d.forEach(m)}}function n(e){var d=e.children;if(d&&d.length){var b,c=h(e),f=d.slice(),a=[];for(l(f,c.dx*c.dy/e.value),a.area=0;b=f.pop();)a.push(b),a.area+=b.area,null!=b.z&&(p(a,b.z?c.dx:c.dy,c,!f.length),a.length=a.area=0);d.forEach(n)}}function o(d,c){for(var a,b=d.area,e=0,f=1/0,g=-1,h=d.length;++g<h;)(a=d[g].area)&&(a<f&&(f=a),a>e&&(e=a));return b*=b,c*=c,b?Math.max(c*e*k/b,b/(c*f*k)):1/0}function p(g,i,a,j){var b,h=-1,k=g.length,d=a.x,f=a.y,c=i?e(g.area/i):0;if(i==a.dx){for((j||c>a.dy)&&(c=a.dy);++h<k;)(b=g[h]).x=d,b.y=f,b.dy=c,d+=b.dx=Math.min(a.x+a.dx-d,c?e(b.area/c):0);b.z=!0,b.dx+=a.x+a.dx-d,a.y+=c,a.dy-=c}else{for((j||c>a.dx)&&(c=a.dx);++h<k;)(b=g[h]).x=d,b.y=f,b.dx=c,f+=b.dy=Math.min(a.y+a.dy-f,c?e(b.area/c):0);b.z=!1,b.dy+=a.y+a.dy-f,a.x+=c,a.dx-=c}}function a(e){var b=d||c(e),a=b[0];return a.x=a.y=0,a.value?(a.dx=f[0],a.dy=f[1]):a.dx=a.dy=0,d&&c.revalue(a),l([a],a.dx*a.dy/a.value),(d?n:m)(a),i&&(d=b),b}return a.size=function(b){return arguments.length?(f=b,a):f},a.padding=function(b){var c;return arguments.length?(h=null==(g=b)?ds:"function"==(c=typeof b)?function(d){var c=b.call(a,d,d.depth);return null==c?ds(d):dt(d,"number"==typeof c?[c,c,c,c]:c)}:("number"===c&&(b=[b,b,b,b]),function(a){return dt(a,b)}),a):g},a.round=function(b){return arguments.length?(e=b?Math.round:Number,a):e!=Number},a.sticky=function(b){return arguments.length?(i=b,d=null,a):i},a.ratio=function(b){return arguments.length?(k=b,a):k},a.mode=function(b){return arguments.length?(j=b+"",a):j},cS(a,c)},b.random={normal:function(b,c){var a=arguments.length;return a<2&&(c=1),a<1&&(b=0),function(){var d,e,a;do d=2*Math.random()-1,e=2*Math.random()-1,a=d*d+e*e;while(!a||a>1)return b+c*d*Math.sqrt(-2*Math.log(a)/a)}},logNormal:function(){var a=b.random.normal.apply(b,arguments);return function(){return Math.exp(a())}},bates:function(a){var c=b.random.irwinHall(a);return function(){return c()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;c<a;c++)b+=Math.random();return b}}},b.scale={};var dz={floor:j,ceil:j};function dA(a,c,f,g){var h=[],i=[],d=0,e=Math.min(a.length,c.length)-1;for(a[e]<a[0]&&(a=a.slice().reverse(),c=c.slice().reverse());++d<=e;)h.push(f(a[d-1],a[d])),i.push(g(c[d-1],c[d]));return function(c){var d=b.bisect(a,c,1,e)-1;return i[d](h[d](c))}}function dB(c,d,e,f){var g,h;function b(){var b=Math.min(c.length,d.length)>2?dA:dw,i=f?cG:cF;return g=b(c,d,i,e),h=b(d,c,i,ae),a}function a(a){return g(a)}return a.invert=function(a){return h(a)},a.domain=function(a){return arguments.length?(c=a.map(Number),b()):c},a.range=function(a){return arguments.length?(d=a,b()):d},a.rangeRound=function(b){return a.range(b).interpolate(ah)},a.clamp=function(a){return arguments.length?(f=a,b()):f},a.interpolate=function(a){return arguments.length?(e=a,b()):e},a.ticks=function(a){return dF(c,a)},a.tickFormat=function(a,b){return d3_scale_linearTickFormat(c,a,b)},a.nice=function(a){return dD(c,a),b()},a.copy=function(){return dB(c,d,e,f)},b()}function dC(a,c){return b.rebind(a,c,"range","rangeRound","interpolate","clamp")}function dD(a,b){return dx(a,dy(dE(a,b)[2])),dx(a,dy(dE(a,b)[2])),a}function dE(f,c){null==c&&(c=10);var b=du(f),e=b[1]-b[0],a=Math.pow(10,Math.floor(Math.log(e/c)/Math.LN10)),d=c/e*a;return d<=.15?a*=10:d<=.35?a*=5:d<=.75&&(a*=2),b[0]=Math.ceil(b[0]/a)*a,b[1]=Math.floor(b[1]/a)*a+.5*a,b[2]=a,b}function dF(a,c){return b.range.apply(b,dE(a,c))}function dG(b,c,d,e){function f(a){return(d?Math.log(a<0?0:a):-Math.log(a>0?0:-a))/Math.log(c)}function g(a){return d?Math.pow(c,a):-Math.pow(c,-a)}function a(a){return b(f(a))}return a.invert=function(a){return g(b.invert(a))},a.domain=function(c){return arguments.length?(d=c[0]>=0,b.domain((e=c.map(Number)).map(f)),a):e},a.base=function(d){return arguments.length?(c=+d,b.domain(e.map(f)),a):c},a.nice=function(){var c=dx(e.map(f),d?Math:dH);return b.domain(c),e=c.map(g),a},a.ticks=function(){var j=du(e),b=[],k=j[0],l=j[1],a=Math.floor(f(k)),h=Math.ceil(f(l)),m=c%1?2:c;if(isFinite(h-a)){if(d){for(;a<h;a++)for(var i=1;i<m;i++)b.push(g(a)*i);b.push(g(a))}else for(b.push(g(a));(a++)<h;)for(var i=m-1;i>0;i--)b.push(g(a)*i);for(a=0;b[a]<k;a++);for(h=b.length;b[h-1]>l;h--);b=b.slice(a,h)}return b},a.copy=function(){return dG(b.copy(),c,d,e)},dC(a,b)}b.scale.linear=function(){return dB([0,1],[0,1],ae,!1)},b.scale.log=function(){return dG(b.scale.linear().domain([0,1]),10,!0,[1,10])};var dH={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};function dI(c,b,d){var e=dJ(b),f=dJ(1/b);function a(a){return c(e(a))}return a.invert=function(a){return f(c.invert(a))},a.domain=function(b){return arguments.length?(c.domain((d=b.map(Number)).map(e)),a):d},a.ticks=function(a){return dF(d,a)},a.tickFormat=function(a,b){return d3_scale_linearTickFormat(d,a,b)},a.nice=function(b){return a.domain(dD(d,b))},a.exponent=function(g){return arguments.length?(e=dJ(b=g),f=dJ(1/b),c.domain(d.map(e)),a):b},a.copy=function(){return dI(c.copy(),b,d)},dC(a,c)}function dJ(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function dK(c,d){var e,f,g;function a(a){return f[((e.get(a)||("range"===d.t?e.set(a,c.push(a)):NaN))-1)%f.length]}function h(a,d){return b.range(c.length).map(function(b){return a+d*b})}return a.domain=function(f){if(!arguments.length)return c;c=[],e=new J;for(var b,g=-1,h=f.length;++g<h;)e.has(b=f[g])||e.set(b,c.push(b));return a[d.t].apply(a,d.a)},a.range=function(b){return arguments.length?(f=b,g=0,d={t:"range",a:arguments},a):f},a.rangePoints=function(i,e){arguments.length<2&&(e=0);var b=i[0],j=i[1],k=c.length<2?(b=(b+j)/2,0):(j-b)/(c.length-1+e);return f=h(b+k*e/2,k),g=0,d={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(k,e){arguments.length<2&&(e=0);var b=k[0],i=k[1],j=c.length<2?(b=i=Math.round((b+i)/2),0):(i-b)/(c.length-1+e)|0;return f=h(b+Math.round(j*e/2+(i-b-(c.length-1+e)*j)/2),j),g=0,d={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(b,e,i){arguments.length<2&&(e=0),arguments.length<3&&(i=e);var j=b[1]<b[0],l=b[j-0],k=(b[1-j]-l)/(c.length-e+2*i);return f=h(l+k*i,k),j&&f.reverse(),g=k*(1-e),d={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(e,b,l){arguments.length<2&&(b=0),arguments.length<3&&(l=b);var i=e[1]<e[0],j=e[i-0],m=e[1-i],k=Math.floor((m-j)/(c.length-b+2*l));return f=h(j+Math.round((m-j-(c.length-b)*k)/2),k),i&&f.reverse(),g=Math.round(k*(1-b)),d={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return g},a.rangeExtent=function(){return du(d.a[0])},a.copy=function(){return dK(c,d)},a.domain(c)}b.scale.pow=function(){return dI(b.scale.linear(),1,[0,1])},b.scale.sqrt=function(){return b.scale.pow().exponent(.5)},b.scale.ordinal=function(){return dK([],{t:"range",a:[[]]})},b.scale.category10=function(){return b.scale.ordinal().range(dL)},b.scale.category20=function(){return b.scale.ordinal().range(dM)},b.scale.category20b=function(){return b.scale.ordinal().range(dN)},b.scale.category20c=function(){return b.scale.ordinal().range(dO)};var dL=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(l),dM=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(l),dN=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(l),dO=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(l);function dP(d,e){var f;function c(){var c=0,g=e.length;for(f=[];++c<g;)f[c-1]=b.quantile(d,c/g);return a}function a(a){if(!isNaN(a=+a))return e[b.bisect(f,a)]}return a.domain=function(a){return arguments.length?(d=a.map(av).filter(aw).sort(u),c()):d},a.range=function(a){return arguments.length?(e=a,c()):e},a.quantiles=function(){return f},a.invertExtent=function(a){return(a=e.indexOf(a))<0?[NaN,NaN]:[a>0?f[a-1]:d[0],a<f.length?f[a]:d[d.length-1]]},a.copy=function(){return dP(d,e)},c()}function dQ(c,d,e){var f,g;function a(a){return e[Math.max(0,Math.min(g,Math.floor(f*(a-c))))]}function b(){return f=e.length/(d-c),g=e.length-1,a}return a.domain=function(a){return arguments.length?(c=+a[0],d=+a[a.length-1],b()):[c,d]},a.range=function(a){return arguments.length?(e=a,b()):e},a.invertExtent=function(a){return[a=(a=e.indexOf(a))<0?NaN:a/f+c,a+1/f]},a.copy=function(){return dQ(c,d,e)},b()}function dR(c,d){function a(a){if(a<=a)return d[b.bisect(c,a)]}return a.domain=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=b,a):d},a.invertExtent=function(a){return[c[(a=d.indexOf(a))-1],c[a]]},a.copy=function(){return dR(c,d)},a}function dS(b){function a(a){return+a}return a.invert=a,a.domain=a.range=function(c){return arguments.length?(b=c.map(a),a):b},a.ticks=function(a){return dF(b,a)},a.tickFormat=function(a,c){return d3_scale_linearTickFormat(b,a,c)},a.copy=function(){return dS(b)},a}b.scale.quantile=function(){return dP([],[])},b.scale.quantize=function(){return dQ(0,1,[0,1])},b.scale.threshold=function(){return dR([.5],[0,1])},b.scale.identity=function(){return dS([0,1])},b.svg={},b.svg.arc=function(){var b=dU,c=dV,d=function(){return 0},e=dT,f=dW,g=dX,h=dY;function a(){var a=Math.max(0,+b.apply(this,arguments)),j=Math.max(0,+c.apply(this,arguments)),t=f.apply(this,arguments)-ba,u=g.apply(this,arguments)-ba,I=Math.abs(u-t),l=t>u?0:1;if(j<a&&(A=j,j=a,a=A),I>=a9)return i(j,l)+(a?i(a,1-l):"")+"Z";var A,B,J,K,m,n,o,x,q,r,s,C,D=0,y=0,p=[];if((K=(+h.apply(this,arguments)||0)/2)&&(J=e===dT?Math.sqrt(a*a+j*j):+e.apply(this,arguments),l||(y*=-1),j&&(y=bd(J/j*Math.sin(K))),a&&(D=bd(J/a*Math.sin(K)))),j){m=j*Math.cos(t+y),n=j*Math.sin(t+y),o=j*Math.cos(u-y),x=j*Math.sin(u-y);var P=Math.abs(u-t-2*y)<=k?0:1;if(y&&dZ(m,n,o,x)===l^P){var Q=(t+u)/2;m=j*Math.cos(Q),n=j*Math.sin(Q),o=x=null}}else m=n=0;if(a){q=a*Math.cos(u-D),r=a*Math.sin(u-D),s=a*Math.cos(t+D),C=a*Math.sin(t+D);var R=Math.abs(t-u+2*D)<=k?0:1;if(D&&dZ(q,r,s,C)===1-l^R){var S=(t+u)/2;q=a*Math.cos(S),r=a*Math.sin(S),s=C=null}}else q=r=0;if(I>1e-6&&(A=Math.min(Math.abs(j-a)/2,+d.apply(this,arguments)))>.001){B=a<j^l?0:1;var v=A,w=A;if(I<k){var z=null==s?[q,r]:null==o?[m,n]:bP([m,n],[s,C],[o,x],[q,r]),L=m-z[0],M=n-z[1],N=o-z[0],O=x-z[1],T=1/Math.sin(Math.acos((L*N+M*O)/(Math.sqrt(L*L+M*M)*Math.sqrt(N*N+O*O)))/2),U=Math.sqrt(z[0]*z[0]+z[1]*z[1]);w=Math.min(A,(a-U)/(T-1)),v=Math.min(A,(j-U)/(T+1))}if(null!=o){var E=d$(null==s?[q,r]:[s,C],[m,n],j,v,l),F=d$([o,x],[q,r],j,v,l);A===v?p.push("M",E[0],"A",v,",",v," 0 0,",B," ",E[1],"A",j,",",j," 0 ",1-l^dZ(E[1][0],E[1][1],F[1][0],F[1][1]),",",l," ",F[1],"A",v,",",v," 0 0,",B," ",F[0]):p.push("M",E[0],"A",v,",",v," 0 1,",B," ",F[0])}else p.push("M",m,",",n);if(null!=s){var G=d$([m,n],[s,C],a,-w,l),H=d$([q,r],null==o?[m,n]:[o,x],a,-w,l);A===w?p.push("L",H[0],"A",w,",",w," 0 0,",B," ",H[1],"A",a,",",a," 0 ",l^dZ(H[1][0],H[1][1],G[1][0],G[1][1]),",",1-l," ",G[1],"A",w,",",w," 0 0,",B," ",G[0]):p.push("L",H[0],"A",w,",",w," 0 0,",B," ",G[0])}else p.push("L",q,",",r)}else p.push("M",m,",",n),null!=o&&p.push("A",j,",",j," 0 ",P,",",l," ",o,",",x),p.push("L",q,",",r),null!=s&&p.push("A",a,",",a," 0 ",R,",",1-l," ",s,",",C);return p.push("Z"),p.join("")}function i(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+ -a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}return a.innerRadius=function(c){return arguments.length?(b=X(c),a):b},a.outerRadius=function(b){return arguments.length?(c=X(b),a):c},a.cornerRadius=function(b){return arguments.length?(d=X(b),a):d},a.padRadius=function(b){return arguments.length?(e=b==dT?dT:X(b),a):e},a.startAngle=function(b){return arguments.length?(f=X(b),a):f},a.endAngle=function(b){return arguments.length?(g=X(b),a):g},a.padAngle=function(b){return arguments.length?(h=X(b),a):h},a.centroid=function(){var a=(+b.apply(this,arguments)+ +c.apply(this,arguments))/2,d=(+f.apply(this,arguments)+ +g.apply(this,arguments))/2-ba;return[Math.cos(d)*a,Math.sin(d)*a]},a};var dT="auto";function dU(a){return a.innerRadius}function dV(a){return a.outerRadius}function dW(a){return a.startAngle}function dX(a){return a.endAngle}function dY(a){return a&&a.padAngle}function dZ(a,b,c,d){return(a-c)*b-(b-d)*a>0?0:1}function d$(e,f,k,l,D){var m=e[0]-f[0],n=e[1]-f[1],u=(D?l:-l)/Math.sqrt(m*m+n*n),o=u*n,p=-u*m,q=e[0]+o,r=e[1]+p,s=f[0]+o,t=f[1]+p,v=(q+s)/2,w=(r+t)/2,b=s-q,a=t-r,d=b*b+a*a,g=k-l,c=q*t-s*r,h=(a<0?-1:1)*Math.sqrt(Math.max(0,g*g*d-c*c)),i=(c*a-b*h)/d,j=(-c*b-a*h)/d,x=(c*a+b*h)/d,y=(-c*b+a*h)/d,z=i-v,A=j-w,B=x-v,C=y-w;return z*z+A*A>B*B+C*C&&(i=x,j=y),[[i-o,j-p],[i*k/g,j*k/g]]}function d_(){return!0}function d0(c){var d=bK,e=bL,f=d_,b=d1,g=b.key,h=.7;function a(j){var i,k=[],g=[],a=-1,m=j.length,n=X(d),o=X(e);function l(){k.push("M",b(c(g),h))}for(;++a<m;)f.call(this,i=j[a],a)?g.push([+n.call(this,i,a),+o.call(this,i,a)]):g.length&&(l(),g=[]);return g.length&&l(),k.length?k.join(""):null}return a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(e=b,a):e},a.defined=function(b){return arguments.length?(f=b,a):f},a.interpolate=function(c){return arguments.length?(g="function"==typeof c?b=c:(b=ak.get(c)||d1).key,a):g},a.tension=function(b){return arguments.length?(h=b,a):h},a}b.svg.line=function(){return d0(j)};var ak=b.map({linear:d1,"linear-closed":d2,step:function(b){for(var d=0,e=b.length,a=b[0],c=[a[0],",",a[1]];++d<e;)c.push("H",(a[0]+(a=b[d])[0])/2,"V",a[1]);return e>1&&c.push("H",a[0]),c.join("")},"step-before":G,"step-after":H,basis:d5,"basis-open":function(b){if(b.length<4)return d1(b);for(var a,f=[],c=-1,g=b.length,d=[0],e=[0];++c<3;)a=b[c],d.push(a[0]),e.push(a[1]);for(f.push(d6(d9,d)+","+d6(d9,e)),--c;++c<g;)a=b[c],d.shift(),d.push(a[0]),e.shift(),e.push(a[1]),ea(f,d,e);return f.join("")},"basis-closed":function(e){for(var f,a,b=-1,g=e.length,h=g+4,c=[],d=[];++b<4;)a=e[b%g],c.push(a[0]),d.push(a[1]);for(f=[d6(d9,c),",",d6(d9,d)],--b;++b<h;)a=e[b%g],c.shift(),c.push(a[0]),d.shift(),d.push(a[1]),ea(f,c,d);return f.join("")},bundle:function(a,d){var b=a.length-1;if(b)for(var c,e,g=a[0][0],h=a[0][1],i=a[b][0]-g,j=a[b][1]-h,f=-1;++f<=b;)c=a[f],e=f/b,c[0]=d*c[0]+(1-d)*(g+e*i),c[1]=d*c[1]+(1-d)*(h+e*j);return d5(a)},cardinal:function(a,b){return a.length<3?d1(a):a[0]+d3(a,d4(a,b))},"cardinal-open":function(a,b){return a.length<4?d1(a):a[1]+d3(a.slice(1,-1),d4(a,b))},"cardinal-closed":function(a,b){return a.length<3?d2(a):a[0]+d3((a.push(a[0]),a),d4([a[a.length-2]].concat(a,[a[1]]),b))},monotone:function(a){return a.length<3?d1(a):a[0]+d3(a,function(d){for(var e,f,g,b,i=[],c=function(a){for(var b=0,g=a.length-1,c=[],f=a[0],d=a[1],e=c[0]=eb(f,d);++b<g;)c[b]=(e+(e=eb(f=d,d=a[b+1])))/2;return c[b]=e,c}(d),a=-1,h=d.length-1;++a<h;)1e-6>ay(e=eb(d[a],d[a+1]))?c[a]=c[a+1]=0:(f=c[a]/e,g=c[a+1]/e,b=f*f+g*g,b>9&&(b=3*e/Math.sqrt(b),c[a]=b*f,c[a+1]=b*g));for(a=-1;++a<=h;)b=(d[Math.min(h,a+1)][0]-d[Math.max(0,a-1)][0])/(6*(1+c[a]*c[a])),i.push([b||0,c[a]*b||0]);return i}(a))}});function d1(a){return a.length>1?a.join("L"):a+"Z"}function d2(a){return a.join("L")+"Z"}function G(b){for(var c=0,e=b.length,a=b[0],d=[a[0],",",a[1]];++c<e;)d.push("V",(a=b[c])[1],"H",a[0]);return d.join("")}function H(b){for(var c=0,e=b.length,a=b[0],d=[a[0],",",a[1]];++c<e;)d.push("H",(a=b[c])[0],"V",a[1]);return d.join("")}function d3(b,c){if(c.length<1||b.length!=c.length&&b.length!=c.length+2)return d1(b);var j=b.length!=c.length,f="",h=b[0],a=b[1],g=c[0],d=g,e=1;if(j&&(f+="Q"+(a[0]-2*g[0]/3)+","+(a[1]-2*g[1]/3)+","+a[0]+","+a[1],h=b[1],e=2),c.length>1){d=c[1],a=b[e],e++,f+="C"+(h[0]+g[0])+","+(h[1]+g[1])+","+(a[0]-d[0])+","+(a[1]-d[1])+","+a[0]+","+a[1];for(var i=2;i<c.length;i++,e++)a=b[e],d=c[i],f+="S"+(a[0]-d[0])+","+(a[1]-d[1])+","+a[0]+","+a[1]}if(j){var k=b[e];f+="Q"+(a[0]+2*d[0]/3)+","+(a[1]+2*d[1]/3)+","+k[0]+","+k[1]}return f}function d4(a,h){for(var c,d=[],e=(1-h)/2,f=a[0],b=a[1],g=1,i=a.length;++g<i;)c=f,f=b,b=a[g],d.push([e*(b[0]-c[0]),e*(b[1]-c[1])]);return d}function d5(a){if(a.length<3)return d1(a);var h=1,i=a.length,b=a[0],c=b[0],d=b[1],e=[c,c,c,(b=a[1])[0]],f=[d,d,d,b[1]],g=[c,",",d,"L",d6(d9,e),",",d6(d9,f)];for(a.push(a[i-1]);++h<=i;)b=a[h],e.shift(),e.push(b[0]),f.shift(),f.push(b[1]),ea(g,e,f);return a.pop(),g.push("L",b),g.join("")}function d6(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}ak.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var d7=[0,2/3,1/3,0],d8=[0,1/3,2/3,0],d9=[0,1/6,2/3,1/6];function ea(c,a,b){c.push("C",d6(d7,a),",",d6(d7,b),",",d6(d8,a),",",d6(d8,b),",",d6(d9,a),",",d6(d9,b))}function eb(a,b){return(b[1]-a[1])/(b[0]-a[0])}function ec(b){for(var a,c,d,e=-1,f=b.length;++e<f;)c=(a=b[e])[0],d=a[1]-ba,a[0]=c*Math.cos(d),a[1]=c*Math.sin(d);return b}function ed(c){var d=bK,e=bK,f=0,g=bL,h=d_,b=d1,i=b.key,j=b,k="L",l=.7;function a(n){var i,r,s,o=[],m=[],p=[],a=-1,t=n.length,u=X(d),v=X(f),w=d===e?function(){return r}:X(e),x=f===g?function(){return s}:X(g);function q(){o.push("M",b(c(p),l),k,j(c(m.reverse()),l),"Z")}for(;++a<t;)h.call(this,i=n[a],a)?(m.push([r=+u.call(this,i,a),s=+v.call(this,i,a)]),p.push([+w.call(this,i,a),+x.call(this,i,a)])):m.length&&(q(),m=[],p=[]);return m.length&&q(),o.length?o.join(""):null}return a.x=function(b){return arguments.length?(d=e=b,a):e},a.x0=function(b){return arguments.length?(d=b,a):d},a.x1=function(b){return arguments.length?(e=b,a):e},a.y=function(b){return arguments.length?(f=g=b,a):g},a.y0=function(b){return arguments.length?(f=b,a):f},a.y1=function(b){return arguments.length?(g=b,a):g},a.defined=function(b){return arguments.length?(h=b,a):h},a.interpolate=function(c){return arguments.length?(i="function"==typeof c?b=c:(b=ak.get(c)||d1).key,j=b.reverse||b,k=b.closed?"M":"L",a):i},a.tension=function(b){return arguments.length?(l=b,a):l},a}function ee(a){return a.source}function ef(a){return a.target}function eg(a){return a.radius}function eh(a){return[a.x,a.y]}function ei(){return"circle"}function al(b){var a=Math.sqrt(b/k);return"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+ -a+"A"+a+","+a+" 0 1,1 0,"+a+"Z"}b.svg.line.radial=function(){var a=d0(ec);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},G.reverse=H,H.reverse=G,b.svg.area=function(){return ed(j)},b.svg.area.radial=function(){var a=ed(ec);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},b.svg.chord=function(){var b=ee,c=ef,d=eg,e=dW,f=dX;function a(e,f){var a=g(this,b,e,f),d=g(this,c,e,f);return"M"+a.p0+i(a.r,a.p1,a.a1-a.a0)+(h(a,d)?j(a.r,a.p1,a.r,a.p0):j(a.r,a.p1,d.r,d.p0)+i(d.r,d.p1,d.a1-d.a0)+j(d.r,d.p1,a.r,a.p0))+"Z"}function g(b,j,k,c){var g=j.call(b,k,c),a=d.call(b,g,c),h=e.call(b,g,c)-ba,i=f.call(b,g,c)-ba;return{r:a,a0:h,a1:i,p0:[a*Math.cos(h),a*Math.sin(h)],p1:[a*Math.cos(i),a*Math.sin(i)]}}function h(a,b){return a.a0==b.a0&&a.a1==b.a1}function i(a,b,c){return"A"+a+","+a+" 0 "+ +(c>k)+",1 "+b}function j(b,c,d,a){return"Q 0,0 "+a}return a.radius=function(b){return arguments.length?(d=X(b),a):d},a.source=function(c){return arguments.length?(b=X(c),a):b},a.target=function(b){return arguments.length?(c=X(b),a):c},a.startAngle=function(b){return arguments.length?(e=X(b),a):e},a.endAngle=function(b){return arguments.length?(f=X(b),a):f},a},b.svg.diagonal=function(){var b=ee,c=ef,d=eh;function a(g,h){var e=b.call(this,g,h),f=c.call(this,g,h),i=(e.y+f.y)/2,a=[e,{x:e.x,y:i},{x:f.x,y:i},f];return"M"+(a=a.map(d))[0]+"C"+a[1]+" "+a[2]+" "+a[3]}return a.source=function(c){return arguments.length?(b=X(c),a):b},a.target=function(b){return arguments.length?(c=X(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},b.svg.diagonal.radial=function(){var a=b.svg.diagonal(),c=eh,d=a.projection;return a.projection=function(a){var b;return arguments.length?d((b=c=a,function(){var a=b.apply(this,arguments),c=a[0],d=a[1]-ba;return[c*Math.cos(d),c*Math.sin(d)]})):c},a},b.svg.symbol=function(){var b=ei,c=function(){return 64};function a(a,d){return(am.get(b.call(this,a,d))||al)(c.call(this,a,d))}return a.type=function(c){return arguments.length?(b=X(c),a):b},a.size=function(b){return arguments.length?(c=X(b),a):c},a};var am=b.map({circle:al,cross:function(b){var a=Math.sqrt(b/5)/2;return"M"+ -3*a+","+ -a+"H"+ -a+"V"+ -3*a+"H"+a+"V"+ -a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+ -a+"V"+a+"H"+ -3*a+"Z"},diamond:function(c){var a=Math.sqrt(c/(2*ek)),b=a*ek;return"M0,"+ -a+"L"+b+",0 0,"+a+" "+ -b+",0Z"},square:function(b){var a=Math.sqrt(b)/2;return"M"+ -a+","+ -a+"L"+a+","+ -a+" "+a+","+a+" "+ -a+","+a+"Z"},"triangle-down":function(c){var a=Math.sqrt(c/ej),b=a*ej/2;return"M0,"+b+"L"+a+","+ -b+" "+ -a+","+ -b+"Z"},"triangle-up":function(c){var a=Math.sqrt(c/ej),b=a*ej/2;return"M0,"+ -b+"L"+a+","+b+" "+ -a+","+b+"Z"}});b.svg.symbolTypes=am.keys();var ej=Math.sqrt(3),ek=Math.tan(30*V);d.transition=function(i){for(var c,a,d=eo|| ++eq,e=et(i),f=[],j=ep||{time:Date.now(),ease:cv,delay:0,duration:250},g=-1,k=this.length;++g<k;){f.push(c=[]);for(var h=this[g],b=-1,l=h.length;++b<l;)(a=h[b])&&eu(a,b,e,d,j),c.push(a)}return en(f,e,d)},d.interrupt=function(a){return this.each(null==a?el:em(et(a)))};var el=em(et());function em(a){return function(){var b,d,c;(b=this[a])&&(c=b[d=b.active])&&(c.timer.c=null,c.timer.t=NaN,--b.count?delete b[d]:delete this[a],b.active+=.5,c.event&&c.event.interrupt.call(this,this.__data__,c.index))}}function en(a,b,c){return aJ(a,e),a.namespace=b,a.id=c,a}var eo,ep,e=[],eq=0;function er(a,d,b,c){var e=a.id,f=a.namespace;return a$(a,"function"==typeof b?function(a,g,h){a[f][e].tween.set(d,c(b.call(a,a.__data__,g,h)))}:(b=c(b),function(a){a[f][e].tween.set(d,b)}))}function es(a){return null==a&&(a=""),function(){this.textContent=a}}function et(a){return null==a?"__transition__":"__transition_"+a+"__"}function eu(c,i,d,e,a){var f,g,j,k,l,b=c[d]||(c[d]={active:0,count:0}),h=b[e];function m(p){var m=b.active,a=b[m];for(var d in a&&(a.timer.c=null,a.timer.t=NaN,--b.count,delete b[m],a.event&&a.event.interrupt.call(c,c.__data__,a.index)),b)if(+d<e){var o=b[d];o.timer.c=null,o.timer.t=NaN,--b.count,delete b[d]}g.c=n,bG(function(){return g.c&&n(p||1)&&(g.c=null,g.t=NaN),1},0,f),b.active=e,h.event&&h.event.start.call(c,c.__data__,i),l=[],h.tween.forEach(function(b,a){(a=a.call(c,c.__data__,i))&&l.push(a)}),k=h.ease,j=h.duration}function n(g){for(var a=g/j,m=k(a),f=l.length;f>0;)l[--f].call(c,m);if(a>=1)return h.event&&h.event.end.call(c,c.__data__,i),--b.count?delete b[e]:delete c[d],1}!h&&(g=bG(function(b){var a=h.delay;if(g.t=a+f,a<=b)return m(b-a);g.c=m},0,f=a.time),h=b[e]={tween:new J,time:f,timer:g,delay:a.delay,duration:a.duration,ease:a.ease,index:i},a=null,++b.count)}e.call=d.call,e.empty=d.empty,e.node=d.node,e.size=d.size,b.transition=function(a,c){return a&&a.transition?eo?a.transition(c):a:b.selection().transition(a)},b.transition.prototype=e,e.select=function(d){var e,b,a,f=this.id,g=this.namespace,i=[];d=aL(d);for(var h=-1,k=this.length;++h<k;){i.push(e=[]);for(var j=this[h],c=-1,l=j.length;++c<l;)(a=j[c])&&(b=d.call(a,a.__data__,c,h))?("__data__"in a&&(b.__data__=a.__data__),eu(b,c,g,f,a[g][f]),e.push(b)):e.push(null)}return en(i,g,f)},e.selectAll=function(b){var j,c,a,d,k,e=this.id,f=this.namespace,l=[];b=aM(b);for(var g=-1,n=this.length;++g<n;)for(var m=this[g],h=-1,o=m.length;++h<o;)if(a=m[h]){k=a[f][e],c=b.call(a,a.__data__,h,g),l.push(j=[]);for(var i=-1,p=c.length;++i<p;)(d=c[i])&&eu(d,i,f,e,k),j.push(d)}return en(l,f,e)},e.filter=function(a){var f,e,b,g=[];"function"!=typeof a&&(a=aY(a));for(var c=0,h=this.length;c<h;c++){g.push(f=[]);for(var e=this[c],d=0,i=e.length;d<i;d++)(b=e[d])&&a.call(b,b.__data__,d,c)&&f.push(b)}return en(g,this.namespace,this.id)},e.tween=function(a,b){var c=this.id,d=this.namespace;return arguments.length<2?this.node()[d][c].tween.get(a):a$(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})},e.attr=function(a,c){if(arguments.length<2){for(c in a)this.attr(c,a[c]);return this}var e="transform"==a?aj:ae,d=b.ns.qualify(a);function f(){this.removeAttribute(d)}function g(){this.removeAttributeNS(d.space,d.local)}return er(this,"attr."+a,c,d.local?function(a){return null==a?g:(a+="",function(){var c,b=this.getAttributeNS(d.space,d.local);return b!==a&&(c=e(b,a),function(a){this.setAttributeNS(d.space,d.local,c(a))})})}:function(a){return null==a?f:(a+="",function(){var c,b=this.getAttribute(d);return b!==a&&(c=e(b,a),function(a){this.setAttribute(d,c(a))})})})},e.attrTween=function(a,d){var c=b.ns.qualify(a);return this.tween("attr."+a,c.local?function(a,b){var e=d.call(this,a,b,this.getAttributeNS(c.space,c.local));return e&&function(a){this.setAttributeNS(c.space,c.local,e(a))}}:function(a,b){var e=d.call(this,a,b,this.getAttribute(c));return e&&function(a){this.setAttribute(c,e(a))}})},e.style=function(a,c,b){var d=arguments.length;if(d<3){if("string"!=typeof a){for(b in d<2&&(c=""),a)this.style(b,a[b],c);return this}b=""}function e(){this.style.removeProperty(a)}return er(this,"style."+a,c,function(c){return null==c?e:(c+="",function(){var e,d=ap(this).getComputedStyle(this,null).getPropertyValue(a);return d!==c&&(e=ae(d,c),function(c){this.style.setProperty(a,e(c),b)})})})},e.styleTween=function(a,c,b){return arguments.length<3&&(b=""),this.tween("style."+a,function(d,e){var f=c.call(this,d,e,ap(this).getComputedStyle(this,null).getPropertyValue(a));return f&&function(c){this.style.setProperty(a,f(c),b)}})},e.text=function(a){return er(this,"text",a,es)},e.remove=function(){var a=this.namespace;return this.each("end.transition",function(){var b;this[a].count<2&&(b=this.parentNode)&&b.removeChild(this)})},e.ease=function(a){var c=this.id,d=this.namespace;return arguments.length<1?this.node()[d][c].ease:("function"!=typeof a&&(a=b.ease.apply(b,arguments)),a$(this,function(b){b[d][c].ease=a}))},e.delay=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].delay:a$(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,f)}:(a=+a,function(d){d[c][b].delay=a}))},e.duration=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].duration:a$(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))},e.each=function(e,f){var a=this.id,g=this.namespace;if(arguments.length<2){var c=ep,d=eo;try{eo=a,a$(this,function(b,c,d){ep=b[g][a],e.call(b,b.__data__,c,d)})}finally{ep=c,eo=d}}else a$(this,function(d){var c=d[g][a];(c.event||(c.event=b.dispatch("start","end","interrupt"))).on(e,f)});return this},e.transition=function(){for(var g,d,b,a,j=this.id,h=++eq,e=this.namespace,i=[],f=0,k=this.length;f<k;f++){i.push(g=[]);for(var d=this[f],c=0,l=d.length;c<l;c++)(b=d[c])&&(a=b[e][j],eu(b,c,e,h,{time:a.time,ease:a.ease,delay:a.delay+a.duration,duration:a.duration})),g.push(b)}return en(i,e,h)},b.svg.axis=function(){var c,d=b.scale.linear(),e=ev,f=6,g=6,h=3,i=[10],k=null;function a(a){a.each(function(){var m,w=b.select(this),n=this.__chart__||d,a=this.__chart__=d.copy(),B=null==k?a.ticks?a.ticks.apply(a,i):a.domain():k,C=null==c?a.tickFormat?a.tickFormat.apply(a,i):j:c,p=w.selectAll(".tick").data(B,a),o=p.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),D=b.transition(p.exit()).style("opacity",1e-6).remove(),t=b.transition(p.order()).style("opacity",1),x=Math.max(f,0)+h,q=dv(a),y=w.selectAll(".domain").data([0]),z=(y.enter().append("path").attr("class","domain"),b.transition(y));o.append("line"),o.append("text");var u,v,r,s,E=o.select("line"),F=t.select("line"),A=p.select("text").text(C),G=o.select("text"),H=t.select("text"),l="top"===e||"left"===e?-1:1;if("bottom"===e||"top"===e?(m=ex,u="x",r="y",v="x2",s="y2",A.attr("dy",l<0?"0em":".71em").style("text-anchor","middle"),z.attr("d","M"+q[0]+","+l*g+"V0H"+q[1]+"V"+l*g)):(m=ey,u="y",r="x",v="y2",s="x2",A.attr("dy",".32em").style("text-anchor",l<0?"end":"start"),z.attr("d","M"+l*g+","+q[0]+"H0V"+q[1]+"H"+l*g)),E.attr(s,l*f),G.attr(r,l*x),F.attr(v,0).attr(s,l*f),H.attr(u,0).attr(r,l*x),a.rangeBand){var I=a,J=I.rangeBand()/2;n=a=function(a){return I(a)+J}}else n.rangeBand?n=a:D.call(m,a,n);o.call(m,n,a),t.call(m,a,a)})}return a.scale=function(b){return arguments.length?(d=b,a):d},a.orient=function(b){return arguments.length?(e=b in ew?b+"":ev,a):e},a.ticks=function(){return arguments.length?(i=s(arguments),a):i},a.tickValues=function(b){return arguments.length?(k=b,a):k},a.tickFormat=function(b){return arguments.length?(c=b,a):c},a.tickSize=function(c){var b=arguments.length;return b?(f=+c,g=+arguments[b-1],a):f},a.innerTickSize=function(b){return arguments.length?(f=+b,a):f},a.outerTickSize=function(b){return arguments.length?(g=+b,a):g},a.tickPadding=function(b){return arguments.length?(h=+b,a):h},a.tickSubdivide=function(){return arguments.length&&a},a};var ev="bottom",ew={top:1,right:1,bottom:1,left:1};function ex(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function ey(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}b.svg.brush=function(){var d,e,c=aH(a,"brushstart","brush","brushend"),f=null,g=null,h=[0,0],i=[0,0],k=!0,l=!0,m=eA[0];function a(c){c.each(function(){var d=b.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",q).on("touchstart.brush",q),i=d.selectAll(".background").data([0]);i.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),d.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var e=d.selectAll(".resize").data(m,j);e.exit().remove(),e.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return ez[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),e.style("display",a.empty()?"none":null);var c,h=b.transition(d),k=b.transition(i);f&&(c=dv(f),k.attr("x",c[0]).attr("width",c[1]-c[0]),o(h)),g&&(c=dv(g),k.attr("y",c[0]).attr("height",c[1]-c[0]),p(h)),n(h)})}function n(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+h[+/e$/.test(a)]+","+i[+/^s/.test(a)]+")"})}function o(a){a.select(".extent").attr("x",h[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function p(a){a.select(".extent").attr("y",i[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",i[1]-i[0])}function q(){var w,x,m=this,r=b.select(b.event.target),y=c.of(m,arguments),s=b.select(m),q=r.datum(),B=!/^(n|s)$/.test(q)&&f,C=!/^(e|w)$/.test(q)&&g,z=r.classed("extent"),D=a4(m),j=b.mouse(m),t=b.select(ap(m)).on("keydown.brush",function(){32==b.event.keyCode&&(z||(w=null,j[0]-=h[1],j[1]-=i[1],z=2),aF())}).on("keyup.brush",function(){32==b.event.keyCode&&2==z&&(j[0]+=h[1],j[1]+=i[1],z=0,aF())});if(b.event.changedTouches?t.on("touchmove.brush",A).on("touchend.brush",F):t.on("mousemove.brush",A).on("mouseup.brush",F),s.interrupt().selectAll("*").interrupt(),z)j[0]=h[0]-j[0],j[1]=i[0]-j[1];else if(q){var u=+/w$/.test(q),v=+/^n/.test(q);x=[h[1-u]-j[0],i[1-v]-j[1]],j[0]=h[u],j[1]=i[v]}else b.event.altKey&&(w=j.slice());function A(){var a=b.mouse(m),c=!1;x&&(a[0]+=x[0],a[1]+=x[1]),z||(b.event.altKey?(w||(w=[(h[0]+h[1])/2,(i[0]+i[1])/2]),j[0]=h[+(a[0]<w[0])],j[1]=i[+(a[1]<w[1])]):w=null),B&&E(a,f,0)&&(o(s),c=!0),C&&E(a,g,1)&&(p(s),c=!0),c&&(n(s),y({type:"brush",mode:z?"move":"resize"}))}function E(o,r,b){var a,g,p=dv(r),m=p[0],n=p[1],c=j[b],f=b?i:h,q=f[1]-f[0];if(z&&(m-=c,n-=q+c),a=(b?l:k)?Math.max(m,Math.min(n,o[b])):o[b],z?g=(a+=c)+q:(w&&(c=Math.max(m,Math.min(n,2*w[b]-a))),c<a?(g=a,a=c):g=c),f[0]!=a||f[1]!=g)return b?e=null:d=null,f[0]=a,f[1]=g,!0}function F(){A(),s.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),b.select("body").style("cursor",null),t.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),y({type:"brushend"})}s.style("pointer-events","none").selectAll(".resize").style("display",null),b.select("body").style("cursor",r.style("cursor")),y({type:"brushstart"}),A()}return a.event=function(a){a.each(function(){var a=c.of(this,arguments),f={x:h,y:i,i:d,j:e},g=this.__chart__||f;this.__chart__=f,eo?b.select(this).transition().each("start.brush",function(){d=g.i,e=g.j,h=g.x,i=g.y,a({type:"brushstart"})}).tween("brush:brush",function(){var b=af(h,f.x),c=af(i,f.y);return d=e=null,function(d){h=f.x=b(d),i=f.y=c(d),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){d=f.i,e=f.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(m=eA[!(f=b)<<1| !g],a):f},a.y=function(b){return arguments.length?(m=eA[!f<<1| !(g=b)],a):g},a.clamp=function(b){return arguments.length?(f&&g?(k=!!b[0],l=!!b[1]):f?k=!!b:g&&(l=!!b),a):f&&g?[k,l]:f?k:g?l:null},a.extent=function(m){var b,c,j,k,l;return arguments.length?(f&&(b=m[0],c=m[1],g&&(b=b[0],c=c[0]),d=[b,c],f.invert&&(b=f(b),c=f(c)),c<b&&(l=b,b=c,c=l),(b!=h[0]||c!=h[1])&&(h=[b,c])),g&&(j=m[0],k=m[1],f&&(j=j[1],k=k[1]),e=[j,k],g.invert&&(j=g(j),k=g(k)),k<j&&(l=j,j=k,k=l),(j!=i[0]||k!=i[1])&&(i=[j,k])),a):(f&&(d?(b=d[0],c=d[1]):(b=h[0],c=h[1],f.invert&&(b=f.invert(b),c=f.invert(c)),c<b&&(l=b,b=c,c=l))),g&&(e?(j=e[0],k=e[1]):(j=i[0],k=i[1],g.invert&&(j=g.invert(j),k=g.invert(k)),k<j&&(l=j,j=k,k=l))),f&&g?[[b,j],[c,k]]:f?[b,c]:g&&[j,k])},a.clear=function(){return a.empty()||(h=[0,0],i=[0,0],d=e=null),a},a.empty=function(){return!!f&&h[0]==h[1]|| !!g&&i[0]==i[1]},b.rebind(a,c,"on")};var ez={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},eA=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function eB(a){return JSON.parse(a.responseText)}function eC(b){var a=h.createRange();return a.selectNode(h.body),a.createContextualFragment(b.responseText)}b.text=q(function(a){return a.responseText}),b.json=function(a,b){return by(a,"application/json",eB,b)},b.html=function(a,b){return by(a,"text/html",eC,b)},b.xml=q(function(a){return a.responseXML}),"function"==typeof a&&a.amd?(this.d3=b,a(b)):"object"==typeof c&&c.exports?c.exports=b:this.d3=b}).apply(self)},{}],59:[function(a,b,c){"use strict";b.exports=a("./quad")},{"./quad":60}],60:[function(a,b,c){"use strict";var d=a("binary-search-bounds"),e=a("clamp"),f=a("parse-rect"),g=a("array-bounds"),h=a("pick-by-alias"),i=a("defined"),j=a("flatten-vertex-data"),k=a("is-obj"),l=a("dtype"),m=a("math-log2");function n(b,c){for(var f=c[0],g=c[1],h=c[2],i=c[3],j=1/(h-f),k=1/(i-g),d=new Array(b.length),a=0,l=b.length/2;a<l;a++)d[2*a]=e((b[2*a]-f)*j,0,1),d[2*a+1]=e((b[2*a+1]-g)*k,0,1);return d}b.exports=function(e,a){a||(a={}),e=j(e,"float64");var b,y=i((a=h(a,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"})).maxDepth,255),c=i(a.bounds,g(e,2));c[0]===c[2]&&c[2]++,c[1]===c[3]&&c[3]++;var z=n(e,c),s=e.length>>>1;a.dtype||(a.dtype="array"),"string"==typeof a.dtype?b=new(l(a.dtype))(s):a.dtype&&(b=a.dtype,Array.isArray(b)&&(b.length=s));for(var q=0;q<s;++q)b[q]=q;var t=[],A=[],B=[],w=[];C(0,0,1,b,0,1);for(var o=0,p=0;p<t.length;p++){var u=t[p];if(b.set)b.set(u,o);else for(var r=0,x=u.length;r<x;r++)b[r+o]=u[r];var v=o+t[p].length;w[p]=[o,v],o=v}return b.range=function(){for(var b,l,d=[],q=arguments.length;q--;)d[q]=arguments[q];if(k(d[d.length-1])){var g=d.pop();d.length||null==g.x&&null==g.l&&null==g.left||(d=[g],b={}),b=h(g,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else b={};d.length||(d=c);var a=f.apply(void 0,d),o=[Math.min(a.x,a.x+a.width),Math.min(a.y,a.y+a.height),Math.max(a.x,a.x+a.width),Math.max(a.y,a.y+a.height)],r=o[0],s=o[1],u=o[2],v=o[3],p=n([r,s,u,v],c),w=p[0],x=p[1],y=p[2],z=p[3],j=i(b.level,t.length);if(null!=b.d&&("number"==typeof b.d?l=[b.d,b.d]:b.d.length&&(l=b.d),j=Math.min(Math.max(Math.ceil(-m(Math.abs(l[0])/(c[2]-c[0]))),Math.ceil(-m(Math.abs(l[1])/(c[3]-c[1])))),j)),j=Math.min(j,t.length),b.lod)return D(w,x,y,z,j);var B=[];function C(c,d,m,h,a,f){if(null!==a&&null!==f&& !(w>c+m)&&!(x>d+m)&&!(y<c)&&!(z<d)&& !(h>=j)&&a!==f){var q=t[h];void 0===f&&(f=q.length);for(var n=a;n<f;n++){var o=q[n],D=e[2*o],F=e[2*o+1];D>=r&&D<=u&&F>=s&&F<=v&&B.push(o)}var g=A[h],H=g[4*a+0],G=g[4*a+1],p=g[4*a+2],i=g[4*a+3],k=E(g,a+1),b=.5*m,l=h+1;C(c,d,b,l,H,G||p||i||k),C(c,d+b,b,l,G,p||i||k),C(c+b,d,b,l,p,i||k),C(c+b,d+b,b,l,i,k)}}function E(c,d){for(var a=null,b=0;null===a;)if(a=c[4*d+b],b++,b>c.length)return null;return a}return C(0,0,1,0,0,1),B},b;function C(g,h,v,c,a,b){if(!c.length)return null;var i=t[a]||(t[a]=[]),o=B[a]||(B[a]=[]),j=A[a]||(A[a]=[]),k=i.length;if(a++,a>y||b>1073741824){for(var l=0;l<c.length;l++)i.push(c[l]),o.push(b),j.push(null,null,null,null);return k}if(i.push(c[0]),o.push(b),c.length<=1)return j.push(null,null,null,null),k;for(var d=.5*v,m=g+d,f=h+d,p=[],q=[],r=[],s=[],n=1,w=c.length;n<w;n++){var e=c[n],x=z[2*e],u=z[2*e+1];x<m?u<f?p.push(e):q.push(e):u<f?r.push(e):s.push(e)}return b<<=2,j.push(C(g,h,d,p,a,b),C(g,f,d,q,a,b+1),C(m,h,d,r,a,b+2),C(m,f,d,s,a,b+3)),k}function D(g,h,i,j,k){for(var c=[],a=0;a<k;a++){var b=B[a],e=w[a][0],l=E(g,h,a),m=E(i,j,a),f=d.ge(b,l),n=d.gt(b,m,f,b.length-1);c[a]=[f+e,n+e]}return c}function E(f,c,h){for(var d=1,e=.5,b=.5,a=.5,g=0;g<h;g++)d<<=2,d+=f<e?c<b?0:1:c<b?2:3,a*=.5,e+=f<e?-a:a,b+=c<b?-a:a;return d}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(b,c,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var d=b("@turf/meta");function e(a){var b=0;if(a&&a.length>0){b+=Math.abs(f(a[0]));for(var c=1;c<a.length;c++)b-=Math.abs(f(a[c]))}return b}function f(c){var i,j,k,d,e,f,a,h=0,b=c.length;if(b>2){for(a=0;a<b;a++)a===b-2?(d=b-2,e=b-1,f=0):a===b-1?(d=b-1,e=0,f=1):(d=a,e=a+1,f=a+2),i=c[d],j=c[e],k=c[f],h+=(g(k[0])-g(i[0]))*Math.sin(g(j[1]));h=6378137*h*6378137/2}return h}function g(a){return a*Math.PI/180}a.default=function(a){return d.geomReduce(a,function(a,b){return a+function(a){var b,c=0;switch(a.type){case"Polygon":return e(a.coordinates);case"MultiPolygon":for(b=0;b<a.coordinates.length;b++)c+=e(a.coordinates[b]);return c;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(b)},0)}},{"@turf/meta":63}],62:[function(n,o,a){"use strict";function b(c,d,a){void 0===a&&(a={});var b={type:"Feature"};return(0===a.id||a.id)&&(b.id=a.id),a.bbox&&(b.bbox=a.bbox),b.properties=d||{},b.geometry=c,b}function c(a,d,c){if(void 0===c&&(c={}),!a)throw new Error("coordinates is required");if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!m(a[0])||!m(a[1]))throw new Error("coordinates must contain numbers");return b({type:"Point",coordinates:a},d,c)}function d(f,h,d){void 0===d&&(d={});for(var e=0,g=f;e<g.length;e++){var a=g[e];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var c=0;c<a[a.length-1].length;c++)if(a[a.length-1][c]!==a[0][c])throw new Error("First and last Position are not equivalent.")}return b({type:"Polygon",coordinates:f},h,d)}function e(c,d,a){if(void 0===a&&(a={}),c.length<2)throw new Error("coordinates must be an array of two or more positions");return b({type:"LineString",coordinates:c},d,a)}function f(c,a){void 0===a&&(a={});var b={type:"FeatureCollection"};return a.id&&(b.id=a.id),a.bbox&&(b.bbox=a.bbox),b.features=c,b}function g(c,d,a){return void 0===a&&(a={}),b({type:"MultiLineString",coordinates:c},d,a)}function h(c,d,a){return void 0===a&&(a={}),b({type:"MultiPoint",coordinates:c},d,a)}function i(c,d,a){return void 0===a&&(a={}),b({type:"MultiPolygon",coordinates:c},d,a)}function j(d,b){void 0===b&&(b="kilometers");var c=a.factors[b];if(!c)throw new Error(b+" units is invalid");return d*c}function k(d,b){void 0===b&&(b="kilometers");var c=a.factors[b];if(!c)throw new Error(b+" units is invalid");return d/c}function l(a){return 180*(a%(2*Math.PI))/Math.PI}function m(a){return!isNaN(a)&&null!==a&&!Array.isArray(a)}Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=6371008.8,a.factors={centimeters:100*a.earthRadius,centimetres:100*a.earthRadius,degrees:a.earthRadius/111325,feet:3.28084*a.earthRadius,inches:39.37*a.earthRadius,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:1e3*a.earthRadius,millimetres:1e3*a.earthRadius,nauticalmiles:a.earthRadius/1852,radians:1,yards:1.0936*a.earthRadius},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1.0936133},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},a.feature=b,a.geometry=function(b,a,f){switch(void 0===f&&(f={}),b){case"Point":return c(a).geometry;case"LineString":return e(a).geometry;case"Polygon":return d(a).geometry;case"MultiPoint":return h(a).geometry;case"MultiLineString":return g(a).geometry;case"MultiPolygon":return i(a).geometry;default:throw new Error(b+" is invalid")}},a.point=c,a.points=function(b,d,a){return void 0===a&&(a={}),f(b.map(function(a){return c(a,d)}),a)},a.polygon=d,a.polygons=function(b,c,a){return void 0===a&&(a={}),f(b.map(function(a){return d(a,c)}),a)},a.lineString=e,a.lineStrings=function(b,c,a){return void 0===a&&(a={}),f(b.map(function(a){return e(a,c)}),a)},a.featureCollection=f,a.multiLineString=g,a.multiPoint=h,a.multiPolygon=i,a.geometryCollection=function(c,d,a){return void 0===a&&(a={}),b({type:"GeometryCollection",geometries:c},d,a)},a.round=function(c,a){if(void 0===a&&(a=0),a&&!(a>=0))throw new Error("precision must be a positive number");var b=Math.pow(10,a||0);return Math.round(c*b)/b},a.radiansToLength=j,a.lengthToRadians=k,a.lengthToDegrees=function(a,b){return l(k(a,b))},a.bearingToAzimuth=function(b){var a=b%360;return a<0&&(a+=360),a},a.radiansToDegrees=l,a.degreesToRadians=function(a){return a%360*Math.PI/180},a.convertLength=function(c,a,b){if(void 0===a&&(a="kilometers"),void 0===b&&(b="kilometers"),!(c>=0))throw new Error("length must be a positive number");return j(k(c,a),b)},a.convertArea=function(d,b,c){if(void 0===b&&(b="meters"),void 0===c&&(c="kilometers"),!(d>=0))throw new Error("area must be a positive number");var e=a.areaFactors[b];if(!e)throw new Error("invalid original units");var f=a.areaFactors[c];if(!f)throw new Error("invalid final units");return d/e*f},a.isNumber=m,a.isObject=function(a){return!!a&&a.constructor===Object},a.validateBBox=function(a){if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(4!==a.length&&6!==a.length)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(a){if(!m(a))throw new Error("bbox must only contain numbers")})},a.validateId=function(a){if(!a)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof a))throw new Error("id must be a number or a string")}},{}],63:[function(b,j,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var k=b("@turf/helpers");function c(j,k,q){if(null!==j)for(var a,e,n,l,r,b,m,s,o=0,f=0,t=j.type,u="FeatureCollection"===t,v="Feature"===t,w=u?j.features.length:1,h=0;h<w;h++){r=(s=!!(m=u?j.features[h].geometry:v?j.geometry:j)&&"GeometryCollection"===m.type)?m.geometries.length:1;for(var p=0;p<r;p++){var d=0,i=0;if(null!==(l=s?m.geometries[p]:m)){b=l.coordinates;var g=l.type;switch(o=q&&("Polygon"===g||"MultiPolygon"===g)?1:0,g){case null:break;case"Point":if(!1===k(b,f,h,d,i))return!1;f++,d++;break;case"LineString":case"MultiPoint":for(a=0;a<b.length;a++){if(!1===k(b[a],f,h,d,i))return!1;f++,"MultiPoint"===g&&d++}"LineString"===g&&d++;break;case"Polygon":case"MultiLineString":for(a=0;a<b.length;a++){for(e=0;e<b[a].length-o;e++){if(!1===k(b[a][e],f,h,d,i))return!1;f++}"MultiLineString"===g&&d++,"Polygon"===g&&i++}"Polygon"===g&&d++;break;case"MultiPolygon":for(a=0;a<b.length;a++){for(e=0,i=0;e<b[a].length;e++){for(n=0;n<b[a][e].length-o;n++){if(!1===k(b[a][e][n],f,h,d,i))return!1;f++}i++}d++}break;case"GeometryCollection":for(a=0;a<l.geometries.length;a++)if(!1===c(l.geometries[a],k,q))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function d(b,c){var a;switch(b.type){case"FeatureCollection":for(a=0;a<b.features.length&& !1!==c(b.features[a].properties,a);a++);break;case"Feature":c(b.properties,0);break}}function e(a,c){if("Feature"===a.type)c(a,0);else if("FeatureCollection"===a.type)for(var b=0;b<a.features.length&& !1!==c(a.features[b],b);b++);}function f(a,m){var b,f,g,d,o,c,n,h,i,j,k=0,e="FeatureCollection"===a.type,l="Feature"===a.type,p=e?a.features.length:1;for(b=0;b<p;b++){for(g=0,c=e?a.features[b].geometry:l?a.geometry:a,h=e?a.features[b].properties:l?a.properties:{},i=e?a.features[b].bbox:l?a.bbox:void 0,j=e?a.features[b].id:l?a.id:void 0,n=!!c&&"GeometryCollection"===c.type,o=n?c.geometries.length:1;g<o;g++){if(null===(d=n?c.geometries[g]:c)){if(!1===m(null,k,h,i,j))return!1;continue}switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===m(d,k,h,i,j))return!1;break;case"GeometryCollection":for(f=0;f<d.geometries.length;f++)if(!1===m(d.geometries[f],k,h,i,j))return!1;break;default:throw new Error("Unknown Geometry Type")}}k++}}function g(a,b){f(a,function(a,e,f,h,i){var c,g=null===a?null:a.type;switch(g){case null:case"Point":case"LineString":case"Polygon":if(!1===b(k.feature(a,f,{bbox:h,id:i}),e,0))return!1;return}switch(g){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var d=0;d<a.coordinates.length;d++){var j={type:c,coordinates:a.coordinates[d]};if(!1===b(k.feature(j,f),e,d))return!1}})}function h(a,b){g(a,function(a,e,f){var g,h=0;if(a.geometry){var d=a.geometry.type;if("Point"!==d&&"MultiPoint"!==d){var i=0,j=0,l=0;if(!1===c(a,function(c,n,o,m,d){if(void 0===g||e>i||m>j||d>l){g=c,i=e,j=m,l=d,h=0;return}if(!1===b(k.lineString([g,c],a.properties),e,f,d,h))return!1;h++,g=c}))return!1}}})}function i(a,b){if(!a)throw new Error("geojson is required");g(a,function(a,d,e){if(null!==a.geometry){var g=a.geometry.type,f=a.geometry.coordinates;switch(g){case"LineString":if(!1===b(a,d,e,0,0))return!1;break;case"Polygon":for(var c=0;c<f.length;c++)if(!1===b(k.lineString(f[c],a.properties),d,e,c))return!1;break}}})}a.coordEach=c,a.coordReduce=function(a,f,b,d){var e=b;return c(a,function(a,c,d,g,h){e=0===c&& void 0===b?a:f(e,a,c,d,g,h)},d),e},a.propEach=d,a.propReduce=function(a,e,b){var c=b;return d(a,function(a,d){c=0===d&& void 0===b?a:e(c,a,d)}),c},a.featureEach=e,a.featureReduce=function(a,d,b){var c=b;return e(a,function(a,e){c=0===e&& void 0===b?a:d(c,a,e)}),c},a.coordAll=function(a){var b=[];return c(a,function(a){b.push(a)}),b},a.geomEach=f,a.geomReduce=function(a,d,b){var c=b;return f(a,function(a,e,f,g,h){c=0===e&& void 0===b?a:d(c,a,e,f,g,h)}),c},a.flattenEach=g,a.flattenReduce=function(a,d,b){var c=b;return g(a,function(a,e,f){c=0===e&&0===f&& void 0===b?a:d(c,a,e,f)}),c},a.segmentEach=h,a.segmentReduce=function(a,d,b){var c=b,e=!1;return h(a,function(a,f,g,h,i){c=!1===e&& void 0===b?a:d(c,a,f,g,h,i),e=!0}),c},a.lineEach=i,a.lineReduce=function(a,d,b){var c=b;return i(a,function(a,e,f,g){c=0===e&& void 0===b?a:d(c,a,e,f,g)}),c},a.findSegment=function(g,d){if(d=d||{},!k.isObject(d))throw new Error("options is invalid");var h,i=d.featureIndex||0,c=d.multiFeatureIndex||0,e=d.geometryIndex||0,a=d.segmentIndex||0,f=d.properties;switch(g.type){case"FeatureCollection":i<0&&(i=g.features.length+i),f=f||g.features[i].properties,h=g.features[i].geometry;break;case"Feature":f=f||g.properties,h=g.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":h=g;break;default:throw new Error("geojson is invalid")}if(null===h)return null;var b=h.coordinates;switch(h.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=b.length+a-1),k.lineString([b[a],b[a+1]],f,d);case"Polygon":return e<0&&(e=b.length+e),a<0&&(a=b[e].length+a-1),k.lineString([b[e][a],b[e][a+1],],f,d);case"MultiLineString":return c<0&&(c=b.length+c),a<0&&(a=b[c].length+a-1),k.lineString([b[c][a],b[c][a+1],],f,d);case"MultiPolygon":return c<0&&(c=b.length+c),e<0&&(e=b[c].length+e),a<0&&(a=b[c][e].length-a-1),k.lineString([b[c][e][a],b[c][e][a+1],],f,d)}throw new Error("geojson is invalid")},a.findPoint=function(g,d){if(d=d||{},!k.isObject(d))throw new Error("options is invalid");var h,i=d.featureIndex||0,b=d.multiFeatureIndex||0,e=d.geometryIndex||0,a=d.coordIndex||0,f=d.properties;switch(g.type){case"FeatureCollection":i<0&&(i=g.features.length+i),f=f||g.features[i].properties,h=g.features[i].geometry;break;case"Feature":f=f||g.properties,h=g.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":h=g;break;default:throw new Error("geojson is invalid")}if(null===h)return null;var c=h.coordinates;switch(h.type){case"Point":return k.point(c,f,d);case"MultiPoint":return b<0&&(b=c.length+b),k.point(c[b],f,d);case"LineString":return a<0&&(a=c.length+a),k.point(c[a],f,d);case"Polygon":return e<0&&(e=c.length+e),a<0&&(a=c[e].length+a),k.point(c[e][a],f,d);case"MultiLineString":return b<0&&(b=c.length+b),a<0&&(a=c[b].length+a),k.point(c[b][a],f,d);case"MultiPolygon":return b<0&&(b=c.length+b),e<0&&(e=c[b].length+e),a<0&&(a=c[b][e].length-a),k.point(c[b][e][a],f,d)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(c,d,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var e=c("@turf/meta");function a(a){var b=[1/0,1/0,-1/0,-1/0];return e.coordEach(a,function(a){b[0]>a[0]&&(b[0]=a[0]),b[1]>a[1]&&(b[1]=a[1]),b[2]<a[0]&&(b[2]=a[0]),b[3]<a[1]&&(b[3]=a[1])}),b}a.default=a,b.default=a},{"@turf/meta":66}],65:[function(b,c,a){arguments[4][62][0].apply(a,arguments)},{dup:62}],66:[function(b,c,a){arguments[4][63][0].apply(a,arguments)},{"@turf/helpers":65,dup:63}],67:[function(a,c,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=a("@turf/meta"),e=a("@turf/helpers");b.default=function(c,a){void 0===a&&(a={});var f=0,g=0,b=0;return d.coordEach(c,function(a){f+=a[0],g+=a[1],b++}),e.point([f/b,g/b],a.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(n,o,a){"use strict";function b(c,d,a){void 0===a&&(a={});var b={type:"Feature"};return(0===a.id||a.id)&&(b.id=a.id),a.bbox&&(b.bbox=a.bbox),b.properties=d||{},b.geometry=c,b}function c(c,d,a){return void 0===a&&(a={}),b({type:"Point",coordinates:c},d,a)}function d(f,h,d){void 0===d&&(d={});for(var e=0,g=f;e<g.length;e++){var a=g[e];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var c=0;c<a[a.length-1].length;c++)if(a[a.length-1][c]!==a[0][c])throw new Error("First and last Position are not equivalent.")}return b({type:"Polygon",coordinates:f},h,d)}function e(c,d,a){if(void 0===a&&(a={}),c.length<2)throw new Error("coordinates must be an array of two or more positions");return b({type:"LineString",coordinates:c},d,a)}function f(c,a){void 0===a&&(a={});var b={type:"FeatureCollection"};return a.id&&(b.id=a.id),a.bbox&&(b.bbox=a.bbox),b.features=c,b}function g(c,d,a){return void 0===a&&(a={}),b({type:"MultiLineString",coordinates:c},d,a)}function h(c,d,a){return void 0===a&&(a={}),b({type:"MultiPoint",coordinates:c},d,a)}function i(c,d,a){return void 0===a&&(a={}),b({type:"MultiPolygon",coordinates:c},d,a)}function j(d,b){void 0===b&&(b="kilometers");var c=a.factors[b];if(!c)throw new Error(b+" units is invalid");return d*c}function k(d,b){void 0===b&&(b="kilometers");var c=a.factors[b];if(!c)throw new Error(b+" units is invalid");return d/c}function l(a){return 180*(a%(2*Math.PI))/Math.PI}function m(a){return!isNaN(a)&&null!==a&&!Array.isArray(a)&&!/^\s*$/.test(a)}Object.defineProperty(a,"__esModule",{value:!0}),a.earthRadius=6371008.8,a.factors={centimeters:100*a.earthRadius,centimetres:100*a.earthRadius,degrees:a.earthRadius/111325,feet:3.28084*a.earthRadius,inches:39.37*a.earthRadius,kilometers:a.earthRadius/1e3,kilometres:a.earthRadius/1e3,meters:a.earthRadius,metres:a.earthRadius,miles:a.earthRadius/1609.344,millimeters:1e3*a.earthRadius,millimetres:1e3*a.earthRadius,nauticalmiles:a.earthRadius/1852,radians:1,yards:a.earthRadius/1.0936},a.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/a.earthRadius,yards:1/1.0936},a.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},a.feature=b,a.geometry=function(b,a,f){switch(void 0===f&&(f={}),b){case"Point":return c(a).geometry;case"LineString":return e(a).geometry;case"Polygon":return d(a).geometry;case"MultiPoint":return h(a).geometry;case"MultiLineString":return g(a).geometry;case"MultiPolygon":return i(a).geometry;default:throw new Error(b+" is invalid")}},a.point=c,a.points=function(b,d,a){return void 0===a&&(a={}),f(b.map(function(a){return c(a,d)}),a)},a.polygon=d,a.polygons=function(b,c,a){return void 0===a&&(a={}),f(b.map(function(a){return d(a,c)}),a)},a.lineString=e,a.lineStrings=function(b,c,a){return void 0===a&&(a={}),f(b.map(function(a){return e(a,c)}),a)},a.featureCollection=f,a.multiLineString=g,a.multiPoint=h,a.multiPolygon=i,a.geometryCollection=function(c,d,a){return void 0===a&&(a={}),b({type:"GeometryCollection",geometries:c},d,a)},a.round=function(c,a){if(void 0===a&&(a=0),a&&!(a>=0))throw new Error("precision must be a positive number");var b=Math.pow(10,a||0);return Math.round(c*b)/b},a.radiansToLength=j,a.lengthToRadians=k,a.lengthToDegrees=function(a,b){return l(k(a,b))},a.bearingToAzimuth=function(b){var a=b%360;return a<0&&(a+=360),a},a.radiansToDegrees=l,a.degreesToRadians=function(a){return a%360*Math.PI/180},a.convertLength=function(c,a,b){if(void 0===a&&(a="kilometers"),void 0===b&&(b="kilometers"),!(c>=0))throw new Error("length must be a positive number");return j(k(c,a),b)},a.convertArea=function(d,b,c){if(void 0===b&&(b="meters"),void 0===c&&(c="kilometers"),!(d>=0))throw new Error("area must be a positive number");var e=a.areaFactors[b];if(!e)throw new Error("invalid original units");var f=a.areaFactors[c];if(!f)throw new Error("invalid final units");return d/e*f},a.isNumber=m,a.isObject=function(a){return!!a&&a.constructor===Object},a.validateBBox=function(a){if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(4!==a.length&&6!==a.length)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(a){if(!m(a))throw new Error("bbox must only contain numbers")})},a.validateId=function(a){if(!a)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof a))throw new Error("id must be a number or a string")},a.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},a.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},a.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},a.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},a.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},a.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},a.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(b,j,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var k=b("@turf/helpers");function c(j,k,q){if(null!==j)for(var a,e,n,l,r,b,m,s,o=0,f=0,t=j.type,u="FeatureCollection"===t,v="Feature"===t,w=u?j.features.length:1,h=0;h<w;h++){r=(s=!!(m=u?j.features[h].geometry:v?j.geometry:j)&&"GeometryCollection"===m.type)?m.geometries.length:1;for(var p=0;p<r;p++){var d=0,i=0;if(null!==(l=s?m.geometries[p]:m)){b=l.coordinates;var g=l.type;switch(o=q&&("Polygon"===g||"MultiPolygon"===g)?1:0,g){case null:break;case"Point":if(!1===k(b,f,h,d,i))return!1;f++,d++;break;case"LineString":case"MultiPoint":for(a=0;a<b.length;a++){if(!1===k(b[a],f,h,d,i))return!1;f++,"MultiPoint"===g&&d++}"LineString"===g&&d++;break;case"Polygon":case"MultiLineString":for(a=0;a<b.length;a++){for(e=0;e<b[a].length-o;e++){if(!1===k(b[a][e],f,h,d,i))return!1;f++}"MultiLineString"===g&&d++,"Polygon"===g&&i++}"Polygon"===g&&d++;break;case"MultiPolygon":for(a=0;a<b.length;a++){for(e=0,i=0;e<b[a].length;e++){for(n=0;n<b[a][e].length-o;n++){if(!1===k(b[a][e][n],f,h,d,i))return!1;f++}i++}d++}break;case"GeometryCollection":for(a=0;a<l.geometries.length;a++)if(!1===c(l.geometries[a],k,q))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function d(b,c){var a;switch(b.type){case"FeatureCollection":for(a=0;a<b.features.length&& !1!==c(b.features[a].properties,a);a++);break;case"Feature":c(b.properties,0);break}}function e(a,c){if("Feature"===a.type)c(a,0);else if("FeatureCollection"===a.type)for(var b=0;b<a.features.length&& !1!==c(a.features[b],b);b++);}function f(a,m){var b,f,g,d,o,c,n,h,i,j,k=0,e="FeatureCollection"===a.type,l="Feature"===a.type,p=e?a.features.length:1;for(b=0;b<p;b++){for(g=0,c=e?a.features[b].geometry:l?a.geometry:a,h=e?a.features[b].properties:l?a.properties:{},i=e?a.features[b].bbox:l?a.bbox:void 0,j=e?a.features[b].id:l?a.id:void 0,n=!!c&&"GeometryCollection"===c.type,o=n?c.geometries.length:1;g<o;g++){if(null===(d=n?c.geometries[g]:c)){if(!1===m(null,k,h,i,j))return!1;continue}switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===m(d,k,h,i,j))return!1;break;case"GeometryCollection":for(f=0;f<d.geometries.length;f++)if(!1===m(d.geometries[f],k,h,i,j))return!1;break;default:throw new Error("Unknown Geometry Type")}}k++}}function g(a,b){f(a,function(a,e,f,h,i){var c,g=null===a?null:a.type;switch(g){case null:case"Point":case"LineString":case"Polygon":if(!1===b(k.feature(a,f,{bbox:h,id:i}),e,0))return!1;return}switch(g){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var d=0;d<a.coordinates.length;d++){var j={type:c,coordinates:a.coordinates[d]};if(!1===b(k.feature(j,f),e,d))return!1}})}function h(a,b){g(a,function(a,e,f){var g,h=0;if(a.geometry){var d=a.geometry.type;if("Point"!==d&&"MultiPoint"!==d){var i=0,j=0,l=0;if(!1===c(a,function(c,n,o,m,d){if(void 0===g||e>i||m>j||d>l){g=c,i=e,j=m,l=d,h=0;return}if(!1===b(k.lineString([g,c],a.properties),e,f,d,h))return!1;h++,g=c}))return!1}}})}function i(a,b){if(!a)throw new Error("geojson is required");g(a,function(a,d,e){if(null!==a.geometry){var g=a.geometry.type,f=a.geometry.coordinates;switch(g){case"LineString":if(!1===b(a,d,e,0,0))return!1;break;case"Polygon":for(var c=0;c<f.length;c++)if(!1===b(k.lineString(f[c],a.properties),d,e,c))return!1;break}}})}a.coordEach=c,a.coordReduce=function(a,f,b,d){var e=b;return c(a,function(a,c,d,g,h){e=0===c&& void 0===b?a:f(e,a,c,d,g,h)},d),e},a.propEach=d,a.propReduce=function(a,e,b){var c=b;return d(a,function(a,d){c=0===d&& void 0===b?a:e(c,a,d)}),c},a.featureEach=e,a.featureReduce=function(a,d,b){var c=b;return e(a,function(a,e){c=0===e&& void 0===b?a:d(c,a,e)}),c},a.coordAll=function(a){var b=[];return c(a,function(a){b.push(a)}),b},a.geomEach=f,a.geomReduce=function(a,d,b){var c=b;return f(a,function(a,e,f,g,h){c=0===e&& void 0===b?a:d(c,a,e,f,g,h)}),c},a.flattenEach=g,a.flattenReduce=function(a,d,b){var c=b;return g(a,function(a,e,f){c=0===e&&0===f&& void 0===b?a:d(c,a,e,f)}),c},a.segmentEach=h,a.segmentReduce=function(a,d,b){var c=b,e=!1;return h(a,function(a,f,g,h,i){c=!1===e&& void 0===b?a:d(c,a,f,g,h,i),e=!0}),c},a.lineEach=i,a.lineReduce=function(a,d,b){var c=b;return i(a,function(a,e,f,g){c=0===e&& void 0===b?a:d(c,a,e,f,g)}),c},a.findSegment=function(g,d){if(d=d||{},!k.isObject(d))throw new Error("options is invalid");var h,i=d.featureIndex||0,c=d.multiFeatureIndex||0,e=d.geometryIndex||0,a=d.segmentIndex||0,f=d.properties;switch(g.type){case"FeatureCollection":i<0&&(i=g.features.length+i),f=f||g.features[i].properties,h=g.features[i].geometry;break;case"Feature":f=f||g.properties,h=g.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":h=g;break;default:throw new Error("geojson is invalid")}if(null===h)return null;var b=h.coordinates;switch(h.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=b.length+a-1),k.lineString([b[a],b[a+1]],f,d);case"Polygon":return e<0&&(e=b.length+e),a<0&&(a=b[e].length+a-1),k.lineString([b[e][a],b[e][a+1]],f,d);case"MultiLineString":return c<0&&(c=b.length+c),a<0&&(a=b[c].length+a-1),k.lineString([b[c][a],b[c][a+1]],f,d);case"MultiPolygon":return c<0&&(c=b.length+c),e<0&&(e=b[c].length+e),a<0&&(a=b[c][e].length-a-1),k.lineString([b[c][e][a],b[c][e][a+1]],f,d)}throw new Error("geojson is invalid")},a.findPoint=function(g,d){if(d=d||{},!k.isObject(d))throw new Error("options is invalid");var h,i=d.featureIndex||0,b=d.multiFeatureIndex||0,e=d.geometryIndex||0,a=d.coordIndex||0,f=d.properties;switch(g.type){case"FeatureCollection":i<0&&(i=g.features.length+i),f=f||g.features[i].properties,h=g.features[i].geometry;break;case"Feature":f=f||g.properties,h=g.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":h=g;break;default:throw new Error("geojson is invalid")}if(null===h)return null;var c=h.coordinates;switch(h.type){case"Point":return k.point(c,f,d);case"MultiPoint":return b<0&&(b=c.length+b),k.point(c[b],f,d);case"LineString":return a<0&&(a=c.length+a),k.point(c[a],f,d);case"Polygon":return e<0&&(e=c.length+e),a<0&&(a=c[e].length+a),k.point(c[e][a],f,d);case"MultiLineString":return b<0&&(b=c.length+b),a<0&&(a=c[b].length+a),k.point(c[b][a],f,d);case"MultiPolygon":return b<0&&(b=c.length+b),e<0&&(e=c[b].length+e),a<0&&(a=c[b][e].length-a),k.point(c[b][e][a],f,d)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(b,a,c){a.exports=function(a){var b=0,c=0,d=0,e=0;return a.map(function(a){var f=(a=a.slice())[0],g=f.toUpperCase();if(f!=g)switch(a[0]=g,f){case"a":a[6]+=d,a[7]+=e;break;case"v":a[1]+=e;break;case"h":a[1]+=d;break;default:for(var h=1;h<a.length;)a[h++]+=d,a[h++]+=e}switch(g){case"Z":d=b,e=c;break;case"H":d=a[1];break;case"V":e=a[1];break;case"M":d=b=a[1],e=c=a[2];break;default:d=a[a.length-2],e=a[a.length-1]}return a})}},{}],71:[function(b,a,c){"use strict";a.exports=function(a,b){if(!a||null==a.length)throw Error("Argument should be an array");for(var e=Array(2*(b=null==b?1:Math.floor(b))),d=0;d<b;d++){for(var f=-1/0,g=1/0,c=d,h=a.length;c<h;c+=b)a[c]>f&&(f=a[c]),a[c]<g&&(g=a[c]);e[d]=g,e[b+d]=f}return e}},{}],72:[function(b,a,c){"use strict";a.exports=function(d,b,e){if("function"==typeof Array.prototype.findIndex)return d.findIndex(b,e);if("function"!=typeof b)throw new TypeError("predicate must be a function");var c=Object(d),f=c.length;if(0===f)return -1;for(var a=0;a<f;a++)if(b.call(e,c[a],a,c))return a;return -1}},{}],73:[function(a,b,c){"use strict";var d=a("array-bounds");b.exports=function(b,c,h){if(!b||null==b.length)throw Error("Argument should be an array");null==c&&(c=1),null==h&&(h=d(b,c));for(var e=0;e<c;e++){var g=h[c+e],f=h[e],a=e,i=b.length;if(g===1/0&&f=== -1/0)for(a=e;a<i;a+=c)b[a]=b[a]===g?1:b[a]===f?0:.5;else if(g===1/0)for(a=e;a<i;a+=c)b[a]=b[a]===g?1:0;else if(f=== -1/0)for(a=e;a<i;a+=c)b[a]=b[a]===f?0:1;else{var j=g-f;for(a=e;a<i;a+=c)isNaN(b[a])||(b[a]=0===j?.5:(b[a]-f)/j)}}return b}},{"array-bounds":71}],74:[function(b,a,c){a.exports=function(a,b){var e="number"==typeof a,f="number"==typeof b;e&&!f?(b=a,a=0):e||f||(a=0,b=0);var c=(b|=0)-(a|=0);if(c<0)throw new Error("array length must be positive");for(var g=new Array(c),d=0,h=a;d<c;d++,h++)g[d]=h;return g}},{}],75:[function(a,b,d){(function(c){(function(){"use strict";var e=a("object-assign");function k(b,c){if(b===c)return 0;for(var d=b.length,e=c.length,a=0,f=Math.min(d,e);a<f;++a)if(b[a]!==c[a]){d=b[a],e=c[a];break}return d<e?-1:e<d?1:0}function l(a){return c.Buffer&&"function"==typeof c.Buffer.isBuffer?c.Buffer.isBuffer(a):!!(null!=a&&a._isBuffer)}var f=a("util/"),m=Object.prototype.hasOwnProperty,n=Array.prototype.slice,o="foo"===(function(){}).name;function p(a){return Object.prototype.toString.call(a)}function q(a){return!l(a)&&"function"==typeof c.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):!!a&&(a instanceof DataView|| !!a.buffer&&a.buffer instanceof ArrayBuffer))}var d=b.exports=h,r=/\s*function\s+([^\(\s]*)\s*/;function s(a){if(f.isFunction(a)){if(o)return a.name;var b=a.toString().match(r);return b&&b[1]}}function t(a,b){return"string"==typeof a?a.length<b?a:a.slice(0,b):a}function u(a){if(o||!f.isFunction(a))return f.inspect(a);var b=s(a);return"[Function"+(b?": "+b:"")+"]"}function g(a,b,c,e,f){throw new d.AssertionError({message:c,actual:a,expected:b,operator:e,stackStartFunction:f})}function h(a,b){a||g(a,!0,b,"==",d.ok)}function v(a,b,d,c){if(a===b)return!0;if(l(a)&&l(b))return 0===k(a,b);if(f.isDate(a)&&f.isDate(b))return a.getTime()===b.getTime();if(f.isRegExp(a)&&f.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase;if((null===a||"object"!=typeof a)&&(null===b||"object"!=typeof b))return d?a===b:a==b;if(q(a)&&q(b)&&p(a)===p(b)&&!(a instanceof Float32Array||a instanceof Float64Array))return 0===k(new Uint8Array(a.buffer),new Uint8Array(b.buffer));if(l(a)!==l(b))return!1;var e=(c=c||{actual:[],expected:[]}).actual.indexOf(a);return -1!==e&&e===c.expected.indexOf(b)||(c.actual.push(a),c.expected.push(b),x(a,b,d,c))}function w(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function x(a,b,e,k){if(null==a||null==b)return!1;if(f.isPrimitive(a)||f.isPrimitive(b))return a===b;if(e&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return!1;var i,c,g=w(a),j=w(b);if(g&&!j|| !g&&j)return!1;if(g)return a=n.call(a),b=n.call(b),v(a,b,e);var d=A(a),h=A(b);if(d.length!==h.length)return!1;for(d.sort(),h.sort(),c=d.length-1;c>=0;c--)if(d[c]!==h[c])return!1;for(c=d.length-1;c>=0;c--)if(!v(a[i=d[c]],b[i],e,k))return!1;return!0}function i(a,b,c){v(a,b,!0)&&g(a,b,c,"notDeepStrictEqual",i)}function y(b,a){if(!b||!a)return!1;if("[object RegExp]"==Object.prototype.toString.call(a))return a.test(b);try{if(b instanceof a)return!0}catch(c){}return!Error.isPrototypeOf(a)&& !0===a.call({},b)}function z(d,e,a,c){var b;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');if("string"==typeof a&&(c=a,a=null),b=function(b){var a;try{b()}catch(c){a=c}return a}(e),c=(a&&a.name?" ("+a.name+").":".")+(c?" "+c:"."),d&&!b&&g(b,a,"Missing expected exception"+c),(!d&&f.isError(b)&&"string"==typeof c&&y(b,a)|| !d&&b&&!a)&&g(b,a,"Got unwanted exception"+c),d&&b&&a&&!y(b,a)|| !d&&b)throw b}function j(a,b){a||g(a,!0,b,"==",j)}d.AssertionError=function(a){this.name="AssertionError",this.actual=a.actual,this.expected=a.expected,this.operator=a.operator,a.message?(this.message=a.message,this.generatedMessage=!1):(this.message=(i=this,t(u(i.actual),128)+" "+i.operator+" "+t(u(i.expected),128)),this.generatedMessage=!0);var i,c=a.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,c);else{var d=new Error;if(d.stack){var b=d.stack,f=s(c),e=b.indexOf("\n"+f);if(e>=0){var h=b.indexOf("\n",e+1);b=b.substring(h+1)}this.stack=b}}},f.inherits(d.AssertionError,Error),d.fail=g,d.ok=h,d.equal=function(a,b,c){a!=b&&g(a,b,c,"==",d.equal)},d.notEqual=function(a,b,c){a==b&&g(a,b,c,"!=",d.notEqual)},d.deepEqual=function(a,b,c){v(a,b,!1)||g(a,b,c,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(a,b,c){v(a,b,!0)||g(a,b,c,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(a,b,c){v(a,b,!1)&&g(a,b,c,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=i,d.strictEqual=function(a,b,c){a!==b&&g(a,b,c,"===",d.strictEqual)},d.notStrictEqual=function(a,b,c){a===b&&g(a,b,c,"!==",d.notStrictEqual)},d.throws=function(a,b,c){z(!0,a,b,c)},d.doesNotThrow=function(a,b,c){z(!1,a,b,c)},d.ifError=function(a){if(a)throw a},d.strict=e(j,d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var A=Object.keys||function(a){var b=[];for(var c in a)m.call(a,c)&&b.push(c);return b}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":247,"util/":78}],76:[function(b,a,c){"function"==typeof Object.create?a.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],77:[function(b,a,c){a.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],78:[function(a,b,d){(function(b,c){(function(){var q,r=/%[sdj%]/g;d.format=function(f){if(!j(f)){for(var g=[],a=0;a<arguments.length;a++)g.push(e(arguments[a]));return g.join(" ")}for(var a=1,c=arguments,i=c.length,d=String(f).replace(r,function(b){if("%%"===b)return"%";if(a>=i)return b;switch(b){case"%s":return String(c[a++]);case"%d":return Number(c[a++]);case"%j":try{return JSON.stringify(c[a++])}catch(d){return"[Circular]"}default:return b}}),b=c[a];a<i;b=c[++a])h(b)||!m(b)?d+=" "+b:d+=" "+e(b);return d},d.deprecate=function(a,e){if(k(c.process))return function(){return d.deprecate(a,e).apply(this,arguments)};if(!0===b.noDeprecation)return a;var f=!1;return function(){if(!f){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),f=!0}return a.apply(this,arguments)}};var s={};function e(c,b){var a={seen:[],stylize:u};return arguments.length>=3&&(a.depth=arguments[2]),arguments.length>=4&&(a.colors=arguments[3]),g(b)?a.showHidden=b:b&&d._extend(a,b),k(a.showHidden)&&(a.showHidden=!1),k(a.depth)&&(a.depth=2),k(a.colors)&&(a.colors=!1),k(a.customInspect)&&(a.customInspect=!0),a.colors&&(a.stylize=t),v(a,c,a.depth)}function t(b,c){var a=e.styles[c];return a?"\x1b["+e.colors[a][0]+"m"+b+"\x1b["+e.colors[a][1]+"m":b}function u(a,b){return a}function v(b,a,g){if(b.customInspect&&a&&p(a.inspect)&&a.inspect!==d.inspect&&!(a.constructor&&a.constructor.prototype===a)){var m,h=a.inspect(g,b);return j(h)||(h=v(b,h,g)),h}var q=w(b,a);if(q)return q;var r,c=Object.keys(a),s=(r={},c.forEach(function(a,b){r[a]=!0}),r);if(b.showHidden&&(c=Object.getOwnPropertyNames(a)),o(a)&&(c.indexOf("message")>=0||c.indexOf("description")>=0))return x(a);if(0===c.length){if(p(a)){var t=a.name?": "+a.name:"";return b.stylize("[Function"+t+"]","special")}if(l(a))return b.stylize(RegExp.prototype.toString.call(a),"regexp");if(n(a))return b.stylize(Date.prototype.toString.call(a),"date");if(o(a))return x(a)}var e="",k=!1,i=["{","}"];return(f(a)&&(k=!0,i=["[","]"]),p(a)&&(e=" [Function"+(a.name?": "+a.name:"")+"]"),l(a)&&(e=" "+RegExp.prototype.toString.call(a)),n(a)&&(e=" "+Date.prototype.toUTCString.call(a)),o(a)&&(e=" "+x(a)),0!==c.length||k&&0!=a.length)?g<0?l(a)?b.stylize(RegExp.prototype.toString.call(a),"regexp"):b.stylize("[Object]","special"):(b.seen.push(a),m=k?y(b,a,g,s,c):c.map(function(c){return z(b,a,g,s,c,k)}),b.seen.pop(),A(m,e,i)):i[0]+e+i[1]}function w(b,a){if(k(a))return b.stylize("undefined","undefined");if(j(a)){var c="'"+JSON.stringify(a).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return b.stylize(c,"string")}return i(a)?b.stylize(""+a,"number"):g(a)?b.stylize(""+a,"boolean"):h(a)?b.stylize("null","null"):void 0}function x(a){return"["+Error.prototype.toString.call(a)+"]"}function y(d,b,e,f,g){for(var c=[],a=0,h=b.length;a<h;++a)E(b,String(a))?c.push(z(d,b,e,f,String(a),!0)):c.push("");return g.forEach(function(a){a.match(/^\d+$/)||c.push(z(d,b,e,f,a,!0))}),c}function z(c,f,g,j,d,i){var a,b,e;if((e=Object.getOwnPropertyDescriptor(f,d)||{value:f[d]}).get?b=e.set?c.stylize("[Getter/Setter]","special"):c.stylize("[Getter]","special"):e.set&&(b=c.stylize("[Setter]","special")),E(j,d)||(a="["+d+"]"),!b&&(0>c.seen.indexOf(e.value)?(b=h(g)?v(c,e.value,null):v(c,e.value,g-1)).indexOf("\n")> -1&&(b=i?b.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+b.split("\n").map(function(a){return"   "+a}).join("\n")):b=c.stylize("[Circular]","special")),k(a)){if(i&&d.match(/^\d+$/))return b;(a=JSON.stringify(""+d)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=c.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=c.stylize(a,"string"))}return a+": "+b}function A(b,c,a){var d=0;return b.reduce(function(b,a){return d++,a.indexOf("\n")>=0&&d++,b+a.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?a[0]+(""===c?"":c+"\n ")+" "+b.join(",\n  ")+" "+a[1]:a[0]+c+" "+b.join(", ")+" "+a[1]}function f(a){return Array.isArray(a)}function g(a){return"boolean"==typeof a}function h(a){return null===a}function i(a){return"number"==typeof a}function j(a){return"string"==typeof a}function k(a){return void 0===a}function l(a){return m(a)&&"[object RegExp]"===B(a)}function m(a){return"object"==typeof a&&null!==a}function n(a){return m(a)&&"[object Date]"===B(a)}function o(a){return m(a)&&("[object Error]"===B(a)||a instanceof Error)}function p(a){return"function"==typeof a}function B(a){return Object.prototype.toString.call(a)}function C(a){return a<10?"0"+a.toString(10):a.toString(10)}d.debuglog=function(a){if(k(q)&&(q=b.env.NODE_DEBUG||""),!s[a=a.toUpperCase()])if(new RegExp("\\b"+a+"\\b","i").test(q)){var c=b.pid;s[a]=function(){var b=d.format.apply(d,arguments);console.error("%s %d: %s",a,c,b)}}else s[a]=function(){};return s[a]},d.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},d.isArray=f,d.isBoolean=g,d.isNull=h,d.isNullOrUndefined=function(a){return null==a},d.isNumber=i,d.isString=j,d.isSymbol=function(a){return"symbol"==typeof a},d.isUndefined=k,d.isRegExp=l,d.isObject=m,d.isDate=n,d.isError=o,d.isFunction=p,d.isPrimitive=function(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a|| void 0===a},d.isBuffer=a("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(a,b){return Object.prototype.hasOwnProperty.call(a,b)}d.log=function(){var a,b;console.log("%s - %s",(b=[C((a=new Date).getHours()),C(a.getMinutes()),C(a.getSeconds())].join(":"),[a.getDate(),D[a.getMonth()],b].join(" ")),d.format.apply(d,arguments))},d.inherits=a("inherits"),d._extend=function(b,a){if(!a||!m(a))return b;for(var c=Object.keys(a),d=c.length;d--;)b[c[d]]=a[c[d]];return b}}).call(this)}).call(this,a("_process"),void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":77,"_process":278,inherits:76}],79:[function(g,h,b){"use strict";b.byteLength=function(c){var a=j(c),d=a[0],b=a[1];return(d+b)*3/4-b},b.toByteArray=function(b){var d,a,k,l=j(b),h=l[0],g=l[1],e=new i((h+(k=g))*3/4-k),f=0,m=g>0?h-4:h;for(a=0;a<m;a+=4)d=c[b.charCodeAt(a)]<<18|c[b.charCodeAt(a+1)]<<12|c[b.charCodeAt(a+2)]<<6|c[b.charCodeAt(a+3)],e[f++]=d>>16&255,e[f++]=d>>8&255,e[f++]=255&d;return 2===g&&(d=c[b.charCodeAt(a)]<<2|c[b.charCodeAt(a+1)]>>4,e[f++]=255&d),1===g&&(d=c[b.charCodeAt(a)]<<10|c[b.charCodeAt(a+1)]<<4|c[b.charCodeAt(a+2)]>>2,e[f++]=d>>8&255,e[f++]=255&d),e},b.fromByteArray=function(b){for(var a,c=b.length,g=c%3,f=[],d=0,h=c-g;d<h;d+=16383)f.push(l(b,d,d+16383>h?h:d+16383));return 1===g?(a=b[c-1],f.push(e[a>>2]+e[a<<4&63]+"==")):2===g&&(a=(b[c-2]<<8)+b[c-1],f.push(e[a>>10]+e[a>>4&63]+e[a<<2&63]+"=")),f.join("")};for(var e=[],c=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,f=d.length;a<f;++a)e[a]=d[a],c[d.charCodeAt(a)]=a;function j(c){var b=c.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=c.indexOf("=");return -1===a&&(a=b),[a,a===b?0:4-a%4]}function k(a){return e[a>>18&63]+e[a>>12&63]+e[a>>6&63]+e[63&a]}function l(b,e,f){for(var c,d=[],a=e;a<f;a+=3)c=(b[a]<<16&16711680)+(b[a+1]<<8&65280)+(255&b[a+2]),d.push(k(c));return d.join("")}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],80:[function(b,a,c){"use strict";function d(h,d,e,c,a){for(var f=a+1;c<=a;){var b=c+a>>>1,g=h[b];(void 0!==e?e(g,d):g-d)>=0?(f=b,a=b-1):c=b+1}return f}function e(h,d,e,c,a){for(var f=a+1;c<=a;){var b=c+a>>>1,g=h[b];(void 0!==e?e(g,d):g-d)>0?(f=b,a=b-1):c=b+1}return f}function f(h,d,e,a,c){for(var f=a-1;a<=c;){var b=a+c>>>1,g=h[b];(void 0!==e?e(g,d):g-d)<0?(f=b,a=b+1):c=b-1}return f}function g(h,d,e,a,c){for(var f=a-1;a<=c;){var b=a+c>>>1,g=h[b];(void 0!==e?e(g,d):g-d)<=0?(f=b,a=b+1):c=b-1}return f}function h(h,d,e,b,c){for(;b<=c;){var a=b+c>>>1,f=h[a],g=void 0!==e?e(f,d):f-d;if(0===g)return a;g<=0?b=a+1:c=a-1}return -1}function i(a,d,b,c,e,f){return"function"==typeof b?f(a,d,b,void 0===c?0:0|c,void 0===e?a.length-1:0|e):f(a,d,void 0,void 0===b?0:0|b,void 0===c?a.length-1:0|c)}a.exports={ge:function(a,b,c,e,f){return i(a,b,c,e,f,d)},gt:function(a,b,c,d,f){return i(a,b,c,d,f,e)},lt:function(a,b,c,d,e){return i(a,b,c,d,e,f)},le:function(a,b,c,d,e){return i(a,b,c,d,e,g)},eq:function(a,b,c,d,e){return i(a,b,c,d,e,h)}}},{}],81:[function(d,e,a){"use strict";"use restrict";function b(a){var b=32;return(a&=-a)&&b--,65535&a&&(b-=16),16711935&a&&(b-=8),252645135&a&&(b-=4),858993459&a&&(b-=2),1431655765&a&&(b-=1),b}a.INT_BITS=32,a.INT_MAX=2147483647,a.INT_MIN=-2147483648,a.sign=function(a){return(a>0)-(a<0)},a.abs=function(a){var b=a>>31;return(a^b)-b},a.min=function(b,a){return a^(b^a)& -(b<a)},a.max=function(a,b){return a^(a^b)& -(a<b)},a.isPow2=function(a){return!(a&a-1)&&!!a},a.log2=function(a){var c,b;return a>>>=c=(a>65535)<<4,a>>>=b=(a>255)<<3,c|=b,b=(a>15)<<2,a>>>=b,c|=b,b=(a>3)<<1,a>>>=b,c|=b,c|a>>1},a.log10=function(a){return a>=1e9?9:a>=1e8?8:a>=1e7?7:a>=1e6?6:a>=1e5?5:a>=1e4?4:a>=1e3?3:a>=100?2:a>=10?1:0},a.popCount=function(a){return a-=a>>>1&1431655765,((a=(858993459&a)+(a>>>2&858993459))+(a>>>4)&252645135)*16843009>>>24},a.countTrailingZeros=b,a.nextPow2=function(a){return a+=0===a,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a+1},a.prevPow2=function(a){return a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,(a|=a>>>16)-(a>>>1)},a.parity=function(a){return a^=a>>>16,a^=a>>>8,a^=a>>>4,27030>>>(a&=15)&1};var c=new Array(256);!function(e){for(var a=0;a<256;++a){var b=a,c=a,d=7;for(b>>>=1;b;b>>>=1)c<<=1,c|=1&b,--d;e[a]=c<<d&255}}(c),a.reverse=function(a){return c[255&a]<<24|c[a>>>8&255]<<16|c[a>>>16&255]<<8|c[a>>>24&255]},a.interleave2=function(a,b){return a&=65535,b&=65535,(a=((a=((a=((a=(a|a<<8)&16711935)|a<<4)&252645135)|a<<2)&858993459)|a<<1)&1431655765)|(b=((b=((b=((b=(b|b<<8)&16711935)|b<<4)&252645135)|b<<2)&858993459)|b<<1)&1431655765)<<1},a.deinterleave2=function(a,b){return(a=((a=((a=((a=((a=a>>>b&1431655765)|a>>>1)&858993459)|a>>>2)&252645135)|a>>>4)&16711935)|a>>>16)&65535)<<16>>16},a.interleave3=function(a,c,b){return a&=1023,a=((a=((a=((a=(a|a<<16)&4278190335)|a<<8)&251719695)|a<<4)&3272356035)|a<<2)&1227133513,c&=1023,b&=1023,b=((b=((b=((b=(b|b<<16)&4278190335)|b<<8)&251719695)|b<<4)&3272356035)|b<<2)&1227133513,(a|=(c=((c=((c=((c=(c|c<<16)&4278190335)|c<<8)&251719695)|c<<4)&3272356035)|c<<2)&1227133513)<<1)|b<<2},a.deinterleave3=function(a,b){return(a=((a=((a=((a=((a=a>>>b&1227133513)|a>>>2)&3272356035)|a>>>4)&251719695)|a>>>8)&4278190335)|a>>>16)&1023)<<22>>22},a.nextCombination=function(a){var c=a|a-1;return c+1|(~c& -~c)-1>>>b(a)+1}},{}],82:[function(a,b,c){"use strict";var d=a("clamp");function e(d,c,e,g,h,i,j){for(var a=0;a<c;a++){for(var b=0;b<e;b++)g[b]=d[b*c+a];for(f(g,h,i,j,e),b=0;b<e;b++)d[b*c+a]=h[b]}for(b=0;b<e;b++){for(a=0;a<c;a++)g[a]=d[b*c+a];for(f(g,h,i,j,c),a=0;a<c;a++)d[b*c+a]=Math.sqrt(h[a])}}function f(e,h,c,d,g){c[0]=0,d[0]=-1e20,d[1]=1e20;for(var b=1,a=0;b<g;b++){for(var f=(e[b]+b*b-(e[c[a]]+c[a]*c[a]))/(2*b-2*c[a]);f<=d[a];)a--,f=(e[b]+b*b-(e[c[a]]+c[a]*c[a]))/(2*b-2*c[a]);a++,c[a]=b,d[a]=f,d[a+1]=1e20}for(b=0,a=0;b<g;b++){for(;d[a+1]<b;)a++;h[b]=(b-c[a])*(b-c[a])+e[c[a]]}}b.exports=function(f,g){g||(g={});var a,b,n,h,p,i,o,j,k,c,l,x=null==g.cutoff?.25:g.cutoff,y=null==g.radius?8:g.radius,z=g.channel||0;if(ArrayBuffer.isView(f)||Array.isArray(f)){if(!g.width||!g.height)throw Error("For raw data width and height should be provided by options");a=g.width,b=g.height,h=f,i=g.stride?g.stride:Math.floor(f.length/a/b)}else window.HTMLCanvasElement&&f instanceof window.HTMLCanvasElement?(o=(j=f).getContext("2d"),a=j.width,b=j.height,k=o.getImageData(0,0,a,b),h=k.data,i=4):window.CanvasRenderingContext2D&&f instanceof window.CanvasRenderingContext2D?(j=f.canvas,o=f,a=j.width,b=j.height,k=o.getImageData(0,0,a,b),h=k.data,i=4):window.ImageData&&f instanceof window.ImageData&&(k=f,a=f.width,b=f.height,h=k.data,i=4);if(n=Math.max(a,b),window.Uint8ClampedArray&&h instanceof window.Uint8ClampedArray||window.Uint8Array&&h instanceof window.Uint8Array)for(c=0,p=h,h=Array(a*b),l=p.length;c<l;c++)h[c]=p[c*i+z]/255;else if(1!==i)throw Error("Raw data can have only 1 value per pixel");var q=Array(a*b),r=Array(a*b),s=Array(n),t=Array(n),u=Array(n+1),v=Array(n);for(c=0,l=a*b;c<l;c++){var m=h[c];q[c]=1===m?0:0===m?1e20:Math.pow(Math.max(0,.5-m),2),r[c]=1===m?1e20:0===m?0:Math.pow(Math.max(0,m-.5),2)}e(q,a,b,s,t,v,u),e(r,a,b,s,t,v,u);var w=window.Float32Array?new Float32Array(a*b):new Array(a*b);for(c=0,l=a*b;c<l;c++)w[c]=d(1-((q[c]-r[c])/y+x),0,1);return w}},{clamp:86}],83:[function(a,b,c){},{}],84:[function(f,c,g){"use strict";var d,b="object"==typeof Reflect?Reflect:null,h=b&&"function"==typeof b.apply?b.apply:function(a,b,c){return Function.prototype.apply.call(a,b,c)};d=b&&"function"==typeof b.ownKeys?b.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};var i=Number.isNaN||function(a){return a!=a};function a(){a.init.call(this)}c.exports=a,c.exports.once=function(a,b){return new Promise(function(e,f){var c;function d(){void 0!==c&&a.removeListener("error",c),e([].slice.call(arguments))}"error"!==b&&(c=function(c){a.removeListener(b,d),f(c)},a.once("error",c)),a.once(b,d)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var j=10;function k(a){if("function"!=typeof a)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function l(b){return void 0===b._maxListeners?a.defaultMaxListeners:b._maxListeners}function m(a,c,b,e){if(k(b),void 0===(i=a._events)?(i=a._events=Object.create(null),a._eventsCount=0):(void 0!==i.newListener&&(a.emit("newListener",c,b.listener?b.listener:b),i=a._events),f=i[c]),void 0===f)f=i[c]=b,++a._eventsCount;else if("function"==typeof f?f=i[c]=e?[b,f]:[f,b]:e?f.unshift(b):f.push(b),(h=l(a))>0&&f.length>h&&!f.warned){f.warned=!0;var h,i,f,g,d=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(c)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=a,d.type=c,d.count=f.length,g=d,console&&console.warn&&console.warn(g)}return a}function n(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function o(d,e,b){var c={fired:!1,wrapFn:void 0,target:d,type:e,listener:b},a=n.bind(c);return a.listener=b,c.wrapFn=a,a}function p(d,e,b){var c=d._events;if(void 0===c)return[];var a=c[e];return void 0===a?[]:"function"==typeof a?b?[a.listener||a]:[a]:b?r(a):q(a,a.length)}function e(c){var b=this._events;if(void 0!==b){var a=b[c];if("function"==typeof a)return 1;if(void 0!==a)return a.length}return 0}function q(d,b){for(var c=new Array(b),a=0;a<b;++a)c[a]=d[a];return c}function r(b){for(var c=new Array(b.length),a=0;a<c.length;++a)c[a]=b[a].listener||b[a];return c}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(a){if("number"!=typeof a||a<0||i(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");j=a}}),a.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||i(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(g){for(var b=[],a=1;a<arguments.length;a++)b.push(arguments[a]);var d="error"===g,e=this._events;if(void 0!==e)d=d&& void 0===e.error;else if(!d)return!1;if(d){if(b.length>0&&(f=b[0]),f instanceof Error)throw f;var f,i=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw i.context=f,i}var c=e[g];if(void 0===c)return!1;if("function"==typeof c)h(c,this,b);else for(var j=c.length,k=q(c,j),a=0;a<j;++a)h(k[a],this,b);return!0},a.prototype.addListener=function(a,b){return m(this,a,b,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(a,b){return m(this,a,b,!0)},a.prototype.once=function(a,b){return k(b),this.on(a,o(this,a,b)),this},a.prototype.prependOnceListener=function(a,b){return k(b),this.prependListener(a,o(this,a,b)),this},a.prototype.removeListener=function(e,b){var a,d,f,c,g;if(k(b),void 0===(d=this._events))return this;if(void 0===(a=d[e]))return this;if(a===b||a.listener===b)0== --this._eventsCount?this._events=Object.create(null):(delete d[e],d.removeListener&&this.emit("removeListener",e,a.listener||b));else if("function"!=typeof a){for(f=-1,c=a.length-1;c>=0;c--)if(a[c]===b||a[c].listener===b){g=a[c].listener,f=c;break}if(f<0)return this;0===f?a.shift():function(a,b){for(;b+1<a.length;b++)a[b]=a[b+1];a.pop()}(a,f),1===a.length&&(d[e]=a[0]),void 0!==d.removeListener&&this.emit("removeListener",e,g||b)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(c){var d,b,a;if(void 0===(b=this._events))return this;if(void 0===b.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==b[c]&&(0== --this._eventsCount?this._events=Object.create(null):delete b[c]),this;if(0===arguments.length){var e,f=Object.keys(b);for(a=0;a<f.length;++a)"removeListener"!==(e=f[a])&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(d=b[c]))this.removeListener(c,d);else if(void 0!==d)for(a=d.length-1;a>=0;a--)this.removeListener(c,d[a]);return this},a.prototype.listeners=function(a){return p(this,a,!0)},a.prototype.rawListeners=function(a){return p(this,a,!1)},a.listenerCount=function(a,b){return"function"==typeof a.listenerCount?a.listenerCount(b):e.call(a,b)},a.prototype.listenerCount=e,a.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},{}],85:[function(a,b,c){(function(b){(function(){"use strict";var e=a("base64-js"),f=a("ieee754");function g(a){if(a>2147483647)throw new RangeError('The value "'+a+'" is invalid for option "size"');var c=new Uint8Array(a);return c.__proto__=b.prototype,c}function b(a,b,c){if("number"==typeof a){if("string"==typeof b)throw new TypeError('The "string" argument must be of type string. Received type number');return j(a)}return h(a,b,c)}function h(a,c,d){if("string"==typeof a)return k(a,c);if(ArrayBuffer.isView(a))return l(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(S(a,ArrayBuffer)||a&&S(a.buffer,ArrayBuffer))return m(a,c,d);if("number"==typeof a)throw new TypeError('The "value" argument must not be of type number. Received type number');var e=a.valueOf&&a.valueOf();if(null!=e&&e!==a)return b.from(e,c,d);var f=n(a);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return b.from(a[Symbol.toPrimitive]("string"),c,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function i(a){if("number"!=typeof a)throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function j(a){return i(a),g(a<0?0:0|o(a))}function k(e,a){if(("string"!=typeof a||""===a)&&(a="utf8"),!b.isEncoding(a))throw new TypeError("Unknown encoding: "+a);var f=0|d(e,a),c=g(f),h=c.write(e,a);return h!==f&&(c=c.slice(0,h)),c}function l(b){for(var c=b.length<0?0:0|o(b.length),d=g(c),a=0;a<c;a+=1)d[a]=255&b[a];return d}function m(c,a,d){var e;if(a<0||c.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<a+(d||0))throw new RangeError('"length" is outside of buffer bounds');return(e=void 0===a&& void 0===d?new Uint8Array(c):void 0===d?new Uint8Array(c,a):new Uint8Array(c,a,d)).__proto__=b.prototype,e}function n(a){if(b.isBuffer(a)){var d=0|o(a.length),c=g(d);return 0===c.length||a.copy(c,0,0,d),c}return void 0!==a.length?"number"!=typeof a.length||T(a.length)?g(0):l(a):"Buffer"===a.type&&Array.isArray(a.data)?l(a.data):void 0}function o(a){if(a>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|a}function d(a,d){if(b.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||S(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var c=a.length,e=arguments.length>2&& !0===arguments[2];if(!e&&0===c)return 0;for(var f=!1;;)switch(d){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return N(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return Q(a).length;default:if(f)return e?-1:N(a).length;d=(""+d).toLowerCase(),f=!0}}function p(c,a,b){var d=!1;if((void 0===a||a<0)&&(a=0),a>this.length)return"";if((void 0===b||b>this.length)&&(b=this.length),b<=0)return"";if((b>>>=0)<=(a>>>=0))return"";for(c||(c="utf8");;)switch(c){case"hex":return E(this,a,b);case"utf8":case"utf-8":return A(this,a,b);case"ascii":return C(this,a,b);case"latin1":case"binary":return D(this,a,b);case"base64":return z(this,a,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,a,b);default:if(d)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),d=!0}}function q(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function r(d,c,a,f,e){if(0===d.length)return -1;if("string"==typeof a?(f=a,a=0):a>2147483647?a=2147483647:a< -2147483648&&(a=-2147483648),T(a=+a)&&(a=e?0:d.length-1),a<0&&(a=d.length+a),a>=d.length){if(e)return -1;a=d.length-1}else if(a<0){if(!e)return -1;a=0}if("string"==typeof c&&(c=b.from(c,f)),b.isBuffer(c))return 0===c.length?-1:s(d,c,a,f,e);if("number"==typeof c)return(c&=255,"function"==typeof Uint8Array.prototype.indexOf)?e?Uint8Array.prototype.indexOf.call(d,c,a):Uint8Array.prototype.lastIndexOf.call(d,c,a):s(d,[c],a,f,e);throw new TypeError("val must be string, number or Buffer")}function s(f,g,d,c,m){var a,k=1,h=f.length,e=g.length;if(void 0!==c&&("ucs2"===(c=String(c).toLowerCase())||"ucs-2"===c||"utf16le"===c||"utf-16le"===c)){if(f.length<2||g.length<2)return -1;k=2,h/=2,e/=2,d/=2}function i(a,b){return 1===k?a[b]:a.readUInt16BE(b*k)}if(m){var b=-1;for(a=d;a<h;a++)if(i(f,a)===i(g,-1===b?0:a-b)){if(-1===b&&(b=a),a-b+1===e)return b*k}else -1!==b&&(a-=a-b),b=-1}else for(d+e>h&&(d=h-e),a=d;a>=0;a--){for(var l=!0,j=0;j<e;j++)if(i(f,a+j)!==i(g,j)){l=!1;break}if(l)return a}return -1}function t(e,f,c,a){c=Number(c)||0;var d=e.length-c;a?(a=Number(a))>d&&(a=d):a=d;var g=f.length;a>g/2&&(a=g/2);for(var b=0;b<a;++b){var h=parseInt(f.substr(2*b,2),16);if(T(h))return b;e[c+b]=h}return b}function u(a,c,b,d){return R(N(c,a.length-b),a,b,d)}function v(a,b,c,d){return R(O(b),a,c,d)}function w(a,b,c,d){return v(a,b,c,d)}function x(a,b,c,d){return R(Q(b),a,c,d)}function y(a,c,b,d){return R(P(c,a.length-b),a,b,d)}function z(a,b,c){return 0===b&&c===a.length?e.fromByteArray(a):e.fromByteArray(a.slice(b,c))}function A(d,l,h){h=Math.min(d.length,h);for(var j=[],b=l;b<h;){var e,g,k,c,f=d[b],a=null,i=f>239?4:f>223?3:f>191?2:1;if(b+i<=h)switch(i){case 1:f<128&&(a=f);break;case 2:(192&(e=d[b+1]))==128&&(c=(31&f)<<6|63&e)>127&&(a=c);break;case 3:e=d[b+1],g=d[b+2],(192&e)==128&&(192&g)==128&&(c=(15&f)<<12|(63&e)<<6|63&g)>2047&&(c<55296||c>57343)&&(a=c);break;case 4:e=d[b+1],g=d[b+2],k=d[b+3],(192&e)==128&&(192&g)==128&&(192&k)==128&&(c=(15&f)<<18|(63&e)<<12|(63&g)<<6|63&k)>65535&&c<1114112&&(a=c)}null===a?(a=65533,i=1):a>65535&&(a-=65536,j.push(a>>>10&1023|55296),a=56320|1023&a),j.push(a),b+=i}return B(j)}function B(a){var c=a.length;if(c<=4096)return String.fromCharCode.apply(String,a);for(var d="",b=0;b<c;)d+=String.fromCharCode.apply(String,a.slice(b,b+=4096));return d}function C(c,e,a){var d="";a=Math.min(c.length,a);for(var b=e;b<a;++b)d+=String.fromCharCode(127&c[b]);return d}function D(c,e,a){var d="";a=Math.min(c.length,a);for(var b=e;b<a;++b)d+=String.fromCharCode(c[b]);return d}function E(d,b,a){var e=d.length;(!b||b<0)&&(b=0),(!a||a<0||a>e)&&(a=e);for(var f="",c=b;c<a;++c)f+=M(d[c]);return f}function F(d,e,f){for(var b=d.slice(e,f),c="",a=0;a<b.length;a+=2)c+=String.fromCharCode(b[a]+256*b[a+1]);return c}function G(a,b,c){if(a%1!=0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function H(a,c,d,e,f,g){if(!b.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>f||c<g)throw new RangeError('"value" argument is out of bounds');if(d+e>a.length)throw new RangeError("Index out of range")}function I(b,d,a,c,e,f){if(a+c>b.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function J(c,a,b,d,e){return a=+a,b>>>=0,e||I(c,a,b,4,0x7fffffffffffffff,0x8000000000000000),f.write(c,a,b,d,23,4),b+4}function K(c,a,b,d,e){return a=+a,b>>>=0,e||I(c,a,b,8,0x7fffffffffffffff,0x8000000000000000),f.write(c,a,b,d,52,8),b+8}c.Buffer=b,c.SlowBuffer=function(a){return+a!=a&&(a=0),b.alloc(+a)},c.INSPECT_MAX_BYTES=50,c.kMaxLength=2147483647,b.TYPED_ARRAY_SUPPORT=function(){try{var a=new Uint8Array(1);return a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===a.foo()}catch(b){return!1}}(),b.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&b[Symbol.species]===b&&Object.defineProperty(b,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),b.poolSize=8192,b.from=function(a,b,c){return h(a,b,c)},b.prototype.__proto__=Uint8Array.prototype,b.__proto__=Uint8Array,b.alloc=function(d,e,f){var a,b,c;return a=d,b=e,c=f,(i(a),a<=0)?g(a):void 0!==b?"string"==typeof c?g(a).fill(b,c):g(a).fill(b):g(a)},b.allocUnsafe=function(a){return j(a)},b.allocUnsafeSlow=function(a){return j(a)},b.isBuffer=function(a){return null!=a&& !0===a._isBuffer&&a!==b.prototype},b.compare=function(a,c){if(S(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),S(c,Uint8Array)&&(c=b.from(c,c.offset,c.byteLength)),!b.isBuffer(a)||!b.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===c)return 0;for(var e=a.length,f=c.length,d=0,g=Math.min(e,f);d<g;++d)if(a[d]!==c[d]){e=a[d],f=c[d];break}return e<f?-1:f<e?1:0},b.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(a,d){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return b.alloc(0);if(void 0===d)for(e=0,d=0;e<a.length;++e)d+=a[e].length;var e,f=b.allocUnsafe(d),g=0;for(e=0;e<a.length;++e){var c=a[e];if(S(c,Uint8Array)&&(c=b.from(c)),!b.isBuffer(c))throw new TypeError('"list" argument must be an Array of Buffers');c.copy(f,g),g+=c.length}return f},b.byteLength=d,b.prototype._isBuffer=!0,b.prototype.swap16=function(){var b=this.length;if(b%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<b;a+=2)q(this,a,a+1);return this},b.prototype.swap32=function(){var b=this.length;if(b%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<b;a+=4)q(this,a,a+3),q(this,a+1,a+2);return this},b.prototype.swap64=function(){var b=this.length;if(b%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<b;a+=8)q(this,a,a+7),q(this,a+1,a+6),q(this,a+2,a+5),q(this,a+3,a+4);return this},b.prototype.toString=function(){var a=this.length;return 0===a?"":0===arguments.length?A(this,0,a):p.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===b.compare(this,a)},b.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return a=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(a+=" ... "),"<Buffer "+a+">"},b.prototype.compare=function(a,c,d,e,f){if(S(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),!b.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===c&&(c=0),void 0===d&&(d=a?a.length:0),void 0===e&&(e=0),void 0===f&&(f=this.length),c<0||d>a.length||e<0||f>this.length)throw new RangeError("out of range index");if(e>=f&&c>=d)return 0;if(e>=f)return -1;if(c>=d)return 1;if(c>>>=0,d>>>=0,e>>>=0,f>>>=0,this===a)return 0;for(var h=f-e,i=d-c,l=Math.min(h,i),j=this.slice(e,f),k=a.slice(c,d),g=0;g<l;++g)if(j[g]!==k[g]){h=j[g],i=k[g];break}return h<i?-1:i<h?1:0},b.prototype.includes=function(a,b,c){return -1!==this.indexOf(a,b,c)},b.prototype.indexOf=function(a,b,c){return r(this,a,b,c,!0)},b.prototype.lastIndexOf=function(a,b,c){return r(this,a,b,c,!1)},b.prototype.write=function(d,b,a,c){if(void 0===b)c="utf8",a=this.length,b=0;else if(void 0===a&&"string"==typeof b)c=b,a=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(a)?(a>>>=0,void 0===c&&(c="utf8")):(c=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-b;if((void 0===a||a>e)&&(a=e),d.length>0&&(a<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");c||(c="utf8");for(var f=!1;;)switch(c){case"hex":return t(this,d,b,a);case"utf8":case"utf-8":return u(this,d,b,a);case"ascii":return v(this,d,b,a);case"latin1":case"binary":return w(this,d,b,a);case"base64":return x(this,d,b,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,d,b,a);default:if(f)throw new TypeError("Unknown encoding: "+c);c=(""+c).toLowerCase(),f=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},b.prototype.slice=function(c,a){var d=this.length;c=~~c,a=void 0===a?d:~~a,c<0?(c+=d)<0&&(c=0):c>d&&(c=d),a<0?(a+=d)<0&&(a=0):a>d&&(a=d),a<c&&(a=c);var e=this.subarray(c,a);return e.__proto__=b.prototype,e},b.prototype.readUIntLE=function(a,b,f){a>>>=0,b>>>=0,f||G(a,b,this.length);for(var c=this[a],d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;return c},b.prototype.readUIntBE=function(b,a,e){b>>>=0,a>>>=0,e||G(b,a,this.length);for(var c=this[b+ --a],d=1;a>0&&(d*=256);)c+=this[b+ --a]*d;return c},b.prototype.readUInt8=function(a,b){return a>>>=0,b||G(a,1,this.length),this[a]},b.prototype.readUInt16LE=function(a,b){return a>>>=0,b||G(a,2,this.length),this[a]|this[a+1]<<8},b.prototype.readUInt16BE=function(a,b){return a>>>=0,b||G(a,2,this.length),this[a]<<8|this[a+1]},b.prototype.readUInt32LE=function(a,b){return a>>>=0,b||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},b.prototype.readUInt32BE=function(a,b){return a>>>=0,b||G(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},b.prototype.readIntLE=function(a,b,f){a>>>=0,b>>>=0,f||G(a,b,this.length);for(var c=this[a],d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;return c>=(d*=128)&&(c-=Math.pow(2,8*b)),c},b.prototype.readIntBE=function(a,b,f){a>>>=0,b>>>=0,f||G(a,b,this.length);for(var d=b,e=1,c=this[a+ --d];d>0&&(e*=256);)c+=this[a+ --d]*e;return c>=(e*=128)&&(c-=Math.pow(2,8*b)),c},b.prototype.readInt8=function(a,b){return(a>>>=0,b||G(a,1,this.length),128&this[a])?-((255-this[a]+1)*1):this[a]},b.prototype.readInt16LE=function(a,c){a>>>=0,c||G(a,2,this.length);var b=this[a]|this[a+1]<<8;return 32768&b?4294901760|b:b},b.prototype.readInt16BE=function(a,c){a>>>=0,c||G(a,2,this.length);var b=this[a+1]|this[a]<<8;return 32768&b?4294901760|b:b},b.prototype.readInt32LE=function(a,b){return a>>>=0,b||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},b.prototype.readInt32BE=function(a,b){return a>>>=0,b||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},b.prototype.readFloatLE=function(a,b){return a>>>=0,b||G(a,4,this.length),f.read(this,a,!0,23,4)},b.prototype.readFloatBE=function(a,b){return a>>>=0,b||G(a,4,this.length),f.read(this,a,!1,23,4)},b.prototype.readDoubleLE=function(a,b){return a>>>=0,b||G(a,8,this.length),f.read(this,a,!0,52,8)},b.prototype.readDoubleBE=function(a,b){return a>>>=0,b||G(a,8,this.length),f.read(this,a,!1,52,8)},b.prototype.writeUIntLE=function(a,b,c,f){if(a=+a,b>>>=0,c>>>=0,!f){var g=Math.pow(2,8*c)-1;H(this,a,b,c,g,0)}var d=1,e=0;for(this[b]=255&a;++e<c&&(d*=256);)this[b+e]=a/d&255;return b+c},b.prototype.writeUIntBE=function(a,b,c,f){if(a=+a,b>>>=0,c>>>=0,!f){var g=Math.pow(2,8*c)-1;H(this,a,b,c,g,0)}var d=c-1,e=1;for(this[b+d]=255&a;--d>=0&&(e*=256);)this[b+d]=a/e&255;return b+c},b.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,1,255,0),this[b]=255&a,b+1},b.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,4294967295,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},b.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,4294967295,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeIntLE=function(a,b,c,h){if(a=+a,b>>>=0,!h){var f=Math.pow(2,8*c-1);H(this,a,b,c,f-1,-f)}var d=0,g=1,e=0;for(this[b]=255&a;++d<c&&(g*=256);)a<0&&0===e&&0!==this[b+d-1]&&(e=1),this[b+d]=(a/g>>0)-e&255;return b+c},b.prototype.writeIntBE=function(a,b,c,h){if(a=+a,b>>>=0,!h){var f=Math.pow(2,8*c-1);H(this,a,b,c,f-1,-f)}var d=c-1,g=1,e=0;for(this[b+d]=255&a;--d>=0&&(g*=256);)a<0&&0===e&&0!==this[b+d+1]&&(e=1),this[b+d]=(a/g>>0)-e&255;return b+c},b.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},b.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,2147483647,-2147483648),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},b.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeFloatLE=function(a,b,c){return J(this,a,b,!0,c)},b.prototype.writeFloatBE=function(a,b,c){return J(this,a,b,!1,c)},b.prototype.writeDoubleLE=function(a,b,c){return K(this,a,b,!0,c)},b.prototype.writeDoubleBE=function(a,b,c){return K(this,a,b,!1,c)},b.prototype.copy=function(e,d,c,a){if(!b.isBuffer(e))throw new TypeError("argument should be a Buffer");if(c||(c=0),a||0===a||(a=this.length),d>=e.length&&(d=e.length),d||(d=0),a>0&&a<c&&(a=c),a===c)return 0;if(0===e.length||0===this.length)return 0;if(d<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-d<a-c&&(a=e.length-d+c);var g=a-c;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(d,c,a);else if(this===e&&c<d&&d<a)for(var f=g-1;f>=0;--f)e[f+d]=this[f+c];else Uint8Array.prototype.set.call(e,this.subarray(c,a),d);return g},b.prototype.fill=function(a,d,c,e){if("string"==typeof a){if("string"==typeof d?(e=d,d=0,c=this.length):"string"==typeof c&&(e=c,c=this.length),void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!b.isEncoding(e))throw new TypeError("Unknown encoding: "+e);if(1===a.length){var f,g=a.charCodeAt(0);("utf8"===e&&g<128||"latin1"===e)&&(a=g)}}else"number"==typeof a&&(a&=255);if(d<0||this.length<d||this.length<c)throw new RangeError("Out of range index");if(c<=d)return this;if(d>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0),"number"==typeof a)for(f=d;f<c;++f)this[f]=a;else{var h=b.isBuffer(a)?a:b.from(a,e),i=h.length;if(0===i)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(f=0;f<c-d;++f)this[f+d]=h[f%i]}return this};var L=/[^+/0-9A-Za-z-_]/g;function M(a){return a<16?"0"+a.toString(16):a.toString(16)}function N(f,b){b=b||1/0;for(var a,g=f.length,d=null,c=[],e=0;e<g;++e){if((a=f.charCodeAt(e))>55295&&a<57344){if(!d){if(a>56319){(b-=3)> -1&&c.push(239,191,189);continue}if(e+1===g){(b-=3)> -1&&c.push(239,191,189);continue}d=a;continue}if(a<56320){(b-=3)> -1&&c.push(239,191,189),d=a;continue}a=(d-55296<<10|a-56320)+65536}else d&&(b-=3)> -1&&c.push(239,191,189);if(d=null,a<128){if((b-=1)<0)break;c.push(a)}else if(a<2048){if((b-=2)<0)break;c.push(a>>6|192,63&a|128)}else if(a<65536){if((b-=3)<0)break;c.push(a>>12|224,a>>6&63|128,63&a|128)}else if(a<1114112){if((b-=4)<0)break;c.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}else throw new Error("Invalid code point")}return c}function O(b){for(var c=[],a=0;a<b.length;++a)c.push(255&b.charCodeAt(a));return c}function P(c,g){for(var d,e,f,a=[],b=0;b<c.length&&!((g-=2)<0);++b)e=(d=c.charCodeAt(b))>>8,f=d%256,a.push(f),a.push(e);return a}function Q(a){return e.toByteArray(function(a){if((a=(a=a.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}(a))}function R(b,c,d,e){for(var a=0;a<e&& !(a+d>=c.length)&&!(a>=b.length);++a)c[a+d]=b[a];return a}function S(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function T(a){return a!=a}}).call(this)}).call(this,a("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(b,a,c){a.exports=function(a,b,c){return b<c?a<b?b:a>c?c:a:a<c?c:a>b?b:a}},{}],87:[function(c,a,d){"use strict";var e=c("clamp");function b(b,c){null==c&&(c=!0);var d=b[0],f=b[1],g=b[2],a=b[3];return null==a&&(a=c?1:255),c&&(d*=255,f*=255,g*=255,a*=255),d=255&e(d,0,255),f=255&e(f,0,255),g=255&e(g,0,255),a=255&e(a,0,255),16777216*d+(f<<16)+(g<<8)+a}a.exports=b,a.exports.to=b,a.exports.from=function(a,f){var b=(a=+a)>>>24,c=(16711680&a)>>>16,d=(65280&a)>>>8,e=255&a;return!1===f?[b,c,d,e]:[b/255,c/255,d/255,e/255]}},{clamp:86}],88:[function(b,a,c){"use strict";a.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(a,b,c){"use strict";var d=a("color-rgba"),e=a("clamp"),f=a("dtype");b.exports=function(a,g){"float"!==g&&g||(g="array"),"uint"===g&&(g="uint8"),"uint_clamped"===g&&(g="uint8_clamped");var c,b=new(f(g))(4),h="uint8"!==g&&"uint8_clamped"!==g;return(a.length&&"string"!=typeof a||(a=d(a),a[0]/=255,a[1]/=255,a[2]/=255),(c=a)instanceof Uint8Array||c instanceof Uint8ClampedArray||Array.isArray(c)&&(c[0]>1||0===c[0])&&(c[1]>1||0===c[1])&&(c[2]>1||0===c[2])&&(!c[3]||c[3]>1))?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=null!=a[3]?a[3]:255,h&&(b[0]/=255,b[1]/=255,b[2]/=255,b[3]/=255),b):(h?(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=null!=a[3]?a[3]:1):(b[0]=e(Math.floor(255*a[0]),0,255),b[1]=e(Math.floor(255*a[1]),0,255),b[2]=e(Math.floor(255*a[2]),0,255),b[3]=null==a[3]?255:e(Math.floor(255*a[3]),0,255)),b)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(a,b,d){(function(c){(function(){"use strict";var d=a("color-name"),e=a("is-plain-obj"),f=a("defined");b.exports=function(a){var l,i,b=[],j=1;if("string"==typeof a)if(d[a])b=d[a].slice(),i="rgb";else if("transparent"===a)j=0,i="rgb",b=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(a)){var h=a.slice(1),k=h.length;j=1,k<=4?(b=[parseInt(h[0]+h[0],16),parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16)],4===k&&(j=parseInt(h[3]+h[3],16)/255)):(b=[parseInt(h[0]+h[1],16),parseInt(h[2]+h[3],16),parseInt(h[4]+h[5],16)],8===k&&(j=parseInt(h[6]+h[7],16)/255)),b[0]||(b[0]=0),b[1]||(b[1]=0),b[2]||(b[2]=0),i="rgb"}else if(l=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(a)){var m=l[1],o="rgb"===m,h=m.replace(/a$/,"");i=h;var k="cmyk"===h?4:"gray"===h?1:3;b=l[2].trim().split(/\s*,\s*/).map(function(a,b){if(/%$/.test(a))return b===k?parseFloat(a)/100:"rgb"===h?255*parseFloat(a)/100:parseFloat(a);if("h"===h[b]){if(/deg$/.test(a))return parseFloat(a);if(void 0!==g[a])return g[a]}return parseFloat(a)}),m===h&&b.push(1),j=o?1:void 0===b[k]?1:b[k],b=b.slice(0,k)}else a.length>10&&/[0-9](?:\s|\/)/.test(a)&&(b=a.match(/([0-9]+)/g).map(function(a){return parseFloat(a)}),i=a.match(/([a-z])/ig).join("").toLowerCase());else if(isNaN(a))if(e(a)){var n=f(a.r,a.red,a.R,null);null!==n?(i="rgb",b=[n,f(a.g,a.green,a.G),f(a.b,a.blue,a.B)]):(i="hsl",b=[f(a.h,a.hue,a.H),f(a.s,a.saturation,a.S),f(a.l,a.lightness,a.L,a.b,a.brightness)]),j=f(a.a,a.alpha,a.opacity,1),null!=a.opacity&&(j/=100)}else(Array.isArray(a)||c.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(a))&&(b=[a[0],a[1],a[2]],i="rgb",j=4===a.length?a[3]:1);else i="rgb",b=[a>>>16,(65280&a)>>>8,255&a];return{space:i,values:b,alpha:j}};var g={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(a,b,c){"use strict";var d=a("color-parse"),e=a("color-space/hsl"),f=a("clamp");b.exports=function(c){var a,b=d(c);return b.space?((a=Array(3))[0]=f(b.values[0],0,255),a[1]=f(b.values[1],0,255),a[2]=f(b.values[2],0,255),"h"===b.space[0]&&(a=e.rgb(a)),a.push(f(b.alpha,0,1)),a):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(a,b,d){"use strict";var c=a("./rgb");b.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(h){var b,d,a,i,e,j=h[0]/360,f=h[1]/100,c=h[2]/100;if(0===f)return[e=255*c,e,e];d=c<.5?c*(1+f):c+f-c*f,b=2*c-d,i=[0,0,0];for(var g=0;g<3;g++)(a=j+ -(1/3*(g-1)))<0?a++:a>1&&a--,e=6*a<1?b+(d-b)*6*a:2*a<1?d:3*a<2?b+(d-b)*(2/3-a)*6:b,i[g]=255*e;return i}},c.hsl=function(h){var b,j,i,d=h[0]/255,e=h[1]/255,f=h[2]/255,c=Math.min(d,e,f),a=Math.max(d,e,f),g=a-c;return a===c?b=0:d===a?b=(e-f)/g:e===a?b=2+(f-d)/g:f===a&&(b=4+(d-e)/g),(b=Math.min(60*b,360))<0&&(b+=360),i=(c+a)/2,j=a===c?0:i<=.5?g/(a+c):g/(2-a-c),[b,100*j,100*i]}},{"./rgb":93}],93:[function(b,a,c){"use strict";a.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(b,a,c){a.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xe7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xe9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xe9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xe3)o.?tom(e|\xe9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(b,a,c){a.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(b,a,c){a.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(b,a,c){a.exports=["normal","italic","oblique"]},{}],98:[function(b,a,c){a.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(a,b,c){"use strict";b.exports={parse:a("./parse"),stringify:a("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(a,b,c){"use strict";var d=a("css-font-size-keywords");b.exports={isSize:function(a){return/^[\d\.]/.test(a)|| -1!==a.indexOf("/")|| -1!==d.indexOf(a)}}},{"css-font-size-keywords":95}],101:[function(a,b,c){"use strict";var d=a("unquote"),e=a("css-global-keywords"),f=a("css-system-font-keywords"),g=a("css-font-weight-keywords"),h=a("css-font-style-keywords"),i=a("css-font-stretch-keywords"),j=a("string-split-by"),k=a("./lib/util").isSize;b.exports=m;var l=m.cache={};function m(b){if("string"!=typeof b)throw new Error("Font argument must be a string.");if(l[b])return l[b];if(""===b)throw new Error("Cannot parse an empty string.");if(-1!==f.indexOf(b))return l[b]={system:b};for(var a,c={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},m=j(b,/\s+/);a=m.shift();){if(-1!==e.indexOf(a))return["style","variant","weight","stretch"].forEach(function(b){c[b]=a}),l[b]=c;if(-1!==h.indexOf(a)){c.style=a;continue}if("normal"===a||"small-caps"===a){c.variant=a;continue}if(-1!==i.indexOf(a)){c.stretch=a;continue}if(-1!==g.indexOf(a)){c.weight=a;continue}if(k(a)){var o=j(a,"/");if(c.size=o[0],null!=o[1]?c.lineHeight=n(o[1]):"/"===m[0]&&(m.shift(),c.lineHeight=n(m.shift())),!m.length)throw new Error("Missing required font-family.");return c.family=j(m.join(" "),/\s*,\s*/).map(d),l[b]=c}throw new Error("Unknown or unsupported font token: "+a)}throw new Error("Missing required font-size.")}function n(a){var b=parseFloat(a);return b.toString()===a?b:a}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(a,b,c){"use strict";var d=a("pick-by-alias"),e=a("./lib/util").isSize,f=n(a("css-global-keywords")),g=n(a("css-system-font-keywords")),h=n(a("css-font-weight-keywords")),i=n(a("css-font-style-keywords")),j=n(a("css-font-stretch-keywords")),k={normal:1,"small-caps":1},l={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1};function m(a,b){if(a&&!b[a]&&!f[a])throw Error("Unknown keyword `"+a+"`");return a}function n(b){for(var c={},a=0;a<b.length;a++)c[b[a]]=1;return c}b.exports=function(a){if((a=d(a,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return a.system&&m(a.system,g),a.system;if(m(a.style,i),m(a.variant,k),m(a.weight,h),m(a.stretch,j),null==a.size&&(a.size="1rem"),"number"==typeof a.size&&(a.size+="px"),!e)throw Error("Bad size value `"+a.size+"`");a.family||(a.family="serif"),Array.isArray(a.family)&&(a.family.length||(a.family=["serif"]),a.family=a.family.map(function(a){return l[a]?a:'"'+a+'"'}).join(", "));var b=[];return b.push(a.style),a.variant!==a.style&&b.push(a.variant),a.weight!==a.variant&&a.weight!==a.style&&b.push(a.weight),a.stretch!==a.weight&&a.stretch!==a.variant&&a.stretch!==a.style&&b.push(a.stretch),b.push(a.size+(null==a.lineHeight||"normal"===a.lineHeight||a.lineHeight+""=="1"?"":"/"+a.lineHeight)),b.push(a.family),b.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(b,a,c){a.exports=["inherit","initial","unset"]},{}],104:[function(b,a,c){a.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(a,b,d){"use strict";var c,e=a("type/value/is"),f=a("type/value/ensure"),g=a("type/plain-function/ensure"),h=a("es5-ext/object/copy"),i=a("es5-ext/object/normalize-options"),j=a("es5-ext/object/map"),k=Function.prototype.bind,l=Object.defineProperty,m=Object.prototype.hasOwnProperty;c=function(c,b,d){var a,e=f(b)&&g(b.value);return delete(a=h(b)).writable,delete a.value,a.get=function(){return!d.overwriteDefinition&&m.call(this,c)?e:(b.value=k.call(e,d.resolveContext?d.resolveContext(this):this),l(this,c,b),this[c])},a},b.exports=function(b){var a=i(arguments[1]);return e(a.resolveContext)&&g(a.resolveContext),j(b,function(b,d){return c(d,b,a)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(a,b,c){"use strict";var d=a("type/value/is"),e=a("type/plain-function/is"),f=a("es5-ext/object/assign"),g=a("es5-ext/object/normalize-options"),h=a("es5-ext/string/#/contains");(b.exports=function(a,c){var e,i,j,b,k;return arguments.length<2||"string"!=typeof a?(b=c,c=a,a=null):b=arguments[2],d(a)?(e=h.call(a,"c"),i=h.call(a,"e"),j=h.call(a,"w")):(e=j=!0,i=!1),k={value:c,configurable:e,enumerable:i,writable:j},b?f(g(b),k):k}).gs=function(c,b,a){var j,k,i,l;return"string"!=typeof c?(i=a,a=b,b=c,c=null):i=arguments[3],d(b)?e(b)?d(a)?e(a)||(i=a,a=void 0):a=void 0:(i=b,b=a=void 0):b=void 0,d(c)?(j=h.call(c,"c"),k=h.call(c,"e")):(j=!0,k=!1),l={get:b,set:a,configurable:j,enumerable:k},i?f(g(i),l):l}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(b,c,d){!function(e,b){"object"==typeof d&& void 0!==c?b(d):"function"==typeof a&&a.amd?a(["exports"],b):b(e.d3=e.d3||{})}(this,function(a){"use strict";function b(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function c(a){return 1===a.length&&(a=r(a)),{left:function(e,f,b,c){for(null==b&&(b=0),null==c&&(c=e.length);b<c;){var d=b+c>>>1;0>a(e[d],f)?b=d+1:c=d}return b},right:function(e,f,b,c){for(null==b&&(b=0),null==c&&(c=e.length);b<c;){var d=b+c>>>1;a(e[d],f)>0?c=d:b=d+1}return b}}}function r(a){return function(c,d){return b(a(c),d)}}var d=c(b),e=d.right,g=d.left;function s(a,b){return[a,b]}function t(a){return null===a?NaN:+a}function h(d,h){var a,e,i=d.length,f=0,c=-1,b=0,g=0;if(null==h)for(;++c<i;)isNaN(a=t(d[c]))||(b+=(e=a-b)/ ++f,g+=e*(a-b));else for(;++c<i;)isNaN(a=t(h(d[c],c,d)))||(b+=(e=a-b)/ ++f,g+=e*(a-b));if(f>1)return g/(f-1)}function i(b,c){var a=h(b,c);return a?Math.sqrt(a):a}function j(c,g){var a,d,e,f=c.length,b=-1;if(null==g){for(;++b<f;)if(null!=(a=c[b])&&a>=a)for(d=e=a;++b<f;)null!=(a=c[b])&&(d>a&&(d=a),e<a&&(e=a))}else for(;++b<f;)if(null!=(a=g(c[b],b,c))&&a>=a)for(d=e=a;++b<f;)null!=(a=g(c[b],b,c))&&(d>a&&(d=a),e<a&&(e=a));return[d,e]}var f=Array.prototype,u=f.slice,v=f.map;function w(a){return function(){return a}}function x(a){return a}function k(a,b,c){a=+a,b=+b,c=(e=arguments.length)<2?(b=a,a=0,1):e<3?1:+c;for(var d=-1,e=0|Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a+d*c;return f}var y=Math.sqrt(50),z=Math.sqrt(10),A=Math.sqrt(2);function l(d,e,f){var c=(e-d)/Math.max(0,f),b=Math.floor(Math.log(c)/Math.LN10),a=c/Math.pow(10,b);return b>=0?(a>=y?10:a>=z?5:a>=A?2:1)*Math.pow(10,b):-Math.pow(10,-b)/(a>=y?10:a>=z?5:a>=A?2:1)}function m(c,d,f){var e=Math.abs(d-c)/Math.max(0,f),a=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),b=e/a;return b>=y?a*=10:b>=z?a*=5:b>=A&&(a*=2),d<c?-a:a}function n(a){return Math.ceil(Math.log(a.length)/Math.LN2)+1}function o(a,d,b){if(null==b&&(b=t),g=a.length){if((d=+d)<=0||g<2)return+b(a[0],0,a);if(d>=1)return+b(a[g-1],g-1,a);var g,e=(g-1)*d,c=Math.floor(e),f=+b(a[c],c,a);return f+(+b(a[c+1],c+1,a)-f)*(e-c)}}function p(c,f){var a,d,e=c.length,b=-1;if(null==f){for(;++b<e;)if(null!=(a=c[b])&&a>=a)for(d=a;++b<e;)null!=(a=c[b])&&d>a&&(d=a)}else for(;++b<e;)if(null!=(a=f(c[b],b,c))&&a>=a)for(d=a;++b<e;)null!=(a=f(c[b],b,c))&&d>a&&(d=a);return d}function q(a){if(!(f=a.length))return[];for(var b=-1,d=p(a,B),e=new Array(d);++b<d;)for(var f,c=-1,g=e[b]=new Array(f);++c<f;)g[c]=a[c][b];return e}function B(a){return a.length}a.bisect=e,a.bisectRight=e,a.bisectLeft=g,a.ascending=b,a.bisector=c,a.cross=function(e,f,c){var a,b,d,g,h=e.length,i=f.length,j=new Array(h*i);for(null==c&&(c=s),a=d=0;a<h;++a)for(g=e[a],b=0;b<i;++b,++d)j[d]=c(g,f[b]);return j},a.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},a.deviation=i,a.extent=j,a.histogram=function(){var b=x,c=j,d=n;function a(j){var a,n,o=j.length,l=new Array(o);for(a=0;a<o;++a)l[a]=b(j[a],a,j);var q=c(l),h=q[0],i=q[1],f=d(l,h,i);Array.isArray(f)||(f=m(h,i,f),f=k(Math.ceil(h/f)*f,i,f));for(var g=f.length;f[0]<=h;)f.shift(),--g;for(;f[g-1]>i;)f.pop(),--g;var r,p=new Array(g+1);for(a=0;a<=g;++a)(r=p[a]=[]).x0=a>0?f[a-1]:h,r.x1=a<g?f[a]:i;for(a=0;a<o;++a)h<=(n=l[a])&&n<=i&&p[e(f,n,0,g)].push(j[a]);return p}return a.value=function(c){return arguments.length?(b="function"==typeof c?c:w(c),a):b},a.domain=function(b){return arguments.length?(c="function"==typeof b?b:w([b[0],b[1]]),a):c},a.thresholds=function(b){return arguments.length?(d="function"==typeof b?b:Array.isArray(b)?w(u.call(b)):w(b),a):d},a},a.thresholdFreedmanDiaconis=function(a,c,d){return Math.ceil((d-c)/(2*(o(a=v.call(a,t).sort(b),.75)-o(a,.25))*Math.pow(a.length,-1/3)))},a.thresholdScott=function(a,b,c){return Math.ceil((c-b)/(3.5*i(a)*Math.pow(a.length,-1/3)))},a.thresholdSturges=n,a.max=function(c,f){var a,d,e=c.length,b=-1;if(null==f){for(;++b<e;)if(null!=(a=c[b])&&a>=a)for(d=a;++b<e;)null!=(a=c[b])&&a>d&&(d=a)}else for(;++b<e;)if(null!=(a=f(c[b],b,c))&&a>=a)for(d=a;++b<e;)null!=(a=f(c[b],b,c))&&a>d&&(d=a);return d},a.mean=function(b,g){var c,e=b.length,d=e,a=-1,f=0;if(null==g)for(;++a<e;)isNaN(c=t(b[a]))?--d:f+=c;else for(;++a<e;)isNaN(c=t(g(b[a],a,b)))?--d:f+=c;if(d)return f/d},a.median=function(c,f){var d,g=c.length,a=-1,e=[];if(null==f)for(;++a<g;)isNaN(d=t(c[a]))||e.push(d);else for(;++a<g;)isNaN(d=t(f(c[a],a,c)))||e.push(d);return o(e.sort(b),.5)},a.merge=function(a){for(var b,c,f,d=a.length,g=-1,e=0;++g<d;)e+=a[g].length;for(c=new Array(e);--d>=0;)for(b=(f=a[d]).length;--b>=0;)c[--e]=f[b];return c},a.min=p,a.pairs=function(a,b){null==b&&(b=s);for(var c=0,d=a.length-1,e=a[0],f=new Array(d<0?0:d);c<d;)f[c]=b(e,e=a[++c]);return f},a.permute=function(d,b){for(var a=b.length,c=new Array(a);a--;)c[a]=d[b[a]];return c},a.quantile=o,a.range=k,a.scan=function(d,c){if(h=d.length){var h,g,e=0,f=0,a=d[f];for(null==c&&(c=b);++e<h;)(0>c(g=d[e],a)||0!==c(a,a))&&(a=g,f=e);if(0===c(a,a))return f}},a.shuffle=function(b,a,e){for(var f,d,c=(null==e?b.length:e)-(a=null==a?0:+a);c;)d=Math.random()*c--|0,f=b[c+a],b[c+a]=b[d+a],b[d+a]=f;return b},a.sum=function(b,e){var c,f=b.length,a=-1,d=0;if(null==e)for(;++a<f;)(c=+b[a])&&(d+=c);else for(;++a<f;)(c=+e(b[a],a,b))&&(d+=c);return d},a.ticks=function(a,b,g){var h,d,e,c,f=-1;if(g=+g,(a=+a)==(b=+b)&&g>0)return[a];if((h=b<a)&&(d=a,a=b,b=d),0===(c=l(a,b,g))||!isFinite(c))return[];if(c>0)for(a=Math.ceil(a/c),b=Math.floor(b/c),e=new Array(d=Math.ceil(b-a+1));++f<d;)e[f]=(a+f)*c;else for(a=Math.floor(a*c),b=Math.ceil(b*c),e=new Array(d=Math.ceil(a-b+1));++f<d;)e[f]=(a-f)/c;return h&&e.reverse(),e},a.tickIncrement=l,a.tickStep=m,a.transpose=q,a.variance=h,a.zip=function(){return q(arguments)},Object.defineProperty(a,"__esModule",{value:!0})})},{}],108:[function(b,c,d){!function(e,b){"object"==typeof d&& void 0!==c?b(d):"function"==typeof a&&a.amd?a(["exports"],b):b(e.d3=e.d3||{})}(this,function(a){"use strict";function d(){}function c(a,e){var c=new d;if(a instanceof d)a.each(function(a,b){c.set(b,a)});else if(Array.isArray(a)){var f,b=-1,g=a.length;if(null==e)for(;++b<g;)c.set(b,a[b]);else for(;++b<g;)c.set(e(f=a[b],b,a),f)}else if(a)for(var h in a)c.set(h,a[h]);return c}function g(){return{}}function h(a,b,c){a[b]=c}function i(){return c()}function j(a,b,c){a.set(b,c)}function e(){}d.prototype=c.prototype={constructor:d,has:function(a){return"$"+a in this},get:function(a){return this["$"+a]},set:function(a,b){return this["$"+a]=b,this},remove:function(b){var a="$"+b;return a in this&&delete this[a]},clear:function(){for(var a in this)"$"===a[0]&&delete this[a]},keys:function(){var a=[];for(var b in this)"$"===b[0]&&a.push(b.slice(1));return a},values:function(){var a=[];for(var b in this)"$"===b[0]&&a.push(this[b]);return a},entries:function(){var b=[];for(var a in this)"$"===a[0]&&b.push({key:a.slice(1),value:this[a]});return b},size:function(){var a=0;for(var b in this)"$"===b[0]&& ++a;return a},empty:function(){for(var a in this)if("$"===a[0])return!1;return!0},each:function(b){for(var a in this)"$"===a[0]&&b(this[a],a.slice(1),this)}};var b=c.prototype;function f(a,d){var c=new e;if(a instanceof e)a.each(function(a){c.add(a)});else if(a){var b=-1,f=a.length;if(null==d)for(;++b<f;)c.add(a[b]);else for(;++b<f;)c.add(d(a[b],b,a))}return c}e.prototype=f.prototype={constructor:e,has:b.has,add:function(a){return this["$"+(a+="")]=a,this},remove:b.remove,clear:b.clear,values:b.keys,size:b.size,empty:b.empty,each:b.each},a.nest=function(){var b,d,a,e=[],f=[];function k(a,h,m,q){if(h>=e.length)return null!=b&&a.sort(b),null!=d?d(a):a;for(var i,f,j,l=-1,n=a.length,o=e[h++],g=c(),p=m();++l<n;)(j=g.get(i=o(f=a[l])+""))?j.push(f):g.set(i,[f]);return g.each(function(a,b){q(p,b,k(a,h,m,q))}),p}function l(b,c){if(++c>e.length)return b;var a,g=f[c-1];return null!=d&&c>=e.length?a=b.entries():(a=[],b.each(function(b,d){a.push({key:d,values:l(b,c)})})),null!=g?a.sort(function(a,b){return g(a.key,b.key)}):a}return a={object:function(a){return k(a,0,g,h)},map:function(a){return k(a,0,i,j)},entries:function(a){return l(k(a,0,i,j),0)},key:function(b){return e.push(b),a},sortKeys:function(b){return f[e.length-1]=b,a},sortValues:function(c){return b=c,a},rollup:function(b){return d=b,a}}},a.set=f,a.map=c,a.keys=function(b){var a=[];for(var c in b)a.push(c);return a},a.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},a.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},Object.defineProperty(a,"__esModule",{value:!0})})},{}],109:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(b){"use strict";function c(a,c,b){a.prototype=c.prototype=b,b.constructor=a}function f(d,a){var b=Object.create(d.prototype);for(var c in a)b[c]=a[c];return b}function d(){}var e="\\s*([+-]?\\d+)\\s*",g="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",x=/^#([0-9a-f]{3,8})$/,y=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),z=new RegExp("^rgb\\("+[a,a,a]+"\\)$"),A=new RegExp("^rgba\\("+[e,e,e,g]+"\\)$"),B=new RegExp("^rgba\\("+[a,a,a,g]+"\\)$"),C=new RegExp("^hsl\\("+[g,a,a]+"\\)$"),D=new RegExp("^hsla\\("+[g,a,a,g]+"\\)$"),E={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function i(){return this.rgb().formatHex()}function j(){return this.rgb().formatRgb()}function k(b){var a,c;return b=(b+"").trim().toLowerCase(),(a=x.exec(b))?(c=a[1].length,a=parseInt(a[1],16),6===c?F(a):3===c?new s(a>>8&15|a>>4&240,a>>4&15|240&a,(15&a)<<4|15&a,1):8===c?G(a>>24&255,a>>16&255,a>>8&255,(255&a)/255):4===c?G(a>>12&15|a>>8&240,a>>8&15|a>>4&240,a>>4&15|240&a,((15&a)<<4|15&a)/255):null):(a=y.exec(b))?new s(a[1],a[2],a[3],1):(a=z.exec(b))?new s(255*a[1]/100,255*a[2]/100,255*a[3]/100,1):(a=A.exec(b))?G(a[1],a[2],a[3],a[4]):(a=B.exec(b))?G(255*a[1]/100,255*a[2]/100,255*a[3]/100,a[4]):(a=C.exec(b))?J(a[1],a[2]/100,a[3]/100,1):(a=D.exec(b))?J(a[1],a[2]/100,a[3]/100,a[4]):E.hasOwnProperty(b)?F(E[b]):"transparent"===b?new s(NaN,NaN,NaN,0):null}function F(a){return new s(a>>16&255,a>>8&255,255&a,1)}function G(a,b,c,d){return d<=0&&(a=b=c=NaN),new s(a,b,c,d)}function H(a){return(a instanceof d||(a=k(a)),a)?(a=a.rgb(),new s(a.r,a.g,a.b,a.opacity)):new s}function l(a,c,d,b){return 1===arguments.length?H(a):new s(a,c,d,null==b?1:b)}function s(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function m(){return"#"+I(this.r)+I(this.g)+I(this.b)}function n(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}function I(a){return((a=Math.max(0,Math.min(255,Math.round(a)||0)))<16?"0":"")+a.toString(16)}function J(a,b,c,d){return d<=0?a=b=c=NaN:c<=0||c>=1?a=b=NaN:b<=0&&(a=NaN),new t(a,b,c,d)}function K(a){if(a instanceof t)return new t(a.h,a.s,a.l,a.opacity);if(a instanceof d||(a=k(a)),!a)return new t;if(a instanceof t)return a;var f=(a=a.rgb()).r/255,c=a.g/255,g=a.b/255,h=Math.min(f,c,g),e=Math.max(f,c,g),i=NaN,b=e-h,j=(e+h)/2;return b?(i=f===e?(c-g)/b+(c<g)*6:c===e?(g-f)/b+2:(f-c)/b+4,b/=j<.5?e+h:2-e-h,i*=60):b=j>0&&j<1?0:i,new t(i,b,j,a.opacity)}function o(a,c,d,b){return 1===arguments.length?K(a):new t(a,c,d,null==b?1:b)}function t(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function L(a,b,c){return(a<60?b+(c-b)*a/60:a<180?c:a<240?b+(c-b)*(240-a)/60:b)*255}c(d,k,{copy:function(a){return Object.assign(new this.constructor,this,a)},displayable:function(){return this.rgb().displayable()},hex:i,formatHex:i,formatHsl:function(){return K(this).formatHsl()},formatRgb:j,toString:j}),c(s,l,f(d,{brighter:function(a){return a=null==a?1.4285714285714286:Math.pow(1.4285714285714286,a),new s(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new s(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return -0.5<=this.r&&this.r<255.5&& -0.5<=this.g&&this.g<255.5&& -0.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:m,formatHex:m,formatRgb:n,toString:n})),c(t,o,f(d,{brighter:function(a){return a=null==a?1.4285714285714286:Math.pow(1.4285714285714286,a),new t(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new t(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+(this.h<0)*360,e=isNaN(a)||isNaN(this.s)?0:this.s,b=this.l,c=b+(b<.5?b:1-b)*e,d=2*b-c;return new s(L(a>=240?a-240:a+120,d,c),L(a,d,c),L(a<120?a+240:a-120,d,c),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===a?")":", "+a+")")}}));var M=Math.PI/180,N=180/Math.PI,O=4/29,h=6/29,P=3*h*h,Q=h*h*h;function R(a){if(a instanceof u)return new u(a.l,a.a,a.b,a.opacity);if(a instanceof v)return X(a);a instanceof s||(a=H(a));var f,g,c=V(a.r),b=V(a.g),d=V(a.b),e=S((.2225045*c+.7168786*b+.0606169*d)/1);return c===b&&b===d?f=g=e:(f=S((.4360747*c+.3850649*b+.1430804*d)/.96422),g=S((.0139322*c+.0971045*b+.7141733*d)/.82521)),new u(116*e-16,500*(f-e),200*(e-g),a.opacity)}function p(a,c,d,b){return 1===arguments.length?R(a):new u(a,c,d,null==b?1:b)}function u(a,b,c,d){this.l=+a,this.a=+b,this.b=+c,this.opacity=+d}function S(a){return a>Q?Math.pow(a,1/3):a/P+O}function T(a){return a>h?a*a*a:P*(a-O)}function U(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function V(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function W(a){if(a instanceof v)return new v(a.h,a.c,a.l,a.opacity);if(a instanceof u||(a=R(a)),0===a.a&&0===a.b)return new v(NaN,0<a.l&&a.l<100?0:NaN,a.l,a.opacity);var b=Math.atan2(a.b,a.a)*N;return new v(b<0?b+360:b,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity)}function q(a,c,d,b){return 1===arguments.length?W(a):new v(a,c,d,null==b?1:b)}function v(a,b,c,d){this.h=+a,this.c=+b,this.l=+c,this.opacity=+d}function X(a){if(isNaN(a.h))return new u(a.l,0,0,a.opacity);var b=a.h*M;return new u(a.l,Math.cos(b)*a.c,Math.sin(b)*a.c,a.opacity)}c(u,p,f(d,{brighter:function(a){return new u(this.l+18*(null==a?1:a),this.a,this.b,this.opacity)},darker:function(a){return new u(this.l-18*(null==a?1:a),this.a,this.b,this.opacity)},rgb:function(){var a=(this.l+16)/116,b=isNaN(this.a)?a:a+this.a/500,c=isNaN(this.b)?a:a-this.b/200;return b=.96422*T(b),a=1*T(a),c=.82521*T(c),new s(U(3.1338561*b-1.6168667*a-.4906146*c),U(-0.9787684*b+1.9161415*a+.033454*c),U(.0719453*b-.2289914*a+1.4052427*c),this.opacity)}})),c(v,q,f(d,{brighter:function(a){return new v(this.h,this.c,this.l+18*(null==a?1:a),this.opacity)},darker:function(a){return new v(this.h,this.c,this.l-18*(null==a?1:a),this.opacity)},rgb:function(){return X(this).rgb()}}));var Y=-0.5210501878999999-.1347134789;function r(a,c,d,b){return 1===arguments.length?function(a){if(a instanceof w)return new w(a.h,a.s,a.l,a.opacity);a instanceof s||(a=H(a));var i=a.r/255,f=a.g/255,g=a.b/255,b=(Y*g+ -1.7884503806*i-3.5172982438*f)/(Y+ -1.7884503806-3.5172982438),c=g-b,d=-((1.97294*(f-b)- -0.29227*c)/.90649),h=Math.sqrt(d*d+c*c)/(1.97294*b*(1-b)),e=h?Math.atan2(d,c)*N-120:NaN;return new w(e<0?e+360:e,h,b,a.opacity)}(a):new w(a,c,d,null==b?1:b)}function w(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}c(w,r,f(d,{brighter:function(a){return a=null==a?1.4285714285714286:Math.pow(1.4285714285714286,a),new w(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?.7:Math.pow(.7,a),new w(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var d=isNaN(this.h)?0:(this.h+120)*M,a=+this.l,b=isNaN(this.s)?0:this.s*a*(1-a),c=Math.cos(d),e=Math.sin(d);return new s(255*(a+b*(-0.14861*c+1.78277*e)),255*(a+b*(-0.29227*c+ -0.90649*e)),255*(a+b*(1.97294*c)),this.opacity)}})),b.color=k,b.cubehelix=r,b.gray=function(b,a){return new u(b,0,0,null==a?1:a)},b.hcl=q,b.hsl=o,b.lab=p,b.lch=function(a,c,d,b){return 1===arguments.length?W(a):new v(d,c,a,null==b?1:b)},b.rgb=l,Object.defineProperty(b,"__esModule",{value:!0})})},{}],110:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(a){"use strict";var d={value:function(){}};function b(){for(var a,b=0,e=arguments.length,d={};b<e;++b){if(!(a=arguments[b]+"")||a in d||/[\s.]/.test(a))throw new Error("illegal type: "+a);d[a]=[]}return new c(d)}function c(a){this._=a}function e(b,d){for(var c,a=0,e=b.length;a<e;++a)if((c=b[a]).name===d)return c.value}function f(a,c,e){for(var b=0,f=a.length;b<f;++b)if(a[b].name===c){a[b]=d,a=a.slice(0,b).concat(a.slice(b+1));break}return null!=e&&a.push({name:c,value:e}),a}c.prototype=b.prototype={constructor:c,on:function(c,d){var i,k,a,b=this._,h=(i=c+"",k=b,i.trim().split(/^|\s+/).map(function(a){var c="",b=a.indexOf(".");if(b>=0&&(c=a.slice(b+1),a=a.slice(0,b)),a&&!k.hasOwnProperty(a))throw new Error("unknown type: "+a);return{type:a,name:c}})),g=-1,j=h.length;if(arguments.length<2){for(;++g<j;)if((a=(c=h[g]).type)&&(a=e(b[a],c.name)))return a;return}if(null!=d&&"function"!=typeof d)throw new Error("invalid callback: "+d);for(;++g<j;)if(a=(c=h[g]).type)b[a]=f(b[a],c.name,d);else if(null==d)for(a in b)b[a]=f(b[a],c.name,null);return this},copy:function(){var a={},b=this._;for(var d in b)a[d]=b[d].slice();return new c(a)},call:function(c,f){if((b=arguments.length-2)>0)for(var b,d,e=new Array(b),a=0;a<b;++a)e[a]=arguments[a+2];if(!this._.hasOwnProperty(c))throw new Error("unknown type: "+c);for(d=this._[c],a=0,b=d.length;a<b;++a)d[a].value.apply(f,e)},apply:function(a,d,e){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var c=this._[a],b=0,f=c.length;b<f;++b)c[b].value.apply(d,e)}},a.dispatch=b,Object.defineProperty(a,"__esModule",{value:!0})})},{}],111:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-quadtree"),b("d3-collection"),b("d3-dispatch"),b("d3-timer")):"function"==typeof a&&a.amd?a(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],f):f(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3)}(this,function(a,b,c,d,e){"use strict";function f(a){return function(){return a}}function g(){return(Math.random()-.5)*1e-6}function h(a){return a.x+a.vx}function i(a){return a.y+a.vy}function j(a){return a.index}function k(c,a){var b=c.get(a);if(!b)throw new Error("missing: "+a);return b}function l(a){return a.x}function m(a){return a.y}var n=Math.PI*(3-Math.sqrt(5));a.forceCenter=function(b,c){var d;function a(){var a,e,f=d.length,g=0,h=0;for(a=0;a<f;++a)g+=(e=d[a]).x,h+=e.y;for(g=g/f-b,h=h/f-c,a=0;a<f;++a)e=d[a],e.x-=g,e.y-=h}return null==b&&(b=0),null==c&&(c=0),a.initialize=function(a){d=a},a.x=function(c){return arguments.length?(b=+c,a):b},a.y=function(b){return arguments.length?(c=+b,a):c},a},a.forceCollide=function(c){var d,e,j=1,k=1;function a(){for(var c,f,a,o,p,m,q,r=d.length,n=0;n<k;++n)for(c=0,f=b.quadtree(d,h,i).visitAfter(l);c<r;++c)q=(m=e[(a=d[c]).index])*m,o=a.x+a.vx,p=a.y+a.vy,f.visit(s);function s(i,k,l,n,r){var d=i.data,h=i.r,b=m+h;if(d){if(d.index>a.index){var e=o-d.x-d.vx,f=p-d.y-d.vy,c=e*e+f*f;c<b*b&&(0===e&&(c+=(e=g())*e),0===f&&(c+=(f=g())*f),c=(b-(c=Math.sqrt(c)))/c*j,a.vx+=(e*=c)*(b=(h*=h)/(q+h)),a.vy+=(f*=c)*b,d.vx-=e*(b=1-b),d.vy-=f*b)}return}return k>o+b||n<o-b||l>p+b||r<p-b}}function l(a){if(a.data)return a.r=e[a.data.index];for(var b=a.r=0;b<4;++b)a[b]&&a[b].r>a.r&&(a.r=a[b].r)}function m(){if(d){var a,b,f=d.length;for(a=0,e=new Array(f);a<f;++a)e[(b=d[a]).index]=+c(b,a,d)}}return"function"!=typeof c&&(c=f(null==c?1:+c)),a.initialize=function(a){d=a,m()},a.iterations=function(b){return arguments.length?(k=+b,a):k},a.strength=function(b){return arguments.length?(j=+b,a):j},a.radius=function(b){return arguments.length?(c="function"==typeof b?b:f(+b),m(),a):c},a},a.forceLink=function(b){var d,e,h,i,l,m=j,n=function(a){return 1/Math.min(i[a.source.index],i[a.target.index])},o=f(30),p=1;function a(o){for(var m=0,q=b.length;m<p;++m)for(var n,a,c,f,h,i,k,j=0;j<q;++j)a=(n=b[j]).source,f=(c=n.target).x+c.vx-a.x-a.vx||g(),h=c.y+c.vy-a.y-a.vy||g(),i=Math.sqrt(f*f+h*h),i=(i-e[j])/i*o*d[j],f*=i,h*=i,c.vx-=f*(k=l[j]),c.vy-=h*k,a.vx+=f*(k=1-k),a.vy+=h*k}function q(){if(h){var f,a,n=h.length,g=b.length,j=c.map(h,m);for(f=0,i=new Array(n);f<g;++f)(a=b[f]).index=f,"object"!=typeof a.source&&(a.source=k(j,a.source)),"object"!=typeof a.target&&(a.target=k(j,a.target)),i[a.source.index]=(i[a.source.index]||0)+1,i[a.target.index]=(i[a.target.index]||0)+1;for(f=0,l=new Array(g);f<g;++f)a=b[f],l[f]=i[a.source.index]/(i[a.source.index]+i[a.target.index]);d=new Array(g),r(),e=new Array(g),s()}}function r(){if(h)for(var a=0,c=b.length;a<c;++a)d[a]=+n(b[a],a,b)}function s(){if(h)for(var a=0,c=b.length;a<c;++a)e[a]=+o(b[a],a,b)}return null==b&&(b=[]),a.initialize=function(a){h=a,q()},a.links=function(c){return arguments.length?(b=c,q(),a):b},a.id=function(b){return arguments.length?(m=b,a):m},a.iterations=function(b){return arguments.length?(p=+b,a):p},a.strength=function(b){return arguments.length?(n="function"==typeof b?b:f(+b),r(),a):n},a.distance=function(b){return arguments.length?(o="function"==typeof b?b:f(+b),s(),a):o},a},a.forceManyBody=function(){var c,d,e,h,i=f(-30),j=1,k=1/0,n=.81;function a(f){var a,g=c.length,h=b.quadtree(c,l,m).visitAfter(p);for(e=f,a=0;a<g;++a)d=c[a],h.visit(q)}function o(){if(c){var a,b,d=c.length;for(a=0,h=new Array(d);a<d;++a)h[(b=c[a]).index]=+i(b,a,c)}}function p(b){var a,c,e,f,d,g=0,i=0;if(b.length){for(e=f=d=0;d<4;++d)(a=b[d])&&(c=Math.abs(a.value))&&(g+=a.value,i+=c,e+=c*a.x,f+=c*a.y);b.x=e/i,b.y=f/i}else{(a=b).x=a.data.x,a.y=a.data.y;do g+=h[a.data.index];while(a=a.next)}b.value=g}function q(b,l,o,m){if(!b.value)return!0;var c=b.x-d.x,f=b.y-d.y,i=m-l,a=c*c+f*f;if(i*i/n<a)return a<k&&(0===c&&(a+=(c=g())*c),0===f&&(a+=(f=g())*f),a<j&&(a=Math.sqrt(j*a)),d.vx+=c*b.value*e/a,d.vy+=f*b.value*e/a),!0;if(!b.length&&!(a>=k)){(b.data!==d||b.next)&&(0===c&&(a+=(c=g())*c),0===f&&(a+=(f=g())*f),a<j&&(a=Math.sqrt(j*a)));do b.data!==d&&(i=h[b.data.index]*e/a,d.vx+=c*i,d.vy+=f*i);while(b=b.next)}}return a.initialize=function(a){c=a,o()},a.strength=function(b){return arguments.length?(i="function"==typeof b?b:f(+b),o(),a):i},a.distanceMin=function(b){return arguments.length?(j=b*b,a):Math.sqrt(j)},a.distanceMax=function(b){return arguments.length?(k=b*b,a):Math.sqrt(k)},a.theta=function(b){return arguments.length?(n=b*b,a):Math.sqrt(n)},a},a.forceRadial=function(b,c,d){var e,g,h,i=f(.1);function a(l){for(var a=0,m=e.length;a<m;++a){var b=e[a],f=b.x-c||1e-6,i=b.y-d||1e-6,j=Math.sqrt(f*f+i*i),k=(h[a]-j)*g[a]*l/j;b.vx+=f*k,b.vy+=i*k}}function j(){if(e){var a,c=e.length;for(a=0,g=new Array(c),h=new Array(c);a<c;++a)h[a]=+b(e[a],a,e),g[a]=isNaN(h[a])?0:+i(e[a],a,e)}}return"function"!=typeof b&&(b=f(+b)),null==c&&(c=0),null==d&&(d=0),a.initialize=function(a){e=a,j()},a.strength=function(b){return arguments.length?(i="function"==typeof b?b:f(+b),j(),a):i},a.radius=function(c){return arguments.length?(b="function"==typeof c?c:f(+c),j(),a):b},a.x=function(b){return arguments.length?(c=+b,a):c},a.y=function(b){return arguments.length?(d=+b,a):d},a},a.forceSimulation=function(a){var b,i=1,f=.001,j=1-Math.pow(f,1/300),k=0,l=.6,m=c.map(),o=e.timer(q),p=d.dispatch("tick","end");function q(){g(),p.call("tick",b),i<f&&(o.stop(),p.call("end",b))}function g(e){var d,c,g=a.length;void 0===e&&(e=1);for(var f=0;f<e;++f)for(i+=(k-i)*j,m.each(function(a){a(i)}),d=0;d<g;++d)null==(c=a[d]).fx?c.x+=c.vx*=l:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=l:(c.y=c.fy,c.vy=0);return b}function h(){for(var b,c=0,f=a.length;c<f;++c){if((b=a[c]).index=c,null!=b.fx&&(b.x=b.fx),null!=b.fy&&(b.y=b.fy),isNaN(b.x)||isNaN(b.y)){var d=10*Math.sqrt(c),e=c*n;b.x=d*Math.cos(e),b.y=d*Math.sin(e)}(isNaN(b.vx)||isNaN(b.vy))&&(b.vx=b.vy=0)}}function r(b){return b.initialize&&b.initialize(a),b}return null==a&&(a=[]),h(),b={tick:g,restart:function(){return o.restart(q),b},stop:function(){return o.stop(),b},nodes:function(c){return arguments.length?(a=c,h(),m.each(r),b):a},alpha:function(a){return arguments.length?(i=+a,b):i},alphaMin:function(a){return arguments.length?(f=+a,b):f},alphaDecay:function(a){return arguments.length?(j=+a,b):+j},alphaTarget:function(a){return arguments.length?(k=+a,b):k},velocityDecay:function(a){return arguments.length?(l=1-a,b):1-l},force:function(a,c){return arguments.length>1?(null==c?m.remove(a):m.set(a,r(c)),b):m.get(a)},find:function(i,j,b){var d,e,f,g,h,c=0,k=a.length;for(null==b?b=1/0:b*=b,c=0;c<k;++c)d=i-(g=a[c]).x,e=j-g.y,f=d*d+e*e,f<b&&(h=g,b=f);return h},on:function(a,c){return arguments.length>1?(p.on(a,c),b):p.on(a)}}},a.forceX=function(a){var c,d,e,g=f(.1);function b(f){for(var b,a=0,g=c.length;a<g;++a)b=c[a],b.vx+=(e[a]-b.x)*d[a]*f}function h(){if(c){var b,f=c.length;for(b=0,d=new Array(f),e=new Array(f);b<f;++b)d[b]=isNaN(e[b]=+a(c[b],b,c))?0:+g(c[b],b,c)}}return"function"!=typeof a&&(a=f(null==a?0:+a)),b.initialize=function(a){c=a,h()},b.strength=function(a){return arguments.length?(g="function"==typeof a?a:f(+a),h(),b):g},b.x=function(c){return arguments.length?(a="function"==typeof c?c:f(+c),h(),b):a},b},a.forceY=function(a){var c,d,e,g=f(.1);function b(f){for(var b,a=0,g=c.length;a<g;++a)b=c[a],b.vy+=(e[a]-b.y)*d[a]*f}function h(){if(c){var b,f=c.length;for(b=0,d=new Array(f),e=new Array(f);b<f;++b)d[b]=isNaN(e[b]=+a(c[b],b,c))?0:+g(c[b],b,c)}}return"function"!=typeof a&&(a=f(null==a?0:+a)),b.initialize=function(a){c=a,h()},b.strength=function(a){return arguments.length?(g="function"==typeof a?a:f(+a),h(),b):g},b.y=function(c){return arguments.length?(a="function"==typeof c?c:f(+c),h(),b):a},b},Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b="undefined"!=typeof globalThis?globalThis:b||self).d3=b.d3||{})}(this,function(a){"use strict";function g(a,c){if((d=(a=c?a.toExponential(c-1):a.toExponential()).indexOf("e"))<0)return null;var d,b=a.slice(0,d);return[b.length>1?b[0]+b.slice(2):b,+a.slice(d+1)]}function h(a){return(a=g(Math.abs(a)))?a[1]:NaN}var i,j,k=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function c(c){var a;if(!(a=k.exec(c)))throw new Error("invalid format: "+c);return new b({fill:a[1],align:a[2],sign:a[3],symbol:a[4],zero:a[5],width:a[6],comma:a[7],precision:a[8]&&a[8].slice(1),trim:a[9],type:a[10]})}function b(a){this.fill=void 0===a.fill?" ":a.fill+"",this.align=void 0===a.align?">":a.align+"",this.sign=void 0===a.sign?"-":a.sign+"",this.symbol=void 0===a.symbol?"":a.symbol+"",this.zero=!!a.zero,this.width=void 0===a.width?void 0:+a.width,this.comma=!!a.comma,this.precision=void 0===a.precision?void 0:+a.precision,this.trim=!!a.trim,this.type=void 0===a.type?"":a.type+""}function e(d,e){var c=g(d,e);if(!c)return d+"";var a=c[0],b=c[1];return b<0?"0."+new Array(-b).join("0")+a:a.length>b+1?a.slice(0,b+1)+"."+a.slice(b+1):a+new Array(b-a.length+2).join("0")}c.prototype=b.prototype,b.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":function(a,b){return(100*a).toFixed(b)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:function(a){return Math.abs(a=Math.round(a))>=1e21?a.toLocaleString("en").replace(/,/g,""):a.toString(10)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},g:function(a,b){return a.toPrecision(b)},o:function(a){return Math.round(a).toString(8)},p:function(a,b){return e(100*a,b)},r:e,s:function(c,f){var d=g(c,f);if(!d)return c+"";var b=d[0],h=d[1],a=h-(i=3*Math.max(-8,Math.min(8,Math.floor(h/3))))+1,e=b.length;return a===e?b:a>e?b+new Array(a-e+1).join("0"):a>0?b.slice(0,a)+"."+b.slice(a):"0."+new Array(1-a).join("0")+g(c,Math.max(0,f+a-1))[0]},X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}};function m(a){return a}var n=Array.prototype.map,o=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function f(a){var b,d,e,g=void 0===a.grouping|| void 0===a.thousands?m:(b=n.call(a.grouping,Number),d=a.thousands+"",function(g,c){for(var e=g.length,h=[],i=0,a=b[0],f=0;e>0&&a>0&&(f+a+1>c&&(a=Math.max(1,c-f)),h.push(g.substring(e-=a,e+a)),!((f+=a+1)>c));)a=b[i=(i+1)%b.length];return h.reverse().join(d)}),j=void 0===a.currency?"":a.currency[0]+"",k=void 0===a.currency?"":a.currency[1]+"",p=void 0===a.decimal?".":a.decimal+"",q=void 0===a.numerals?m:(e=n.call(a.numerals,String),function(a){return a.replace(/[0-9]/g,function(a){return e[+a]})}),r=void 0===a.percent?"%":a.percent+"",s=void 0===a.minus?"-":a.minus+"",t=void 0===a.nan?"NaN":a.nan+"";function f(a){var f=(a=c(a)).fill,h=a.align,w=a.sign,e=a.symbol,m=a.zero,x=a.width,u=a.comma,d=a.precision,v=a.trim,b=a.type;"n"===b?(u=!0,b="g"):l[b]||(void 0===d&&(d=12),v=!0,b="g"),(m||"0"===f&&"="===h)&&(m=!0,f="0",h="=");var y="$"===e?j:"#"===e&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",z="$"===e?k:/[%p]/.test(b)?r:"",A=l[b],B=/[defgprs%]/.test(b);function n(a){var k,C,r,j=y,c=z;if("c"===b)c=A(a)+c,a="";else{var l=(a=+a)<0||1/a<0;if(a=isNaN(a)?t:A(Math.abs(a),d),v&&(a=function(c){out:for(var d,e=c.length,a=1,b=-1;a<e;++a)switch(c[a]){case".":b=d=a;break;case"0":0===b&&(b=a),d=a;break;default:if(!+c[a])break out;b>0&&(b=0);break}return b>0?c.slice(0,b)+c.slice(d+1):c}(a)),l&&0== +a&&"+"!==w&&(l=!1),j=(l?"("===w?w:s:"-"===w||"("===w?"":w)+j,c=("s"===b?o[8+i/3]:"")+c+(l&&"("===w?")":""),B){for(k=-1,C=a.length;++k<C;)if(48>(r=a.charCodeAt(k))||r>57){c=(46===r?p+a.slice(k+1):a.slice(k))+c,a=a.slice(0,k);break}}}u&&!m&&(a=g(a,1/0));var n=j.length+a.length+c.length,e=n<x?new Array(x-n+1).join(f):"";switch(u&&m&&(a=g(e+a,e.length?x-c.length:1/0),e=""),h){case"<":a=j+a+c+e;break;case"=":a=j+e+a+c;break;case"^":a=e.slice(0,n=e.length>>1)+j+a+c+e.slice(n);break;default:a=e+j+a+c;break}return q(a)}return d=void 0===d?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),n.toString=function(){return a+""},n}return{format:f,formatPrefix:function(a,d){var e=f(((a=c(a)).type="f",a)),b=3*Math.max(-8,Math.min(8,Math.floor(h(d)/3))),g=Math.pow(10,-b),i=o[8+b/3];return function(a){return e(g*a)+i}}}}function d(b){return j=f(b),a.format=j.format,a.formatPrefix=j.formatPrefix,j}d({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),a.FormatSpecifier=b,a.formatDefaultLocale=d,a.formatLocale=f,a.formatSpecifier=c,a.precisionFixed=function(a){return Math.max(0,-h(Math.abs(a)))},a.precisionPrefix=function(a,b){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(h(b)/3)))-h(Math.abs(a)))},a.precisionRound=function(a,b){return a=Math.abs(a),b=Math.abs(b)-a,Math.max(0,h(b)-h(a))+1},Object.defineProperty(a,"__esModule",{value:!0})})},{}],113:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-geo"),b("d3-array")):"function"==typeof a&&a.amd?a(["exports","d3-geo","d3-array"],f):f(e.d3=e.d3||{},e.d3,e.d3)}(this,function(a,h,aY){"use strict";var aZ=Math.abs,a$=Math.atan,a_=Math.atan2,ab=Math.cos,a0=Math.exp,a1=Math.floor,ac=Math.log,a2=Math.max,a3=Math.min,a4=Math.pow,a5=Math.round,a6=Math.sign||function(a){return a>0?1:a<0?-1:0},a7=Math.sin,a8=Math.tan,a9=1e-6,b=Math.PI,ad=b/2,ba=b/4,bb=Math.SQRT1_2,d=c(2),bc=c(b),bd=2*b,ae=180/b,af=b/180;function ag(a){return a>1?ad:a< -1?-ad:Math.asin(a)}function be(a){return a>1?0:a< -1?b:Math.acos(a)}function c(a){return a>0?Math.sqrt(a):0}function bf(a){return(a0(a)-a0(-a))/2}function bg(a){return(a0(a)+a0(-a))/2}function ah(a){var b=a8(a/2),e=2*ac(ab(a/2))/(b*b);function d(b,c){var g=ab(b),d=ab(c),h=a7(c),a=d*g,f=-((1-a?ac((1+a)/2)/(1-a):-0.5)+e/(1+a));return[f*d*a7(b),f*h]}return d.invert=function(g,h){var j,d=c(g*g+h*h),f=-a/2,o=50;if(!d)return[0,0];do{var k=f/2,b=ab(k),i=a7(k),l=i/b,m=-ac(aZ(b));f-=j=(2/l*m-e*l-d)/(-m/(i*i)+1-e/(2*b*b))*(b<0?.7:1)}while(aZ(j)>a9&& --o>0)var n=a7(f);return[a_(g*n,d*ab(f)),ag(h*n/d)]},d}function i(b,c){var a,d=ab(c),e=(a=be(d*ab(b/=2)))?a/Math.sin(a):1;return[2*d*a7(b)*e,a7(c)*e]}function ai(a){var c=a7(a),d=ab(a),e=a>=0?1:-1,f=a8(e*a),g=(1+c-d)/2;function b(b,a){var h=ab(a),i=ab(b/=2);return[(1+h)*a7(b),(e*a> -a_(i,f)-.001?0:-(10*e))+g+a7(a)*d-(1+h)*c*i]}return b.invert=function(u,v){var a=0,b=0,w=50;do{var i=ab(a),j=a7(a),m=ab(b),k=a7(b),h=1+m,n=h*j-u,o=g+k*d-h*c*i-v,p=h*i/2,q=-j*k,r=c*h*j/2,s=d*m+c*i*k,t=q*r-s*p,x=(o*q-n*s)/t/2,l=(n*r-o*p)/t;aZ(l)>2&&(l/=2),a-=x,b-=l}while((aZ(x)>a9||aZ(l)>a9)&& --w>0)return e*b> -a_(ab(a),f)-.001?[2*a,b]:null},b}function j(e,j){var a=a8(j/2),f=c(1-a*a),g=1+f*ab(e/=2),b=a7(e)*f/g,d=a/g,h=b*b,i=d*d;return[4/3*b*(3+h-3*i),4/3*d*(3+3*h-i)]}i.invert=function(k,l){if(!(k*k+4*l*l>b*b+a9)){var f=k,g=l,z=25;do{var a,o=a7(f),h=a7(f/2),i=ab(f/2),j=a7(g),d=ab(g),p=a7(2*g),q=j*j,m=d*d,r=h*h,s=1-m*i*i,e=s?be(d*i)*c(a=1/s):a=0,t=2*e*d*h-k,u=e*j-l,v=a*(m*r+e*d*i*q),w=a*(.5*o*p-2*e*j*h),x=.25*a*(p*h-e*j*m*o),y=a*(q*i+e*r*d),n=w*x-y*v;if(!n)break;var A=(u*w-t*y)/n,B=(t*x-u*v)/n;f-=A,g-=B}while((aZ(A)>a9||aZ(B)>a9)&& --z>0)return[f,g]}},j.invert=function(b,a){if(a*=.375,!(b*=.375)&&aZ(a)>1)return null;var d,e,f=1+b*b+a*a,g=c((f-c(f*f-4*a*a))/2),j=ag(g)/3,k=g?ac((d=aZ(a/g))+c(d*d-1))/3:ac((e=aZ(b))+c(e*e+1))/3,h=ab(j),i=bg(k),l=i*i-h*h;return[2*a6(b)*a_(bf(k)*h,.25-l),2*a6(a)*a_(i*a7(j),.25+l)]};var bh=c(8),bi=ac(1+d);function k(c,b){var a=aZ(b);return a<ba?[c,ac(a8(ba+b/2))]:[c*ab(a)*(2*d-1/a7(a)),a6(b)*(2*d*(a-ba)-ac(a8(a/2)))]}function aj(d){var e=2*b/d;function a(g,k){var a=h.geoAzimuthalEquidistantRaw(g,k);if(aZ(g)>ad){var d=a_(a[1],a[0]),f=c(a[0]*a[0]+a[1]*a[1]),i=e*a5((d-ad)/e)+ad,j=a_(a7(d-=i),2-ab(d));d=i+ag(b/f*a7(j))-j,a[0]=f*ab(d),a[1]=f*a7(d)}return a}return a.invert=function(d,f){var a=c(d*d+f*f);if(a>ad){var g=a_(f,d),i=e*a5((g-ad)/e)+ad,k=g>i?-1:1,l=a*ab(i-g),j=1/a8(k*be((l-b)/c(b*(b-2*l)+a*a)));d=a*ab(g=i+2*a$((j+k*c(j*j-3))/3)),f=a*a7(g)}return h.geoAzimuthalEquidistantRaw.invert(d,f)},a}function ak(c,a){if(arguments.length<2&&(a=c),1===a)return h.geoAzimuthalEqualAreaRaw;if(a===1/0)return al;function b(d,e){var b=h.geoAzimuthalEqualAreaRaw(d/a,e);return b[0]*=c,b}return b.invert=function(d,e){var b=h.geoAzimuthalEqualAreaRaw.invert(d/c,e);return b[0]*=a,b},b}function al(b,a){return[b*ab(a)/ab(a/=2),2*a7(a)]}function bj(e,d,a){var f,b,c,g=100;a=void 0===a?0:+a,d=+d;do b=e(a),c=e(a+a9),b===c&&(c=b+a9),a-=f=-1*a9*(b-d)/(b-c);while(g-- >0&&aZ(f)>a9)return g<0?NaN:a}function bk(c,a,b){return void 0===a&&(a=40),void 0===b&&(b=1e-12),function(x,y,d,e){var m,i,j;d=void 0===d?0:+d,e=void 0===e?0:+e;for(var n=0;n<a;n++){var f=c(d,e),g=f[0]-x,h=f[1]-y;if(aZ(g)<b&&aZ(h)<b)break;var o=g*g+h*h;if(o>m){d-=i/=2,e-=j/=2;continue}m=o;var k=(d>0?-1:1)*b,l=(e>0?-1:1)*b,p=c(d+k,e),q=c(d,e+l),r=(p[0]-f[0])/k,s=(p[1]-f[1])/k,t=(q[0]-f[0])/l,u=(q[1]-f[1])/l,v=u*r-s*t,w=(.5>aZ(v)?.5:1)/v;if(i=(h*t-g*u)*w,j=(g*s-h*r)*w,d+=i,e+=j,aZ(i)<b&&aZ(j)<b)break}return[d,e]}}function am(){var c=ak(1.68,2),d=1.4;function a(f,a){if(f+a< -d){var g=(f-a+1.6)*(f+a+d)/8;f+=g,a-=.8*g*a7(a+b/2)}var e=c(f,a),h=(1-ab(f*a))/12;return e[1]<0&&(e[0]*=1+h),e[1]>0&&(e[1]*=1+h/1.5*e[0]*e[0]),e}return a.invert=bk(a),a}function bl(c,a){var b,d=c*a7(a),e=30;do a-=b=(a+a7(a)-d)/(1+ab(a));while(aZ(b)>a9&& --e>0)return a/2}function g(b,c,d){function a(e,a){return[b*e*ab(a=bl(d,a)),c*a7(a)]}return a.invert=function(e,a){return[e/(b*ab(a=ag(a/c))),ag((2*a+a7(2*a))/d)]},a}k.invert=function(c,b){if((g=aZ(b))<bi)return[c,2*a$(a0(b))-ad];var d,g,a=ba,h=25;do{var e=ab(a/2),f=a8(a/2);a-=d=(bh*(a-ba)-ac(f)-g)/(bh-e*e/(2*f))}while(aZ(d)>1e-12&& --h>0)return[c/(ab(a)*(bh-1/a7(a))),a6(b)*a]},al.invert=function(b,c){var a=2*ag(c/2);return[b*ab(a/2)/ab(a),a]};var an=g(d/ad,d,b);function l(e,a){var c=bl(b,a);return[2.00276*e/(1/ab(a)+1.11072/ab(c)),(a+d*a7(c))/2.00276]}function bm(b){var c=0,d=h.geoProjectionMutator(b),a=d(c);return a.parallel=function(a){return arguments.length?d(c=a*af):c*ae},a}function m(b,a){return[b*ab(a),a]}function ao(a){if(!a)return m;var d=1/a8(a);function b(f,c){var b=d+a-c,e=b?f*ab(c)/b:b;return[b*a7(e),d-b*ab(e)]}return b.invert=function(e,b){var f=c(e*e+(b=d-b)*b),g=d+a-f;return[f/ab(g)*a_(e,b),g]},b}function ap(b){function a(d,e){var a=ad-e,c=a?d*b*a7(a)/a:a;return[a*a7(c)/b,ad-a*ab(c)]}return a.invert=function(f,g){var d=f*b,e=ad-g,a=c(d*d+e*e),h=a_(d,e);return[(a?a/a7(a):1)*h/b,ad-a]},a}l.invert=function(h,e){var f,c,g=2.00276*e,a=e<0?-ba:ba,i=25;do c=g-d*a7(a),a-=f=(a7(2*a)+2*a-b*a7(c))/(2*ab(2*a)+2+b*ab(c)*d*ab(a));while(aZ(f)>a9&& --i>0)return[h*(1/ab(c=g-d*a7(a))+1.11072/ab(a))/2.00276,c]},m.invert=function(b,a){return[b/ab(a),a]};var aq=g(1,4/b,b);function bn(f,e,g,a,h,b){var d,i=ab(b);if(aZ(f)>1||aZ(b)>1)d=be(g*h+e*a*i);else{var j=a7(f/2),k=a7(b/2);d=2*ag(c(j*j+e*a*k*k))}return aZ(d)>a9?[d,a_(a*a7(b),e*h-g*a*i)]:[0,0]}function bo(a,b,c){return be((a*a+b*b-c*c)/(2*a*b))}function bp(a){return a-2*b*a1((a+b)/(2*b))}function ar(e,f,g){for(var d,a=[[e[0],e[1],a7(e[1]),ab(e[1])],[f[0],f[1],a7(f[1]),ab(f[1])],[g[0],g[1],a7(g[1]),ab(g[1])]],c=a[2],h=0;h<3;++h,c=d)d=a[h],c.v=bn(d[1]-c[1],c[3],c[2],d[3],d[2],d[0]-c[0]),c.point=[0,0];var i=bo(a[0].v[0],a[2].v[0],a[1].v[0]),j=bo(a[0].v[0],a[1].v[0],a[2].v[0]),k=b-i;a[2].point[1]=0,a[0].point[0]=-(a[1].point[0]=a[0].v[0]/2);var l=[a[2].point[0]=a[0].point[0]+a[2].v[0]*ab(i),2*(a[0].point[1]=a[1].point[1]=a[2].v[0]*a7(i))];return function(h,g){var b,i=a7(g),m=ab(g),c=new Array(3);for(b=0;b<3;++b){var f=a[b];if(c[b]=bn(g-f[1],f[3],f[2],m,i,h-f[0]),!c[b][0])return f.point;c[b][1]=bp(c[b][1]-f.v[1])}var e=l.slice();for(b=0;b<3;++b){var n=2==b?0:b+1,d=bo(a[b].v[0],c[b][0],c[n][0]);c[b][1]<0&&(d=-d),b?1==b?(d=j-d,e[0]-=c[b][0]*ab(d),e[1]-=c[b][0]*a7(d)):(d=k-d,e[0]+=c[b][0]*ab(d),e[1]+=c[b][0]*a7(d)):(e[0]+=c[b][0]*ab(d),e[1]-=c[b][0]*a7(d))}return e[0]/=3,e[1]/=3,e}}function bq(a){return a[0]*=af,a[1]*=af,a}function as(d,e,f){var g=h.geoCentroid({type:"MultiPoint",coordinates:[d,e,f]}),i=[-g[0],-g[1]],b=h.geoRotation(i),c=ar(bq(b(d)),bq(b(e)),bq(b(f)));c.invert=bk(c);var a=h.geoProjection(c).rotate(i),j=a.center;return delete a.rotate,a.center=function(a){return arguments.length?j(b(a)):b.invert(j())},a.clipAngle(90)}function n(b,d){var a=c(1-a7(d));return[2/bc*b*a,bc*(1-a)]}function at(b){var d=a8(b);function a(a,b){return[a,(a?a/a7(a):1)*(a7(b)*ab(a)-d*ab(b))]}return a.invert=d?function(a,b){a&&(b*=a7(a)/a);var e=ab(a);return[a,2*a_(c(e*e+d*d-b*b)-e,d-b)]}:function(a,b){return[a,ag(a?b*a8(a)/a:b)]},a}n.invert=function(d,e){var a=(a=e/bc-1)*a;return[a>0?d*c(b/a)/2:0,ag(1-a)]};var br=c(3);function o(b,a){return[br*b*(2*ab(2*a/3)-1)/bc,br*bc*a7(a/3)]}function p(b){var c=ab(b);function a(a,b){return[a*c,a7(b)/c]}return a.invert=function(a,b){return[a/c,ag(b*c)]},a}function au(b){var c=ab(b);function a(a,b){return[a*c,(1+c)*a8(b/2)]}return a.invert=function(a,b){return[a/c,2*a$(b/(1+c))]},a}function q(e,a){var d=c(8/(3*b));return[d*e*(1-aZ(a)/b),d*a]}function r(e,a){var d=c(4-3*a7(aZ(a)));return[2/c(6*b)*e*d,a6(a)*c(2*b/3)*(2-d)]}function s(e,a){var d=c(b*(4+b));return[2/d*e*(1+c(1-4*a*a/(b*b))),4/d*a]}function t(g,a){var h=(2+ad)*a7(a);a/=2;for(var e=0,f=1/0;e<10&&aZ(f)>a9;e++){var d=ab(a);a-=f=(a+a7(a)*(d+2)-h)/(2*d*(1+d))}return[2/c(b*(4+b))*g*(1+ab(a)),2*c(b/(4+b))*a7(a)]}function u(d,a){return[d*(1+ab(a))/c(2+b),2*a/c(2+b)]}function v(g,a){for(var d=(1+ad)*a7(a),e=0,f=1/0;e<10&&aZ(f)>a9;e++)a-=f=(a+a7(a)-d)/(1+ab(a));return d=c(2+b),[g*(1+ab(a))/d,2*a/d]}o.invert=function(b,c){var a=3*ag(c/(br*bc));return[bc*b/(br*(2*ab(2*a/3)-1)),a]},q.invert=function(e,f){var a=c(8/(3*b)),d=f/a;return[e/(a*(1-aZ(d)/b)),d]},r.invert=function(e,d){var a=2-aZ(d)/c(2*b/3);return[e*c(6*b)/(2*a),a6(d)*ag((4-a*a)/3)]},s.invert=function(e,a){var d=c(b*(4+b))/2;return[e*d/(1+c(1-a*a*(4+b)/(4*b))),a*d/2]},t.invert=function(f,g){var a=g*c((4+b)/b)/2,d=ag(a),e=ab(d);return[f/(2/c(b*(4+b))*(1+e)),ag((d+a*(e+2))/(2+ad))]},u.invert=function(e,f){var a=c(2+b),d=f*a/2;return[a*e/(1+ab(d)),d]},v.invert=function(e,a){var b=1+ad,d=c(b/2);return[2*e*d/(1+ab(a*=d)),ag((a+a7(a))/b)]};var bs=3+2*d;function w(i,e){var j=a7(i/=2),f=ab(i),g=c(ab(e)),h=ab(e/=2),b=a7(e)/(h+d*f*g),k=c(2/(1+b*b)),a=c((d*h+(f+j)*g)/(d*h+(f-j)*g));return[bs*(k*(a-1/a)-2*ac(a)),bs*(k*b*(a+1/a)-2*a$(b))]}w.invert=function(s,t){if(!(z=j.invert(s/1.2,1.065*t)))return null;var z,u=z[0],i=z[1],A=20;s/=bs,t/=bs;do{var B=u/2,C=i/2,k=a7(B),f=ab(B),p=a7(C),g=ab(C),D=ab(i),a=c(D),e=p/(g+d*f*a),q=e*e,b=c(2/(1+q)),N=d*g+(f+k)*a,O=d*g+(f-k)*a,l=N/O,h=c(l),v=h-1/h,m=h+1/h,E=b*v-2*ac(h)-s,F=b*e*m-2*a$(e)-t,w=p&&bb*a*k*q/p,x=(d*f*g+a)/(2*(g+d*f*a)*(g+d*f*a)*a),G=-0.5*e*b*b*b,H=G*w,I=G*x,r=(r=2*g+d*a*(f-k))*r*h,n=(d*f*g*a+D)/r,o=-(d*k*p)/(a*r),J=v*H-2*n/h+b*(n+n/l),K=v*I-2*o/h+b*(o+o/l),L=e*m*H-2*w/(1+q)+b*m*w+b*e*(n-n/l),M=e*m*I-2*x/(1+q)+b*m*x+b*e*(o-o/l),y=K*L-M*J;if(!y)break;var P=(F*K-E*M)/y,Q=(E*L-F*J)/y;u-=P,i=a2(-ad,a3(ad,i-Q))}while((aZ(P)>a9||aZ(Q)>a9)&& --A>0)return aZ(aZ(i)-ad)<a9?[0,i]:A&&[u,i]};var bt=ab(35*af);function x(b,d){var a=a8(d/2);return[b*bt*c(1-a*a),(1+bt)*a]}function y(d,a){var b=a/2,c=ab(b);return[2*d/bc*ab(a)*c*c,bc*a8(b)]}function av(d){var g=1-d,e=i(b,0)[0]-i(-b,0)[0],f=i(0,ad)[1]-i(0,-ad)[1],h=c(2*f/e);function i(c,a){var b=ab(a),e=a7(a);return[b/(g+d*b)*c,g*a+d*e]}function a(b,c){var a=i(b,c);return[a[0]*h,a[1]/h]}function j(b){return a(0,b)[1]}return a.invert=function(b,c){var a=bj(j,c);return[b/h*(d+g/ab(a)),a]},a}function bu(a){return[a[0]/2,ag(a8(a[1]/2*af))*ae]}function bv(a){return[2*a[0],2*a$(a7(a[1]*af))*ae]}function aw(a,e){var f=2*b/e,g=a*a;function d(v,w){var i=h.geoAzimuthalEquidistantRaw(v,w),d=i[0],e=i[1],n=d*d+e*e;if(n>g){var o=c(n),p=a_(e,d),l=f*a5(p/f),j=p-l,k=a*ab(j),q=(a*a7(j)-j*a7(k))/(ad-k),m=bw(j,q),r=(b-a)/bx(m,k,b);d=o;var s,x=50;do d-=s=(a+bx(m,k,d)*r-o)/(m(d)*r);while(aZ(s)>a9&& --x>0)e=j*a7(d),d<ad&&(e-=q*(d-ad));var t=a7(l),u=ab(l);i[0]=d*u-e*t,i[1]=d*t+e*u}return i}return d.invert=function(d,i){var q=d*d+i*i;if(q>g){var k=c(q),l=a_(i,d),r=f*a5(l/f),s=l-r;d=k*ab(s),i=k*a7(s);for(var t=d-ad,o=a7(d),e=i/o,u=d<ad?1/0:0,x=10;;){var m=a*a7(e),j=a*ab(e),p=a7(j),n=ad-j,v=(m-e*p)/n,w=bw(e,v);if(1e-12>aZ(u)||!--x)break;e-=u=(e*o-v*t-i)/(o-2*t*(n*(j+e*m*ab(j)-p)-m*(m-e*p))/(n*n))}d=(k=a+bx(w,j,d)*(b-a)/bx(w,j,b))*ab(l=r+e),i=k*a7(l)}return h.geoAzimuthalEquidistantRaw.invert(d,i)},d}function bw(a,b){return function(e){var d=a*ab(e);return e<ad&&(d-=b),c(1+d*d)}}function bx(a,b,c){for(var d=50,e=(c-b)/d,f=a(b)+a(c),g=1,h=b;g<d;++g)f+=2*a(h+=e);return .5*f*e}function e(e,f,g,h,i,j,k,d){function a(o,c){if(!c)return[e*o/b,0];var a=c*c,l=e+a*(f+a*(g+a*h)),m=c*(i-1+a*(j-d+a*k)),n=(l*l+m*m)/(2*m),p=o*ag(l/n)/b;return[n*a7(p),c*(1+a*d)+n*(1-ab(p))]}return arguments.length<8&&(d=0),a.invert=function(w,x){var y,z,o=b*w/e,l=x,O=50;do{var a=l*l,m=e+a*(f+a*(g+a*h)),p=l*(i-1+a*(j-d+a*k)),A=m*m+p*p,q=2*p,n=A/q,B=n*n,s=ag(m/n)/b,C=o*s,P=m*m,D=(2*f+a*(4*g+6*a*h))*l,E=i+a*(3*j+5*a*k),Q=2*(m*D+p*(E-1)),R=2*(E-1),r=(Q*q-A*R)/(q*q),F=ab(C),G=a7(C),t=n*F,u=n*G,H=o/b*(1/c(1-P/B))*(D*n-m*r)/B,I=u-w,J=l*(1+a*d)+n-t-x,K=r*G+t*H,L=t*s,M=1+r-(r*F-u*H),N=u*s,v=K*N-M*L;if(!v)break;o-=y=(J*K-I*M)/v,l-=z=(I*N-J*L)/v}while((aZ(y)>a9||aZ(z)>a9)&& --O>0)return[o,l]},a}x.invert=function(b,d){var a=d/(1+bt);return[b&&b/(bt*c(1-a*a)),2*a$(a)]},y.invert=function(d,e){var a=a$(e/bc),b=ab(a),c=2*a;return[d*bc/2/(ab(c)*b*b),c]};var ax=e(2.8284,-1.6988,.75432,-0.18071,1.76003,-0.38914,.042555),ay=e(2.583819,-0.835827,.170354,-0.038094,1.543313,-0.411435,.082742),az=e(5/6*b,-0.62636,-0.0344,0,1.3493,-0.05524,0,.045);function z(a,b){var c=a*a,d=b*b;return[a*(1-.162388*d)*(.87-952426e-9*c*c),b*(1+d/12)]}z.invert=function(e,h){var c,a=e,b=h,f=50;do{var g=b*b;b-=c=(b*(1+g/12)-h)/(1+g/4)}while(aZ(c)>a9&& --f>0)f=50,e/=1-.162388*g;do{var d=(d=a*a)*d;a-=c=(a*(.87-952426e-9*d)-e)/(.87-.00476213*d)}while(aZ(c)>a9&& --f>0)return[a,b]};var aA=e(2.6516,-0.76534,.19123,-0.047094,1.36289,-0.13965,.031762);function by(a){var d=a(ad,0)[0]-a(-ad,0)[0];function c(c,g){var e=c>0?-0.5:.5,f=a(c+e*b,g);return f[0]-=e*d,f}return a.invert&&(c.invert=function(f,h){var g=f>0?-0.5:.5,e=a.invert(f+g*d,h),c=e[0]-g*b;return c< -b?c+=2*b:c>b&&(c-=2*b),e[0]=c,e}),c}function A(a,d){var h=a6(a),f=a6(d),g=ab(d),i=ab(a)*g,j=a7(a)*g,e=a7(f*d);a=aZ(a_(j,e)),d=ag(i),aZ(a-ad)>a9&&(a%=ad);var c=bz(a>b/4?ad-a:a,d);return a>b/4&&(e=c[0],c[0]=-c[1],c[1]=-e),c[0]*=h,c[1]*=-f,c}function bz(e,j){if(j===ad)return[0,0];var a,k,f=a7(j),d=f*f,g=d*d,l=1+g,z=1+3*g,q=1-g,A=ag(1/c(l)),m=q+d*l*A,r=(1-f)/m,s=c(r),h=r*l,t=c(h),i=s*q;if(0===e)return[0,-(i+d*t)];var B,u=ab(j),v=1/u,n=2*f*u,C=(-m*u-(1-f)*((-3*d+A*z)*n))/(m*m),I=q*(.5*C/s)-2*d*s*n,J=d*l*C+r*z*n,w=-v*n,x=-v*J,D=-2*v*I,E=4*e/b;if(e>.222*b||j<b/4&&e>.175*b){if(a=(i+d*c(h*(1+g)-i*i))/(1+g),e>b/4)return[a,a];var o=a,p=.5*a;a=.5*(p+o),k=50;do{var K=c(h-a*a),F=a*(D+w*K)+x*ag(a/t)-E;if(!F)break;F<0?p=a:o=a,a=.5*(p+o)}while(aZ(o-p)>a9&& --k>0)}else{a=a9,k=25;do{var G=a*a,y=c(h-G),H=D+w*y,L=a*H+x*ag(a/t)-E,M=H+(x-w*G)/y;a-=B=y?L/M:0}while(aZ(B)>a9&& --k>0)}return[a,-i-d*c(h-a*a)]}function bA(a,e){if(e<a9)return j=a7(a),f=ab(a),h=e*(a-j*f)/4,[j-h*f,f+h*j,1-e*j*j/2,a-h];if(e>=1-a9){var i;return h=(1-e)/4,f=bg(a),j=((i=a0(2*(i=a)))-1)/(i+1),d=1/f,k=f*bf(a),[j+h*(k-a)/(f*f),d-h*j*d*(k-a),d+h*j*d*(k+a),2*a$(a0(a))-ad+h*(k-a)/f]}var h,f,d,j,k,g=[1,0,0,0,0,0,0,0,0],l=[c(e),0,0,0,0,0,0,0,0],b=0;for(f=c(1-e),k=1;aZ(l[b]/g[b])>a9&&b<8;)h=g[b++],l[b]=(h-f)/2,g[b]=(h+f)/2,f=c(h*f),k*=2;d=k*g[b]*a;do d=(ag(j=l[b]*a7(f=d)/g[b])+d)/2;while(--b)return[a7(d),j=ab(d),j/ab(d-f),d]}function bB(a,f){if(!f)return a;if(1===f)return ac(a8(a/2+ba));for(var d=1,e=c(1-f),g=c(f),i=0;aZ(g)>a9;i++){if(a%b){var h=a$(e*a8(a)/d);h<0&&(h+=b),a+=h+ ~~(a/b)*b}else a+=a;g=(d+e)/2,e=c(d*e),g=((d=g)-e)/2}return a/(a4(2,i)*d)}function B(f,g){var e=(d-1)/(d+1),a=c(1-e*e),k=bB(ad,a*a),h=a0(-1*ac(a8(b/4+aZ(g)/2)))/c(e),i=bC(h*ab(-1*f),h*a7(-1*f)),j=function(h,d,a){var b=aZ(h),e=bf(aZ(d));if(b){var i=1/a7(b),f=1/(a8(b)*a8(b)),g=-(f+a*(e*e*i*i)-1+a),j=(-g+c(g*g-4*((a-1)*f)))/2;return[bB(a$(1/c(j)),a)*a6(h),bB(a$(c((j/f-1)/a)),1-a)*a6(d)]}return[0,bB(a$(e),1-a)*a6(d)]}(i[0],i[1],a*a);return[-j[1],(g>=0?1:-1)*(.5*k-j[0])]}function bC(a,b){var c=a*a,e=b+1,d=1-c-b*b;return[.5*((a>=0?ad:-ad)-a_(d,2*a)),-0.25*ac(d*d+4*c)+.5*ac(e*e+c)]}function aB(a){var e=a7(a),f=ab(a),d=bD(a);function b(a,b){var g=d(a,b);a=g[0];var h=a7(b=g[1]),i=ab(b),j=ab(a),k=be(e*h+f*i*j),l=a7(k),c=aZ(l)>a9?k/l:1;return[c*f*a7(a),(aZ(a)>ad?c:-c)*(e*i-f*h*j)]}return d.invert=bD(-a),b.invert=function(i,b){var a=c(i*i+b*b),j=-a7(a),l=ab(a),f=a*l,g=-b*j,h=a*e,m=c(f*f+g*g-h*h),k=a_(f*h+g*m,g*h-f*m),n=(a>ad?-1:1)*a_(i*j,a*ab(k)*l+b*a7(k)*j);return d.invert(n,k)},b}function bD(a){var b=a7(a),c=ab(a);return function(a,d){var e=ab(d),f=ab(a)*e,h=a7(a)*e,g=a7(d);return[a_(h,f*c-g*b),ag(g*c+f*b)]}}A.invert=function(a,d){aZ(a)>1&&(a=2*a6(a)-a),aZ(d)>1&&(d=2*a6(d)-d);var i=a6(a),j=a6(d),f=-i*a,g=-j*d,h=g/f<1,k=function(e,v){for(var i=0,j=1,a=.5,o=50;;){var d=a*a,f=c(a),p=ag(1/c(1+d)),g=1-d+a*(1+d)*p,k=(1-f)/g,l=c(k),q=k*(1+d),w=l*(1-d),r=c(q-e*e),s=v+w+a*r;if(1e-12>aZ(j-i)||0== --o||0===s)break;s>0?i=a:j=a,a=.5*(i+j)}if(!o)return null;var t=ag(f),m=ab(t),n=1/m,h=2*f*m,u=(-g*m-(1-f)*((-3*a+p*(1+3*d))*h))/(g*g),x=-2*n*((1-d)*(.5*u/l)-2*a*l*h),y=-n*h,z=-n*(a*(1+d)*u+k*(1+3*d)*h);return[b/4*(e*(x+y*r)+z*ag(e/c(q))),t]}(h?g:f,h?f:g),e=k[0],l=k[1],m=ab(l);return h&&(e=-ad-e),[i*(a_(a7(e)*m,-a7(l))+b),j*ag(ab(e)*m)]},B.invert=function(p,q){var m,j,g,b,a,f,i,e,n,k=(d-1)/(d+1),l=c(1-k*k),o=(m=.5*bB(ad,l*l)-q,j=-p,g=l*l,m?(b=bA(m,g),j)?(f=(a=bA(j,1-g))[1]*a[1]+g*b[0]*b[0]*a[0]*a[0],[[b[0]*a[2]/f,b[1]*b[2]*a[0]*a[1]/f],[b[1]*a[1]/f,-b[0]*b[2]*a[0]*a[2]/f],[b[2]*a[1]*a[2]/f,-g*b[0]*b[1]*a[0]/f]]):[[b[0],0],[b[1],0],[b[2],0]]:[[0,(a=bA(j,1-g))[0]/a[1]],[1/a[1],0],[a[2]/a[1],0]]),h=(i=o[0],e=o[1],n=e[0]*e[0]+e[1]*e[1],[(i[0]*e[0]+i[1]*e[1])/n,(i[1]*e[0]-i[0]*e[1])/n]);return[-(a_(h[1],h[0])/1),2*a$(a0(-0.5*ac(k*h[0]*h[0]+k*h[1]*h[1])))-ad]};var bE=ag(1-.3333333333333333)*ae,bF=p(0);function aC(e){var a=bE*af,h=n(b,a)[0]-n(-b,a)[0],f=bF(0,a)[1],g=n(0,a)[1],c=bc-g,i=bd/e,j=4/bd,k=f+c*c*4/bd;function d(l,m){var d,o=aZ(m);if(o>a){var p=a3(e-1,a2(0,a1((l+b)/i)));l+=b*(e-1)/e-p*i,(d=n(l,o))[0]=d[0]*bd/h-bd*(e-1)/(2*e)+p*bd/e,d[1]=f+(d[1]-g)*4*c/bd,m<0&&(d[1]=-d[1])}else d=bF(l,m);return d[0]*=j,d[1]/=k,d}return d.invert=function(a,l){a/=j;var m=aZ(l*=k);if(m>f){var o=a3(e-1,a2(0,a1((a+b)/i)));a=(a+b*(e-1)/e-o*i)*h/bd;var d=n.invert(a,.25*(m-f)*bd/c+g);return d[0]-=b*(e-1)/e-o*i,l<0&&(d[1]=-d[1]),d}return bF.invert(a,l)},d}function bG(a,b){return[a,1&b?90-a9:bE]}function bH(a,b){return[a,1&b?-90+a9:-bE]}function bI(a){return[a[0]*(1-a9),a[1]]}function aD(a){var f,d=1+a,g=ag(a7(1/d)),h=2*c(b/(f=b+4*g*d)),i=.5*h*(d+c(a*(2+a))),j=a*a,k=d*d;function e(q,r){var e,l,m=1-a7(r);if(m&&m<2){var s,n=ad-r,v=25;do{var o=a7(n),t=ab(n),p=g+a_(o,d-t),u=1+k-2*d*t;n-=s=(n-j*g-d*o+u*p-.5*m*f)/(2*d*o*p)}while(aZ(s)>1e-12&& --v>0)e=h*c(u),l=q*p/b}else e=h*(a+m),l=q*g/b;return[e*a7(l),i-e*ab(l)]}return e.invert=function(a,l){var m=a*a+(l-=i)*l,e=(1+k-m/(h*h))/(2*d),n=be(e),o=a7(n),p=g+a_(o,d-e);return[ag(a/c(m))*b/p,ag(1-2*(n-j*g-d*o+(1+k-2*d*e)*p)/f)]},e}function C(a,b){return b> -0.7109889596207567?(a=an(a,b),a[1]+=.0528035274542,a):m(a,b)}function D(a,b){return aZ(b)>.7109889596207567?(a=an(a,b),a[1]-=b>0?.0528035274542:-0.0528035274542,a):m(a,b)}function aE(e,d,a,g){var h=c(4*b/(2*a+(1+e-d/2)*a7(2*a)+(e+d)/2*a7(4*a)+d/2*a7(6*a))),i=c(g*a7(a)*c((1+e*ab(2*a)+d*ab(4*a))/(1+e+d))),j=a*l(1);function k(a){return c(1+e*ab(2*a)+d*ab(4*a))}function l(c){var b=c*a;return(2*b+(1+e-d/2)*a7(2*b)+(e+d)/2*a7(4*b)+d/2*a7(6*b))/a}function m(a){return k(a)*a7(a)}var f=function(f,d){var c=a*bj(l,j*a7(d)/a,d/b);isNaN(c)&&(c=a*a6(d));var e=h*k(c);return[e*i*f/b*ab(c),e/i*a7(c)]};return f.invert=function(d,e){var c=bj(m,e*i/h);return[d*b/(ab(c)*h*i*k(c)),ag(a*l(c/a)/j)]},0===a&&(h=c(g/b),(f=function(a,b){return[a*h,a7(b)/h]}).invert=function(a,b){return[a/h,ag(b*h)]}),f}function bJ(c,d,j,r,e,s,u,k,l,m,a){var b,f,g,n,o,h,p,q,t,i;if(a.nanEncountered)return NaN;if(b=j-d,f=c(d+.25*b),g=c(j-.25*b),isNaN(f)){a.nanEncountered=!0;return}if(isNaN(g)){a.nanEncountered=!0;return}return(n=b*(r+4*f+e)/12,o=b*(e+4*g+s)/12,h=n+o,i=(h-u)/15,m>l)?(a.maxDepthCount++,h+i):Math.abs(i)<k?h+i:(p=d+.5*b,q=bJ(c,d,p,r,f,e,n,.5*k,l,m+1,a),isNaN(q))?(a.nanEncountered=!0,NaN):isNaN(t=bJ(c,p,j,e,g,s,o,.5*k,l,m+1,a))?(a.nanEncountered=!0,NaN):q+t}function aF(k,l,g){function m(a){return k+(1-k)*a4(1-a4(a,l),1/l)}function c(i){var a,b,c,h,d,e,f,g;return a=m,b=0,c=i,h=1e-4,void 0===d&&(d=20),e=a(b),f=a(.5*(b+c)),g=a(c),bJ(a,b,c,e,f,g,(e+4*f+g)*(c-b)/6,h,d,1,{maxDepthCount:0,nanEncountered:!1})}for(var d=1/c(1),e=1e3,h=(1+1e-8)*d,i=[],a=0;a<=e;a++)i.push(c(a/e)*h);function j(d){var c=0,f=e,a=e>>1;do i[a]>d?f=a:c=a,a=c+f>>1;while(a>c)var b=i[a+1]-i[a];return b&&(b=(d-i[a+1])/b),(a+1+b)/e}var n=2*j(1)/b*d/g,f=function(c,b){var a=j(aZ(a7(b))),d=m(a)*c;return a/=n,[d,b>=0?a:-a]};return f.invert=function(e,a){var b;return 1>aZ(a*=n)&&(b=a6(a)*ag(c(aZ(a))*d)),[e/m(aZ(a)),b]},f}function bK(a,b){return aZ(a[0]-b[0])<a9&&aZ(a[1]-b[1])<a9}function bL(d,e){for(var b,g,h,i=-1,j=d.length,a=d[0],f=[];++i<j;){g=((b=d[i])[0]-a[0])/e,h=(b[1]-a[1])/e;for(var c=0;c<e;++c)f.push([a[0]+c*g,a[1]+c*h]);a=b}return f.push(b),f}function aG(e,c,d){function b(f,d){for(var g=d<0?-1:1,b=c[+(d<0)],a=0,i=b.length-1;a<i&&f>b[a][2][0];++a);var h=e(f-b[a][1][0],d);return h[0]+=e(b[a][1][0],g*d>g*b[a][0][1]?b[a][0][1]:d)[0],h}d?b.invert=d(b):e.invert&&(b.invert=function(f,a){for(var j=g[+(a<0)],k=c[+(a<0)],d=0,l=j.length;d<l;++d){var h=j[d];if(h[0][0]<=f&&f<h[1][0]&&h[0][1]<=a&&a<h[1][1]){var i=e.invert(f-e(k[d][1][0],0)[0],a);return i[0]+=k[d][1][0],bK(b(i[0],i[1]),[f,a])?i:null}}});var f,g,a=h.geoProjection(b),i=a.stream;return a.stream=function(b){var d=a.rotate(),c=i(b),e=(a.rotate([0,0]),i(b));return a.rotate(d),c.sphere=function(){h.geoStream(f,e)},c},a.lobes=function(b){return arguments.length?(f=function(f){var a,c,g,d,e,h,b,i=[],j=f[0].length;for(b=0;b<j;++b)c=(a=f[0][b])[0][0],g=a[0][1],d=a[1][1],e=a[2][0],h=a[2][1],i.push(bL([[c+a9,g+a9],[c+a9,d-a9],[e-a9,d-a9],[e-a9,h+a9]],30));for(b=f[1].length-1;b>=0;--b)c=(a=f[1][b])[0][0],g=a[0][1],d=a[1][1],e=a[2][0],h=a[2][1],i.push(bL([[e-a9,h-a9],[e-a9,d+a9],[c+a9,d+a9],[c+a9,g-a9]],30));return{type:"Polygon",coordinates:[aY.merge(i)]}}(b),c=b.map(function(a){return a.map(function(a){return[[a[0][0]*af,a[0][1]*af],[a[1][0]*af,a[1][1]*af],[a[2][0]*af,a[2][1]*af]]})}),g=c.map(function(a){return a.map(function(a){var d,f=e(a[0][0],a[0][1])[0],g=e(a[2][0],a[2][1])[0],b=e(a[1][0],a[0][1])[1],c=e(a[1][0],a[1][1])[1];return b>c&&(d=b,b=c,c=d),[[f,b],[g,c]]})}),a):c.map(function(a){return a.map(function(a){return[[a[0][0]*ae,a[0][1]*ae],[a[1][0]*ae,a[1][1]*ae],[a[2][0]*ae,a[2][1]*ae]]})})},null!=c&&a.lobes(c),a}C.invert=function(b,a){return a> -0.7109889596207567?an.invert(b,a-.0528035274542):m.invert(b,a)},D.invert=function(b,a){return aZ(a)>.7109889596207567?an.invert(b,a+(a>0?.0528035274542:-0.0528035274542)):m.invert(b,a)};var bM=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],bN=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],bO=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],bP=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],bQ=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],bR=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function E(d,a){return[3/bd*d*c(b*b/3-a*a),a]}function aH(b){function a(d,c){if(aZ(aZ(c)-ad)<a9)return[0,c<0?-2:2];var e=a7(c),a=a4((1+e)/(1-e),b/2),f=.5*(a+1/a)+ab(d*=b);return[2*a7(d)/f,(a-1/a)/f]}return a.invert=function(d,a){var e=aZ(a);if(aZ(e-2)<a9)return d?null:[0,a6(a)*ad];if(e>2)return null;var f=(d/=2)*d,g=(a/=2)*a,c=2*a/(1+f+g);return c=a4((1+c)/(1-c),1/b),[a_(2*d,1-f-g)/b,ag((c-1)/(c+1))]},a}E.invert=function(d,a){return[bd/3*d/c(b*b/3-a*a),a]};var bS=b/d;function F(b,a){return[b*(1+c(ab(a)))/2,a/(ab(a/2)*ab(b/6))]}function G(b,c){var d=b*b,a=c*c;return[b*(.975534+a*(-0.119161+ -0.0143059*d+ -0.0547009*a)),c*(1.00384+d*(.0802894+ -0.02855*a+199025e-9*d)+a*(.0998909+ -0.0491032*a))]}function H(a,b){return[a7(a)/ab(b),a8(b)*ab(a)]}function aI(a){var c=ab(a),d=a8(ba+a/2);function b(f,g){var e=g-a,b=aZ(e)<a9?f*c:aZ(b=ba+g/2)<a9||aZ(aZ(b)-ad)<a9?0:f*e/ac(a8(b)/d);return[b,e]}return b.invert=function(f,b){var e,g=b+a;return[aZ(b)<a9?f/c:aZ(e=ba+g/2)<a9||aZ(aZ(e)-ad)<a9?0:f*ac(a8(e)/d)/b,g]},b}function I(a,b){return[a,1.25*ac(a8(ba+.4*b))]}function aJ(b){var d=b.length-1;function a(j,k){for(var e,l=ab(k),m=2/(1+l*ab(j)),f=m*l*a7(j),g=m*a7(k),i=d,h=b[i],c=h[0],a=h[1];--i>=0;)c=(h=b[i])[0]+f*(e=c)-g*a,a=h[1]+f*a+g*e;return c=f*(e=c)-g*a,a=f*a+g*e,[c,a]}return a.invert=function(n,o){var p=20,a=n,e=o;do{for(var h,m=d,k=b[m],i=k[0],g=k[1],j=0,f=0;--m>=0;)k=b[m],j=i+a*(h=j)-e*f,f=g+a*f+e*h,i=k[0]+a*(h=i)-e*g,g=k[1]+a*g+e*h;j=i+a*(h=j)-e*f,f=g+a*f+e*h,i=a*(h=i)-e*g-n;var t,u,q=j*j+f*f;a-=t=(i*j+(g=a*g+e*h-o)*f)/q,e-=u=(g*j-i*f)/q}while(aZ(t)+aZ(u)>a9*a9&& --p>0)if(p){var l=c(a*a+e*e),r=2*a$(.5*l),s=a7(r);return[a_(a*s,l*ab(r)),l?ag(e*s/l):0]}},a}F.invert=function(h,i){var t=aZ(h),d=aZ(i),b=a9,a=ad;d<bS?a*=d/bS:b+=6*be(bS/d);for(var j=0;j<25;j++){var u=a7(a),e=c(ab(a)),v=a7(a/2),f=ab(a/2),w=a7(b/6),g=ab(b/6),k=.5*b*(1+e)-t,l=a/(f*g)-d,m=e?-0.25*b*u/e:0,n=.5*(1+e),o=(1+.5*a*v/f)/(f*g),p=a/f*(w/6)/(g*g),q=m*p-o*n,r=(k*p-l*n)/q,s=(l*m-k*o)/q;if(a-=r,b-=s,aZ(r)<a9&&aZ(s)<a9)break}return[h<0?-b:b,i<0?-a:a]},G.invert=function(f,g){var d=a6(f)*b,e=g/2,h=50;do{var c=d*d,a=e*e,i=d*e,j=d*(.975534+a*(-0.119161+ -0.0143059*c+ -0.0547009*a))-f,k=e*(1.00384+c*(.0802894+ -0.02855*a+199025e-9*c)+a*(.0998909+ -0.0491032*a))-g,l=.975534-a*(.119161+3*c*.0143059+.0547009*a),m=-i*(.238322+.2188036*a+.0286118*c),n=i*(.1605788+7961e-7*c+ -0.0571*a),o=1.00384+c*(.0802894+199025e-9*c)+a*(3*(.0998909-.02855*c)-.245516*a),p=m*n-o*l,q=(k*m-j*o)/p,r=(j*n-k*l)/p;d-=q,e-=r}while((aZ(q)>a9||aZ(r)>a9)&& --h>0)return h&&[d,e]},H.invert=function(a,b){var d=a*a,f=b*b+1,e=d+f,g=a?bb*c((e-c(e*e-4*d))/d):1/c(f);return[ag(a*g),a6(b)*be(g)]},I.invert=function(a,c){return[a,2.5*a$(a0(.8*c))-.625*b]};var bT=[[.9972523,0],[.0052513,-0.0041175],[.0074606,.0048125],[-0.0153783,-0.1968253],[.0636871,-0.1408027],[.3660976,-0.2937382]],bU=[[.98879,0],[0,0],[-0.050909,0],[0,0],[.075528,0]],bV=[[.984299,0],[.0211642,.0037608],[-0.1036018,-0.0575102],[-0.0329095,-0.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-0.1435792],[.0075848,-0.1334108],[-0.0216473,.0776645],[-0.0225161,.0853673]],bW=[[.9245,0],[0,0],[.01943,0]],bX=[[.721316,0],[0,0],[-0.00881625,-0.00617325]];function aK(c,b){var a=h.geoProjection(aJ(c)).rotate(b).clipAngle(90),d=h.geoRotation(b),e=a.center;return delete a.rotate,a.center=function(a){return arguments.length?e(d(a)):d.invert(e())},a}var bY=c(6),bZ=c(7);function J(b,c){var a=ag(7*a7(c)/(3*bY));return[bY*b*(2*ab(2*a/3)-1)/bZ,9*a7(a/3)/bZ]}function K(g,b){for(var e,h=(1+bb)*a7(b),a=b,f=0;f<25&&(a-=e=(a7(a/2)+a7(a)-h)/(.5*ab(a/2)+ab(a)),!(aZ(e)<a9));f++);return[g*(1+2*ab(a)/ab(a/2))/(3*d),2*c(3)*a7(a/2)/c(2+d)]}function L(h,d){for(var e,f=c(6/(4+b)),i=(1+b/4)*a7(d),a=d/2,g=0;g<25&&(a-=e=(a/2+a7(a)-i)/(.5+ab(a)),!(aZ(e)<a9));g++);return[f*(.5+ab(a))*h/1.5,f*a]}function M(e,c){var a=c*c,b=a*a,d=a*b;return[e*(.84719-.13063*a+d*d*(-0.04515+.05494*a-.02326*b+.00331*d)),c*(1.01183+b*b*(-0.02625+.01926*a-.00396*b))]}function N(b,a){return[b*(1+ab(a))/2,2*(a-a8(a/2))]}J.invert=function(b,c){var a=3*ag(c*bZ/9);return[b*bZ/(bY*(2*ab(2*a/3)-1)),ag(3*a7(a)*bY/7)]},K.invert=function(e,f){var b=f*c(2+d)/(2*c(3)),a=2*ag(b);return[3*d*e/(1+2*ab(a)/ab(a/2)),ag((b+a7(a))/(1+bb))]},L.invert=function(e,f){var d=c(6/(4+b)),a=f/d;return aZ(aZ(a)-ad)<a9&&(a=a<0?-ad:ad),[1.5*e/(d*(.5+ab(a))),ag((a/2+a7(a))/(1+b/4))]},M.invert=function(g,e){var f,b,a,d,c=e,h=25;do a=(b=c*c)*b,c-=f=(c*(1.01183+a*a*(-0.02625+.01926*b-.00396*a))-e)/(1.01183+a*a*(-0.23625+.21186*b+ -0.05148*a));while(aZ(f)>1e-12&& --h>0)return a=(b=c*c)*b,d=b*a,[g/(.84719-.13063*b+d*d*(-0.04515+.05494*b-.02326*a+.00331*d)),c]},N.invert=function(e,a){for(var f=a/2,b=0,c=1/0;b<10&&aZ(c)>a9;++b){var d=ab(a/2);a-=c=(a-a8(a/2)-f)/(1-.5/(d*d))}return[2*e/(1+ab(a)),a]};var b$=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function O(a,d){var e=a7(d),j=ab(d),n=a6(a);if(0===a||aZ(d)===ad)return[0,d];if(0===d)return[a,0];if(aZ(a)===ad)return[a*j,ad*e];var f=b/(2*a)-2*a/b,k=2*d/b,g=(1-k*k)/(e-k),h=f*f,i=g*g,o=1+h/i,p=1+i/h,l=(f*e/g-f/2)/o,m=(i*e/h+g/2)/p,r=l*l+j*j/o,q=m*m-(i*e*e/h+g*e-1)/p;return[ad*(l+c(r)*n),ad*(m+c(q<0?0:q)*a6(-d*f)*n)]}function P(c,b){var a=b*b;return[c,b*(1.0148+a*a*(.23185+a*(-0.14499+.02406*a)))]}function Q(b,a){if(aZ(a)<a9)return[b,0];var c=a8(a),d=b*a7(a);return[a7(d)/c,a+(1-ab(d))/c]}function b_(a,b){return[a[0]*b[0]+a[1]*b[3],a[0]*b[1]+a[1]*b[4],a[0]*b[2]+a[1]*b[5]+a[2],a[3]*b[0]+a[4]*b[3],a[3]*b[1]+a[4]*b[4],a[3]*b[2]+a[4]*b[5]+a[5]]}function b0(a,b){return[a[0]-b[0],a[1]-b[1]]}function b1(a){return c(a[0]*a[0]+a[1]*a[1])}function aL(b,f,c){function e(c,f){if(c.edges=b5(c.face),f.face){var g,h,i,j,l,m,k,n,d=c.shared=b4(c.face,f.face),p=(i=d.map(f.project),j=d.map(c.project),l=b0(i[1],i[0]),m=b0(j[1],j[0]),k=(g=l,h=m,a_(g[0]*h[1]-g[1]*h[0],g[0]*h[0]+g[1]*h[1])),n=b1(l)/b1(m),b_([1,0,i[0][0],0,1,i[0][1]],b_([n,0,0,0,n,0],b_([ab(k),a7(k),0,-a7(k),ab(k),0],[1,0,-j[0][0],0,1,-j[0][1]]))));c.transform=f.transform?b_(f.transform,p):p;for(var b=f.edges,a=0,o=b.length;a<o;++a)b3(d[0],b[a][1])&&b3(d[1],b[a][0])&&(b[a]=c),b3(d[0],b[a][0])&&b3(d[1],b[a][1])&&(b[a]=c);for(a=0,o=(b=c.edges).length;a<o;++a)b3(d[0],b[a][0])&&b3(d[1],b[a][1])&&(b[a]=f),b3(d[0],b[a][1])&&b3(d[1],b[a][0])&&(b[a]=f)}else c.transform=f.transform;return c.children&&c.children.forEach(function(a){e(a,c)}),c}function d(c,d){var a,e=f(c,d),b=e.project([c*ae,d*ae]);return(a=e.transform)?[a[0]*b[0]+a[1]*b[1]+a[2],-(a[3]*b[0]+a[4]*b[1]+a[5])]:(b[1]=-b[1],b)}function g(c,f){var h=c.project.invert,a=c.transform,b=f;if(a&&(b=[(a=[(m=1/((l=a)[0]*l[4]-l[1]*l[3]))*l[4],-m*l[1],m*(l[1]*l[5]-l[2]*l[4]),-m*l[3],m*l[0],m*(l[2]*l[3]-l[0]*l[5])])[0]*b[0]+a[1]*b[1]+a[2],a[3]*b[0]+a[4]*b[1]+a[5]]),h&&c===i(j=h(b)))return j;for(var l,m,j,d=c.children,e=0,k=d&&d.length;e<k;++e)if(j=g(d[e],f))return j}function i(a){return f(a[0]*af,a[1]*af)}e(b,{transform:null}),b6(b)&&(d.invert=function(c,d){var a=g(b,[c,-d]);return a&&(a[0]*=af,a[1]*=af,a)});var a=h.geoProjection(d),j=a.stream;return a.stream=function(c){var e=a.rotate(),d=j(c),f=(a.rotate([0,0]),j(c));return a.rotate(e),d.sphere=function(){f.polygonStart(),f.lineStart(),b2(f,b),f.lineEnd(),f.polygonEnd()},d},a.angle(null==c?-30:c*ae)}function b2(f,c,g){var d,a,i=c.edges,j=i.length,o={type:"MultiPoint",coordinates:c.face},p=c.face.filter(function(a){return 90!==aZ(a[1])}),b=h.geoBounds({type:"MultiPoint",coordinates:p}),k=!1,e=-1,m=b[1][0]-b[0][0],n=180===m||360===m?[(b[0][0]+b[1][0])/2,(b[0][1]+b[1][1])/2]:h.geoCentroid(o);if(g)for(;++e<j&&i[e]!==g;);++e;for(var l=0;l<j;++l)a=i[(l+e)%j],Array.isArray(a)?(k||(f.point((d=h.geoInterpolate(a[0],n)(a9))[0],d[1]),k=!0),f.point((d=h.geoInterpolate(a[1],n)(a9))[0],d[1])):(k=!1,a!==g&&b2(f,a,c))}function b3(a,b){return a&&b&&a[0]===b[0]&&a[1]===b[1]}function b4(e,f){for(var a,b,h=e.length,c=null,d=0;d<h;++d){a=e[d];for(var g=f.length;--g>=0;)if(b=f[g],a[0]===b[0]&&a[1]===b[1]){if(c)return[c,a];c=a}}}function b5(a){for(var c=a.length,d=[],e=a[c-1],b=0;b<c;++b)d.push([e,e=a[b]]);return d}function b6(a){return a.project.invert||a.children&&a.children.some(b6)}O.invert=function(a,e){var f=(a/=ad)*a,d=f+(e/=ad)*e,g=b*b;return[a?(d-1+c((1-d)*(1-d)+4*f))/(2*a)*ad:0,bj(function(a){return d*(b*a7(a)-2*a)*b+4*a*a*(e-a7(a))+2*b*a-g*e},0)]},P.invert=function(e,b){b>1.790857183?b=1.790857183:b< -1.790857183&&(b=-1.790857183);var d,c=b;do{var a=c*c;c-=d=(c*(1.0148+a*a*(.23185+a*(-0.14499+.02406*a)))-b)/(1.0148+a*a*(1.1592500000000001+a*(-1.01493+.21654*a)))}while(aZ(d)>a9)return[e,c]},Q.invert=function(c,b){if(aZ(b)<a9)return[c,0];var e,h=c*c+b*b,a=.5*b,i=10;do{var d=a8(a),f=1/ab(a),g=h-2*b*a+a*a;a-=e=(d*g+2*(a-b))/(2+g*f*f+2*(a-b)*d)}while(aZ(e)>a9&& --i>0)return d=a8(a),[(aZ(b)<aZ(a+1/d)?ag(c*d):a6(b)*a6(c)*(be(aZ(c*d))+ad))/a7(a),a]};var b7=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],b8=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(a){return a.map(function(a){return b7[a]})}),b9=2/c(3);function aM(b,c){var a=n(b,c);return[a[0]*b9,a[1]]}function ca(b,d){for(var a=0,e=b.length,c=0;a<e;++a)c+=b[a]*d[a];return c}function cb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function cc(a){return[a_(a[1],a[0])*ae,ag(a2(-1,a3(1,a[2])))*ae]}function cd(a){var b=a[0]*af,c=a[1]*af,d=ab(c);return[d*ab(b),d*a7(b),a7(c)]}function f(){}function ce(a,b){return{type:"FeatureCollection",features:a.features.map(function(a){return cf(a,b)})}}function cf(a,b){return{type:"Feature",id:a.id,properties:a.properties,geometry:cg(a.geometry,b)}}function cg(b,c){var a,d,e;if(!b)return null;if("GeometryCollection"===b.type)return d=b,e=c,{type:"GeometryCollection",geometries:d.geometries.map(function(a){return cg(a,e)})};switch(b.type){case"Point":a=cj;break;case"MultiPoint":a=cj;break;case"LineString":a=ck;break;case"MultiLineString":a=ck;break;case"Polygon":a=cl;break;case"MultiPolygon":a=cl;break;case"Sphere":a=cl;break;default:return null}return h.geoStream(b,c(a)),a.result()}aM.invert=function(a,b){return n.invert(a/b9,b)};var ch=[],ci=[],cj={point:function(a,b){ch.push([a,b])},result:function(){var a=ch.length?ch.length<2?{type:"Point",coordinates:ch[0]}:{type:"MultiPoint",coordinates:ch}:null;return ch=[],a}},ck={lineStart:f,point:function(a,b){ch.push([a,b])},lineEnd:function(){ch.length&&(ci.push(ch),ch=[])},result:function(){var a=ci.length?ci.length<2?{type:"LineString",coordinates:ci[0]}:{type:"MultiLineString",coordinates:ci}:null;return ci=[],a}},cl={polygonStart:f,lineStart:f,point:function(a,b){ch.push([a,b])},lineEnd:function(){var a=ch.length;if(a){do ch.push(ch[0].slice());while(++a<4)ci.push(ch),ch=[]}},polygonEnd:f,result:function(){if(!ci.length)return null;var a=[],b=[];return ci.forEach(function(c){(function(a){if((c=a.length)<4)return!1;for(var c,b=0,d=a[c-1][1]*a[0][0]-a[c-1][0]*a[0][1];++b<c;)d+=a[b-1][1]*a[b][0]-a[b-1][0]*a[b][1];return d<=0})(c)?a.push([c]):b.push(c)}),b.forEach(function(b){var c=b[0];a.some(function(a){if(function(a,f){for(var m=f[0],b=f[1],c=!1,d=0,g=a.length,h=g-1;d<g;h=d++){var i=a[d],j=i[0],e=i[1],k=a[h],n=k[0],l=k[1];e>b^l>b&&m<(n-j)*(b-e)/(l-e)+j&&(c=!c)}return c}(a[0],c))return a.push(b),!0})||a.push([b])}),ci=[],a.length?a.length>1?{type:"MultiPolygon",coordinates:a}:{type:"Polygon",coordinates:a[0]}:null}};function aN(a){var d=a(ad,0)[0]-a(-ad,0)[0];function c(c,k){var h=aZ(c)<ad,e=a(h?c:c>0?c-b:c+b,k),f=(e[0]-e[1])*bb,g=(e[0]+e[1])*bb;if(h)return[f,g];var i=d*bb,j=f>0^g>0?-1:1;return[j*f-a6(g)*i,j*g-a6(f)*i]}return a.invert&&(c.invert=function(f,g){var c=(f+g)*bb,e=(g-f)*bb,h=aZ(c)<.5*d&&aZ(e)<.5*d;if(!h){var i=d*bb,j=c>0^e>0?-1:1,k=-j*f+(e>0?1:-1)*i,l=-j*g+(c>0?1:-1)*i;c=(-k-l)*bb,e=(k-l)*bb}var m=a.invert(c,e);return h||(m[0]+=c>0?b:-b),m}),h.geoProjection(c).rotate([-90,-90,45]).clipAngle(179.999)}function R(){return aN(B).scale(111.48)}function aO(c){var d=a7(c);function a(b,a){var e=d?a8(b*d/2)/d:b/2;if(!a)return[2*e,-c];var f=2*a$(e*a7(a)),g=1/a8(a);return[a7(f)*g,a+(1-ab(f))*g-c]}return a.invert=function(f,e){if(aZ(e+=c)<a9)return[d?2*a$(d*f/2)/d:f,0];var h,m=f*f+e*e,a=0,n=10;do{var g=a8(a),i=1/ab(a),j=m-2*e*a+a*a;a-=h=(g*j+2*(a-e))/(2+j*i*i+2*(a-e)*g)}while(aZ(h)>a9&& --n>0)var k=f*(g=a8(a)),l=a8(aZ(e)<aZ(a+1/g)?.5*ag(k):.5*be(k)+b/4)/a7(a);return[d?2*a$(d*l)/d:2*l,a]},a}var aP=[[.9986,-0.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function S(m,e){var a,f=a3(18,36*aZ(e)/b),d=a1(f),c=f-d,g=(a=aP[d])[0],h=a[1],i=(a=aP[++d])[0],j=a[1],k=(a=aP[a3(19,++d)])[0],l=a[1];return[m*(i+c*(k-g)/2+c*c*(k-2*i+g)/2),(e>0?ad:-ad)*(j+c*(l-h)/2+c*c*(l-2*j+h)/2)]}function aQ(d,a){var e=function(b){function a(a,c){var d=ab(c),e=(b-1)/(b-d*ab(a));return[e*d*a7(a),e*a7(c)]}return a.invert=function(e,f){var g=e*e+f*f,a=c(g),d=(b-c(1-g*(b+1)/(b-1)))/((b-1)/a+a/(b-1));return[a_(e*d,a*c(1-d*d)),a?ag(f*d/a):0]},a}(d);if(!a)return e;var f=ab(a),g=a7(a);function b(h,i){var a=e(h,i),b=a[1],c=b*g/(d-1)+f;return[a[0]*f/c,b/c]}return b.invert=function(c,a){var b=(d-1)/(d-1-a*g);return e.invert(b*c,b*a*f)},b}function cm(a){return a.length>0}function cn(a){return -90===a||90===a?[0,a]:[-180,Math.floor(1e4*a)/1e4]}function co(d){var a=d[0],b=d[1],c=!1;return a<= -179.9999?(a=-180,c=!0):a>=179.9999&&(a=180,c=!0),b<= -89.9999?(b=-90,c=!0):b>=89.9999&&(b=90,c=!0),c?[a,b]:d}function cp(a){return a.map(co)}function cq(k,f,d){for(var g=0,p=k.length;g<p;++g){var a=k[g].slice();d.push({index:-1,polygon:f,ring:a});for(var b=0,e=a.length;b<e;++b){var h=a[b],l=h[0],i=h[1];if(l<= -179.9999||l>=179.9999||i<= -89.9999||i>=89.9999){a[b]=co(h);for(var c=b+1;c<e;++c){var m=a[c],n=m[0],o=m[1];if(n> -179.9999&&n<179.9999&&o> -89.9999&&o<89.9999)break}if(c===b+1)continue;if(b){var j={index:-1,polygon:f,ring:a.slice(0,b+1)};j.ring[j.ring.length-1]=cn(i),d[d.length-1]=j}else d.pop();if(c>=e)break;d.push({index:-1,polygon:f,ring:a=a.slice(c-1)}),a[0]=cn(a[0][1]),b=-1,e=a.length}}}}function cr(e){var b,a,c,f,d,g,j=e.length,h={},i={};for(b=0;b<j;++b){if(c=(a=e[b]).ring[0],d=a.ring[a.ring.length-1],c[0]===d[0]&&c[1]===d[1]){a.polygon.push(a.ring),e[b]=null;continue}a.index=b,h[c]=i[d]=a}for(b=0;b<j;++b)if(a=e[b]){if(c=a.ring[0],d=a.ring[a.ring.length-1],f=i[c],g=h[d],delete h[c],delete i[d],c[0]===d[0]&&c[1]===d[1]){a.polygon.push(a.ring);continue}f?(delete i[c],delete h[f.ring[0]],f.ring.pop(),e[f.index]=null,a={index:-1,polygon:f.polygon,ring:f.ring.concat(a.ring)},f===g?a.polygon.push(a.ring):(a.index=j++,e.push(h[a.ring[0]]=i[a.ring[a.ring.length-1]]=a))):g?(delete h[d],delete i[g.ring[g.ring.length-1]],a.ring.pop(),a={index:j++,polygon:g.polygon,ring:a.ring.concat(g.ring)},e[g.index]=null,e.push(h[a.ring[0]]=i[a.ring[a.ring.length-1]]=a)):(a.ring.push(a.ring[0]),a.polygon.push(a.ring))}}function cs(a){var b={type:"Feature",geometry:ct(a.geometry)};return null!=a.id&&(b.id=a.id),null!=a.bbox&&(b.bbox=a.bbox),null!=a.properties&&(b.properties=a.properties),b}function ct(a){if(null==a)return a;switch(a.type){case"GeometryCollection":c={type:"GeometryCollection",geometries:a.geometries.map(ct)};break;case"Point":c={type:"Point",coordinates:co(a.coordinates)};break;case"MultiPoint":case"LineString":c={type:a.type,coordinates:cp(a.coordinates)};break;case"MultiLineString":c={type:"MultiLineString",coordinates:a.coordinates.map(cp)};break;case"Polygon":var c,b,d,e,f=[];cq(a.coordinates,f,b=[]),cr(b),c={type:"Polygon",coordinates:f};break;case"MultiPolygon":b=[],d=-1,e=a.coordinates.length;for(var g=new Array(e);++d<e;)cq(a.coordinates[d],g[d]=[],b);cr(b),c={type:"MultiPolygon",coordinates:g.filter(cm)};break;default:return a}return null!=a.bbox&&(c.bbox=a.bbox),c}function T(c,d){var a=a8(d/2),b=a7(ba*a);return[c*(.74482-.34588*b*b),1.70711*a]}function cu(k,d,l){var e=h.geoInterpolate(d,l),a=e(.5),f=h.geoRotation([-a[0],-a[1]])(d),g=e.distance/2,i=-ag(a7(f[1]*af)/a7(g)),j=[-a[0],-a[1],-(f[0]>0?b-i:i)*ae],c=h.geoProjection(k(g)).rotate(j),m=h.geoRotation(j),n=c.center;return delete c.rotate,c.center=function(a){return arguments.length?n(m(a)):m.invert(n())},c.clipAngle(90)}function aR(b){var c=ab(b);function a(b,d){var a=h.geoGnomonicRaw(b,d);return a[0]*=c,a}return a.invert=function(a,b){return h.geoGnomonicRaw.invert(a/c,b)},a}function aS(a,b){return cu(aR,a,b)}function aT(a){if(!(a*=2))return h.geoAzimuthalEquidistantRaw;var e=-a/2,b=-e,f=a*a,g=a8(b),i=.5/a7(b);function d(i,h){var g=be(ab(h)*ab(i-e)),d=be(ab(h)*ab(i-b)),j=h<0?-1:1;return g*=g,d*=d,[(g-d)/(2*a),j*c(4*f*d-(f-g+d)*(f-g+d))/(2*a)]}return d.invert=function(h,d){var a,f,j=d*d,k=ab(c(j+(a=h+e)*a)),l=ab(c(j+(a=h+b)*a));return[a_(f=k-l,a=(k+l)*g),(d<0?-1:1)*be(c(a*a+f*f)*i)]},d}function aU(a,b){return cu(aT,a,b)}function U(a,d){if(aZ(d)<a9)return[a,0];var i=aZ(d/ad),n=ag(i);if(aZ(a)<a9||aZ(aZ(d)-ad)<a9)return[0,a6(d)*b*a8(n/2)];var o=ab(n),f=aZ(b/a-a/b)/2,g=f*f,e=o/(i+o-1),j=e*(2/i-1),k=j*j,h=k+g,l=e-k,m=g+e;return[a6(a)*b*(f*l+c(g*l*l-h*(e*e-k)))/h,a6(d)*b*(j*m-f*c((g+1)*h-m*m))/h]}function V(a,d){if(aZ(d)<a9)return[a,0];var f=aZ(d/ad),h=ag(f);if(aZ(a)<a9||aZ(aZ(d)-ad)<a9)return[0,a6(d)*b*a8(h/2)];var i=ab(h),e=aZ(b/a-a/b)/2,j=e*e,g=i*(c(1+j)-e*i)/(1+j*f*f);return[a6(a)*b*g,a6(d)*b*c(1-g*(2*e+g))]}function W(a,d){if(aZ(d)<a9)return[a,0];var g=d/ad,h=ag(g);if(aZ(a)<a9||aZ(aZ(d)-ad)<a9)return[0,b*a8(h/2)];var e=(b/a-a/b)/2,f=g/(1+ab(h));return[b*(a6(a)*c(e*e+1-f*f)-e),b*f]}function X(e,f){if(!f)return[e,0];var k=aZ(f);if(!e||k===ad)return[0,f];var d=k/ad,a=d*d,g=(8*d-a*(a+2)-5)/(2*a*(d-1)),b=g*g,l=d*g,j=a+b+2*l,m=d+3*g,n=e/ad,o=n+1/n,h=a6(aZ(e)-ad)*c(o*o-4),p=h*h,q=j*(a+b*p-1)+(1-a)*(a*(m*m+4*b)+12*l*b+4*b*b),i=(h*(j+b-1)+2*c(q))/(4*j+p);return[a6(e)*ad*i,a6(f)*ad*c(1+h*aZ(i)-i*i)]}function aV(a,d,e,g){var j=b/3;a=a2(a,a9),d=a2(d,a9),a=a3(a,ad),d=a3(d,b-a9),e=a2(e,0),e=a3(e,100-a9),g=a2(g,a9);var f=be((e/100+1)*ab(j))/j,h=a7(a)/a7(f*ad),i=d/b,k=c(g/100*a7(a/2)/a7(d/2)),l=k/c(i*h*f),m=1/(k*c(i*h*f));return function(b,d,e,f,g){function a(h,k){var a=e*a7(f*k),i=c(1-a*a),j=c(2/(1+i*ab(h*=g)));return[b*i*j*a7(h),d*a*j]}return a.invert=function(h,i){var j=h/b,k=i/d,a=c(j*j+k*k),l=2*ag(a/2);return[a_(h*a8(l),b*a)/g,a&&ag(i*a7(l)/(d*e*a))/f]},a}(l,m,h,f,i)}function aW(){var b=65*af,c=60*af,d=20,e=200,f=h.geoProjectionMutator(aV),a=f(b,c,d,e);return a.poleline=function(a){return arguments.length?f(b=+a*af,c,d,e):b*ae},a.parallels=function(a){return arguments.length?f(b,c=+a*af,d,e):c*ae},a.inflation=function(a){return arguments.length?f(b,c,d=+a,e):d},a.ratio=function(a){return arguments.length?f(b,c,d,e=+a):e},a.scale(163.775)}aP.forEach(function(a){a[1]*=1.0144}),S.invert=function(q,g){var j=g/ad,c=90*j,h=a3(18,aZ(c/5)),a=a2(0,a1(h));do{var d=aP[a][1],e=aP[a+1][1],f=aP[a3(19,a+2)][1],k=f-d,r=f-2*e+d,i=2*(aZ(j)-e)/k,l=r/k,b=i*(1-l*i*(1-2*l*i));if(b>=0||1===a){c=(g>=0?5:-5)*(b+h);var m,s=50;do a=a1(h=a3(18,aZ(c)/5)),b=h-a,d=aP[a][1],e=aP[a+1][1],f=aP[a3(19,a+2)][1],c-=(m=(g>=0?ad:-ad)*(e+b*(f-d)/2+b*b*(f-2*e+d)/2)-g)*ae;while(aZ(m)>1e-12&& --s>0)break}}while(--a>=0)var n=aP[a][0],o=aP[a+1][0],p=aP[a3(19,a+2)][0];return[q/(o+b*(p-n)/2+b*b*(p-2*o+n)/2),c*af]},T.invert=function(c,d){var a=d/1.70711,b=a7(ba*a);return[c/(.74482-.34588*b*b),2*a$(a)]},U.invert=function(f,e){if(aZ(e)<a9)return[f,0];if(aZ(f)<a9)return[0,ad*a7(2*a$(e/b))];var j=(f/=b)*f,g=(e/=b)*e,h=j+g,k=h*h,i=-aZ(e)*(1+h),d=i-2*g+j,a=-2*i+1+2*g+k,n=g/a+(2*d*d*d/(a*a*a)-9*i*d/(a*a))/27,l=(i-d*d/(3*a))/a,m=2*c(-l/3),o=be(3*n/(l*m))/3;return[b*(h-1+c(1+2*(j-g)+k))/(2*f),a6(e)*b*(-m*ab(o+b/3)-d/(3*a))]},V.invert=function(f,e){if(!f)return[0,ad*a7(2*a$(e/b))];var a=aZ(f/b),d=(1-a*a-(e/=b)*e)/(2*a),g=c(d*d+1);return[a6(f)*b*(g-d),a6(e)*ad*a7(2*a_(c((1-2*d*a)*(d+g)-a),c(g+d+a)))]},W.invert=function(a,f){if(!f)return[a,0];var d=f/b,e=(b*b*(1-d*d)-a*a)/(2*b*a);return[a?b*(a6(a)*c(e*e+1)-e):0,ad*a7(2*a$(d))]},X.invert=function(k,g){if(!k||!g)return[k,g];g/=b;var q,n=a6(k)*k/ad,e=(n*n-1+4*g*g)/aZ(n),h=e*e,d=2*g,s=50;do{var a=d*d,i=(8*d-a*(a+2)-5)/(2*a*(d-1)),j=(3*d-a*d-10)/(2*a*d),f=i*i,o=d*i,l=d+i,m=l*l,r=d+3*i,t=m*(a+f*h-1)+(1-a)*(a*(r*r+4*f)+f*(12*o+4*f)),u=-2*l*(4*o*f+(1-4*a+3*a*a)*(1+j)+f*(-6+14*a-h+(-8+8*a-2*h)*j)+o*(-8+12*a+(-10+10*a-h)*j)),p=c(t),v=e*(m+f-1)+2*p-n*(4*m+h),w=e*(2*i*j+2*l*(1+j))+u/p-8*l*(e*(-1+f+m)+2*p)*(1+j)/(h+4*m);d-=q=v/w}while(q>a9&& --s>0)return[a6(k)*(c(e*e+4)+e)*b/4,ad*d]};var Y=4*b+3*c(3),Z=2*c(2*b*c(3)/Y),aX=g(Z*c(3)/b,Z,Y/6);function $(d,a){return[d*c(1-3*a*a/(b*b)),a]}function _(a,e){var b=ab(e),d=ab(a)*b,f=1-d,g=ab(a=a_(a7(a)*b,-a7(e))),h=a7(a);return[h*(b=c(1-d*d))-g*f,-g*b-h*f]}function aa(a,b){var c=i(a,b);return[(c[0]+a/ad)/2,(c[1]+b)/2]}$.invert=function(d,a){return[d/c(1-3*a*a/(b*b)),a]},_.invert=function(b,d){var a=-((b*b+d*d)/2),e=c(-a*(2+a)),f=d*a+b*e,g=b*a-d*e,h=c(g*g+f*f);return[a_(e*f,h*(1+a)),h?-ag(e*g/h):0]},aa.invert=function(k,l){var a=k,b=l,y=25;do{var d,e=ab(b),g=a7(b),m=a7(2*b),n=g*g,j=e*e,o=a7(a),h=ab(a/2),i=a7(a/2),p=i*i,q=1-j*h*h,f=q?be(e*h)*c(d=1/q):d=0,r=.5*(2*f*e*i+a/ad)-k,s=.5*(f*g+b)-l,t=.5*d*(j*p+f*e*h*n)+.5/ad,u=d*(o*m/4-f*g*i),v=.125*d*(m*i-f*g*j*o),w=.5*d*(n*h+f*p*e)+.5,x=u*v-w*t,z=(s*u-r*w)/x,A=(r*v-s*t)/x;a-=z,b-=A}while((aZ(z)>a9||aZ(A)>a9)&& --y>0)return[a,b]},a.geoNaturalEarth=h.geoNaturalEarth1,a.geoNaturalEarthRaw=h.geoNaturalEarth1Raw,a.geoAiry=function(){var b=ad,c=h.geoProjectionMutator(ah),a=c(b);return a.radius=function(a){return arguments.length?c(b=a*af):b*ae},a.scale(179.976).clipAngle(147)},a.geoAiryRaw=ah,a.geoAitoff=function(){return h.geoProjection(i).scale(152.63)},a.geoAitoffRaw=i,a.geoArmadillo=function(){var b=20*af,c=b>=0?1:-1,e=a8(c*b),d=h.geoProjectionMutator(ai),a=d(b),f=a.stream;return a.parallel=function(a){return arguments.length?(e=a8((c=(b=a*af)>=0?1:-1)*b),d(b)):b*ae},a.stream=function(d){var h=a.rotate(),g=f(d),i=(a.rotate([0,0]),f(d)),j=a.precision();return a.rotate(h),g.sphere=function(){i.polygonStart(),i.lineStart();for(var a=-180*c;c*a<180;a+=90*c)i.point(a,90*c);if(b)for(;c*(a-=3*c*j)>= -180;)i.point(a,-(c*a_(ab(a*af/2),e))*ae);i.lineEnd(),i.polygonEnd()},g},a.scale(218.695).center([0,28.0974])},a.geoArmadilloRaw=ai,a.geoAugust=function(){return h.geoProjection(j).scale(66.1603)},a.geoAugustRaw=j,a.geoBaker=function(){return h.geoProjection(k).scale(112.314)},a.geoBakerRaw=k,a.geoBerghaus=function(){var c=5,d=h.geoProjectionMutator(aj),a=d(c),e=a.stream,f=-ab(.01*af),g=a7(.01*af);return a.lobes=function(a){return arguments.length?d(c=+a):c},a.stream=function(d){var i=a.rotate(),h=e(d),j=(a.rotate([0,0]),e(d));return a.rotate(i),h.sphere=function(){j.polygonStart(),j.lineStart();for(var e=0,h=360/c,i=2*b/c,a=90-180/c,d=ad;e<c;++e,a-=h,d-=i)j.point(a_(g*ab(d),f)*ae,ag(g*a7(d))*ae),a< -90?(j.point(-90,-180-a-.01),j.point(-90,-180-a+.01)):(j.point(90,a+.01),j.point(90,a-.01));j.lineEnd(),j.polygonEnd()},h},a.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},a.geoBerghausRaw=aj,a.geoBertin1953=function(){return h.geoProjection(am()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},a.geoBertin1953Raw=am,a.geoBoggs=function(){return h.geoProjection(l).scale(160.857)},a.geoBoggsRaw=l,a.geoBonne=function(){return bm(ao).scale(123.082).center([0,26.1441]).parallel(45)},a.geoBonneRaw=ao,a.geoBottomley=function(){var b=.5,c=h.geoProjectionMutator(ap),a=c(b);return a.fraction=function(a){return arguments.length?c(b=+a):b},a.scale(158.837)},a.geoBottomleyRaw=ap,a.geoBromley=function(){return h.geoProjection(aq).scale(152.63)},a.geoBromleyRaw=aq,a.geoChamberlin=as,a.geoChamberlinRaw=ar,a.geoChamberlinAfrica=function(){return as([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},a.geoCollignon=function(){return h.geoProjection(n).scale(95.6464).center([0,30])},a.geoCollignonRaw=n,a.geoCraig=function(){return bm(at).scale(249.828).clipAngle(90)},a.geoCraigRaw=at,a.geoCraster=function(){return h.geoProjection(o).scale(156.19)},a.geoCrasterRaw=o,a.geoCylindricalEqualArea=function(){return bm(p).parallel(38.58).scale(195.044)},a.geoCylindricalEqualAreaRaw=p,a.geoCylindricalStereographic=function(){return bm(au).scale(124.75)},a.geoCylindricalStereographicRaw=au,a.geoEckert1=function(){return h.geoProjection(q).scale(165.664)},a.geoEckert1Raw=q,a.geoEckert2=function(){return h.geoProjection(r).scale(165.664)},a.geoEckert2Raw=r,a.geoEckert3=function(){return h.geoProjection(s).scale(180.739)},a.geoEckert3Raw=s,a.geoEckert4=function(){return h.geoProjection(t).scale(180.739)},a.geoEckert4Raw=t,a.geoEckert5=function(){return h.geoProjection(u).scale(173.044)},a.geoEckert5Raw=u,a.geoEckert6=function(){return h.geoProjection(v).scale(173.044)},a.geoEckert6Raw=v,a.geoEisenlohr=function(){return h.geoProjection(w).scale(62.5271)},a.geoEisenlohrRaw=w,a.geoFahey=function(){return h.geoProjection(x).scale(137.152)},a.geoFaheyRaw=x,a.geoFoucaut=function(){return h.geoProjection(y).scale(135.264)},a.geoFoucautRaw=y,a.geoFoucautSinusoidal=function(){var b=.5,c=h.geoProjectionMutator(av),a=c(b);return a.alpha=function(a){return arguments.length?c(b=+a):b},a.scale(168.725)},a.geoFoucautSinusoidalRaw=av,a.geoGilbert=function(c){null==c&&(c=h.geoOrthographic);var d=c(),e=h.geoEquirectangular().scale(ae).precision(0).clipAngle(null).translate([0,0]);function b(a){return d(bu(a))}function a(a){b[a]=function(){return arguments.length?(d[a].apply(d,arguments),b):d[a]()}}return d.invert&&(b.invert=function(a){return bv(d.invert(a))}),b.stream=function(b){var c=d.stream(b),a=e.stream({point:function(a,b){c.point(a/2,ag(a8(-b/2*af))*ae)},lineStart:function(){c.lineStart()},lineEnd:function(){c.lineEnd()},polygonStart:function(){c.polygonStart()},polygonEnd:function(){c.polygonEnd()}});return a.sphere=c.sphere,a},b.rotate=function(a){return arguments.length?(e.rotate(a),b):e.rotate()},b.center=function(a){return arguments.length?(d.center(bu(a)),b):bv(d.center())},a("angle"),a("clipAngle"),a("clipExtent"),a("fitExtent"),a("fitHeight"),a("fitSize"),a("fitWidth"),a("scale"),a("translate"),a("precision"),b.scale(249.5)},a.geoGingery=function(){var d=6,c=30*af,f=ab(c),g=a7(c),e=h.geoProjectionMutator(aw),a=e(c,d),i=a.stream,j=-ab(.01*af),k=a7(.01*af);return a.radius=function(a){return arguments.length?(f=ab(c=a*af),g=a7(c),e(c,d)):c*ae},a.lobes=function(a){return arguments.length?e(c,d=+a):d},a.stream=function(c){var h=a.rotate(),e=i(c),l=(a.rotate([0,0]),i(c));return a.rotate(h),e.sphere=function(){l.polygonStart(),l.lineStart();for(var e=0,c=2*b/d,a=0;e<d;++e,a-=c)l.point(a_(k*ab(a),j)*ae,ag(k*a7(a))*ae),l.point(a_(g*ab(a-c/2),f)*ae,ag(g*a7(a-c/2))*ae);l.lineEnd(),l.polygonEnd()},e},a.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},a.geoGingeryRaw=aw,a.geoGinzburg4=function(){return h.geoProjection(ax).scale(149.995)},a.geoGinzburg4Raw=ax,a.geoGinzburg5=function(){return h.geoProjection(ay).scale(153.93)},a.geoGinzburg5Raw=ay,a.geoGinzburg6=function(){return h.geoProjection(az).scale(130.945)},a.geoGinzburg6Raw=az,a.geoGinzburg8=function(){return h.geoProjection(z).scale(131.747)},a.geoGinzburg8Raw=z,a.geoGinzburg9=function(){return h.geoProjection(aA).scale(131.087)},a.geoGinzburg9Raw=aA,a.geoGringorten=function(){return h.geoProjection(by(A)).scale(239.75)},a.geoGringortenRaw=A,a.geoGuyou=function(){return h.geoProjection(by(B)).scale(151.496)},a.geoGuyouRaw=B,a.geoHammer=function(){var b=2,c=h.geoProjectionMutator(ak),a=c(b);return a.coefficient=function(a){return arguments.length?c(b=+a):b},a.scale(169.529)},a.geoHammerRaw=ak,a.geoHammerRetroazimuthal=function(){var b=0,c=h.geoProjectionMutator(aB),a=c(b),d=a.rotate,e=a.stream,f=h.geoCircle();return a.parallel=function(d){if(!arguments.length)return b*ae;var e=a.rotate();return c(b=d*af).rotate(e)},a.rotate=function(c){return arguments.length?(d.call(a,[c[0],c[1]-b*ae]),f.center([-c[0],-c[1]]),a):(c=d.call(a),c[1]+=b*ae,c)},a.stream=function(a){return(a=e(a)).sphere=function(){a.polygonStart();var b,e=.01,c=f.radius(90-e)().coordinates[0],g=c.length-1,d=-1;for(a.lineStart();++d<g;)a.point((b=c[d])[0],b[1]);for(a.lineEnd(),g=(c=f.radius(90+e)().coordinates[0]).length-1,a.lineStart();--d>=0;)a.point((b=c[d])[0],b[1]);a.lineEnd(),a.polygonEnd()},a},a.scale(79.4187).parallel(45).clipAngle(179.999)},a.geoHammerRetroazimuthalRaw=aB,a.geoHealpix=function(){var b=4,c=h.geoProjectionMutator(aC),a=c(b),d=a.stream;return a.lobes=function(a){return arguments.length?c(b=+a):b},a.stream=function(c){var f=a.rotate(),e=d(c),g=(a.rotate([0,0]),d(c));return a.rotate(f),e.sphere=function(){var a,c;h.geoStream((a=180/b,c=[].concat(aY.range(-180,180+a/2,a).map(bG),aY.range(180,-180-a/2,-a).map(bH)),{type:"Polygon",coordinates:[180===a?c.map(bI):c]}),g)},e},a.scale(239.75)},a.geoHealpixRaw=aC,a.geoHill=function(){var b=1,c=h.geoProjectionMutator(aD),a=c(b);return a.ratio=function(a){return arguments.length?c(b=+a):b},a.scale(167.774).center([0,18.67])},a.geoHillRaw=aD,a.geoHomolosine=function(){return h.geoProjection(D).scale(152.63)},a.geoHomolosineRaw=D,a.geoHufnagel=function(){var b=1,c=0,d=45*af,e=2,f=h.geoProjectionMutator(aE),a=f(b,c,d,e);return a.a=function(a){return arguments.length?f(b=+a,c,d,e):b},a.b=function(a){return arguments.length?f(b,c=+a,d,e):c},a.psiMax=function(a){return arguments.length?f(b,c,d=+a*af,e):d*ae},a.ratio=function(a){return arguments.length?f(b,c,d,e=+a):e},a.scale(180.739)},a.geoHufnagelRaw=aE,a.geoHyperelliptical=function(){var b=0,c=2.5,d=1.183136,e=h.geoProjectionMutator(aF),a=e(b,c,d);return a.alpha=function(a){return arguments.length?e(b=+a,c,d):b},a.k=function(a){return arguments.length?e(b,c=+a,d):c},a.gamma=function(a){return arguments.length?e(b,c,d=+a):d},a.scale(152.63)},a.geoHyperellipticalRaw=aF,a.geoInterrupt=aG,a.geoInterruptedBoggs=function(){return aG(l,bM).scale(160.857)},a.geoInterruptedHomolosine=function(){return aG(D,bN).scale(152.63)},a.geoInterruptedMollweide=function(){return aG(an,bO).scale(169.529)},a.geoInterruptedMollweideHemispheres=function(){return aG(an,bP).scale(169.529).rotate([20,0])},a.geoInterruptedSinuMollweide=function(){return aG(C,bQ,bk).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},a.geoInterruptedSinusoidal=function(){return aG(m,bR).scale(152.63).rotate([-20,0])},a.geoKavrayskiy7=function(){return h.geoProjection(E).scale(158.837)},a.geoKavrayskiy7Raw=E,a.geoLagrange=function(){var b=.5,c=h.geoProjectionMutator(aH),a=c(b);return a.spacing=function(a){return arguments.length?c(b=+a):b},a.scale(124.75)},a.geoLagrangeRaw=aH,a.geoLarrivee=function(){return h.geoProjection(F).scale(97.2672)},a.geoLarriveeRaw=F,a.geoLaskowski=function(){return h.geoProjection(G).scale(139.98)},a.geoLaskowskiRaw=G,a.geoLittrow=function(){return h.geoProjection(H).scale(144.049).clipAngle(89.999)},a.geoLittrowRaw=H,a.geoLoximuthal=function(){return bm(aI).parallel(40).scale(158.837)},a.geoLoximuthalRaw=aI,a.geoMiller=function(){return h.geoProjection(I).scale(108.318)},a.geoMillerRaw=I,a.geoModifiedStereographic=aK,a.geoModifiedStereographicRaw=aJ,a.geoModifiedStereographicAlaska=function(){return aK(bT,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},a.geoModifiedStereographicGs48=function(){return aK(bU,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},a.geoModifiedStereographicGs50=function(){return aK(bV,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},a.geoModifiedStereographicMiller=function(){return aK(bW,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},a.geoModifiedStereographicLee=function(){return aK(bX,[165,10]).scale(250).clipAngle(130).center([-165,-10])},a.geoMollweide=function(){return h.geoProjection(an).scale(169.529)},a.geoMollweideRaw=an,a.geoMtFlatPolarParabolic=function(){return h.geoProjection(J).scale(164.859)},a.geoMtFlatPolarParabolicRaw=J,a.geoMtFlatPolarQuartic=function(){return h.geoProjection(K).scale(188.209)},a.geoMtFlatPolarQuarticRaw=K,a.geoMtFlatPolarSinusoidal=function(){return h.geoProjection(L).scale(166.518)},a.geoMtFlatPolarSinusoidalRaw=L,a.geoNaturalEarth2=function(){return h.geoProjection(M).scale(175.295)},a.geoNaturalEarth2Raw=M,a.geoNellHammer=function(){return h.geoProjection(N).scale(152.63)},a.geoNellHammerRaw=N,a.geoInterruptedQuarticAuthalic=function(){return aG(ak(1/0),b$).rotate([20,0]).scale(152.63)},a.geoNicolosi=function(){return h.geoProjection(O).scale(127.267)},a.geoNicolosiRaw=O,a.geoPatterson=function(){return h.geoProjection(P).scale(139.319)},a.geoPattersonRaw=P,a.geoPolyconic=function(){return h.geoProjection(Q).scale(103.74)},a.geoPolyconicRaw=Q,a.geoPolyhedral=aL,a.geoPolyhedralButterfly=function(a){a=a||function(b){var a=h.geoCentroid({type:"MultiPoint",coordinates:b});return h.geoGnomonic().scale(1).translate([0,0]).rotate([-a[0],-a[1]])};var c=b8.map(function(b){return{face:b,project:a(b)}});return[-1,0,0,1,0,1,4,5].forEach(function(b,d){var a=c[b];a&&(a.children||(a.children=[])).push(c[d])}),aL(c[0],function(d,a){return c[d< -b/2?a<0?6:4:d<0?a<0?2:0:d<b/2?a<0?3:1:a<0?7:5]}).angle(-30).scale(101.858).center([0,45])},a.geoPolyhedralCollignon=function(a){a=a||function(b){var a=h.geoCentroid({type:"MultiPoint",coordinates:b});return h.geoProjection(aM).translate([0,0]).scale(1).rotate(a[1]>0?[-a[0],0]:[180-a[0],180])};var c=b8.map(function(b){return{face:b,project:a(b)}});return[-1,0,0,1,0,1,4,5].forEach(function(b,d){var a=c[b];a&&(a.children||(a.children=[])).push(c[d])}),aL(c[0],function(d,a){return c[d< -b/2?a<0?6:4:d<0?a<0?2:0:d<b/2?a<0?3:1:a<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},a.geoPolyhedralWaterman=function(a){a=a||function(a){var b=6===a.length?h.geoCentroid({type:"MultiPoint",coordinates:a}):a[0];return h.geoGnomonic().scale(1).translate([0,0]).rotate([-b[0],-b[1]])};var c=b8.map(function(g){for(var a,c=g.map(cd),e=c.length,b=c[e-1],f=[],d=0;d<e;++d)a=c[d],f.push(cc([.9486832980505138*b[0]+.31622776601683794*a[0],.9486832980505138*b[1]+.31622776601683794*a[1],.9486832980505138*b[2]+.31622776601683794*a[2]]),cc([.9486832980505138*a[0]+.31622776601683794*b[0],.9486832980505138*a[1]+.31622776601683794*b[1],.9486832980505138*a[2]+.31622776601683794*b[2]])),b=a;return f}),f=[],d=[-1,0,0,1,0,1,4,5];c.forEach(function(e,g){for(var h=b8[g],b=h.length,i=f[g]=[],a=0;a<b;++a)c.push([h[a],e[(2*a+2)%(2*b)],e[(2*a+1)%(2*b)]]),d.push(g),i.push(cb(cd(e[(2*a+2)%(2*b)]),cd(e[(2*a+1)%(2*b)])))});var e=c.map(function(b){return{project:a(b),face:b}});return d.forEach(function(b,c){var a=e[b];a&&(a.children||(a.children=[])).push(e[c])}),aL(e[0],function(c,a){var i=ab(a),g=[i*ab(c),i*a7(c),a7(a)],d=c< -b/2?a<0?6:4:c<0?a<0?2:0:c<b/2?a<0?3:1:a<0?7:5,h=f[d];return e[0>ca(h[0],g)?8+3*d:0>ca(h[1],g)?8+3*d+1:0>ca(h[2],g)?8+3*d+2:d]}).angle(-30).scale(110.625).center([0,45])},a.geoProject=function(b,d){var a,c=d.stream;if(!c)throw new Error("invalid projection");switch(b&&b.type){case"Feature":a=cf;break;case"FeatureCollection":a=ce;break;default:a=cg;break}return a(b,c)},a.geoGringortenQuincuncial=function(){return aN(A).scale(176.423)},a.geoPeirceQuincuncial=R,a.geoPierceQuincuncial=R,a.geoQuantize=function(a,b){if(!(0<=(b=+b)&&b<=20))throw new Error("invalid digits");function f(a){var e=a.length,c=2,d=new Array(e);for(d[0]=+a[0].toFixed(b),d[1]=+a[1].toFixed(b);c<e;)d[c]=a[c],++c;return d}function g(a){for(var c=f(a[0]),d=[c],e=1;e<a.length;e++){var b=f(a[e]);(b.length>2||b[0]!=c[0]||b[1]!=c[1])&&(d.push(b),c=b)}return 1===d.length&&a.length>1&&d.push(f(a[a.length-1])),d}function h(a){return a.map(g)}function e(a){var b;if(null==a)return a;switch(a.type){case"GeometryCollection":b={type:"GeometryCollection",geometries:a.geometries.map(e)};break;case"Point":b={type:"Point",coordinates:f(a.coordinates)};break;case"MultiPoint":b={type:a.type,coordinates:a.coordinates.map(f)};break;case"LineString":b={type:a.type,coordinates:g(a.coordinates)};break;case"MultiLineString":case"Polygon":b={type:a.type,coordinates:h(a.coordinates)};break;case"MultiPolygon":b={type:"MultiPolygon",coordinates:a.coordinates.map(h)};break;default:return a}return null!=a.bbox&&(b.bbox=a.bbox),b}function c(a){var b={type:"Feature",properties:a.properties,geometry:e(a.geometry)};return null!=a.id&&(b.id=a.id),null!=a.bbox&&(b.bbox=a.bbox),b}if(null!=a)switch(a.type){case"Feature":return c(a);case"FeatureCollection":var d={type:"FeatureCollection",features:a.features.map(c)};return null!=a.bbox&&(d.bbox=a.bbox),d;default:return e(a)}return a},a.geoQuincuncial=aN,a.geoRectangularPolyconic=function(){return bm(aO).scale(131.215)},a.geoRectangularPolyconicRaw=aO,a.geoRobinson=function(){return h.geoProjection(S).scale(152.63)},a.geoRobinsonRaw=S,a.geoSatellite=function(){var b=2,c=0,d=h.geoProjectionMutator(aQ),a=d(b,c);return a.distance=function(a){return arguments.length?d(b=+a,c):b},a.tilt=function(a){return arguments.length?d(b,c=a*af):c*ae},a.scale(432.147).clipAngle(be(1/b)*ae-1e-6)},a.geoSatelliteRaw=aQ,a.geoSinuMollweide=function(){return h.geoProjection(C).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},a.geoSinuMollweideRaw=C,a.geoSinusoidal=function(){return h.geoProjection(m).scale(152.63)},a.geoSinusoidalRaw=m,a.geoStitch=function(a){if(null==a)return a;switch(a.type){case"Feature":return cs(a);case"FeatureCollection":var b={type:"FeatureCollection",features:a.features.map(cs)};return null!=a.bbox&&(b.bbox=a.bbox),b;default:return ct(a)}},a.geoTimes=function(){return h.geoProjection(T).scale(146.153)},a.geoTimesRaw=T,a.geoTwoPointAzimuthal=aS,a.geoTwoPointAzimuthalRaw=aR,a.geoTwoPointAzimuthalUsa=function(){return aS([-158,21.5],[-77,39]).clipAngle(60).scale(400)},a.geoTwoPointEquidistant=aU,a.geoTwoPointEquidistantRaw=aT,a.geoTwoPointEquidistantUsa=function(){return aU([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},a.geoVanDerGrinten=function(){return h.geoProjection(U).scale(79.4183)},a.geoVanDerGrintenRaw=U,a.geoVanDerGrinten2=function(){return h.geoProjection(V).scale(79.4183)},a.geoVanDerGrinten2Raw=V,a.geoVanDerGrinten3=function(){return h.geoProjection(W).scale(79.4183)},a.geoVanDerGrinten3Raw=W,a.geoVanDerGrinten4=function(){return h.geoProjection(X).scale(127.16)},a.geoVanDerGrinten4Raw=X,a.geoWagner=aW,a.geoWagner7=function(){return aW().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},a.geoWagnerRaw=aV,a.geoWagner4=function(){return h.geoProjection(aX).scale(176.84)},a.geoWagner4Raw=aX,a.geoWagner6=function(){return h.geoProjection($).scale(152.63)},a.geoWagner6Raw=$,a.geoWiechel=function(){return h.geoProjection(_).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},a.geoWiechelRaw=_,a.geoWinkel3=function(){return h.geoProjection(aa).scale(158.837)},a.geoWinkel3Raw=aa,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-array")):"function"==typeof a&&a.amd?a(["exports","d3-array"],f):f((e=e||self).d3=e.d3||{},e.d3)}(this,function(a,X){"use strict";function c(){return new f}function f(){this.reset()}f.prototype={constructor:f,reset:function(){this.s=this.t=0},add:function(a){Z(Y,a,this.t),Z(this,Y.s,this.s),this.s?this.t+=Y.t:this.s=Y.t},valueOf:function(){return this.s}};var Y=new f;function Z(b,a,c){var d=b.s=a+c,e=d-a;b.t=a-(d-e)+(c-e)}var $=1e-6,d=Math.PI,u=d/2,_=d/4,aa=2*d,ab=180/d,v=d/180,ac=Math.abs,w=Math.atan,ad=Math.atan2,x=Math.cos,ae=Math.ceil,af=Math.exp,ag=Math.log,ah=Math.pow,ai=Math.sin,aj=Math.sign||function(a){return a>0?1:a<0?-1:0},y=Math.sqrt,ak=Math.tan;function al(a){return a>1?0:a< -1?d:Math.acos(a)}function z(a){return a>1?u:a< -1?-u:Math.asin(a)}function am(a){return(a=ai(a/2))*a}function b(){}function an(a,b){a&&ap.hasOwnProperty(a.type)&&ap[a.type](a,b)}var ao={Feature:function(a,b){an(a.geometry,b)},FeatureCollection:function(c,d){for(var a=c.features,b=-1,e=a.length;++b<e;)an(a[b].geometry,d)}},ap={Sphere:function(b,a){a.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,d){for(var b=a.coordinates,c=-1,e=b.length;++c<e;)a=b[c],d.point(a[0],a[1],a[2])},LineString:function(a,b){aq(a.coordinates,b,0)},MultiLineString:function(c,d){for(var a=c.coordinates,b=-1,e=a.length;++b<e;)aq(a[b],d,0)},Polygon:function(a,b){ar(a.coordinates,b)},MultiPolygon:function(c,d){for(var a=c.coordinates,b=-1,e=a.length;++b<e;)ar(a[b],d)},GeometryCollection:function(c,d){for(var a=c.geometries,b=-1,e=a.length;++b<e;)an(a[b],d)}};function aq(c,b,e){var a,d=-1,f=c.length-e;for(b.lineStart();++d<f;)a=c[d],b.point(a[0],a[1],a[2]);b.lineEnd()}function ar(b,a){var c=-1,d=b.length;for(a.polygonStart();++c<d;)aq(b[c],a,1);a.polygonEnd()}function A(a,b){a&&ao.hasOwnProperty(a.type)?ao[a.type](a,b):an(a,b)}var as,at,au,av,aw,ax=c(),ay=c(),az={point:b,lineStart:b,lineEnd:b,polygonStart:function(){ax.reset(),az.lineStart=aA,az.lineEnd=aB},polygonEnd:function(){var a=+ax;ay.add(a<0?aa+a:a),this.lineStart=this.lineEnd=this.point=b},sphere:function(){ay.add(aa)}};function aA(){az.point=aC}function aB(){aD(as,at)}function aC(b,a){az.point=aD,as=b,at=a,b*=v,a*=v,au=b,av=x(a=a/2+_),aw=ai(a)}function aD(b,a){b*=v,a*=v;var c=b-au,d=c>=0?1:-1,e=d*c,f=x(a=a/2+_),g=ai(a),h=aw*g,i=av*f+h*x(e),j=h*d*ai(e);ax.add(ad(j,i)),au=b,av=f,aw=g}function aE(a){return[ad(a[1],a[0]),z(a[2])]}function aF(a){var b=a[0],c=a[1],d=x(c);return[d*x(b),d*ai(b),ai(c)]}function aG(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function aH(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function aI(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function aJ(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function aK(a){var b=y(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}var aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV=c(),aW={point:aX,lineStart:aZ,lineEnd:a$,polygonStart:function(){aW.point=a_,aW.lineStart=a0,aW.lineEnd=a1,aV.reset(),az.polygonStart()},polygonEnd:function(){az.polygonEnd(),aW.point=aX,aW.lineStart=aZ,aW.lineEnd=a$,ax<0?(aL=-(aN=180),aM=-(aO=90)):aV>$?aO=90:aV< -$&&(aM=-90),aU[0]=aL,aU[1]=aN},sphere:function(){aL=-(aN=180),aM=-(aO=90)}};function aX(b,a){aT.push(aU=[aL=b,aN=b]),a<aM&&(aM=a),a>aO&&(aO=a)}function aY(a,b){var i=aF([a*v,b*v]);if(aS){var g=aH(aS,i),c=aH([g[1],-g[0],0],g);aK(c);var f,j=a-aP,d=j>0?1:-1,e=(c=aE(c))[0]*ab*d,h=ac(j)>180;h^(d*aP<e&&e<d*a)?(f=c[1]*ab)>aO&&(aO=f):h^(d*aP<(e=(e+360)%360-180)&&e<d*a)?(f=-c[1]*ab)<aM&&(aM=f):(b<aM&&(aM=b),b>aO&&(aO=b)),h?a<aP?a2(aL,a)>a2(aL,aN)&&(aN=a):a2(a,aN)>a2(aL,aN)&&(aL=a):aN>=aL?(a<aL&&(aL=a),a>aN&&(aN=a)):a>aP?a2(aL,a)>a2(aL,aN)&&(aN=a):a2(a,aN)>a2(aL,aN)&&(aL=a)}else aT.push(aU=[aL=a,aN=a]);b<aM&&(aM=b),b>aO&&(aO=b),aS=i,aP=a}function aZ(){aW.point=aY}function a$(){aU[0]=aL,aU[1]=aN,aW.point=aX,aS=null}function a_(a,c){if(aS){var b=a-aP;aV.add(ac(b)>180?b+(b>0?360:-360):b)}else aQ=a,aR=c;az.point(a,c),aY(a,c)}function a0(){az.lineStart()}function a1(){a_(aQ,aR),az.lineEnd(),ac(aV)>$&&(aL=-(aN=180)),aU[0]=aL,aU[1]=aN,aS=null}function a2(b,a){return(a-=b)<0?a+360:a}function a3(a,b){return a[0]-b[0]}function a4(a,b){return a[0]<=a[1]?a[0]<=b&&b<=a[1]:b<a[0]||a[1]<b}var a5={sphere:b,point:a6,lineStart:a8,lineEnd:bb,polygonStart:function(){a5.lineStart=bc,a5.lineEnd=bd},polygonEnd:function(){a5.lineStart=a8,a5.lineEnd=bb}};function a6(a,b){a*=v;var c=x(b*=v);a7(c*x(a),c*ai(a),ai(b))}function a7(a,b,c){++bA,bC+=(a-bC)/bA,bD+=(b-bD)/bA,bE+=(c-bE)/bA}function a8(){a5.point=a9}function a9(a,b){a*=v;var c=x(b*=v);bN=c*x(a),bO=c*ai(a),bP=ai(b),a5.point=ba,a7(bN,bO,bP)}function ba(e,f){e*=v;var g=x(f*=v),b=g*x(e),c=g*ai(e),d=ai(f),a=ad(y((a=bO*d-bP*c)*a+(a=bP*b-bN*d)*a+(a=bN*c-bO*b)*a),bN*b+bO*c+bP*d);bB+=a,bF+=a*(bN+(bN=b)),bG+=a*(bO+(bO=c)),bH+=a*(bP+(bP=d)),a7(bN,bO,bP)}function bb(){a5.point=a6}function bc(){a5.point=be}function bd(){bf(bL,bM),a5.point=a6}function be(a,b){bL=a,bM=b,a*=v,b*=v,a5.point=bf;var c=x(b);bN=c*x(a),bO=c*ai(a),bP=ai(b),a7(bN,bO,bP)}function bf(b,k){b*=v;var l=x(k*=v),c=l*x(b),d=l*ai(b),e=ai(k),f=bO*e-bP*d,g=bP*c-bN*e,h=bN*d-bO*c,i=y(f*f+g*g+h*h),a=z(i),j=i&& -a/i;bI+=j*f,bJ+=j*g,bK+=j*h,bB+=a,bF+=a*(bN+(bN=c)),bG+=a*(bO+(bO=d)),bH+=a*(bP+(bP=e)),a7(bN,bO,bP)}function bg(a){return function(){return a}}function bh(b,c){function a(a,d){return c((a=b(a,d))[0],a[1])}return b.invert&&c.invert&&(a.invert=function(a,d){return(a=c.invert(a,d))&&b.invert(a[0],a[1])}),a}function h(a,b){return[ac(a)>d?a+Math.round(-a/aa)*aa:a,b]}function bi(c,a,b){return(c%=aa)?a||b?bh(bk(c),bl(a,b)):bk(c):a||b?bl(a,b):h}function bj(a){return function(b,c){return[(b+=a)>d?b-aa:b< -d?b+aa:b,c]}}function bk(a){var b=bj(a);return b.invert=bj(-a),b}function bl(a,b){var d=x(a),e=ai(a),f=x(b),g=ai(b);function c(a,b){var c=x(b),h=x(a)*c,i=ai(a)*c,j=ai(b),k=j*d+h*e;return[ad(i*f-k*g,h*d-j*e),z(k*f+i*g)]}return c.invert=function(a,b){var c=x(b),h=x(a)*c,i=ai(a)*c,j=ai(b),k=j*f-i*g;return[ad(i*f+j*g,h*d+k*e),z(k*d-h*e)]},c}function B(a){function b(b){return b=a(b[0]*v,b[1]*v),b[0]*=ab,b[1]*=ab,b}return a=bi(a[0]*v,a[1]*v,a.length>2?a[2]*v:0),b.invert=function(b){return b=a.invert(b[0]*v,b[1]*v),b[0]*=ab,b[1]*=ab,b},b}function bm(k,e,h,c,a,b){if(h){var f=x(e),i=ai(e),j=c*h;null==a?(a=e+c*aa,b=e-j/2):(a=bn(f,a),b=bn(f,b),(c>0?a<b:a>b)&&(a+=c*aa));for(var g,d=a;c>0?d>b:d<b;d-=j)g=aE([f,-i*x(d),-i*ai(d)]),k.point(g[0],g[1])}}function bn(c,a){a=aF(a),a[0]-=c,aK(a);var b=al(-a[1]);return((0> -a[2]?-b:b)+aa-$)%aa}function bo(){var a,c=[];return{point:function(b,c,d){a.push([b,c,d])},lineStart:function(){c.push(a=[])},lineEnd:b,rejoin:function(){c.length>1&&c.push(c.pop().concat(c.shift()))},result:function(){var b=c;return c=[],a=null,b}}}function bp(a,b){return ac(a[0]-b[0])<$&&ac(a[1]-b[1])<$}function bq(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function br(m,n,j,k,c){var b,e,i=[],f=[];if(m.forEach(function(a){if(!((h=a.length-1)<=0)){var h,d,e=a[0],g=a[h];if(bp(e,g)){if(!e[2]&&!g[2]){for(c.lineStart(),b=0;b<h;++b)c.point((e=a[b])[0],e[1]);c.lineEnd();return}g[0]+=2*$}i.push(d=new bq(e,a,null,!0)),f.push(d.o=new bq(e,null,d,!1)),i.push(d=new bq(g,a,null,!1)),f.push(d.o=new bq(g,null,d,!0))}}),i.length){for(f.sort(n),bs(i),bs(f),b=0,e=f.length;b<e;++b)f[b].e=j=!j;for(var d,g,l=i[0];;){for(var a=l,h=!0;a.v;)if((a=a.n)===l)return;d=a.z,c.lineStart();do{if(a.v=a.o.v=!0,a.e){if(h)for(b=0,e=d.length;b<e;++b)c.point((g=d[b])[0],g[1]);else k(a.x,a.n.x,1,c);a=a.n}else{if(h)for(b=(d=a.p.z).length-1;b>=0;--b)c.point((g=d[b])[0],g[1]);else k(a.x,a.p.x,-1,c);a=a.p}d=(a=a.o).z,h=!h}while(!a.v)c.lineEnd()}}}function bs(c){if(e=c.length){for(var e,a,d=0,b=c[0];++d<e;)b.n=a=c[d],a.p=b,b=a;b.n=a=c[0],a.p=b}}h.invert=h;var bt=c();function bu(a){return ac(a[0])<=d?a[0]:aj(a[0])*((ac(a[0])+d)%aa-d)}function bv(o,p){var c=bu(p),b=p[1],q=ai(b),F=[ai(c),-x(c),0],h=0,r=0;bt.reset(),1===q?b=u+$:-1===q&&(b=-u-$);for(var i=0,G=o.length;i<G;++i)if(t=(s=o[i]).length)for(var s,t,e=s[t-1],j=bu(e),v=e[1]/2+_,w=ai(v),y=x(v),k=0;k<t;++k,j=A,w=H,y=I,e=l){var l=s[k],A=bu(l),B=l[1]/2+_,H=ai(B),I=x(B),a=A-j,m=a>=0?1:-1,n=m*a,f=n>d,C=w*H;if(bt.add(ad(C*m*ai(n),y*I+C*x(n))),h+=f?a+m*aa:a,f^j>=c^A>=c){var g=aH(aF(e),aF(l));aK(g);var D=aH(F,g);aK(D);var E=(f^a>=0?-1:1)*z(D[2]);(b>E||b===E&&(g[0]||g[1]))&&(r+=f^a>=0?1:-1)}}return(h< -$||h<$&&bt< -$)^1&r}function C(a,b,c,d){return function(e){var h,i,j,k=b(e),f=bo(),l=b(f),m=!1,g={point:n,lineStart:p,lineEnd:q,polygonStart:function(){g.point=r,g.lineStart=s,g.lineEnd=t,i=[],h=[]},polygonEnd:function(){g.point=n,g.lineStart=p,g.lineEnd=q,i=X.merge(i);var a=bv(h,d);i.length?(m||(e.polygonStart(),m=!0),br(i,bx,a,c,e)):a&&(m||(e.polygonStart(),m=!0),e.lineStart(),c(null,null,1,e),e.lineEnd()),m&&(e.polygonEnd(),m=!1),i=h=null},sphere:function(){e.polygonStart(),e.lineStart(),c(null,null,1,e),e.lineEnd(),e.polygonEnd()}};function n(b,c){a(b,c)&&e.point(b,c)}function o(a,b){k.point(a,b)}function p(){g.point=o,k.lineStart()}function q(){g.point=n,k.lineEnd()}function r(a,b){j.push([a,b]),l.point(a,b)}function s(){l.lineStart(),j=[]}function t(){r(j[0][0],j[0][1]),l.lineEnd();var b,c,d,g,k=l.clean(),a=f.result(),n=a.length;if(j.pop(),h.push(j),j=null,n){if(1&k){if((c=(d=a[0]).length-1)>0){for(m||(e.polygonStart(),m=!0),e.lineStart(),b=0;b<c;++b)e.point((g=d[b])[0],g[1]);e.lineEnd()}return}n>1&&2&k&&a.push(a.pop().concat(a.shift())),i.push(a.filter(bw))}}return g}}function bw(a){return a.length>1}function bx(a,b){return((a=a.x)[0]<0?a[1]-u-$:u-a[1])-((b=b.x)[0]<0?b[1]-u-$:u-b[1])}var D=C(function(){return!0},function(a){var b,c=NaN,e=NaN,f=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(g,i){var h=g>0?d:-d,j=ac(g-c);ac(j-d)<$?(a.point(c,e=(e+i)/2>0?u:-u),a.point(f,e),a.lineEnd(),a.lineStart(),a.point(h,e),a.point(g,e),b=0):f!==h&&j>=d&&(ac(c-f)<$&&(c-=f*$),ac(g-h)<$&&(g-=h*$),e=by(c,e,g,i),a.point(f,e),a.lineEnd(),a.lineStart(),a.point(h,e),b=0),a.point(c=g,e=i),f=h},lineEnd:function(){a.lineEnd(),c=e=NaN},clean:function(){return 2-b}}},function(e,c,g,a){var b;if(null==e)b=g*u,a.point(-d,b),a.point(0,b),a.point(d,b),a.point(d,0),a.point(d,-b),a.point(0,-b),a.point(-d,-b),a.point(-d,0),a.point(-d,b);else if(ac(e[0]-c[0])>$){var f=e[0]<c[0]?d:-d;b=g*f/2,a.point(-f,b),a.point(0,b),a.point(f,b)}else a.point(c[0],c[1])},[-d,-u]);function by(c,a,d,b){var e,f,g=ai(c-d);return ac(g)>$?w((ai(a)*(f=x(b))*ai(d)-ai(b)*(e=x(a))*ai(c))/(e*f*g)):(a+b)/2}function E(a){var b=x(a),f=6*v,c=b>0,g=ac(b)>$;function e(a,c){return x(a)*x(c)>b}function h(k,n,t){var A=aF(k),B=aF(n),u=[1,0,0],h=aH(A,B),v=aG(h,h),o=h[0],p=v-o*o;if(!p)return!t&&k;var C=b*v/p,D=-b*o/p,E=aH(u,h),c=aJ(u,C),F=aJ(h,D);aI(c,F);var i=E,l=aG(c,i),q=aG(i,i),w=l*l-q*(aG(c,c)-1);if(!(w<0)){var x=y(w),a=aJ(i,(-l-x)/q);if(aI(a,c),a=aE(a),!t)return a;var m,e=k[0],j=n[0],f=k[1],g=n[1];j<e&&(m=e,e=j,j=m);var r=j-e,s=ac(r-d)<$,G=s||r<$;if(!s&&g<f&&(m=f,f=g,g=m),G?s?f+g>0^a[1]<(ac(a[0]-e)<$?f:g):f<=a[1]&&a[1]<=g:r>d^(e<=a[0]&&a[0]<=j)){var z=aJ(i,(-l+x)/q);return aI(z,c),[a,aE(z)]}}}function i(f,g){var e=c?a:d-a,b=0;return f< -e?b|=1:f>e&&(b|=2),g< -e?b|=4:g>e&&(b|=8),b}return C(e,function(a){var b,f,j,k,l;return{lineStart:function(){k=j=!1,l=1},point:function(q,r){var o,m,n=[q,r],p=e(q,r),s=c?p?0:i(q,r):p?i(q+(q<0?d:-d),r):0;!b&&(k=j=p)&&a.lineStart(),p!==j&&(!(m=h(b,n))||bp(b,m)||bp(n,m))&&(n[2]=1),p!==j?(l=0,p?(a.lineStart(),m=h(n,b),a.point(m[0],m[1])):(m=h(b,n),a.point(m[0],m[1],2),a.lineEnd()),b=m):g&&b&&c^p&& !(s&f)&&(o=h(n,b,!0))&&(l=0,c?(a.lineStart(),a.point(o[0][0],o[0][1]),a.point(o[1][0],o[1][1]),a.lineEnd()):(a.point(o[1][0],o[1][1]),a.lineEnd(),a.lineStart(),a.point(o[0][0],o[0][1],3))),!p||b&&bp(b,n)||a.point(n[0],n[1]),b=n,j=p,f=s},lineEnd:function(){j&&a.lineEnd(),b=null},clean:function(){return l|(k&&j)<<1}}},function(b,c,d,e){bm(e,a,f,d,b,c)},c?[0,-a]:[-d,a-d])}var F=1e9,bz=-F;function G(a,b,c,d){function e(e,f){return a<=e&&e<=c&&b<=f&&f<=d}function f(j,f,h,k){var e=0,l=0;if(null==j||(e=g(j,h))!==(l=g(f,h))||0>i(j,f)^h>0)do k.point(0===e||3===e?a:c,e>1?d:b);while((e=(e+h+4)%4)!==l)else k.point(f[0],f[1])}function g(e,d){return ac(e[0]-a)<$?d>0?0:3:ac(e[0]-c)<$?d>0?2:1:ac(e[1]-b)<$?d>0?1:0:d>0?3:2}function h(a,b){return i(a.x,b.x)}function i(a,b){var c=g(a,1),d=g(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(g){var j,k,l,m,n,o,p,q,r,s,t,u=g,v=bo(),i={point:w,lineStart:function(){i.point=x,k&&k.push(l=[]),s=!0,r=!1,p=q=NaN},lineEnd:function(){j&&(x(m,n),o&&r&&v.rejoin(),j.push(v.result())),i.point=w,r&&u.lineEnd()},polygonStart:function(){u=v,j=[],k=[],t=!0},polygonEnd:function(){var b=function(){for(var h=0,i=0,m=k.length;i<m;++i)for(var e,b,j=k[i],l=1,n=j.length,f=j[0],g=f[0],c=f[1];l<n;++l)e=g,b=c,g=(f=j[l])[0],c=f[1],b<=d?c>d&&(g-e)*(d-b)>(c-b)*(a-e)&& ++h:c<=d&&(g-e)*(d-b)<(c-b)*(a-e)&& --h;return h}(),c=t&&b,e=(j=X.merge(j)).length;(c||e)&&(g.polygonStart(),c&&(g.lineStart(),f(null,null,1,g),g.lineEnd()),e&&br(j,h,b,f,g),g.polygonEnd()),u=g,j=k=l=null}};function w(a,b){e(a,b)&&u.point(a,b)}function x(f,g){var h=e(f,g);if(k&&l.push([f,g]),s)m=f,n=g,o=h,s=!1,h&&(u.lineStart(),u.point(f,g));else if(h&&r)u.point(f,g);else{var i=[p=Math.max(bz,Math.min(F,p)),q=Math.max(bz,Math.min(F,q))],j=[f=Math.max(bz,Math.min(F,f)),g=Math.max(bz,Math.min(F,g))];!function(h,i,j,k,l,m){var a,f=h[0],g=h[1],n=i[0],o=i[1],b=0,c=1,d=n-f,e=o-g;if(a=j-f,d||!(a>0)){if(a/=d,d<0){if(a<b)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>b&&(b=a)}if(a=l-f,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>b&&(b=a)}else if(d>0){if(a<b)return;a<c&&(c=a)}if(a=k-g,e||!(a>0)){if(a/=e,e<0){if(a<b)return;a<c&&(c=a)}else if(e>0){if(a>c)return;a>b&&(b=a)}if(a=m-g,e||!(a<0)){if(a/=e,e<0){if(a>c)return;a>b&&(b=a)}else if(e>0){if(a<b)return;a<c&&(c=a)}return b>0&&(h[0]=f+b*d,h[1]=g+b*e),c<1&&(i[0]=f+c*d,i[1]=g+c*e),!0}}}}}(i,j,a,b,c,d)?h&&(u.lineStart(),u.point(f,g),t=!1):(r||(u.lineStart(),u.point(i[0],i[1])),u.point(j[0],j[1]),h||u.lineEnd(),t=!1)}p=f,q=g,r=h}return i}}var bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT=c(),bU={sphere:b,point:b,lineStart:function(){bU.point=bW,bU.lineEnd=bV},lineEnd:b,polygonStart:b,polygonEnd:b};function bV(){bU.point=bU.lineEnd=b}function bW(b,a){b*=v,a*=v,bQ=b,bR=ai(a),bS=x(a),bU.point=bX}function bX(b,d){b*=v;var c=ai(d*=v),a=x(d),e=ac(b-bQ),f=x(e),g=a*ai(e),h=bS*c-bR*a*f,i=bR*c+bS*a*f;bT.add(ad(y(g*g+h*h),i)),bQ=b,bR=c,bS=a}function H(a){return bT.reset(),A(a,bU),+bT}var I=[null,null],bY={type:"LineString",coordinates:I};function J(a,b){return I[0]=a,I[1]=b,H(bY)}var bZ={Feature:function(a,b){return b_(a.geometry,b)},FeatureCollection:function(c,d){for(var a=c.features,b=-1,e=a.length;++b<e;)if(b_(a[b].geometry,d))return!0;return!1}},b$={Sphere:function(){return!0},Point:function(a,b){return b0(a.coordinates,b)},MultiPoint:function(c,d){for(var a=c.coordinates,b=-1,e=a.length;++b<e;)if(b0(a[b],d))return!0;return!1},LineString:function(a,b){return b1(a.coordinates,b)},MultiLineString:function(c,d){for(var a=c.coordinates,b=-1,e=a.length;++b<e;)if(b1(a[b],d))return!0;return!1},Polygon:function(a,b){return b2(a.coordinates,b)},MultiPolygon:function(c,d){for(var a=c.coordinates,b=-1,e=a.length;++b<e;)if(b2(a[b],d))return!0;return!1},GeometryCollection:function(c,d){for(var a=c.geometries,b=-1,e=a.length;++b<e;)if(b_(a[b],d))return!0;return!1}};function b_(a,b){return!!(a&&b$.hasOwnProperty(a.type))&&b$[a.type](a,b)}function b0(a,b){return 0===J(a,b)}function b1(d,f){for(var e,c,a,b=0,g=d.length;b<g;b++){if(0===(c=J(d[b],f)))return!0;if(b>0&&(a=J(d[b],d[b-1]))>0&&e<=a&&c<=a&&(e+c-a)*(1-Math.pow((e-c)/a,2))<1e-12*a)return!0;e=c}return!1}function b2(a,b){return!!bv(a.map(b3),b4(b))}function b3(a){return(a=a.map(b4)).pop(),a}function b4(a){return[a[0]*v,a[1]*v]}function b5(b,a,c){var d=X.range(b,a-$,c).concat(a);return function(a){return d.map(function(b){return[a,b]})}}function b6(b,a,c){var d=X.range(b,a-$,c).concat(a);return function(a){return d.map(function(b){return[b,a]})}}function K(){var c,d,e,f,g,h,i,j,k,l,m,n,b=10,o=b,p=90,q=360,r=2.5;function a(){return{type:"MultiLineString",coordinates:s()}}function s(){return X.range(ae(f/p)*p,e,p).map(m).concat(X.range(ae(j/q)*q,i,q).map(n)).concat(X.range(ae(d/b)*b,c,b).filter(function(a){return ac(a%p)>$}).map(k)).concat(X.range(ae(h/o)*o,g,o).filter(function(a){return ac(a%q)>$}).map(l))}return a.lines=function(){return s().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.extentMajor(b).extentMinor(b):a.extentMinor()},a.extentMajor=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(r)):[[f,j],[e,i]]},a.extentMinor=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(r)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.stepMajor(b).stepMinor(b):a.stepMinor()},a.stepMajor=function(b){return arguments.length?(p=+b[0],q=+b[1],a):[p,q]},a.stepMinor=function(c){return arguments.length?(b=+c[0],o=+c[1],a):[b,o]},a.precision=function(b){return arguments.length?(r=+b,k=b5(h,g,90),l=b6(d,c,r),m=b5(j,i,90),n=b6(f,e,r),a):r},a.extentMajor([[-180,-90+$],[180,90-$]]).extentMinor([[-180,-80-$],[180,80+$]])}function b7(a){return a}var b8,b9,ca,cb,cc=c(),cd=c(),ce={point:b,lineStart:b,lineEnd:b,polygonStart:function(){ce.lineStart=cf,ce.lineEnd=ci},polygonEnd:function(){ce.lineStart=ce.lineEnd=ce.point=b,cc.add(ac(cd)),cd.reset()},result:function(){return cc.reset(),cc/2}};function cf(){ce.point=cg}function cg(a,b){ce.point=ch,b8=ca=a,b9=cb=b}function ch(a,b){cd.add(cb*a-ca*b),ca=a,cb=b}function ci(){ch(b8,b9)}var cj,ck,cl,cm,i=1/0,cn=i,L=-i,co=L,cp={point:function(a,b){a<i&&(i=a),a>L&&(L=a),b<cn&&(cn=b),b>co&&(co=b)},lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b,result:function(){var a=[[i,cn],[L,co]];return L=co=-(cn=i=1/0),a}},cq=0,cr=0,cs=0,ct=0,cu=0,cv=0,cw=0,cx=0,cy=0,cz={point:cA,lineStart:cB,lineEnd:cE,polygonStart:function(){cz.lineStart=cF,cz.lineEnd=cG},polygonEnd:function(){cz.point=cA,cz.lineStart=cB,cz.lineEnd=cE},result:function(){var a=cy?[cw/cy,cx/cy]:cv?[ct/cv,cu/cv]:cs?[cq/cs,cr/cs]:[NaN,NaN];return cq=cr=cs=ct=cu=cv=cw=cx=cy=0,a}};function cA(a,b){cq+=a,cr+=b,++cs}function cB(){cz.point=cC}function cC(a,b){cz.point=cD,cA(cl=a,cm=b)}function cD(a,b){var d=a-cl,e=b-cm,c=y(d*d+e*e);ct+=c*(cl+a)/2,cu+=c*(cm+b)/2,cv+=c,cA(cl=a,cm=b)}function cE(){cz.point=cA}function cF(){cz.point=cH}function cG(){cI(cj,ck)}function cH(a,b){cz.point=cI,cA(cj=cl=a,ck=cm=b)}function cI(b,c){var d=b-cl,e=c-cm,a=y(d*d+e*e);ct+=a*(cl+b)/2,cu+=a*(cm+c)/2,cv+=a,a=cm*b-cl*c,cw+=a*(cl+b),cx+=a*(cm+c),cy+=3*a,cA(cl=b,cm=c)}function M(a){this._context=a}M.prototype={_radius:4.5,pointRadius:function(a){return this._radius=a,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(a,b){switch(this._point){case 0:this._context.moveTo(a,b),this._point=1;break;case 1:this._context.lineTo(a,b);break;default:this._context.moveTo(a+this._radius,b),this._context.arc(a,b,this._radius,0,aa);break}},result:b};var cJ,cK,cL,cM,cN,cO=c(),cP={point:b,lineStart:function(){cP.point=cQ},lineEnd:function(){cJ&&cR(cK,cL),cP.point=b},polygonStart:function(){cJ=!0},polygonEnd:function(){cJ=null},result:function(){return cO.reset(),+cO}};function cQ(a,b){cP.point=cR,cK=cM=a,cL=cN=b}function cR(a,b){cM-=a,cN-=b,cO.add(y(cM*cM+cN*cN)),cM=a,cN=b}function N(){this._string=[]}function O(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+ -2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function P(a){return function(d){var b=new j;for(var c in a)b[c]=a[c];return b.stream=d,b}}function j(){}function cS(a,c,d){var b=a.clipExtent&&a.clipExtent();return a.scale(150).translate([0,0]),null!=b&&a.clipExtent(null),A(d,a.stream(cp)),c(cp.result()),null!=b&&a.clipExtent(b),a}function cT(a,c,b){return cS(a,function(b){var e=c[1][0]-c[0][0],f=c[1][1]-c[0][1],d=Math.min(e/(b[1][0]-b[0][0]),f/(b[1][1]-b[0][1])),g=+c[0][0]+(e-d*(b[1][0]+b[0][0]))/2,h=+c[0][1]+(f-d*(b[1][1]+b[0][1]))/2;a.scale(150*d).translate([g,h])},b)}function cU(a,b,c){return cT(a,[[0,0],b],c)}function cV(a,c,b){return cS(a,function(b){var e=+c,d=e/(b[1][0]-b[0][0]),f=(e-d*(b[1][0]+b[0][0]))/2,g=-d*b[0][1];a.scale(150*d).translate([f,g])},b)}function cW(a,c,b){return cS(a,function(b){var e=+c,d=e/(b[1][1]-b[0][1]),f=-d*b[0][0],g=(e-d*(b[1][1]+b[0][1]))/2;a.scale(150*d).translate([f,g])},b)}N.prototype={_radius:4.5,_circle:O(4.5),pointRadius:function(a){return(a=+a)!==this._radius&&(this._radius=a,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(a,b){switch(this._point){case 0:this._string.push("M",a,",",b),this._point=1;break;case 1:this._string.push("L",a,",",b);break;default:null==this._circle&&(this._circle=O(this._radius)),this._string.push("M",a,",",b,this._circle);break}},result:function(){if(!this._string.length)return null;var a=this._string.join("");return this._string=[],a}},j.prototype={constructor:j,point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var cX=x(30*v);function cY(a,b){return+b?c$(a,b):cZ(a)}function cZ(a){return P({point:function(b,c){b=a(b,c),this.stream.point(b[0],b[1])}})}function c$(a,b){function c(k,l,m,n,o,p,B,C,q,r,s,t,u,v){var g=B-k,h=C-l,w=g*g+h*h;if(w>4*b&&u--){var e=n+r,f=o+s,d=p+t,x=y(e*e+f*f+d*d),H=z(d/=x),A=ac(ac(d)-1)<$||ac(m-q)<$?(m+q)/2:ad(f,e),D=a(A,H),i=D[0],j=D[1],E=i-k,F=j-l,G=h*E-g*F;(G*G/w>b||ac((g*E+h*F)/w-.5)>.3||n*r+o*s+p*t<cX)&&(c(k,l,m,n,o,p,i,j,A,e/=x,f/=x,d,u,v),v.point(i,j),c(i,j,A,e,f,d,B,C,q,r,s,t,u,v))}}return function(d){var e,f,g,h,i,j,k,l,m,n,o,p,b={point:q,lineStart:r,lineEnd:t,polygonStart:function(){d.polygonStart(),b.lineStart=u},polygonEnd:function(){d.polygonEnd(),b.lineStart=r}};function q(b,c){b=a(b,c),d.point(b[0],b[1])}function r(){l=NaN,b.point=s,d.lineStart()}function s(b,f){var e=aF([b,f]),g=a(b,f);c(l,m,k,n,o,p,l=g[0],m=g[1],k=b,n=e[0],o=e[1],p=e[2],16,d),d.point(l,m)}function t(){b.point=q,d.lineEnd()}function u(){r(),b.point=v,b.lineEnd=w}function v(a,c){s(e=a,c),f=l,g=m,h=n,i=o,j=p,b.point=s}function w(){c(l,m,k,n,o,p,f,g,e,h,i,j,16,d),b.lineEnd=t,t()}return b}}var c_=P({point:function(a,b){this.stream.point(a*v,b*v)}});function c0(b,c,d,e,f){function a(a,g){return[c+b*(a*=e),d-b*(g*=f)]}return a.invert=function(a,g){return[(a-c)/b*e,(d-g)/b*f]},a}function c1(a,d,e,h,i,f){var b=x(f),c=ai(f),j=b*a,k=c*a,l=b/a,m=c/a,n=(c*e-b*d)/a,o=(c*d+b*e)/a;function g(a,b){return[j*(a*=h)-k*(b*=i)+d,e-k*a-j*b]}return g.invert=function(a,b){return[h*(l*a-m*b+n),i*(o-m*a-l*b)]},g}function Q(a){return R(function(){return a})()}function R(b){var c,d,e,f,g,h,i,j,k,l,m=150,n=480,o=250,p=0,q=0,r=0,s=0,t=0,u=0,w=1,x=1,z=null,A=D,B=null,C=b7,F=.5;function a(a){return j(a[0]*v,a[1]*v)}function H(a){return(a=j.invert(a[0],a[1]))&&[a[0]*ab,a[1]*ab]}function I(){var a=c1(m,0,0,w,x,u).apply(null,c(p,q)),b=(u?c1:c0)(m,n-a[0],o-a[1],w,x,u);return d=bi(r,s,t),i=bh(c,b),j=bh(d,i),h=cY(i,F),J()}function J(){return k=l=null,a}return a.stream=function(a){var b;return k&&l===a?k:k=c_((b=d,P({point:function(c,d){var a=b(c,d);return this.stream.point(a[0],a[1])}}))(A(h(C(l=a)))))},a.preclip=function(a){return arguments.length?(A=a,z=void 0,J()):A},a.postclip=function(a){return arguments.length?(C=a,B=e=f=g=null,J()):C},a.clipAngle=function(a){return arguments.length?(A=+a?E(z=a*v):(z=null,D),J()):z*ab},a.clipExtent=function(a){return arguments.length?(C=null==a?(B=e=f=g=null,b7):G(B=+a[0][0],e=+a[0][1],f=+a[1][0],g=+a[1][1]),J()):null==B?null:[[B,e],[f,g]]},a.scale=function(a){return arguments.length?(m=+a,I()):m},a.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],I()):[n,o]},a.center=function(a){return arguments.length?(p=a[0]%360*v,q=a[1]%360*v,I()):[p*ab,q*ab]},a.rotate=function(a){return arguments.length?(r=a[0]%360*v,s=a[1]%360*v,t=a.length>2?a[2]%360*v:0,I()):[r*ab,s*ab,t*ab]},a.angle=function(a){return arguments.length?(u=a%360*v,I()):u*ab},a.reflectX=function(a){return arguments.length?(w=a?-1:1,I()):w<0},a.reflectY=function(a){return arguments.length?(x=a?-1:1,I()):x<0},a.precision=function(a){return arguments.length?(h=cY(i,F=a*a),J()):y(F)},a.fitExtent=function(b,c){return cT(a,b,c)},a.fitSize=function(b,c){return cU(a,b,c)},a.fitWidth=function(b,c){return cV(a,b,c)},a.fitHeight=function(b,c){return cW(a,b,c)},function(){return c=b.apply(this,arguments),a.invert=c.invert&&H,I()}}function c2(b){var c=0,e=d/3,f=R(b),a=f(c,e);return a.parallels=function(a){return arguments.length?f(c=a[0]*v,e=a[1]*v):[c*ab,e*ab]},a}function S(c,f){var a=ai(c),b=(a+ai(f))/2;if(ac(b)<$)return function(b){var c=x(b);function a(a,b){return[a*c,ai(b)/c]}return a.invert=function(a,b){return[a/c,z(b*c)]},a}(c);var g=1+a*(2*b-a),h=y(g)/b;function e(a,d){var c=y(g-2*b*ai(d))/b;return[c*ai(a*=b),h-c*x(a)]}return e.invert=function(c,f){var a=h-f,e=ad(c,ac(a))*aj(a);return a*b<0&&(e-=d*aj(c)*aj(a)),[e/b,z((g-(c*c+a*a)*b*b)/(2*b))]},e}function T(){return c2(S).scale(155.424).center([0,33.6442])}function U(){return T().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-0.6,38.7])}function k(a){return function(b,c){var f=x(b),d=x(c),e=a(f*d);return[e*d*ai(b),e*ai(c)]}}function e(a){return function(c,d){var b=y(c*c+d*d),e=a(b),f=ai(e);return[ad(c*f,b*x(e)),z(b&&d*f/b)]}}var l=k(function(a){return y(2/(1+a))});l.invert=e(function(a){return 2*z(a/2)});var m=k(function(a){return(a=al(a))&&a/ai(a)});function n(a,b){return[a,ag(ak((u+b)/2))]}function c3(b){var e,f,g,a=Q(b),h=a.center,i=a.scale,j=a.translate,k=a.clipExtent,l=null;function c(){var c=d*i(),h=a(B(a.rotate()).invert([0,0]));return k(null==l?[[h[0]-c,h[1]-c],[h[0]+c,h[1]+c]]:b===n?[[Math.max(h[0]-c,l),e],[Math.min(h[0]+c,f),g]]:[[l,Math.max(h[1]-c,e)],[f,Math.min(h[1]+c,g)]])}return a.scale=function(a){return arguments.length?(i(a),c()):i()},a.translate=function(a){return arguments.length?(j(a),c()):j()},a.center=function(a){return arguments.length?(h(a),c()):h()},a.clipExtent=function(a){return arguments.length?(null==a?l=e=f=g=null:(l=+a[0][0],e=+a[0][1],f=+a[1][0],g=+a[1][1]),c()):null==l?null:[[l,e],[f,g]]},c()}function c4(a){return ak((u+a)/2)}function V(a,b){var e=x(a),c=a===b?ai(a):ag(e/x(b))/ag(c4(b)/c4(a)),g=e*ah(c4(a),c)/c;if(!c)return n;function f(b,a){g>0?a< -u+$&&(a=-u+$):a>u-$&&(a=u-$);var d=g/ah(c4(a),c);return[d*ai(c*b),g-d*x(c*b)]}return f.invert=function(b,f){var a=g-f,h=aj(c)*y(b*b+a*a),e=ad(b,ac(a))*aj(a);return a*c<0&&(e-=d*aj(b)*aj(a)),[e/c,2*w(ah(g/h,1/c))-u]},f}function g(a,b){return[a,b]}function W(a,b){var c=x(a),e=a===b?ai(a):(c-x(b))/(b-a),h=c/e+a;if(ac(e)<$)return g;function f(c,d){var a=h-d,b=e*c;return[a*ai(b),h-a*x(b)]}return f.invert=function(b,f){var a=h-f,c=ad(b,ac(a))*aj(a);return a*e<0&&(c-=d*aj(b)*aj(a)),[c/e,h-aj(e)*y(b*b+a*a)]},f}m.invert=e(function(a){return a}),n.invert=function(a,b){return[a,2*w(af(b))-u]},g.invert=g;var c5=y(3)/2;function o(d,e){var b=z(c5*ai(e)),a=b*b,c=a*a*a;return[d*x(b)/(c5*(1.340264+ -0.24331799999999998*a+c*(.0062510000000000005+.034164*a))),b*(1.340264+ -0.081106*a+c*(893e-6+.003796*a))]}function p(a,b){var c=x(b),d=x(a)*c;return[c*ai(a)/d,ai(b)/d]}function q(d,c){var a=c*c,b=a*a;return[d*(.8707-.131979*a+b*(-0.013791+b*(.003971*a-.001529*b))),c*(1.007226+a*(.015085+b*(-0.044475+.028874*a-.005916*b)))]}function r(b,a){return[x(a)*ai(b),ai(a)]}function s(a,b){var c=x(b),d=1+x(a)*c;return[c*ai(a)/d,ai(b)/d]}function t(a,b){return[ag(ak((u+b)/2)),-a]}o.invert=function(i,d){for(var e,f,g,b=d,a=b*b,c=a*a*a,h=0;h<12&&(f=b*(1.340264+ -0.081106*a+c*(893e-6+.003796*a))-d,g=1.340264+ -0.24331799999999998*a+c*(.0062510000000000005+.034164*a),b-=e=f/g,c=(a=b*b)*a*a,!(1e-12>ac(e)));++h);return[c5*i*(1.340264+ -0.24331799999999998*a+c*(.0062510000000000005+.034164*a))/x(b),z(ai(b)/c5)]},p.invert=e(w),q.invert=function(f,d){var e,b=d,g=25;do{var a=b*b,c=a*a;b-=e=(b*(1.007226+a*(.015085+c*(-0.044475+.028874*a-.005916*c)))-d)/(1.007226+a*(.045255+c*(-0.311325+.259866*a-.005916*11*c)))}while(ac(e)>$&& --g>0)return[f/(.8707+(a=b*b)*(-0.131979+a*(-0.013791+a*a*a*(.003971-.001529*a)))),b]},r.invert=e(z),s.invert=e(function(a){return 2*w(a)}),t.invert=function(a,b){return[-b,2*w(af(a))-u]},a.geoAlbers=U,a.geoAlbersUsa=function(){var b,c,d,e,f,g,h=U(),i=T().rotate([154,0]).center([-2,58.5]).parallels([55,65]),j=T().rotate([157,0]).center([-3,19.9]).parallels([8,18]),k={point:function(a,b){g=[a,b]}};function a(c){var a=c[0],b=c[1];return g=null,d.point(a,b),g||(e.point(a,b),g)||(f.point(a,b),g)}function l(){return b=c=null,a}return a.invert=function(c){var d=h.scale(),e=h.translate(),a=(c[0]-e[0])/d,b=(c[1]-e[1])/d;return(b>=.12&&b<.234&&a>= -0.425&&a< -0.214?i:b>=.166&&b<.234&&a>= -0.214&&a< -0.115?j:h).invert(c)},a.stream=function(a){var d,e;return b&&c===a?b:b=(e=(d=[h.stream(c=a),i.stream(a),j.stream(a)]).length,{point:function(b,c){for(var a=-1;++a<e;)d[a].point(b,c)},sphere:function(){for(var a=-1;++a<e;)d[a].sphere()},lineStart:function(){for(var a=-1;++a<e;)d[a].lineStart()},lineEnd:function(){for(var a=-1;++a<e;)d[a].lineEnd()},polygonStart:function(){for(var a=-1;++a<e;)d[a].polygonStart()},polygonEnd:function(){for(var a=-1;++a<e;)d[a].polygonEnd()}})},a.precision=function(a){return arguments.length?(h.precision(a),i.precision(a),j.precision(a),l()):h.precision()},a.scale=function(b){return arguments.length?(h.scale(b),i.scale(.35*b),j.scale(b),a.translate(h.translate())):h.scale()},a.translate=function(g){if(!arguments.length)return h.translate();var a=h.scale(),b=+g[0],c=+g[1];return d=h.translate(g).clipExtent([[b-.455*a,c-.238*a],[b+.455*a,c+.238*a]]).stream(k),e=i.translate([b-.307*a,c+.201*a]).clipExtent([[b-.425*a+$,c+.12*a+$],[b-.214*a-$,c+.234*a-$]]).stream(k),f=j.translate([b-.205*a,c+.212*a]).clipExtent([[b-.214*a+$,c+.166*a+$],[b-.115*a-$,c+.234*a-$]]).stream(k),l()},a.fitExtent=function(b,c){return cT(a,b,c)},a.fitSize=function(b,c){return cU(a,b,c)},a.fitWidth=function(b,c){return cV(a,b,c)},a.fitHeight=function(b,c){return cW(a,b,c)},a.scale(1070)},a.geoArea=function(a){return ay.reset(),A(a,az),2*ay},a.geoAzimuthalEqualArea=function(){return Q(l).scale(124.75).clipAngle(179.999)},a.geoAzimuthalEqualAreaRaw=l,a.geoAzimuthalEquidistant=function(){return Q(m).scale(79.4188).clipAngle(179.999)},a.geoAzimuthalEquidistantRaw=m,a.geoBounds=function(h){var c,d,a,b,e,f,g;if(aO=aN=-(aL=aM=1/0),aT=[],A(h,aW),d=aT.length){for(aT.sort(a3),c=1,e=[a=aT[0]];c<d;++c)a4(a,(b=aT[c])[0])||a4(a,b[1])?(a2(a[0],b[1])>a2(a[0],a[1])&&(a[1]=b[1]),a2(b[0],a[1])>a2(a[0],a[1])&&(a[0]=b[0])):e.push(a=b);for(f=-1/0,d=e.length-1,c=0,a=e[d];c<=d;a=b,++c)b=e[c],(g=a2(a[1],b[0]))>f&&(f=g,aL=b[0],aN=a[1])}return aT=aU=null,aL===1/0||aM===1/0?[[NaN,NaN],[NaN,NaN]]:[[aL,aM],[aN,aO]]},a.geoCentroid=function(e){bA=bB=bC=bD=bE=bF=bG=bH=bI=bJ=bK=0,A(e,a5);var a=bI,b=bJ,c=bK,d=a*a+b*b+c*c;return d<1e-12&&(a=bF,b=bG,c=bH,bB<$&&(a=bC,b=bD,c=bE),(d=a*a+b*b+c*c)<1e-12)?[NaN,NaN]:[ad(b,a)*ab,z(c/y(d))*ab]},a.geoCircle=function(){var b,c,d=bg([0,0]),e=bg(90),f=bg(6),g={point:function(a,d){b.push(a=c(a,d)),a[0]*=ab,a[1]*=ab}};function a(){var a=d.apply(this,arguments),h=e.apply(this,arguments)*v,i=f.apply(this,arguments)*v;return b=[],c=bi(-a[0]*v,-a[1]*v,0).invert,bm(g,h,i,1),a={type:"Polygon",coordinates:[b]},b=c=null,a}return a.center=function(b){return arguments.length?(d="function"==typeof b?b:bg([+b[0],+b[1]]),a):d},a.radius=function(b){return arguments.length?(e="function"==typeof b?b:bg(+b),a):e},a.precision=function(b){return arguments.length?(f="function"==typeof b?b:bg(+b),a):f},a},a.geoClipAntimeridian=D,a.geoClipCircle=E,a.geoClipExtent=function(){var b,c,a,d=0,e=0,f=960,g=500;return a={stream:function(a){return b&&c===a?b:b=G(d,e,f,g)(c=a)},extent:function(h){return arguments.length?(d=+h[0][0],e=+h[0][1],f=+h[1][0],g=+h[1][1],b=c=null,a):[[d,e],[f,g]]}}},a.geoClipRectangle=G,a.geoConicConformal=function(){return c2(V).scale(109.5).parallels([30,30])},a.geoConicConformalRaw=V,a.geoConicEqualArea=T,a.geoConicEqualAreaRaw=S,a.geoConicEquidistant=function(){return c2(W).scale(131.154).center([0,13.9389])},a.geoConicEquidistantRaw=W,a.geoContains=function(a,b){return(a&&bZ.hasOwnProperty(a.type)?bZ[a.type]:b_)(a,b)},a.geoDistance=J,a.geoEqualEarth=function(){return Q(o).scale(177.158)},a.geoEqualEarthRaw=o,a.geoEquirectangular=function(){return Q(g).scale(152.63)},a.geoEquirectangularRaw=g,a.geoGnomonic=function(){return Q(p).scale(144.049).clipAngle(60)},a.geoGnomonicRaw=p,a.geoGraticule=K,a.geoGraticule10=function(){return K()()},a.geoIdentity=function(){var b,c,d,e,f,g,h,i=1,j=0,k=0,l=1,m=1,n=0,o=null,p=1,q=1,r=P({point:function(c,d){var b=a([c,d]);this.stream.point(b[0],b[1])}}),s=b7;function t(){return p=i*l,q=i*m,g=h=null,a}function a(e){var a=e[0]*p,d=e[1]*q;if(n){var f=d*b-a*c;a=a*b+d*c,d=f}return[a+j,d+k]}return a.invert=function(e){var a=e[0]-j,d=e[1]-k;if(n){var f=d*b+a*c;a=a*b-d*c,d=f}return[a/p,d/q]},a.stream=function(a){return g&&h===a?g:g=r(s(h=a))},a.postclip=function(a){return arguments.length?(s=a,o=d=e=f=null,t()):s},a.clipExtent=function(a){return arguments.length?(s=null==a?(o=d=e=f=null,b7):G(o=+a[0][0],d=+a[0][1],e=+a[1][0],f=+a[1][1]),t()):null==o?null:[[o,d],[e,f]]},a.scale=function(a){return arguments.length?(i=+a,t()):i},a.translate=function(a){return arguments.length?(j=+a[0],k=+a[1],t()):[j,k]},a.angle=function(a){return arguments.length?(c=ai(n=a%360*v),b=x(n),t()):n*ab},a.reflectX=function(a){return arguments.length?(l=a?-1:1,t()):l<0},a.reflectY=function(a){return arguments.length?(m=a?-1:1,t()):m<0},a.fitExtent=function(b,c){return cT(a,b,c)},a.fitSize=function(b,c){return cU(a,b,c)},a.fitWidth=function(b,c){return cV(a,b,c)},a.fitHeight=function(b,c){return cW(a,b,c)},a},a.geoInterpolate=function(h,i){var a=h[0]*v,b=h[1]*v,c=i[0]*v,d=i[1]*v,e=x(b),k=ai(b),f=x(d),l=ai(d),m=e*x(a),n=e*ai(a),o=f*x(c),p=f*ai(c),g=2*z(y(am(d-b)+e*f*am(c-a))),q=ai(g),j=g?function(e){var a=ai(e*=g)/q,b=ai(g-e)/q,c=b*m+a*o,d=b*n+a*p,f=b*k+a*l;return[ad(d,c)*ab,ad(f,y(c*c+d*d))*ab]}:function(){return[a*ab,b*ab]};return j.distance=g,j},a.geoLength=H,a.geoMercator=function(){return c3(n).scale(961/aa)},a.geoMercatorRaw=n,a.geoNaturalEarth1=function(){return Q(q).scale(175.295)},a.geoNaturalEarth1Raw=q,a.geoOrthographic=function(){return Q(r).scale(249.5).clipAngle(90+$)},a.geoOrthographicRaw=r,a.geoPath=function(b,c){var d,e,f=4.5;function a(a){return a&&("function"==typeof f&&e.pointRadius(+f.apply(this,arguments)),A(a,d(e))),e.result()}return a.area=function(a){return A(a,d(ce)),ce.result()},a.measure=function(a){return A(a,d(cP)),cP.result()},a.bounds=function(a){return A(a,d(cp)),cp.result()},a.centroid=function(a){return A(a,d(cz)),cz.result()},a.projection=function(c){return arguments.length?(d=null==c?(b=null,b7):(b=c).stream,a):b},a.context=function(b){return arguments.length?(e=null==b?(c=null,new N):new M(c=b),"function"!=typeof f&&e.pointRadius(f),a):c},a.pointRadius=function(b){return arguments.length?(f="function"==typeof b?b:(e.pointRadius(+b),+b),a):f},a.projection(b).context(c)},a.geoProjection=Q,a.geoProjectionMutator=R,a.geoRotation=B,a.geoStereographic=function(){return Q(s).scale(250).clipAngle(142)},a.geoStereographicRaw=s,a.geoStream=A,a.geoTransform=function(a){return{stream:P(a)}},a.geoTransverseMercator=function(){var a=c3(t),c=a.center,b=a.rotate;return a.center=function(a){return arguments.length?c([-a[1],a[0]]):[(a=c())[1],-a[0]]},a.rotate=function(a){return arguments.length?b([a[0],a[1],a.length>2?a[2]+90:90]):[(a=b())[0],a[1],a[2]-90]},b([0,0,90]).scale(159.155)},a.geoTransverseMercatorRaw=t,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(a){"use strict";function k(a,b){return a.parent===b.parent?1:2}function l(a,b){return a+b.x}function m(a,b){return Math.max(a,b.y)}function n(d){var a=0,b=d.children,c=b&&b.length;if(c)for(;--c>=0;)a+=b[c].value;else a=1;d.value=a}function o(a,b){if(a===b)return a;var c=a.ancestors(),d=b.ancestors(),e=null;for(a=c.pop(),b=d.pop();a===b;)e=a,a=c.pop(),b=d.pop();return e}function c(d,e){var a,f,g,c,h,i=new b(d),k=+d.value&&(i.value=d.value),j=[i];for(null==e&&(e=p);a=j.pop();)if(k&&(a.value=+a.data.value),(g=e(a.data))&&(h=g.length))for(a.children=new Array(h),c=h-1;c>=0;--c)j.push(f=a.children[c]=new b(g[c])),f.parent=a,f.depth=a.depth+1;return i.eachBefore(r)}function p(a){return a.children}function q(a){a.data=a.data.data}function r(a){var b=0;do a.height=b;while((a=a.parent)&&a.height< ++b)}function b(a){this.data=a,this.depth=this.height=0,this.parent=null}b.prototype=c.prototype={constructor:b,count:function(){return this.eachAfter(n)},each:function(g){var e,d,a,f,b=this,c=[b];do for(e=c.reverse(),c=[];b=e.pop();)if(g(b),d=b.children)for(a=0,f=d.length;a<f;++a)c.push(d[a]);while(c.length)return this},eachAfter:function(g){for(var c,b,d,a=this,e=[a],f=[];a=e.pop();)if(f.push(a),c=a.children)for(b=0,d=c.length;b<d;++b)e.push(c[b]);for(;a=f.pop();)g(a);return this},eachBefore:function(e){for(var c,a,b=this,d=[b];b=d.pop();)if(e(b),c=b.children)for(a=c.length-1;a>=0;--a)d.push(c[a]);return this},sum:function(a){return this.eachAfter(function(b){for(var d=+a(b.data)||0,c=b.children,e=c&&c.length;--e>=0;)d+=c[e].value;b.value=d})},sort:function(a){return this.eachBefore(function(b){b.children&&b.children.sort(a)})},path:function(b){for(var a=this,d=o(a,b),c=[a];a!==d;)a=a.parent,c.push(a);for(var e=c.length;b!==d;)c.splice(e,0,b),b=b.parent;return c},ancestors:function(){for(var a=this,b=[a];a=a.parent;)b.push(a);return b},descendants:function(){var a=[];return this.each(function(b){a.push(b)}),a},leaves:function(){var a=[];return this.eachBefore(function(b){b.children||a.push(b)}),a},links:function(){var a=this,b=[];return a.each(function(c){c!==a&&b.push({source:c.parent,target:c})}),b},copy:function(){return c(this).eachBefore(q)}};var s=Array.prototype.slice;function e(c){for(var d,a,b=0,f=(c=function(a){for(var d,c,b=a.length;b;)c=Math.random()*b--|0,d=a[b],a[b]=a[c],a[c]=d;return a}(s.call(c))).length,e=[];b<f;)d=c[b],a&&v(a,d)?++b:(a=x(e=t(e,d)),b=0);return a}function t(a,c){var b,d;if(w(c,a))return[c];for(b=0;b<a.length;++b)if(u(c,a[b])&&w(z(a[b],c),a))return[a[b],c];for(b=0;b<a.length-1;++b)for(d=b+1;d<a.length;++d)if(u(z(a[b],a[d]),c)&&u(z(a[b],c),a[d])&&u(z(a[d],c),a[b])&&w(A(a[b],a[d],c),a))return[a[b],a[d],c];throw new Error}function u(a,b){var c=a.r-b.r,d=b.x-a.x,e=b.y-a.y;return c<0||c*c<d*d+e*e}function v(a,b){var c=a.r-b.r+1e-6,d=b.x-a.x,e=b.y-a.y;return c>0&&c*c>d*d+e*e}function w(c,b){for(var a=0;a<b.length;++a)if(!v(c,b[a]))return!1;return!0}function x(a){switch(a.length){case 1:return y(a[0]);case 2:return z(a[0],a[1]);case 3:return A(a[0],a[1],a[2])}}function y(a){return{x:a.x,y:a.y,r:a.r}}function z(a,b){var f=a.x,g=a.y,h=a.r,i=b.x,j=b.y,k=b.r,c=i-f,d=j-g,l=k-h,e=Math.sqrt(c*c+d*d);return{x:(f+i+c/e*l)/2,y:(g+j+d/e*l)/2,r:(e+h+k)/2}}function A(j,k,l){var b=j.x,c=j.y,a=j.r,m=k.x,n=k.y,o=k.r,p=l.x,q=l.y,r=l.r,s=b-m,t=b-p,u=c-n,v=c-q,y=o-a,z=r-a,A=b*b+c*c-a*a,B=A-m*m-n*n+o*o,C=A-p*p-q*q+r*r,d=t*u-s*v,e=(u*C-v*B)/(2*d)-b,f=(v*y-u*z)/d,g=(t*B-s*C)/(2*d)-c,h=(s*z-t*y)/d,w=f*f+h*h-1,i=2*(a+e*f+g*h),D=e*e+g*g-a*a,x=-(w?(i+Math.sqrt(i*i-4*w*D))/(2*w):D/i);return{x:b+e+f*x,y:c+g+h*x,r:x}}function B(j,c,b){var a,d,f,g,h=j.x-c.x,i=j.y-c.y,e=h*h+i*i;e?(d=c.r+b.r,d*=d,g=j.r+b.r,d>(g*=g)?(a=(e+g-d)/(2*e),f=Math.sqrt(Math.max(0,g/e-a*a)),b.x=j.x-a*h-f*i,b.y=j.y-a*i+f*h):(a=(e+d-g)/(2*e),f=Math.sqrt(Math.max(0,d/e-a*a)),b.x=c.x+a*h-f*i,b.y=c.y+a*i+f*h)):(b.x=c.x+b.r,b.y=c.y)}function C(a,b){var c=a.r+b.r-1e-6,d=b.x-a.x,e=b.y-a.y;return c>0&&c*c>d*d+e*e}function D(c){var a=c._,b=c.next._,d=a.r+b.r,e=(a.x*b.r+b.x*a.r)/d,f=(a.y*b.r+b.y*a.r)/d;return e*e+f*f}function E(a){this._=a,this.next=null,this.previous=null}function F(h){var a,b,c,i,j,m,d,f,g,k,l;if(!(i=h.length))return 0;if((a=h[0]).x=0,a.y=0,!(i>1))return a.r;if(b=h[1],a.x=-b.r,b.x=a.r,b.y=0,!(i>2))return a.r+b.r;B(b,a,c=h[2]),a=new E(a),b=new E(b),c=new E(c),a.next=c.previous=b,b.next=a.previous=c,c.next=b.previous=a;pack:for(d=3;d<i;++d){B(a._,b._,c=h[d]),c=new E(c),f=b.next,g=a.previous,k=b._.r,l=a._.r;do if(k<=l){if(C(f._,c._)){b=f,a.next=b,b.previous=a,--d;continue pack}k+=f._.r,f=f.next}else{if(C(g._,c._)){(a=g).next=b,b.previous=a,--d;continue pack}l+=g._.r,g=g.previous}while(f!==g.next)for(c.previous=a,c.next=b,a.next=b.previous=b=c,j=D(a);(c=c.next)!==b;)(m=D(c))<j&&(a=c,j=m);b=a.next}for(a=[b._],c=b;(c=c.next)!==b;)a.push(c._);for(d=0,c=e(a);d<i;++d)a=h[d],a.x-=c.x,a.y-=c.y;return c.r}function G(a){if("function"!=typeof a)throw new Error;return a}function H(a){return function(){return a}}function I(a){return Math.sqrt(a.value)}function J(a){return function(b){b.children||(b.r=Math.max(0,+a(b)||0))}}function K(a,b){return function(f){if(e=f.children){var e,c,g,h=e.length,d=a(f)*b||0;if(d)for(c=0;c<h;++c)e[c].r+=d;if(g=F(e),d)for(c=0;c<h;++c)e[c].r-=d;f.r=g+d}}}function L(a){return function(b){var c=b.parent;b.r*=a,c&&(b.x=c.x+a*b.x,b.y=c.y+a*b.y)}}function M(a){a.x0=Math.round(a.x0),a.y0=Math.round(a.y0),a.x1=Math.round(a.x1),a.y1=Math.round(a.y1)}function f(b,c,f,g,h){for(var a,d=b.children,e=-1,i=d.length,j=b.value&&(g-c)/b.value;++e<i;)(a=d[e]).y0=f,a.y1=h,a.x0=c,a.x1=c+=a.value*j}var N={depth:-1},O={};function P(a){return a.id}function Q(a){return a.parentId}function R(a,b){return a.parent===b.parent?1:2}function S(a){var b=a.children;return b?b[0]:a.t}function T(b){var a=b.children;return a?a[a.length-1]:b.t}function U(c,a,b){var d=b/(a.i-c.i);a.c-=d,a.s+=b,c.c+=d,a.z+=b,a.m+=b}function V(a,b,c){return a.a.parent===b.parent?a.a:c}function g(a,b){this._=a,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=b}function h(b,f,c,g,h){for(var a,d=b.children,e=-1,i=d.length,j=b.value&&(h-c)/b.value;++e<i;)(a=d[e]).x0=f,a.x1=g,a.y0=c,a.y1=c+=a.value*j}g.prototype=Object.create(b.prototype);var d=(1+Math.sqrt(5))/2;function W(y,v,l,m,p,q){for(var n,c,g,i,a,j,k,r,s,w,d,x=[],o=v.children,t=0,b=0,u=o.length,e=v.value;t<u;){g=p-l,i=q-m;do a=o[b++].value;while(!a&&b<u)for(j=k=a,d=a*a*(w=Math.max(i/g,g/i)/(e*y)),s=Math.max(k/d,d/j);b<u;++b){if(a+=c=o[b].value,c<j&&(j=c),c>k&&(k=c),d=a*a*w,r=Math.max(k/d,d/j),r>s){a-=c;break}s=r}x.push(n={value:a,dice:g<i,children:o.slice(t,b)}),n.dice?f(n,l,m,p,e?m+=i*a/e:q):h(n,l,m,e?l+=g*a/e:p,q),e-=a,t=b}return x}var i=function b(c){function a(a,b,d,e,f){W(c,a,b,d,e,f)}return a.ratio=function(a){return b((a=+a)>1?a:1)},a}(d),j=function b(c){function a(e,b,d,j,k){if((g=e._squarify)&&g.ratio===c)for(var g,a,l,i,n,o=-1,p=g.length,m=e.value;++o<p;){for(l=(a=g[o]).children,i=a.value=0,n=l.length;i<n;++i)a.value+=l[i].value;a.dice?f(a,b,d,j,d+=(k-d)*a.value/m):h(a,b,d,b+=(j-b)*a.value/m,k),m-=a.value}else e._squarify=g=W(c,e,b,d,j,k),g.ratio=c}return a.ratio=function(a){return b((a=+a)>1?a:1)},a}(d);a.cluster=function(){var b=k,c=1,d=1,e=!1;function a(a){var h,i=0;a.eachAfter(function(a){var d,c=a.children;c?(a.x=(d=c).reduce(l,0)/d.length,a.y=1+c.reduce(m,0)):(a.x=h?i+=b(a,h):0,a.y=0,h=a)});var f=function(a){for(var b;b=a.children;)a=b[0];return a}(a),g=function(a){for(var b;b=a.children;)a=b[b.length-1];return a}(a),j=f.x-b(f,g)/2,k=g.x+b(g,f)/2;return a.eachAfter(e?function(b){b.x=(b.x-a.x)*c,b.y=(a.y-b.y)*d}:function(b){b.x=(b.x-j)/(k-j)*c,b.y=(1-(a.y?b.y/a.y:1))*d})}return a.separation=function(c){return arguments.length?(b=c,a):b},a.size=function(b){return arguments.length?(e=!1,c=+b[0],d=+b[1],a):e?null:[c,d]},a.nodeSize=function(b){return arguments.length?(e=!0,c=+b[0],d=+b[1],a):e?[c,d]:null},a},a.hierarchy=c,a.pack=function(){var b=null,c=1,d=1,e=function(){return 0};function a(a){return a.x=c/2,a.y=d/2,b?a.eachBefore(J(b)).eachAfter(K(e,.5)).eachBefore(L(1)):a.eachBefore(J(I)).eachAfter(K(function(){return 0},1)).eachAfter(K(e,a.r/Math.min(c,d))).eachBefore(L(Math.min(c,d)/(2*a.r))),a}return a.radius=function(d){var c;return arguments.length?(b=null==(c=d)?null:G(c),a):b},a.size=function(b){return arguments.length?(c=+b[0],d=+b[1],a):[c,d]},a.padding=function(b){return arguments.length?(e="function"==typeof b?b:H(+b),a):e},a},a.packEnclose=e,a.packSiblings=function(a){return F(a),a},a.partition=function(){var b=1,c=1,d=0,e=!1;function a(a){var f=a.height+1;return a.x0=a.y0=d,a.x1=b,a.y1=c/f,a.eachBefore(g(c,f)),e&&a.eachBefore(M),a}function g(a,b){return function(c){c.children&&f(c,c.x0,a*(c.depth+1)/b,c.x1,a*(c.depth+2)/b);var e=c.x0,g=c.y0,h=c.x1-d,i=c.y1-d;h<e&&(e=h=(e+h)/2),i<g&&(g=i=(g+i)/2),c.x0=e,c.y0=g,c.x1=h,c.y1=i}}return a.round=function(b){return arguments.length?(e=!!b,a):e},a.size=function(d){return arguments.length?(b=+d[0],c=+d[1],a):[b,c]},a.padding=function(b){return arguments.length?(d=+b,a):d},a},a.stratify=function(){var c=P,d=Q;function a(i){var k,a,g,h,e,f,m,j=i.length,n=new Array(j),l={};for(a=0;a<j;++a)k=i[a],e=n[a]=new b(k),null!=(f=c(k,a,i))&&(f+="")&&(l[m="$"+(e.id=f)]=m in l?O:e);for(a=0;a<j;++a)if(e=n[a],null!=(f=d(i[a],a,i))&&(f+="")){if(!(h=l["$"+f]))throw new Error("missing: "+f);if(h===O)throw new Error("ambiguous: "+f);h.children?h.children.push(e):h.children=[e],e.parent=h}else{if(g)throw new Error("multiple roots");g=e}if(!g)throw new Error("no root");if(g.parent=N,g.eachBefore(function(a){a.depth=a.parent.depth+1,--j}).eachBefore(r),g.parent=null,j>0)throw new Error("cycle");return g}return a.id=function(b){return arguments.length?(c=G(b),a):c},a.parentId=function(b){return arguments.length?(d=G(b),a):d},a},a.tree=function(){var b=R,c=1,d=1,e=null;function a(a){var i=function(i){for(var b,e,d,a,f,c=new g(i,0),h=[c];b=h.pop();)if(d=b._.children)for(b.children=new Array(f=d.length),a=f-1;a>=0;--a)h.push(e=b.children[a]=new g(d[a],a)),e.parent=b;return(c.parent=new g(null,0)).children=[c],c}(a);if(i.eachAfter(f),i.parent.m=-i.z,i.eachBefore(h),e)a.eachBefore(j);else{var k=a,l=a,n=a;a.eachBefore(function(a){a.x<k.x&&(k=a),a.x>l.x&&(l=a),a.depth>n.depth&&(n=a)});var m=k===l?1:b(k,l)/2,o=m-k.x,p=c/(l.x+m+o),q=d/(n.depth||1);a.eachBefore(function(a){a.x=(a.x+o)*p,a.y=a.depth*q})}return a}function f(a){var d=a.children,e=a.parent.children,c=a.i?e[a.i-1]:null;if(d){!function(e){for(var a,b=0,f=0,c=e.children,d=c.length;--d>=0;)a=c[d],a.z+=b,a.m+=b,b+=a.s+(f+=a.c)}(a);var f=(d[0].z+d[d.length-1].z)/2;c?(a.z=c.z+b(a._,c._),a.m=a.z-f):a.z=f}else c&&(a.z=c.z+b(a._,c._));a.parent.A=i(a,c,a.parent.A||e[0])}function h(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function i(f,l,i){if(l){for(var g,a=f,d=f,c=l,e=a.parent.children[0],h=a.m,j=d.m,k=c.m,m=e.m;c=T(c),a=S(a),c&&a;)e=S(e),(d=T(d)).a=f,(g=c.z+k-a.z-h+b(c._,a._))>0&&(U(V(c,f,i),f,g),h+=g,j+=g),k+=c.m,h+=a.m,m+=e.m,j+=d.m;c&&!T(d)&&(d.t=c,d.m+=k-j),a&&!S(e)&&(e.t=a,e.m+=h-m,i=f)}return i}function j(a){a.x*=c,a.y=a.depth*d}return a.separation=function(c){return arguments.length?(b=c,a):b},a.size=function(b){return arguments.length?(e=!1,c=+b[0],d=+b[1],a):e?null:[c,d]},a.nodeSize=function(b){return arguments.length?(e=!0,c=+b[0],d=+b[1],a):e?[c,d]:null},a},a.treemap=function(){var b=i,c=!1,d=1,e=1,f=[0],g=function(){return 0},h=function(){return 0},j=function(){return 0},k=function(){return 0},l=function(){return 0};function a(a){return a.x0=a.y0=0,a.x1=d,a.y1=e,a.eachBefore(m),f=[0],c&&a.eachBefore(M),a}function m(a){var c=f[a.depth],d=a.x0+c,e=a.y0+c,i=a.x1-c,m=a.y1-c;i<d&&(d=i=(d+i)/2),m<e&&(e=m=(e+m)/2),a.x0=d,a.y0=e,a.x1=i,a.y1=m,a.children&&(c=f[a.depth+1]=g(a)/2,d+=l(a)-c,e+=h(a)-c,i-=j(a)-c,m-=k(a)-c,i<d&&(d=i=(d+i)/2),m<e&&(e=m=(e+m)/2),b(a,d,e,i,m))}return a.round=function(b){return arguments.length?(c=!!b,a):c},a.size=function(b){return arguments.length?(d=+b[0],e=+b[1],a):[d,e]},a.tile=function(c){return arguments.length?(b=G(c),a):b},a.padding=function(b){return arguments.length?a.paddingInner(b).paddingOuter(b):a.paddingInner()},a.paddingInner=function(b){return arguments.length?(g="function"==typeof b?b:H(+b),a):g},a.paddingOuter=function(b){return arguments.length?a.paddingTop(b).paddingRight(b).paddingBottom(b).paddingLeft(b):a.paddingTop()},a.paddingTop=function(b){return arguments.length?(h="function"==typeof b?b:H(+b),a):h},a.paddingRight=function(b){return arguments.length?(j="function"==typeof b?b:H(+b),a):j},a.paddingBottom=function(b){return arguments.length?(k="function"==typeof b?b:H(+b),a):k},a.paddingLeft=function(b){return arguments.length?(l="function"==typeof b?b:H(+b),a):l},a},a.treemapBinary=function(c,g,h,i,j){var a,d,e=c.children,b=e.length,f=new Array(b+1);for(f[0]=d=a=0;a<b;++a)f[a+1]=d+=e[a].value;function k(b,j,l,c,d,g,h){if(b>=j-1){var m=e[b];m.x0=c,m.y0=d,m.x1=g,m.y1=h;return}for(var r=f[b],o=l/2+r,a=b+1,p=j-1;a<p;){var q=a+p>>>1;f[q]<o?a=q+1:p=q}o-f[a-1]<f[a]-o&&b+1<a&& --a;var i=f[a]-r,n=l-i;if(g-c>h-d){var s=(c*n+g*i)/l;k(b,a,i,c,d,s,h),k(a,j,n,s,d,g,h)}else{var t=(d*n+h*i)/l;k(b,a,i,c,d,g,t),k(a,j,n,c,t,g,h)}}k(0,b,c.value,g,h,i,j)},a.treemapDice=f,a.treemapResquarify=j,a.treemapSlice=h,a.treemapSliceDice=function(a,b,c,d,e){(1&a.depth?h:f)(a,b,c,d,e)},a.treemapSquarify=i,Object.defineProperty(a,"__esModule",{value:!0})})},{}],116:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-color")):"function"==typeof a&&a.amd?a(["exports","d3-color"],f):f((e=e||self).d3=e.d3||{},e.d3)}(this,function(a,C){"use strict";function D(a,d,e,f,g){var b=a*a,c=b*a;return((1-3*a+3*b-c)*d+(4-6*b+3*c)*e+(1+3*a+3*b-3*c)*f+c*g)/6}function d(a){var b=a.length-1;return function(d){var c=d<=0?d=0:d>=1?(d=1,b-1):Math.floor(d*b),e=a[c],f=a[c+1],g=c>0?a[c-1]:2*e-f,h=c<b-1?a[c+2]:2*f-e;return D((d-c/b)*b,g,e,f,h)}}function e(a){var b=a.length;return function(d){var c=Math.floor(((d%=1)<0?++d:d)*b),e=a[(c+b-1)%b],f=a[c%b],g=a[(c+1)%b],h=a[(c+2)%b];return D((d-c/b)*b,e,f,g,h)}}function E(a){return function(){return a}}function F(a,b){return function(c){return a+c*b}}function b(b,c){var a=c-b;return a?F(b,a>180||a< -180?a-360*Math.round(a/360):a):E(isNaN(b)?c:b)}function c(a,b){var c=b-a;return c?F(a,c):E(isNaN(a)?b:a)}var G,H,I,J,k=function d(e){var a,f=1==(a=+(a=1))?c:function(b,e){var c,f,d;return e-b?(c=b,f=e,c=Math.pow(c,d=a),f=Math.pow(f,d)-c,d=1/d,function(a){return Math.pow(c+a*f,d)}):E(isNaN(b)?e:b)};function b(a,b){var d=f((a=C.rgb(a)).r,(b=C.rgb(b)).r),e=f(a.g,b.g),g=f(a.b,b.b),h=c(a.opacity,b.opacity);return function(b){return a.r=d(b),a.g=e(b),a.b=g(b),a.opacity=h(b),a+""}}return b.gamma=d,b}(1);function f(a){return function(h){var b,c,d=h.length,e=new Array(d),f=new Array(d),g=new Array(d);for(b=0;b<d;++b)c=C.rgb(h[b]),e[b]=c.r||0,f[b]=c.g||0,g[b]=c.b||0;return e=a(e),f=a(f),g=a(g),c.opacity=1,function(a){return c.r=e(a),c.g=f(a),c.b=g(a),c+""}}}var l=f(d),m=f(e);function n(b,a){a||(a=[]);var c,d=b?Math.min(a.length,b.length):0,e=a.slice();return function(f){for(c=0;c<d;++c)e[c]=b[c]*(1-f)+a[c]*f;return e}}function K(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}function L(c,b){var a,d=b?b.length:0,e=c?Math.min(d,c.length):0,f=new Array(e),g=new Array(d);for(a=0;a<e;++a)f[a]=t(c[a],b[a]);for(;a<d;++a)g[a]=b[a];return function(b){for(a=0;a<e;++a)g[a]=f[a](b);return g}}function o(a,b){var c=new Date;return a=+a,b=+b,function(d){return c.setTime(a*(1-d)+b*d),c}}function p(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function q(c,b){var a,d={},e={};for(a in(null===c||"object"!=typeof c)&&(c={}),(null===b||"object"!=typeof b)&&(b={}),b)a in c?d[a]=t(c[a],b[a]):e[a]=b[a];return function(b){for(a in d)e[a]=d[a](b);return e}}var r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,M=new RegExp(r.source,"g");function s(i,d){var j,k,g,e,c,f=r.lastIndex=M.lastIndex=0,a=-1,b=[],h=[];for(i+="",d+="";(g=r.exec(i))&&(e=M.exec(d));)(c=e.index)>f&&(c=d.slice(f,c),b[a]?b[a]+=c:b[++a]=c),(g=g[0])===(e=e[0])?b[a]?b[a]+=e:b[++a]=e:(b[++a]=null,h.push({i:a,x:p(g,e)})),f=M.lastIndex;return f<d.length&&(c=d.slice(f),b[a]?b[a]+=c:b[++a]=c),b.length<2?h[0]?(j=h[0].x,function(a){return j(a)+""}):(k=d,function(){return k}):(d=h.length,function(e){for(var c,a=0;a<d;++a)b[(c=h[a]).i]=c.x(e);return b.join("")})}function t(d,a){var c,b=typeof a;return null==a||"boolean"===b?E(a):("number"===b?p:"string"===b?(c=C.color(a))?(a=c,k):s:a instanceof C.color?k:a instanceof Date?o:K(a)?n:Array.isArray(a)?L:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?q:p)(d,a)}var N=180/Math.PI,O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function P(a,b,d,e,h,i){var f,g,c;return(f=Math.sqrt(a*a+b*b))&&(a/=f,b/=f),(c=a*d+b*e)&&(d-=a*c,e-=b*c),(g=Math.sqrt(d*d+e*e))&&(d/=g,e/=g,c/=g),a*e<b*d&&(a=-a,b=-b,c=-c,f=-f),{translateX:h,translateY:i,rotate:Math.atan2(b,a)*N,skewX:Math.atan(c)*N,scaleX:f,scaleY:g}}function g(a,b,c,d){function e(a){return a.length?a.pop()+" ":""}return function(f,g){var i,h,j,q,o,k,l,r,m=[],n=[];return f=a(f),g=a(g),!function(e,f,a,d,g,i){if(e!==a||f!==d){var h=g.push("translate(",null,b,null,c);i.push({i:h-4,x:p(e,a)},{i:h-2,x:p(f,d)})}else(a||d)&&g.push("translate("+a+b+d+c)}(f.translateX,f.translateY,g.translateX,g.translateY,m,n),i=f.rotate,h=g.rotate,j=m,q=n,i!==h?(i-h>180?h+=360:h-i>180&&(i+=360),q.push({i:j.push(e(j)+"rotate(",null,d)-2,x:p(i,h)})):h&&j.push(e(j)+"rotate("+h+d),o=f.skewX,k=g.skewX,l=m,r=n,o!==k?r.push({i:l.push(e(l)+"skewX(",null,d)-2,x:p(o,k)}):k&&l.push(e(l)+"skewX("+k+d),!function(d,f,a,b,c,h){if(d!==a||f!==b){var g=c.push(e(c)+"scale(",null,",",null,")");h.push({i:g-4,x:p(d,a)},{i:g-2,x:p(f,b)})}else(1!==a||1!==b)&&c.push(e(c)+"scale("+a+","+b+")")}(f.scaleX,f.scaleY,g.scaleX,g.scaleY,m,n),f=g=null,function(c){for(var a,b=-1,d=n.length;++b<d;)m[(a=n[b]).i]=a.x(c);return m.join("")}}}var u=g(function(a){return"none"===a?O:(G||(G=document.createElement("DIV"),H=document.documentElement,I=document.defaultView),G.style.transform=a,a=I.getComputedStyle(H.appendChild(G),null).getPropertyValue("transform"),H.removeChild(G),a=a.slice(7,-1).split(","),P(+a[0],+a[1],+a[2],+a[3],+a[4],+a[5]))},"px, ","px)","deg)"),v=g(function(a){return null==a?O:(J||(J=document.createElementNS("http://www.w3.org/2000/svg","g")),J.setAttribute("transform",a),a=J.transform.baseVal.consolidate())?P((a=a.matrix).a,a.b,a.c,a.d,a.e,a.f):O},", ",")",")"),Q=Math.SQRT2;function R(a){return((a=Math.exp(a))+1/a)/2}function h(a){return function(b,d){var e=a((b=C.hsl(b)).h,(d=C.hsl(d)).h),f=c(b.s,d.s),g=c(b.l,d.l),h=c(b.opacity,d.opacity);return function(a){return b.h=e(a),b.s=f(a),b.l=g(a),b.opacity=h(a),b+""}}}var w=h(b),x=h(c);function i(a){return function(b,d){var e=a((b=C.hcl(b)).h,(d=C.hcl(d)).h),f=c(b.c,d.c),g=c(b.l,d.l),h=c(b.opacity,d.opacity);return function(a){return b.h=e(a),b.c=f(a),b.l=g(a),b.opacity=h(a),b+""}}}var y=i(b),z=i(c);function j(a){return function e(b){function d(d,e){var f=a((d=C.cubehelix(d)).h,(e=C.cubehelix(e)).h),g=c(d.s,e.s),h=c(d.l,e.l),i=c(d.opacity,e.opacity);return function(a){return d.h=f(a),d.s=g(a),d.l=h(Math.pow(a,b)),d.opacity=i(a),d+""}}return b=+b,d.gamma=e,d}(1)}var A=j(b),B=j(c);a.interpolate=t,a.interpolateArray=function(b,a){return(K(a)?n:L)(b,a)},a.interpolateBasis=d,a.interpolateBasisClosed=e,a.interpolateCubehelix=A,a.interpolateCubehelixLong=B,a.interpolateDate=o,a.interpolateDiscrete=function(a){var b=a.length;return function(c){return a[Math.max(0,Math.min(b-1,Math.floor(c*b)))]}},a.interpolateHcl=y,a.interpolateHclLong=z,a.interpolateHsl=w,a.interpolateHslLong=x,a.interpolateHue=function(a,c){var d=b(+a,+c);return function(b){var a=d(b);return a-360*Math.floor(a/360)}},a.interpolateLab=function(a,b){var d=c((a=C.lab(a)).l,(b=C.lab(b)).l),e=c(a.a,b.a),f=c(a.b,b.b),g=c(a.opacity,b.opacity);return function(b){return a.l=d(b),a.a=e(b),a.b=f(b),a.opacity=g(b),a+""}},a.interpolateNumber=p,a.interpolateNumberArray=n,a.interpolateObject=q,a.interpolateRgb=k,a.interpolateRgbBasis=l,a.interpolateRgbBasisClosed=m,a.interpolateRound=function(a,b){return a=+a,b=+b,function(c){return Math.round(a*(1-c)+b*c)}},a.interpolateString=s,a.interpolateTransformCss=u,a.interpolateTransformSvg=v,a.interpolateZoom=function(e,f){var c,g,m=e[0],n=e[1],a=e[2],o=f[0],p=f[1],b=f[2],j=o-m,k=p-n,d=j*j+k*k;if(d<1e-12)g=Math.log(b/a)/Q,c=function(b){return[m+b*j,n+b*k,a*Math.exp(Q*b*g)]};else{var l=Math.sqrt(d),h=(b*b-a*a+4*d)/(2*a*2*l),i=(b*b-a*a-4*d)/(2*b*2*l),q=Math.log(Math.sqrt(h*h+1)-h);g=(Math.log(Math.sqrt(i*i+1)-i)-q)/Q,c=function(h){var b,c,d=h*g,e=R(q),f=a/(2*l)*(e*(((b=Math.exp(2*(b=Q*d+q)))-1)/(b+1))-((c=Math.exp(c=q))-1/c)/2);return[m+f*j,n+f*k,a*e/R(Q*d+q)]}}return c.duration=1e3*g,c},a.piecewise=function(e,a){for(var b=0,c=a.length-1,d=a[0],f=new Array(c<0?0:c);b<c;)f[b]=e(d,d=a[++b]);return function(a){var b=Math.max(0,Math.min(c-1,Math.floor(a*=c)));return f[b](a-b)}},a.quantize=function(d,b){for(var c=new Array(b),a=0;a<b;++a)c[a]=d(a/(b-1));return c},Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(a){"use strict";var d=Math.PI,e=2*d,f=e-1e-6;function b(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function c(){return new b}b.prototype=c.prototype={constructor:b,moveTo:function(a,b){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+b)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(a,b){this._+="L"+(this._x1=+a)+","+(this._y1=+b)},quadraticCurveTo:function(a,b,c,d){this._+="Q"+ +a+","+ +b+","+(this._x1=+c)+","+(this._y1=+d)},bezierCurveTo:function(a,b,c,d,e,f){this._+="C"+ +a+","+ +b+","+ +c+","+ +d+","+(this._x1=+e)+","+(this._y1=+f)},arcTo:function(a,b,g,h,c){a=+a,b=+b,g=+g,h=+h,c=+c;var o=this._x1,p=this._y1,i=g-a,j=h-b,e=o-a,f=p-b,k=e*e+f*f;if(c<0)throw new Error("negative radius: "+c);if(null===this._x1)this._+="M"+(this._x1=a)+","+(this._y1=b);else if(k>1e-6)if(Math.abs(f*i-j*e)>1e-6&&c){var l=g-o,m=h-p,q=i*i+j*j,r=Math.sqrt(q),s=Math.sqrt(k),t=c*Math.tan((d-Math.acos((q+k-(l*l+m*m))/(2*r*s)))/2),n=t/s,u=t/r;Math.abs(n-1)>1e-6&&(this._+="L"+(a+n*e)+","+(b+n*f)),this._+="A"+c+","+c+",0,0,"+ +(f*l>e*m)+","+(this._x1=a+u*i)+","+(this._y1=b+u*j)}else this._+="L"+(this._x1=a)+","+(this._y1=b)},arc:function(c,g,a,h,i,l){var n=(a=+a)*Math.cos(h),o=a*Math.sin(h),j=(c=+c)+n,k=(g=+g)+o,m=1^(l=!!l),b=l?h-i:i-h;if(a<0)throw new Error("negative radius: "+a);null===this._x1?this._+="M"+j+","+k:(Math.abs(this._x1-j)>1e-6||Math.abs(this._y1-k)>1e-6)&&(this._+="L"+j+","+k),a&&(b<0&&(b=b%e+e),b>f?this._+="A"+a+","+a+",0,1,"+m+","+(c-n)+","+(g-o)+"A"+a+","+a+",0,1,"+m+","+(this._x1=j)+","+(this._y1=k):b>1e-6&&(this._+="A"+a+","+a+",0,"+ +(b>=d)+","+m+","+(this._x1=c+a*Math.cos(i))+","+(this._y1=g+a*Math.sin(i))))},rect:function(b,c,a,d){this._+="M"+(this._x0=this._x1=+b)+","+(this._y0=this._y1=+c)+"h"+ +a+"v"+ +d+"h"+ -a+"Z"},toString:function(){return this._}},a.path=c,Object.defineProperty(a,"__esModule",{value:!0})})},{}],118:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(b){"use strict";function e(a,h,i,s){if(isNaN(h)||isNaN(i))return a;var b,d,e,p,q,j,k,f,r,c=a._root,g={data:s},l=a._x0,m=a._y0,n=a._x1,o=a._y1;if(!c)return a._root=g,a;for(;c.length;)if((j=h>=(d=(l+n)/2))?l=d:n=d,(k=i>=(e=(m+o)/2))?m=e:o=e,b=c,!(c=c[f=k<<1|j]))return b[f]=g,a;if(p=+a._x.call(null,c.data),q=+a._y.call(null,c.data),h===p&&i===q)return g.next=c,b?b[f]=g:a._root=g,a;do b=b?b[f]=new Array(4):a._root=new Array(4),(j=h>=(d=(l+n)/2))?l=d:n=d,(k=i>=(e=(m+o)/2))?m=e:o=e;while((f=k<<1|j)==(r=(q>=e)<<1|p>=d))return b[r]=c,b[f]=g,a}function f(a,b,c,d,e){this.node=a,this.x0=b,this.y0=c,this.x1=d,this.y1=e}function g(a){return a[0]}function h(a){return a[1]}function c(a,b,c){var e=new d(null==b?g:b,null==c?h:c,NaN,NaN,NaN,NaN);return null==a?e:e.addAll(a)}function d(a,b,c,d,e,f){this._x=a,this._y=b,this._x0=c,this._y0=d,this._x1=e,this._y1=f,this._root=void 0}function i(a){for(var b={data:a.data},c=b;a=a.next;)c=c.next={data:a.data};return b}var a=c.prototype=d.prototype;a.copy=function(){var f,e,b=new d(this._x,this._y,this._x0,this._y0,this._x1,this._y1),a=this._root;if(!a)return b;if(!a.length)return b._root=i(a),b;for(f=[{source:a,target:b._root=new Array(4)}];a=f.pop();)for(var c=0;c<4;++c)(e=a.source[c])&&(e.length?f.push({source:e,target:a.target[c]=new Array(4)}):a.target[c]=i(e));return b},a.add=function(a){var b=+this._x.call(null,a),c=+this._y.call(null,a);return e(this.cover(b,c),b,c,a)},a.addAll=function(j){var k,a,b,c,d=j.length,l=new Array(d),m=new Array(d),f=1/0,g=1/0,h=-1/0,i=-1/0;for(a=0;a<d;++a)!(isNaN(b=+this._x.call(null,k=j[a]))||isNaN(c=+this._y.call(null,k)))&&(l[a]=b,m[a]=c,b<f&&(f=b),b>h&&(h=b),c<g&&(g=c),c>i&&(i=c));if(f>h||g>i)return this;for(this.cover(f,g).cover(h,i),a=0;a<d;++a)e(this,l[a],m[a],j[a]);return this},a.cover=function(f,g){if(isNaN(f=+f)||isNaN(g=+g))return this;var a=this._x0,c=this._y0,d=this._x1,e=this._y1;if(isNaN(a))d=(a=Math.floor(f))+1,e=(c=Math.floor(g))+1;else{for(var j,h,b=d-a,i=this._root;a>f||f>=d||c>g||g>=e;)switch(h=(g<c)<<1|f<a,(j=new Array(4))[h]=i,i=j,b*=2,h){case 0:d=a+b,e=c+b;break;case 1:a=d-b,e=c+b;break;case 2:d=a+b,c=e-b;break;case 3:a=d-b,c=e-b;break}this._root&&this._root.length&&(this._root=i)}return this._x0=a,this._y0=c,this._x1=d,this._y1=e,this},a.data=function(){var a=[];return this.visit(function(b){if(!b.length)do a.push(b.data);while(b=b.next)}),a},a.extent=function(a){return arguments.length?this.cover(+a[0][0],+a[0][1]).cover(+a[1][0],+a[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},a.find=function(e,g,c){var t,j,k,l,m,d,s,n=this._x0,o=this._y0,p=this._x1,q=this._y1,a=[],b=this._root;for(b&&a.push(new f(b,n,o,p,q)),null==c?c=1/0:(n=e-c,o=g-c,p=e+c,q=g+c,c*=c);d=a.pop();)if((b=d.node)&&!((j=d.x0)>p)&&!((k=d.y0)>q)&&!((l=d.x1)<n)&&!((m=d.y1)<o))if(b.length){var h=(j+l)/2,i=(k+m)/2;a.push(new f(b[3],h,i,l,m),new f(b[2],j,i,h,m),new f(b[1],h,k,l,i),new f(b[0],j,k,h,i)),(s=(g>=i)<<1|e>=h)&&(d=a[a.length-1],a[a.length-1]=a[a.length-1-s],a[a.length-1-s]=d)}else{var u=e- +this._x.call(null,b.data),v=g- +this._y.call(null,b.data),w=u*u+v*v;if(w<c){var r=Math.sqrt(c=w);n=e-r,o=g-r,p=e+r,q=g+r,t=b.data}}return t},a.remove=function(f){if(isNaN(q=+this._x.call(null,f))||isNaN(r=+this._y.call(null,f)))return this;var b,g,e,d,q,r,h,i,j,k,c,l,a=this._root,m=this._x0,n=this._y0,o=this._x1,p=this._y1;if(!a)return this;if(a.length)for(;;){if((j=q>=(h=(m+o)/2))?m=h:o=h,(k=r>=(i=(n+p)/2))?n=i:p=i,b=a,!(a=a[c=k<<1|j]))return this;if(!a.length)break;(b[c+1&3]||b[c+2&3]||b[c+3&3])&&(g=b,l=c)}for(;a.data!==f;)if(e=a,!(a=a.next))return this;return((d=a.next)&&delete a.next,e)?(d?e.next=d:delete e.next,this):b?(d?b[c]=d:delete b[c],(a=b[0]||b[1]||b[2]||b[3])&&a===(b[3]||b[2]||b[1]||b[0])&&!a.length&&(g?g[l]=a:this._root=a),this):(this._root=d,this)},a.removeAll=function(b){for(var a=0,c=b.length;a<c;++a)this.remove(b[a]);return this},a.root=function(){return this._root},a.size=function(){var a=0;return this.visit(function(b){if(!b.length)do++a;while(b=b.next)}),a},a.visit=function(l){var c,a,e,g,h,i,d=[],b=this._root;for(b&&d.push(new f(b,this._x0,this._y0,this._x1,this._y1));c=d.pop();)if(!l(b=c.node,e=c.x0,g=c.y0,h=c.x1,i=c.y1)&&b.length){var j=(e+h)/2,k=(g+i)/2;(a=b[3])&&d.push(new f(a,j,k,h,i)),(a=b[2])&&d.push(new f(a,e,k,j,i)),(a=b[1])&&d.push(new f(a,j,g,h,k)),(a=b[0])&&d.push(new f(a,e,g,j,k))}return this},a.visitAfter=function(m){var a,c=[],l=[];for(this._root&&c.push(new f(this._root,this._x0,this._y0,this._x1,this._y1));a=c.pop();){var d=a.node;if(d.length){var b,h=a.x0,i=a.y0,j=a.x1,k=a.y1,e=(h+j)/2,g=(i+k)/2;(b=d[0])&&c.push(new f(b,h,i,e,g)),(b=d[1])&&c.push(new f(b,e,i,j,g)),(b=d[2])&&c.push(new f(b,h,g,e,k)),(b=d[3])&&c.push(new f(b,e,g,j,k))}l.push(a)}for(;a=l.pop();)m(a.node,a.x0,a.y0,a.x1,a.y1);return this},a.x=function(a){return arguments.length?(this._x=a,this):this._x},a.y=function(a){return arguments.length?(this._y=a,this):this._y},b.quadtree=c,Object.defineProperty(b,"__esModule",{value:!0})})},{}],119:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-path")):"function"==typeof a&&a.amd?a(["exports","d3-path"],f):f((e=e||self).d3=e.d3||{},e.d3)}(this,function(a,X){"use strict";function Y(a){return function(){return a}}var Z=Math.abs,$=Math.atan2,_=Math.cos,aa=Math.max,ab=Math.min,ac=Math.sin,ad=Math.sqrt,c=Math.PI,ae=c/2,d=2*c;function af(a){return a>=1?ae:a<= -1?-ae:Math.asin(a)}function ag(a){return a.innerRadius}function ah(a){return a.outerRadius}function ai(a){return a.startAngle}function aj(a){return a.endAngle}function ak(a){return a&&a.padAngle}function al(s,t,u,v,i,j,F){var k=s-u,l=t-v,w=(F?j:-j)/ad(k*k+l*l),m=w*l,n=-w*k,o=s+m,p=t+n,q=u+m,r=v+n,x=(o+q)/2,y=(p+r)/2,b=q-o,a=r-p,d=b*b+a*a,e=i-j,c=o*r-q*p,f=(a<0?-1:1)*ad(aa(0,e*e*d-c*c)),g=(c*a-b*f)/d,h=(-c*b-a*f)/d,z=(c*a+b*f)/d,A=(-c*b+a*f)/d,B=g-x,C=h-y,D=z-x,E=A-y;return B*B+C*C>D*D+E*E&&(g=z,h=A),{cx:g,cy:h,x01:-m,y01:-n,x11:g*(i/e-1),y11:h*(i/e-1)}}function q(a){this._context=a}function e(a){return new q(a)}function am(a){return a[0]}function an(a){return a[1]}function r(){var b=am,c=an,d=Y(!0),f=null,g=e,h=null;function a(e){var a,j,k,l=e.length,i=!1;for(null==f&&(h=g(k=X.path())),a=0;a<=l;++a)!(a<l&&d(j=e[a],a,e))===i&&((i=!i)?h.lineStart():h.lineEnd()),i&&h.point(+b(j,a,e),+c(j,a,e));if(k)return h=null,k+""||null}return a.x=function(c){return arguments.length?(b="function"==typeof c?c:Y(+c),a):b},a.y=function(b){return arguments.length?(c="function"==typeof b?b:Y(+b),a):c},a.defined=function(b){return arguments.length?(d="function"==typeof b?b:Y(!!b),a):d},a.curve=function(b){return arguments.length?(g=b,null!=f&&(h=g(f)),a):g},a.context=function(b){return arguments.length?(null==b?f=h=null:h=g(f=b),a):f},a}function s(){var b=am,c=null,d=Y(0),f=an,g=Y(!0),h=null,i=e,j=null;function a(e){var a,r,k,l,o,m=e.length,n=!1,p=new Array(m),q=new Array(m);for(null==h&&(j=i(o=X.path())),a=0;a<=m;++a){if(!(a<m&&g(l=e[a],a,e))===n)if(n=!n)r=a,j.areaStart(),j.lineStart();else{for(j.lineEnd(),j.lineStart(),k=a-1;k>=r;--k)j.point(p[k],q[k]);j.lineEnd(),j.areaEnd()}n&&(p[a]=+b(l,a,e),q[a]=+d(l,a,e),j.point(c?+c(l,a,e):p[a],f?+f(l,a,e):q[a]))}if(o)return j=null,o+""||null}function k(){return r().defined(g).curve(i).context(h)}return a.x=function(d){return arguments.length?(b="function"==typeof d?d:Y(+d),c=null,a):b},a.x0=function(c){return arguments.length?(b="function"==typeof c?c:Y(+c),a):b},a.x1=function(b){return arguments.length?(c=null==b?null:"function"==typeof b?b:Y(+b),a):c},a.y=function(b){return arguments.length?(d="function"==typeof b?b:Y(+b),f=null,a):d},a.y0=function(b){return arguments.length?(d="function"==typeof b?b:Y(+b),a):d},a.y1=function(b){return arguments.length?(f=null==b?null:"function"==typeof b?b:Y(+b),a):f},a.lineX0=a.lineY0=function(){return k().x(b).y(d)},a.lineY1=function(){return k().x(b).y(f)},a.lineX1=function(){return k().x(c).y(d)},a.defined=function(b){return arguments.length?(g="function"==typeof b?b:Y(!!b),a):g},a.curve=function(b){return arguments.length?(i=b,null!=h&&(j=i(h)),a):i},a.context=function(b){return arguments.length?(null==b?h=j=null:j=i(h=b),a):h},a}function ao(a,b){return b<a?-1:b>a?1:b>=a?0:NaN}function ap(a){return a}q.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;default:this._context.lineTo(a,b);break}}};var aq=ar(e);function t(a){this._curve=a}function ar(b){function a(a){return new t(b(a))}return a._curve=b,a}function as(a){var b=a.curve;return a.angle=a.x,delete a.x,a.radius=a.y,delete a.y,a.curve=function(a){return arguments.length?b(ar(a)):b()._curve},a}function f(){return as(r().curve(aq))}function g(){var a=s().curve(aq),b=a.curve,c=a.lineX0,d=a.lineX1,e=a.lineY0,f=a.lineY1;return a.angle=a.x,delete a.x,a.startAngle=a.x0,delete a.x0,a.endAngle=a.x1,delete a.x1,a.radius=a.y,delete a.y,a.innerRadius=a.y0,delete a.y0,a.outerRadius=a.y1,delete a.y1,a.lineStartAngle=function(){return as(c())},delete a.lineX0,a.lineEndAngle=function(){return as(d())},delete a.lineX1,a.lineInnerRadius=function(){return as(e())},delete a.lineY0,a.lineOuterRadius=function(){return as(f())},delete a.lineY1,a.curve=function(a){return arguments.length?b(ar(a)):b()._curve},a}function u(b,a){return[(a=+a)*Math.cos(b-=Math.PI/2),a*Math.sin(b)]}t.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,b){this._curve.point(b*Math.sin(a),-(b*Math.cos(a)))}};var at=Array.prototype.slice;function au(a){return a.source}function av(a){return a.target}function aw(b){var c=au,d=av,e=am,f=an,g=null;function a(){var h,a=at.call(arguments),i=c.apply(this,a),j=d.apply(this,a);if(g||(g=h=X.path()),b(g,+e.apply(this,(a[0]=i,a)),+f.apply(this,a),+e.apply(this,(a[0]=j,a)),+f.apply(this,a)),h)return g=null,h+""||null}return a.source=function(b){return arguments.length?(c=b,a):c},a.target=function(b){return arguments.length?(d=b,a):d},a.x=function(b){return arguments.length?(e="function"==typeof b?b:Y(+b),a):e},a.y=function(b){return arguments.length?(f="function"==typeof b?b:Y(+b),a):f},a.context=function(b){return arguments.length?(g=null==b?null:b,a):g},a}function ax(b,a,c,d,e){b.moveTo(a,c),b.bezierCurveTo(a=(a+d)/2,c,a,e,d,e)}function ay(b,c,a,d,e){b.moveTo(c,a),b.bezierCurveTo(c,a=(a+e)/2,d,a,d,e)}function az(b,c,a,d,e){var f=u(c,a),g=u(c,a=(a+e)/2),h=u(d,a),i=u(d,e);b.moveTo(f[0],f[1]),b.bezierCurveTo(g[0],g[1],h[0],h[1],i[0],i[1])}var h={draw:function(a,e){var b=Math.sqrt(e/c);a.moveTo(b,0),a.arc(0,0,b,0,d)}},i={draw:function(b,c){var a=Math.sqrt(c/5)/2;b.moveTo(-3*a,-a),b.lineTo(-a,-a),b.lineTo(-a,-3*a),b.lineTo(a,-3*a),b.lineTo(a,-a),b.lineTo(3*a,-a),b.lineTo(3*a,a),b.lineTo(a,a),b.lineTo(a,3*a),b.lineTo(-a,3*a),b.lineTo(-a,a),b.lineTo(-3*a,a),b.closePath()}},v=Math.sqrt(1/3),aA=2*v,j={draw:function(a,d){var b=Math.sqrt(d/aA),c=b*v;a.moveTo(0,-b),a.lineTo(c,0),a.lineTo(0,b),a.lineTo(-c,0),a.closePath()}},k=Math.sin(c/10)/Math.sin(7*c/10),aB=Math.sin(d/10)*k,aC=-Math.cos(d/10)*k,l={draw:function(a,j){var b=Math.sqrt(.8908130915292852*j),c=aB*b,e=aC*b;a.moveTo(0,-b),a.lineTo(c,e);for(var f=1;f<5;++f){var i=d*f/5,g=Math.cos(i),h=Math.sin(i);a.lineTo(h*b,-g*b),a.lineTo(g*c-h*e,h*c+g*e)}a.closePath()}},m={draw:function(c,d){var a=Math.sqrt(d),b=-a/2;c.rect(b,b,a,a)}},aD=Math.sqrt(3),n={draw:function(b,c){var a=-Math.sqrt(c/(3*aD));b.moveTo(0,2*a),b.lineTo(-aD*a,-a),b.lineTo(aD*a,-a),b.closePath()}},aE=Math.sqrt(3)/2,w=1/Math.sqrt(12),aF=(w/2+1)*3,o={draw:function(a,i){var h=Math.sqrt(i/aF),b=h/2,e=h*w,c=b,d=h*w+h,f=-c,g=d;a.moveTo(b,e),a.lineTo(c,d),a.lineTo(f,g),a.lineTo(-0.5*b-aE*e,aE*b+ -0.5*e),a.lineTo(-0.5*c-aE*d,aE*c+ -0.5*d),a.lineTo(-0.5*f-aE*g,aE*f+ -0.5*g),a.lineTo(-0.5*b+aE*e,-0.5*e-aE*b),a.lineTo(-0.5*c+aE*d,-0.5*d-aE*c),a.lineTo(-0.5*f+aE*g,-0.5*g-aE*f),a.closePath()}};function b(){}function aG(a,b,c){a._context.bezierCurveTo((2*a._x0+a._x1)/3,(2*a._y0+a._y1)/3,(a._x0+2*a._x1)/3,(a._y0+2*a._y1)/3,(a._x0+4*a._x1+b)/6,(a._y0+4*a._y1+c)/6)}function x(a){this._context=a}function y(a){this._context=a}function z(a){this._context=a}function A(a,b){this._basis=new x(a),this._beta=b}x.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:aG(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:aG(this,a,b);break}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},y.prototype={areaStart:b,areaEnd:b,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._x2=a,this._y2=b;break;case 1:this._point=2,this._x3=a,this._y3=b;break;case 2:this._point=3,this._x4=a,this._y4=b,this._context.moveTo((this._x0+4*this._x1+a)/6,(this._y0+4*this._y1+b)/6);break;default:aG(this,a,b);break}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},z.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var c=(this._x0+4*this._x1+a)/6,d=(this._y0+4*this._y1+b)/6;this._line?this._context.lineTo(c,d):this._context.moveTo(c,d);break;case 3:this._point=4;default:aG(this,a,b);break}this._x0=this._x1,this._x1=a,this._y0=this._y1,this._y1=b}},A.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var b=this._x,d=this._y,a=b.length-1;if(a>0)for(var e,f=b[0],g=d[0],h=b[a]-f,i=d[a]-g,c=-1;++c<=a;)e=c/a,this._basis.point(this._beta*b[c]+(1-this._beta)*(f+e*h),this._beta*d[c]+(1-this._beta)*(g+e*i));this._x=this._y=null,this._basis.lineEnd()},point:function(a,b){this._x.push(+a),this._y.push(+b)}};var B=function b(c){function a(a){return 1===c?new x(a):new A(a,c)}return a.beta=function(a){return b(+a)},a}(.85);function aH(a,b,c){a._context.bezierCurveTo(a._x1+a._k*(a._x2-a._x0),a._y1+a._k*(a._y2-a._y0),a._x2+a._k*(a._x1-b),a._y2+a._k*(a._y1-c),a._x2,a._y2)}function C(a,b){this._context=a,this._k=(1-b)/6}C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:aH(this,this._x1,this._y1);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2,this._x1=a,this._y1=b;break;case 2:this._point=3;default:aH(this,a,b);break}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var D=function b(c){function a(a){return new C(a,0)}return a.tension=function(a){return b(+a)},a}(0);function E(a,b){this._context=a,this._k=(1-b)/6}E.prototype={areaStart:b,areaEnd:b,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1,this._x3=a,this._y3=b;break;case 1:this._point=2,this._context.moveTo(this._x4=a,this._y4=b);break;case 2:this._point=3,this._x5=a,this._y5=b;break;default:aH(this,a,b);break}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var F=function b(c){function a(a){return new E(a,0)}return a.tension=function(a){return b(+a)},a}(0);function G(a,b){this._context=a,this._k=(1-b)/6}G.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){switch(a=+a,b=+b,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:aH(this,a,b);break}this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var H=function b(c){function a(a){return new G(a,0)}return a.tension=function(a){return b(+a)},a}(0);function aI(a,j,k){var b=a._x1,c=a._y1,d=a._x2,e=a._y2;if(a._l01_a>1e-12){var f=2*a._l01_2a+3*a._l01_a*a._l12_a+a._l12_2a,g=3*a._l01_a*(a._l01_a+a._l12_a);b=(b*f-a._x0*a._l12_2a+a._x2*a._l01_2a)/g,c=(c*f-a._y0*a._l12_2a+a._y2*a._l01_2a)/g}if(a._l23_a>1e-12){var h=2*a._l23_2a+3*a._l23_a*a._l12_a+a._l12_2a,i=3*a._l23_a*(a._l23_a+a._l12_a);d=(d*h+a._x1*a._l23_2a-j*a._l12_2a)/i,e=(e*h+a._y1*a._l23_2a-k*a._l12_2a)/i}a._context.bezierCurveTo(b,c,d,e,a._x2,a._y2)}function I(a,b){this._context=a,this._alpha=b}I.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(a,b):this._context.moveTo(a,b);break;case 1:this._point=2;break;case 2:this._point=3;default:aI(this,a,b);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var J=function b(c){function a(a){return c?new I(a,c):new C(a,0)}return a.alpha=function(a){return b(+a)},a}(.5);function K(a,b){this._context=a,this._alpha=b}K.prototype={areaStart:b,areaEnd:b,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=a,this._y3=b;break;case 1:this._point=2,this._context.moveTo(this._x4=a,this._y4=b);break;case 2:this._point=3,this._x5=a,this._y5=b;break;default:aI(this,a,b);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var L=function b(c){function a(a){return c?new K(a,c):new E(a,0)}return a.alpha=function(a){return b(+a)},a}(.5);function M(a,b){this._context=a,this._alpha=b}M.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(a,b){if(a=+a,b=+b,this._point){var c=this._x2-a,d=this._y2-b;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(c*c+d*d,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:aI(this,a,b);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=a,this._y0=this._y1,this._y1=this._y2,this._y2=b}};var N=function b(c){function a(a){return c?new M(a,c):new G(a,0)}return a.alpha=function(a){return b(+a)},a}(.5);function O(a){this._context=a}function aJ(a){return a<0?-1:1}function aK(a,f,g){var b=a._x1-a._x0,c=f-a._x1,d=(a._y1-a._y0)/(b||c<0&& -0),e=(g-a._y1)/(c||b<0&& -0);return(aJ(d)+aJ(e))*Math.min(Math.abs(d),Math.abs(e),.5*Math.abs((d*c+e*b)/(b+c)))||0}function aL(a,b){var c=a._x1-a._x0;return c?(3*(a._y1-a._y0)/c-b)/2:b}function aM(a,f,g){var d=a._x0,h=a._y0,c=a._x1,e=a._y1,b=(c-d)/3;a._context.bezierCurveTo(d+b,h+b*f,c-b,e-b*g,c,e)}function p(a){this._context=a}function P(a){this._context=new Q(a)}function Q(a){this._context=a}function R(a){this._context=a}function aN(e){var a,g,b=e.length-1,c=new Array(b),d=new Array(b),f=new Array(b);for(c[0]=0,d[0]=2,f[0]=e[0]+2*e[1],a=1;a<b-1;++a)c[a]=1,d[a]=4,f[a]=4*e[a]+2*e[a+1];for(c[b-1]=2,d[b-1]=7,f[b-1]=8*e[b-1]+e[b],a=1;a<b;++a)g=c[a]/d[a-1],d[a]-=g,f[a]-=g*f[a-1];for(c[b-1]=f[b-1]/d[b-1],a=b-2;a>=0;--a)c[a]=(f[a]-c[a+1])/d[a];for(a=0,d[b-1]=(e[b]+c[b-1])/2;a<b-1;++a)d[a]=2*e[a+1]-c[a+1];return[c,d]}function S(a,b){this._context=a,this._t=b}function T(d,f){if((g=d.length)>1)for(var a,c,g,e=1,b=d[f[0]],h=b.length;e<g;++e)for(c=b,b=d[f[e]],a=0;a<h;++a)b[a][1]+=b[a][0]=isNaN(c[a][1])?c[a][0]:c[a][1]}function U(c){for(var a=c.length,b=new Array(a);--a>=0;)b[a]=a;return b}function aO(a,b){return a[b]}function V(a){var b=a.map(aP);return U(a).sort(function(a,c){return b[a]-b[c]})}function aP(b){for(var c,a=-1,d=0,f=b.length,e=-1/0;++a<f;)(c=+b[a][1])>e&&(e=c,d=a);return d}function W(a){var b=a.map(aQ);return U(a).sort(function(a,c){return b[a]-b[c]})}function aQ(a){for(var b,c=0,d=-1,e=a.length;++d<e;)(b=+a[d][1])&&(c+=b);return c}O.prototype={areaStart:b,areaEnd:b,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(a,b){a=+a,b=+b,this._point?this._context.lineTo(a,b):(this._point=1,this._context.moveTo(a,b))}},p.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:aM(this,this._t0,aL(this,this._t0));break}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(b,a){var c=NaN;if(a=+a,(b=+b)!==this._x1||a!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(b,a):this._context.moveTo(b,a);break;case 1:this._point=2;break;case 2:this._point=3,aM(this,aL(this,c=aK(this,b,a)),c);break;default:aM(this,this._t0,c=aK(this,b,a));break}this._x0=this._x1,this._x1=b,this._y0=this._y1,this._y1=a,this._t0=c}}},(P.prototype=Object.create(p.prototype)).point=function(a,b){p.prototype.point.call(this,b,a)},Q.prototype={moveTo:function(a,b){this._context.moveTo(b,a)},closePath:function(){this._context.closePath()},lineTo:function(a,b){this._context.lineTo(b,a)},bezierCurveTo:function(a,b,c,d,e,f){this._context.bezierCurveTo(b,a,d,c,f,e)}},R.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var a=this._x,b=this._y,d=a.length;if(d)if(this._line?this._context.lineTo(a[0],b[0]):this._context.moveTo(a[0],b[0]),2===d)this._context.lineTo(a[1],b[1]);else for(var f=aN(a),g=aN(b),c=0,e=1;e<d;++c,++e)this._context.bezierCurveTo(f[0][c],g[0][c],f[1][c],g[1][c],a[e],b[e]);(this._line||0!==this._line&&1===d)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(a,b){this._x.push(+a),this._y.push(+b)}},S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(b,a){switch(b=+b,a=+a,this._point){case 0:this._point=1,this._line?this._context.lineTo(b,a):this._context.moveTo(b,a);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,a),this._context.lineTo(b,a);else{var c=this._x*(1-this._t)+b*this._t;this._context.lineTo(c,this._y),this._context.lineTo(c,a)}break}this._x=b,this._y=a}},a.arc=function(){var b=ag,e=ah,f=Y(0),g=null,h=ai,i=aj,j=ak,k=null;function a(){var I,U,m=+b.apply(this,arguments),n=+e.apply(this,arguments),p=h.apply(this,arguments)-ae,q=i.apply(this,arguments)-ae,B=Z(q-p),o=q>p;if(k||(k=I=X.path()),n<m&&(U=n,n=m,m=U),n>1e-12)if(B>d-1e-12)k.moveTo(n*_(p),n*ac(p)),k.arc(0,0,n,p,q,!o),m>1e-12&&(k.moveTo(m*_(q),m*ac(q)),k.arc(0,0,m,q,p,o));else{var a,l,x=p,y=q,z=p,A=q,J=B,K=B,L=j.apply(this,arguments)/2,M=L>1e-12&&(g?+g.apply(this,arguments):ad(m*m+n*n)),u=ab(Z(n-m)/2,+f.apply(this,arguments)),s=u,t=u;if(M>1e-12){var C=af(M/m*ac(L)),D=af(M/n*ac(L));(J-=2*C)>1e-12?(C*=o?1:-1,z+=C,A-=C):(J=0,z=A=(p+q)/2),(K-=2*D)>1e-12?(D*=o?1:-1,x+=D,y-=D):(K=0,x=y=(p+q)/2)}var v=n*_(x),w=n*ac(x),E=m*_(A),F=m*ac(A);if(u>1e-12){var r,G=n*_(y),H=n*ac(y),N=m*_(z),O=m*ac(z);if(B<c&&(r=function(b,c,j,k,d,e,l,m){var f=j-b,g=k-c,h=l-d,i=m-e,a=i*f-h*g;if(!(a*a<1e-12))return a=(h*(c-e)-i*(b-d))/a,[b+a*f,c+a*g]}(v,w,N,O,G,H,E,F))){var P,Q=v-r[0],R=w-r[1],S=G-r[0],T=H-r[1],V=1/ac(((P=(Q*S+R*T)/(ad(Q*Q+R*R)*ad(S*S+T*T)))>1?0:P< -1?c:Math.acos(P))/2),W=ad(r[0]*r[0]+r[1]*r[1]);s=ab(u,(m-W)/(V-1)),t=ab(u,(n-W)/(V+1))}}K>1e-12?t>1e-12?(a=al(N,O,v,w,n,t,o),l=al(G,H,E,F,n,t,o),k.moveTo(a.cx+a.x01,a.cy+a.y01),t<u?k.arc(a.cx,a.cy,t,$(a.y01,a.x01),$(l.y01,l.x01),!o):(k.arc(a.cx,a.cy,t,$(a.y01,a.x01),$(a.y11,a.x11),!o),k.arc(0,0,n,$(a.cy+a.y11,a.cx+a.x11),$(l.cy+l.y11,l.cx+l.x11),!o),k.arc(l.cx,l.cy,t,$(l.y11,l.x11),$(l.y01,l.x01),!o))):(k.moveTo(v,w),k.arc(0,0,n,x,y,!o)):k.moveTo(v,w),m>1e-12&&J>1e-12?s>1e-12?(a=al(E,F,G,H,m,-s,o),l=al(v,w,N,O,m,-s,o),k.lineTo(a.cx+a.x01,a.cy+a.y01),s<u?k.arc(a.cx,a.cy,s,$(a.y01,a.x01),$(l.y01,l.x01),!o):(k.arc(a.cx,a.cy,s,$(a.y01,a.x01),$(a.y11,a.x11),!o),k.arc(0,0,m,$(a.cy+a.y11,a.cx+a.x11),$(l.cy+l.y11,l.cx+l.x11),o),k.arc(l.cx,l.cy,s,$(l.y11,l.x11),$(l.y01,l.x01),!o))):k.arc(0,0,m,A,z,o):k.lineTo(E,F)}else k.moveTo(0,0);if(k.closePath(),I)return k=null,I+""||null}return a.centroid=function(){var a=(+b.apply(this,arguments)+ +e.apply(this,arguments))/2,d=(+h.apply(this,arguments)+ +i.apply(this,arguments))/2-c/2;return[_(d)*a,ac(d)*a]},a.innerRadius=function(c){return arguments.length?(b="function"==typeof c?c:Y(+c),a):b},a.outerRadius=function(b){return arguments.length?(e="function"==typeof b?b:Y(+b),a):e},a.cornerRadius=function(b){return arguments.length?(f="function"==typeof b?b:Y(+b),a):f},a.padRadius=function(b){return arguments.length?(g=null==b?null:"function"==typeof b?b:Y(+b),a):g},a.startAngle=function(b){return arguments.length?(h="function"==typeof b?b:Y(+b),a):h},a.endAngle=function(b){return arguments.length?(i="function"==typeof b?b:Y(+b),a):i},a.padAngle=function(b){return arguments.length?(j="function"==typeof b?b:Y(+b),a):j},a.context=function(b){return arguments.length?(k=null==b?null:b,a):k},a},a.area=s,a.areaRadial=g,a.curveBasis=function(a){return new x(a)},a.curveBasisClosed=function(a){return new y(a)},a.curveBasisOpen=function(a){return new z(a)},a.curveBundle=B,a.curveCardinal=D,a.curveCardinalClosed=F,a.curveCardinalOpen=H,a.curveCatmullRom=J,a.curveCatmullRomClosed=L,a.curveCatmullRomOpen=N,a.curveLinear=e,a.curveLinearClosed=function(a){return new O(a)},a.curveMonotoneX=function(a){return new p(a)},a.curveMonotoneY=function(a){return new P(a)},a.curveNatural=function(a){return new R(a)},a.curveStep=function(a){return new S(a,.5)},a.curveStepAfter=function(a){return new S(a,1)},a.curveStepBefore=function(a){return new S(a,0)},a.line=r,a.lineRadial=f,a.linkHorizontal=function(){return aw(ax)},a.linkRadial=function(){var a=aw(az);return a.angle=a.x,delete a.x,a.radius=a.y,delete a.y,a},a.linkVertical=function(){return aw(ay)},a.pie=function(){var b=ap,c=ao,e=null,f=Y(0),g=Y(d),h=Y(0);function a(k){var a,o,s,p,j,i=k.length,q=0,l=new Array(i),m=new Array(i),n=+f.apply(this,arguments),r=Math.min(d,Math.max(-d,g.apply(this,arguments)-n)),t=Math.min(Math.abs(r)/i,h.apply(this,arguments)),u=t*(r<0?-1:1);for(a=0;a<i;++a)(j=m[l[a]=a]=+b(k[a],a,k))>0&&(q+=j);for(null!=c?l.sort(function(a,b){return c(m[a],m[b])}):null!=e&&l.sort(function(a,b){return e(k[a],k[b])}),a=0,s=q?(r-i*u)/q:0;a<i;++a,n=p)p=n+((j=m[o=l[a]])>0?j*s:0)+u,m[o]={data:k[o],index:a,value:j,startAngle:n,endAngle:p,padAngle:t};return m}return a.value=function(c){return arguments.length?(b="function"==typeof c?c:Y(+c),a):b},a.sortValues=function(b){return arguments.length?(c=b,e=null,a):c},a.sort=function(b){return arguments.length?(e=b,c=null,a):e},a.startAngle=function(b){return arguments.length?(f="function"==typeof b?b:Y(+b),a):f},a.endAngle=function(b){return arguments.length?(g="function"==typeof b?b:Y(+b),a):g},a.padAngle=function(b){return arguments.length?(h="function"==typeof b?b:Y(+b),a):h},a},a.pointRadial=u,a.radialArea=g,a.radialLine=f,a.stack=function(){var b=Y([]),c=U,d=T,e=aO;function a(h){var a,i,k=b.apply(this,arguments),l=h.length,j=k.length,g=new Array(j);for(a=0;a<j;++a){for(var m,n=k[a],o=g[a]=new Array(l),f=0;f<l;++f)o[f]=m=[0,+e(h[f],n,f,h)],m.data=h[f];o.key=n}for(a=0,i=c(g);a<j;++a)g[i[a]].index=a;return d(g,i),g}return a.keys=function(c){return arguments.length?(b="function"==typeof c?c:Y(at.call(c)),a):b},a.value=function(b){return arguments.length?(e="function"==typeof b?b:Y(+b),a):e},a.order=function(b){return arguments.length?(c=null==b?U:"function"==typeof b?b:Y(at.call(b)),a):c},a.offset=function(b){return arguments.length?(d=null==b?T:b,a):d},a},a.stackOffsetDiverging=function(d,h){if((i=d.length)>0)for(var c,a,b,e,f,i,g=0,j=d[h[0]].length;g<j;++g)for(e=f=0,c=0;c<i;++c)(b=(a=d[h[c]][g])[1]-a[0])>0?(a[0]=e,a[1]=e+=b):b<0?(a[1]=f,a[0]=f+=b):(a[0]=0,a[1]=b)},a.stackOffsetExpand=function(b,f){if((e=b.length)>0){for(var a,e,c,d=0,g=b[0].length;d<g;++d){for(c=a=0;a<e;++a)c+=b[a][d][1]||0;if(c)for(a=0;a<e;++a)b[a][d][1]/=c}T(b,f)}},a.stackOffsetNone=T,a.stackOffsetSilhouette=function(b,e){if((g=b.length)>0){for(var g,a=0,c=b[e[0]],h=c.length;a<h;++a){for(var d=0,f=0;d<g;++d)f+=b[d][a][1]||0;c[a][1]+=c[a][0]=-f/2}T(b,e)}},a.stackOffsetWiggle=function(b,c){if((o=b.length)>0&&(n=(d=b[c[0]]).length)>0){for(var d,n,o,f=0,a=1;a<n;++a){for(var e=0,g=0,j=0;e<o;++e){for(var k=b[c[e]],h=k[a][1]||0,l=(h-(k[a-1][1]||0))/2,i=0;i<e;++i){var m=b[c[i]],p=m[a][1]||0,q=m[a-1][1]||0;l+=p-q}g+=h,j+=l*h}d[a-1][1]+=d[a-1][0]=f,g&&(f-=j/g)}d[a-1][1]+=d[a-1][0]=f,T(b,c)}},a.stackOrderAppearance=V,a.stackOrderAscending=W,a.stackOrderDescending=function(a){return W(a).reverse()},a.stackOrderInsideOut=function(c){var b,a,i=c.length,d=c.map(aQ),j=V(c),e=0,f=0,g=[],h=[];for(b=0;b<i;++b)a=j[b],e<f?(e+=d[a],g.push(a)):(f+=d[a],h.push(a));return h.reverse().concat(g)},a.stackOrderNone=U,a.stackOrderReverse=function(a){return U(a).reverse()},a.symbol=function(){var b=Y(h),c=Y(64),d=null;function a(){var a;if(d||(d=a=X.path()),b.apply(this,arguments).draw(d,+c.apply(this,arguments)),a)return d=null,a+""||null}return a.type=function(c){return arguments.length?(b="function"==typeof c?c:Y(c),a):b},a.size=function(b){return arguments.length?(c="function"==typeof b?b:Y(+b),a):c},a.context=function(b){return arguments.length?(d=null==b?null:b,a):d},a},a.symbolCircle=h,a.symbolCross=i,a.symbolDiamond=j,a.symbolSquare=m,a.symbolStar=l,a.symbolTriangle=n,a.symbolWye=o,a.symbols=[h,i,j,m,l,n,o],Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(b,c,d){!function(e,f){"object"==typeof d&& void 0!==c?f(d,b("d3-time")):"function"==typeof a&&a.amd?a(["exports","d3-time"],f):f((e=e||self).d3=e.d3||{},e.d3)}(this,function(a,g){"use strict";function h(a){if(0<=a.y&&a.y<100){var b=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return b.setFullYear(a.y),b}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function i(a){if(0<=a.y&&a.y<100){var b=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return b.setUTCFullYear(a.y),b}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function j(a,b,c){return{y:a,m:b,d:c,H:0,M:0,S:0,L:0}}function d(a){var e=a.dateTime,f=a.date,k=a.time,m=a.periods,n=a.days,o=a.shortDays,p=a.months,q=a.shortMonths,aw=r(m),ax=s(m),ay=r(n),az=s(n),aA=r(o),aB=s(o),aC=r(p),aD=s(p),aE=r(q),aF=s(q),b={a:function(a){return o[a.getDay()]},A:function(a){return n[a.getDay()]},b:function(a){return q[a.getMonth()]},B:function(a){return p[a.getMonth()]},c:null,d:N,e:N,f:S,H:O,I:P,j:Q,L:R,m:T,M:U,p:function(a){return m[+(a.getHours()>=12)]},q:function(a){return 1+ ~~(a.getMonth()/3)},Q:au,s:av,S:V,u:W,U:X,V:Y,w:Z,W:$,x:null,X:null,y:_,Y:aa,Z:ab,"%":at},c={a:function(a){return o[a.getUTCDay()]},A:function(a){return n[a.getUTCDay()]},b:function(a){return q[a.getUTCMonth()]},B:function(a){return p[a.getUTCMonth()]},c:null,d:ac,e:ac,f:ah,H:ad,I:ae,j:af,L:ag,m:ai,M:aj,p:function(a){return m[+(a.getUTCHours()>=12)]},q:function(a){return 1+ ~~(a.getUTCMonth()/3)},Q:au,s:av,S:ak,u:al,U:am,V:an,w:ao,W:ap,x:null,X:null,y:aq,Y:ar,Z:as,"%":at},aG={a:function(c,d,b){var a=aA.exec(d.slice(b));return a?(c.w=aB[a[0].toLowerCase()],b+a[0].length):-1},A:function(c,d,b){var a=ay.exec(d.slice(b));return a?(c.w=az[a[0].toLowerCase()],b+a[0].length):-1},b:function(c,d,b){var a=aE.exec(d.slice(b));return a?(c.m=aF[a[0].toLowerCase()],b+a[0].length):-1},B:function(c,d,b){var a=aC.exec(d.slice(b));return a?(c.m=aD[a[0].toLowerCase()],b+a[0].length):-1},c:function(a,b,c){return aI(a,e,b,c)},d:D,e:D,f:J,H:F,I:F,j:E,L:I,m:C,M:G,p:function(c,d,b){var a=aw.exec(d.slice(b));return a?(c.p=ax[a[0].toLowerCase()],b+a[0].length):-1},q:B,Q:L,s:M,S:H,u:u,U:v,V:w,w:t,W:x,x:function(a,b,c){return aI(a,f,b,c)},X:function(a,b,c){return aI(a,k,b,c)},y:z,Y:y,Z:A,"%":K};function d(a,b){return function(e){var d,g,i,f=[],c=-1,h=0,j=a.length;for(e instanceof Date||(e=new Date(+e));++c<j;)37===a.charCodeAt(c)&&(f.push(a.slice(h,c)),null!=(g=l[d=a.charAt(++c)])?d=a.charAt(++c):g="e"===d?" ":"0",(i=b[d])&&(d=i(e,g)),f.push(d),h=c+1);return f.push(a.slice(h,c)),f.join("")}}function aH(a,b){return function(f){var d,e,c=j(1900,void 0,1);if(aI(c,a,f+="",0)!=f.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(!b||"Z"in c||(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(d=(e=(d=i(j(c.y,0,1))).getUTCDay())>4||0===e?g.utcMonday.ceil(d):g.utcMonday(d),d=g.utcDay.offset(d,(c.V-1)*7),c.y=d.getUTCFullYear(),c.m=d.getUTCMonth(),c.d=d.getUTCDate()+(c.w+6)%7):(d=(e=(d=h(j(c.y,0,1))).getDay())>4||0===e?g.timeMonday.ceil(d):g.timeMonday(d),d=g.timeDay.offset(d,(c.V-1)*7),c.y=d.getFullYear(),c.m=d.getMonth(),c.d=d.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),e="Z"in c?i(j(c.y,0,1)).getUTCDay():h(j(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(e+5)%7:c.w+7*c.U-(e+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,i(c)):h(c)}}function aI(g,b,e,a){for(var c,f,d=0,h=b.length,i=e.length;d<h;){if(a>=i)return -1;if(37===(c=b.charCodeAt(d++))){if(!(f=aG[(c=b.charAt(d++))in l?b.charAt(d++):c])||(a=f(g,e,a))<0)return -1}else if(c!=e.charCodeAt(a++))return -1}return a}return b.x=d(f,b),b.X=d(k,b),b.c=d(e,b),c.x=d(f,c),c.X=d(k,c),c.c=d(e,c),{format:function(c){var a=d(c+="",b);return a.toString=function(){return c},a},parse:function(b){var a=aH(b+="",!1);return a.toString=function(){return b},a},utcFormat:function(b){var a=d(b+="",c);return a.toString=function(){return b},a},utcParse:function(b){var a=aH(b+="",!0);return a.toString=function(){return b},a}}}var k,l={"-":"","_":" ","0":"0"},m=/^\s*\d+/,n=/^%/,o=/[\\^$*+?|[\]().{}]/g;function p(a,f,c){var d=a<0?"-":"",b=(d?-a:a)+"",e=b.length;return d+(e<c?new Array(c-e+1).join(f)+b:b)}function q(a){return a.replace(o,"\\$&")}function r(a){return new RegExp("^(?:"+a.map(q).join("|")+")","i")}function s(b){for(var c={},a=-1,d=b.length;++a<d;)c[b[a].toLowerCase()]=a;return c}function t(c,d,a){var b=m.exec(d.slice(a,a+1));return b?(c.w=+b[0],a+b[0].length):-1}function u(c,d,a){var b=m.exec(d.slice(a,a+1));return b?(c.u=+b[0],a+b[0].length):-1}function v(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.U=+b[0],a+b[0].length):-1}function w(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.V=+b[0],a+b[0].length):-1}function x(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.W=+b[0],a+b[0].length):-1}function y(c,d,a){var b=m.exec(d.slice(a,a+4));return b?(c.y=+b[0],a+b[0].length):-1}function z(c,d,b){var a=m.exec(d.slice(b,b+2));return a?(c.y=+a[0]+(+a[0]>68?1900:2e3),b+a[0].length):-1}function A(c,d,b){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(d.slice(b,b+6));return a?(c.Z=a[1]?0:-(a[2]+(a[3]||"00")),b+a[0].length):-1}function B(c,d,a){var b=m.exec(d.slice(a,a+1));return b?(c.q=3*b[0]-3,a+b[0].length):-1}function C(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.m=b[0]-1,a+b[0].length):-1}function D(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.d=+b[0],a+b[0].length):-1}function E(c,d,a){var b=m.exec(d.slice(a,a+3));return b?(c.m=0,c.d=+b[0],a+b[0].length):-1}function F(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.H=+b[0],a+b[0].length):-1}function G(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.M=+b[0],a+b[0].length):-1}function H(c,d,a){var b=m.exec(d.slice(a,a+2));return b?(c.S=+b[0],a+b[0].length):-1}function I(c,d,a){var b=m.exec(d.slice(a,a+3));return b?(c.L=+b[0],a+b[0].length):-1}function J(c,d,a){var b=m.exec(d.slice(a,a+6));return b?(c.L=Math.floor(b[0]/1e3),a+b[0].length):-1}function K(d,c,a){var b=n.exec(c.slice(a,a+1));return b?a+b[0].length:-1}function L(c,d,b){var a=m.exec(d.slice(b));return a?(c.Q=+a[0],b+a[0].length):-1}function M(c,d,b){var a=m.exec(d.slice(b));return a?(c.s=+a[0],b+a[0].length):-1}function N(a,b){return p(a.getDate(),b,2)}function O(a,b){return p(a.getHours(),b,2)}function P(a,b){return p(a.getHours()%12||12,b,2)}function Q(a,b){return p(1+g.timeDay.count(g.timeYear(a),a),b,3)}function R(a,b){return p(a.getMilliseconds(),b,3)}function S(a,b){return R(a,b)+"000"}function T(a,b){return p(a.getMonth()+1,b,2)}function U(a,b){return p(a.getMinutes(),b,2)}function V(a,b){return p(a.getSeconds(),b,2)}function W(b){var a=b.getDay();return 0===a?7:a}function X(a,b){return p(g.timeSunday.count(g.timeYear(a)-1,a),b,2)}function Y(a,c){var b=a.getDay();return a=b>=4||0===b?g.timeThursday(a):g.timeThursday.ceil(a),p(g.timeThursday.count(g.timeYear(a),a)+(4===g.timeYear(a).getDay()),c,2)}function Z(a){return a.getDay()}function $(a,b){return p(g.timeMonday.count(g.timeYear(a)-1,a),b,2)}function _(a,b){return p(a.getFullYear()%100,b,2)}function aa(a,b){return p(a.getFullYear()%1e4,b,4)}function ab(b){var a=b.getTimezoneOffset();return(a>0?"-":(a*=-1,"+"))+p(a/60|0,"0",2)+p(a%60,"0",2)}function ac(a,b){return p(a.getUTCDate(),b,2)}function ad(a,b){return p(a.getUTCHours(),b,2)}function ae(a,b){return p(a.getUTCHours()%12||12,b,2)}function af(a,b){return p(1+g.utcDay.count(g.utcYear(a),a),b,3)}function ag(a,b){return p(a.getUTCMilliseconds(),b,3)}function ah(a,b){return ag(a,b)+"000"}function ai(a,b){return p(a.getUTCMonth()+1,b,2)}function aj(a,b){return p(a.getUTCMinutes(),b,2)}function ak(a,b){return p(a.getUTCSeconds(),b,2)}function al(b){var a=b.getUTCDay();return 0===a?7:a}function am(a,b){return p(g.utcSunday.count(g.utcYear(a)-1,a),b,2)}function an(a,c){var b=a.getUTCDay();return a=b>=4||0===b?g.utcThursday(a):g.utcThursday.ceil(a),p(g.utcThursday.count(g.utcYear(a),a)+(4===g.utcYear(a).getUTCDay()),c,2)}function ao(a){return a.getUTCDay()}function ap(a,b){return p(g.utcMonday.count(g.utcYear(a)-1,a),b,2)}function aq(a,b){return p(a.getUTCFullYear()%100,b,2)}function ar(a,b){return p(a.getUTCFullYear()%1e4,b,4)}function as(){return"+0000"}function at(){return"%"}function au(a){return+a}function av(a){return Math.floor(+a/1e3)}function b(b){return k=d(b),a.timeFormat=k.format,a.timeParse=k.parse,a.utcFormat=k.utcFormat,a.utcParse=k.utcParse,k}b({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var c="%Y-%m-%dT%H:%M:%S.%LZ",e=Date.prototype.toISOString?function(a){return a.toISOString()}:a.utcFormat(c),f=+new Date("2000-01-01T00:00:00.000Z")?function(b){var a=new Date(b);return isNaN(a)?null:a}:a.utcParse(c);a.isoFormat=e,a.isoParse=f,a.timeFormatDefaultLocale=b,a.timeFormatLocale=d,Object.defineProperty(a,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(a){"use strict";var ac=new Date,ad=new Date;function b(d,e,c,f){function a(a){return d(a=0===arguments.length?new Date:new Date(+a)),a}return a.floor=function(a){return d(a=new Date(+a)),a},a.ceil=function(a){return d(a=new Date(a-1)),e(a,1),d(a),a},a.round=function(b){var c=a(b),d=a.ceil(b);return b-c<d-b?c:d},a.offset=function(a,b){return e(a=new Date(+a),null==b?1:Math.floor(b)),a},a.range=function(b,g,c){var h,f=[];if(b=a.ceil(b),c=null==c?1:Math.floor(c),!(b<g)||!(c>0))return f;do f.push(h=new Date(+b)),e(b,c),d(b);while(h<b&&b<g)return f},a.filter=function(a){return b(function(b){if(b>=b)for(;d(b),!a(b);)b.setTime(b-1)},function(b,c){if(b>=b)if(c<0)for(;++c<=0;)for(;e(b,-1),!a(b););else for(;--c>=0;)for(;e(b,1),!a(b););})},c&&(a.count=function(a,b){return ac.setTime(+a),ad.setTime(+b),d(ac),d(ad),Math.floor(c(ac,ad))},a.every=function(b){return isFinite(b=Math.floor(b))&&b>0?b>1?a.filter(f?function(a){return f(a)%b==0}:function(c){return a.count(0,c)%b==0}):a:null}),a}var e=b(function(){},function(a,b){a.setTime(+a+b)},function(a,b){return b-a});e.every=function(a){return isFinite(a=Math.floor(a))&&a>0?a>1?b(function(b){b.setTime(Math.floor(b/a)*a)},function(b,c){b.setTime(+b+c*a)},function(b,c){return(c-b)/a}):e:null};var k=e.range,f=b(function(a){a.setTime(a-a.getMilliseconds())},function(a,b){a.setTime(+a+1e3*b)},function(a,b){return(b-a)/1e3},function(a){return a.getUTCSeconds()}),l=f.range,m=b(function(a){a.setTime(a-a.getMilliseconds()-1e3*a.getSeconds())},function(a,b){a.setTime(+a+6e4*b)},function(a,b){return(b-a)/6e4},function(a){return a.getMinutes()}),I=m.range,n=b(function(a){a.setTime(a-a.getMilliseconds()-1e3*a.getSeconds()-6e4*a.getMinutes())},function(a,b){a.setTime(+a+36e5*b)},function(a,b){return(b-a)/36e5},function(a){return a.getHours()}),J=n.range,o=b(function(a){a.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*6e4)/864e5},function(a){return a.getDate()-1}),K=o.range;function c(a){return b(function(b){b.setDate(b.getDate()-(b.getDay()+7-a)%7),b.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+7*b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*6e4)/6048e5})}var g=c(0),p=c(1),q=c(2),r=c(3),s=c(4),t=c(5),u=c(6),v=g.range,L=p.range,M=q.range,N=r.range,O=s.range,P=t.range,Q=u.range,w=b(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,b){a.setMonth(a.getMonth()+b)},function(a,b){return b.getMonth()-a.getMonth()+(b.getFullYear()-a.getFullYear())*12},function(a){return a.getMonth()}),R=w.range,h=b(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a,b){return b.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});h.every=function(a){return isFinite(a=Math.floor(a))&&a>0?b(function(b){b.setFullYear(Math.floor(b.getFullYear()/a)*a),b.setMonth(0,1),b.setHours(0,0,0,0)},function(b,c){b.setFullYear(b.getFullYear()+c*a)}):null};var S=h.range,x=b(function(a){a.setUTCSeconds(0,0)},function(a,b){a.setTime(+a+6e4*b)},function(a,b){return(b-a)/6e4},function(a){return a.getUTCMinutes()}),T=x.range,y=b(function(a){a.setUTCMinutes(0,0,0)},function(a,b){a.setTime(+a+36e5*b)},function(a,b){return(b-a)/36e5},function(a){return a.getUTCHours()}),U=y.range,z=b(function(a){a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+b)},function(a,b){return(b-a)/864e5},function(a){return a.getUTCDate()-1}),V=z.range;function d(a){return b(function(b){b.setUTCDate(b.getUTCDate()-(b.getUTCDay()+7-a)%7),b.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+7*b)},function(a,b){return(b-a)/6048e5})}var i=d(0),A=d(1),B=d(2),C=d(3),D=d(4),E=d(5),F=d(6),G=i.range,W=A.range,X=B.range,Y=C.range,Z=D.range,$=E.range,_=F.range,H=b(function(a){a.setUTCDate(1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCMonth(a.getUTCMonth()+b)},function(a,b){return b.getUTCMonth()-a.getUTCMonth()+(b.getUTCFullYear()-a.getUTCFullYear())*12},function(a){return a.getUTCMonth()}),aa=H.range,j=b(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCFullYear(a.getUTCFullYear()+b)},function(a,b){return b.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});j.every=function(a){return isFinite(a=Math.floor(a))&&a>0?b(function(b){b.setUTCFullYear(Math.floor(b.getUTCFullYear()/a)*a),b.setUTCMonth(0,1),b.setUTCHours(0,0,0,0)},function(b,c){b.setUTCFullYear(b.getUTCFullYear()+c*a)}):null};var ab=j.range;a.timeDay=o,a.timeDays=K,a.timeFriday=t,a.timeFridays=P,a.timeHour=n,a.timeHours=J,a.timeInterval=b,a.timeMillisecond=e,a.timeMilliseconds=k,a.timeMinute=m,a.timeMinutes=I,a.timeMonday=p,a.timeMondays=L,a.timeMonth=w,a.timeMonths=R,a.timeSaturday=u,a.timeSaturdays=Q,a.timeSecond=f,a.timeSeconds=l,a.timeSunday=g,a.timeSundays=v,a.timeThursday=s,a.timeThursdays=O,a.timeTuesday=q,a.timeTuesdays=M,a.timeWednesday=r,a.timeWednesdays=N,a.timeWeek=g,a.timeWeeks=v,a.timeYear=h,a.timeYears=S,a.utcDay=z,a.utcDays=V,a.utcFriday=E,a.utcFridays=$,a.utcHour=y,a.utcHours=U,a.utcMillisecond=e,a.utcMilliseconds=k,a.utcMinute=x,a.utcMinutes=T,a.utcMonday=A,a.utcMondays=W,a.utcMonth=H,a.utcMonths=aa,a.utcSaturday=F,a.utcSaturdays=_,a.utcSecond=f,a.utcSeconds=l,a.utcSunday=i,a.utcSundays=G,a.utcThursday=D,a.utcThursdays=Z,a.utcTuesday=B,a.utcTuesdays=X,a.utcWednesday=C,a.utcWednesdays=Y,a.utcWeek=i,a.utcWeeks=G,a.utcYear=j,a.utcYears=ab,Object.defineProperty(a,"__esModule",{value:!0})})},{}],122:[function(b,c,a){arguments[4][121][0].apply(a,arguments)},{dup:121}],123:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).d3=b.d3||{})}(this,function(a){"use strict";var f,g,h=0,i=0,j=0,k=0,l=0,m=0,n="object"==typeof performance&&performance.now?performance:Date,o="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(a){setTimeout(a,17)};function d(){return l||(o(p),l=n.now()+m)}function p(){l=0}function b(){this._call=this._time=this._next=null}function c(c,d,e){var a=new b;return a.restart(c,d,e),a}function e(){d(),++h;for(var b,a=f;a;)(b=l-a._time)>=0&&a._call.call(null,b),a=a._next;--h}function q(){l=(k=n.now())+m,h=i=0;try{e()}finally{h=0,s(),l=0}}function r(){var a=n.now(),b=a-k;b>1e3&&(m-=b,k=a)}function s(){for(var b,c,a=f,d=1/0;a;)a._call?(d>a._time&&(d=a._time),b=a,a=a._next):(c=a._next,a._next=null,a=b?b._next=c:f=c);g=b,t(d)}function t(a){!h&&(i&&(i=clearTimeout(i)),a-l>24?(a<1/0&&(i=setTimeout(q,a-n.now()-m)),j&&(j=clearInterval(j))):(j||(k=n.now(),j=setInterval(r,1e3)),h=1,o(q)))}b.prototype=c.prototype={constructor:b,restart:function(b,c,a){if("function"!=typeof b)throw new TypeError("callback is not a function");a=(null==a?d():+a)+(null==c?0:+c),this._next||g===this||(g?g._next=this:f=this,g=this),this._call=b,this._time=a,t()},stop:function(){this._call&&(this._call=null,this._time=1/0,t())}},a.interval=function(f,a,c){var e=new b,g=a;return null==a?(e.restart(f,a,c),e):(a=+a,c=null==c?d():+c,e.restart(function d(b){b+=g,e.restart(d,g+=a,c),f(b)},a,c),e)},a.now=d,a.timeout=function(e,a,d){var c=new b;return a=null==a?0:+a,c.restart(function(b){c.stop(),e(b+a)},a,d),c},a.timer=c,a.timerFlush=e,Object.defineProperty(a,"__esModule",{value:!0})})},{}],124:[function(b,a,c){a.exports=function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]}},{}],125:[function(e,b,f){"use strict";b.exports=a;var g=(a.canvas=document.createElement("canvas")).getContext("2d"),c=d([32,126]);function a(e,a){Array.isArray(e)&&(e=e.join(", "));var b,j={},f=16,k=.05;a&&(2===a.length&&"number"==typeof a[0]?b=d(a):Array.isArray(a)?b=a:(a.o?b=d(a.o):a.pairs&&(b=a.pairs),a.fontSize&&(f=a.fontSize),null!=a.threshold&&(k=a.threshold))),b||(b=c),g.font=f+"px "+e;for(var i=0;i<b.length;i++){var h=b[i],l=g.measureText(h[0]).width+g.measureText(h[1]).width,m=g.measureText(h).width;if(Math.abs(l-m)>f*k){var n=(m-l)/f;j[h]=1e3*n}}return j}function d(a){for(var d=[],b=a[0];b<=a[1];b++)for(var e=String.fromCharCode(b),c=a[0];c<a[1];c++){var f=e+String.fromCharCode(c);d.push(f)}return d}a.createPairs=d,a.ascii=c},{}],126:[function(a,b,c){var d=a("abs-svg-path"),e=a("normalize-svg-path"),f={M:"moveTo",C:"bezierCurveTo"};b.exports=function(a,b){a.beginPath(),e(d(b)).forEach(function(b){var c=b[0],d=b.slice(1);a[f[c]].apply(a,d)}),a.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(b,a,c){a.exports=function(a){switch(a){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(b,a,c){"use strict";function d(c,g,e){var b=0|c[e];if(b<=0)return[];var a,f=new Array(b);if(e===c.length-1)for(a=0;a<b;++a)f[a]=g;else for(a=0;a<b;++a)f[a]=d(c,g,e+1);return f}a.exports=function(a,b){switch(void 0===b&&(b=0),typeof a){case"number":if(a>0)return function(c,d){var b,a;for(a=0,b=new Array(c);a<c;++a)b[a]=d;return b}(0|a,b);break;case"object":if("number"==typeof a.length)return d(a,b,0);break}return[]}},{}],129:[function(c,b,d){"use strict";function a(b,j,a){a=a||2;var d,f,k,m,h,i,n,q=j&&j.length,r=q?j[0]*a:b.length,c=e(b,0,r,a,!0),p=[];if(!c||c.next===c.prev)return p;if(q&&(c=l(b,j,c,a)),b.length>80*a){d=k=b[0],f=m=b[1];for(var o=a;o<r;o+=a)h=b[o],i=b[o+1],h<d&&(d=h),i<f&&(f=i),h>k&&(k=h),i>m&&(m=i);n=0!==(n=Math.max(k-d,m-f))?1/n:0}return g(c,p,a,d,f,n),p}function e(c,e,f,d,g){var a,b;if(g===I(c,e,f,d)>0)for(a=e;a<f;a+=d)b=F(a,c[a],c[a+1],b);else for(a=f-d;a>=e;a-=d)b=F(a,c[a],c[a+1],b);return b&&x(b,b.next)&&(G(b),b=b.next),b}function f(c,b){if(!c)return c;b||(b=c);var d,a=c;do if(d=!1,!a.steiner&&(x(a,a.next)||0===w(a.prev,a,a.next))){if(G(a),(a=b=a.prev)===a.next)break;d=!0}else a=a.next;while(d||a!==b)return b}function g(a,b,c,e,l,d,n){if(a){!n&&d&&q(a,e,l,d);for(var o,m,p=a;a.prev!==a.next;){if(o=a.prev,m=a.next,d?i(a,e,l,d):h(a)){b.push(o.i/c),b.push(a.i/c),b.push(m.i/c),G(a),a=m.next,p=m.next;continue}if((a=m)===p){n?1===n?g(a=j(f(a),b,c),b,c,e,l,d,2):2===n&&k(a,b,c,e,l,d):g(f(a),b,c,e,l,d,1);break}}}}function h(b){var c=b.prev,d=b,e=b.next;if(w(c,d,e)>=0)return!1;for(var a=b.next.next;a!==b.prev;){if(u(c.x,c.y,d.x,d.y,e.x,e.y,a.x,a.y)&&w(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function i(f,g,h,i){var d=f.prev,e=f,a=f.next;if(w(d,e,a)>=0)return!1;for(var l=d.x<e.x?d.x<a.x?d.x:a.x:e.x<a.x?e.x:a.x,m=d.y<e.y?d.y<a.y?d.y:a.y:e.y<a.y?e.y:a.y,n=d.x>e.x?d.x>a.x?d.x:a.x:e.x>a.x?e.x:a.x,o=d.y>e.y?d.y>a.y?d.y:a.y:e.y>a.y?e.y:a.y,j=s(l,m,g,h,i),k=s(n,o,g,h,i),b=f.prevZ,c=f.nextZ;b&&b.z>=j&&c&&c.z<=k;){if(b!==f.prev&&b!==f.next&&u(d.x,d.y,e.x,e.y,a.x,a.y,b.x,b.y)&&w(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,c!==f.prev&&c!==f.next&&u(d.x,d.y,e.x,e.y,a.x,a.y,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;c=c.nextZ}for(;b&&b.z>=j;){if(b!==f.prev&&b!==f.next&&u(d.x,d.y,e.x,e.y,a.x,a.y,b.x,b.y)&&w(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;c&&c.z<=k;){if(c!==f.prev&&c!==f.next&&u(d.x,d.y,e.x,e.y,a.x,a.y,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;c=c.nextZ}return!0}function j(d,e,g){var a=d;do{var c=a.prev,b=a.next.next;!x(c,b)&&y(c,a,a.next,b)&&C(c,b)&&C(b,c)&&(e.push(c.i/g),e.push(a.i/g),e.push(b.i/g),G(a),G(a.next),a=d=b),a=a.next}while(a!==d)return f(a)}function k(d,e,h,i,j,k){var a=d;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&v(a,b)){var c=E(a,b);a=f(a,a.next),c=f(c,c.next),g(a,e,h,i,j,k),g(c,e,h,i,j,k);return}b=b.next}a=a.next}while(a!==d)}function l(j,g,b,h){var a,i,k,l,c,d=[];for(a=0,i=g.length;a<i;a++)k=g[a]*h,l=a<i-1?g[a+1]*h:j.length,c=e(j,k,l,h,!1),c===c.next&&(c.steiner=!0),d.push(t(c));for(d.sort(m),a=0;a<d.length;a++)n(d[a],b),b=f(b,b.next);return b}function m(a,b){return a.x-b.x}function n(b,a){if(a=o(b,a)){var c=E(a,b);f(a,a.next),f(c,c.next)}}function o(h,k){var b,a=k,d=h.x,c=h.y,e=-1/0;do{if(c<=a.y&&c>=a.next.y&&a.next.y!==a.y){var f=a.x+(c-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(f<=d&&f>e){if(e=f,f===d){if(c===a.y)return a;if(c===a.next.y)return a.next}b=a.x<a.next.x?a:a.next}}a=a.next}while(a!==k)if(!b)return null;if(d===e)return b;var g,m=b,l=b.x,i=b.y,j=1/0;a=b;do d>=a.x&&a.x>=l&&d!==a.x&&u(c<i?d:e,c,l,i,c<i?e:d,c,a.x,a.y)&&(g=Math.abs(c-a.y)/(d-a.x),C(a,h)&&(g<j||g===j&&(a.x>b.x||a.x===b.x&&p(b,a)))&&(b=a,j=g)),a=a.next;while(a!==m)return b}function p(a,b){return 0>w(a.prev,a,b.prev)&&0>w(b.next,a,a.next)}function q(b,c,d,e){var a=b;do null===a.z&&(a.z=s(a.x,a.y,c,d,e)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==b)a.prevZ.nextZ=null,a.prevZ=null,r(a)}function r(f){var h,b,a,c,d,i,e,g,j=1;do{for(b=f,f=null,d=null,i=0;b;){for(i++,a=b,e=0,h=0;h<j&&(e++,a=a.nextZ);h++);for(g=j;e>0||g>0&&a;)0!==e&&(0===g||!a||b.z<=a.z)?(c=b,b=b.nextZ,e--):(c=a,a=a.nextZ,g--),d?d.nextZ=c:f=c,c.prevZ=d,d=c;b=a}d.nextZ=null,j*=2}while(i>1)return f}function s(a,b,d,e,c){return a=32767*(a-d)*c,b=32767*(b-e)*c,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,b=(b|b<<8)&16711935,b=(b|b<<4)&252645135,b=(b|b<<2)&858993459,b=(b|b<<1)&1431655765,a|b<<1}function t(c){var a=c,b=c;do(a.x<b.x||a.x===b.x&&a.y<b.y)&&(b=a),a=a.next;while(a!==c)return b}function u(c,d,e,f,g,h,a,b){return(g-a)*(d-b)-(c-a)*(h-b)>=0&&(c-a)*(f-b)-(e-a)*(d-b)>=0&&(e-a)*(h-b)-(g-a)*(f-b)>=0}function v(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!B(a,b)&&(C(a,b)&&C(b,a)&&D(a,b)&&(w(a.prev,a,b.prev)||w(a,b.prev,b))||x(a,b)&&w(a.prev,a,a.next)>0&&w(b.prev,b,b.next)>0)}function w(b,a,c){return(a.y-b.y)*(c.x-a.x)-(a.x-b.x)*(c.y-a.y)}function x(a,b){return a.x===b.x&&a.y===b.y}function y(a,b,c,d){var e=A(w(a,b,c)),f=A(w(a,b,d)),g=A(w(c,d,a)),h=A(w(c,d,b));return e!==f&&g!==h|| !!(0===e&&z(a,c,b))|| !!(0===f&&z(a,d,b))|| !!(0===g&&z(c,a,d))||!!(0===h&&z(c,b,d))}function z(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function A(a){return a>0?1:a<0?-1:0}function B(b,c){var a=b;do{if(a.i!==b.i&&a.next.i!==b.i&&a.i!==c.i&&a.next.i!==c.i&&y(a,a.next,b,c))return!0;a=a.next}while(a!==b)return!1}function C(a,b){return 0>w(a.prev,a,a.next)?w(a,b,a.next)>=0&&w(a,a.prev,b)>=0:0>w(a,b,a.prev)||0>w(a,a.next,b)}function D(b,e){var a=b,c=!1,f=(b.x+e.x)/2,d=(b.y+e.y)/2;do a.y>d!=a.next.y>d&&a.next.y!==a.y&&f<(a.next.x-a.x)*(d-a.y)/(a.next.y-a.y)+a.x&&(c=!c),a=a.next;while(a!==b)return c}function E(a,b){var d=new H(a.i,a.x,a.y),c=new H(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,d.next=e,e.prev=d,c.next=d,d.prev=c,f.next=c,c.prev=f,c}function F(c,d,e,b){var a=new H(c,d,e);return b?(a.next=b.next,a.prev=b,b.next.prev=a,b.next=a):(a.prev=a,a.next=a),a}function G(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function H(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(b,g,d,e){for(var f=0,a=g,c=d-e;a<d;a+=e)f+=(b[c]-b[a])*(b[a+1]+b[c+1]),c=a;return f}b.exports=a,b.exports.default=a,a.deviation=function(a,d,c,e){var i=d&&d.length,m=i?d[0]*c:a.length,f=Math.abs(I(a,0,m,c));if(i)for(var b=0,j=d.length;b<j;b++){var n=d[b]*c,o=b<j-1?d[b+1]*c:a.length;f-=Math.abs(I(a,n,o,c))}var h=0;for(b=0;b<e.length;b+=3){var g=e[b]*c,k=e[b+1]*c,l=e[b+2]*c;h+=Math.abs((a[g]-a[l])*(a[k+1]-a[g+1])-(a[g]-a[k])*(a[l+1]-a[g+1]))}return 0===f&&0===h?0:Math.abs((h-f)/f)},a.flatten=function(b){for(var f=b[0][0].length,c={vertices:[],holes:[],dimensions:f},g=0,a=0;a<b.length;a++){for(var d=0;d<b[a].length;d++)for(var e=0;e<f;e++)c.vertices.push(b[a][d][e]);a>0&&(g+=b[a-1].length,c.holes.push(g))}return c}},{}],130:[function(a,b,c){var d=a("strongly-connected-components");b.exports=function(i,j){var a,k=[],p=[],l=[],m={},b=[];function q(a){l[a]=!1,m.hasOwnProperty(a)&&Object.keys(m[a]).forEach(function(b){delete m[a][b],l[b]&&q(b)})}function n(d){var c,e,f=!1;for(p.push(d),l[d]=!0,c=0;c<b[d].length;c++)(e=b[d][c])===a?(r(a,p),f=!0):l[e]||(f=n(e));if(f)q(d);else for(c=0;c<b[d].length;c++){var g=m[e=b[d][c]];g||(g={},m[e]=g),g[e]=!0}return p.pop(),f}function r(a,b){var c=[].concat(b).concat(a);j?j(n):k.push(c)}function o(g){!function(b){for(var a=0;a<i.length;a++)a<b&&(i[a]=[]),i[a]=i[a].filter(function(a){return a>=b})}(g);for(var f,b=d(i).components.filter(function(a){return a.length>1}),e=1/0,a=0;a<b.length;a++)for(var c=0;c<b[a].length;c++)b[a][c]<e&&(e=b[a][c],f=a);var h=b[f];return!!h&&{leastVertex:e,adjList:i.map(function(a,b){return -1===h.indexOf(b)?[]:a.filter(function(a){return -1!==h.indexOf(a)})})}}a=0;for(var f=i.length;a<f;){var g=o(a);if(a=g.leastVertex,b=g.adjList){for(var c=0;c<b.length;c++)for(var e=0;e<b[c].length;e++){var h=b[c][e];l[+h]=!1,m[h]={}}n(a),a+=1}else a=f}if(!j)return k}},{"strongly-connected-components":307}],131:[function(a,b,c){"use strict";var d=a("../../object/valid-value");b.exports=function(){return d(this).length=0,this}},{"../../object/valid-value":162}],132:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Array.from:a("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(b,a,c){"use strict";a.exports=function(){var b,a,c=Array.from;return"function"==typeof c&&Boolean((a=c(b=["raz","dwa"]))&&a!==b&&"dwa"===a[1])}},{}],134:[function(a,b,c){"use strict";var d=a("es6-symbol").iterator,e=a("../../function/is-arguments"),f=a("../../function/is-function"),g=a("../../number/to-pos-integer"),h=a("../../object/valid-callable"),i=a("../../object/valid-value"),j=a("../../object/is-value"),k=a("../../string/is-string"),l=Array.isArray,m=Function.prototype.call,n={configurable:!0,enumerable:!0,writable:!0,value:null},o=Object.defineProperty;b.exports=function(b){var r,a,t,c,q,x,v,u,y,p,s=arguments[1],w=arguments[2];if(b=Object(i(b)),j(s)&&h(s),this&&this!==Array&&f(this))r=this;else{if(!s){if(e(b))return 1!==(q=b.length)?Array.apply(null,b):((c=new Array(1))[0]=b[0],c);if(l(b)){for(a=0,c=new Array(q=b.length);a<q;++a)c[a]=b[a];return c}}c=[]}if(!l(b)){if(void 0!==(y=b[d])){for(v=h(y).call(b),r&&(c=new r),u=v.next(),a=0;!u.done;)p=s?m.call(s,w,u.value,a):u.value,r?(n.value=p,o(c,a,n)):c[a]=p,u=v.next(),++a;q=a}else if(k(b)){for(q=b.length,r&&(c=new r),a=0,t=0;a<q;++a)p=b[a],a+1<q&&(x=p.charCodeAt(0))>=55296&&x<=56319&&(p+=b[++a]),p=s?m.call(s,w,p,t):p,r?(n.value=p,o(c,t,n)):c[t]=p,++t;q=t}}if(void 0===q)for(q=g(b.length),r&&(c=new r(q)),a=0;a<q;++a)p=s?m.call(s,w,b[a],a):b[a],r?(n.value=p,o(c,a,n)):c[a]=p;return r&&(n.value=null,c.length=q),c}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(c,a,d){"use strict";var b=Object.prototype.toString,e=b.call(function(){return arguments}());a.exports=function(a){return b.call(a)===e}},{}],136:[function(b,a,c){"use strict";var d=Object.prototype.toString,e=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);a.exports=function(a){return"function"==typeof a&&e(d.call(a))}},{}],137:[function(b,a,c){"use strict";a.exports=function(){}},{}],138:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Math.sign:a("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(b,a,c){"use strict";a.exports=function(){var a=Math.sign;return"function"==typeof a&&1===a(10)&& -1===a(-20)}},{}],140:[function(b,a,c){"use strict";a.exports=function(a){return isNaN(a=Number(a))||0===a?a:a>0?1:-1}},{}],141:[function(a,b,c){"use strict";var d=a("../math/sign"),e=Math.abs,f=Math.floor;b.exports=function(a){return isNaN(a)?0:0!==(a=Number(a))&&isFinite(a)?d(a)*f(e(a)):a}},{"../math/sign":138}],142:[function(a,b,c){"use strict";var d=a("./to-integer"),e=Math.max;b.exports=function(a){return e(0,d(a))}},{"./to-integer":141}],143:[function(a,b,c){"use strict";var d=a("./valid-callable"),e=a("./valid-value"),f=Function.prototype.bind,g=Function.prototype.call,h=Object.keys,i=Object.prototype.propertyIsEnumerable;b.exports=function(a,b){return function(c,l){var j,m=arguments[2],k=arguments[3];return c=Object(e(c)),d(l),j=h(c),k&&j.sort("function"==typeof k?f.call(k,c):void 0),"function"!=typeof a&&(a=j[a]),g.call(a,j,function(a,d){return i.call(c,a)?g.call(l,m,c[a],a,c,d):b})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Object.assign:a("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(b,a,c){"use strict";a.exports=function(){var a,b=Object.assign;return"function"==typeof b&&(b(a={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),a.foo+a.bar+a.trzy==="razdwatrzy")}},{}],146:[function(a,b,c){"use strict";var d=a("../keys"),e=a("../valid-value"),f=Math.max;b.exports=function(b,c){var g,a,h,i=f(arguments.length,2);for(a=1,b=Object(e(b)),h=function(a){try{b[a]=c[a]}catch(d){g||(g=d)}};a<i;++a)c=arguments[a],d(c).forEach(h);if(void 0!==g)throw g;return b}},{"../keys":152,"../valid-value":162}],147:[function(a,b,c){"use strict";var d=a("../array/from"),e=a("./assign"),f=a("./valid-value");b.exports=function(a){var c=Object(f(a)),b=arguments[1],h=Object(arguments[2]);if(c!==a&&!b)return c;var g={};return b?d(b,function(b){(h.ensure||b in a)&&(g[b]=a[b])}):e(g,a),g}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(c,f,h){"use strict";var a,b,d,g,e=Object.create;c("./set-prototype-of/is-implemented")()||(a=c("./set-prototype-of/shim")),f.exports=a?1!==a.level?e:(b={},d={},g={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if("__proto__"===a){d[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}d[a]=g}),Object.defineProperties(b,d),Object.defineProperty(a,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:b}),function(a,c){return e(null===a?b:a,c)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(a,b,c){"use strict";b.exports=a("./_iterate")("forEach")},{"./_iterate":143}],150:[function(a,b,c){"use strict";var d=a("./is-value"),e={function:!0,object:!0};b.exports=function(a){return d(a)&&e[typeof a]||!1}},{"./is-value":151}],151:[function(a,b,c){"use strict";var d=a("../function/noop")();b.exports=function(a){return a!==d&&null!==a}},{"../function/noop":137}],152:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Object.keys:a("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(b,a,c){"use strict";a.exports=function(){try{return Object.keys("primitive"),!0}catch(a){return!1}}},{}],154:[function(a,b,c){"use strict";var d=a("../is-value"),e=Object.keys;b.exports=function(a){return e(d(a)?Object(a):a)}},{"../is-value":151}],155:[function(a,b,c){"use strict";var d=a("./valid-callable"),e=a("./for-each"),f=Function.prototype.call;b.exports=function(a,b){var c={},g=arguments[2];return d(b),e(a,function(d,a,e,h){c[a]=f.call(b,g,d,a,e,h)}),c}},{"./for-each":149,"./valid-callable":160}],156:[function(a,b,c){"use strict";var d=a("./is-value"),e=Array.prototype.forEach,f=Object.create,g=function(b,c){var a;for(a in b)c[a]=b[a]};b.exports=function(b){var a=f(null);return e.call(arguments,function(b){d(b)&&g(Object(b),a)}),a}},{"./is-value":151}],157:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?Object.setPrototypeOf:a("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(b,a,c){"use strict";var d=Object.create,e=Object.getPrototypeOf,f={};a.exports=function(){var a=Object.setPrototypeOf,b=arguments[0]||d;return"function"==typeof a&&e(a(b(null),f))===f}},{}],159:[function(c,d,g){"use strict";var e,a,b,f,h=c("../is-object"),i=c("../valid-value"),j=Object.prototype.isPrototypeOf,k=Object.defineProperty,l={configurable:!0,enumerable:!1,writable:!0,value:void 0};e=function(a,b){if(i(a),null===b||h(b))return a;throw new TypeError("Prototype must be null or an object")},d.exports=(a=function(){var c,a=Object.create(null),b={},d=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(d){try{(c=d.set).call(a,b)}catch(e){}if(Object.getPrototypeOf(a)===b)return{set:c,level:2}}return(a.__proto__=b,Object.getPrototypeOf(a)===b)?{level:2}:((a={}).__proto__=b,Object.getPrototypeOf(a)===b&&{level:1})}())?(2===a.level?a.set?(f=a.set,b=function(a,b){return f.call(e(a,b),b),a}):b=function(a,b){return e(a,b).__proto__=b,a}:b=function a(b,c){var d;return e(b,c),(d=j.call(a.nullPolyfill,b))&&delete a.nullPolyfill.__proto__,null===c&&(c=a.nullPolyfill),b.__proto__=c,d&&k(a.nullPolyfill,"__proto__",l),b},Object.defineProperty(b,"level",{configurable:!1,enumerable:!1,writable:!1,value:a.level})):null,c("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(b,a,c){"use strict";a.exports=function(a){if("function"!=typeof a)throw new TypeError(a+" is not a function");return a}},{}],161:[function(a,b,c){"use strict";var d=a("./is-object");b.exports=function(a){if(!d(a))throw new TypeError(a+" is not an Object");return a}},{"./is-object":150}],162:[function(a,b,c){"use strict";var d=a("./is-value");b.exports=function(a){if(!d(a))throw new TypeError("Cannot use null or undefined");return a}},{"./is-value":151}],163:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?String.prototype.contains:a("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(b,a,c){"use strict";var d="razdwatrzy";a.exports=function(){return"function"==typeof d.contains&& !0===d.contains("dwa")&& !1===d.contains("foo")}},{}],165:[function(b,a,c){"use strict";var d=String.prototype.indexOf;a.exports=function(a){return d.call(this,a,arguments[1])> -1}},{}],166:[function(c,a,d){"use strict";var b=Object.prototype.toString,e=b.call("");a.exports=function(a){return"string"==typeof a||a&&"object"==typeof a&&(a instanceof String||b.call(a)===e)||!1}},{}],167:[function(b,a,c){"use strict";var d=Object.create(null),e=Math.random;a.exports=function(){var a;do a=e().toString(36).slice(2);while(d[a])return a}},{}],168:[function(a,f,i){"use strict";var b,c=a("es5-ext/object/set-prototype-of"),j=a("es5-ext/string/#/contains"),d=a("d"),g=a("es6-symbol"),e=a("./"),h=Object.defineProperty;b=f.exports=function(c,a){if(!(this instanceof b))throw new TypeError("Constructor requires 'new'");e.call(this,c),h(this,"__kind__",d("",a=a?j.call(a,"key+value")?"key+value":j.call(a,"key")?"key":"value":"value"))},c&&c(b,e),delete b.prototype.constructor,b.prototype=Object.create(e.prototype,{_resolve:d(function(a){return"value"===this.__kind__?this.__list__[a]:"key+value"===this.__kind__?[a,this.__list__[a]]:a})}),h(b.prototype,g.toStringTag,d("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(a,b,c){"use strict";var d=a("es5-ext/function/is-arguments"),e=a("es5-ext/object/valid-callable"),f=a("es5-ext/string/is-string"),g=a("./get"),h=Array.isArray,i=Function.prototype.call,j=Array.prototype.some;b.exports=function(a,m){var c,k,n,p,b,o,l,q,r=arguments[2];if(h(a)||d(a)?c="array":f(a)?c="string":a=g(a),e(m),n=function(){p=!0},"array"===c){j.call(a,function(a){return i.call(m,r,a,n),p});return}if("string"===c){for(b=0,o=a.length;b<o&&(l=a[b],b+1<o&&(q=l.charCodeAt(0))>=55296&&q<=56319&&(l+=a[++b]),i.call(m,r,l,n),!p);++b);return}for(k=a.next();!k.done;){if(i.call(m,r,k.value,n),p)return;k=a.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(a,b,c){"use strict";var d=a("es5-ext/function/is-arguments"),e=a("es5-ext/string/is-string"),f=a("./array"),g=a("./string"),h=a("./valid-iterable"),i=a("es6-symbol").iterator;b.exports=function(a){return"function"==typeof h(a)[i]?a[i]():d(a)?new f(a):e(a)?new g(a):new f(a)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(b,d,j){"use strict";var c,k=b("es5-ext/array/#/clear"),e=b("es5-ext/object/assign"),l=b("es5-ext/object/valid-callable"),m=b("es5-ext/object/valid-value"),a=b("d"),f=b("d/auto-bind"),g=b("es6-symbol"),h=Object.defineProperty,i=Object.defineProperties;d.exports=c=function(d,b){if(!(this instanceof c))throw new TypeError("Constructor requires 'new'");i(this,{__list__:a("w",m(d)),__context__:a("w",b),__nextIndex__:a("w",0)}),b&&(l(b.on),b.on("_add",this._onAdd),b.on("_delete",this._onDelete),b.on("_clear",this._onClear))},delete c.prototype.constructor,i(c.prototype,e({_next:a(function(){var a;if(this.__list__){if(this.__redo__&& void 0!==(a=this.__redo__.shift()))return a;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:a(function(){return this._createResult(this._next())}),_createResult:a(function(a){return void 0===a?{done:!0,value:void 0}:{done:!1,value:this._resolve(a)}}),_resolve:a(function(a){return this.__list__[a]}),_unBind:a(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:a(function(){return"[object "+(this[g.toStringTag]||"Object")+"]"})},f({_onAdd:a(function(b){if(!(b>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){h(this,"__redo__",a("c",[b]));return}this.__redo__.forEach(function(a,c){a>=b&&(this.__redo__[c]=++a)},this),this.__redo__.push(b)}}),_onDelete:a(function(a){var b;!(a>=this.__nextIndex__)&&(--this.__nextIndex__,this.__redo__&&(-1!==(b=this.__redo__.indexOf(a))&&this.__redo__.splice(b,1),this.__redo__.forEach(function(b,c){b>a&&(this.__redo__[c]=--b)},this)))}),_onClear:a(function(){this.__redo__&&k.call(this.__redo__),this.__nextIndex__=0})}))),h(c.prototype,g.iterator,a(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(a,b,c){"use strict";var d=a("es5-ext/function/is-arguments"),e=a("es5-ext/object/is-value"),f=a("es5-ext/string/is-string"),g=a("es6-symbol").iterator,h=Array.isArray;b.exports=function(a){return!!e(a)&&(!!h(a)|| !!f(a)|| !!d(a)||"function"==typeof a[g])}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(b,f,i){"use strict";var a,d=b("es5-ext/object/set-prototype-of"),c=b("d"),g=b("es6-symbol"),e=b("./"),h=Object.defineProperty;a=f.exports=function(b){if(!(this instanceof a))throw new TypeError("Constructor requires 'new'");b=String(b),e.call(this,b),h(this,"__length__",c("",b.length))},d&&d(a,e),delete a.prototype.constructor,a.prototype=Object.create(e.prototype,{_next:c(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:c(function(c){var b,a=this.__list__[c];return this.__nextIndex__===this.__length__?a:(b=a.charCodeAt(0))>=55296&&b<=56319?a+this.__list__[this.__nextIndex__++]:a})}),h(a.prototype,g.toStringTag,c("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(a,b,c){"use strict";var d=a("./is-iterable");b.exports=function(a){if(!d(a))throw new TypeError(a+" is not iterable");return a}},{"./is-iterable":172}],175:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?a("ext/global-this").Symbol:a("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(a,b,c){"use strict";var d=a("ext/global-this"),e={object:!0,symbol:!0};b.exports=function(){var b,a=d.Symbol;if("function"!=typeof a)return!1;b=a("test symbol");try{String(b)}catch(c){return!1}return!!e[typeof a.iterator]&& !!e[typeof a.toPrimitive]&&!!e[typeof a.toStringTag]}},{"ext/global-this":188}],177:[function(b,a,c){"use strict";a.exports=function(a){return!!a&&("symbol"==typeof a|| !!a.constructor&&"Symbol"===a.constructor.name&&"Symbol"===a[a.constructor.toStringTag])}},{}],178:[function(a,b,d){"use strict";var e=a("d"),c=Object.create,f=Object.defineProperty,g=Object.prototype,h=c(null);b.exports=function(a){for(var c,d,b=0;h[a+(b||"")];)++b;return h[a+=b||""]=!0,f(g,c="@@"+a,e.gs(null,function(a){d||(d=!0,f(this,c,e(a)),d=!1)})),c}},{d:106}],179:[function(a,b,c){"use strict";var d=a("d"),e=a("ext/global-this").Symbol;b.exports=function(a){return Object.defineProperties(a,{hasInstance:d("",e&&e.hasInstance||a("hasInstance")),isConcatSpreadable:d("",e&&e.isConcatSpreadable||a("isConcatSpreadable")),iterator:d("",e&&e.iterator||a("iterator")),match:d("",e&&e.match||a("match")),replace:d("",e&&e.replace||a("replace")),search:d("",e&&e.search||a("search")),species:d("",e&&e.species||a("species")),split:d("",e&&e.split||a("split")),toPrimitive:d("",e&&e.toPrimitive||a("toPrimitive")),toStringTag:d("",e&&e.toStringTag||a("toStringTag")),unscopables:d("",e&&e.unscopables||a("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(a,b,c){"use strict";var d=a("d"),e=a("../../../validate-symbol"),f=Object.create(null);b.exports=function(a){return Object.defineProperties(a,{for:d(function(b){return f[b]?f[b]:f[b]=a(String(b))}),keyFor:d(function(b){var a;for(a in e(b),f)if(f[a]===b)return a})})}},{"../../../validate-symbol":182,d:106}],181:[function(c,h,l){"use strict";var a,d,i,b=c("d"),m=c("./validate-symbol"),f=c("ext/global-this").Symbol,n=c("./lib/private/generate-name"),j=c("./lib/private/setup/standard-symbols"),k=c("./lib/private/setup/symbol-registry"),o=Object.create,g=Object.defineProperties,e=Object.defineProperty;if("function"==typeof f)try{String(f()),i=!0}catch(p){}else f=null;d=function(b){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return a(b)},h.exports=a=function c(a){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return i?f(a):g(o(d.prototype),{__description__:b("",a=void 0===a?"":String(a)),__name__:b("",n(a))})},j(a),k(a),g(d.prototype,{constructor:b(a),toString:b("",function(){return this.__name__})}),g(a.prototype,{toString:b(function(){return"Symbol ("+m(this).__description__+")"}),valueOf:b(function(){return m(this)})}),e(a.prototype,a.toPrimitive,b("",function(){var a=m(this);return"symbol"==typeof a?a:a.toString()})),e(a.prototype,a.toStringTag,b("c","Symbol")),e(d.prototype,a.toStringTag,b("c",a.prototype[a.toStringTag])),e(d.prototype,a.toPrimitive,b("c",a.prototype[a.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(a,b,c){"use strict";var d=a("./is-symbol");b.exports=function(a){if(!d(a))throw new TypeError(a+" is not a symbol");return a}},{"./is-symbol":177}],183:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?WeakMap:a("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(b,a,c){"use strict";a.exports=function(){var a,b;if("function"!=typeof WeakMap)return!1;try{a=new WeakMap([[b={},"one"],[{},"two"],[{},"three"]])}catch(c){return!1}return"[object WeakMap]"===String(a)&&"function"==typeof a.set&&a.set({},1)===a&&"function"==typeof a.delete&&"function"==typeof a.has&&"one"===a.get(b)}},{}],185:[function(b,a,c){"use strict";a.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],186:[function(a,e,i){"use strict";var c,j=a("es5-ext/object/is-value"),d=a("es5-ext/object/set-prototype-of"),k=a("es5-ext/object/valid-object"),l=a("es5-ext/object/valid-value"),m=a("es5-ext/string/random-uniq"),b=a("d"),n=a("es6-iterator/get"),o=a("es6-iterator/for-of"),f=a("es6-symbol").toStringTag,g=a("./is-native-implemented"),p=Array.isArray,h=Object.defineProperty,q=Object.prototype.hasOwnProperty,r=Object.getPrototypeOf;e.exports=c=function(){var e,a=arguments[0];if(!(this instanceof c))throw new TypeError("Constructor requires 'new'");return e=g&&d&&WeakMap!==c?d(new WeakMap,r(this)):this,j(a)&&(p(a)||(a=n(a))),h(e,"__weakMapData__",b("c","$weakMap$"+m())),a&&o(a,function(a){l(a),e.set(a[0],a[1])}),e},g&&(d&&d(c,WeakMap),c.prototype=Object.create(WeakMap.prototype,{constructor:b(c)})),Object.defineProperties(c.prototype,{delete:b(function(a){return!!q.call(k(a),this.__weakMapData__)&&(delete a[this.__weakMapData__],!0)}),get:b(function(a){if(q.call(k(a),this.__weakMapData__))return a[this.__weakMapData__]}),has:b(function(a){return q.call(k(a),this.__weakMapData__)}),set:b(function(a,c){return h(k(a),this.__weakMapData__,b("c",c)),this}),toString:b(function(){return"[object WeakMap]"})}),h(c.prototype,f,b("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(b,a,c){var d=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};a.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(a){return d()}try{if(!__global__)return d();return __global__}finally{delete Object.prototype.__global__}}()},{}],188:[function(a,b,c){"use strict";b.exports=a("./is-implemented")()?globalThis:a("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(b,a,c){"use strict";a.exports=function(){return"object"==typeof globalThis&& !!globalThis&&globalThis.Array===Array}},{}],190:[function(a,b,c){"use strict";var d=a("is-string-blank");b.exports=function(a){var b=typeof a;if("string"===b){var c=a;if(0==(a=+a)&&d(c))return!1}else if("number"!==b)return!1;return a-a<1}},{"is-string-blank":237}],191:[function(a,b,c){var d=a("dtype");b.exports=function(a,b,c){if(!a)throw new TypeError("must specify data as first parameter");if(c=0| +(c||0),Array.isArray(a)&&a[0]&&"number"==typeof a[0][0]){var e,g,f,k,h=a[0].length,i=a.length*h;b&&"string"!=typeof b||(b=new(d(b||"float32"))(i+c));var l=b.length-c;if(i!==l)throw new Error("source length "+i+" ("+h+"x"+a.length+") does not match destination length "+l);for(e=0,f=c;e<a.length;e++)for(g=0;g<h;g++)b[f++]=null===a[e][g]?NaN:a[e][g]}else if(b&&"string"!=typeof b)b.set(a,c);else{var j=d(b||"float32");if(Array.isArray(a)||"array"===b)for(e=0,b=new j(a.length+c),f=c,k=b.length;f<k;f++,e++)b[f]=null===a[e]?NaN:a[e];else 0===c?b=new j(a):(b=new j(a.length+c)).set(a,c)}return b}},{dtype:127}],192:[function(a,b,c){"use strict";var d=a("css-font/stringify"),e=[32,126];b.exports=function(a){var i=(a=a||{}).shape?a.shape:a.canvas?[a.canvas.width,a.canvas.height]:[512,512],g=a.canvas||document.createElement("canvas"),j=a.font,h="number"==typeof a.step?[a.step,a.step]:a.step||[32,32],b=a.chars||e;if(j&&"string"!=typeof j&&(j=d(j)),Array.isArray(b)){if(2===b.length&&"number"==typeof b[0]&&"number"==typeof b[1]){for(var l=[],c=b[0],n=0;c<=b[1];c++)l[n++]=String.fromCharCode(c);b=l}}else b=String(b).split("");i=i.slice(),g.width=i[0],g.height=i[1];var f=g.getContext("2d");f.fillStyle="#000",f.fillRect(0,0,g.width,g.height),f.font=j,f.textAlign="center",f.textBaseline="middle",f.fillStyle="#fff";for(var k=h[0]/2,m=h[1]/2,c=0;c<b.length;c++)f.fillText(b[c],k,m),(k+=h[0])>i[0]-h[0]/2&&(k=h[0]/2,m+=h[1]);return g}},{"css-font/stringify":102}],193:[function(c,b,d){"use strict";function a(k,d){d||(d={}),("string"==typeof k||Array.isArray(k))&&(d.family=k);var j=Array.isArray(d.family)?d.family.join(", "):d.family;if(!j)throw Error("`family` must be defined");var l=d.size||d.fontSize||d.em||48,q=d.weight||d.fontWeight||"",r=d.style||d.fontStyle||"",k=[r,q,l].join(" ")+"px "+j,o=d.origin||"top";if(a.cache[j]&&l<=a.cache[j].em)return e(a.cache[j],o);var n=d.canvas||a.canvas,c=n.getContext("2d"),i={upper:void 0!==d.upper?d.upper:"H",lower:void 0!==d.lower?d.lower:"x",descent:void 0!==d.descent?d.descent:"p",ascent:void 0!==d.ascent?d.ascent:"h",tittle:void 0!==d.tittle?d.tittle:"i",overshoot:void 0!==d.overshoot?d.overshoot:"O"},b=Math.ceil(1.5*l);n.height=b,n.width=.5*b,c.font=k;var h={top:0};c.clearRect(0,0,b,b),c.textBaseline="top",c.fillStyle="black",c.fillText("H",0,0);var m=f(c.getImageData(0,0,b,b));c.clearRect(0,0,b,b),c.textBaseline="bottom",c.fillText("H",0,b);var s=f(c.getImageData(0,0,b,b));h.lineHeight=h.bottom=b-s+m,c.clearRect(0,0,b,b),c.textBaseline="alphabetic",c.fillText("H",0,b);var t=f(c.getImageData(0,0,b,b)),p=b-t-1+m;h.baseline=h.alphabetic=p,c.clearRect(0,0,b,b),c.textBaseline="middle",c.fillText("H",0,.5*b);var u=f(c.getImageData(0,0,b,b));h.median=h.middle=b-u-1+m-.5*b,c.clearRect(0,0,b,b),c.textBaseline="hanging",c.fillText("H",0,.5*b);var v=f(c.getImageData(0,0,b,b));h.hanging=b-v-1+m-.5*b,c.clearRect(0,0,b,b),c.textBaseline="ideographic",c.fillText("H",0,b);var w=f(c.getImageData(0,0,b,b));if(h.ideographic=b-w-1+m,i.upper&&(c.clearRect(0,0,b,b),c.textBaseline="top",c.fillText(i.upper,0,0),h.upper=f(c.getImageData(0,0,b,b)),h.capHeight=h.baseline-h.upper),i.lower&&(c.clearRect(0,0,b,b),c.textBaseline="top",c.fillText(i.lower,0,0),h.lower=f(c.getImageData(0,0,b,b)),h.xHeight=h.baseline-h.lower),i.tittle&&(c.clearRect(0,0,b,b),c.textBaseline="top",c.fillText(i.tittle,0,0),h.tittle=f(c.getImageData(0,0,b,b))),i.ascent&&(c.clearRect(0,0,b,b),c.textBaseline="top",c.fillText(i.ascent,0,0),h.ascent=f(c.getImageData(0,0,b,b))),i.descent&&(c.clearRect(0,0,b,b),c.textBaseline="top",c.fillText(i.descent,0,0),h.descent=g(c.getImageData(0,0,b,b))),i.overshoot){c.clearRect(0,0,b,b),c.textBaseline="top",c.fillText(i.overshoot,0,0);var x=g(c.getImageData(0,0,b,b));h.overshoot=x-p}for(var y in h)h[y]/=l;return h.em=l,a.cache[j]=h,e(h,o)}function e(b,a){var d={};for(var c in"string"==typeof a&&(a=b[a]),b)"em"!==c&&(d[c]=b[c]-a);return d}function f(b){for(var d=b.height,c=b.data,a=3;a<c.length;a+=4)if(0!==c[a])return Math.floor((a-3)*.25/d)}function g(b){for(var d=b.height,c=b.data,a=c.length-1;a>0;a-=4)if(0!==c[a])return Math.floor((a-3)*.25/d)}b.exports=a,a.canvas=document.createElement("canvas"),a.cache={}},{}],194:[function(b,a,c){a.exports=function(b,a){if("string"!=typeof b)throw new TypeError("must specify type string");if(a=a||{},"undefined"==typeof document&&!a.canvas)return null;var c,d=a.canvas||document.createElement("canvas");"number"==typeof a.width&&(d.width=a.width),"number"==typeof a.height&&(d.height=a.height);var g=a;try{var e=[b];0===b.indexOf("webgl")&&e.push("experimental-"+b);for(var f=0;f<e.length;f++)if(c=d.getContext(e[f],g))return c}catch(h){c=null}return c||null}},{}],195:[function(b,a,c){a.exports=function(i,j){var o=j[0],k=j[1],a=j[2],b=j[3],p=j[4],l=j[5],c=j[6],d=j[7],q=j[8],m=j[9],e=j[10],f=j[11],r=j[12],n=j[13],g=j[14],h=j[15];return i[0]=l*(e*h-f*g)-m*(c*h-d*g)+n*(c*f-d*e),i[1]=-(k*(e*h-f*g)-m*(a*h-b*g)+n*(a*f-b*e)),i[2]=k*(c*h-d*g)-l*(a*h-b*g)+n*(a*d-b*c),i[3]=-(k*(c*f-d*e)-l*(a*f-b*e)+m*(a*d-b*c)),i[4]=-(p*(e*h-f*g)-q*(c*h-d*g)+r*(c*f-d*e)),i[5]=o*(e*h-f*g)-q*(a*h-b*g)+r*(a*f-b*e),i[6]=-(o*(c*h-d*g)-p*(a*h-b*g)+r*(a*d-b*c)),i[7]=o*(c*f-d*e)-p*(a*f-b*e)+q*(a*d-b*c),i[8]=p*(m*h-f*n)-q*(l*h-d*n)+r*(l*f-d*m),i[9]=-(o*(m*h-f*n)-q*(k*h-b*n)+r*(k*f-b*m)),i[10]=o*(l*h-d*n)-p*(k*h-b*n)+r*(k*d-b*l),i[11]=-(o*(l*f-d*m)-p*(k*f-b*m)+q*(k*d-b*l)),i[12]=-(p*(m*g-e*n)-q*(l*g-c*n)+r*(l*e-c*m)),i[13]=o*(m*g-e*n)-q*(k*g-a*n)+r*(k*e-a*m),i[14]=-(o*(l*g-c*n)-p*(k*g-a*n)+r*(k*c-a*l)),i[15]=o*(l*e-c*m)-p*(k*e-a*m)+q*(k*c-a*l),i}},{}],196:[function(b,a,c){a.exports=function(b){var a=new Float32Array(16);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}},{}],197:[function(b,a,c){a.exports=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}},{}],198:[function(b,a,c){a.exports=function(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],199:[function(b,a,c){a.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15];return(b*g-c*f)*(l*q-m*p)-(b*h-d*f)*(k*q-m*o)+(b*i-e*f)*(k*p-l*o)+(c*h-d*g)*(j*q-m*n)-(c*i-e*g)*(j*p-l*n)+(d*i-e*h)*(j*o-k*n)}},{}],200:[function(b,a,c){a.exports=function(a,c){var f=c[0],d=c[1],b=c[2],g=c[3],e=f+f,h=d+d,i=b+b,j=f*e,k=d*e,l=d*h,m=b*e,n=b*h,o=b*i,p=g*e,q=g*h,r=g*i;return a[0]=1-l-o,a[1]=k+r,a[2]=m-q,a[3]=0,a[4]=k-r,a[5]=1-j-o,a[6]=n+p,a[7]=0,a[8]=m+q,a[9]=n-p,a[10]=1-j-l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],201:[function(b,a,c){a.exports=function(a,j,i){var f,g,e,b=i[0],c=i[1],d=i[2],h=Math.sqrt(b*b+c*c+d*d);return 1e-6>Math.abs(h)?null:(b*=h=1/h,c*=h,d*=h,f=Math.sin(j),g=Math.cos(j),e=1-g,a[0]=b*b*e+g,a[1]=c*b*e+d*f,a[2]=d*b*e-c*f,a[3]=0,a[4]=b*c*e-d*f,a[5]=c*c*e+g,a[6]=d*c*e+b*f,a[7]=0,a[8]=b*d*e+c*f,a[9]=c*d*e-b*f,a[10]=d*d*e+g,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}},{}],202:[function(b,a,c){a.exports=function(a,c,f){var b=c[0],d=c[1],g=c[2],h=c[3],j=b+b,i=d+d,e=g+g,k=b*j,l=b*i,m=b*e,n=d*i,o=d*e,p=g*e,q=h*j,r=h*i,s=h*e;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=f[0],a[13]=f[1],a[14]=f[2],a[15]=1,a}},{}],203:[function(b,a,c){a.exports=function(a,b){return a[0]=b[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=b[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],204:[function(b,a,c){a.exports=function(a,b){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,a}},{}],205:[function(b,a,c){a.exports=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d,a[6]=c,a[7]=0,a[8]=0,a[9]=-c,a[10]=d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],206:[function(b,a,c){a.exports=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=0,a[2]=-c,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=c,a[9]=0,a[10]=d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],207:[function(b,a,c){a.exports=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=0,a[4]=-c,a[5]=d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],208:[function(b,a,c){a.exports=function(a,d,e,f,g,b,c){var h=1/(e-d),i=1/(g-f),j=1/(b-c);return a[0]=2*b*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*b*i,a[6]=0,a[7]=0,a[8]=(e+d)*h,a[9]=(g+f)*i,a[10]=(c+b)*j,a[11]=-1,a[12]=0,a[13]=0,a[14]=c*b*2*j,a[15]=0,a}},{}],209:[function(b,a,c){a.exports=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],210:[function(a,b,c){b.exports={create:a("./create"),clone:a("./clone"),copy:a("./copy"),identity:a("./identity"),transpose:a("./transpose"),invert:a("./invert"),adjoint:a("./adjoint"),determinant:a("./determinant"),multiply:a("./multiply"),translate:a("./translate"),scale:a("./scale"),rotate:a("./rotate"),rotateX:a("./rotateX"),rotateY:a("./rotateY"),rotateZ:a("./rotateZ"),fromRotation:a("./fromRotation"),fromRotationTranslation:a("./fromRotationTranslation"),fromScaling:a("./fromScaling"),fromTranslation:a("./fromTranslation"),fromXRotation:a("./fromXRotation"),fromYRotation:a("./fromYRotation"),fromZRotation:a("./fromZRotation"),fromQuat:a("./fromQuat"),frustum:a("./frustum"),perspective:a("./perspective"),perspectiveFromFieldOfView:a("./perspectiveFromFieldOfView"),ortho:a("./ortho"),lookAt:a("./lookAt"),str:a("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(b,a,c){a.exports=function(b,c){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14],s=c[15],t=d*i-e*h,u=d*j-f*h,v=d*k-g*h,w=e*j-f*i,x=e*k-g*i,y=f*k-g*j,z=l*q-m*p,A=l*r-n*p,B=l*s-o*p,C=m*r-n*q,D=m*s-o*q,E=n*s-o*r,a=t*E-u*D+v*C+w*B-x*A+y*z;return a?(a=1/a,b[0]=(i*E-j*D+k*C)*a,b[1]=(f*D-e*E-g*C)*a,b[2]=(q*y-r*x+s*w)*a,b[3]=(n*x-m*y-o*w)*a,b[4]=(j*B-h*E-k*A)*a,b[5]=(d*E-f*B+g*A)*a,b[6]=(r*v-p*y-s*u)*a,b[7]=(l*y-n*v+o*u)*a,b[8]=(h*D-i*B+k*z)*a,b[9]=(e*B-d*D-g*z)*a,b[10]=(p*x-q*v+s*t)*a,b[11]=(m*v-l*x-o*t)*a,b[12]=(i*A-h*C-j*z)*a,b[13]=(d*C-e*A+f*z)*a,b[14]=(q*u-p*w-r*t)*a,b[15]=(l*w-m*u+n*t)*a,b):null}},{}],212:[function(a,b,c){var d=a("./identity");b.exports=function(a,p,q,r){var f,g,h,j,k,l,c,e,i,b,m=p[0],n=p[1],o=p[2],s=r[0],t=r[1],u=r[2],v=q[0],w=q[1],x=q[2];return 1e-6>Math.abs(m-v)&&1e-6>Math.abs(n-w)&&1e-6>Math.abs(o-x)?d(a):(c=m-v,e=n-w,c*=b=1/Math.sqrt(c*c+e*e+(i=o-x)*i),e*=b,i*=b,f=t*i-u*e,g=u*c-s*i,h=s*e-t*c,b=Math.sqrt(f*f+g*g+h*h),b?(f*=b=1/b,g*=b,h*=b):(f=0,g=0,h=0),j=e*h-i*g,k=i*f-c*h,l=c*g-e*f,b=Math.sqrt(j*j+k*k+l*l),b?(j*=b=1/b,k*=b,l*=b):(j=0,k=0,l=0),a[0]=f,a[1]=j,a[2]=c,a[3]=0,a[4]=g,a[5]=k,a[6]=e,a[7]=0,a[8]=h,a[9]=l,a[10]=i,a[11]=0,a[12]=-(f*m+g*n+h*o),a[13]=-(j*m+k*n+l*o),a[14]=-(c*m+e*n+i*o),a[15]=1,a)}},{"./identity":209}],213:[function(b,a,c){a.exports=function(e,f,g){var h=f[0],i=f[1],j=f[2],k=f[3],l=f[4],m=f[5],n=f[6],o=f[7],p=f[8],q=f[9],r=f[10],s=f[11],t=f[12],u=f[13],v=f[14],w=f[15],a=g[0],b=g[1],c=g[2],d=g[3];return e[0]=a*h+b*l+c*p+d*t,e[1]=a*i+b*m+c*q+d*u,e[2]=a*j+b*n+c*r+d*v,e[3]=a*k+b*o+c*s+d*w,a=g[4],b=g[5],c=g[6],d=g[7],e[4]=a*h+b*l+c*p+d*t,e[5]=a*i+b*m+c*q+d*u,e[6]=a*j+b*n+c*r+d*v,e[7]=a*k+b*o+c*s+d*w,a=g[8],b=g[9],c=g[10],d=g[11],e[8]=a*h+b*l+c*p+d*t,e[9]=a*i+b*m+c*q+d*u,e[10]=a*j+b*n+c*r+d*v,e[11]=a*k+b*o+c*s+d*w,a=g[12],b=g[13],c=g[14],d=g[15],e[12]=a*h+b*l+c*p+d*t,e[13]=a*i+b*m+c*q+d*u,e[14]=a*j+b*n+c*r+d*v,e[15]=a*k+b*o+c*s+d*w,e}},{}],214:[function(b,a,c){a.exports=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a}},{}],215:[function(b,a,c){a.exports=function(a,f,g,b,c){var d=1/Math.tan(f/2),e=1/(b-c);return a[0]=d/g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(c+b)*e,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*c*b*e,a[15]=0,a}},{}],216:[function(b,a,c){a.exports=function(a,b,d,c){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180),h=Math.tan(b.rightDegrees*Math.PI/180),i=2/(g+h),j=2/(e+f);return a[0]=i,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=j,a[6]=0,a[7]=0,a[8]=-((g-h)*i*.5),a[9]=(e-f)*j*.5,a[10]=c/(d-c),a[11]=-1,a[12]=0,a[13]=0,a[14]=c*d/(d-c),a[15]=0,a}},{}],217:[function(b,a,c){a.exports=function(a,b,F,E){var g,h,f,s,t,u,v,w,x,y,z,A,B,C,D,i,j,k,l,m,n,o,p,q,c=E[0],d=E[1],e=E[2],r=Math.sqrt(c*c+d*d+e*e);return 1e-6>Math.abs(r)?null:(c*=r=1/r,d*=r,e*=r,g=Math.sin(F),h=Math.cos(F),f=1-h,s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8],B=b[9],C=b[10],D=b[11],i=c*c*f+h,j=d*c*f+e*g,k=e*c*f-d*g,l=c*d*f-e*g,m=d*d*f+h,n=e*d*f+c*g,o=c*e*f+d*g,p=d*e*f-c*g,q=e*e*f+h,a[0]=s*i+w*j+A*k,a[1]=t*i+x*j+B*k,a[2]=u*i+y*j+C*k,a[3]=v*i+z*j+D*k,a[4]=s*l+w*m+A*n,a[5]=t*l+x*m+B*n,a[6]=u*l+y*m+C*n,a[7]=v*l+z*m+D*n,a[8]=s*o+w*p+A*q,a[9]=t*o+x*p+B*q,a[10]=u*o+y*p+C*q,a[11]=v*o+z*p+D*q,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)}},{}],218:[function(b,a,c){a.exports=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*d+j*c,a[5]=g*d+k*c,a[6]=h*d+l*c,a[7]=i*d+m*c,a[8]=j*d-f*c,a[9]=k*d-g*c,a[10]=l*d-h*c,a[11]=m*d-i*c,a}},{}],219:[function(b,a,c){a.exports=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*d-j*c,a[1]=g*d-k*c,a[2]=h*d-l*c,a[3]=i*d-m*c,a[8]=f*c+j*d,a[9]=g*c+k*d,a[10]=h*c+l*d,a[11]=i*c+m*d,a}},{}],220:[function(b,a,c){a.exports=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*d+j*c,a[1]=g*d+k*c,a[2]=h*d+l*c,a[3]=i*d+m*c,a[4]=j*d-f*c,a[5]=k*d-g*c,a[6]=l*d-h*c,a[7]=m*d-i*c,a}},{}],221:[function(b,a,c){a.exports=function(a,b,f){var c=f[0],d=f[1],e=f[2];return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a[4]=b[4]*d,a[5]=b[5]*d,a[6]=b[6]*d,a[7]=b[7]*d,a[8]=b[8]*e,a[9]=b[9]*e,a[10]=b[10]*e,a[11]=b[11]*e,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}},{}],222:[function(b,a,c){a.exports=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}},{}],223:[function(b,a,c){a.exports=function(b,a,f){var g,h,i,j,k,l,m,n,o,p,q,r,c=f[0],d=f[1],e=f[2];return a===b?(b[12]=a[0]*c+a[4]*d+a[8]*e+a[12],b[13]=a[1]*c+a[5]*d+a[9]*e+a[13],b[14]=a[2]*c+a[6]*d+a[10]*e+a[14],b[15]=a[3]*c+a[7]*d+a[11]*e+a[15]):(g=a[0],h=a[1],i=a[2],j=a[3],k=a[4],l=a[5],m=a[6],n=a[7],o=a[8],p=a[9],q=a[10],r=a[11],b[0]=g,b[1]=h,b[2]=i,b[3]=j,b[4]=k,b[5]=l,b[6]=m,b[7]=n,b[8]=o,b[9]=p,b[10]=q,b[11]=r,b[12]=g*c+k*d+o*e+a[12],b[13]=h*c+l*d+p*e+a[13],b[14]=i*c+m*d+q*e+a[14],b[15]=j*c+n*d+r*e+a[15]),b}},{}],224:[function(b,a,c){a.exports=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],225:[function(b,d,h){"use strict";var i=b("css-font"),j=b("pick-by-alias"),k=b("regl"),l=b("gl-util/context"),e=b("es6-weak-map"),m=b("color-normalize"),n=b("font-atlas"),o=b("typedarray-pool"),p=b("parse-rect"),q=b("is-plain-obj"),r=b("parse-unit"),s=b("to-px"),t=b("detect-kerning"),u=b("object-assign"),v=b("font-measure"),w=b("flatten-vertex-data"),f=b("bit-twiddle"),x=f.nextPow2,y=new e,g=!1;if(document.body){var c=document.body.appendChild(document.createElement("div"));c.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(c).fontStretch&&(g=!0),document.body.removeChild(c)}var a=function(a){z(a)?(a={regl:a},this.gl=a.regl._gl):this.gl=l(a),this.shader=y.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=a.regl||k({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),y.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(q(a)?a:{})};function z(a){return"function"==typeof a&&a._gl&&a.prop&&a.texture&&a.buffer}a.prototype.createShader=function(){var a=this.regl,b=a({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:a.prop("count"),offset:a.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:a.this("sizeBuffer")},width:{offset:0,stride:8,buffer:a.this("sizeBuffer")},char:a.this("charBuffer"),position:a.this("position")},uniforms:{atlasSize:function(b,a){return[a.atlas.width,a.atlas.height]},atlasDim:function(b,a){return[a.atlas.cols,a.atlas.rows]},atlas:function(b,a){return a.atlas.texture},charStep:function(b,a){return a.atlas.step},em:function(b,a){return a.atlas.em},color:a.prop("color"),opacity:a.prop("opacity"),viewport:a.this("viewportArray"),scale:a.this("scale"),align:a.prop("align"),baseline:a.prop("baseline"),translate:a.this("translate"),positionOffset:a.prop("positionOffset")},primitive:"points",viewport:a.this("viewport"),vert:"\n			precision highp float;\n			attribute float width, charOffset, char;\n			attribute vec2 position;\n			uniform float fontSize, charStep, em, align, baseline;\n			uniform vec4 viewport;\n			uniform vec4 color;\n			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n			varying vec2 charCoord, charId;\n			varying float charWidth;\n			varying vec4 fontColor;\n			void main () {\n				vec2 offset = floor(em * (vec2(align + charOffset, baseline)\n					+ vec2(positionOffset.x, -positionOffset.y)))\n					/ (viewport.zw * scale.xy);\n\n				vec2 position = (position + translate) * scale;\n				position += offset * scale;\n\n				charCoord = position * viewport.zw + viewport.xy;\n\n				gl_Position = vec4(position * 2. - 1., 0, 1);\n\n				gl_PointSize = charStep;\n\n				charId.x = mod(char, atlasDim.x);\n				charId.y = floor(char / atlasDim.x);\n\n				charWidth = width * em;\n\n				fontColor = color / 255.;\n			}",frag:"\n			precision highp float;\n			uniform float fontSize, charStep, opacity;\n			uniform vec2 atlasSize;\n			uniform vec4 viewport;\n			uniform sampler2D atlas;\n			varying vec4 fontColor;\n			varying vec2 charCoord, charId;\n			varying float charWidth;\n\n			float lightness(vec4 color) {\n				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n			}\n\n			void main () {\n				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n				float halfCharStep = floor(charStep * .5 + .5);\n\n				// invert y and shift by 1px (FF expecially needs that)\n				uv.y = charStep - uv.y;\n\n				// ignore points outside of character bounding box\n				float halfCharWidth = ceil(charWidth * .5);\n				if (floor(uv.x) > halfCharStep + halfCharWidth ||\n					floor(uv.x) < halfCharStep - halfCharWidth) return;\n\n				uv += charId * charStep;\n				uv = uv / atlasSize;\n\n				vec4 color = fontColor;\n				vec4 mask = texture2D(atlas, uv);\n\n				float maskY = lightness(mask);\n				// float colorY = lightness(color);\n				color.a *= maskY;\n				color.a *= opacity;\n\n				// color.a += .1;\n\n				// antialiasing, see yiq color space y-channel formula\n				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n				gl_FragColor = color;\n			}"});return{regl:a,draw:b,atlas:{}}},a.prototype.update=function(b){var H,l,$=this;if("string"==typeof b)b={text:b};else if(!b)return;null!=(b=j(b,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(Array.isArray(b.opacity)?this.opacity=b.opacity.map(function(a){return parseFloat(a)}):this.opacity=parseFloat(b.opacity)),null!=b.viewport&&(this.viewport=p(b.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=b.kerning&&(this.kerning=b.kerning),null!=b.offset&&("number"==typeof b.offset&&(b.offset=[b.offset,0]),this.positionOffset=w(b.offset)),b.direction&&(this.direction=b.direction),b.range&&(this.range=b.range,this.scale=[1/(b.range[2]-b.range[0]),1/(b.range[3]-b.range[1])],this.translate=[-b.range[0],-b.range[1]]),b.scale&&(this.scale=b.scale),b.translate&&(this.translate=b.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||b.font||(b.font=a.baseFontSize+"px sans-serif");var B=!1,Q=!1;if(b.font&&(Array.isArray(b.font)?b.font:[b.font]).forEach(function(b,c){if("string"==typeof b)try{b=i.parse(b)}catch(k){b=i.parse(a.baseFontSize+"px "+b)}else b=i.parse(i.stringify(b));var d=i.stringify({size:a.baseFontSize,family:b.family,stretch:g?b.stretch:void 0,variant:b.variant,weight:b.weight,style:b.style}),f=r(b.size),h=Math.round(f[0]*s(f[1]));if(h!==$.fontSize[c]&&(Q=!0,$.fontSize[c]=h),(!$.font[c]||d!=$.font[c].baseString)&&(B=!0,$.font[c]=a.fonts[d],!$.font[c])){var j=b.family.join(", "),e=[b.style];b.style!=b.variant&&e.push(b.variant),b.variant!=b.weight&&e.push(b.weight),g&&b.weight!=b.stretch&&e.push(b.stretch),$.font[c]={baseString:d,family:j,weight:b.weight,stretch:b.stretch,style:b.style,variant:b.variant,width:{},kerning:{},metrics:v(j,{origin:"top",fontSize:a.baseFontSize,fontStyle:e.join(" ")})},a.fonts[d]=$.font[c]}}),(B||Q)&&this.font.forEach(function(a,c){var d=i.stringify({size:$.fontSize[c],family:a.family,stretch:g?a.stretch:void 0,variant:a.variant,weight:a.weight,style:a.style});if($.fontAtlas[c]=$.shader.atlas[d],!$.fontAtlas[c]){var e=a.metrics;$.shader.atlas[d]=$.fontAtlas[c]={fontString:d,step:2*Math.ceil($.fontSize[c]*e.bottom*.5),em:$.fontSize[c],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:$.regl.texture()}}null==b.text&&(b.text=$.text)}),"string"==typeof b.text&&b.position&&b.position.length>2){for(var C=Array(.5*b.position.length),D=0;D<C.length;D++)C[D]=b.text;b.text=C}if(null!=b.text||B){if(this.textOffsets=[0],Array.isArray(b.text)){this.count=b.text[0].length,this.counts=[this.count];for(var f=1;f<b.text.length;f++)this.textOffsets[f]=this.textOffsets[f-1]+b.text[f-1].length,this.count+=b.text[f].length,this.counts.push(b.text[f].length);this.text=b.text.join("")}else this.text=b.text,this.count=this.text.length,this.counts=[this.count];H=[],this.font.forEach(function(c,h){a.atlasContext.font=c.baseString;for(var d=$.fontAtlas[h],e=0;e<$.text.length;e++){var b=$.text.charAt(e);if(null==d.ids[b]&&(d.ids[b]=d.chars.length,d.chars.push(b),H.push(b)),null==c.width[b]&&(c.width[b]=a.atlasContext.measureText(b).width/a.baseFontSize,$.kerning)){var f=[];for(var g in c.width)f.push(g+b,b+g);u(c.kerning,t(c.family,{pairs:f}))}}})}if(b.position)if(b.position.length>2){for(var R=!b.position[0].length,h=o.mallocFloat(2*this.count),k=0,z=0;k<this.counts.length;k++){var I=this.counts[k];if(R)for(var J=0;J<I;J++)h[z++]=b.position[2*k],h[z++]=b.position[2*k+1];else for(var K=0;K<I;K++)h[z++]=b.position[k][0],h[z++]=b.position[k][1]}this.position.call?this.position({type:"float",data:h}):this.position=this.regl.buffer({type:"float",data:h}),o.freeFloat(h)}else this.position.destroy&&this.position.destroy(),this.position={constant:b.position};if(b.text||B){var E=o.mallocUint8(this.count),e=o.mallocFloat(2*this.count);this.textWidth=[];for(var q=0,d=0;q<this.counts.length;q++){for(var S=this.counts[q],L=this.font[q]||this.font[0],T=this.fontAtlas[q]||this.fontAtlas[0],F=0;F<S;F++){var G=this.text.charAt(d),U=this.text.charAt(d-1);if(E[d]=T.ids[G],e[2*d]=L.width[G],F){var V=e[2*d-2],W=e[2*d],X=e[2*d-1],M=X+.5*V+.5*W;if(this.kerning){var N=L.kerning[U+G];N&&(M+=.001*N)}e[2*d+1]=M}else e[2*d+1]=.5*e[2*d];d++}this.textWidth.push(e.length?.5*e[2*d-2]+e[2*d-1]:0)}b.align||(b.align=this.align),this.charBuffer({data:E,type:"uint8",usage:"stream"}),this.sizeBuffer({data:e,type:"float",usage:"stream"}),o.freeUint8(E),o.freeFloat(e),H.length&&this.font.forEach(function(j,h){var b=$.fontAtlas[h],c=b.step,i=Math.floor(a.maxAtlasSize/c),d=Math.min(i,b.chars.length),e=Math.ceil(b.chars.length/d),f=x(d*c),g=x(e*c);b.width=f,b.height=g,b.rows=e,b.cols=d,b.em&&b.texture({data:n({canvas:a.atlasCanvas,font:b.fontString,chars:b.chars,shape:[f,g],step:[c,c]})})})}if(b.align&&(this.align=b.align,this.alignOffset=this.textWidth.map(function(b,c){var a=Array.isArray($.align)?$.align.length>1?$.align[c]:$.align[0]:$.align;if("number"==typeof a)return a;switch(a){case"right":case"end":return-b;case"center":case"centre":case"middle":return-(.5*b)}return 0})),null==this.baseline&&null==b.baseline&&(b.baseline=0),null!=b.baseline&&(this.baseline=b.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(b,d){var c=($.font[d]||$.font[0]).metrics,a=0;return a+=.5*c.bottom,"number"==typeof b?a+=b-c.baseline:a+=-c[b],a*=-1})),null!=b.color)if(b.color||(b.color="transparent"),"string"!=typeof b.color&&isNaN(b.color)){if("number"==typeof b.color[0]&&b.color.length>this.counts.length){var O=b.color.length;l=o.mallocUint8(O);for(var Y=(b.color.subarray||b.color.slice).bind(b.color),y=0;y<O;y+=4)l.set(m(Y(y,y+4),"uint8"),y)}else{var P=b.color.length;l=o.mallocUint8(4*P);for(var A=0;A<P;A++)l.set(m(b.color[A]||0,"uint8"),4*A)}this.color=l}else this.color=m(b.color,"uint8");if(b.position||b.text||b.color||b.baseline||b.align||b.font||b.offset||b.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Z=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Z);for(var c=0;c<this.batch.length;c++)this.batch[c]={count:this.counts.length>1?this.counts[c]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[c]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*c,4*c+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[c]:this.opacity,baseline:null!=this.baselineOffset[c]?this.baselineOffset[c]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[c]?this.alignOffset[c]:this.alignOffset[0]:0,atlas:this.fontAtlas[c]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*c,2*c+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},a.prototype.destroy=function(){},a.prototype.kerning=!0,a.prototype.position={constant:new Float32Array(2)},a.prototype.translate=null,a.prototype.scale=null,a.prototype.font=null,a.prototype.text="",a.prototype.positionOffset=[0,0],a.prototype.opacity=1,a.prototype.color=new Uint8Array([0,0,0,255]),a.prototype.alignOffset=[0,0],a.maxAtlasSize=1024,a.atlasCanvas=document.createElement("canvas"),a.atlasContext=a.atlasCanvas.getContext("2d",{alpha:!1}),a.baseFontSize=64,a.fonts={},d.exports=a},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(a,b,d){(function(c){(function(){"use strict";var d=a("pick-by-alias");function e(a){if(a.container)if(a.container==document.body)document.body.style.width||(a.canvas.width=a.width||a.pixelRatio*c.innerWidth),document.body.style.height||(a.canvas.height=a.height||a.pixelRatio*c.innerHeight);else{var b=a.container.getBoundingClientRect();a.canvas.width=a.width||b.right-b.left,a.canvas.height=a.height||b.bottom-b.top}}function f(a){return"function"==typeof a.getContext&&"width"in a&&"height"in a}function g(){var a=document.createElement("canvas");return a.style.position="absolute",a.style.top=0,a.style.left=0,a}b.exports=function(a){var b,h;if(a?"string"==typeof a&&(a={container:a}):a={},(a=f(a)?{container:a}:"string"==typeof(b=a).nodeName&&"function"==typeof b.appendChild&&"function"==typeof b.getBoundingClientRect?{container:a}:"function"==typeof(h=a).drawArrays||"function"==typeof h.drawElements?{gl:a}:d(a,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(a.pixelRatio=c.pixelRatio||1),a.gl)return a.gl;if(a.canvas&&(a.container=a.canvas.parentNode),a.container){if("string"==typeof a.container){var i=document.querySelector(a.container);if(!i)throw Error("Element "+a.container+" is not found");a.container=i}f(a.container)?(a.canvas=a.container,a.container=a.canvas.parentNode):a.canvas||(a.canvas=g(),a.container.appendChild(a.canvas),e(a))}else if(!a.canvas)if("undefined"!=typeof document)a.container=document.body||document.documentElement,a.canvas=g(),a.container.appendChild(a.canvas),e(a);else throw Error("Not DOM environment. Use headless-gl.");return a.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(b){try{a.gl=a.canvas.getContext(b,a.attrs)}catch(c){}return a.gl}),a.gl}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pick-by-alias":253}],227:[function(b,a,c){a.exports=function(a){"string"==typeof a&&(a=[a]);for(var d=[].slice.call(arguments,1),c=[],b=0;b<a.length-1;b++)c.push(a[b],d[b]||"");return c.push(a[b]),c.join("")}},{}],228:[function(a,b,d){(function(c){(function(){"use strict";var d,e=a("is-browser");d="function"==typeof c.matchMedia?!c.matchMedia("(hover: none)").matches:e,b.exports=d}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"is-browser":232}],229:[function(a,b,d){"use strict";var c=a("is-browser");b.exports=c&&function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b),window.removeEventListener("test",null,b)}catch(c){a=!1}return a}()},{"is-browser":232}],230:[function(b,c,a){a.read=function(g,h,j,e,k){var a,c,l=8*k-e-1,m=(1<<l)-1,n=m>>1,b=-7,d=j?k-1:0,i=j?-1:1,f=g[h+d];for(d+=i,a=f&(1<< -b)-1,f>>=-b,b+=l;b>0;a=256*a+g[h+d],d+=i,b-=8);for(c=a&(1<< -b)-1,a>>=-b,b+=e;b>0;c=256*c+g[h+d],d+=i,b-=8);if(0===a)a=1-n;else{if(a===m)return c?NaN:(f?-1:1)*(1/0);c+=Math.pow(2,e),a-=n}return(f?-1:1)*c*Math.pow(2,a-e)},a.write=function(j,b,k,m,c,n){var a,d,e,h=8*n-c-1,i=(1<<h)-1,f=i>>1,o=23===c?5960464477539062e-23:0,g=m?0:n-1,l=m?1:-1,p=b<0||0===b&&1/b<0?1:0;for(isNaN(b=Math.abs(b))||b===1/0?(d=isNaN(b)?1:0,a=i):(a=Math.floor(Math.log(b)/Math.LN2),b*(e=Math.pow(2,-a))<1&&(a--,e*=2),a+f>=1?b+=o/e:b+=o*Math.pow(2,1-f),b*e>=2&&(a++,e/=2),a+f>=i?(d=0,a=i):a+f>=1?(d=(b*e-1)*Math.pow(2,c),a+=f):(d=b*Math.pow(2,f-1)*Math.pow(2,c),a=0));c>=8;j[k+g]=255&d,g+=l,d/=256,c-=8);for(a=a<<c|d,h+=c;h>0;j[k+g]=255&a,g+=l,a/=256,h-=8);j[k+g-l]|=128*p}},{}],231:[function(b,a,c){"function"==typeof Object.create?a.exports=function(a,b){b&&(a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(a,b){if(b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}}},{}],232:[function(b,a,c){a.exports=!0},{}],233:[function(b,a,c){"use strict";a.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(b,a,c){"use strict";a.exports=f,a.exports.isMobile=f,a.exports.default=f;var d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function f(b){b||(b={});var a=b.ua;if(a||"undefined"==typeof navigator||(a=navigator.userAgent),a&&a.headers&&"string"==typeof a.headers["user-agent"]&&(a=a.headers["user-agent"]),"string"!=typeof a)return!1;var c=b.tablet?e.test(a):d.test(a);return!c&&b.tablet&&b.featureDetect&&navigator&&navigator.maxTouchPoints>1&& -1!==a.indexOf("Macintosh")&& -1!==a.indexOf("Safari")&&(c=!0),c}},{}],235:[function(b,a,c){"use strict";a.exports=function(a){var b=typeof a;return null!==a&&("object"===b||"function"===b)}},{}],236:[function(b,a,c){"use strict";var d=Object.prototype.toString;a.exports=function(a){var b;return"[object Object]"===d.call(a)&&(null===(b=Object.getPrototypeOf(a))||b===Object.getPrototypeOf({}))}},{}],237:[function(b,a,c){"use strict";a.exports=function(c){for(var a,d=c.length,b=0;b<d;b++)if(((a=c.charCodeAt(b))<9||a>13)&&32!==a&&133!==a&&160!==a&&5760!==a&&6158!==a&&(a<8192||a>8205)&&8232!==a&&8233!==a&&8239!==a&&8287!==a&&8288!==a&&12288!==a&&65279!==a)return!1;return!0}},{}],238:[function(b,a,c){"use strict";a.exports=function(a){return"string"==typeof a&&(a=a.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(a)&&/[\dz]$/i.test(a))&&a.length>4)}},{}],239:[function(b,c,d){!function(e,b){"object"==typeof d&& void 0!==c?c.exports=b():"function"==typeof a&&a.amd?a(b):(e=e||self).mapboxgl=b()}(this,function(){"use strict";var c,d,b;function a(g,a){if(c)if(d){var f="var sharedChunk = {}; ("+c+")(sharedChunk); ("+d+")(sharedChunk);",e={};c(e),(b=a(e)).workerUrl=window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))}else d=a;else c=a}return a(["exports"],function(a){"use strict";function aK(b,a){return b(a={exports:{}},a.exports),a.exports}var d3,aW,d4,aX,d5,d6,d7,b$,b_,b0="1.10.1",d8=au;function au(a,c,d,b){this.cx=3*a,this.bx=3*(d-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(b-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=b,this.p2x=d,this.p2y=b}au.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},au.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},au.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},au.prototype.solveCurveX=function(d,e){for(void 0===e&&(e=1e-6),a=d,h=0;h<8;h++){if(Math.abs(f=this.sampleCurveX(a)-d)<e)return a;var b,c,a,f,h,g=this.sampleCurveDerivativeX(a);if(1e-6>Math.abs(g))break;a-=f/g}if(b=0,c=1,(a=d)<b)return b;if(a>c)return c;for(;b<c;){if(Math.abs((f=this.sampleCurveX(a))-d)<e)return a;d>f?b=a:c=a,a=(c-b)*.5+b}return a},au.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))};var aY=bl;function bl(a,b){this.x=a,this.y=b}function b1(a,b){if(Array.isArray(a)){if(!Array.isArray(b)||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!b1(a[c],b[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==b){if("object"!=typeof b)return!1;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(var d in a)if(!b1(a[d],b[d]))return!1;return!0}return a===b}function bm(a,b,c,d){var e=new d8(a,b,c,d);return function(a){return e.solve(a)}}bl.prototype={clone:function(){return new bl(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,b){return this.clone()._rotateAround(a,b)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x,c=a.y-this.y;return b*b+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y,c=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=c,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=b*this.x-c*this.y,e=c*this.x+b*this.y;return this.x=d,this.y=e,this},_rotateAround:function(b,a){var c=Math.cos(b),d=Math.sin(b),e=a.x+c*(this.x-a.x)-d*(this.y-a.y),f=a.y+d*(this.x-a.x)+c*(this.y-a.y);return this.x=e,this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},bl.convert=function(a){return a instanceof bl?a:Array.isArray(a)?new bl(a[0],a[1]):a};var b2=bm(.25,.1,.25,1);function b3(a,b,c){return Math.min(c,Math.max(b,a))}function b4(e,a,c){var b=c-a,d=((e-a)%b+b)%b+a;return d===a?c:d}function b5(c){for(var d=[],a=arguments.length-1;a-- >0;)d[a]=arguments[a+1];for(var b=0,e=d;b<e.length;b+=1){var f=e[b];for(var g in f)c[g]=f[g]}return c}var d9=1;function b6(){return d9++}function ea(){function a(b){return b?(b^16*Math.random()>>b/4).toString(16):([1e7]+ -[1e3]+ -4e3+ -8e3+ -1e11).replace(/[018]/g,a)}return a()}function eb(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function b7(a,b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})}function b8(a,b){return -1!==a.indexOf(b,a.length-b.length)}function b9(a,d,e){var c={};for(var b in a)c[b]=d.call(e||this,a[b],b,a);return c}function ca(a,d,e){var c={};for(var b in a)d.call(e||this,a[b],b,a)&&(c[b]=a[b]);return c}function cb(a){return Array.isArray(a)?a.map(cb):"object"==typeof a&&a?b9(a,cb):a}var ec={};function cc(a){ec[a]||("undefined"!=typeof console&&console.warn(a),ec[a]=!0)}function ed(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)}function ee(a){for(var e=0,b=0,f=a.length,g=f-1,c=void 0,d=void 0;b<f;g=b++)c=a[b],d=a[g],e+=(d.x-c.x)*(c.y+d.y);return e}function cd(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function ef(c){var a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(f,c,d,e){var b=d||e;return a[c]=!b||b.toLowerCase(),""}),a["max-age"]){var b=parseInt(a["max-age"],10);isNaN(b)?delete a["max-age"]:a["max-age"]=b}return a}var eg=null;function eh(b){if(null==eg){var a=b.navigator?b.navigator.userAgent:null;eg=!!b.safari||!!(a&&(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return eg}function ei(b){try{var a=self[b];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch(c){return!1}}var ce=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),ej=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,ek=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,cf={now:ce,frame:function(a){var b=ej(a);return{cancel:function(){return ek(b)}}},getImageData:function(a,b){void 0===b&&(b=0);var c=self.document.createElement("canvas"),d=c.getContext("2d");if(!d)throw new Error("failed to create canvas 2d context");return c.width=a.width,c.height=a.height,d.drawImage(a,0,0,a.width,a.height),d.getImageData(-b,-b,a.width+2*b,a.height+2*b)},resolveURL:function(a){return d3||(d3=self.document.createElement("a")),d3.href=a,d3.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){if(!self.matchMedia)return!1;return null==aW&&(aW=self.matchMedia("(prefers-reduced-motion: reduce)")),aW.matches}},cg={API_URL:"https://api.mapbox.com",get EVENTS_URL(){if(!this.API_URL)return null;if(0===this.API_URL.indexOf("https://api.mapbox.cn"))return"https://events.mapbox.cn/events/v2";if(0===this.API_URL.indexOf("https://api.mapbox.com"))return"https://events.mapbox.com/events/v2";return null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ch={supported:!1,testSupport:function(a){!el&&aX&&(em?en(a):d4=a)}},el=!1,em=!1;function en(a){var b=a.createTexture();a.bindTexture(a.TEXTURE_2D,b);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,aX),a.isContextLost())return;ch.supported=!0}catch(c){}a.deleteTexture(b),el=!0}self.document&&((aX=self.document.createElement("img")).onload=function(){d4&&en(d4),d4=null,em=!0},aX.onerror=function(){el=!0,d4=null},aX.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var u=function(a,b){this._transformRequestFn=a,this._customAccessToken=b,this._createSkuToken()};function ci(a){return 0===a.indexOf("mapbox:")}u.prototype._createSkuToken=function(){var a=function(){for(var a="",b=0;b<10;b++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1","01",a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt},u.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},u.prototype.transformRequest=function(a,b){return this._transformRequestFn?this._transformRequestFn(a,b)||{url:a}:{url:a}},u.prototype.normalizeStyleURL=function(a,c){if(!ci(a))return a;var b=es(a);return b.path="/styles/v1"+b.path,this._makeAPIURL(b,this._customAccessToken||c)},u.prototype.normalizeGlyphsURL=function(a,c){if(!ci(a))return a;var b=es(a);return b.path="/fonts/v1"+b.path,this._makeAPIURL(b,this._customAccessToken||c)},u.prototype.normalizeSourceURL=function(b,c){if(!ci(b))return b;var a=es(b);return a.path="/v4/"+a.authority+".json",a.params.push("secure"),this._makeAPIURL(a,this._customAccessToken||c)},u.prototype.normalizeSpriteURL=function(b,c,d,e){var a=es(b);return ci(b)?(a.path="/styles/v1"+a.path+"/sprite"+c+d,this._makeAPIURL(a,this._customAccessToken||e)):(a.path+=""+c+d,et(a))},u.prototype.normalizeTileURL=function(b,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),b&&!ci(b))return b;var a=es(b),e=cf.devicePixelRatio>=2||512===d?"@2x":"",f=ch.supported?".webp":"$1";a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+e+f),a.path=a.path.replace(/^.+\/v4\//,"/"),a.path="/v4"+a.path;var c=this._customAccessToken||eq(a.params)||cg.ACCESS_TOKEN;return cg.REQUIRE_ACCESS_TOKEN&&c&&this._skuToken&&a.params.push("sku="+this._skuToken),this._makeAPIURL(a,c)},u.prototype.canonicalizeTileURL=function(d,e){var a=es(d);if(!a.path.match(/(^\/v4\/)/)||!a.path.match(/\.[\w]+$/))return d;var c="mapbox://tiles/";c+=a.path.replace("/v4/","");var b=a.params;return e&&(b=b.filter(function(a){return!a.match(/^access_token=/)})),b.length&&(c+="?"+b.join("&")),c},u.prototype.canonicalizeTileset=function(f,d){for(var g=!!d&&ci(d),a=[],b=0,e=f.tiles||[];b<e.length;b+=1){var c=e[b];ep(c)?a.push(this.canonicalizeTileURL(c,g)):a.push(c)}return a},u.prototype._makeAPIURL=function(a,b){var d="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=es(cg.API_URL);if(a.protocol=c.protocol,a.authority=c.authority,"/"!==c.path&&(a.path=""+c.path+a.path),!cg.REQUIRE_ACCESS_TOKEN)return et(a);if(!(b=b||cg.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+d);if("s"===b[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+d);return a.params=a.params.filter(function(a){return -1===a.indexOf("access_token")}),a.params.push("access_token="+b),et(a)};var eo=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ep(a){return eo.test(a)}function eq(d){for(var a=0,b=d;a<b.length;a+=1){var c=b[a].match(/^access_token=(.*)$/);if(c)return c[1]}return null}var er=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function es(b){var a=b.match(er);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function et(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+b}var eu="mapbox.eventData";function ev(b){if(!b)return null;var c,a=b.split(".");if(!a||3!==a.length)return null;try{return JSON.parse((c=a[1],decodeURIComponent(self.atob(c).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(d){return null}}var H=function(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};H.prototype.getStorageKey=function(c){var d,a=ev(cg.ACCESS_TOKEN),b="";return b=a&&a.u?(d=a.u,self.btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,function(b,a){return String.fromCharCode(Number("0x"+a))}))):cg.ACCESS_TOKEN||"",c?eu+"."+c+":"+b:eu+":"+b},H.prototype.fetchEventData=function(){var c=ei("localStorage"),d=this.getStorageKey(),e=this.getStorageKey("uuid");if(c)try{var a=self.localStorage.getItem(d);a&&(this.eventData=JSON.parse(a));var b=self.localStorage.getItem(e);b&&(this.anonId=b)}catch(f){cc("Unable to read from LocalStorage")}},H.prototype.saveEventData=function(){var a=ei("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{self.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(b,JSON.stringify(this.eventData))}catch(d){cc("Unable to write to LocalStorage")}},H.prototype.processRequests=function(a){},H.prototype.postEvent=function(d,a,h,e){var i=this;if(cg.EVENTS_URL){var b=es(cg.EVENTS_URL);b.params.push("access_token="+(e||cg.ACCESS_TOKEN||""));var c={event:this.type,created:new Date(d).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:b0,skuId:"01",userId:this.anonId},f=a?b5(c,a):c,g={url:et(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([f])};this.pendingRequest=eD(g,function(a){i.pendingRequest=null,h(a),i.saveEventData(),i.processRequests(e)})}},H.prototype.queueRequest=function(a,b){this.queue.push(a),this.processRequests(b)};var cj=function(b){function a(){b.call(this,"map.load"),this.success={},this.skuToken=""}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.postMapLoadEvent=function(a,c,d,b){this.skuToken=d,(cg.EVENTS_URL&&b||cg.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return ci(a)||ep(a)}))&&this.queueRequest({id:c,timestamp:Date.now()},b)},a.prototype.processRequests=function(c){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var a=this.queue.shift(),b=a.id,d=a.timestamp;b&&this.success[b]||(this.anonId||this.fetchEventData(),eb(this.anonId)||(this.anonId=ea()),this.postEvent(d,{skuToken:this.skuToken},function(a){!a&&b&&(e.success[b]=!0)},c))}},a}(H),ck=function(b){function a(a){b.call(this,"appUserTurnstile"),this._customAccessToken=a}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.postTurnstileEvent=function(a,b){cg.EVENTS_URL&&cg.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return ci(a)||ep(a)})&&this.queueRequest(Date.now(),b)},a.prototype.processRequests=function(e){var i=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var c=ev(cg.ACCESS_TOKEN),f=c?c.u:cg.ACCESS_TOKEN,a=f!==this.eventData.tokenU;eb(this.anonId)||(this.anonId=ea(),a=!0);var b=this.queue.shift();if(this.eventData.lastSuccess){var g=new Date(this.eventData.lastSuccess),h=new Date(b),d=(b-this.eventData.lastSuccess)/864e5;a=a||d>=1||d< -1||g.getDate()!==h.getDate()}else a=!0;if(!a)return this.processRequests();this.postEvent(b,{"enabled.telemetry":!1},function(a){a||(i.eventData.lastSuccess=b,i.eventData.tokenU=f)},e)}},a}(H),bn=new ck,cl=bn.postTurnstileEvent.bind(bn),bo=new cj,cm=bo.postMapLoadEvent.bind(bo),ew="mapbox-tiles",ex=500,ey=50;function ez(){self.caches&&!d5&&(d5=self.caches.open(ew))}function eA(a){var b=a.indexOf("?");return b<0?a:a.slice(0,b)}var eB=1/0;function cn(){return null==d7&&(d7=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),d7}var bp={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bp);var eC=function(b){function a(a,c,d){401===c&&ep(d)&&(a+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),b.call(this,a),this.status=c,this.url=d,this.name=this.constructor.name,this.message=a}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},a}(Error),co=cd()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},cp=function(a,b){if(d=a.url,!(/^file:/.test(d)||/^file:/.test(co())&&!/^\w+:/.test(d))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return e=a,f=b,g=new self.AbortController,h=new self.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:co(),signal:g.signal}),i=!1,j=!1,l=(k=h.url).indexOf("sku=")>0&&ep(k),"json"===e.type&&h.headers.set("Accept","application/json"),m=function(a,b,c){if(!j){if(a&&"SecurityError"!==a.message&&cc(a),b&&c)return n(b);var d=Date.now();self.fetch(h).then(function(a){if(!a.ok)return f(new eC(a.statusText,a.status,e.url));var b=l?a.clone():null;return n(a,b,d)}).catch(function(a){20!==a.code&&f(new Error(a.message))})}},n=function(a,b,c){("arrayBuffer"===e.type?a.arrayBuffer():"json"===e.type?a.json():a.text()).then(function(d){j||(b&&c&&function(e,a,c){if(ez(),d5){var d={status:a.status,statusText:a.statusText,headers:new self.Headers};a.headers.forEach(function(a,b){return d.headers.set(b,a)});var b=ef(a.headers.get("Cache-Control")||"");!b["no-store"]&&(b["max-age"]&&d.headers.set("Expires",new Date(c+1e3*b["max-age"]).toUTCString()),new Date(d.headers.get("Expires")).getTime()-c<42e4||function(a,b){if(void 0===d6)try{new Response(new ReadableStream),d6=!0}catch(c){d6=!1}d6?b(a.body):a.blob().then(b)}(a,function(a){var b=new self.Response(a,d);ez(),d5&&d5.then(function(a){return a.put(eA(e.url),b)}).catch(function(a){return cc(a.message)})}))}}(h,b,c),i=!0,f(null,d,a.headers.get("Cache-Control"),a.headers.get("Expires")))}).catch(function(a){j||f(new Error(a.message))})},l?function(b,a){if(ez(),!d5)return a(null);var c=eA(b.url);d5.then(function(b){b.match(c).then(function(d){var e=function(a){if(!a)return!1;var b=new Date(a.headers.get("Expires")||0),c=ef(a.headers.get("Cache-Control")||"");return b>Date.now()&&!c["no-cache"]}(d);b.delete(c),e&&b.put(c,d.clone()),a(null,d,e)}).catch(a)}).catch(a)}(h,m):m(null,null),{cancel:function(){j=!0,i||g.abort()}};if(cd()&&self.worker&&self.worker.actor){var d,e,f,g,h,i,j,k,l,m,n,c=!0;return self.worker.actor.send("getResource",a,b,void 0,c)}}return function(b,d){var a=new self.XMLHttpRequest;for(var c in a.open(b.method||"GET",b.url,!0),"arrayBuffer"===b.type&&(a.responseType="arraybuffer"),b.headers)a.setRequestHeader(c,b.headers[c]);return"json"===b.type&&(a.responseType="text",a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===b.credentials,a.onerror=function(){d(new Error(a.statusText))},a.onload=function(){if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){var c=a.response;if("json"===b.type)try{c=JSON.parse(a.response)}catch(e){return d(e)}d(null,c,a.getResponseHeader("Cache-Control"),a.getResponseHeader("Expires"))}else d(new eC(a.statusText,a.status,b.url))},a.send(b.body),{cancel:function(){return a.abort()}}}(a,b)},cq=function(a,b){return cp(b5(a,{type:"arrayBuffer"}),b)},eD=function(a,b){return cp(b5(a,{method:"POST"}),b)};function eE(b){var a=self.document.createElement("a");return a.href=b,a.protocol===self.document.location.protocol&&a.host===self.document.location.host}b$=[],b_=0;var cr=function(a,c){if(ch.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),b_>=cg.MAX_PARALLEL_IMAGE_REQUESTS){var b={requestParameters:a,callback:c,cancelled:!1,cancel:function(){this.cancelled=!0}};return b$.push(b),b}b_++;var d=!1,e=function(){if(!d)for(d=!0,b_--;b$.length&&b_<cg.MAX_PARALLEL_IMAGE_REQUESTS;){var a=b$.shift(),b=a.requestParameters,c=a.callback,e=a.cancelled;e||(a.cancel=cr(b,c).cancel)}},f=cq(a,function(f,b,k,l){if(e(),f)c(f);else if(b)if(cn())!function(a,c){var b=new self.Blob([new Uint8Array(a)],{type:"image/png"});self.createImageBitmap(b).then(function(a){c(null,a)}).catch(function(a){c(new Error("Could not load image because of "+a.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(b,c);else{var d,m,g,h,a,i,j;d=b,m=c,g=k,h=l,a=new self.Image,i=self.URL,a.onload=function(){m(null,a),i.revokeObjectURL(a.src)},a.onerror=function(){return m(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},j=new self.Blob([new Uint8Array(d)],{type:"image/png"}),a.cacheControl=g,a.expires=h,a.src=d.byteLength?i.createObjectURL(j):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}});return{cancel:function(){f.cancel(),e()}}};function eF(a,c,b){b[a]&& -1!==b[a].indexOf(c)||(b[a]=b[a]||[],b[a].push(c))}function eG(b,d,a){if(a&&a[b]){var c=a[b].indexOf(d);-1!==c&&a[b].splice(c,1)}}var bq=function(b,a){void 0===a&&(a={}),b5(this,a),this.type=b},cs=function(b){function a(c,a){void 0===a&&(a={}),b.call(this,"error",b5({error:c},a))}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a}(bq),A=function(){};A.prototype.on=function(a,b){return this._listeners=this._listeners||{},eF(a,b,this._listeners),this},A.prototype.off=function(a,b){return eG(a,b,this._listeners),eG(a,b,this._oneTimeListeners),this},A.prototype.once=function(a,b){return this._oneTimeListeners=this._oneTimeListeners||{},eF(a,b,this._oneTimeListeners),this},A.prototype.fire=function(a,i){"string"==typeof a&&(a=new bq(a,i||{}));var b=a.type;if(this.listens(b)){a.target=this;for(var j=this._listeners&&this._listeners[b]?this._listeners[b].slice():[],c=0,e=j;c<e.length;c+=1)e[c].call(this,a);for(var k=this._oneTimeListeners&&this._oneTimeListeners[b]?this._oneTimeListeners[b].slice():[],d=0,f=k;d<f.length;d+=1){var g=f[d];eG(b,g,this._oneTimeListeners),g.call(this,a)}var h=this._eventedParent;h&&(b5(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),h.fire(a))}else a instanceof cs&&console.error(a.error);return this},A.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},A.prototype.setEventedParent=function(a,b){return this._eventedParent=a,this._eventedParentData=b,this};var b={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number","default":0,period:360,units:"degrees"},pitch:{type:"number","default":0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},"default":"xyz"},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},"default":"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},"default":"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number","default":18},attribution:{type:"string"},buffer:{type:"number","default":128,maximum:512,minimum:0},tolerance:{type:"number","default":.375},cluster:{type:"boolean","default":!1},clusterRadius:{type:"number","default":50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean","default":!1},generateId:{type:"boolean","default":!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},"default":"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},"default":"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number","default":2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number","default":1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},"default":"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number","default":250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean","default":!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},"default":"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean","default":!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean","default":!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean","default":!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number","default":1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},"default":"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number","default":0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number","default":2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean","default":!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted","default":"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number","default":16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number","default":10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number","default":1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number","default":0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},"default":"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems","default":0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number","default":45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number","default":0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number","default":2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean","default":!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},"default":"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,"default":[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean","default":!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean","default":!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean","default":!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},"function":{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number","default":1,minimum:0},property:{type:"string","default":"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},"default":"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},"default":"rgb"},"default":{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},"var":{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},"in":{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},"case":{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},"typeof":{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum","default":"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array","default":[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant","default":"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant","default":.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","default":!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number","default":0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number","default":0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean","default":!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number","default":1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number","default":0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number","default":0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},"default":"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},"default":"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number","default":30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number","default":1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number","default":1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color","default":"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color","default":"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number","default":0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number","default":0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number","default":0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number","default":0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},"default":"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number","default":300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number","default":335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number","default":.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color","default":"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds"},delay:{type:"number","default":0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ct=function(b,a,d,c){this.message=(b?b+": ":"")+d,c&&(this.identifier=c),null!=a&&a.__line__&&(this.line=a.__line__)};function cu(a){var c=a.key,b=a.value;return b?[new ct(c,b,"constants have been deprecated as of v8")]:[]}function eH(c){for(var d=[],a=arguments.length-1;a-- >0;)d[a]=arguments[a+1];for(var b=0,e=d;b<e.length;b+=1){var f=e[b];for(var g in f)c[g]=f[g]}return c}function eI(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function eJ(a){if(Array.isArray(a))return a.map(eJ);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){var b={};for(var c in a)b[c]=eJ(a[c]);return b}return eI(a)}var eK=function(b){function a(c,a){b.call(this,a),this.message=a,this.key=c}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a}(Error),aZ=function(e,a){void 0===a&&(a=[]),this.parent=e,this.bindings={};for(var b=0,c=a;b<c.length;b+=1){var d=c[b],f=d[0],g=d[1];this.bindings[f]=g}};aZ.prototype.concat=function(a){return new aZ(this,a)},aZ.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},aZ.prototype.has=function(a){return!!this.bindings[a]|| !!this.parent&&this.parent.has(a)};var cv={kind:"null"},d={kind:"number"},j={kind:"string"},g={kind:"boolean"},Q={kind:"color"},av={kind:"object"},k={kind:"value"},cw={kind:"collator"},cx={kind:"formatted"},cy={kind:"resolvedImage"};function R(a,b){return{kind:"array",itemType:a,N:b}}function eL(a){if("array"!==a.kind)return a.kind;var b=eL(a.itemType);return"number"==typeof a.N?"array<"+b+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+b+">"}var eM=[cv,d,j,g,Q,cx,av,R(k),cy];function eN(b,a){if("error"===a.kind)return null;if("array"===b.kind){if("array"===a.kind&&(0===a.N&&"value"===a.itemType.kind||!eN(b.itemType,a.itemType))&&("number"!=typeof b.N||b.N===a.N))return null}else if(b.kind===a.kind)return null;else if("value"===b.kind){for(var c=0,d=eM;c<d.length;c+=1)if(!eN(d[c],a))return null}return"Expected "+eL(b)+" but found "+eL(a)+" instead."}function eO(b,a){return a.some(function(a){return a.kind===b.kind})}function eP(b,a){return a.some(function(a){return"null"===a?null===b:"array"===a?Array.isArray(b):"object"===a?b&&!Array.isArray(b)&&"object"==typeof b:a===typeof b})}var eQ=aK(function(b,a){var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function d(a){return(a=Math.round(a))<0?0:a>255?255:a}function e(a){return a<0?0:a>1?1:a}function f(a){return"%"===a[a.length-1]?d(parseFloat(a)/100*255):d(parseInt(a))}function g(a){return"%"===a[a.length-1]?e(parseFloat(a)/100):e(parseFloat(a))}function h(b,c,a){return(a<0?a+=1:a>1&&(a-=1),6*a<1)?b+(c-b)*a*6:2*a<1?c:3*a<2?b+(c-b)*(2/3-a)*6:b}try{a.parseCSSColor=function(q){var b=q.replace(/ /g,"").toLowerCase();if(b in c)return c[b].slice();if("#"===b[0]){if(4===b.length){var a=parseInt(b.substr(1),16);return a>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null}if(7===b.length){var a=parseInt(b.substr(1),16);return a>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null}return null}var j=b.indexOf("("),p=b.indexOf(")");if(-1!==j&&p+1===b.length){var r=b.substr(0,j),e=b.substr(j+1,p-(j+1)).split(","),k=1;switch(r){case"rgba":if(4!==e.length)return null;k=g(e.pop());case"rgb":if(3!==e.length)return null;return[f(e[0]),f(e[1]),f(e[2]),k];case"hsla":if(4!==e.length)return null;k=g(e.pop());case"hsl":if(3!==e.length)return null;var m=(parseFloat(e[0])%360+360)%360/360,n=g(e[1]),i=g(e[2]),l=i<=.5?i*(n+1):i+n-i*n,o=2*i-l;return[d(255*h(o,l,m+1/3)),d(255*h(o,l,m)),d(255*h(o,l,m-1/3)),k];default:return null}}return null}}catch(i){}}).parseCSSColor,s=function(b,c,d,a){void 0===a&&(a=1),this.r=b,this.g=c,this.b=d,this.a=a};s.parse=function(b){if(b){if(b instanceof s)return b;if("string"==typeof b){var a=eQ(b);if(a)return new s(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3])}}},s.prototype.toString=function(){var a=this.toArray(),b=a[0],c=a[1],d=a[2],e=a[3];return"rgba("+Math.round(b)+","+Math.round(c)+","+Math.round(d)+","+e+")"},s.prototype.toArray=function(){var b=this.r,c=this.g,d=this.b,a=this.a;return 0===a?[0,0,0,0]:[255*b/a,255*c/a,255*d/a,a]},s.black=new s(0,0,0,1),s.white=new s(1,1,1,1),s.transparent=new s(0,0,0,0),s.red=new s(1,0,0,1);var br=function(b,a,c){b?this.sensitivity=a?"variant":"case":this.sensitivity=a?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};br.prototype.compare=function(a,b){return this.collator.compare(a,b)},br.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var eR=function(a,b,c,d,e){this.text=a,this.image=b,this.scale=c,this.fontStack=d,this.textColor=e},aw=function(a){this.sections=a};aw.fromString=function(a){return new aw([new eR(a,null,null,null,null)])},aw.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(a){return 0!==a.text.length||a.image&&0!==a.image.name.length})},aw.factory=function(a){return a instanceof aw?a:aw.fromString(a)},aw.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(a){return a.text}).join("")},aw.prototype.serialize=function(){for(var b=["format"],d=0,e=this.sections;d<e.length;d+=1){var a=e[d];if(a.image){b.push(["image",a.image.name]);continue}b.push(a.text);var c={};a.fontStack&&(c["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(c["font-scale"]=a.scale),a.textColor&&(c["text-color"]=["rgba"].concat(a.textColor.toArray())),b.push(c)}return b};var aL=function(a){this.name=a.name,this.available=a.available};function eS(b,c,d,a){return"number"==typeof b&&b>=0&&b<=255&&"number"==typeof c&&c>=0&&c<=255&&"number"==typeof d&&d>=0&&d<=255?void 0===a||"number"==typeof a&&a>=0&&a<=1?null:"Invalid rgba value ["+[b,c,d,a].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof a?[b,c,d,a]:[b,c,d]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function eT(a){if(null===a)return!0;if("string"==typeof a)return!0;if("boolean"==typeof a)return!0;if("number"==typeof a)return!0;if(a instanceof s)return!0;if(a instanceof br)return!0;if(a instanceof aw)return!0;if(a instanceof aL)return!0;if(Array.isArray(a)){for(var b=0,c=a;b<c.length;b+=1)if(!eT(c[b]))return!1;return!0}if("object"!=typeof a)return!1;for(var d in a)if(!eT(a[d]))return!1;return!0}function eU(a){if(null===a)return cv;if("string"==typeof a)return j;if("boolean"==typeof a)return g;if("number"==typeof a)return d;if(a instanceof s)return Q;if(a instanceof br)return cw;if(a instanceof aw)return cx;if(a instanceof aL)return cy;if(!Array.isArray(a))return av;for(var b,h=a.length,c=0,e=a;c<e.length;c+=1){var f=eU(e[c]);if(b)if(b===f)continue;else{b=k;break}b=f}return R(b||k,h)}function eV(a){var b=typeof a;return null===a?"":"string"===b||"number"===b||"boolean"===b?String(a):a instanceof s||a instanceof aw||a instanceof aL?a.toString():JSON.stringify(a)}aL.prototype.toString=function(){return this.name},aL.fromString=function(a){return a?new aL({name:a,available:!1}):null},aL.prototype.serialize=function(){return["image",this.name]};var S=function(a,b){this.type=a,this.value=b};S.parse=function(b,d){if(2!==b.length)return d.error("'literal' expression requires exactly one argument, but found "+(b.length-1)+" instead.");if(!eT(b[1]))return d.error("invalid value");var e=b[1],c=eU(e),a=d.expectedType;return"array"===c.kind&&0===c.N&&a&&"array"===a.kind&&("number"!=typeof a.N||0===a.N)&&(c=a),new S(c,e)},S.prototype.evaluate=function(){return this.value},S.prototype.eachChild=function(){},S.prototype.outputDefined=function(){return!0},S.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof s?["rgba"].concat(this.value.toArray()):this.value instanceof aw?this.value.serialize():this.value};var cz=function(a){this.name="ExpressionEvaluationError",this.message=a};cz.prototype.toJSON=function(){return this.message};var eW={string:j,number:d,boolean:g,object:av},w=function(a,b){this.type=a,this.args=b};w.parse=function(a,c){if(a.length<2)return c.error("Expected at least one argument.");var b=1,g=a[0];if("array"===g){if(a.length>2){var e,f,h,d=a[1];if("string"!=typeof d||!(d in eW)||"object"===d)return c.error('The item type argument of "array" must be one of string, number, boolean',1);f=eW[d],b++}else f=k;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return c.error('The length argument to "array" must be a positive integer literal',2);h=a[2],b++}e=R(f,h)}else e=eW[g];for(var i=[];b<a.length;b++){var j=c.parse(a[b],b,k);if(!j)return null;i.push(j)}return new w(e,i)},w.prototype.evaluate=function(c){for(var a=0;a<this.args.length;a++){var b=this.args[a].evaluate(c);if(!eN(this.type,eU(b)))return b;if(a===this.args.length-1)throw new cz("Expected value to be of type "+eL(this.type)+", but found "+eL(eU(b))+" instead.")}return null},w.prototype.eachChild=function(a){this.args.forEach(a)},w.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},w.prototype.serialize=function(){var a=this.type,c=[a.kind];if("array"===a.kind){var b=a.itemType;if("string"===b.kind||"number"===b.kind||"boolean"===b.kind){c.push(b.kind);var d=a.N;("number"==typeof d||this.args.length>1)&&c.push(d)}}return c.concat(this.args.map(function(a){return a.serialize()}))};var T=function(a){this.type=cx,this.sections=a};T.parse=function(c,b){if(c.length<2)return b.error("Expected at least one argument.");var m=c[1];if(!Array.isArray(m)&&"object"==typeof m)return b.error("First argument must be an image or text section.");for(var e=[],h=!1,f=1;f<=c.length-1;++f){var a=c[f];if(h&&"object"==typeof a&&!Array.isArray(a)){h=!1;var n=null;if(a["font-scale"]&&!(n=b.parse(a["font-scale"],1,d)))return null;var o=null;if(a["text-font"]&&!(o=b.parse(a["text-font"],1,R(j))))return null;var p=null;if(a["text-color"]&&!(p=b.parse(a["text-color"],1,Q)))return null;var i=e[e.length-1];i.scale=n,i.font=o,i.textColor=p}else{var l=b.parse(c[f],1,k);if(!l)return null;var g=l.type.kind;if("string"!==g&&"value"!==g&&"null"!==g&&"resolvedImage"!==g)return b.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,e.push({content:l,scale:null,font:null,textColor:null})}}return new T(e)},T.prototype.evaluate=function(a){return new aw(this.sections.map(function(b){var c=b.content.evaluate(a);return eU(c)===cy?new eR("",c,null,null,null):new eR(eV(c),null,b.scale?b.scale.evaluate(a):null,b.font?b.font.evaluate(a).join(","):null,b.textColor?b.textColor.evaluate(a):null)}))},T.prototype.eachChild=function(b){for(var c=0,d=this.sections;c<d.length;c+=1){var a=d[c];b(a.content),a.scale&&b(a.scale),a.font&&b(a.font),a.textColor&&b(a.textColor)}},T.prototype.outputDefined=function(){return!1},T.prototype.serialize=function(){for(var c=["format"],d=0,e=this.sections;d<e.length;d+=1){var a=e[d];c.push(a.content.serialize());var b={};a.scale&&(b["font-scale"]=a.scale.serialize()),a.font&&(b["text-font"]=a.font.serialize()),a.textColor&&(b["text-color"]=a.textColor.serialize()),c.push(b)}return c};var U=function(a){this.type=cy,this.input=a};U.parse=function(b,a){if(2!==b.length)return a.error("Expected two arguments.");var c=a.parse(b[1],1,j);return c?new U(c):a.error("No image name provided.")},U.prototype.evaluate=function(a){var c=this.input.evaluate(a),b=aL.fromString(c);return b&&a.availableImages&&(b.available=a.availableImages.indexOf(c)> -1),b},U.prototype.eachChild=function(a){a(this.input)},U.prototype.outputDefined=function(){return!1},U.prototype.serialize=function(){return["image",this.input.serialize()]};var eX={"to-boolean":g,"to-color":Q,"to-number":d,"to-string":j},B=function(a,b){this.type=a,this.args=b};B.parse=function(a,c){if(a.length<2)return c.error("Expected at least one argument.");var d=a[0];if(("to-boolean"===d||"to-string"===d)&&2!==a.length)return c.error("Expected one argument.");for(var g=eX[d],e=[],b=1;b<a.length;b++){var f=c.parse(a[b],b,k);if(!f)return null;e.push(f)}return new B(g,e)},B.prototype.evaluate=function(b){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(b));if("color"===this.type.kind){for(var a,c,d=0,g=this.args;d<g.length;d+=1){if(a=g[d].evaluate(b),c=null,a instanceof s)return a;if("string"==typeof a){var h=b.parseColor(a);if(h)return h}else if(Array.isArray(a)&&!(c=a.length<3||a.length>4?"Invalid rbga value "+JSON.stringify(a)+": expected an array containing either three or four numeric values.":eS(a[0],a[1],a[2],a[3])))return new s(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new cz(c||"Could not parse color from value '"+("string"==typeof a?a:String(JSON.stringify(a)))+"'")}if("number"===this.type.kind){for(var e=null,f=0,i=this.args;f<i.length;f+=1){if(null===(e=i[f].evaluate(b)))return 0;var j=Number(e);if(!isNaN(j))return j}throw new cz("Could not convert "+JSON.stringify(e)+" to number.")}return"formatted"===this.type.kind?aw.fromString(eV(this.args[0].evaluate(b))):"resolvedImage"===this.type.kind?aL.fromString(eV(this.args[0].evaluate(b))):eV(this.args[0].evaluate(b))},B.prototype.eachChild=function(a){this.args.forEach(a)},B.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},B.prototype.serialize=function(){if("formatted"===this.type.kind)return new T([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new U(this.args[0]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(b){a.push(b.serialize())}),a};var eY=["Unknown","Point","LineString","Polygon"],V=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};V.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},V.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?eY[this.feature.type]:this.feature.type:null},V.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},V.prototype.canonicalID=function(){return this.canonical},V.prototype.properties=function(){return this.feature&&this.feature.properties||{}},V.prototype.parseColor=function(a){var b=this._parseColorCache[a];return b||(b=this._parseColorCache[a]=s.parse(a)),b};var I=function(a,b,c,d){this.name=a,this.type=b,this._evaluate=c,this.args=d};I.prototype.evaluate=function(a){return this._evaluate(a,this.args)},I.prototype.eachChild=function(a){this.args.forEach(a)},I.prototype.outputDefined=function(){return!1},I.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},I.parse=function(f,c){var n,j=f[0],b=I.definitions[j];if(!b)return c.error('Unknown expression "'+j+'". If you wanted a literal array, use ["literal", [...]].',0);for(var u=Array.isArray(b)?b[0]:b.type,o=Array.isArray(b)?[[b[1],b[2]]]:b.overloads,h=o.filter(function(b){var a=b[0];return!Array.isArray(a)||a.length===f.length-1}),e=null,k=0,p=h;k<p.length;k+=1){var q=p[k],a=q[0],v=q[1];e=new ax(c.registry,c.path,null,c.scope);for(var d=[],r=!1,i=1;i<f.length;i++){var w=f[i],x=Array.isArray(a)?a[i-1]:a.type,s=e.parse(w,1+d.length,x);if(!s){r=!0;break}d.push(s)}if(!r){if(Array.isArray(a)&&a.length!==d.length){e.error("Expected "+a.length+" arguments, but found "+d.length+" instead.");continue}for(var g=0;g<d.length;g++){var y=Array.isArray(a)?a[g]:a.type,z=d[g];e.concat(g+1).checkSubtype(y,z.type)}if(0===e.errors.length)return new I(j,u,v,d)}}if(1===h.length)(n=c.errors).push.apply(n,e.errors);else{for(var A=(h.length?h:o).map(function(b){var a;return a=b[0],Array.isArray(a)?"("+a.map(eL).join(", ")+")":"("+eL(a.type)+"...)"}).join(" | "),l=[],m=1;m<f.length;m++){var t=c.parse(f[m],1+l.length);if(!t)return null;l.push(eL(t.type))}c.error("Expected arguments of type "+A+", but found ("+l.join(", ")+") instead.")}return null},I.register=function(b,a){for(var c in I.definitions=a,a)b[c]=I};var W=function(a,b,c){this.type=cw,this.locale=c,this.caseSensitive=a,this.diacriticSensitive=b};function eZ(a,b){a[0]=Math.min(a[0],b[0]),a[1]=Math.min(a[1],b[1]),a[2]=Math.max(a[2],b[0]),a[3]=Math.max(a[3],b[1])}function e$(a,b){return!(a[0]<=b[0])&& !(a[2]>=b[2])&& !(a[1]<=b[1])&&!(a[3]>=b[3])}function e_(a,c){var d=(180+a[0])/360,e=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,b=Math.pow(2,c.z);return[Math.round(d*b*8192),Math.round(e*b*8192)]}function e0(a,b,c){var d=a[0]-b[0],e=a[1]-b[1],f=a[0]-c[0],g=a[1]-c[1];return d*g-f*e==0&&d*f<=0&&e*g<=0}function e1(b,a,c){return a[1]>b[1]!=c[1]>b[1]&&b[0]<(c[0]-a[0])*(b[1]-a[1])/(c[1]-a[1])+a[0]}function e2(e,f){for(var c=!1,d=0,g=f.length;d<g;d++)for(var b=f[d],a=0,h=b.length;a<h-1;a++){if(e0(e,b[a],b[a+1]))return!1;e1(e,b[a],b[a+1])&&(c=!c)}return c}function e3(c,b){for(var a=0;a<b.length;a++)if(e2(c,b[a]))return!0;return!1}function e4(b,c,a,d){var i=b[0]-a[0],j=b[1]-a[1],k=c[0]-a[0],l=c[1]-a[1],e=d[0]-a[0],f=d[1]-a[1],g=i*f-e*j,h=k*f-e*l;return g>0&&h<0||g<0&&h>0}function e5(a,b,c,d){var e,f,g=[b[0]-a[0],b[1]-a[1]];return 0!=(e=[d[0]-c[0],d[1]-c[1]],f=g,e[0]*f[1]-e[1]*f[0])&&!!(e4(a,b,c,d)&&e4(c,d,a,b))}function e6(e,f,g){for(var b=0,d=g;b<d.length;b+=1)for(var c=d[b],a=0;a<c.length-1;++a)if(e5(e,f,c[a],c[a+1]))return!0;return!1}function e7(a,d){for(var c=0;c<a.length;++c)if(!e2(a[c],d))return!1;for(var b=0;b<a.length-1;++b)if(e6(a[b],a[b+1],d))return!1;return!0}function e8(c,b){for(var a=0;a<b.length;a++)if(e7(c,b[a]))return!0;return!1}function e9(b,g,h){for(var d=[],a=0;a<b.length;a++){for(var e=[],c=0;c<b[a].length;c++){var f=e_(b[a][c],h);eZ(g,f),e.push(f)}d.push(e)}return d}function fa(b,d,e){for(var c=[],a=0;a<b.length;a++){var f=e9(b[a],d,e);c.push(f)}return c}function fb(a,f,b,c){if(a[0]<b[0]||a[0]>b[2]){var d=.5*c,e=a[0]-b[0]>d?-c:b[0]-a[0]>d?c:0;0===e&&(e=a[0]-b[2]>d?-c:b[2]-a[0]>d?c:0),a[0]+=e}eZ(f,a)}function fc(j,k,l,a){for(var m=8192*Math.pow(2,a.z),d=[8192*a.x,8192*a.y],e=[],b=0,f=j;b<f.length;b+=1)for(var n=f[b],c=0,g=n;c<g.length;c+=1){var h=g[c],i=[h.x+d[0],h.y+d[1]];fb(i,k,l,m),e.push(i)}return e}function fd(q,a,r,b){for(var h=8192*Math.pow(2,b.z),i=[8192*b.x,8192*b.y],c=[],d=0,j=q;d<j.length;d+=1){for(var s=j[d],k=[],e=0,l=s;e<l.length;e+=1){var m=l[e],n=[m.x+i[0],m.y+i[1]];eZ(a,n),k.push(n)}c.push(k)}if(a[2]-a[0]<=h/2){(u=a)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var f=0,o=c;f<o.length;f+=1)for(var u,t=o[f],g=0,p=t;g<p.length;g+=1)fb(p[g],a,r,h)}return c}W.parse=function(c,b){if(2!==c.length)return b.error("Expected one argument.");var a=c[1];if("object"!=typeof a||Array.isArray(a))return b.error("Collator options argument must be an object.");var d=b.parse(void 0!==a["case-sensitive"]&&a["case-sensitive"],1,g);if(!d)return null;var e=b.parse(void 0!==a["diacritic-sensitive"]&&a["diacritic-sensitive"],1,g);if(!e)return null;var f=null;return!a.locale||(f=b.parse(a.locale,1,j))?new W(d,e,f):null},W.prototype.evaluate=function(a){return new br(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},W.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},W.prototype.outputDefined=function(){return!1},W.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var X=function(a,b){this.type=g,this.geojson=a,this.geometries=b};function fe(a){if(a instanceof I){if("get"===a.name&&1===a.args.length)return!1;if("feature-state"===a.name)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}if(a instanceof X)return!1;var b=!0;return a.eachChild(function(a){b&&!fe(a)&&(b=!1)}),b}function ff(a){if(a instanceof I&&"feature-state"===a.name)return!1;var b=!0;return a.eachChild(function(a){b&&!ff(a)&&(b=!1)}),b}function fg(a,b){if(a instanceof I&&b.indexOf(a.name)>=0)return!1;var c=!0;return a.eachChild(function(a){c&&!fg(a,b)&&(c=!1)}),c}X.parse=function(b,d){if(2!==b.length)return d.error("'within' expression requires exactly one argument, but found "+(b.length-1)+" instead.");if(eT(b[1])){var a=b[1];if("FeatureCollection"===a.type)for(var c=0;c<a.features.length;++c){var e=a.features[c].geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new X(a,a.features[c].geometry)}else if("Feature"===a.type){var f=a.geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new X(a,a.geometry)}else if("Polygon"===a.type||"MultiPolygon"===a.type)return new X(a,a)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},X.prototype.evaluate=function(a){if(null!=a.geometry()&&null!=a.canonicalID()){if("Point"===a.geometryType())return function(e,b){var c=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=e.canonicalID();if("Polygon"===b.type){var j=e9(b.coordinates,a,d),k=fc(e.geometry(),c,a,d);if(!e$(c,a))return!1;for(var f=0,h=k;f<h.length;f+=1)if(!e2(h[f],j))return!1}if("MultiPolygon"===b.type){var l=fa(b.coordinates,a,d),m=fc(e.geometry(),c,a,d);if(!e$(c,a))return!1;for(var g=0,i=m;g<i.length;g+=1)if(!e3(i[g],l))return!1}return!0}(a,this.geometries);if("LineString"===a.geometryType())return function(e,b){var c=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],d=e.canonicalID();if("Polygon"===b.type){var j=e9(b.coordinates,a,d),k=fd(e.geometry(),c,a,d);if(!e$(c,a))return!1;for(var f=0,h=k;f<h.length;f+=1)if(!e7(h[f],j))return!1}if("MultiPolygon"===b.type){var l=fa(b.coordinates,a,d),m=fd(e.geometry(),c,a,d);if(!e$(c,a))return!1;for(var g=0,i=m;g<i.length;g+=1)if(!e8(i[g],l))return!1}return!0}(a,this.geometries)}return!1},X.prototype.eachChild=function(){},X.prototype.outputDefined=function(){return!0},X.prototype.serialize=function(){return["within",this.geojson]};var Y=function(b,a){this.type=a.type,this.name=b,this.boundExpression=a};Y.parse=function(c,b){if(2!==c.length||"string"!=typeof c[1])return b.error("'var' expression requires exactly one string literal argument.");var a=c[1];return b.scope.has(a)?new Y(a,b.scope.get(a)):b.error('Unknown variable "'+a+'". Make sure "'+a+'" has been bound in an enclosing "let" expression before using it.',1)},Y.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},Y.prototype.eachChild=function(){},Y.prototype.outputDefined=function(){return!1},Y.prototype.serialize=function(){return["var",this.name]};var ax=function(d,a,e,b,c){void 0===a&&(a=[]),void 0===b&&(b=new aZ),void 0===c&&(c=[]),this.registry=d,this.path=a,this.key=a.map(function(a){return"["+a+"]"}).join(""),this.scope=b,this.errors=c,this.expectedType=e};function fh(a){if(a instanceof Y)return fh(a.boundExpression);if(a instanceof I&&"error"===a.name)return!1;if(a instanceof W)return!1;if(a instanceof X)return!1;var c=a instanceof B||a instanceof w,b=!0;return a.eachChild(function(a){b=c?b&&fh(a):b&&a instanceof S}),!!b&&fe(a)&&fg(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function fi(b,c){for(var d,g,h=b.length-1,e=0,f=h,a=0;e<=f;)if(d=b[a=Math.floor((e+f)/2)],g=b[a+1],d<=c){if(a===h||c<g)return a;e=a+1}else if(d>c)f=a-1;else throw new cz("Input is not a number.");return 0}ax.prototype.parse=function(b,c,d,e,a){return(void 0===a&&(a={}),c)?this.concat(c,d,e)._parse(b,a):this._parse(b,a)},ax.prototype._parse=function(a,f){function g(a,b,c){return"assert"===c?new w(b,[a]):"coerce"===c?new B(b,[a]):a}if((null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a)&&(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var d=a[0];if("string"!=typeof d)return this.error("Expression name must be a string, but found "+typeof d+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var h=this.registry[d];if(h){var b=h.parse(a,this);if(!b)return null;if(this.expectedType){var c=this.expectedType,e=b.type;if(("string"===c.kind||"number"===c.kind||"boolean"===c.kind||"object"===c.kind||"array"===c.kind)&&"value"===e.kind)b=g(b,c,f.typeAnnotation||"assert");else if(("color"===c.kind||"formatted"===c.kind||"resolvedImage"===c.kind)&&("value"===e.kind||"string"===e.kind))b=g(b,c,f.typeAnnotation||"coerce");else if(this.checkSubtype(c,e))return null}if(!(b instanceof S)&&"resolvedImage"!==b.type.kind&&fh(b)){var i=new V;try{b=new S(b.type,b.evaluate(i))}catch(j){return this.error(j.message),null}}return b}return this.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===a?this.error("'undefined' value invalid. Use null instead."):"object"==typeof a?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof a+" instead.")},ax.prototype.concat=function(a,c,b){var d="number"==typeof a?this.path.concat(a):this.path,e=b?this.scope.concat(b):this.scope;return new ax(this.registry,d,c||null,e,this.errors)},ax.prototype.error=function(c){for(var b=[],a=arguments.length-1;a-- >0;)b[a]=arguments[a+1];var d=""+this.key+b.map(function(a){return"["+a+"]"}).join("");this.errors.push(new eK(d,c))},ax.prototype.checkSubtype=function(b,c){var a=eN(b,c);return a&&this.error(a),a};var Z=function(d,e,f){this.type=d,this.input=e,this.labels=[],this.outputs=[];for(var a=0,b=f;a<b.length;a+=1){var c=b[a],g=c[0],h=c[1];this.labels.push(g),this.outputs.push(h)}};function bs(b,c,a){return b*(1-a)+c*a}Z.parse=function(b,a){if(b.length-1<4)return a.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if((b.length-1)%2!=0)return a.error("Expected an even number of arguments.");var i=a.parse(b[1],1,d);if(!i)return null;var e=[],f=null;a.expectedType&&"value"!==a.expectedType.kind&&(f=a.expectedType);for(var c=1;c<b.length;c+=2){var g=1===c?-1/0:b[c],k=b[c+1],j=c,l=c+1;if("number"!=typeof g)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(e.length&&e[e.length-1][0]>=g)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);var h=a.parse(k,l,f);if(!h)return null;f=f||h.type,e.push([g,h])}return new Z(f,i,e)},Z.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;return d>=b[e-1]?c[e-1].evaluate(a):c[fi(b,d)].evaluate(a)},Z.prototype.eachChild=function(b){b(this.input);for(var a=0,c=this.outputs;a<c.length;a+=1)b(c[a])},Z.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},Z.prototype.serialize=function(){for(var b=["step",this.input.serialize()],a=0;a<this.labels.length;a++)a>0&&b.push(this.labels[a]),b.push(this.outputs[a].serialize());return b};var fj=Object.freeze({__proto__:null,number:bs,color:function(a,b,c){return new s(bs(a.r,b.r,c),bs(a.g,b.g,c),bs(a.b,b.b,c),bs(a.a,b.a,c))},array:function(a,b,c){return a.map(function(a,d){return bs(a,b[d],c)})}}),fk=4/29,ay=6/29,fl=3*ay*ay,fm=ay*ay*ay,fn=Math.PI/180,fo=180/Math.PI;function fp(a){return a>fm?Math.pow(a,1/3):a/fl+fk}function fq(a){return a>ay?a*a*a:fl*(a-fk)}function fr(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function fs(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function cA(a){var b=fs(a.r),c=fs(a.g),d=fs(a.b),f=fp((.4124564*b+.3575761*c+.1804375*d)/.95047),e=fp((.2126729*b+.7151522*c+.072175*d)/1),g=fp((.0193339*b+.119192*c+.9503041*d)/1.08883);return{l:116*e-16,a:500*(f-e),b:200*(e-g),alpha:a.a}}function cB(b){var a=(b.l+16)/116,c=isNaN(b.a)?a:a+b.a/500,d=isNaN(b.b)?a:a-b.b/200;return a=1*fq(a),c=.95047*fq(c),d=1.08883*fq(d),new s(fr(3.2404542*c-1.5371385*a-.4985314*d),fr(-0.969266*c+1.8760108*a+.041556*d),fr(.0556434*c-.2040259*a+1.0572252*d),b.alpha)}var cC={forward:cA,reverse:cB,interpolate:function(a,b,c){return{l:bs(a.l,b.l,c),a:bs(a.a,b.a,c),b:bs(a.b,b.b,c),alpha:bs(a.alpha,b.alpha,c)}}},cD={forward:function(e){var a=cA(e),f=a.l,b=a.a,c=a.b,d=Math.atan2(c,b)*fo;return{h:d<0?d+360:d,c:Math.sqrt(b*b+c*c),l:f,alpha:e.a}},reverse:function(a){var b=a.h*fn,c=a.c;return cB({l:a.l,a:Math.cos(b)*c,b:Math.sin(b)*c,alpha:a.alpha})},interpolate:function(b,c,d){var e,f,g,a;return{h:(e=b.h,f=c.h,g=d,a=f-e,e+g*(a>180||a< -180?a-360*Math.round(a/360):a)),c:bs(b.c,c.c,d),l:bs(b.l,c.l,d),alpha:bs(b.alpha,c.alpha,d)}}},ft=Object.freeze({__proto__:null,lab:cC,hcl:cD}),C=function(d,e,f,g,h){this.type=d,this.operator=e,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(var a=0,b=h;a<b.length;a+=1){var c=b[a],i=c[0],j=c[1];this.labels.push(i),this.outputs.push(j)}};function fu(e,a,c,f){var b=f-c,d=e-c;return 0===b?0:1===a?d/b:(Math.pow(a,d)-1)/(Math.pow(a,b)-1)}C.interpolationFactor=function(a,d,e,f){var b=0;if("exponential"===a.name)b=fu(d,a.base,e,f);else if("linear"===a.name)b=fu(d,1,e,f);else if("cubic-bezier"===a.name){var c=a.controlPoints;b=new d8(c[0],c[1],c[2],c[3]).solve(fu(d,1,e,f))}return b},C.parse=function(e,a){var h=e[0],b=e[1],i=e[2],j=e.slice(3);if(!Array.isArray(b)||0===b.length)return a.error("Expected an interpolation type expression.",1);if("linear"===b[0])b={name:"linear"};else if("exponential"===b[0]){var n=b[1];if("number"!=typeof n)return a.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:n}}else{if("cubic-bezier"!==b[0])return a.error("Unknown interpolation type "+String(b[0]),1,0);var k=b.slice(1);if(4!==k.length||k.some(function(a){return"number"!=typeof a||a<0||a>1}))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:k}}if(e.length-1<4)return a.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(!(i=a.parse(i,2,d)))return null;var g=[],c=null;"interpolate-hcl"===h||"interpolate-lab"===h?c=Q:a.expectedType&&"value"!==a.expectedType.kind&&(c=a.expectedType);for(var f=0;f<j.length;f+=2){var l=j[f],p=j[f+1],o=f+3,q=f+4;if("number"!=typeof l)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(g.length&&g[g.length-1][0]>=l)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',o);var m=a.parse(p,q,c);if(!m)return null;c=c||m.type,g.push([l,m])}return"number"===c.kind||"color"===c.kind||"array"===c.kind&&"number"===c.itemType.kind&&"number"==typeof c.N?new C(c,h,b,i,g):a.error("Type "+eL(c)+" is not interpolatable.")},C.prototype.evaluate=function(b){var a=this.labels,c=this.outputs;if(1===a.length)return c[0].evaluate(b);var d=this.input.evaluate(b);if(d<=a[0])return c[0].evaluate(b);var i=a.length;if(d>=a[i-1])return c[i-1].evaluate(b);var e=fi(a,d),j=a[e],k=a[e+1],f=C.interpolationFactor(this.interpolation,d,j,k),g=c[e].evaluate(b),h=c[e+1].evaluate(b);return"interpolate"===this.operator?fj[this.type.kind.toLowerCase()](g,h,f):"interpolate-hcl"===this.operator?cD.reverse(cD.interpolate(cD.forward(g),cD.forward(h),f)):cC.reverse(cC.interpolate(cC.forward(g),cC.forward(h),f))},C.prototype.eachChild=function(b){b(this.input);for(var a=0,c=this.outputs;a<c.length;a+=1)b(c[a])},C.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})},C.prototype.serialize=function(){c="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var c,b=[this.operator,c,this.input.serialize()],a=0;a<this.labels.length;a++)b.push(this.labels[a],this.outputs[a].serialize());return b};var $=function(a,b){this.type=a,this.args=b};$.parse=function(g,d){if(g.length<2)return d.error("Expectected at least one argument.");var a=null,c=d.expectedType;c&&"value"!==c.kind&&(a=c);for(var b=[],e=0,h=g.slice(1);e<h.length;e+=1){var i=h[e],f=d.parse(i,1+b.length,a,void 0,{typeAnnotation:"omit"});if(!f)return null;a=a||f.type,b.push(f)}return c&&b.some(function(a){return eN(c,a.type)})?new $(k,b):new $(a,b)},$.prototype.evaluate=function(f){for(var b,a=null,d=0,c=0,e=this.args;c<e.length;c+=1){var g=e[c];if(d++,(a=g.evaluate(f))&&a instanceof aL&&!a.available&&(b||(b=a.name),a=null,d===this.args.length&&(a=b)),null!==a)break}return a},$.prototype.eachChild=function(a){this.args.forEach(a)},$.prototype.outputDefined=function(){return this.args.every(function(a){return a.outputDefined()})},$.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(b){a.push(b.serialize())}),a};var _=function(b,a){this.type=a.type,this.bindings=[].concat(b),this.result=a};_.prototype.evaluate=function(a){return this.result.evaluate(a)},_.prototype.eachChild=function(b){for(var a=0,c=this.bindings;a<c.length;a+=1)b(c[a][1]);b(this.result)},_.parse=function(a,c){if(a.length<4)return c.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var e=[],b=1;b<a.length-1;b+=2){var d=a[b];if("string"!=typeof d)return c.error("Expected string, but found "+typeof d+" instead.",b);if(/[^a-zA-Z0-9_]/.test(d))return c.error("Variable names must contain only alphanumeric characters or '_'.",b);var f=c.parse(a[b+1],b+1);if(!f)return null;e.push([d,f])}var g=c.parse(a[a.length-1],a.length-1,c.expectedType,e);return g?new _(e,g):null},_.prototype.outputDefined=function(){return this.result.outputDefined()},_.prototype.serialize=function(){for(var a=["let"],b=0,c=this.bindings;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];a.push(e,f.serialize())}return a.push(this.result.serialize()),a};var aa=function(a,b,c){this.type=a,this.index=b,this.input=c};aa.parse=function(a,b){if(3!==a.length)return b.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var e=b.parse(a[1],1,d),c=b.parse(a[2],2,R(b.expectedType||k));if(!e||!c)return null;var f=c.type;return new aa(f.itemType,e,c)},aa.prototype.evaluate=function(c){var a=this.index.evaluate(c),b=this.input.evaluate(c);if(a<0)throw new cz("Array index out of bounds: "+a+" < 0.");if(a>=b.length)throw new cz("Array index out of bounds: "+a+" > "+(b.length-1)+".");if(a!==Math.floor(a))throw new cz("Array index must be an integer, but found "+a+" instead.");return b[a]},aa.prototype.eachChild=function(a){a(this.index),a(this.input)},aa.prototype.outputDefined=function(){return!1},aa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ab=function(a,b){this.type=g,this.needle=a,this.haystack=b};ab.parse=function(a,b){if(3!==a.length)return b.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1,k),e=b.parse(a[2],2,k);return c&&e?eO(c.type,[g,j,d,cv,k])?new ab(c,e):b.error("Expected first argument to be of type boolean, string, number or null, but found "+eL(c.type)+" instead"):null},ab.prototype.evaluate=function(c){var b=this.needle.evaluate(c),a=this.haystack.evaluate(c);if(!a)return!1;if(!eP(b,["boolean","string","number","null"]))throw new cz("Expected first argument to be of type boolean, string, number or null, but found "+eL(eU(b))+" instead.");if(!eP(a,["string","array"]))throw new cz("Expected second argument to be of type array or string, but found "+eL(eU(a))+" instead.");return a.indexOf(b)>=0},ab.prototype.eachChild=function(a){a(this.needle),a(this.haystack)},ab.prototype.outputDefined=function(){return!0},ab.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ac=function(a,b,c){this.type=d,this.needle=a,this.haystack=b,this.fromIndex=c};ac.parse=function(a,b){if(a.length<=2||a.length>=5)return b.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1,k),e=b.parse(a[2],2,k);if(!c||!e)return null;if(!eO(c.type,[g,j,d,cv,k]))return b.error("Expected first argument to be of type boolean, string, number or null, but found "+eL(c.type)+" instead");if(4!==a.length)return new ac(c,e);var f=b.parse(a[3],3,d);return f?new ac(c,e,f):null},ac.prototype.evaluate=function(c){var a=this.needle.evaluate(c),b=this.haystack.evaluate(c);if(!eP(a,["boolean","string","number","null"]))throw new cz("Expected first argument to be of type boolean, string, number or null, but found "+eL(eU(a))+" instead.");if(!eP(b,["string","array"]))throw new cz("Expected second argument to be of type array or string, but found "+eL(eU(b))+" instead.");if(this.fromIndex){var d=this.fromIndex.evaluate(c);return b.indexOf(a,d)}return b.indexOf(a)},ac.prototype.eachChild=function(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)},ac.prototype.outputDefined=function(){return!1},ac.prototype.serialize=function(){if(null!=this.fromIndex&& void 0!==this.fromIndex){var a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ad=function(a,b,c,d,e,f){this.inputType=a,this.type=b,this.input=c,this.cases=d,this.outputs=e,this.otherwise=f};ad.parse=function(b,c){if(b.length<5)return c.error("Expected at least 4 arguments, but found only "+(b.length-1)+".");if(b.length%2!=1)return c.error("Expected an even number of arguments.");c.expectedType&&"value"!==c.expectedType.kind&&(g=c.expectedType);for(var f,g,j={},l=[],d=2;d<b.length-1;d+=2){var h=b[d],q=b[d+1];Array.isArray(h)||(h=[h]);var e=c.concat(d);if(0===h.length)return e.error("Expected at least one branch label.");for(var m=0,o=h;m<o.length;m+=1){var a=o[m];if("number"!=typeof a&&"string"!=typeof a)return e.error("Branch labels must be numbers or strings.");if("number"==typeof a&&Math.abs(a)>Number.MAX_SAFE_INTEGER)return e.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof a&&Math.floor(a)!==a)return e.error("Numeric branch labels must be integer values.");if(f){if(e.checkSubtype(f,eU(a)))return null}else f=eU(a);if(void 0!==j[String(a)])return e.error("Branch labels must be unique.");j[String(a)]=l.length}var n=c.parse(q,d,g);if(!n)return null;g=g||n.type,l.push(n)}var i=c.parse(b[1],1,k);if(!i)return null;var p=c.parse(b[b.length-1],b.length-1,g);return p?"value"!==i.type.kind&&c.concat(1).checkSubtype(f,i.type)?null:new ad(f,g,i,j,l,p):null},ad.prototype.evaluate=function(a){var b=this.input.evaluate(a);return(eU(b)===this.inputType&&this.outputs[this.cases[b]]||this.otherwise).evaluate(a)},ad.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},ad.prototype.outputDefined=function(){return this.outputs.every(function(a){return a.outputDefined()})&&this.otherwise.outputDefined()},ad.prototype.serialize=function(){for(var n=this,a=["match",this.input.serialize()],m=Object.keys(this.cases).sort(),c=[],h={},d=0,i=m;d<i.length;d+=1){var b=i[d],e=h[this.cases[b]];void 0===e?(h[this.cases[b]]=c.length,c.push([this.cases[b],[b]])):c[e][1].push(b)}for(var j=function(a){return"number"===n.inputType.kind?Number(a):a},f=0,k=c;f<k.length;f+=1){var l=k[f],e=l[0],g=l[1];1===g.length?a.push(j(g[0])):a.push(g.map(j)),a.push(this.outputs[outputIndex$1].serialize())}return a.push(this.otherwise.serialize()),a};var ae=function(a,b,c){this.type=a,this.branches=b,this.otherwise=c};ae.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return b.error("Expected an odd number of arguments.");b.expectedType&&"value"!==b.expectedType.kind&&(d=b.expectedType);for(var d,f=[],c=1;c<a.length-1;c+=2){var h=b.parse(a[c],c,g);if(!h)return null;var e=b.parse(a[c+1],c+1,d);if(!e)return null;f.push([h,e]),d=d||e.type}var i=b.parse(a[a.length-1],a.length-1,d);return i?new ae(d,f,i):null},ae.prototype.evaluate=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];if(e.evaluate(a))return f.evaluate(a)}return this.otherwise.evaluate(a)},ae.prototype.eachChild=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0],f=d[1];a(e),a(f)}a(this.otherwise)},ae.prototype.outputDefined=function(){return this.branches.every(function(a){return a[0],a[1].outputDefined()})&&this.otherwise.outputDefined()},ae.prototype.serialize=function(){var a=["case"];return this.eachChild(function(b){a.push(b.serialize())}),a};var af=function(a,b,c,d){this.type=a,this.input=b,this.beginIndex=c,this.endIndex=d};function fv(b,a){return"=="===b||"!="===b?"boolean"===a.kind||"string"===a.kind||"number"===a.kind||"null"===a.kind||"value"===a.kind:"string"===a.kind||"number"===a.kind||"value"===a.kind}function cE(d,a,b,c){return 0===c.compare(a,b)}function ag(a,b,c){var d="=="!==a&&"!="!==a;return function(){function e(a,b,c){this.type=g,this.lhs=a,this.rhs=b,this.collator=c,this.hasUntypedArgument="value"===a.type.kind||"value"===b.type.kind}return e.parse=function(f,c){if(3!==f.length&&4!==f.length)return c.error("Expected two or three arguments.");var g=f[0],a=c.parse(f[1],1,k);if(!a)return null;if(!fv(g,a.type))return c.concat(1).error('"'+g+"\" comparisons are not supported for type '"+eL(a.type)+"'.");var b=c.parse(f[2],2,k);if(!b)return null;if(!fv(g,b.type))return c.concat(2).error('"'+g+"\" comparisons are not supported for type '"+eL(b.type)+"'.");if(a.type.kind!==b.type.kind&&"value"!==a.type.kind&&"value"!==b.type.kind)return c.error("Cannot compare types '"+eL(a.type)+"' and '"+eL(b.type)+"'.");d&&("value"===a.type.kind&&"value"!==b.type.kind?a=new w(b.type,[a]):"value"!==a.type.kind&&"value"===b.type.kind&&(b=new w(a.type,[b])));var h=null;if(4===f.length){if("string"!==a.type.kind&&"string"!==b.type.kind&&"value"!==a.type.kind&&"value"!==b.type.kind)return c.error("Cannot use collator to compare non-string types.");if(!(h=c.parse(f[3],3,cw)))return null}return new e(a,b,h)},e.prototype.evaluate=function(e){var f=this.lhs.evaluate(e),g=this.rhs.evaluate(e);if(d&&this.hasUntypedArgument){var h=eU(f),i=eU(g);if(h.kind!==i.kind||!("string"===h.kind||"number"===h.kind))throw new cz('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+h.kind+", "+i.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){var j=eU(f),k=eU(g);if("string"!==j.kind||"string"!==k.kind)return b(e,f,g)}return this.collator?c(e,f,g,this.collator.evaluate(e)):b(e,f,g)},e.prototype.eachChild=function(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)},e.prototype.outputDefined=function(){return!0},e.prototype.serialize=function(){var b=[a];return this.eachChild(function(a){b.push(a.serialize())}),b},e}()}af.parse=function(a,c){if(a.length<=2||a.length>=5)return c.error("Expected 3 or 4 arguments, but found "+(a.length-1)+" instead.");var b=c.parse(a[1],1,k),e=c.parse(a[2],2,d);if(!b||!e)return null;if(!eO(b.type,[R(k),j,k]))return c.error("Expected first argument to be of type array or string, but found "+eL(b.type)+" instead");if(4!==a.length)return new af(b.type,b,e);var f=c.parse(a[3],3,d);return f?new af(b.type,b,e,f):null},af.prototype.evaluate=function(b){var a=this.input.evaluate(b),c=this.beginIndex.evaluate(b);if(!eP(a,["string","array"]))throw new cz("Expected first argument to be of type array or string, but found "+eL(eU(a))+" instead.");if(this.endIndex){var d=this.endIndex.evaluate(b);return a.slice(c,d)}return a.slice(c)},af.prototype.eachChild=function(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)},af.prototype.outputDefined=function(){return!1},af.prototype.serialize=function(){if(null!=this.endIndex&& void 0!==this.endIndex){var a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var cF=ag("==",function(c,a,b){return a===b},cE),cG=ag("!=",function(c,a,b){return a!==b},function(a,b,c,d){return!cE(a,b,c,d)}),cH=ag("<",function(c,a,b){return a<b},function(d,a,b,c){return 0>c.compare(a,b)}),cI=ag(">",function(c,a,b){return a>b},function(d,a,b,c){return c.compare(a,b)>0}),cJ=ag("<=",function(c,a,b){return a<=b},function(d,a,b,c){return 0>=c.compare(a,b)}),cK=ag(">=",function(c,a,b){return a>=b},function(d,a,b,c){return c.compare(a,b)>=0}),ah=function(a,b,c,d,e){this.type=j,this.number=a,this.locale=b,this.currency=c,this.minFractionDigits=d,this.maxFractionDigits=e};ah.parse=function(c,b){if(3!==c.length)return b.error("Expected two arguments.");var e=b.parse(c[1],1,d);if(!e)return null;var a=c[2];if("object"!=typeof a||Array.isArray(a))return b.error("NumberFormat options argument must be an object.");var f=null;if(a.locale&&!(f=b.parse(a.locale,1,j)))return null;var g=null;if(a.currency&&!(g=b.parse(a.currency,1,j)))return null;var h=null;if(a["min-fraction-digits"]&&!(h=b.parse(a["min-fraction-digits"],1,d)))return null;var i=null;return!a["max-fraction-digits"]||(i=b.parse(a["max-fraction-digits"],1,d))?new ah(e,f,g,h,i):null},ah.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},ah.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},ah.prototype.outputDefined=function(){return!1},ah.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var ai=function(a){this.type=d,this.input=a};ai.parse=function(b,c){if(2!==b.length)return c.error("Expected 1 argument, but found "+(b.length-1)+" instead.");var a=c.parse(b[1],1);return a?"array"!==a.type.kind&&"string"!==a.type.kind&&"value"!==a.type.kind?c.error("Expected argument of type string or array, but found "+eL(a.type)+" instead."):new ai(a):null},ai.prototype.evaluate=function(b){var a=this.input.evaluate(b);if("string"==typeof a)return a.length;if(Array.isArray(a))return a.length;throw new cz("Expected value to be of type string or array, but found "+eL(eU(a))+" instead.")},ai.prototype.eachChild=function(a){a(this.input)},ai.prototype.outputDefined=function(){return!1},ai.prototype.serialize=function(){var a=["length"];return this.eachChild(function(b){a.push(b.serialize())}),a};var aM={"==":cF,"!=":cG,">":cI,"<":cH,">=":cK,"<=":cJ,array:w,at:aa,"boolean":w,"case":ae,coalesce:$,collator:W,format:T,image:U,"in":ab,"index-of":ac,interpolate:C,"interpolate-hcl":C,"interpolate-lab":C,length:ai,let:_,literal:S,match:ad,number:w,"number-format":ah,object:w,slice:af,step:Z,string:w,"to-boolean":B,"to-color":B,"to-number":B,"to-string":B,"var":Y,within:X};function bt(b,c){var d=c[0],e=c[1],f=c[2],g=c[3];d=d.evaluate(b),e=e.evaluate(b),f=f.evaluate(b);var a=g?g.evaluate(b):1,h=eS(d,e,f,a);if(h)throw new cz(h);return new s(d/255*a,e/255*a,f/255*a,a)}function fw(a,b){return a in b}function fx(b,c){var a=c[b];return void 0===a?null:a}function L(a){return{type:a}}function fy(a){return{result:"success",value:a}}function fz(a){return{result:"error",value:a}}function fA(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function fB(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")> -1}function fC(a){return!!a.expression&&a.expression.interpolated}function fD(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function fE(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function fF(a){return a}function fG(a,e){var f,l,v,w="color"===e.type,g=a.stops&&"object"==typeof a.stops[0][0],x=g|| void 0!==a.property,b=a.type||(fC(e)?"exponential":"interval");if(w&&((a=eH({},a)).stops&&(a.stops=a.stops.map(function(a){return[a[0],s.parse(a[1])]})),a.default?a.default=s.parse(a.default):a.default=s.parse(e.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!ft[a.colorSpace])throw new Error("Unknown color space: "+a.colorSpace);if("exponential"===b)f=fK;else if("interval"===b)f=fJ;else if("categorical"===b){f=fI,l=Object.create(null);for(var h=0,m=a.stops;h<m.length;h+=1){var n=m[h];l[n[0]]=n[1]}v=typeof a.stops[0][0]}else if("identity"===b)f=fL;else throw new Error('Unknown function type "'+b+'"');if(g){for(var c={},o=[],i=0;i<a.stops.length;i++){var j=a.stops[i],d=j[0].zoom;void 0===c[d]&&(c[d]={zoom:d,type:a.type,property:a.property,default:a.default,stops:[]},o.push(d)),c[d].stops.push([j[0].value,j[1]])}for(var p=[],k=0,q=o;k<q.length;k+=1){var r=q[k];p.push([c[r].zoom,fG(c[r],e)])}var t={name:"linear"};return{kind:"composite",interpolationType:t,interpolationFactor:C.interpolationFactor.bind(void 0,t),zoomStops:p.map(function(a){return a[0]}),evaluate:function(c,d){var b=c.zoom;return fK({stops:p,base:a.base},e,b).evaluate(b,d)}}}if(!g&&x)return{kind:"source",evaluate:function(d,b){var c=b&&b.properties?b.properties[a.property]:void 0;return void 0===c?fH(a.default,e.default):f(a,e,c,l,v)}};var u="exponential"===b?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:u,interpolationFactor:C.interpolationFactor.bind(void 0,u),zoomStops:a.stops.map(function(a){return a[0]}),evaluate:function(b){return f(a,e,b.zoom,l,v)}}}function fH(a,b,c){return void 0!==a?a:void 0!==b?b:void 0!==c?c:void 0}function fI(b,c,a,d,e){return fH(typeof a===e?d[a]:void 0,b.default,c.default)}function fJ(a,d,b){if("number"!==fD(b))return fH(a.default,d.default);var c=a.stops.length;if(1===c)return a.stops[0][1];if(b<=a.stops[0][0])return a.stops[0][1];if(b>=a.stops[c-1][0])return a.stops[c-1][1];var e=fi(a.stops.map(function(a){return a[0]}),b);return a.stops[e][1]}function fK(a,e,b){var h=void 0!==a.base?a.base:1;if("number"!==fD(b))return fH(a.default,e.default);var d=a.stops.length;if(1===d)return a.stops[0][1];if(b<=a.stops[0][0])return a.stops[0][1];if(b>=a.stops[d-1][0])return a.stops[d-1][1];var c=fi(a.stops.map(function(a){return a[0]}),b),i=fM(b,h,a.stops[c][0],a.stops[c+1][0]),f=a.stops[c][1],j=a.stops[c+1][1],g=fj[e.type]||fF;if(a.colorSpace&&"rgb"!==a.colorSpace){var k=ft[a.colorSpace];g=function(a,b){return k.reverse(k.interpolate(k.forward(a),k.forward(b),i))}}return"function"==typeof f.evaluate?{evaluate:function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var c=f.evaluate.apply(void 0,a),d=j.evaluate.apply(void 0,a);if(void 0!==c&& void 0!==d)return g(c,d,i)}}:g(f,j,i)}function fL(c,b,a){return"color"===b.type?a=s.parse(a):"formatted"===b.type?a=aw.fromString(a.toString()):"resolvedImage"===b.type?a=aL.fromString(a.toString()):fD(a)===b.type||"enum"===b.type&&b.values[a]||(a=void 0),fH(a,c.default,b.default)}function fM(e,a,c,f){var b=f-c,d=e-c;return 0===b?0:1===a?d/b:(Math.pow(a,d)-1)/(Math.pow(a,b)-1)}I.register(aM,{error:[{kind:"error"},[j],function(a,b){var c=b[0];throw new cz(c.evaluate(a))}],"typeof":[j,[k],function(a,b){return eL(eU(b[0].evaluate(a)))}],"to-rgba":[R(d,4),[Q],function(a,b){return b[0].evaluate(a).toArray()}],rgb:[Q,[d,d,d],bt],rgba:[Q,[d,d,d,d],bt],has:{type:g,overloads:[[[j],function(a,b){return fw(b[0].evaluate(a),a.properties())}],[[j,av],function(a,b){var c=b[0],d=b[1];return fw(c.evaluate(a),d.evaluate(a))}]]},get:{type:k,overloads:[[[j],function(a,b){return fx(b[0].evaluate(a),a.properties())}],[[j,av],function(a,b){var c=b[0],d=b[1];return fx(c.evaluate(a),d.evaluate(a))}]]},"feature-state":[k,[j],function(a,b){return fx(b[0].evaluate(a),a.featureState||{})}],properties:[av,[],function(a){return a.properties()}],"geometry-type":[j,[],function(a){return a.geometryType()}],id:[k,[],function(a){return a.id()}],zoom:[d,[],function(a){return a.globals.zoom}],"heatmap-density":[d,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[d,[],function(a){return a.globals.lineProgress||0}],accumulated:[k,[],function(a){return void 0===a.globals.accumulated?null:a.globals.accumulated}],"+":[d,L(d),function(d,e){for(var b=0,a=0,c=e;a<c.length;a+=1)b+=c[a].evaluate(d);return b}],"*":[d,L(d),function(d,e){for(var b=1,a=0,c=e;a<c.length;a+=1)b*=c[a].evaluate(d);return b}],"-":{type:d,overloads:[[[d,d],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)-d.evaluate(a)}],[[d],function(a,b){return-b[0].evaluate(a)}]]},"/":[d,[d,d],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)/d.evaluate(a)}],"%":[d,[d,d],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)%d.evaluate(a)}],ln2:[d,[],function(){return Math.LN2}],pi:[d,[],function(){return Math.PI}],e:[d,[],function(){return Math.E}],"^":[d,[d,d],function(a,b){var c=b[0],d=b[1];return Math.pow(c.evaluate(a),d.evaluate(a))}],sqrt:[d,[d],function(a,b){return Math.sqrt(b[0].evaluate(a))}],log10:[d,[d],function(a,b){return Math.log(b[0].evaluate(a))/Math.LN10}],ln:[d,[d],function(a,b){return Math.log(b[0].evaluate(a))}],log2:[d,[d],function(a,b){return Math.log(b[0].evaluate(a))/Math.LN2}],sin:[d,[d],function(a,b){return Math.sin(b[0].evaluate(a))}],cos:[d,[d],function(a,b){return Math.cos(b[0].evaluate(a))}],tan:[d,[d],function(a,b){return Math.tan(b[0].evaluate(a))}],asin:[d,[d],function(a,b){return Math.asin(b[0].evaluate(a))}],acos:[d,[d],function(a,b){return Math.acos(b[0].evaluate(a))}],atan:[d,[d],function(a,b){return Math.atan(b[0].evaluate(a))}],min:[d,L(d),function(b,a){return Math.min.apply(Math,a.map(function(a){return a.evaluate(b)}))}],max:[d,L(d),function(b,a){return Math.max.apply(Math,a.map(function(a){return a.evaluate(b)}))}],abs:[d,[d],function(a,b){return Math.abs(b[0].evaluate(a))}],round:[d,[d],function(b,c){var a=c[0].evaluate(b);return a<0?-Math.round(-a):Math.round(a)}],floor:[d,[d],function(a,b){return Math.floor(b[0].evaluate(a))}],ceil:[d,[d],function(a,b){return Math.ceil(b[0].evaluate(a))}],"filter-==":[g,[j,k],function(b,a){var c=a[0],d=a[1];return b.properties()[c.value]===d.value}],"filter-id-==":[g,[k],function(a,b){var c=b[0];return a.id()===c.value}],"filter-type-==":[g,[j],function(a,b){var c=b[0];return a.geometryType()===c.value}],"filter-<":[g,[j,k],function(d,a){var e=a[0],f=a[1],b=d.properties()[e.value],c=f.value;return typeof b==typeof c&&b<c}],"filter-id-<":[g,[k],function(c,d){var e=d[0],a=c.id(),b=e.value;return typeof a==typeof b&&a<b}],"filter->":[g,[j,k],function(d,a){var e=a[0],f=a[1],b=d.properties()[e.value],c=f.value;return typeof b==typeof c&&b>c}],"filter-id->":[g,[k],function(c,d){var e=d[0],a=c.id(),b=e.value;return typeof a==typeof b&&a>b}],"filter-<=":[g,[j,k],function(d,a){var e=a[0],f=a[1],b=d.properties()[e.value],c=f.value;return typeof b==typeof c&&b<=c}],"filter-id-<=":[g,[k],function(c,d){var e=d[0],a=c.id(),b=e.value;return typeof a==typeof b&&a<=b}],"filter->=":[g,[j,k],function(d,a){var e=a[0],f=a[1],b=d.properties()[e.value],c=f.value;return typeof b==typeof c&&b>=c}],"filter-id->=":[g,[k],function(c,d){var e=d[0],a=c.id(),b=e.value;return typeof a==typeof b&&a>=b}],"filter-has":[g,[k],function(a,b){return b[0].value in a.properties()}],"filter-has-id":[g,[],function(a){return null!==a.id()&& void 0!==a.id()}],"filter-type-in":[g,[R(j)],function(a,b){return b[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[g,[R(k)],function(a,b){return b[0].value.indexOf(a.id())>=0}],"filter-in-small":[g,[j,R(k)],function(b,a){var c=a[0],d=a[1];return d.value.indexOf(b.properties()[c.value])>=0}],"filter-in-large":[g,[j,R(k)],function(c,a){var d=a[0],b=a[1];return function(d,e,b,c){for(;b<=c;){var a=b+c>>1;if(e[a]===d)return!0;e[a]>d?c=a-1:b=a+1}return!1}(c.properties()[d.value],b.value,0,b.value.length-1)}],all:{type:g,overloads:[[[g,g],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)&&d.evaluate(a)}],[L(g),function(c,d){for(var a=0,b=d;a<b.length;a+=1)if(!b[a].evaluate(c))return!1;return!0}]]},any:{type:g,overloads:[[[g,g],function(a,b){var c=b[0],d=b[1];return c.evaluate(a)||d.evaluate(a)}],[L(g),function(c,d){for(var a=0,b=d;a<b.length;a+=1)if(b[a].evaluate(c))return!0;return!1}]]},"!":[g,[g],function(a,b){return!b[0].evaluate(a)}],"is-supported-script":[g,[j],function(a,c){var d=c[0],b=a.globals&&a.globals.isSupportedScript;return!b||b(d.evaluate(a))}],upcase:[j,[j],function(a,b){return b[0].evaluate(a).toUpperCase()}],downcase:[j,[j],function(a,b){return b[0].evaluate(a).toLowerCase()}],concat:[j,L(k),function(b,a){return a.map(function(a){return eV(a.evaluate(b))}).join("")}],"resolved-locale":[j,[cw],function(a,b){return b[0].evaluate(a).resolvedLocale()}]});var a$=function(b,a){this.expression=b,this._warningHistory={},this._evaluator=new V,this._defaultValue=a?fR(a):null,this._enumValues=a&&"enum"===a.type?a.values:null};function fN(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in aM}function cL(d,a){var b=new ax(aM,[],a?fQ(a):void 0),c=b.parse(d,void 0,void 0,void 0,a&&"string"===a.type?{typeAnnotation:"coerce"}:void 0);return c?fy(new a$(c,a)):fz(b.errors)}a$.prototype.evaluateWithoutErrorHandling=function(a,b,c,d,e,f){return this._evaluator.globals=a,this._evaluator.feature=b,this._evaluator.featureState=c,this._evaluator.canonical=d,this._evaluator.availableImages=e||null,this._evaluator.formattedSection=f,this.expression.evaluate(this._evaluator)},a$.prototype.evaluate=function(c,d,e,f,g,h){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=e||null,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=h||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new cz("Expected value to be one of "+Object.keys(this._enumValues).map(function(a){return JSON.stringify(a)}).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,"undefined"!=typeof console&&console.warn(b.message)),this._defaultValue}};var a_=function(a,b){this.kind=a,this._styleExpression=b,this.isStateDependent="constant"!==a&&!ff(b.expression)};a_.prototype.evaluateWithoutErrorHandling=function(a,b,c,d,e,f){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c,d,e,f)},a_.prototype.evaluate=function(a,b,c,d,e,f){return this._styleExpression.evaluate(a,b,c,d,e,f)};var aN=function(a,b,c,d){this.kind=a,this.zoomStops=c,this._styleExpression=b,this.isStateDependent="camera"!==a&&!ff(b.expression),this.interpolationType=d};function fO(b,c){if("error"===(b=cL(b,c)).result)return b;var d=b.value.expression,e=fe(d);if(!e&&!fA(c))return fz([new eK("","data expressions not supported")]);var f=fg(d,["zoom"]);if(!f&&!fB(c))return fz([new eK("","zoom expressions not supported")]);var a=fP(d);if(!a&&!f)return fz([new eK("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(a instanceof eK)return fz([a]);if(a instanceof C&&!fC(c))return fz([new eK("",'"interpolate" expressions cannot be used with this property')]);if(!a)return fy(e?new a_("constant",b.value):new a_("source",b.value));var g=a instanceof C?a.interpolation:void 0;return fy(e?new aN("camera",b.value,a.labels,g):new aN("composite",b.value,a.labels,g))}aN.prototype.evaluateWithoutErrorHandling=function(a,b,c,d,e,f){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c,d,e,f)},aN.prototype.evaluate=function(a,b,c,d,e,f){return this._styleExpression.evaluate(a,b,c,d,e,f)},aN.prototype.interpolationFactor=function(a,b,c){return this.interpolationType?C.interpolationFactor(this.interpolationType,a,b,c):0};var a0=function(a,b){this._parameters=a,this._specification=b,eH(this,fG(this._parameters,this._specification))};function fP(a){var b=null;if(a instanceof _)b=fP(a.result);else if(a instanceof $)for(var c=0,d=a.args;c<d.length&&!(b=fP(d[c]));c+=1);else(a instanceof Z||a instanceof C)&&a.input instanceof I&&"zoom"===a.input.name&&(b=a);return b instanceof eK||a.eachChild(function(c){var a=fP(c);a instanceof eK?b=a:!b&&a?b=new eK("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):b&&a&&b!==a&&(b=new eK("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),b}function fQ(a){var b={color:Q,string:j,number:d,enum:j,boolean:g,formatted:cx,resolvedImage:cy};return"array"===a.type?R(b[a.value]||k,a.length):b[a.type]}function fR(a){return"color"===a.type&&fE(a.default)?new s(0,0,0,0):"color"===a.type?s.parse(a.default)||null:void 0===a.default?null:a.default}function cM(c){var d=c.key,a=c.value,b=c.valueSpec||{},f=c.objectElementValidators||{},l=c.style,m=c.styleSpec,g=[],k=fD(a);if("object"!==k)return[new ct(d,a,"object expected, "+k+" found")];for(var e in a){var j=e.split(".")[0],n=b[j]||b["*"],h=void 0;if(f[j])h=f[j];else if(b[j])h=f5;else if(f["*"])h=f["*"];else if(b["*"])h=f5;else{g.push(new ct(d,a[e],'unknown property "'+e+'"'));continue}g=g.concat(h({key:(d?d+".":d)+e,value:a[e],valueSpec:n,style:l,styleSpec:m,object:a,objectKey:e},a))}for(var i in b)!f[i]&&b[i].required&& void 0===b[i].default&& void 0===a[i]&&g.push(new ct(d,a,'missing required property "'+i+'"'));return g}function cN(c){var a=c.value,b=c.valueSpec,i=c.style,h=c.styleSpec,e=c.key,j=c.arrayElementValidator||f5;if("array"!==fD(a))return[new ct(e,a,"array expected, "+fD(a)+" found")];if(b.length&&a.length!==b.length)return[new ct(e,a,"array length "+b.length+" expected, length "+a.length+" found")];if(b["min-length"]&&a.length<b["min-length"])return[new ct(e,a,"array length at least "+b["min-length"]+" expected, length "+a.length+" found")];var f={type:b.value,values:b.values};h.$version<7&&(f.function=b.function),"object"===fD(b.value)&&(f=b.value);for(var g=[],d=0;d<a.length;d++)g=g.concat(j({array:a,arrayIndex:d,value:a[d],valueSpec:f,style:i,styleSpec:h,key:e+"["+d+"]"}));return g}function cO(d){var e=d.key,a=d.value,b=d.valueSpec,c=fD(a);return("number"===c&&a!=a&&(c="NaN"),"number"!==c)?[new ct(e,a,"number expected, "+c+" found")]:"minimum"in b&&a<b.minimum?[new ct(e,a,a+" is less than the minimum value "+b.minimum)]:"maximum"in b&&a>b.maximum?[new ct(e,a,a+" is greater than the maximum value "+b.maximum)]:[]}function cP(a){var f,g,h,i=a.valueSpec,c=eI(a.value.type),j={},d="categorical"!==c&& void 0===a.value.property,e="array"===fD(a.value.stops)&&"array"===fD(a.value.stops[0])&&"object"===fD(a.value.stops[0][0]),b=cM({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(a){if("identity"===c)return[new ct(a.key,a.value,'identity function may not have a "stops" property')];var b=[],d=a.value;return b=b.concat(cN({key:a.key,value:d,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:k})),"array"===fD(d)&&0===d.length&&b.push(new ct(a.key,d,"array must have at least one stop")),b},default:function(a){return f5({key:a.key,value:a.value,valueSpec:i,style:a.style,styleSpec:a.styleSpec})}}});return"identity"===c&&d&&b.push(new ct(a.key,a.value,'missing required property "property"')),"identity"===c||a.value.stops||b.push(new ct(a.key,a.value,'missing required property "stops"')),"exponential"===c&&a.valueSpec.expression&&!fC(a.valueSpec)&&b.push(new ct(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(d||fA(a.valueSpec)?d&&!fB(a.valueSpec)&&b.push(new ct(a.key,a.value,"zoom functions not supported")):b.push(new ct(a.key,a.value,"property functions not supported"))),("categorical"===c||e)&& void 0===a.value.property&&b.push(new ct(a.key,a.value,'"property" property is required')),b;function k(c){var d=[],a=c.value,b=c.key;if("array"!==fD(a))return[new ct(b,a,"array expected, "+fD(a)+" found")];if(2!==a.length)return[new ct(b,a,"array length 2 expected, length "+a.length+" found")];if(e){if("object"!==fD(a[0]))return[new ct(b,a,"object expected, "+fD(a[0])+" found")];if(void 0===a[0].zoom)return[new ct(b,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new ct(b,a,"object stop key must have value")];if(h&&h>eI(a[0].zoom))return[new ct(b,a[0].zoom,"stop zoom values must appear in ascending order")];eI(a[0].zoom)!==h&&(h=eI(a[0].zoom),g=void 0,j={}),d=d.concat(cM({key:b+"[0]",value:a[0],valueSpec:{zoom:{}},style:c.style,styleSpec:c.styleSpec,objectElementValidators:{zoom:cO,value:l}}))}else d=d.concat(l({key:b+"[0]",value:a[0],valueSpec:{},style:c.style,styleSpec:c.styleSpec},a));return fN(eJ(a[1]))?d.concat([new ct(b+"[1]",a[1],"expressions are not allowed in function stops.")]):d.concat(f5({key:b+"[1]",value:a[1],valueSpec:i,style:c.style,styleSpec:c.styleSpec}))}function l(a,k){var b=fD(a.value),d=eI(a.value),e=null!==a.value?a.value:k;if(f){if(b!==f)return[new ct(a.key,e,b+" stop domain type must match previous stop domain type "+f)]}else f=b;if("number"!==b&&"string"!==b&&"boolean"!==b)return[new ct(a.key,e,"stop domain value must be a number, string, or boolean")];if("number"!==b&&"categorical"!==c){var h="number expected, "+b+" found";return fA(i)&& void 0===c&&(h+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ct(a.key,e,h)]}return"categorical"!==c||"number"!==b||isFinite(d)&&Math.floor(d)===d?"categorical"!==c&&"number"===b&& void 0!==g&&d<g?[new ct(a.key,e,"stop domain values must appear in ascending order")]:(g=d,"categorical"===c&&d in j)?[new ct(a.key,e,"stop domain values must be unique")]:(j[d]=!0,[]):[new ct(a.key,e,"integer expected, found "+d)]}}function fS(a){var c=("property"===a.expressionContext?fO:cL)(eJ(a.value),a.valueSpec);if("error"===c.result)return c.value.map(function(b){return new ct(""+a.key+b.key,a.value,b.message)});var b=c.value.expression||c.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!b.outputDefined())return[new ct(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===a.expressionContext&&"layout"===a.propertyType&&!ff(b))return[new ct(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!ff(b))return[new ct(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!fg(b,["zoom","feature-state"]))return[new ct(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!fe(b))return[new ct(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cQ(c){var e=c.key,a=c.value,b=c.valueSpec,d=[];return Array.isArray(b.values)?-1===b.values.indexOf(eI(a))&&d.push(new ct(e,a,"expected one of ["+b.values.join(", ")+"], "+JSON.stringify(a)+" found")):-1===Object.keys(b.values).indexOf(eI(a))&&d.push(new ct(e,a,"expected one of ["+Object.keys(b.values).join(", ")+"], "+JSON.stringify(a)+" found")),d}function fT(a){if(!0===a|| !1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var b=0,c=a.slice(1);b<c.length;b+=1){var d=c[b];if(!fT(d)&&"boolean"!=typeof d)return!1}return!0;default:return!0}}a0.deserialize=function(a){return new a0(a._parameters,a._specification)},a0.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var fU={type:"boolean","default":!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cR(a){if(null==a)return{filter:function(){return!0},needGeometry:!1};fT(a)||(a=fX(a));var b=cL(a,fU);if("error"===b.result)throw new Error(b.value.map(function(a){return a.key+": "+a.message}).join(", "));return{filter:function(a,c,d){return b.value.evaluate(a,c,{},d)},needGeometry:fW(a)}}function fV(a,b){return a<b?-1:a>b?1:0}function fW(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(var b=1;b<a.length;b++)if(fW(a[b]))return!0;return!1}function fX(a){if(!a)return!0;var b=a[0];return a.length<=1?"any"!==b:"=="===b?fY(a[1],a[2],"=="):"!="===b?f0(fY(a[1],a[2],"==")):"<"===b||">"===b||"<="===b||">="===b?fY(a[1],a[2],b):"any"===b?fZ(a.slice(1)):"all"===b?["all"].concat(a.slice(1).map(fX)):"none"===b?["all"].concat(a.slice(1).map(fX).map(f0)):"in"===b?f$(a[1],a.slice(2)):"!in"===b?f0(f$(a[1],a.slice(2))):"has"===b?f_(a[1]):"!has"===b?f0(f_(a[1])):"within"!==b||a}function fY(c,a,b){switch(c){case"$type":return["filter-type-"+b,a];case"$id":return["filter-id-"+b,a];default:return["filter-"+b,c,a]}}function fZ(a){return["any"].concat(a.map(fX))}function f$(b,a){if(0===a.length)return!1;switch(b){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:if(a.length>200&&!a.some(function(b){return typeof b!=typeof a[0]}))return["filter-in-large",b,["literal",a.sort(fV)]];return["filter-in-small",b,["literal",a]]}}function f_(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function f0(a){return["!",a]}function bu(a){return fT(eJ(a.value))?fS(eH({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):f1(a)}function f1(e){var c,a=e.value,d=e.key;if("array"!==fD(a))return[new ct(d,a,"array expected, "+fD(a)+" found")];var h=e.styleSpec,b=[];if(a.length<1)return[new ct(d,a,"filter array must have at least 1 element")];switch(b=b.concat(cQ({key:d+"[0]",value:a[0],valueSpec:h.filter_operator,style:e.style,styleSpec:e.styleSpec})),eI(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&"$type"===eI(a[1])&&b.push(new ct(d,a,'"$type" cannot be use with operator "'+a[0]+'"'));case"==":case"!=":3!==a.length&&b.push(new ct(d,a,'filter array for operator "'+a[0]+'" must have 3 elements'));case"in":case"!in":a.length>=2&&"string"!==(c=fD(a[1]))&&b.push(new ct(d+"[1]",a[1],"string expected, "+c+" found"));for(var f=2;f<a.length;f++)c=fD(a[f]),"$type"===eI(a[1])?b=b.concat(cQ({key:d+"["+f+"]",value:a[f],valueSpec:h.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==c&&"number"!==c&&"boolean"!==c&&b.push(new ct(d+"["+f+"]",a[f],"string, number, or boolean expected, "+c+" found"));break;case"any":case"all":case"none":for(var g=1;g<a.length;g++)b=b.concat(f1({key:d+"["+g+"]",value:a[g],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":c=fD(a[1]),2!==a.length?b.push(new ct(d,a,'filter array for "'+a[0]+'" operator must have 2 elements')):"string"!==c&&b.push(new ct(d+"[1]",a[1],"string expected, "+c+" found"));break;case"within":c=fD(a[1]),2!==a.length?b.push(new ct(d,a,'filter array for "'+a[0]+'" operator must have 2 elements')):"object"!==c&&b.push(new ct(d+"[1]",a[1],"object expected, "+c+" found"));break}return b}function f2(b,i){var l,d=b.key,e=b.style,f=b.styleSpec,a=b.value,c=b.objectKey,g=f[i+"_"+b.layerType];if(!g)return[];var j=c.match(/^(.*)-transition$/);if("paint"===i&&j&&g[j[1]]&&g[j[1]].transition)return f5({key:d,value:a,valueSpec:f.transition,style:e,styleSpec:f});var h=b.valueSpec||g[c];if(!h)return[new ct(d,a,'unknown property "'+c+'"')];if("string"===fD(a)&&fA(h)&&!h.tokens&&(l=/^{([^}]+)}$/.exec(a)))return[new ct(d,a,'"'+c+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(l[1])+" }`.")];var k=[];return"symbol"===b.layerType&&("text-field"===c&&e&&!e.glyphs&&k.push(new ct(d,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===c&&fE(eJ(a))&&"identity"===eI(a.type)&&k.push(new ct(d,a,'"text-font" does not support identity functions'))),k.concat(f5({key:b.key,value:a,valueSpec:h,style:e,styleSpec:f,expressionContext:"property",propertyType:i,propertyKey:c}))}function cS(a){return f2(a,"paint")}function cT(a){return f2(a,"layout")}function bv(d){var i,b=[],a=d.value,c=d.key,g=d.style,l=d.styleSpec;a.type||a.ref||b.push(new ct(c,a,'either "type" or "ref" is required'));var e=eI(a.type),m=eI(a.ref);if(a.id)for(var n=eI(a.id),j=0;j<d.arrayIndex;j++){var k=g.layers[j];eI(k.id)===n&&b.push(new ct(c,a.id,'duplicate layer id "'+a.id+'", previously used at line '+k.id.__line__))}if("ref"in a)["type","source","source-layer","filter","layout"].forEach(function(d){d in a&&b.push(new ct(c,a[d],'"'+d+'" is prohibited for ref layers'))}),g.layers.forEach(function(a){eI(a.id)===m&&(i=a)}),i?i.ref?b.push(new ct(c,a.ref,"ref cannot reference another ref layer")):e=eI(i.type):b.push(new ct(c,a.ref,'ref layer "'+m+'" not found'));else if("background"!==e)if(a.source){var h=g.sources&&g.sources[a.source],f=h&&eI(h.type);h?"vector"===f&&"raster"===e?b.push(new ct(c,a.source,'layer "'+a.id+'" requires a raster source')):"raster"===f&&"raster"!==e?b.push(new ct(c,a.source,'layer "'+a.id+'" requires a vector source')):"vector"!==f||a["source-layer"]?"raster-dem"===f&&"hillshade"!==e?b.push(new ct(c,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===e&&a.paint&&a.paint["line-gradient"]&&("geojson"!==f||!h.lineMetrics)&&b.push(new ct(c,a,'layer "'+a.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):b.push(new ct(c,a,'layer "'+a.id+'" must specify a "source-layer"')):b.push(new ct(c,a.source,'source "'+a.source+'" not found'))}else b.push(new ct(c,a,'missing required property "source"'));return b=b.concat(cM({key:c,value:a,valueSpec:l.layer,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return f5({key:c+".type",value:a.type,valueSpec:l.layer.type,style:d.style,styleSpec:d.styleSpec,object:a,objectKey:"type"})},filter:bu,layout:function(b){return cM({layer:a,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":function(a){return cT(eH({layerType:e},a))}}})},paint:function(b){return cM({layer:a,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":function(a){return cS(eH({layerType:e},a))}}})}}}))}function cU(a){var b=a.value,d=a.key,c=fD(b);return"string"!==c?[new ct(d,b,"string expected, "+c+" found")]:[]}var f3={promoteId:function(c){var d=c.key,a=c.value;if("string"===fD(a))return cU({key:d,value:a});var b=[];for(var e in a)b.push.apply(b,cU({key:d+"."+e,value:a[e]}));return b}};function bw(e){var d,a=e.value,b=e.key,c=e.styleSpec,f=e.style;if(!a.type)return[new ct(b,a,'"type" is required')];var i=eI(a.type);switch(i){case"vector":case"raster":case"raster-dem":return d=cM({key:b,value:a,valueSpec:c["source_"+i.replace("-","_")],style:e.style,styleSpec:c,objectElementValidators:f3});case"geojson":if(d=cM({key:b,value:a,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:f3}),a.cluster)for(var g in a.clusterProperties){var j=a.clusterProperties[g],h=j[0],k=j[1],l="string"==typeof h?[h,["accumulated"],["get",g]]:h;d.push.apply(d,fS({key:b+"."+g+".map",value:k,expressionContext:"cluster-map"})),d.push.apply(d,fS({key:b+"."+g+".reduce",value:l,expressionContext:"cluster-reduce"}))}return d;case"video":return cM({key:b,value:a,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return cM({key:b,value:a,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new ct(b,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cQ({key:b+".type",value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:c})}}function bx(f){var c=f.value,d=f.styleSpec,e=d.light,h=f.style,b=[],i=fD(c);if(void 0===c)return b;if("object"!==i)return b=b.concat([new ct("light",c,"object expected, "+i+" found")]);for(var a in c){var g=a.match(/^(.*)-transition$/);b=g&&e[g[1]]&&e[g[1]].transition?b.concat(f5({key:a,value:c[a],valueSpec:d.transition,style:h,styleSpec:d})):e[a]?b.concat(f5({key:a,value:c[a],valueSpec:e[a],style:h,styleSpec:d})):b.concat([new ct(a,c[a],'unknown property "'+a+'"')])}return b}var f4={"*":function(){return[]},array:cN,"boolean":function(a){var b=a.value,d=a.key,c=fD(b);return"boolean"!==c?[new ct(d,b,"boolean expected, "+c+" found")]:[]},number:cO,color:function(b){var c=b.key,a=b.value,d=fD(a);return"string"!==d?[new ct(c,a,"color expected, "+d+" found")]:null===eQ(a)?[new ct(c,a,'color expected, "'+a+'" found')]:[]},constants:cu,"enum":cQ,filter:bu,"function":cP,layer:bv,object:cM,source:bw,light:bx,string:cU,formatted:function(a){return 0===cU(a).length?[]:fS(a)},resolvedImage:function(a){return 0===cU(a).length?[]:fS(a)}};function f5(b){var c=b.value,a=b.valueSpec,d=b.styleSpec;return a.expression&&fE(eI(c))?cP(b):a.expression&&fN(eJ(c))?fS(b):a.type&&f4[a.type]?f4[a.type](b):cM(eH({},b,{valueSpec:a.type?d[a.type]:a}))}function f6(c){var a=c.value,d=c.key,b=cU(c);return b.length||(-1===a.indexOf("{fontstack}")&&b.push(new ct(d,a,'"glyphs" url must include a "{fontstack}" token')),-1===a.indexOf("{range}")&&b.push(new ct(d,a,'"glyphs" url must include a "{range}" token'))),b}function M(a,c){void 0===c&&(c=b);var d=[];return d=d.concat(f5({key:"",value:a,valueSpec:c.$root,styleSpec:c,style:a,objectElementValidators:{glyphs:f6,"*":function(){return[]}}})),a.constants&&(d=d.concat(cu({key:"constants",value:a.constants,style:a,styleSpec:c}))),f7(d)}function f7(a){return[].concat(a).sort(function(a,b){return a.line-b.line})}function aj(a){return function(){for(var c=[],b=arguments.length;b--;)c[b]=arguments[b];return f7(a.apply(this,c))}}M.source=aj(bw),M.light=aj(bx),M.layer=aj(bv),M.filter=aj(bu),M.paintProperty=aj(cS),M.layoutProperty=aj(cT);var aO=M,cV=aO.light,f8=aO.paintProperty,f9=aO.layoutProperty;function cW(e,a){var c=!1;if(a&&a.length)for(var b=0,d=a;b<d.length;b+=1){var f=d[b];e.fire(new cs(new Error(f.message))),c=!0}return c}var a1=D,ga=3;function D(b,c,d){var e=this.cells=[];if(b instanceof ArrayBuffer){this.arrayBuffer=b;var a=new Int32Array(this.arrayBuffer);b=a[0],c=a[1],d=a[2],this.d=c+2*d;for(var f=0;f<this.d*this.d;f++){var g=a[ga+f],h=a[ga+f+1];e.push(g===h?null:a.subarray(g,h))}var l=a[ga+e.length],i=a[ga+e.length+1];this.keys=a.subarray(l,i),this.bboxes=a.subarray(i),this.insert=this._insertReadonly}else{this.d=c+2*d;for(var j=0;j<this.d*this.d;j++)e.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=b,this.padding=d,this.scale=c/b,this.uid=0;var k=d/c*b;this.min=-k,this.max=b+k}D.prototype.insert=function(e,a,b,c,d){this._forEachCell(a,b,c,d,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d)},D.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},D.prototype._insertCell=function(c,d,e,f,a,b){this.cells[a].push(b)},D.prototype.query=function(a,b,c,d,e){var f=this.min,g=this.max;if(a<=f&&b<=f&&g<=c&&g<=d&&!e)return Array.prototype.slice.call(this.keys);var h=[],i={};return this._forEachCell(a,b,c,d,this._queryCell,h,i,e),h},D.prototype._queryCell=function(h,i,j,k,l,m,d,g){var e=this.cells[l];if(null!==e)for(var n=this.keys,a=this.bboxes,f=0;f<e.length;f++){var c=e[f];if(void 0===d[c]){var b=4*c;(g?g(a[b+0],a[b+1],a[b+2],a[b+3]):h<=a[b+2]&&i<=a[b+3]&&j>=a[b+0]&&k>=a[b+1])?(d[c]=!0,m.push(n[c])):d[c]=!1}}},D.prototype._forEachCell=function(d,e,f,g,h,i,j,c){for(var k=this._convertToCellCoord(d),l=this._convertToCellCoord(e),m=this._convertToCellCoord(f),n=this._convertToCellCoord(g),a=k;a<=m;a++)for(var b=l;b<=n;b++){var o=this.d*b+a;if((!c||c(this._convertFromCellCoord(a),this._convertFromCellCoord(b),this._convertFromCellCoord(a+1),this._convertFromCellCoord(b+1)))&&h.call(this,d,e,f,g,o,i,j,c))return}},D.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},D.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},D.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,f=ga+this.cells.length+1+1,g=0,e=0;e<this.cells.length;e++)g+=this.cells[e].length;var a=new Int32Array(f+g+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var b=f,d=0;d<c.length;d++){var h=c[d];a[ga+d]=b,a.set(h,b),b+=h.length}return a[ga+c.length]=b,a.set(this.keys,b),b+=this.keys.length,a[ga+c.length+1]=b,a.set(this.bboxes,b),b+=this.bboxes.length,a.buffer};var gb=self.ImageData,gc=self.ImageBitmap,gd={};function c(b,c,a){void 0===a&&(a={}),Object.defineProperty(c,"_classRegistryKey",{value:b,writeable:!1}),gd[b]={klass:c,omit:a.omit||[],shallow:a.shallow||[]}}for(var a2 in c("Object",Object),a1.serialize=function(c,a){var b=c.toArrayBuffer();return a&&a.push(b),{buffer:b}},a1.deserialize=function(a){return new a1(a.buffer)},c("Grid",a1),c("Color",s),c("Error",Error),c("ResolvedImage",aL),c("StylePropertyFunction",a0),c("StyleExpression",a$,{omit:["_evaluator"]}),c("ZoomDependentExpression",aN),c("ZoomConstantExpression",a_),c("CompoundExpression",I,{omit:["_evaluate"]}),aM)aM[a2]._classRegistryKey||c("Expression_"+a2,aM[a2]);function ge(a){return a&&"undefined"!=typeof ArrayBuffer&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function gf(a){return gc&&a instanceof gc}function gg(a,b){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(ge(a)||gf(a))return b&&b.push(a),a;if(ArrayBuffer.isView(a)){var h=a;return b&&b.push(h.buffer),h}if(a instanceof gb)return b&&b.push(a.data.buffer),a;if(Array.isArray(a)){for(var i=[],g=0,j=a;g<j.length;g+=1){var l=j[g];i.push(gg(l,b))}return i}if("object"==typeof a){var f=a.constructor,c=f._classRegistryKey;if(!c)throw new Error("can't serialize object of unregistered class");var d=f.serialize?f.serialize(a,b):{};if(!f.serialize){for(var e in a)if(a.hasOwnProperty(e)&&!(gd[c].omit.indexOf(e)>=0)){var k=a[e];d[e]=gd[c].shallow.indexOf(e)>=0?k:gg(k,b)}a instanceof Error&&(d.message=a.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(d.$name=c),d}throw new Error("can't serialize object of type "+typeof a)}function gh(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||ge(a)||gf(a)||ArrayBuffer.isView(a)||a instanceof gb)return a;if(Array.isArray(a))return a.map(gh);if("object"==typeof a){var d=a.$name||"Object",b=gd[d].klass;if(!b)throw new Error("can't deserialize unregistered class "+d);if(b.deserialize)return b.deserialize(a);for(var f=Object.create(b.prototype),e=0,g=Object.keys(a);e<g.length;e+=1){var c=g[e];if("$name"!==c){var h=a[c];f[c]=gd[d].shallow.indexOf(c)>=0?h:gh(h)}}return f}throw new Error("can't deserialize object of type "+typeof a)}var by=function(){this.first=!0};by.prototype.update=function(b,c){var a=Math.floor(b);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=b,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=c),b!==this.lastZoom&&(this.lastZoom=b,this.lastFloorZoom=a,!0))};var cX={"Latin-1 Supplement":function(a){return a>=128&&a<=255},Arabic:function(a){return a>=1536&&a<=1791},"Arabic Supplement":function(a){return a>=1872&&a<=1919},"Arabic Extended-A":function(a){return a>=2208&&a<=2303},"Hangul Jamo":function(a){return a>=4352&&a<=4607},"Unified Canadian Aboriginal Syllabics":function(a){return a>=5120&&a<=5759},Khmer:function(a){return a>=6016&&a<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(a){return a>=6320&&a<=6399},"General Punctuation":function(a){return a>=8192&&a<=8303},"Letterlike Symbols":function(a){return a>=8448&&a<=8527},"Number Forms":function(a){return a>=8528&&a<=8591},"Miscellaneous Technical":function(a){return a>=8960&&a<=9215},"Control Pictures":function(a){return a>=9216&&a<=9279},"Optical Character Recognition":function(a){return a>=9280&&a<=9311},"Enclosed Alphanumerics":function(a){return a>=9312&&a<=9471},"Geometric Shapes":function(a){return a>=9632&&a<=9727},"Miscellaneous Symbols":function(a){return a>=9728&&a<=9983},"Miscellaneous Symbols and Arrows":function(a){return a>=11008&&a<=11263},"CJK Radicals Supplement":function(a){return a>=11904&&a<=12031},"Kangxi Radicals":function(a){return a>=12032&&a<=12255},"Ideographic Description Characters":function(a){return a>=12272&&a<=12287},"CJK Symbols and Punctuation":function(a){return a>=12288&&a<=12351},Hiragana:function(a){return a>=12352&&a<=12447},Katakana:function(a){return a>=12448&&a<=12543},Bopomofo:function(a){return a>=12544&&a<=12591},"Hangul Compatibility Jamo":function(a){return a>=12592&&a<=12687},Kanbun:function(a){return a>=12688&&a<=12703},"Bopomofo Extended":function(a){return a>=12704&&a<=12735},"CJK Strokes":function(a){return a>=12736&&a<=12783},"Katakana Phonetic Extensions":function(a){return a>=12784&&a<=12799},"Enclosed CJK Letters and Months":function(a){return a>=12800&&a<=13055},"CJK Compatibility":function(a){return a>=13056&&a<=13311},"CJK Unified Ideographs Extension A":function(a){return a>=13312&&a<=19903},"Yijing Hexagram Symbols":function(a){return a>=19904&&a<=19967},"CJK Unified Ideographs":function(a){return a>=19968&&a<=40959},"Yi Syllables":function(a){return a>=40960&&a<=42127},"Yi Radicals":function(a){return a>=42128&&a<=42191},"Hangul Jamo Extended-A":function(a){return a>=43360&&a<=43391},"Hangul Syllables":function(a){return a>=44032&&a<=55215},"Hangul Jamo Extended-B":function(a){return a>=55216&&a<=55295},"Private Use Area":function(a){return a>=57344&&a<=63743},"CJK Compatibility Ideographs":function(a){return a>=63744&&a<=64255},"Arabic Presentation Forms-A":function(a){return a>=64336&&a<=65023},"Vertical Forms":function(a){return a>=65040&&a<=65055},"CJK Compatibility Forms":function(a){return a>=65072&&a<=65103},"Small Form Variants":function(a){return a>=65104&&a<=65135},"Arabic Presentation Forms-B":function(a){return a>=65136&&a<=65279},"Halfwidth and Fullwidth Forms":function(a){return a>=65280&&a<=65519}};function gi(c){for(var a=0,b=c;a<b.length;a+=1)if(gm(b[a].charCodeAt(0)))return!0;return!1}function gj(c){for(var a=0,b=c;a<b.length;a+=1)if(!gk(b[a].charCodeAt(0)))return!1;return!0}function gk(a){return!cX.Arabic(a)&& !cX["Arabic Supplement"](a)&& !cX["Arabic Extended-A"](a)&& !cX["Arabic Presentation Forms-A"](a)&&!cX["Arabic Presentation Forms-B"](a)}function gl(a){return!(a<11904)&&(!!cX["Bopomofo Extended"](a)|| !!cX.Bopomofo(a)|| !!cX["CJK Compatibility Forms"](a)|| !!cX["CJK Compatibility Ideographs"](a)|| !!cX["CJK Compatibility"](a)|| !!cX["CJK Radicals Supplement"](a)|| !!cX["CJK Strokes"](a)|| !!cX["CJK Symbols and Punctuation"](a)|| !!cX["CJK Unified Ideographs Extension A"](a)|| !!cX["CJK Unified Ideographs"](a)|| !!cX["Enclosed CJK Letters and Months"](a)|| !!cX["Halfwidth and Fullwidth Forms"](a)|| !!cX.Hiragana(a)|| !!cX["Ideographic Description Characters"](a)|| !!cX["Kangxi Radicals"](a)|| !!cX["Katakana Phonetic Extensions"](a)|| !!cX.Katakana(a)|| !!cX["Vertical Forms"](a)|| !!cX["Yi Radicals"](a)||!!cX["Yi Syllables"](a))}function gm(a){return 746===a||747===a|| !(a<4352)&&(!!cX["Bopomofo Extended"](a)|| !!cX.Bopomofo(a)|| !!cX["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)|| !!cX["CJK Compatibility Ideographs"](a)|| !!cX["CJK Compatibility"](a)|| !!cX["CJK Radicals Supplement"](a)|| !!cX["CJK Strokes"](a)|| !!cX["CJK Symbols and Punctuation"](a)&&(!(a>=12296)||!(a<=12305))&&(!(a>=12308)||!(a<=12319))&&12336!==a|| !!cX["CJK Unified Ideographs Extension A"](a)|| !!cX["CJK Unified Ideographs"](a)|| !!cX["Enclosed CJK Letters and Months"](a)|| !!cX["Hangul Compatibility Jamo"](a)|| !!cX["Hangul Jamo Extended-A"](a)|| !!cX["Hangul Jamo Extended-B"](a)|| !!cX["Hangul Jamo"](a)|| !!cX["Hangul Syllables"](a)|| !!cX.Hiragana(a)|| !!cX["Ideographic Description Characters"](a)|| !!cX.Kanbun(a)|| !!cX["Kangxi Radicals"](a)|| !!cX["Katakana Phonetic Extensions"](a)|| !!cX.Katakana(a)&&12540!==a|| !!cX["Halfwidth and Fullwidth Forms"](a)&&65288!==a&&65289!==a&&65293!==a&&(!(a>=65306)||!(a<=65310))&&65339!==a&&65341!==a&&65343!==a&&(!(a>=65371)||!(a<=65503))&&65507!==a&&(!(a>=65512)||!(a<=65519))|| !!cX["Small Form Variants"](a)&&(!(a>=65112)||!(a<=65118))&&(!(a>=65123)||!(a<=65126))|| !!cX["Unified Canadian Aboriginal Syllabics"](a)|| !!cX["Unified Canadian Aboriginal Syllabics Extended"](a)|| !!cX["Vertical Forms"](a)|| !!cX["Yijing Hexagram Symbols"](a)|| !!cX["Yi Syllables"](a)||!!cX["Yi Radicals"](a))}function gn(b){var a;return!(gm(b)||(a=b,cX["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||cX["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||cX["Letterlike Symbols"](a)||cX["Number Forms"](a)||cX["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||cX["Control Pictures"](a)&&9251!==a||cX["Optical Character Recognition"](a)||cX["Enclosed Alphanumerics"](a)||cX["Geometric Shapes"](a)||cX["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||cX["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||cX["CJK Symbols and Punctuation"](a)||cX.Katakana(a)||cX["Private Use Area"](a)||cX["CJK Compatibility Forms"](a)||cX["Small Form Variants"](a)||cX["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a))}function go(a){return cX.Arabic(a)||cX["Arabic Supplement"](a)||cX["Arabic Extended-A"](a)||cX["Arabic Presentation Forms-A"](a)||cX["Arabic Presentation Forms-B"](a)}function gp(a){return a>=1424&&a<=2303||cX["Arabic Presentation Forms-A"](a)||cX["Arabic Presentation Forms-B"](a)}function gq(a,b){return!(!b&&gp(a))&&!(a>=2304&&a<=3583||a>=3840&&a<=4255||cX.Khmer(a))}function gr(c){for(var a=0,b=c;a<b.length;a+=1)if(gp(b[a].charCodeAt(0)))return!0;return!1}var cY={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},gs=null,gt=cY.unavailable,gu=null,cZ=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")> -1&&(gt=cY.error),gs&&gs(a)};function gv(){c$.fire(new bq("pluginStateChange",{pluginStatus:gt,pluginURL:gu}))}var c$=new A,c_=function(){return gt},gw=function(){if(gt!==cY.deferred||!gu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");gt=cY.loading,gv(),gu&&cq({url:gu},function(a){a?cZ(a):(gt=cY.loaded,gv())})},c0={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return gt===cY.loaded||null!=c0.applyArabicShaping},isLoading:function(){return gt===cY.loading},setState:function(a){gt=a.pluginStatus,gu=a.pluginURL},isParsed:function(){return null!=c0.applyArabicShaping&&null!=c0.processBidirectionalText&&null!=c0.processStyledBidirectionalText},getPluginURL:function(){return gu}},gx=function(){c0.isLoading()||c0.isLoaded()||"deferred"!==c_()||gw()},aP=function(b,a){this.zoom=b,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new by,this.transition={})};aP.prototype.isSupportedScript=function(a){return function(c,d){for(var a=0,b=c;a<b.length;a+=1)if(!gq(b[a].charCodeAt(0),d))return!1;return!0}(a,c0.isLoaded())},aP.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},aP.prototype.getCrossfadeParameters=function(){var a=this.zoom,b=a-Math.floor(a),c=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:b+(1-b)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*b}};var bz=function(a,b){this.property=a,this.value=b,this.expression=function(a,b){if(fE(a))return new a0(a,b);if(fN(a)){var c=fO(a,b);if("error"===c.result)throw new Error(c.value.map(function(a){return a.key+": "+a.message}).join(", "));return c.value}var d=a;return"string"==typeof a&&"color"===b.type&&(d=s.parse(a)),{kind:"constant",evaluate:function(){return d}}}(void 0===b?a.specification.default:b,a.specification)};bz.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},bz.prototype.possiblyEvaluate=function(a,b,c){return this.property.possiblyEvaluate(this,a,b,c)};var bA=function(a){this.property=a,this.value=new bz(a,void 0)};bA.prototype.transitioned=function(a,b){return new c1(this.property,this.value,b,b5({},a.transition,this.transition),a.now)},bA.prototype.untransitioned=function(){return new c1(this.property,this.value,null,{},0)};var J=function(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)};J.prototype.getValue=function(a){return cb(this._values[a].value.value)},J.prototype.setValue=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new bA(this._values[a].property)),this._values[a].value=new bz(this._values[a].property,null===b?void 0:cb(b))},J.prototype.getTransition=function(a){return cb(this._values[a].transition)},J.prototype.setTransition=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new bA(this._values[a].property)),this._values[a].transition=cb(b)||void 0},J.prototype.serialize=function(){for(var b={},c=0,d=Object.keys(this._values);c<d.length;c+=1){var a=d[c],e=this.getValue(a);void 0!==e&&(b[a]=e);var f=this.getTransition(a);void 0!==f&&(b[a+"-transition"]=f)}return b},J.prototype.transitioned=function(e,f){for(var c=new bB(this._properties),a=0,d=Object.keys(this._values);a<d.length;a+=1){var b=d[a];c._values[b]=this._values[b].transitioned(e,f._values[b])}return c},J.prototype.untransitioned=function(){for(var b=new bB(this._properties),a=0,c=Object.keys(this._values);a<c.length;a+=1){var d=c[a];b._values[d]=this._values[d].untransitioned()}return b};var c1=function(b,c,d,a,e){this.property=b,this.value=c,this.begin=e+a.delay||0,this.end=this.begin+a.duration||0,b.specification.transition&&(a.delay||a.duration)&&(this.prior=d)};c1.prototype.possiblyEvaluate=function(a,c,d){var e=a.now||0,b=this.value.possiblyEvaluate(a,c,d),f=this.prior;if(!f)return b;if(e>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(e<this.begin)return f.possiblyEvaluate(a,c,d);var g=(e-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(a,c,d),b,function(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}(g))};var bB=function(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)};bB.prototype.possiblyEvaluate=function(e,f,g){for(var b=new c2(this._properties),a=0,c=Object.keys(this._values);a<c.length;a+=1){var d=c[a];b._values[d]=this._values[d].possiblyEvaluate(e,f,g)}return b},bB.prototype.hasTransition=function(){for(var a=0,b=Object.keys(this._values);a<b.length;a+=1){var c=b[a];if(this._values[c].prior)return!0}return!1};var aQ=function(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)};aQ.prototype.getValue=function(a){return cb(this._values[a].value)},aQ.prototype.setValue=function(a,b){this._values[a]=new bz(this._values[a].property,null===b?void 0:cb(b))},aQ.prototype.serialize=function(){for(var b={},a=0,c=Object.keys(this._values);a<c.length;a+=1){var d=c[a],e=this.getValue(d);void 0!==e&&(b[d]=e)}return b},aQ.prototype.possiblyEvaluate=function(e,f,g){for(var b=new c2(this._properties),a=0,c=Object.keys(this._values);a<c.length;a+=1){var d=c[a];b._values[d]=this._values[d].possiblyEvaluate(e,f,g)}return b};var a3=function(a,b,c){this.property=a,this.value=b,this.parameters=c};a3.prototype.isConstant=function(){return"constant"===this.value.kind},a3.prototype.constantOr=function(a){return"constant"===this.value.kind?this.value.value:a},a3.prototype.evaluate=function(a,b,c,d){return this.property.evaluate(this.value,this.parameters,a,b,c,d)};var c2=function(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)};c2.prototype.get=function(a){return this._values[a]};var e=function(a){this.specification=a};e.prototype.possiblyEvaluate=function(a,b){return a.expression.evaluate(b)},e.prototype.interpolate=function(a,c,d){var b=fj[this.specification.type];return b?b(a,c,d):a};var f=function(a,b){this.specification=a,this.overrides=b};f.prototype.possiblyEvaluate=function(a,b,c,d){return"constant"===a.expression.kind||"camera"===a.expression.kind?new a3(this,{kind:"constant",value:a.expression.evaluate(b,null,{},c,d)},b):new a3(this,a.expression,b)},f.prototype.interpolate=function(a,b,d){if("constant"!==a.value.kind||"constant"!==b.value.kind)return a;if(void 0===a.value.value|| void 0===b.value.value)return new a3(this,{kind:"constant",value:void 0},a.parameters);var c=fj[this.specification.type];return c?new a3(this,{kind:"constant",value:c(a.value.value,b.value.value,d)},a.parameters):a},f.prototype.evaluate=function(a,b,c,d,e,f){return"constant"===a.kind?a.value:a.evaluate(b,c,d,e,f)};var aR=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.possiblyEvaluate=function(b,a,e,f){if(void 0===b.value)return new a3(this,{kind:"constant",value:void 0},a);if("constant"===b.expression.kind){var c=b.expression.evaluate(a,null,{},e,f),d="resolvedImage"===b.property.specification.type&&"string"!=typeof c?c.name:c,g=this._calculate(d,d,d,a);return new a3(this,{kind:"constant",value:g},a)}if("camera"!==b.expression.kind)return new a3(this,b.expression,a);var h=this._calculate(b.expression.evaluate({zoom:a.zoom-1}),b.expression.evaluate({zoom:a.zoom}),b.expression.evaluate({zoom:a.zoom+1}),a);return new a3(this,{kind:"constant",value:h},a)},a.prototype.evaluate=function(a,b,c,d,f,g){if("source"===a.kind){var e=a.evaluate(b,c,d,f,g);return this._calculate(e,e,e,b)}return"composite"===a.kind?this._calculate(a.evaluate({zoom:Math.floor(b.zoom)-1},c,d),a.evaluate({zoom:Math.floor(b.zoom)},c,d),a.evaluate({zoom:Math.floor(b.zoom)+1},c,d),b):a.value},a.prototype._calculate=function(c,a,d,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:a}:{from:d,to:a}},a.prototype.interpolate=function(a){return a},a}(f),ak=function(a){this.specification=a};ak.prototype.possiblyEvaluate=function(b,a,d,e){if(void 0!==b.value){if("constant"!==b.expression.kind)return this._calculate(b.expression.evaluate(new aP(Math.floor(a.zoom-1),a)),b.expression.evaluate(new aP(Math.floor(a.zoom),a)),b.expression.evaluate(new aP(Math.floor(a.zoom+1),a)),a);var c=b.expression.evaluate(a,null,{},d,e);return this._calculate(c,c,c,a)}},ak.prototype._calculate=function(c,a,d,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:c,to:a}:{from:d,to:a}},ak.prototype.interpolate=function(a){return a};var az=function(a){this.specification=a};az.prototype.possiblyEvaluate=function(a,b,c,d){return!!a.expression.evaluate(b,null,{},c,d)},az.prototype.interpolate=function(){return!1};var p=function(b){for(var a in this.properties=b,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],b){var c=b[a];c.specification.overridable&&this.overridableProperties.push(a);var d=this.defaultPropertyValues[a]=new bz(c,void 0),e=this.defaultTransitionablePropertyValues[a]=new bA(c);this.defaultTransitioningPropertyValues[a]=e.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=d.possiblyEvaluate({})}};c("DataDrivenProperty",f),c("DataConstantProperty",e),c("CrossFadedDataDrivenProperty",aR),c("CrossFadedProperty",ak),c("ColorRampProperty",az);var gy="-transition",x=function(c){function a(a,b){if(c.call(this),this.id=a.id,this.type=a.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==a.type&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,"background"!==a.type&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),b.layout&&(this._unevaluatedLayout=new aQ(b.layout)),b.paint)){for(var d in this._transitionablePaint=new J(b.paint),a.paint)this.setPaintProperty(d,a.paint[d],{validate:!1});for(var e in a.layout)this.setLayoutProperty(e,a.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new c2(b.paint)}}return c&&(a.__proto__=c),a.prototype=Object.create(c&&c.prototype),a.prototype.constructor=a,a.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},a.prototype.getLayoutProperty=function(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)},a.prototype.setLayoutProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".layout."+a;if(this._validate(f9,d,a,b,c))return}if("visibility"===a){this.visibility=b;return}this._unevaluatedLayout.setValue(a,b)},a.prototype.getPaintProperty=function(a){return b8(a,gy)?this._transitionablePaint.getTransition(a.slice(0,-gy.length)):this._transitionablePaint.getValue(a)},a.prototype.setPaintProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var f="layers."+this.id+".paint."+a;if(this._validate(f8,f,a,b,c))return!1}if(b8(a,gy))return this._transitionablePaint.setTransition(a.slice(0,-gy.length),b||void 0),!1;var d=this._transitionablePaint._values[a],g="cross-faded-data-driven"===d.property.specification["property-type"],h=d.value.isDataDriven(),i=d.value;this._transitionablePaint.setValue(a,b),this._handleSpecialPaintPropertyUpdate(a);var e=this._transitionablePaint._values[a].value,j=e.isDataDriven();return j||h||g||this._handleOverridablePaintPropertyUpdate(a,i,e)},a.prototype._handleSpecialPaintPropertyUpdate=function(a){},a.prototype._handleOverridablePaintPropertyUpdate=function(a,b,c){return!1},a.prototype.isHidden=function(a){return!!this.minzoom&&a<this.minzoom|| !!this.maxzoom&&a>=this.maxzoom||"none"===this.visibility},a.prototype.updateTransitions=function(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)},a.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},a.prototype.recalculate=function(a,b){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,b)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,b)},a.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),ca(a,function(a,b){return void 0!==a&&!("layout"===b&&!Object.keys(a).length)&&!("paint"===b&&!Object.keys(a).length)})},a.prototype._validate=function(c,d,e,f,a){return void 0===a&&(a={}),(!a|| !1!==a.validate)&&cW(this,c.call(aO,{key:d,layerType:this.type,objectKey:e,value:f,styleSpec:b,style:{glyphs:!0,sprite:!0}}))},a.prototype.is3D=function(){return!1},a.prototype.isTileClipped=function(){return!1},a.prototype.hasOffscreenPass=function(){return!1},a.prototype.resize=function(){},a.prototype.isStateDependent=function(){for(var b in this.paint._values){var a=this.paint.get(b);if(a instanceof a3&&fA(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1},a}(A),gz={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},aS=function(a,b){this._structArray=a,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},i=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function m(b,a){void 0===a&&(a=1);var c=0,d=0;return{members:b.map(function(b){var e=gA(b.type),g=c=gB(c,Math.max(a,e)),f=b.components||1;return d=Math.max(d,e),c+=e*f,{name:b.name,type:b.type,components:f,offset:g}}),size:gB(c,Math.max(d,a)),alignment:a}}function gA(a){return gz[a].BYTES_PER_ELEMENT}function gB(b,a){return Math.ceil(b/a)*a}i.serialize=function(a,b){return a._trim(),b&&(a.isTransferred=!0,b.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},i.deserialize=function(b){var a=Object.create(this.prototype);return a.arrayBuffer=b.arrayBuffer,a.length=b.length,a.capacity=b.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a},i.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},i.prototype.clear=function(){this.length=0},i.prototype.resize=function(a){this.reserve(a),this.length=a},i.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var b=this.uint8;this._refreshViews(),b&&this.uint8.set(b)}},i.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var a4=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c){var a=this.length;return this.resize(a+1),this.emplace(a,b,c)},a.prototype.emplace=function(a,c,d){var b=2*a;return this.int16[b+0]=c,this.int16[b+1]=d,a},a}(i);a4.prototype.bytesPerElement=4,c("StructArrayLayout2i4",a4);var a5=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e)},a.prototype.emplace=function(b,c,d,e,f){var a=4*b;return this.int16[a+0]=c,this.int16[a+1]=d,this.int16[a+2]=e,this.int16[a+3]=f,b},a}(i);a5.prototype.bytesPerElement=8,c("StructArrayLayout4i8",a5);var bC=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g)},a.prototype.emplace=function(b,c,d,e,f,g,h){var a=6*b;return this.int16[a+0]=c,this.int16[a+1]=d,this.int16[a+2]=e,this.int16[a+3]=f,this.int16[a+4]=g,this.int16[a+5]=h,b},a}(i);bC.prototype.bytesPerElement=12,c("StructArrayLayout2i4i12",bC);var bD=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g)},a.prototype.emplace=function(b,d,e,f,g,h,i){var c=4*b,a=8*b;return this.int16[c+0]=d,this.int16[c+1]=e,this.uint8[a+4]=f,this.uint8[a+5]=g,this.uint8[a+6]=h,this.uint8[a+7]=i,b},a}(i);bD.prototype.bytesPerElement=8,c("StructArrayLayout2i4ub8",bD);var bE=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g,h,i,j,k){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g,h,i,j,k)},a.prototype.emplace=function(b,d,e,f,g,h,i,j,k,l,m){var a=9*b,c=18*b;return this.uint16[a+0]=d,this.uint16[a+1]=e,this.uint16[a+2]=f,this.uint16[a+3]=g,this.uint16[a+4]=h,this.uint16[a+5]=i,this.uint16[a+6]=j,this.uint16[a+7]=k,this.uint8[c+16]=l,this.uint8[c+17]=m,b},a}(i);bE.prototype.bytesPerElement=18,c("StructArrayLayout8ui2ub18",bE);var bF=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g,h,i,j,k,l,m){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g,h,i,j,k,l,m)},a.prototype.emplace=function(b,c,d,e,f,g,h,i,j,k,l,m,n){var a=12*b;return this.int16[a+0]=c,this.int16[a+1]=d,this.int16[a+2]=e,this.int16[a+3]=f,this.uint16[a+4]=g,this.uint16[a+5]=h,this.uint16[a+6]=i,this.uint16[a+7]=j,this.int16[a+8]=k,this.int16[a+9]=l,this.int16[a+10]=m,this.int16[a+11]=n,b},a}(i);bF.prototype.bytesPerElement=24,c("StructArrayLayout4i4ui4i24",bF);var bG=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d)},a.prototype.emplace=function(b,c,d,e){var a=3*b;return this.float32[a+0]=c,this.float32[a+1]=d,this.float32[a+2]=e,b},a}(i);bG.prototype.bytesPerElement=12,c("StructArrayLayout3f12",bG);var bH=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b){var a=this.length;return this.resize(a+1),this.emplace(a,b)},a.prototype.emplace=function(a,b){var c=1*a;return this.uint32[c+0]=b,a},a}(i);bH.prototype.bytesPerElement=4,c("StructArrayLayout1ul4",bH);var a6=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g,h,i,j){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g,h,i,j)},a.prototype.emplace=function(b,c,d,e,f,g,h,i,j,k){var a=10*b,l=5*b;return this.int16[a+0]=c,this.int16[a+1]=d,this.int16[a+2]=e,this.int16[a+3]=f,this.int16[a+4]=g,this.int16[a+5]=h,this.uint32[l+3]=i,this.uint16[a+8]=j,this.uint16[a+9]=k,b},a}(i);a6.prototype.bytesPerElement=20,c("StructArrayLayout6i1ul2ui20",a6);var bI=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g)},a.prototype.emplace=function(b,c,d,e,f,g,h){var a=6*b;return this.int16[a+0]=c,this.int16[a+1]=d,this.int16[a+2]=e,this.int16[a+3]=f,this.int16[a+4]=g,this.int16[a+5]=h,b},a}(i);bI.prototype.bytesPerElement=12,c("StructArrayLayout2i2i2i12",bI);var a7=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f)},a.prototype.emplace=function(a,d,e,f,g,h){var b=4*a,c=8*a;return this.float32[b+0]=d,this.float32[b+1]=e,this.float32[b+2]=f,this.int16[c+6]=g,this.int16[c+7]=h,a},a}(i);a7.prototype.bytesPerElement=16,c("StructArrayLayout2f1f2i16",a7);var bJ=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e)},a.prototype.emplace=function(a,d,e,f,g){var b=12*a,c=3*a;return this.uint8[b+0]=d,this.uint8[b+1]=e,this.float32[c+1]=f,this.float32[c+2]=g,a},a}(i);bJ.prototype.bytesPerElement=12,c("StructArrayLayout2ub2f12",bJ);var a8=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d)},a.prototype.emplace=function(b,c,d,e){var a=3*b;return this.uint16[a+0]=c,this.uint16[a+1]=d,this.uint16[a+2]=e,b},a}(i);a8.prototype.bytesPerElement=6,c("StructArrayLayout3ui6",a8);var a9=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r)},a.prototype.emplace=function(c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var a=24*c,b=12*c,d=48*c;return this.int16[a+0]=e,this.int16[a+1]=f,this.uint16[a+2]=g,this.uint16[a+3]=h,this.uint32[b+2]=i,this.uint32[b+3]=j,this.uint32[b+4]=k,this.uint16[a+10]=l,this.uint16[a+11]=m,this.uint16[a+12]=n,this.float32[b+7]=o,this.float32[b+8]=p,this.uint8[d+36]=q,this.uint8[d+37]=r,this.uint8[d+38]=s,this.uint32[b+10]=t,this.int16[a+22]=u,c},a}(i);a9.prototype.bytesPerElement=48,c("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",a9);var ba=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C)},a.prototype.emplace=function(c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){var a=34*c,b=17*c;return this.int16[a+0]=d,this.int16[a+1]=e,this.int16[a+2]=f,this.int16[a+3]=g,this.int16[a+4]=h,this.int16[a+5]=i,this.int16[a+6]=j,this.int16[a+7]=k,this.uint16[a+8]=l,this.uint16[a+9]=m,this.uint16[a+10]=n,this.uint16[a+11]=o,this.uint16[a+12]=p,this.uint16[a+13]=q,this.uint16[a+14]=r,this.uint16[a+15]=s,this.uint16[a+16]=t,this.uint16[a+17]=u,this.uint16[a+18]=v,this.uint16[a+19]=w,this.uint16[a+20]=x,this.uint16[a+21]=y,this.uint16[a+22]=z,this.uint32[b+12]=A,this.float32[b+13]=B,this.float32[b+14]=C,this.float32[b+15]=D,this.float32[b+16]=E,c},a}(i);ba.prototype.bytesPerElement=68,c("StructArrayLayout8i15ui1ul4f68",ba);var bb=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b){var a=this.length;return this.resize(a+1),this.emplace(a,b)},a.prototype.emplace=function(a,b){var c=1*a;return this.float32[c+0]=b,a},a}(i);bb.prototype.bytesPerElement=4,c("StructArrayLayout1f4",bb);var bc=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d)},a.prototype.emplace=function(b,c,d,e){var a=3*b;return this.int16[a+0]=c,this.int16[a+1]=d,this.int16[a+2]=e,b},a}(i);bc.prototype.bytesPerElement=6,c("StructArrayLayout3i6",bc);var bd=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d)},a.prototype.emplace=function(a,c,d,e){var f=2*a,b=4*a;return this.uint32[f+0]=c,this.uint16[b+2]=d,this.uint16[b+3]=e,a},a}(i);bd.prototype.bytesPerElement=8,c("StructArrayLayout1ul2ui8",bd);var bK=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c){var a=this.length;return this.resize(a+1),this.emplace(a,b,c)},a.prototype.emplace=function(a,c,d){var b=2*a;return this.uint16[b+0]=c,this.uint16[b+1]=d,a},a}(i);bK.prototype.bytesPerElement=4,c("StructArrayLayout2ui4",bK);var be=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b){var a=this.length;return this.resize(a+1),this.emplace(a,b)},a.prototype.emplace=function(a,b){var c=1*a;return this.uint16[c+0]=b,a},a}(i);be.prototype.bytesPerElement=2,c("StructArrayLayout1ui2",be);var bL=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c){var a=this.length;return this.resize(a+1),this.emplace(a,b,c)},a.prototype.emplace=function(a,c,d){var b=2*a;return this.float32[b+0]=c,this.float32[b+1]=d,a},a}(i);bL.prototype.bytesPerElement=8,c("StructArrayLayout2f8",bL);var bM=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},a.prototype.emplaceBack=function(b,c,d,e){var a=this.length;return this.resize(a+1),this.emplace(a,b,c,d,e)},a.prototype.emplace=function(b,c,d,e,f){var a=4*b;return this.float32[a+0]=c,this.float32[a+1]=d,this.float32[a+2]=e,this.float32[a+3]=f,b},a}(i);bM.prototype.bytesPerElement=16,c("StructArrayLayout4f16",bM);var c3=function(c){function b(){c.apply(this,arguments)}c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b;var a={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return a.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},a.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},a.x1.get=function(){return this._structArray.int16[this._pos2+2]},a.y1.get=function(){return this._structArray.int16[this._pos2+3]},a.x2.get=function(){return this._structArray.int16[this._pos2+4]},a.y2.get=function(){return this._structArray.int16[this._pos2+5]},a.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},a.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},a.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},a.anchorPoint.get=function(){return new aY(this.anchorPointX,this.anchorPointY)},Object.defineProperties(b.prototype,a),b}(aS);c3.prototype.size=20;var bN=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.get=function(a){return new c3(this,a)},a}(a6);c("CollisionBoxArray",bN);var c4=function(c){function b(){c.apply(this,arguments)}c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b;var a={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return a.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},a.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},a.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},a.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},a.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},a.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},a.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},a.segment.get=function(){return this._structArray.uint16[this._pos2+10]},a.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},a.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},a.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},a.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},a.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},a.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},a.placedOrientation.set=function(a){this._structArray.uint8[this._pos1+37]=a},a.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},a.hidden.set=function(a){this._structArray.uint8[this._pos1+38]=a},a.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},a.crossTileID.set=function(a){this._structArray.uint32[this._pos4+10]=a},a.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(b.prototype,a),b}(aS);c4.prototype.size=48;var c5=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.get=function(a){return new c4(this,a)},a}(a9);c("PlacedSymbolArray",c5);var c6=function(c){function b(){c.apply(this,arguments)}c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b;var a={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return a.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},a.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},a.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},a.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},a.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},a.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},a.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},a.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},a.key.get=function(){return this._structArray.uint16[this._pos2+8]},a.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},a.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},a.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},a.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},a.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},a.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},a.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},a.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},a.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},a.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},a.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},a.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},a.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},a.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},a.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},a.crossTileID.set=function(a){this._structArray.uint32[this._pos4+12]=a},a.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},a.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},a.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},a.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(b.prototype,a),b}(aS);c6.prototype.size=68;var c7=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.get=function(a){return new c6(this,a)},a}(ba);c("SymbolInstanceArray",c7);var c8=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getoffsetX=function(a){return this.float32[1*a+0]},a}(bb);c("GlyphOffsetArray",c8);var c9=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getx=function(a){return this.int16[3*a+0]},a.prototype.gety=function(a){return this.int16[3*a+1]},a.prototype.gettileUnitDistanceFromAnchor=function(a){return this.int16[3*a+2]},a}(bc);c("SymbolLineVertexArray",c9);var da=function(b){function a(){b.apply(this,arguments)}b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(a.prototype,c),a}(aS);da.prototype.size=8;var db=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.get=function(a){return new da(this,a)},a}(bd);c("FeatureIndexArray",db);var gC=m([{name:"a_pos",components:2,type:"Int16"}],4).members,N=function(a){void 0===a&&(a=[]),this.segments=a};function gD(a,b){return a=b3(Math.floor(a),0,255),b=b3(Math.floor(b),0,255),256*a+b}N.prototype.prepareSegment=function(b,d,e,c){var a=this.segments[this.segments.length-1];return b>N.MAX_VERTEX_ARRAY_LENGTH&&cc("Max vertices per segment is "+N.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+b),(!a||a.vertexLength+b>N.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==c)&&(a={vertexOffset:d.length,primitiveOffset:e.length,vertexLength:0,primitiveLength:0},void 0!==c&&(a.sortKey=c),this.segments.push(a)),a},N.prototype.get=function(){return this.segments},N.prototype.destroy=function(){for(var a=0,b=this.segments;a<b.length;a+=1){var c=b[a];for(var d in c.vaos)c.vaos[d].destroy()}},N.simpleSegment=function(a,b,c,d){return new N([{vertexOffset:a,primitiveOffset:b,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])},N.MAX_VERTEX_ARRAY_LENGTH=65535,c("SegmentVector",N);var gE=m([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),bO=aK(function(a){a.exports=function(c,j){var g,h,a,i,e,f,b,d;for(g=3&c.length,h=c.length-g,a=j,e=3432918353,f=461845907,d=0;d<h;)b=255&c.charCodeAt(d)|(255&c.charCodeAt(++d))<<8|(255&c.charCodeAt(++d))<<16|(255&c.charCodeAt(++d))<<24,++d,a^=b=(65535&(b=(b=(65535&b)*e+(((b>>>16)*e&65535)<<16)&4294967295)<<15|b>>>17))*f+(((b>>>16)*f&65535)<<16)&4294967295,a=(65535&(i=(65535&(a=a<<13|a>>>19))*5+(((a>>>16)*5&65535)<<16)&4294967295))+27492+(((i>>>16)+58964&65535)<<16);switch(b=0,g){case 3:b^=(255&c.charCodeAt(d+2))<<16;case 2:b^=(255&c.charCodeAt(d+1))<<8;case 1:b^=255&c.charCodeAt(d),a^=b=(65535&(b=(b=(65535&b)*e+(((b>>>16)*e&65535)<<16)&4294967295)<<15|b>>>17))*f+(((b>>>16)*f&65535)<<16)&4294967295}return a^=c.length,a^=a>>>16,a=(65535&a)*2246822507+(((a>>>16)*2246822507&65535)<<16)&4294967295,a^=a>>>13,a=(65535&a)*3266489909+(((a>>>16)*3266489909&65535)<<16)&4294967295,a^=a>>>16,a>>>0}}),dc=aK(function(a){a.exports=function(c,f){for(var b,e=c.length,a=f^e,d=0;e>=4;)b=(65535&(b=255&c.charCodeAt(d)|(255&c.charCodeAt(++d))<<8|(255&c.charCodeAt(++d))<<16|(255&c.charCodeAt(++d))<<24))*1540483477+(((b>>>16)*1540483477&65535)<<16),b^=b>>>24,b=(65535&b)*1540483477+(((b>>>16)*1540483477&65535)<<16),a=(65535&a)*1540483477+(((a>>>16)*1540483477&65535)<<16)^b,e-=4,++d;switch(e){case 3:a^=(255&c.charCodeAt(d+2))<<16;case 2:a^=(255&c.charCodeAt(d+1))<<8;case 1:a^=255&c.charCodeAt(d),a=(65535&a)*1540483477+(((a>>>16)*1540483477&65535)<<16)}return a^=a>>>13,a=(65535&a)*1540483477+(((a>>>16)*1540483477&65535)<<16),a^=a>>>15,a>>>0}}),bP=bO;bP.murmur3=bO,bP.murmur2=dc;var aA=function(){this.ids=[],this.positions=[],this.indexed=!1};function gF(b){var a=+b;return!isNaN(a)&&a<=9007199254740991?a:bP(String(b))}function gG(c,f,d,e){for(;d<e;){for(var g=c[d+e>>1],b=d-1,a=e+1;;){do b++;while(c[b]<g)do a--;while(c[a]>g)if(b>=a)break;gH(c,b,a),gH(f,3*b,3*a),gH(f,3*b+1,3*a+1),gH(f,3*b+2,3*a+2)}a-d<e-a?(gG(c,f,d,a),d=a+1):(gG(c,f,a+1,e),e=a)}}function gH(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}aA.prototype.add=function(a,b,c,d){this.ids.push(gF(a)),this.positions.push(b,c,d)},aA.prototype.getPositions=function(f){for(var d=gF(f),a=0,b=this.ids.length-1;a<b;){var c=a+b>>1;this.ids[c]>=d?b=c:a=c+1}for(var e=[];this.ids[a]===d;){var g=this.positions[3*a],h=this.positions[3*a+1],i=this.positions[3*a+2];e.push({index:g,start:h,end:i}),a++}return e},aA.serialize=function(c,d){var a=new Float64Array(c.ids),b=new Uint32Array(c.positions);return gG(a,b,0,a.length-1),d&&d.push(a.buffer,b.buffer),{ids:a,positions:b}},aA.deserialize=function(b){var a=new aA;return a.ids=b.ids,a.positions=b.positions,a.indexed=!0,a},c("FeaturePositionMap",aA);var O=function(a,b){this.gl=a.gl,this.location=b},dd=function(b){function a(a,c){b.call(this,a,c),this.current=0}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))},a}(O),de=function(b){function a(a,c){b.call(this,a,c),this.current=0}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))},a}(O),df=function(b){function a(a,c){b.call(this,a,c),this.current=[0,0]}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){(a[0]!==this.current[0]||a[1]!==this.current[1])&&(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))},a}(O),dg=function(b){function a(a,c){b.call(this,a,c),this.current=[0,0,0]}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){(a[0]!==this.current[0]||a[1]!==this.current[1]||a[2]!==this.current[2])&&(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))},a}(O),dh=function(b){function a(a,c){b.call(this,a,c),this.current=[0,0,0,0]}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){(a[0]!==this.current[0]||a[1]!==this.current[1]||a[2]!==this.current[2]||a[3]!==this.current[3])&&(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))},a}(O),di=function(b){function a(a,c){b.call(this,a,c),this.current=s.transparent}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){(a.r!==this.current.r||a.g!==this.current.g||a.b!==this.current.b||a.a!==this.current.a)&&(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))},a}(O),gI=new Float32Array(16),dj=function(b){function a(a,c){b.call(this,a,c),this.current=gI}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);return}for(var b=1;b<16;b++)if(a[b]!==this.current[b]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},a}(O);function gJ(a){return[gD(255*a.r,255*a.g),gD(255*a.b,255*a.a)]}var bf=function(a,b,c){this.value=a,this.uniformNames=b.map(function(a){return"u_"+a}),this.type=c};bf.prototype.setUniform=function(a,c,b){a.set(b.constantOr(this.value))},bf.prototype.getBinding=function(a,b,c){return"color"===this.type?new di(a,b):new de(a,b)};var aT=function(b,a){this.uniformNames=a.map(function(a){return"u_"+a}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};aT.prototype.setConstantPatternPositions=function(a,b){this.pixelRatioFrom=b.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=b.tlbr,this.patternTo=a.tlbr},aT.prototype.setUniform=function(c,d,e,a){var b="u_pattern_to"===a?this.patternTo:"u_pattern_from"===a?this.patternFrom:"u_pixel_ratio_to"===a?this.pixelRatioTo:"u_pixel_ratio_from"===a?this.pixelRatioFrom:null;b&&c.set(b)},aT.prototype.getBinding=function(a,b,c){return"u_pattern"===c.substr(0,9)?new dh(a,b):new de(a,b)};var al=function(a,b,c,d){this.expression=a,this.type=c,this.maxValue=0,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?2:1,offset:0}}),this.paintVertexArray=new d};al.prototype.populatePaintArray=function(a,b,g,c,d){var e=this.paintVertexArray.length,f=this.expression.evaluate(new aP(0),b,{},c,[],d);this.paintVertexArray.resize(a),this._setPaintValue(e,a,f)},al.prototype.updatePaintArray=function(a,b,c,d){var e=this.expression.evaluate({zoom:0},c,d);this._setPaintValue(a,b,e)},al.prototype._setPaintValue=function(d,e,a){if("color"===this.type)for(var f=gJ(a),b=d;b<e;b++)this.paintVertexArray.emplace(b,f[0],f[1]);else{for(var c=d;c<e;c++)this.paintVertexArray.emplace(c,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}},al.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},al.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var K=function(b,a,c,d,e,f){this.expression=b,this.uniformNames=a.map(function(a){return"u_"+a+"_t"}),this.type=c,this.useIntegerZoom=d,this.zoom=e,this.maxValue=0,this.paintVertexAttributes=a.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?4:2,offset:0}}),this.paintVertexArray=new f};K.prototype.populatePaintArray=function(a,b,h,c,d){var e=this.expression.evaluate(new aP(this.zoom),b,{},c,[],d),f=this.expression.evaluate(new aP(this.zoom+1),b,{},c,[],d),g=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(g,a,e,f)},K.prototype.updatePaintArray=function(c,d,a,b){var e=this.expression.evaluate({zoom:this.zoom},a,b),f=this.expression.evaluate({zoom:this.zoom+1},a,b);this._setPaintValue(c,d,e,f)},K.prototype._setPaintValue=function(e,f,a,b){if("color"===this.type)for(var g=gJ(a),h=gJ(b),c=e;c<f;c++)this.paintVertexArray.emplace(c,g[0],g[1],h[0],h[1]);else{for(var d=e;d<f;d++)this.paintVertexArray.emplace(d,a,b);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(b))}},K.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},K.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},K.prototype.setUniform=function(b,a){var c=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,d=b3(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);b.set(d)},K.prototype.getBinding=function(a,b,c){return new de(a,b)};var am=function(b,c,d,e,a,f){this.expression=b,this.type=c,this.useIntegerZoom=d,this.zoom=e,this.layerId=f,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a};am.prototype.populatePaintArray=function(a,b,c){var d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(d,a,b.patterns&&b.patterns[this.layerId],c)},am.prototype.updatePaintArray=function(b,c,a,e,d){this._setPaintValues(b,c,a.patterns&&a.patterns[this.layerId],d)},am.prototype._setPaintValues=function(g,h,d,e){if(e&&d){var i=d.min,j=d.mid,k=d.max,b=e[i],a=e[j],c=e[k];if(b&&a&&c)for(var f=g;f<h;f++)this.zoomInPaintVertexArray.emplace(f,a.tl[0],a.tl[1],a.br[0],a.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],a.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(f,a.tl[0],a.tl[1],a.br[0],a.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],a.pixelRatio,c.pixelRatio)}},am.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,gE.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,gE.members,this.expression.isStateDependent))},am.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var v=function(e,i,m,n){this.binders={},this.layoutAttributes=n,this._buffers=[];var f=[];for(var a in e.paint._values)if(m(a)){var c=e.paint.get(a);if(c instanceof a3&&fA(c.property.specification)){var g=gK(a,e.type),b=c.value,d=c.property.specification.type,j=c.property.useIntegerZoom,k=c.property.specification["property-type"],h="cross-faded"===k||"cross-faded-data-driven"===k;if("constant"===b.kind)this.binders[a]=h?new aT(b.value,g):new bf(b.value,g,d),f.push("/u_"+a);else if("source"===b.kind||h){var l=gL(a,d,"source");this.binders[a]=h?new am(b,d,j,i,l,e.id):new al(b,g,d,l),f.push("/a_"+a)}else{var o=gL(a,d,"composite");this.binders[a]=new K(b,g,d,j,i,o),f.push("/z_"+a)}}}this.cacheKey=f.sort().join("")};v.prototype.getMaxValue=function(b){var a=this.binders[b];return a instanceof al||a instanceof K?a.maxValue:0},v.prototype.populatePaintArrays=function(b,c,d,e,f){for(var g in this.binders){var a=this.binders[g];(a instanceof al||a instanceof K||a instanceof am)&&a.populatePaintArray(b,c,d,e,f)}},v.prototype.setConstantPatternPositions=function(b,c){for(var d in this.binders){var a=this.binders[d];a instanceof aT&&a.setConstantPatternPositions(b,c)}},v.prototype.updatePaintArrays=function(d,i,j,k,l){var e=!1;for(var f in d)for(var m=i.getPositions(f),b=0,g=m;b<g.length;b+=1){var c=g[b],n=j.feature(c.index);for(var h in this.binders){var a=this.binders[h];if((a instanceof al||a instanceof K||a instanceof am)&& !0===a.expression.isStateDependent){var o=k.paint.get(h);a.expression=o.value,a.updatePaintArray(c.start,c.end,n,d[f],l),e=!0}}}return e},v.prototype.defines=function(){var a=[];for(var c in this.binders){var b=this.binders[c];(b instanceof bf||b instanceof aT)&&a.push.apply(a,b.uniformNames.map(function(a){return"#define HAS_UNIFORM_"+a}))}return a},v.prototype.getPaintVertexBuffers=function(){return this._buffers},v.prototype.getUniforms=function(h,d){var e=[];for(var f in this.binders){var a=this.binders[f];if(a instanceof bf||a instanceof aT||a instanceof K)for(var c=0,g=a.uniformNames;c<g.length;c+=1){var b=g[c];if(d[b]){var i=a.getBinding(h,d[b],b);e.push({name:b,property:f,binding:i})}}}return e},v.prototype.setUniforms=function(j,e,f,g){for(var a=0,c=e;a<c.length;a+=1){var b=c[a],h=b.name,d=b.property,i=b.binding;this.binders[d].setUniform(i,g,f.get(d),h)}},v.prototype.updatePaintBuffers=function(b){for(var d in this._buffers=[],this.binders){var a=this.binders[d];if(b&&a instanceof am){var c=2===b.fromScale?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;c&&this._buffers.push(c)}else(a instanceof al||a instanceof K)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}},v.prototype.upload=function(b){for(var c in this.binders){var a=this.binders[c];(a instanceof al||a instanceof K||a instanceof am)&&a.upload(b)}this.updatePaintBuffers()},v.prototype.destroy=function(){for(var b in this.binders){var a=this.binders[b];(a instanceof al||a instanceof K||a instanceof am)&&a.destroy()}};var an=function(e,f,g,a){void 0===a&&(a=function(){return!0}),this.programConfigurations={};for(var b=0,c=f;b<c.length;b+=1){var d=c[b];this.programConfigurations[d.id]=new v(d,g,a,e)}this.needsUpload=!1,this._featureMap=new aA,this._bufferOffset=0};function gK(a,b){return({"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]})[a]||[a.replace(b+"-","").replace(/-/g,"_")]}function gL(c,d,a){var b={"line-pattern":{source:bE,composite:bE},"fill-pattern":{source:bE,composite:bE},"fill-extrusion-pattern":{source:bE,composite:bE}}[c];return b&&b[a]||({color:{source:bL,composite:bM},number:{source:bb,composite:bL}})[d][a]}an.prototype.populatePaintArrays=function(a,b,c,d,e,f){for(var g in this.programConfigurations)this.programConfigurations[g].populatePaintArrays(a,b,d,e,f);void 0!==b.id&&this._featureMap.add(b.id,c,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0},an.prototype.updatePaintArrays=function(d,e,f,g){for(var a=0,b=f;a<b.length;a+=1){var c=b[a];this.needsUpload=this.programConfigurations[c.id].updatePaintArrays(d,this._featureMap,e,c,g)||this.needsUpload}},an.prototype.get=function(a){return this.programConfigurations[a]},an.prototype.upload=function(a){if(this.needsUpload){for(var b in this.programConfigurations)this.programConfigurations[b].upload(a);this.needsUpload=!1}},an.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},c("ConstantBinder",bf),c("CrossFadedConstantBinder",aT),c("SourceExpressionBinder",al),c("CrossFadedCompositeBinder",am),c("CompositeExpressionBinder",K),c("ProgramConfiguration",v,{omit:["_buffers"]}),c("ProgramConfigurationSet",an);var bQ,gM={min:-1*Math.pow(2,(bQ=15)-1),max:Math.pow(2,bQ-1)-1};function gN(e){for(var f=8192/e.extent,b=e.loadGeometry(),c=0;c<b.length;c++)for(var g=b[c],d=0;d<g.length;d++){var a=g[d];a.x=Math.round(a.x*f),a.y=Math.round(a.y*f),(a.x<gM.min||a.x>gM.max||a.y<gM.min||a.y>gM.max)&&(cc("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a.x=b3(a.x,gM.min,gM.max),a.y=b3(a.y,gM.min,gM.max))}return b}function gO(a,b,c,d,e){a.emplaceBack(2*b+(d+1)/2,2*c+(e+1)/2)}var E=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new a4,this.indexArray=new a8,this.segments=new N,this.programConfigurations=new an(gC,a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function dk(a,b){for(var c=0;c<a.length;c++)if(gX(b,a[c]))return!0;for(var d=0;d<b.length;d++)if(gX(a,b[d]))return!0;return!!gS(a,b)}function gP(a,b,c){return!!gX(a,b)||!!gU(b,a,c)}function gQ(a,b){if(1===a.length)return gW(b,a[0]);for(var c=0;c<b.length;c++)for(var g=b[c],d=0;d<g.length;d++)if(gX(a,g[d]))return!0;for(var e=0;e<a.length;e++)if(gW(b,a[e]))return!0;for(var f=0;f<b.length;f++)if(gS(a,b[f]))return!0;return!1}function gR(a,b,e){if(a.length>1){if(gS(a,b))return!0;for(var c=0;c<b.length;c++)if(gU(b[c],a,e))return!0}for(var d=0;d<a.length;d++)if(gU(a[d],b,e))return!0;return!1}function gS(a,b){if(0===a.length||0===b.length)return!1;for(var c=0;c<a.length-1;c++)for(var e=a[c],f=a[c+1],d=0;d<b.length-1;d++){var g=b[d],h=b[d+1];if(gT(e,f,g,h))return!0}return!1}function gT(a,b,c,d){return ed(a,c,d)!==ed(b,c,d)&&ed(a,b,c)!==ed(a,b,d)}function gU(c,a,d){var e=d*d;if(1===a.length)return c.distSqr(a[0])<e;for(var b=1;b<a.length;b++){var f=a[b-1],g=a[b];if(gV(c,f,g)<e)return!0}return!1}function gV(b,a,c){var e=a.distSqr(c);if(0===e)return b.distSqr(a);var d=((b.x-a.x)*(c.x-a.x)+(b.y-a.y)*(c.y-a.y))/e;return d<0?b.distSqr(a):d>1?b.distSqr(c):b.distSqr(c.sub(a)._mult(d)._add(a))}function gW(h,c){for(var b,a,d,e=!1,f=0;f<h.length;f++){b=h[f];for(var g=0,i=b.length-1;g<b.length;i=g++)a=b[g],d=b[i],a.y>c.y!=d.y>c.y&&c.x<(d.x-a.x)*(c.y-a.y)/(d.y-a.y)+a.x&&(e=!e)}return e}function gX(b,c){for(var d=!1,e=0,g=b.length-1;e<b.length;g=e++){var a=b[e],f=b[g];a.y>c.y!=f.y>c.y&&c.x<(f.x-a.x)*(c.y-a.y)/(f.y-a.y)+a.x&&(d=!d)}return d}function gY(a,b,c){var d=c[0],e=c[2];if(a.x<d.x&&b.x<d.x||a.x>e.x&&b.x>e.x||a.y<d.y&&b.y<d.y||a.y>e.y&&b.y>e.y)return!1;var f=ed(a,b,c[0]);return f!==ed(a,b,c[1])||f!==ed(a,b,c[2])||f!==ed(a,b,c[3])}function gZ(a,b,d){var c=b.paint.get(a).value;return"constant"===c.kind?c.value:d.programConfigurations.get(b.id).getMaxValue(a)}function g$(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function g_(a,b,f,g,h){if(!b[0]&&!b[1])return a;var d=aY.convert(b)._mult(h);"viewport"===f&&d._rotate(-g);for(var e=[],c=0;c<a.length;c++){var i=a[c];e.push(i.sub(d))}return e}E.prototype.populate=function(k,s,e){var l=this.layers[0],f=[],b=null;"circle"===l.type&&(b=l.layout.get("circle-sort-key"));for(var g=0,m=k;g<m.length;g+=1){var c=m[g],a=c.feature,n=c.id,t=c.index,u=c.sourceLayerIndex,o=this.layers[0]._featureFilter.needGeometry,d={type:a.type,id:n,properties:a.properties,geometry:o?gN(a):[]};if(this.layers[0]._featureFilter.filter(new aP(this.zoom),d,e)){o||(d.geometry=gN(a));var v=b?b.evaluate(d,{},e):void 0,w={id:n,properties:a.properties,type:a.type,sourceLayerIndex:u,index:t,geometry:d.geometry,patterns:{},sortKey:v};f.push(w)}}b&&f.sort(function(a,b){return a.sortKey-b.sortKey});for(var h=0,p=f;h<p.length;h+=1){var q=p[h],i=q,r=i.geometry,j=i.index,x=i.sourceLayerIndex,y=k[j].feature;this.addFeature(q,r,j,e),s.featureIndex.insert(y,r,j,x,this.index)}},E.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},E.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},E.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},E.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,gC),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},E.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},E.prototype.addFeature=function(g,k,l,m){for(var d=0,h=k;d<h.length;d+=1)for(var n=h[d],e=0,i=n;e<i.length;e+=1){var j=i[e],a=j.x,b=j.y;if(!(a<0)&&!(a>=8192)&&!(b<0)&&!(b>=8192)){var f=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,g.sortKey),c=f.vertexLength;gO(this.layoutVertexArray,a,b,-1,-1),gO(this.layoutVertexArray,a,b,1,-1),gO(this.layoutVertexArray,a,b,1,1),gO(this.layoutVertexArray,a,b,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),f.vertexLength+=4,f.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,g,l,{},m)},c("CircleBucket",E,{omit:["layers"]});var dl=new p({"circle-sort-key":new f(b.layout_circle["circle-sort-key"])}),dm=new p({"circle-radius":new f(b.paint_circle["circle-radius"]),"circle-color":new f(b.paint_circle["circle-color"]),"circle-blur":new f(b.paint_circle["circle-blur"]),"circle-opacity":new f(b.paint_circle["circle-opacity"]),"circle-translate":new e(b.paint_circle["circle-translate"]),"circle-translate-anchor":new e(b.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new e(b.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new e(b.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new f(b.paint_circle["circle-stroke-width"]),"circle-stroke-color":new f(b.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new f(b.paint_circle["circle-stroke-opacity"])}),g0={paint:dm,layout:dl},ao="undefined"!=typeof Float32Array?Float32Array:Array;function dn(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function bR(e,f,g){var h=f[0],i=f[1],j=f[2],k=f[3],l=f[4],m=f[5],n=f[6],o=f[7],p=f[8],q=f[9],r=f[10],s=f[11],t=f[12],u=f[13],v=f[14],w=f[15],a=g[0],b=g[1],c=g[2],d=g[3];return e[0]=a*h+b*l+c*p+d*t,e[1]=a*i+b*m+c*q+d*u,e[2]=a*j+b*n+c*r+d*v,e[3]=a*k+b*o+c*s+d*w,a=g[4],b=g[5],c=g[6],d=g[7],e[4]=a*h+b*l+c*p+d*t,e[5]=a*i+b*m+c*q+d*u,e[6]=a*j+b*n+c*r+d*v,e[7]=a*k+b*o+c*s+d*w,a=g[8],b=g[9],c=g[10],d=g[11],e[8]=a*h+b*l+c*p+d*t,e[9]=a*i+b*m+c*q+d*u,e[10]=a*j+b*n+c*r+d*v,e[11]=a*k+b*o+c*s+d*w,a=g[12],b=g[13],c=g[14],d=g[15],e[12]=a*h+b*l+c*p+d*t,e[13]=a*i+b*m+c*q+d*u,e[14]=a*j+b*n+c*r+d*v,e[15]=a*k+b*o+c*s+d*w,e}function dp(b,c,a){var d=c[0],e=c[1],f=c[2],g=c[3];return b[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*g,b[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*g,b[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*g,b[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*g,b}Math.hypot||(Math.hypot=function(){for(var b=arguments,c=0,a=arguments.length;a--;)c+=b[a]*b[a];return Math.sqrt(c)}),g6=new ao(3),ao!=Float32Array&&(g6[0]=0,g6[1]=0,g6[2]=0),g7=new ao(4),ao!=Float32Array&&(g7[0]=0,g7[1]=0,g7[2]=0,g7[3]=0),g8=new ao(2),ao!=Float32Array&&(g8[0]=0,g8[1]=0);var dq=function(b){function a(a){b.call(this,a,g0)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.createBucket=function(a){return new E(a)},a.prototype.queryRadius=function(b){var a=b;return gZ("circle-radius",this,a)+gZ("circle-stroke-width",this,a)+g$(this.paint.get("circle-translate"))},a.prototype.queryIntersectsFeature=function(p,h,i,q,w,b,j,c){for(var k=g_(p,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,j),r=this.paint.get("circle-radius").evaluate(h,i),l=r+this.paint.get("circle-stroke-width").evaluate(h,i),d="map"===this.paint.get("circle-pitch-alignment"),s=d?k:g2(k,c),t=d?l*j:l,e=0,m=q;e<m.length;e+=1)for(var u=m[e],f=0,n=u;f<n.length;f+=1){var a=n[f],v=d?a:g1(a,c),g=t,o=dp([],[a.x,a.y,0,1],c);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?g*=o[3]/b.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(g*=b.cameraToCenterDistance/o[3]),gP(s,v,g))return!0}return!1},a}(x);function g1(b,c){var a=dp([],[b.x,b.y,0,1],c);return new aY(a[0]/a[3],a[1]/a[3])}function g2(a,b){return a.map(function(a){return g1(a,b)})}var dr=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a}(E);function g3(b,e,f,a){var c=e.width,d=e.height;if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==c*d*f)throw new RangeError("mismatched image size")}else a=new Uint8Array(c*d*f);return b.width=c,b.height=d,b.data=a,b}function g4(a,d,e){var b=d.width,c=d.height;if(b!==a.width||c!==a.height){var f=g3({},{width:b,height:c},e);g5(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,b),height:Math.min(a.height,c)},e),a.width=b,a.height=c,a.data=f.data}}function g5(c,b,d,e,a,h){if(0===a.width||0===a.height)return b;if(a.width>c.width||a.height>c.height||d.x>c.width-a.width||d.y>c.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>b.width||a.height>b.height||e.x>b.width-a.width||e.y>b.height-a.height)throw new RangeError("out of range destination coordinates for image copy");for(var i=c.data,j=b.data,f=0;f<a.height;f++)for(var k=((d.y+f)*c.width+d.x)*h,l=((e.y+f)*b.width+e.x)*h,g=0;g<a.width*h;g++)j[l+g]=i[k+g];return b}c("HeatmapBucket",dr,{omit:["layers"]});var aB=function(a,b){g3(this,a,1,b)};aB.prototype.resize=function(a){g4(this,a,1)},aB.prototype.clone=function(){return new aB({width:this.width,height:this.height},new Uint8Array(this.data))},aB.copy=function(a,b,c,d,e){g5(a,b,c,d,e,1)};var g6,g7,g8,ap=function(a,b){g3(this,a,4,b)};ap.prototype.resize=function(a){g4(this,a,4)},ap.prototype.replace=function(a,b){b?this.data.set(a):a instanceof Uint8ClampedArray?this.data=new Uint8Array(a.buffer):this.data=a},ap.prototype.clone=function(){return new ap({width:this.width,height:this.height},new Uint8Array(this.data))},ap.copy=function(a,b,c,d,e){g5(a,b,c,d,e,4)},c("AlphaImage",aB),c("RGBAImage",ap);var g9={paint:new p({"heatmap-radius":new f(b.paint_heatmap["heatmap-radius"]),"heatmap-weight":new f(b.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new e(b.paint_heatmap["heatmap-intensity"]),"heatmap-color":new az(b.paint_heatmap["heatmap-color"]),"heatmap-opacity":new e(b.paint_heatmap["heatmap-opacity"])})};function ha(f,g){for(var b=new Uint8Array(1024),e={},d=0,c=0;d<256;d++,c+=4){e[g]=d/255;var a=f.evaluate(e);b[c+0]=Math.floor(255*a.r/a.a),b[c+1]=Math.floor(255*a.g/a.a),b[c+2]=Math.floor(255*a.b/a.a),b[c+3]=Math.floor(255*a.a)}return new ap({width:256,height:1},b)}var ds=function(b){function a(a){b.call(this,a,g9),this._updateColorRamp()}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.createBucket=function(a){return new dr(a)},a.prototype._handleSpecialPaintPropertyUpdate=function(a){"heatmap-color"===a&&this._updateColorRamp()},a.prototype._updateColorRamp=function(){var a=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=ha(a,"heatmapDensity"),this.colorRampTexture=null},a.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},a.prototype.queryRadius=function(){return 0},a.prototype.queryIntersectsFeature=function(){return!1},a.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},a}(x),hb={paint:new p({"hillshade-illumination-direction":new e(b.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new e(b.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new e(b.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new e(b.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new e(b.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new e(b.paint_hillshade["hillshade-accent-color"])})},dt=function(b){function a(a){b.call(this,a,hb)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},a}(x),hc=m([{name:"a_pos",components:2,type:"Int16"}],4).members,du=bg;function bg(b,h,a){a=a||2;var d,e,i,j,f,g,k,n=h&&h.length,o=n?h[0]*a:b.length,c=hd(b,0,o,a,!0),m=[];if(!c||c.next===c.prev)return m;if(n&&(c=hk(b,h,c,a)),b.length>80*a){d=i=b[0],e=j=b[1];for(var l=a;l<o;l+=a)f=b[l],g=b[l+1],f<d&&(d=f),g<e&&(e=g),f>i&&(i=f),g>j&&(j=g);k=0!==(k=Math.max(i-d,j-e))?1/k:0}return hf(c,m,a,d,e,k),m}function hd(c,e,f,d,g){var a,b;if(g===hH(c,e,f,d)>0)for(a=e;a<f;a+=d)b=hE(a,c[a],c[a+1],b);else for(a=f-d;a>=e;a-=d)b=hE(a,c[a],c[a+1],b);return b&&hw(b,b.next)&&(hF(b),b=b.next),b}function he(c,b){if(!c)return c;b||(b=c);var d,a=c;do if(d=!1,!a.steiner&&(hw(a,a.next)||0===hv(a.prev,a,a.next))){if(hF(a),(a=b=a.prev)===a.next)break;d=!0}else a=a.next;while(d||a!==b)return b}function hf(a,b,c,e,f,d,h){if(a){!h&&d&&hp(a,e,f,d);for(var i,g,j=a;a.prev!==a.next;){if(i=a.prev,g=a.next,d?hh(a,e,f,d):hg(a)){b.push(i.i/c),b.push(a.i/c),b.push(g.i/c),hF(a),a=g.next,j=g.next;continue}if((a=g)===j){h?1===h?hf(a=hi(he(a),b,c),b,c,e,f,d,2):2===h&&hj(a,b,c,e,f,d):hf(he(a),b,c,e,f,d,1);break}}}}function hg(b){var c=b.prev,d=b,e=b.next;if(hv(c,d,e)>=0)return!1;for(var a=b.next.next;a!==b.prev;){if(ht(c.x,c.y,d.x,d.y,e.x,e.y,a.x,a.y)&&hv(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function hh(f,g,h,i){var d=f.prev,e=f,a=f.next;if(hv(d,e,a)>=0)return!1;for(var l=d.x<e.x?d.x<a.x?d.x:a.x:e.x<a.x?e.x:a.x,m=d.y<e.y?d.y<a.y?d.y:a.y:e.y<a.y?e.y:a.y,n=d.x>e.x?d.x>a.x?d.x:a.x:e.x>a.x?e.x:a.x,o=d.y>e.y?d.y>a.y?d.y:a.y:e.y>a.y?e.y:a.y,j=hr(l,m,g,h,i),k=hr(n,o,g,h,i),b=f.prevZ,c=f.nextZ;b&&b.z>=j&&c&&c.z<=k;){if(b!==f.prev&&b!==f.next&&ht(d.x,d.y,e.x,e.y,a.x,a.y,b.x,b.y)&&hv(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,c!==f.prev&&c!==f.next&&ht(d.x,d.y,e.x,e.y,a.x,a.y,c.x,c.y)&&hv(c.prev,c,c.next)>=0)return!1;c=c.nextZ}for(;b&&b.z>=j;){if(b!==f.prev&&b!==f.next&&ht(d.x,d.y,e.x,e.y,a.x,a.y,b.x,b.y)&&hv(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;c&&c.z<=k;){if(c!==f.prev&&c!==f.next&&ht(d.x,d.y,e.x,e.y,a.x,a.y,c.x,c.y)&&hv(c.prev,c,c.next)>=0)return!1;c=c.nextZ}return!0}function hi(d,e,f){var a=d;do{var c=a.prev,b=a.next.next;!hw(c,b)&&hx(c,a,a.next,b)&&hB(c,b)&&hB(b,c)&&(e.push(c.i/f),e.push(a.i/f),e.push(b.i/f),hF(a),hF(a.next),a=d=b),a=a.next}while(a!==d)return he(a)}function hj(d,e,f,g,h,i){var a=d;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&hu(a,b)){var c=hD(a,b);a=he(a,a.next),c=he(c,c.next),hf(a,e,f,g,h,i),hf(c,e,f,g,h,i);return}b=b.next}a=a.next}while(a!==d)}function hk(h,e,b,f){var a,g,i,j,c,d=[];for(a=0,g=e.length;a<g;a++)i=e[a]*f,j=a<g-1?e[a+1]*f:h.length,c=hd(h,i,j,f,!1),c===c.next&&(c.steiner=!0),d.push(hs(c));for(d.sort(hl),a=0;a<d.length;a++)hm(d[a],b),b=he(b,b.next);return b}function hl(a,b){return a.x-b.x}function hm(b,a){if(a=hn(b,a)){var c=hD(a,b);he(a,a.next),he(c,c.next)}}function hn(h,k){var b,a=k,d=h.x,c=h.y,e=-1/0;do{if(c<=a.y&&c>=a.next.y&&a.next.y!==a.y){var f=a.x+(c-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(f<=d&&f>e){if(e=f,f===d){if(c===a.y)return a;if(c===a.next.y)return a.next}b=a.x<a.next.x?a:a.next}}a=a.next}while(a!==k)if(!b)return null;if(d===e)return b;var g,m=b,l=b.x,i=b.y,j=1/0;a=b;do d>=a.x&&a.x>=l&&d!==a.x&&ht(c<i?d:e,c,l,i,c<i?e:d,c,a.x,a.y)&&(g=Math.abs(c-a.y)/(d-a.x),hB(a,h)&&(g<j||g===j&&(a.x>b.x||a.x===b.x&&ho(b,a)))&&(b=a,j=g)),a=a.next;while(a!==m)return b}function ho(a,b){return 0>hv(a.prev,a,b.prev)&&0>hv(b.next,a,a.next)}function hp(b,c,d,e){var a=b;do null===a.z&&(a.z=hr(a.x,a.y,c,d,e)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==b)a.prevZ.nextZ=null,a.prevZ=null,hq(a)}function hq(f){var h,b,a,c,d,i,e,g,j=1;do{for(b=f,f=null,d=null,i=0;b;){for(i++,a=b,e=0,h=0;h<j&&(e++,a=a.nextZ);h++);for(g=j;e>0||g>0&&a;)0!==e&&(0===g||!a||b.z<=a.z)?(c=b,b=b.nextZ,e--):(c=a,a=a.nextZ,g--),d?d.nextZ=c:f=c,c.prevZ=d,d=c;b=a}d.nextZ=null,j*=2}while(i>1)return f}function hr(a,b,d,e,c){return a=32767*(a-d)*c,b=32767*(b-e)*c,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,b=(b|b<<8)&16711935,b=(b|b<<4)&252645135,b=(b|b<<2)&858993459,b=(b|b<<1)&1431655765,a|b<<1}function hs(c){var a=c,b=c;do(a.x<b.x||a.x===b.x&&a.y<b.y)&&(b=a),a=a.next;while(a!==c)return b}function ht(c,d,e,f,g,h,a,b){return(g-a)*(d-b)-(c-a)*(h-b)>=0&&(c-a)*(f-b)-(e-a)*(d-b)>=0&&(e-a)*(h-b)-(g-a)*(f-b)>=0}function hu(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!hA(a,b)&&(hB(a,b)&&hB(b,a)&&hC(a,b)&&(hv(a.prev,a,b.prev)||hv(a,b.prev,b))||hw(a,b)&&hv(a.prev,a,a.next)>0&&hv(b.prev,b,b.next)>0)}function hv(b,a,c){return(a.y-b.y)*(c.x-a.x)-(a.x-b.x)*(c.y-a.y)}function hw(a,b){return a.x===b.x&&a.y===b.y}function hx(a,b,c,d){var e=hz(hv(a,b,c)),f=hz(hv(a,b,d)),g=hz(hv(c,d,a)),h=hz(hv(c,d,b));return e!==f&&g!==h|| !!(0===e&&hy(a,c,b))|| !!(0===f&&hy(a,d,b))|| !!(0===g&&hy(c,a,d))||!!(0===h&&hy(c,b,d))}function hy(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function hz(a){return a>0?1:a<0?-1:0}function hA(b,c){var a=b;do{if(a.i!==b.i&&a.next.i!==b.i&&a.i!==c.i&&a.next.i!==c.i&&hx(a,a.next,b,c))return!0;a=a.next}while(a!==b)return!1}function hB(a,b){return 0>hv(a.prev,a,a.next)?hv(a,b,a.next)>=0&&hv(a,a.prev,b)>=0:0>hv(a,b,a.prev)||0>hv(a,a.next,b)}function hC(b,e){var a=b,c=!1,f=(b.x+e.x)/2,d=(b.y+e.y)/2;do a.y>d!=a.next.y>d&&a.next.y!==a.y&&f<(a.next.x-a.x)*(d-a.y)/(a.next.y-a.y)+a.x&&(c=!c),a=a.next;while(a!==b)return c}function hD(a,b){var d=new hG(a.i,a.x,a.y),c=new hG(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,d.next=e,e.prev=d,c.next=d,d.prev=c,f.next=c,c.prev=f,c}function hE(c,d,e,b){var a=new hG(c,d,e);return b?(a.next=b.next,a.prev=b,b.next.prev=a,b.next=a):(a.prev=a,a.next=a),a}function hF(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function hG(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hH(b,g,d,e){for(var f=0,a=g,c=d-e;a<d;a+=e)f+=(b[c]-b[a])*(b[a+1]+b[c+1]),c=a;return f}function hI(a,b,c,d,e){hJ(a,b,c||0,d||a.length-1,e||hL)}function hJ(b,e,c,d,g){for(;d>c;){if(d-c>600){var f=d-c+1,k=e-c+1,l=Math.log(f),i=.5*Math.exp(2*l/3),m=.5*Math.sqrt(l*i*(f-i)/f)*(k-f/2<0?-1:1),n=Math.max(c,Math.floor(e-k*i/f+m)),o=Math.min(d,Math.floor(e+(f-k)*i/f+m));hJ(b,e,n,o,g)}var j=b[e],h=c,a=d;for(hK(b,c,e),g(b[d],j)>0&&hK(b,c,d);h<a;){for(hK(b,h,a),h++,a--;0>g(b[h],j);)h++;for(;g(b[a],j)>0;)a--}0===g(b[c],j)?hK(b,c,a):(a++,hK(b,a,d)),a<=e&&(c=a+1),e<=a&&(d=a-1)}}function hK(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function hL(a,b){return a<b?-1:a>b?1:0}function hM(c,f){var d,h,i=c.length;if(i<=1)return[c];for(var a=[],e=0;e<i;e++){var g=ee(c[e]);0!==g&&(c[e].area=Math.abs(g),void 0===h&&(h=g<0),h===g<0?(d&&a.push(d),d=[c[e]]):d.push(c[e]))}if(d&&a.push(d),f>1)for(var b=0;b<a.length;b++)a[b].length<=f||(hI(a[b],f,1,a[b].length-1,hN),a[b]=a[b].slice(0,f));return a}function hN(a,b){return b.area-a.area}function hO(g,h,i){for(var d=i.patternDependencies,a=!1,b=0,e=h;b<e.length;b+=1){var f=e[b].paint.get(g+"-pattern");f.isConstant()||(a=!0);var c=f.constantOr(null);c&&(a=!0,d[c.to]=!0,d[c.from]=!0)}return a}function hP(l,m,d,g,e){for(var h=e.patternDependencies,i=0,j=m;i<j.length;i+=1){var k=j[i],f=k.paint.get(l+"-pattern").value;if("constant"!==f.kind){var a=f.evaluate({zoom:g-1},d,{},e.availableImages),b=f.evaluate({zoom:g},d,{},e.availableImages),c=f.evaluate({zoom:g+1},d,{},e.availableImages);a=a&&a.name?a.name:a,b=b&&b.name?b.name:b,c=c&&c.name?c.name:c,h[a]=!0,h[b]=!0,h[c]=!0,d.patterns[k.id]={min:a,mid:b,max:c}}}return d}bg.deviation=function(a,d,c,e){var i=d&&d.length,m=i?d[0]*c:a.length,f=Math.abs(hH(a,0,m,c));if(i)for(var b=0,j=d.length;b<j;b++){var n=d[b]*c,o=b<j-1?d[b+1]*c:a.length;f-=Math.abs(hH(a,n,o,c))}var h=0;for(b=0;b<e.length;b+=3){var g=e[b]*c,k=e[b+1]*c,l=e[b+2]*c;h+=Math.abs((a[g]-a[l])*(a[k+1]-a[g+1])-(a[g]-a[k])*(a[l+1]-a[g+1]))}return 0===f&&0===h?0:Math.abs((h-f)/f)},bg.flatten=function(b){for(var f=b[0][0].length,c={vertices:[],holes:[],dimensions:f},g=0,a=0;a<b.length;a++){for(var d=0;d<b[a].length;d++)for(var e=0;e<f;e++)c.vertices.push(b[a][d][e]);a>0&&(g+=b[a-1].length,c.holes.push(g))}return c},du.default=bg;var y=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new a4,this.indexArray=new a8,this.indexArray2=new bK,this.programConfigurations=new an(hc,a.layers,a.zoom),this.segments=new N,this.segments2=new N,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};y.prototype.populate=function(m,b,e){this.hasPattern=hO("fill",this.layers,b);for(var f=this.layers[0].layout.get("fill-sort-key"),g=[],h=0,n=m;h<n.length;h+=1){var c=n[h],a=c.feature,o=c.id,s=c.index,t=c.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,d={type:a.type,id:o,properties:a.properties,geometry:p?gN(a):[]};if(this.layers[0]._featureFilter.filter(new aP(this.zoom),d,e)){p||(d.geometry=gN(a));var u=f?f.evaluate(d,{},e,b.availableImages):void 0,v={id:o,properties:a.properties,type:a.type,sourceLayerIndex:t,index:s,geometry:d.geometry,patterns:{},sortKey:u};g.push(v)}}f&&g.sort(function(a,b){return a.sortKey-b.sortKey});for(var i=0,q=g;i<q.length;i+=1){var j=q[i],k=j,r=k.geometry,l=k.index,w=k.sourceLayerIndex;if(this.hasPattern){var x=hP("fill",this.layers,j,this.zoom,b);this.patternFeatures.push(x)}else this.addFeature(j,r,l,e,{});var y=m[l].feature;b.featureIndex.insert(y,r,l,w,this.index)}},y.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},y.prototype.addFeatures=function(f,d,e){for(var a=0,c=this.patternFeatures;a<c.length;a+=1){var b=c[a];this.addFeature(b,b.geometry,b.index,d,e)}},y.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},y.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},y.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,hc),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},y.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},y.prototype.addFeature=function(s,t,u,v,w){for(var g=0,o=hM(t,500);g<o.length;g+=1){for(var h=o[g],i=0,j=0,p=h;j<p.length;j+=1)i+=p[j].length;for(var k=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray),l=k.vertexLength,c=[],q=[],m=0,r=h;m<r.length;m+=1){var a=r[m];if(0!==a.length){a!==h[0]&&q.push(c.length/2);var n=this.segments2.prepareSegment(a.length,this.layoutVertexArray,this.indexArray2),f=n.vertexLength;this.layoutVertexArray.emplaceBack(a[0].x,a[0].y),this.indexArray2.emplaceBack(f+a.length-1,f),c.push(a[0].x),c.push(a[0].y);for(var b=1;b<a.length;b++)this.layoutVertexArray.emplaceBack(a[b].x,a[b].y),this.indexArray2.emplaceBack(f+b-1,f+b),c.push(a[b].x),c.push(a[b].y);n.vertexLength+=a.length,n.primitiveLength+=a.length}}for(var d=du(c,q),e=0;e<d.length;e+=3)this.indexArray.emplaceBack(l+d[e],l+d[e+1],l+d[e+2]);k.vertexLength+=i,k.primitiveLength+=d.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,u,w,v)},c("FillBucket",y,{omit:["layers","patternFeatures"]});var dv=new p({"fill-sort-key":new f(b.layout_fill["fill-sort-key"])}),dw=new p({"fill-antialias":new e(b.paint_fill["fill-antialias"]),"fill-opacity":new f(b.paint_fill["fill-opacity"]),"fill-color":new f(b.paint_fill["fill-color"]),"fill-outline-color":new f(b.paint_fill["fill-outline-color"]),"fill-translate":new e(b.paint_fill["fill-translate"]),"fill-translate-anchor":new e(b.paint_fill["fill-translate-anchor"]),"fill-pattern":new aR(b.paint_fill["fill-pattern"])}),hQ={paint:dw,layout:dv},dx=function(b){function a(a){b.call(this,a,hQ)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.recalculate=function(c,d){b.prototype.recalculate.call(this,c,d);var a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&& void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},a.prototype.createBucket=function(a){return new y(a)},a.prototype.queryRadius=function(){return g$(this.paint.get("fill-translate"))},a.prototype.queryIntersectsFeature=function(a,e,f,b,g,c,d){return gQ(g_(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),c.angle,d),b)},a.prototype.isTileClipped=function(){return!0},a}(x),dy=m([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),hR=dy.members,dz=aU;function aU(a,b,c,d,e){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=e,a.readFields(hS,this,b)}function hS(a,b,c){1==a?b.id=c.readVarint():2==a?hT(c,b):3==a?b.type=c.readVarint():4==a&&(b._geometry=c.pos)}function hT(a,b){for(var c=a.readVarint()+a.pos;a.pos<c;){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}}function hU(a){for(var b,c,e=0,d=0,f=a.length,g=f-1;d<f;g=d++)b=a[d],c=a[g],e+=(c.x-b.x)*(b.y+c.y);return e}aU.types=["Unknown","Point","LineString","Polygon"],aU.prototype.loadGeometry=function(){var b=this._pbf;b.pos=this._geometry;for(var a,i=b.readVarint()+b.pos,c=1,d=0,f=0,g=0,e=[];b.pos<i;){if(d<=0){var h=b.readVarint();c=7&h,d=h>>3}if(d--,1===c||2===c)f+=b.readSVarint(),g+=b.readSVarint(),1===c&&(a&&e.push(a),a=[]),a.push(new aY(f,g));else if(7===c)a&&a.push(a[0].clone());else throw new Error("unknown command "+c)}return a&&e.push(a),e},aU.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var k=a.readVarint()+a.pos,b=1,e=0,c=0,d=0,f=1/0,g=-1/0,h=1/0,i=-1/0;a.pos<k;){if(e<=0){var j=a.readVarint();b=7&j,e=j>>3}if(e--,1===b||2===b)c+=a.readSVarint(),d+=a.readSVarint(),c<f&&(f=c),c>g&&(g=c),d<h&&(h=d),d>i&&(i=d);else if(7!==b)throw new Error("unknown command "+b)}return[f,h,g,i]},aU.prototype.toGeoJSON=function(h,i,j){var a,c,k=this.extent*Math.pow(2,j),l=this.extent*h,m=this.extent*i,b=this.loadGeometry(),d=aU.types[this.type];function e(b){for(var a=0;a<b.length;a++){var c=b[a],d=180-(c.y+m)*360/k;b[a]=[(c.x+l)*360/k-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(a=0;a<b.length;a++)f[a]=b[a][0];e(b=f);break;case 2:for(a=0;a<b.length;a++)e(b[a]);break;case 3:for(a=0,b=function(b){var g=b.length;if(g<=1)return[b];for(var a,d,e=[],c=0;c<g;c++){var f=hU(b[c]);0!==f&&(void 0===d&&(d=f<0),d===f<0?(a&&e.push(a),a=[b[c]]):a.push(b[c]))}return a&&e.push(a),e}(b);a<b.length;a++)for(c=0;c<b[a].length;c++)e(b[a][c]);break}1===b.length?b=b[0]:d="Multi"+d;var g={type:"Feature",geometry:{type:d,coordinates:b},properties:this.properties};return"id"in this&&(g.id=this.id),g};var dA=dB;function dB(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(hV,this,b),this.length=this._features.length}function hV(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():5===a?b.extent=c.readVarint():2===a?b._features.push(c.pos):3===a?b._keys.push(c.readString()):4===a&&b._values.push(hW(c))}function hW(a){for(var c=null,d=a.readVarint()+a.pos;a.pos<d;){var b=a.readVarint()>>3;c=1===b?a.readString():2===b?a.readFloat():3===b?a.readDouble():4===b?a.readVarint64():5===b?a.readVarint():6===b?a.readSVarint():7===b?a.readBoolean():null}return c}function hX(c,d,a){if(3===c){var b=new dA(a,a.readVarint()+a.pos);b.length&&(d[b.name]=b)}}dB.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var b=this._pbf.readVarint()+this._pbf.pos;return new dz(this._pbf,b,this.extent,this._keys,this._values)};var aC={VectorTile:function(a,b){this.layers=a.readFields(hX,{},b)},VectorTileFeature:dz,VectorTileLayer:dA},hY=aC.VectorTileFeature.types;function hZ(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,2*Math.floor(8192*d)+g,16384*e,16384*f,Math.round(h))}var z=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new bC,this.indexArray=new a8,this.programConfigurations=new an(hR,a.layers,a.zoom),this.segments=new N,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function h$(a,b){return a.x===b.x&&(a.x<0||a.x>8192)||a.y===b.y&&(a.y<0||a.y>8192)}function h_(a){return a.every(function(a){return a.x<0})||a.every(function(a){return a.x>8192})||a.every(function(a){return a.y<0})||a.every(function(a){return a.y>8192})}z.prototype.populate=function(m,d,g){this.features=[],this.hasPattern=hO("fill-extrusion",this.layers,d);for(var e=0,h=m;e<h.length;e+=1){var c=h[e],a=c.feature,i=c.id,f=c.index,j=c.sourceLayerIndex,k=this.layers[0]._featureFilter.needGeometry,l={type:a.type,id:i,properties:a.properties,geometry:k?gN(a):[]};if(this.layers[0]._featureFilter.filter(new aP(this.zoom),l,g)){var b={id:i,sourceLayerIndex:j,index:f,geometry:k?l.geometry:gN(a),properties:a.properties,type:a.type,patterns:{}};void 0!==a.id&&(b.id=a.id),this.hasPattern?this.features.push(hP("fill-extrusion",this.layers,b,this.zoom,d)):this.addFeature(b,b.geometry,f,g,{}),d.featureIndex.insert(a,b.geometry,f,j,this.index,!0)}}},z.prototype.addFeatures=function(g,d,e){for(var a=0,c=this.features;a<c.length;a+=1){var b=c[a],f=b.geometry;this.addFeature(b,f,b.index,d,e)}},z.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},z.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},z.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},z.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,hR),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},z.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},z.prototype.addFeature=function(v,C,D,E,F){for(var p=0,w=hM(C,500);p<w.length;p+=1){for(var k=w[p],l=0,q=0,x=k;q<x.length;q+=1)l+=x[q].length;for(var a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),r=0,y=k;r<y.length;r+=1){var g=y[r];if(0!==g.length&&!h_(g))for(var c=0,h=0;h<g.length;h++){var d=g[h];if(h>=1){var e=g[h-1];if(!h$(d,e)){a.vertexLength+4>N.MAX_VERTEX_ARRAY_LENGTH&&(a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var b=d.sub(e)._perp()._unit(),z=e.dist(d);c+z>32768&&(c=0),hZ(this.layoutVertexArray,d.x,d.y,b.x,b.y,0,0,c),hZ(this.layoutVertexArray,d.x,d.y,b.x,b.y,0,1,c),c+=z,hZ(this.layoutVertexArray,e.x,e.y,b.x,b.y,0,0,c),hZ(this.layoutVertexArray,e.x,e.y,b.x,b.y,0,1,c);var f=a.vertexLength;this.indexArray.emplaceBack(f,f+2,f+1),this.indexArray.emplaceBack(f+1,f+2,f+3),a.vertexLength+=4,a.primitiveLength+=2}}}}if(a.vertexLength+l>N.MAX_VERTEX_ARRAY_LENGTH&&(a=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),"Polygon"===hY[v.type]){for(var m=[],A=[],s=a.vertexLength,t=0,B=k;t<B.length;t+=1){var n=B[t];if(0!==n.length){n!==k[0]&&A.push(m.length/2);for(var u=0;u<n.length;u++){var o=n[u];hZ(this.layoutVertexArray,o.x,o.y,0,0,1,1,0),m.push(o.x),m.push(o.y)}}}for(var i=du(m,A),j=0;j<i.length;j+=3)this.indexArray.emplaceBack(s+i[j],s+i[j+2],s+i[j+1]);a.primitiveLength+=i.length/3,a.vertexLength+=l}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,v,D,F,E)},c("FillExtrusionBucket",z,{omit:["layers","features"]});var h0={paint:new p({"fill-extrusion-opacity":new e(b["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new f(b["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new e(b["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new e(b["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new aR(b["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new f(b["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new f(b["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new e(b["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},dC=function(b){function a(a){b.call(this,a,h0)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.createBucket=function(a){return new z(a)},a.prototype.queryRadius=function(){return g$(this.paint.get("fill-extrusion-translate"))},a.prototype.is3D=function(){return!0},a.prototype.queryIntersectsFeature=function(f,a,b,g,o,c,h,d){var i=g_(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),c.angle,h),j=this.paint.get("fill-extrusion-height").evaluate(a,b),k=this.paint.get("fill-extrusion-base").evaluate(a,b),l=h5(i,d,c,0),e=h4(g,k,j,d),m=e[0],n=e[1];return h3(m,n,l)},a}(x);function h1(a,b){return a.x*b.x+a.y*b.y}function h2(j,a){if(1===j.length){for(var b,c=0,d=a[c++];!b||d.equals(b);)if(!(b=a[c++]))return 1/0;for(;c<a.length;c++){var k=a[c],v=j[0],e=b.sub(d),f=k.sub(d),l=v.sub(d),m=h1(e,e),g=h1(e,f),n=h1(f,f),o=h1(l,e),p=h1(l,f),q=m*n-g*g,r=(n*o-g*p)/q,s=(m*p-g*o)/q,w=1-r-s,t=d.z*w+b.z*r+k.z*s;if(isFinite(t))return t}return 1/0}for(var h=1/0,i=0,u=a;i<u.length;i+=1)h=Math.min(h,u[i].z);return h}function h3(j,c,d){var b=1/0;gQ(d,c)&&(b=h2(d,c[0]));for(var e=0;e<c.length;e++)for(var f=c[e],g=j[e],a=0;a<f.length-1;a++){var h=f[a],k=f[a+1],l=g[a],m=g[a+1],i=[h,k,m,l,h];dk(d,i)&&(b=Math.min(b,h2(d,i)))}return b!==1/0&&b}function h4(w,b,c,a){for(var j=[],k=[],x=a[8]*b,y=a[9]*b,z=a[10]*b,A=a[11]*b,B=a[8]*c,C=a[9]*c,D=a[10]*c,E=a[11]*c,f=0,l=w;f<l.length;f+=1){for(var F=l[f],m=[],n=[],g=0,o=F;g<o.length;g+=1){var p=o[g],d=p.x,e=p.y,q=a[0]*d+a[4]*e+a[12],r=a[1]*d+a[5]*e+a[13],s=a[2]*d+a[6]*e+a[14],t=a[3]*d+a[7]*e+a[15],G=q+x,H=r+y,I=s+z,h=t+A,J=q+B,K=r+C,L=s+D,i=t+E,u=new aY(G/h,H/h);u.z=I/h,m.push(u);var v=new aY(J/i,K/i);v.z=L/i,n.push(v)}j.push(m),k.push(n)}return[j,k]}function h5(f,g,i,h){for(var c=[],b=0,d=f;b<d.length;b+=1){var e=d[b],a=[e.x,e.y,h,1];dp(a,a,g),c.push(new aY(a[0]/a[3],a[1]/a[3]))}return c}var h6=m([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,h7=aC.VectorTileFeature.types,h8=Math.cos(37.5*(Math.PI/180)),o=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bD,this.indexArray=new a8,this.programConfigurations=new an(h6,a.layers,a.zoom),this.segments=new N,this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};o.prototype.populate=function(m,d,e){this.hasPattern=hO("line",this.layers,d);for(var f=this.layers[0].layout.get("line-sort-key"),g=[],h=0,n=m;h<n.length;h+=1){var b=n[h],a=b.feature,o=b.id,s=b.index,t=b.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,c={type:a.type,id:o,properties:a.properties,geometry:p?gN(a):[]};if(this.layers[0]._featureFilter.filter(new aP(this.zoom),c,e)){p||(c.geometry=gN(a));var u=f?f.evaluate(c,{},e):void 0,v={id:o,properties:a.properties,type:a.type,sourceLayerIndex:t,index:s,geometry:c.geometry,patterns:{},sortKey:u};g.push(v)}}f&&g.sort(function(a,b){return a.sortKey-b.sortKey});for(var i=0,q=g;i<q.length;i+=1){var j=q[i],k=j,r=k.geometry,l=k.index,w=k.sourceLayerIndex;if(this.hasPattern){var x=hP("line",this.layers,j,this.zoom,d);this.patternFeatures.push(x)}else this.addFeature(j,r,l,e,{});var y=m[l].feature;d.featureIndex.insert(y,r,l,w,this.index)}},o.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},o.prototype.addFeatures=function(f,d,e){for(var a=0,c=this.patternFeatures;a<c.length;a+=1){var b=c[a];this.addFeature(b,b.geometry,b.index,d,e)}},o.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},o.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},o.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,h6),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},o.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},o.prototype.addFeature=function(b,e,f,g,h){for(var a=this.layers[0].layout,i=a.get("line-join").evaluate(b,{}),j=a.get("line-cap"),k=a.get("line-miter-limit"),l=a.get("line-round-limit"),c=0,d=e;c<d.length;c+=1){var m=d[c];this.addLine(m,b,i,j,k,l)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,f,h,g)},o.prototype.addLine=function(e,n,A,L,v,M){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+n.properties.mapbox_clip_start,this.clipEnd=+n.properties.mapbox_clip_end;for(var a,r=0;r<e.length-1;r++)this.totalDistance+=e[r].dist(e[r+1]);this.updateScaledDistance()}for(var s="Polygon"===h7[n.type],i=e.length;i>=2&&e[i-1].equals(e[i-2]);)i--;for(var l=0;l<i-1&&e[l].equals(e[l+1]);)l++;if(!(i<(s?3:2))){"bevel"===A&&(v=1.05);var t=this.overscaling<=16?122880/(512*this.overscaling):0,f=this.segments.prepareSegment(10*i,this.layoutVertexArray,this.indexArray),h=void 0,j=void 0,c=void 0,b=void 0;this.e1=this.e2=-1,s&&(a=e[i-2],b=e[l].sub(a)._unit()._perp());for(var m=l;m<i;m++)if(!((j=m===i-1?s?e[l+1]:void 0:e[m+1])&&e[m].equals(j))){b&&(c=b),a&&(h=a),a=e[m],b=j?j.sub(a)._unit()._perp():c;var g=(c=c||b).add(b);(0!==g.x||0!==g.y)&&g._unit();var p=c.x*b.x+c.y*b.y,u=g.x*b.x+g.y*b.y,k=0!==u?1/u:1/0,N=2*Math.sqrt(2-2*u),B=u<h8&&h&&j,q=c.x*b.y-c.y*b.x>0;if(B&&m>l){var C=a.dist(h);if(C>2*t){var w=a.sub(a.sub(h)._mult(t/C)._round());this.updateDistance(h,w),this.addCurrentVertex(w,c,0,0,f),h=w}}var D=h&&j,d=D?A:s?"butt":L;if(D&&"round"===d&&(k<M?d="miter":k<=2&&(d="fakeround")),"miter"===d&&k>v&&(d="bevel"),"bevel"===d&&(k>2&&(d="flipbevel"),k<v&&(d="miter")),h&&this.updateDistance(h,a),"miter"===d)g._mult(k),this.addCurrentVertex(a,g,0,0,f);else if("flipbevel"===d){if(k>100)g=b.mult(-1);else{var O=k*c.add(b).mag()/c.sub(b).mag();g._perp()._mult(O*(q?-1:1))}this.addCurrentVertex(a,g,0,0,f),this.addCurrentVertex(a,g.mult(-1),0,0,f)}else if("bevel"===d||"fakeround"===d){var E=-Math.sqrt(k*k-1),F=q?E:0,G=q?0:E;if(h&&this.addCurrentVertex(a,c,F,G,f),"fakeround"===d)for(var H=Math.round(180*N/Math.PI/20),x=1;x<H;x++){var o=x/H;if(.5!==o){var y=o-.5,P=1.0904+p*(-3.2452+p*(3.55645-1.43519*p)),Q=.848013+p*(-1.06021+.215638*p);o+=o*y*(o-1)*(P*y*y+Q)}var I=b.sub(c)._mult(o)._add(c)._unit()._mult(q?-1:1);this.addHalfVertex(a,I.x,I.y,!1,q,0,f)}j&&this.addCurrentVertex(a,b,-F,-G,f)}else if("butt"===d)this.addCurrentVertex(a,g,0,0,f);else if("square"===d){var J=h?1:-1;this.addCurrentVertex(a,g,J,J,f)}else"round"===d&&(h&&(this.addCurrentVertex(a,c,0,0,f),this.addCurrentVertex(a,c,1,1,f,!0)),j&&(this.addCurrentVertex(a,b,-1,-1,f,!0),this.addCurrentVertex(a,b,0,0,f)));if(B&&m<i-1){var K=a.dist(j);if(K>2*t){var z=a.add(j.sub(a)._mult(t/K)._round());this.updateDistance(a,z),this.addCurrentVertex(z,b,0,0,f),a=z}}}}},o.prototype.addCurrentVertex=function(e,a,c,d,f,b){void 0===b&&(b=!1);var g=a.x+a.y*c,h=a.y-a.x*c,i=-a.x+a.y*d,j=-a.y-a.x*d;this.addHalfVertex(e,g,h,b,!1,c,f),this.addHalfVertex(e,i,j,b,!0,-d,f),this.distance>16384&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,a,c,d,f,b))},o.prototype.addHalfVertex=function(b,g,h,i,c,d,e){var j=b.x,k=b.y,f=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((j<<1)+(i?1:0),(k<<1)+(c?1:0),Math.round(63*g)+128,Math.round(63*h)+128,(0===d?0:d<0?-1:1)+1|(63&f)<<2,f>>6);var a=e.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,a),e.primitiveLength++),c?this.e2=a:this.e1=a},o.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*32767:this.distance},o.prototype.updateDistance=function(a,b){this.distance+=a.dist(b),this.updateScaledDistance()},c("LineBucket",o,{omit:["layers","patternFeatures"]});var dD=new p({"line-cap":new e(b.layout_line["line-cap"]),"line-join":new f(b.layout_line["line-join"]),"line-miter-limit":new e(b.layout_line["line-miter-limit"]),"line-round-limit":new e(b.layout_line["line-round-limit"]),"line-sort-key":new f(b.layout_line["line-sort-key"])}),dE=new p({"line-opacity":new f(b.paint_line["line-opacity"]),"line-color":new f(b.paint_line["line-color"]),"line-translate":new e(b.paint_line["line-translate"]),"line-translate-anchor":new e(b.paint_line["line-translate-anchor"]),"line-width":new f(b.paint_line["line-width"]),"line-gap-width":new f(b.paint_line["line-gap-width"]),"line-offset":new f(b.paint_line["line-offset"]),"line-blur":new f(b.paint_line["line-blur"]),"line-dasharray":new ak(b.paint_line["line-dasharray"]),"line-pattern":new aR(b.paint_line["line-pattern"]),"line-gradient":new az(b.paint_line["line-gradient"])}),dF={paint:dE,layout:dD},dG=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.possiblyEvaluate=function(c,a){return a=new aP(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),b.prototype.possiblyEvaluate.call(this,c,a)},a.prototype.evaluate=function(c,a,d,e){return a=b5({},a,{zoom:Math.floor(a.zoom)}),b.prototype.evaluate.call(this,c,a,d,e)},a}(f),dH=new dG(dF.paint.properties["line-width"].specification);dH.useIntegerZoom=!0;var dI=function(b){function a(a){b.call(this,a,dF)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._handleSpecialPaintPropertyUpdate=function(a){"line-gradient"===a&&this._updateGradient()},a.prototype._updateGradient=function(){var a=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=ha(a,"lineProgress"),this.gradientTexture=null},a.prototype.recalculate=function(a,c){b.prototype.recalculate.call(this,a,c),this.paint._values["line-floorwidth"]=dH.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)},a.prototype.createBucket=function(a){return new o(a)},a.prototype.queryRadius=function(b){var a=b,c=h9(gZ("line-width",this,a),gZ("line-gap-width",this,a)),d=gZ("line-offset",this,a);return c/2+Math.abs(d)+g$(this.paint.get("line-translate"))},a.prototype.queryIntersectsFeature=function(f,a,b,c,j,g,d){var h=g_(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,d),i=d/2*h9(this.paint.get("line-width").evaluate(a,b),this.paint.get("line-gap-width").evaluate(a,b)),e=this.paint.get("line-offset").evaluate(a,b);return e&&(c=ia(c,e*d)),function(a,e,f){for(var b=0;b<e.length;b++){var c=e[b];if(a.length>=3){for(var d=0;d<c.length;d++)if(gX(a,c[d]))return!0}if(gR(a,c,f))return!0}return!1}(h,c,i)},a.prototype.isTileClipped=function(){return!0},a}(x);function h9(a,b){return b>0?b+2*a:a}function ia(g,k){for(var h=[],i=new aY(0,0),d=0;d<g.length;d++){for(var b=g[d],j=[],a=0;a<b.length;a++){var l=b[a-1],e=b[a],m=b[a+1],n=0===a?i:e.sub(l)._unit()._perp(),f=a===b.length-1?i:m.sub(e)._unit()._perp(),c=n._add(f)._unit(),o=c.x*f.x+c.y*f.y;c._mult(1/o),j.push(c._mult(k)._add(e))}h.push(j)}return h}var ib=m([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ic=m([{name:"a_projected_pos",components:3,type:"Float32"}],4);m([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var id=m([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);m([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var ie=m([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),dJ=m([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ig(a,b,c){return a.sections.forEach(function(d){var a,e,f,g;d.text=(a=d.text,e=b,f=c,"uppercase"===(g=e.layout.get("text-transform").evaluate(f,{}))?a=a.toLocaleUpperCase():"lowercase"===g&&(a=a.toLocaleLowerCase()),c0.applyArabicShaping&&(a=c0.applyArabicShaping(a)),a)}),a}m([{name:"triangle",components:3,type:"Uint16"}]),m([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),m([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),m([{type:"Float32",name:"offsetX"}]),m([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var ih={"!":"\uFE15","#":"\uFF03","$":"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E","_":"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xa2":"\uFFE0","\xa3":"\uFFE1","\xa5":"\uFFE5","\xa6":"\uFFE4","\xac":"\uFFE2","\xaf":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},dK=24,ii={read:function(g,h,j,e,k){var a,c,l=8*k-e-1,m=(1<<l)-1,n=m>>1,b=-7,d=j?k-1:0,i=j?-1:1,f=g[h+d];for(d+=i,a=f&(1<< -b)-1,f>>=-b,b+=l;b>0;a=256*a+g[h+d],d+=i,b-=8);for(c=a&(1<< -b)-1,a>>=-b,b+=e;b>0;c=256*c+g[h+d],d+=i,b-=8);if(0===a)a=1-n;else{if(a===m)return c?NaN:(f?-1:1)*(1/0);c+=Math.pow(2,e),a-=n}return(f?-1:1)*c*Math.pow(2,a-e)},write:function(j,b,k,m,c,n){var a,d,e,h=8*n-c-1,i=(1<<h)-1,f=i>>1,o=23===c?5960464477539062e-23:0,g=m?0:n-1,l=m?1:-1,p=b<0||0===b&&1/b<0?1:0;for(isNaN(b=Math.abs(b))||b===1/0?(d=isNaN(b)?1:0,a=i):(a=Math.floor(Math.log(b)/Math.LN2),b*(e=Math.pow(2,-a))<1&&(a--,e*=2),a+f>=1?b+=o/e:b+=o*Math.pow(2,1-f),b*e>=2&&(a++,e/=2),a+f>=i?(d=0,a=i):a+f>=1?(d=(b*e-1)*Math.pow(2,c),a+=f):(d=b*Math.pow(2,f-1)*Math.pow(2,c),a=0));c>=8;j[k+g]=255&d,g+=l,d/=256,c-=8);for(a=a<<c|d,h+=c;h>0;j[k+g]=255&a,g+=l,a/=256,h-=8);j[k+g-l]|=128*p}},bS=aD;function aD(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}aD.Varint=0,aD.Fixed64=1,aD.Bytes=2,aD.Fixed32=5;var ij="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function ik(a){return a.type===aD.Bytes?a.readVarint()+a.pos:a.pos+1}function il(a,b,c){return c?4294967296*b+(a>>>0):(b>>>0)*4294967296+(a>>>0)}function im(e,a,b){var d=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));b.realloc(d);for(var c=b.pos-1;c>=e;c--)b.buf[c+d]=b.buf[c]}function io(b,c){for(var a=0;a<b.length;a++)c.writeVarint(b[a])}function ip(b,c){for(var a=0;a<b.length;a++)c.writeSVarint(b[a])}function iq(b,c){for(var a=0;a<b.length;a++)c.writeFloat(b[a])}function ir(b,c){for(var a=0;a<b.length;a++)c.writeDouble(b[a])}function is(b,c){for(var a=0;a<b.length;a++)c.writeBoolean(b[a])}function it(b,c){for(var a=0;a<b.length;a++)c.writeFixed32(b[a])}function iu(b,c){for(var a=0;a<b.length;a++)c.writeSFixed32(b[a])}function iv(b,c){for(var a=0;a<b.length;a++)c.writeFixed64(b[a])}function iw(b,c){for(var a=0;a<b.length;a++)c.writeSFixed64(b[a])}function ix(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+16777216*a[b+3]}function iy(a,b,c){a[c]=b,a[c+1]=b>>>8,a[c+2]=b>>>16,a[c+3]=b>>>24}function iz(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+(a[b+3]<<24)}function iA(a,b,c){1===a&&c.readMessage(iB,b)}function iB(d,e,f){if(3===d){var a=f.readMessage(iC,{}),g=a.id,h=a.bitmap,b=a.width,c=a.height,i=a.left,j=a.top,k=a.advance;e.push({id:g,bitmap:new aB({width:b+6,height:c+6},h),metrics:{width:b,height:c,left:i,top:j,advance:k}})}}function iC(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}function dL(g){for(var h=0,i=0,j=0,m=g;j<m.length;j+=1){var k=m[j];h+=k.w*k.h,i=Math.max(i,k.w)}g.sort(function(a,b){return b.h-a.h});for(var c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(h/.95)),i),h:1/0}],e=0,f=0,l=0,n=g;l<n.length;l+=1)for(var a=n[l],d=c.length-1;d>=0;d--){var b=c[d];if(!(a.w>b.w)&&!(a.h>b.h)){if(a.x=b.x,a.y=b.y,f=Math.max(f,a.y+a.h),e=Math.max(e,a.x+a.w),a.w===b.w&&a.h===b.h){var o=c.pop();d<c.length&&(c[d]=o)}else a.h===b.h?(b.x+=a.w,b.w-=a.w):a.w===b.w?(b.y+=a.h,b.h-=a.h):(c.push({x:b.x+a.w,y:b.y,w:b.w-a.w,h:a.h}),b.y+=a.h,b.h-=a.h);break}}return{w:e,h:f,fill:h/(e*f)||0}}aD.prototype={destroy:function(){this.buf=null},readFields:function(d,c,a){for(a=a||this.length;this.pos<a;){var b=this.readVarint(),e=b>>3,f=this.pos;this.type=7&b,d(e,c,this),this.pos===f&&this.skip(b)}return c},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=ix(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=iz(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=ix(this.buf,this.pos)+4294967296*ix(this.buf,this.pos+4);return this.pos+=8,a},readSFixed64:function(){var a=ix(this.buf,this.pos)+4294967296*iz(this.buf,this.pos+4);return this.pos+=8,a},readFloat:function(){var a=ii.read(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=ii.read(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(d){var a,b,c=this.buf;return(a=127&(b=c[this.pos++]),b<128)?a:(a|=(127&(b=c[this.pos++]))<<7,b<128)?a:(a|=(127&(b=c[this.pos++]))<<14,b<128)?a:(a|=(127&(b=c[this.pos++]))<<21,b<128)?a:function(d,e,c){var a,b,f=c.buf;if(a=(112&(b=f[c.pos++]))>>4,b<128)return il(d,a,e);if(a|=(127&(b=f[c.pos++]))<<3,b<128)return il(d,a,e);if(a|=(127&(b=f[c.pos++]))<<10,b<128)return il(d,a,e);if(a|=(127&(b=f[c.pos++]))<<17,b<128)return il(d,a,e);if(a|=(127&(b=f[c.pos++]))<<24,b<128)return il(d,a,e);if(a|=(1&(b=f[c.pos++]))<<31,b<128)return il(d,a,e);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(b=c[this.pos]))<<28,d,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?-((a+1)/2):a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c,d,e,a=this.readVarint()+this.pos,b=this.pos;return(this.pos=a,a-b>=12&&ij)?(c=this.buf,d=b,e=a,ij.decode(c.subarray(d,e))):function(e,k,j){for(var h="",b=k;b<j;){var c,g,i,d=e[b],a=null,f=d>239?4:d>223?3:d>191?2:1;if(b+f>j)break;1===f?d<128&&(a=d):2===f?(192&(c=e[b+1]))==128&&(a=(31&d)<<6|63&c)<=127&&(a=null):3===f?(c=e[b+1],g=e[b+2],(192&c)==128&&(192&g)==128&&((a=(15&d)<<12|(63&c)<<6|63&g)<=2047||a>=55296&&a<=57343)&&(a=null)):4===f&&(c=e[b+1],g=e[b+2],i=e[b+3],(192&c)==128&&(192&g)==128&&(192&i)==128&&((a=(15&d)<<18|(63&c)<<12|(63&g)<<6|63&i)<=65535||a>=1114112)&&(a=null)),null===a?(a=65533,f=1):a>65535&&(a-=65536,h+=String.fromCharCode(a>>>10&1023|55296),a=56320|1023&a),h+=String.fromCharCode(a),b+=f}return h}(this.buf,b,a)},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.subarray(this.pos,a);return this.pos=a,b},readPackedVarint:function(a,b){if(this.type!==aD.Bytes)return a.push(this.readVarint(b));var c=ik(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(b));return a},readPackedSVarint:function(a){if(this.type!==aD.Bytes)return a.push(this.readSVarint());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==aD.Bytes)return a.push(this.readBoolean());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==aD.Bytes)return a.push(this.readFloat());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==aD.Bytes)return a.push(this.readDouble());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==aD.Bytes)return a.push(this.readFixed32());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==aD.Bytes)return a.push(this.readSFixed32());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==aD.Bytes)return a.push(this.readFixed64());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==aD.Bytes)return a.push(this.readSFixed64());var b=ik(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed64());return a},skip:function(b){var a=7&b;if(a===aD.Varint)for(;this.buf[this.pos++]>127;);else if(a===aD.Bytes)this.pos=this.readVarint()+this.pos;else if(a===aD.Fixed32)this.pos+=4;else if(a===aD.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+a)},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var b=new Uint8Array(a);b.set(this.buf),this.buf=b,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),iy(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),iy(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),iy(this.buf,-1&a,this.pos),iy(this.buf,Math.floor(23283064365386963e-26*a),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),iy(this.buf,-1&a,this.pos),iy(this.buf,Math.floor(23283064365386963e-26*a),this.pos+4),this.pos+=8},writeVarint:function(a){if((a=+a||0)>268435455||a<0){(function(e,h){var f,g,c,d,a,b,i;if(e>=0?(f=e%4294967296|0,g=e/4294967296|0):(f=~(-e%4294967296),g=~(-e/4294967296),4294967295^f?f=f+1|0:(f=0,g=g+1|0)),e>=0x7fffffffffffffff||e< 0x8000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),c=f,(d=h).buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos++]=127&c|128,c>>>=7,d.buf[d.pos]=127&c,a=g,b=h,i=(7&a)<<4,b.buf[b.pos++]|=i|((a>>>=3)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),a&&(b.buf[b.pos++]=127&a)))))})(a,this);return}this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127)))},writeSVarint:function(a){this.writeVarint(a<0?-(2*a)-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var c=this.pos;this.pos=function(c,f,b){for(var a,d,e=0;e<f.length;e++){if((a=f.charCodeAt(e))>55295&&a<57344)if(d){if(a<56320){c[b++]=239,c[b++]=191,c[b++]=189,d=a;continue}a=d-55296<<10|a-56320|65536,d=null}else{a>56319||e+1===f.length?(c[b++]=239,c[b++]=191,c[b++]=189):d=a;continue}else d&&(c[b++]=239,c[b++]=191,c[b++]=189,d=null);a<128?c[b++]=a:(a<2048?c[b++]=a>>6|192:(a<65536?c[b++]=a>>12|224:(c[b++]=a>>18|240,c[b++]=a>>12&63|128),c[b++]=a>>6&63|128),c[b++]=63&a|128)}return b}(this.buf,a,this.pos);var b=this.pos-c;b>=128&&im(c,b,this),this.pos=c-1,this.writeVarint(b),this.pos+=b},writeFloat:function(a){this.realloc(4),ii.write(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),ii.write(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var b=0;b<a;b++)this.buf[this.pos++]=c[b]},writeRawMessage:function(c,d){this.pos++;var b=this.pos;c(d,this);var a=this.pos-b;a>=128&&im(b,a,this),this.pos=b-1,this.writeVarint(a),this.pos+=a},writeMessage:function(a,b,c){this.writeTag(a,aD.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(b,a){a.length&&this.writeMessage(b,io,a)},writePackedSVarint:function(b,a){a.length&&this.writeMessage(b,ip,a)},writePackedBoolean:function(b,a){a.length&&this.writeMessage(b,is,a)},writePackedFloat:function(b,a){a.length&&this.writeMessage(b,iq,a)},writePackedDouble:function(b,a){a.length&&this.writeMessage(b,ir,a)},writePackedFixed32:function(b,a){a.length&&this.writeMessage(b,it,a)},writePackedSFixed32:function(b,a){a.length&&this.writeMessage(b,iu,a)},writePackedFixed64:function(b,a){a.length&&this.writeMessage(b,iv,a)},writePackedSFixed64:function(b,a){a.length&&this.writeMessage(b,iw,a)},writeBytesField:function(a,b){this.writeTag(a,aD.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,aD.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,aD.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,aD.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,aD.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,aD.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,aD.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,aD.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,aD.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,aD.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}};var bh=function(b,a){var c=a.pixelRatio,d=a.version,e=a.stretchX,f=a.stretchY,g=a.content;this.paddedRect=b,this.pixelRatio=c,this.stretchX=e,this.stretchY=f,this.content=g,this.version=d},aE={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};aE.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},aE.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},aE.tlbr.get=function(){return this.tl.concat(this.br)},aE.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(bh.prototype,aE);var aF=function(g,h){var i={},j={};this.haveRenderCallbacks=[];var k=[];this.addImages(g,i,k),this.addImages(h,j,k);var l=dL(k),r=l.w,s=l.h,b=new ap({width:r||1,height:s||1});for(var m in g){var n=g[m],o=i[m].paddedRect;ap.copy(n.data,b,{x:0,y:0},{x:o.x+1,y:o.y+1},n.data)}for(var p in h){var a=h[p],q=j[p].paddedRect,c=q.x+1,d=q.y+1,e=a.data.width,f=a.data.height;ap.copy(a.data,b,{x:0,y:0},{x:c,y:d},a.data),ap.copy(a.data,b,{x:0,y:f-1},{x:c,y:d-1},{width:e,height:1}),ap.copy(a.data,b,{x:0,y:0},{x:c,y:d+f},{width:e,height:1}),ap.copy(a.data,b,{x:e-1,y:0},{x:c-1,y:d},{width:1,height:f}),ap.copy(a.data,b,{x:0,y:0},{x:c+e,y:d},{width:1,height:f})}this.image=b,this.iconPositions=i,this.patternPositions=j};aF.prototype.addImages=function(c,e,f){for(var b in c){var a=c[b],d={x:0,y:0,w:a.data.width+2,h:a.data.height+2};f.push(d),e[b]=new bh(d,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(b)}},aF.prototype.patchUpdatedImages=function(a,c){for(var b in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[b],a.getImage(b),c),this.patchUpdatedImage(this.patternPositions[b],a.getImage(b),c)},aF.prototype.patchUpdatedImage=function(a,b,d){if(a&&b&&a.version!==b.version){a.version=b.version;var c=a.tl,e=c[0],f=c[1];d.update(b.data,void 0,{x:e,y:f})}},c("ImagePosition",bh),c("ImageAtlas",aF);var dM={horizontal:1,vertical:2,horizontalOnly:3},bT=function(){this.scale=1,this.fontStack="",this.imageName=null};bT.forText=function(b,c){var a=new bT;return a.scale=b||1,a.fontStack=c,a},bT.forImage=function(b){var a=new bT;return a.imageName=b,a};var t=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function iD(y,c,z,d,A,i,B,C,D,e,f,j,E,k,l,F){var b,a=t.fromFeature(y,A);j===dM.vertical&&a.verticalizePunctuation();var o=c0.processBidirectionalText,p=c0.processStyledBidirectionalText;if(o&&1===a.sections.length){b=[];for(var G=o(a.toString(),iJ(a,e,i,c,d,k,l)),m=0,q=G;m<q.length;m+=1){var r=q[m],g=new t;g.text=r,g.sections=a.sections;for(var s=0;s<r.length;s++)g.sectionIndex.push(0);b.push(g)}}else if(p){b=[];for(var H=p(a.text,a.sectionIndex,iJ(a,e,i,c,d,k,l)),n=0,u=H;n<u.length;n+=1){var v=u[n],h=new t;h.text=v[0],h.sectionIndex=v[1],h.sections=a.sections,b.push(h)}}else b=function(b,h){for(var c=[],e=b.text,a=0,d=0,f=h;d<f.length;d+=1){var g=f[d];c.push(b.substring(a,g)),a=g}return a<e.length&&c.push(b.substring(a,e.length)),c}(a,iJ(a,e,i,c,d,k,l));var w=[],x={positionedLines:w,text:a.toString(),top:f[1],bottom:f[1],left:f[0],right:f[0],writingMode:j,iconsInText:!1,verticalizable:!1};return iK(x,c,z,d,b,B,C,D,j,e,E,F),!function(c){for(var a=0,b=c;a<b.length;a+=1)if(0!==b[a].positionedGlyphs.length)return!1;return!0}(w)&&x}t.fromFeature=function(d,e){for(var a=new t,b=0;b<d.sections.length;b++){var c=d.sections[b];c.image?a.addImageSection(c):a.addTextSection(c,e)}return a},t.prototype.length=function(){return this.text.length},t.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},t.prototype.getSectionIndex=function(a){return this.sectionIndex[a]},t.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},t.prototype.verticalizePunctuation=function(){this.text=function(b){for(var c="",a=0;a<b.length;a++){var d=b.charCodeAt(a+1)||null,e=b.charCodeAt(a-1)||null;d&&gn(d)&&!ih[b[a+1]]||e&&gn(e)&&!ih[b[a-1]]||!ih[b[a]]?c+=b[a]:c+=ih[b[a]]}return c}(this.text)},t.prototype.trim=function(){for(var a=0,c=0;c<this.text.length&&aq[this.text.charCodeAt(c)];c++)a++;for(var d=this.text.length,b=this.text.length-1;b>=0&&b>=a&&aq[this.text.charCodeAt(b)];b--)d--;this.text=this.text.substring(a,d),this.sectionIndex=this.sectionIndex.slice(a,d)},t.prototype.substring=function(b,c){var a=new t;return a.text=this.text.substring(b,c),a.sectionIndex=this.sectionIndex.slice(b,c),a.sections=this.sections,a},t.prototype.toString=function(){return this.text},t.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(b,c){return Math.max(b,a.sections[c].scale)},0)},t.prototype.addTextSection=function(a,c){this.text+=a.text,this.sections.push(bT.forText(a.scale,a.fontStack||c));for(var d=this.sections.length-1,b=0;b<a.text.length;++b)this.sectionIndex.push(d)},t.prototype.addImageSection=function(a){var b=a.image?a.image.name:"";if(0===b.length){cc("Can't add FormattedSection with an empty image.");return}var c=this.getNextImageSectionCharCode();if(!c){cc("Reached maximum number of images 6401");return}this.text+=String.fromCharCode(c),this.sections.push(bT.forImage(b)),this.sectionIndex.push(this.sections.length-1)},t.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var aq={};aq[9]=!0,aq[10]=!0,aq[11]=!0,aq[12]=!0,aq[13]=!0,aq[32]=!0;var q={};function iE(f,a,g,h,b,i){if(a.imageName){var c=h[a.imageName];return c?c.displaySize[0]*a.scale*dK/i+b:0}var d=g[a.fontStack],e=d&&d[f];return e?e.metrics.advance*a.scale+b:0}function iF(b,c,d,e){var a=Math.pow(b-c,2);return e?b<c?a/2:2*a:a+Math.abs(d)*d}function iG(b,c,d){var a=0;return 10===b&&(a-=1e4),d&&(a+=150),(40===b||65288===b)&&(a+=50),(41===c||65289===c)&&(a+=50),a}function iH(k,a,e,l,f,g){for(var h=null,b=iF(a,e,f,g),c=0,i=l;c<i.length;c+=1){var d=i[c],j=iF(a-d.x,e,f,g)+d.badness;j<=b&&(h=d,b=j)}return{index:k,x:a,priorBreak:h,badness:b}}function iI(a){return a?iI(a.priorBreak).concat(a.index):[]}function iJ(a,f,m,g,h,n,i){if("point"!==n)return[];if(!a)return[];for(var d=[],j=function(b,d,e,f,g,h){for(var c=0,a=0;a<b.length();a++){var i=b.getSection(a);c+=iE(b.getCharCode(a),i,f,g,d,h)}return c/Math.max(1,Math.ceil(c/e))}(a,f,m,g,h,i),o=a.text.indexOf("\u200B")>=0,e=0,b=0;b<a.length();b++){var k=a.getSection(b),c=a.getCharCode(b);if(aq[c]||(e+=iE(c,k,g,h,f,i)),b<a.length()-1){var l=gl(c);(q[c]||l||k.imageName)&&d.push(iH(b+1,e,j,d,iG(c,a.getCharCode(b+1),l&&o),!1))}}return iI(iH(a.length(),e,j,d,0,!0))}function dN(c){var a=.5,b=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0;break}switch(c){case"bottom":case"bottom-right":case"bottom-left":b=1;break;case"top":case"top-right":case"top-left":b=0;break}return{horizontalAlign:a,verticalAlign:b}}function iK(b,Q,R,S,B,r,T,C,U,s,D,V){for(var g=0,h=-17,i=0,t=0,E="right"===C?1:"left"===C?0:.5,u=0,v=0,F=B;v<F.length;v+=1){var c=F[v];c.trim();var j=c.getMaxScale(),G=(j-1)*dK,w={positionedGlyphs:[],lineOffset:0};b.positionedLines[u]=w;var k=w.positionedGlyphs,l=0;if(!c.length()){h+=r,++u;continue}for(var m=0;m<c.length();m++){var a=c.getSection(m),H=c.getSectionIndex(m),d=c.getCharCode(m),o=0,e=null,p=null,x=null,I=dK,n=!(U===dM.horizontal|| !D&&!gm(d)||D&&(aq[d]||go(d)));if(a.imageName){var y=S[a.imageName];if(!y)continue;x=a.imageName,b.iconsInText=b.iconsInText||!0,p=y.paddedRect;var f=y.displaySize;a.scale=a.scale*dK/V,e={width:f[0],height:f[1],left:1,top:-3,advance:n?f[1]:f[0]};var W=dK-f[1]*a.scale;o=G+W,I=e.advance;var z=n?f[0]*a.scale-dK*j:f[1]*a.scale-dK*j;z>0&&z>l&&(l=z)}else{var J=R[a.fontStack],q=J&&J[d];if(q&&q.rect)p=q.rect,e=q.metrics;else{var K=Q[a.fontStack],L=K&&K[d];if(!L)continue;e=L.metrics}o=(j-a.scale)*dK}n?(b.verticalizable=!0,k.push({glyph:d,imageName:x,x:g,y:h+o,vertical:n,scale:a.scale,fontStack:a.fontStack,sectionIndex:H,metrics:e,rect:p}),g+=I*a.scale+s):(k.push({glyph:d,imageName:x,x:g,y:h+o,vertical:n,scale:a.scale,fontStack:a.fontStack,sectionIndex:H,metrics:e,rect:p}),g+=e.advance*a.scale+s)}0!==k.length&&(i=Math.max(g-s,i),iL(k,0,k.length-1,E,l)),g=0;var M=r*j+l;w.lineOffset=Math.max(l,G),h+=M,t=Math.max(M,t),++u}var A=h- -17,N=dN(T),O=N.horizontalAlign,P=N.verticalAlign;iM(b.positionedLines,E,O,P,i,t,r,A,B.length),b.top+=-P*A,b.bottom=b.top+A,b.left+=-O*i,b.right=b.left+i}function iL(a,g,c,d,e){if(d||e)for(var f=a[c],h=f.metrics.advance*f.scale,i=(a[c].x+h)*d,b=g;b<=c;b++)a[b].x-=i,a[b].y+=e}function iM(i,j,k,c,l,m,d,n,o){var p=(j-k)*l,e=0;e=m!==d?-n*c- -17:(-c*o+.5)*d;for(var a=0,f=i;a<f.length;a+=1)for(var q=f[a],b=0,g=q.positionedGlyphs;b<g.length;b+=1){var h=g[b];h.x+=p,h.y+=e}}function iN(a,b,f){var c=dN(f),g=c.horizontalAlign,h=c.verticalAlign,i=b[0],j=b[1],d=i-a.displaySize[0]*g,k=d+a.displaySize[0],e=j-a.displaySize[1]*h,l=e+a.displaySize[1];return{image:a,top:e,bottom:l,left:d,right:k}}function iO(r,c,d,e,b,f){var m,i,j,k,l,a=r.image;if(a.content){var g=a.content,h=a.pixelRatio||1;m=[g[0]/h,g[1]/h,a.displaySize[0]-g[2]/h,a.displaySize[1]-g[3]/h]}var n=c.left*f,o=c.right*f;"width"===d||"both"===d?(l=b[0]+n-e[3],j=b[0]+o+e[1]):j=(l=b[0]+(n+o-a.displaySize[0])/2)+a.displaySize[0];var p=c.top*f,q=c.bottom*f;return"height"===d||"both"===d?(i=b[1]+p-e[0],k=b[1]+q+e[2]):k=(i=b[1]+(p+q-a.displaySize[1])/2)+a.displaySize[1],{image:a,top:i,right:j,bottom:k,left:l,collisionPadding:m}}q[10]=!0,q[32]=!0,q[38]=!0,q[40]=!0,q[41]=!0,q[43]=!0,q[45]=!0,q[47]=!0,q[173]=!0,q[183]=!0,q[8203]=!0,q[8208]=!0,q[8211]=!0,q[8231]=!0;var dO=function(b){function a(c,d,e,a){b.call(this,c,d),this.angle=e,void 0!==a&&(this.segment=a)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.clone=function(){return new a(this.x,this.y,this.angle,this.segment)},a}(aY);function dP(e,i){var a=i.expression;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new aP(e+1))};if("source"===a.kind)return{kind:"source"};for(var b=a.zoomStops,h=a.interpolationType,c=0;c<b.length&&b[c]<=e;)c++;for(var d=c=Math.max(0,c-1);d<b.length&&b[d]<e+1;)d++;d=Math.min(b.length-1,d);var f=b[c],g=b[d];if("composite"===a.kind)return{kind:"composite",minZoom:f,maxZoom:g,interpolationType:h};var j=a.evaluate(new aP(f)),k=a.evaluate(new aP(g));return{kind:"camera",minZoom:f,maxZoom:g,minSize:j,maxSize:k,interpolationType:h}}function bU(a,b,c){var e=b.uSize,f=b.uSizeT,d=c.lowerSize,g=c.upperSize;return"source"===a.kind?d/128:"composite"===a.kind?bs(d/128,g/128,f):e}function bV(a,f){var c=0,b=0;if("constant"===a.kind)b=a.layoutSize;else if("source"!==a.kind){var d=a.interpolationType,g=a.minZoom,h=a.maxZoom,e=d?b3(C.interpolationFactor(d,f,g,h),0,1):0;"camera"===a.kind?b=bs(a.minSize,a.maxSize,e):c=e}return{uSizeT:c,uSize:b}}c("Anchor",dO);var dQ=Object.freeze({__proto__:null,getSizeData:dP,evaluateSizeForFeature:bU,evaluateSizeForZoom:bV,SIZE_PACK_FACTOR:128});function iP(b,e,j,l,m){if(void 0===e.segment)return!0;for(var k=e,a=e.segment+1,c=0;c> -j/2;){if(a--,a<0)return!1;c-=b[a].dist(k),k=b[a]}c+=b[a].dist(b[a+1]),a++;for(var f=[],g=0;c<j/2;){var n=b[a-1],h=b[a],i=b[a+1];if(!i)return!1;var d=n.angleTo(h)-h.angleTo(i);for(d=Math.abs((d+3*Math.PI)%(2*Math.PI)-Math.PI),f.push({distance:c,angleDelta:d}),g+=d;c-f[0].distance>l;)g-=f.shift().angleDelta;if(g>m)return!1;a++,c+=h.dist(i)}return!0}function iQ(b){for(var c=0,a=0;a<b.length-1;a++)c+=b[a].dist(b[a+1]);return c}function iR(a,b,c){return a?.6*b*c:0}function iS(a,b){return Math.max(a?a.right-a.left:0,b?b.right-b.left:0)}function iT(a,m,h,n,o,i){for(var j=iR(h,o,i),p=iS(h,n)*i,e=0,k=iQ(a)/2,b=0;b<a.length-1;b++){var c=a[b],d=a[b+1],f=c.dist(d);if(e+f>k){var l=(k-e)/f,q=bs(c.x,d.x,l),r=bs(c.y,d.y,l),g=new dO(q,r,d.angleTo(c),b);if(g._round(),!j||iP(a,g,p,j,m))return g;return}e+=f}}function iU(b,a,k,f,l,g,c,h,d){var m=iR(f,g,c),i=iS(f,l),e=i*c,j=0===b[0].x||b[0].x===d||0===b[0].y||b[0].y===d;return a-e<a/4&&(a=e+a/4),iV(b,j?a/2*h%a:(i/2+2*g)*c*h%a,a,m,k,e,j,!1,d)}function iV(a,t,c,i,p,j,q,u,k){for(var r=j/2,v=iQ(a),d=0,e=t-c,f=[],b=0;b<a.length-1;b++){for(var g=a[b],h=a[b+1],l=g.dist(h),w=h.angleTo(g);e+c<d+l;){var s=((e+=c)-d)/l,m=bs(g.x,h.x,s),n=bs(g.y,h.y,s);if(m>=0&&m<k&&n>=0&&n<k&&e-r>=0&&e+r<=v){var o=new dO(m,n,w,b);o._round(),(!i||iP(a,o,j,i,p))&&f.push(o)}}d+=l}return u||f.length||q||(f=iV(a,d/2,c,i,p,j,q,!0,k)),f}function dR(k,c,d,e,f){for(var l=[],i=0;i<k.length;i++)for(var j=k[i],g=void 0,h=0;h<j.length-1;h++){var a=j[h],b=j[h+1];(!(a.x<c)||!(b.x<c))&&(a.x<c?a=new aY(c,a.y+(b.y-a.y)*((c-a.x)/(b.x-a.x)))._round():b.x<c&&(b=new aY(c,a.y+(b.y-a.y)*((c-a.x)/(b.x-a.x)))._round()),a.y<d&&b.y<d||(a.y<d?a=new aY(a.x+(b.x-a.x)*((d-a.y)/(b.y-a.y)),d)._round():b.y<d&&(b=new aY(a.x+(b.x-a.x)*((d-a.y)/(b.y-a.y)),d)._round()),(!(a.x>=e)||!(b.x>=e))&&(a.x>=e?a=new aY(e,a.y+(b.y-a.y)*((e-a.x)/(b.x-a.x)))._round():b.x>=e&&(b=new aY(e,a.y+(b.y-a.y)*((e-a.x)/(b.x-a.x)))._round()),a.y>=f&&b.y>=f||(a.y>=f?a=new aY(a.x+(b.x-a.x)*((f-a.y)/(b.y-a.y)),f)._round():b.y>=f&&(b=new aY(a.x+(b.x-a.x)*((f-a.y)/(b.y-a.y)),f)._round()),g&&a.equals(g[g.length-1])||(g=[a],l.push(g)),g.push(b)))))}return l}function iW(c,F,G,o){var h=[],b=c.image,H=b.pixelRatio,i=b.paddedRect.w-2,j=b.paddedRect.h-2,I=c.right-c.left,J=c.bottom-c.top,d=b.stretchX||[[0,i]],e=b.stretchY||[[0,j]],p=function(b,a){return b+a[1]-a[0]},k=d.reduce(p,0),l=e.reduce(p,0),q=i-k,r=j-l,s=0,t=k,u=0,v=l,x=0,y=q,z=0,A=r;if(b.content&&o){var a=b.content;s=iX(d,0,a[0]),u=iX(e,0,a[1]),t=iX(d,a[0],a[2]),v=iX(e,a[1],a[3]),x=a[0]-s,z=a[1]-u,y=a[2]-a[0]-t,A=a[3]-a[1]-v}var w=function(a,d,e,f){var i=iZ(a.stretch-s,t,I,c.left),E=i$(a.fixed-x,y,a.stretch,k),j=iZ(d.stretch-u,v,J,c.top),K=i$(d.fixed-z,A,d.stretch,l),m=iZ(e.stretch-s,t,I,c.left),L=i$(e.fixed-x,y,e.stretch,k),n=iZ(f.stretch-u,v,J,c.top),M=i$(f.fixed-z,A,f.stretch,l),o=new aY(i,j),p=new aY(m,j),q=new aY(m,n),r=new aY(i,n),N=new aY(E/H,K/H),O=new aY(L/H,M/H),h=F*Math.PI/180;if(h){var w=Math.sin(h),B=Math.cos(h),g=[B,-w,w,B];o._matMult(g),p._matMult(g),r._matMult(g),q._matMult(g)}var C=a.stretch+a.fixed,P=e.stretch+e.fixed,D=d.stretch+d.fixed,Q=f.stretch+f.fixed;return{tl:o,tr:p,bl:r,br:q,tex:{x:b.paddedRect.x+1+C,y:b.paddedRect.y+1+D,w:P-C,h:Q-D},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:N,pixelOffsetBR:O,minFontScaleX:y/H/I,minFontScaleY:A/H/J,isSDF:G}};if(o&&(b.stretchX||b.stretchY))for(var m=iY(d,q,k),n=iY(e,r,l),f=0;f<m.length-1;f++)for(var B=m[f],C=m[f+1],g=0;g<n.length-1;g++){var D=n[g],E=n[g+1];h.push(w(B,D,C,E))}else h.push(w({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:i+1},{fixed:0,stretch:j+1}));return h}function iX(g,b,c){for(var d=0,a=0,e=g;a<e.length;a+=1){var f=e[a];d+=Math.max(b,Math.min(c,f[1]))-Math.max(b,Math.min(c,f[0]))}return d}function iY(g,h,i){for(var a=[{fixed:-1,stretch:0}],c=0,e=g;c<e.length;c+=1){var f=e[c],d=f[0],j=f[1],b=a[a.length-1];a.push({fixed:d-b.stretch,stretch:b.stretch}),a.push({fixed:d-b.stretch,stretch:b.stretch+(j-d)})}return a.push({fixed:h+1,stretch:i}),a}function iZ(a,b,c,d){return a/b*c+d}function i$(a,b,c,d){return a-b*c/d}var i_=function(o,q,u,v,w,a,b,l,x,r){if(this.boxStartIndex=o.length,x){var s=a.top,t=a.bottom,p=a.collisionPadding;p&&(s-=p[1],t+=p[3]);var m=t-s;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{var c=a.top*b-l,d=a.bottom*b+l,e=a.left*b-l,f=a.right*b+l,g=a.collisionPadding;if(g&&(e-=g[0]*b,c-=g[1]*b,f+=g[2]*b,d+=g[3]*b),r){var h=new aY(e,c),i=new aY(f,c),j=new aY(e,d),k=new aY(f,d),n=r*Math.PI/180;h._rotate(n),i._rotate(n),j._rotate(n),k._rotate(n),e=Math.min(h.x,i.x,j.x,k.x),f=Math.max(h.x,i.x,j.x,k.x),c=Math.min(h.y,i.y,j.y,k.y),d=Math.max(h.y,i.y,j.y,k.y)}o.emplaceBack(q.x,q.y,e,c,f,d,u,v,w)}this.boxEndIndex=o.length},aG=function(a,b){if(void 0===a&&(a=[]),void 0===b&&(b=i0),this.data=a,this.length=this.data.length,this.compare=b,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function i0(a,b){return a<b?-1:a>b?1:0}function i1(e,n,j){void 0===n&&(n=1),void 0===j&&(j=!1);for(var h=1/0,i=1/0,k=-1/0,l=-1/0,r=e[0],f=0;f<r.length;f++){var c=r[f];(!f||c.x<h)&&(h=c.x),(!f||c.y<i)&&(i=c.y),(!f||c.x>k)&&(k=c.x),(!f||c.y>l)&&(l=c.y)}var m=Math.min(k-h,l-i),a=m/2,d=new aG([],i2);if(0===m)return new aY(h,i);for(var o=h;o<k;o+=m)for(var p=i;p<l;p+=m)d.push(new i3(o+a,p+a,a,e));for(var g=i5(e),q=d.length;d.length;){var b=d.pop();(b.d>g.d||!g.d)&&(g=b,j&&console.log("found best %d after %d probes",Math.round(1e4*b.d)/1e4,q)),b.max-g.d<=n||(a=b.h/2,d.push(new i3(b.p.x-a,b.p.y-a,a,e)),d.push(new i3(b.p.x+a,b.p.y-a,a,e)),d.push(new i3(b.p.x-a,b.p.y+a,a,e)),d.push(new i3(b.p.x+a,b.p.y+a,a,e)),q+=4)}return j&&(console.log("num probes: "+q),console.log("best distance: "+g.d)),g.p}function i2(a,b){return b.max-a.max}function i3(a,b,c,d){this.p=new aY(a,b),this.h=c,this.d=i4(this.p,d),this.max=this.d+this.h*Math.SQRT2}function i4(b,i){for(var d=!1,e=1/0,f=0;f<i.length;f++)for(var g=i[f],h=0,j=g.length,k=j-1;h<j;k=h++){var a=g[h],c=g[k];a.y>b.y!=c.y>b.y&&b.x<(c.x-a.x)*(b.y-a.y)/(c.y-a.y)+a.x&&(d=!d),e=Math.min(e,gV(b,a,c))}return(d?1:-1)*Math.sqrt(e)}function i5(g){for(var c=0,h=0,i=0,d=g[0],e=0,j=d.length,k=j-1;e<j;k=e++){var a=d[e],b=d[k],f=a.x*b.y-b.x*a.y;h+=(a.x+b.x)*f,i+=(a.y+b.y)*f,c+=3*f}return new i3(h/c,i/c,0,g)}aG.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},aG.prototype.pop=function(){if(0!==this.length){var a=this.data[0],b=this.data.pop();return this.length--,this.length>0&&(this.data[0]=b,this._down(0)),a}},aG.prototype.peek=function(){return this.data[0]},aG.prototype._up=function(a){for(var b=this.data,f=this.compare,c=b[a];a>0;){var d=a-1>>1,e=b[d];if(f(c,e)>=0)break;b[a]=e,a=d}b[a]=c},aG.prototype._down=function(a){for(var b=this.data,f=this.compare,h=this.length>>1,g=b[a];a<h;){var c=(a<<1)+1,d=b[c],e=c+1;if(e<this.length&&0>f(b[e],d)&&(c=e,d=b[e]),f(d,g)>=0)break;b[a]=d,a=c}b[a]=g};var i6=Number.POSITIVE_INFINITY;function dS(b,a){return a[1]!==i6?function(e,a,b){var c=0,d=0;switch(a=Math.abs(a),b=Math.abs(b),e){case"top-right":case"top-left":case"top":d=b-7;break;case"bottom-right":case"bottom-left":case"bottom":d=-b+7;break}switch(e){case"top-right":case"bottom-right":case"right":c=-a;break;case"top-left":case"bottom-left":case"left":c=a;break}return[c,d]}(b,a[0],a[1]):function(e,a){var b=0,c=0;a<0&&(a=0);var d=a/Math.sqrt(2);switch(e){case"top-right":case"top-left":c=d-7;break;case"bottom-right":case"bottom-left":c=-d+7;break;case"bottom":c=-a+7;break;case"top":c=a-7;break}switch(e){case"top-right":case"bottom-right":b=-d;break;case"top-left":case"bottom-left":b=d;break;case"left":b=a;break;case"right":b=-a;break}return[b,c]}(b,a[0])}function dT(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function i7(b,c,e,d,U,N,u,O,V,W,P){var Q,h=N.textMaxSize.evaluate(c,{});void 0===h&&(h=u);var a=b.layers[0].layout,v=a.get("icon-offset").evaluate(c,{},P),f=i9(e.horizontal),i=u/24,X=b.tilePixelRatio*i,w=b.tilePixelRatio*h/24,Y=b.tilePixelRatio*O,x=b.tilePixelRatio*a.get("symbol-spacing"),Z=a.get("text-padding")*b.tilePixelRatio,$=a.get("icon-padding")*b.tilePixelRatio,y=a.get("text-max-angle")/180*Math.PI,_="map"===a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement"),aa="map"===a.get("icon-rotation-alignment")&&"point"!==a.get("symbol-placement"),z=a.get("symbol-placement"),R=x/2,j=a.get("icon-text-fit");d&&"none"!==j&&(b.allowVerticalPlacement&&e.vertical&&(Q=iO(d,e.vertical,j,a.get("icon-text-fit-padding"),v,i)),f&&(d=iO(d,f,j,a.get("icon-text-fit-padding"),v,i)));var g=function(f,a){a.x<0||a.x>=8192||a.y<0||a.y>=8192||ja(b,a,f,e,d,U,Q,b.layers[0],b.collisionBoxArray,c.index,c.sourceLayerIndex,b.index,X,Z,_,V,Y,$,aa,v,c,N,W,P,u)};if("line"===z)for(var k=0,A=dR(c.geometry,0,0,8192,8192);k<A.length;k+=1)for(var B=A[k],S=iU(B,x,y,e.vertical||f,d,24,w,b.overscaling,8192),l=0,C=S;l<C.length;l+=1){var D=C[l],E=f;E&&jb(b,E.text,R,D)||g(B,D)}else if("line-center"===z)for(var m=0,F=c.geometry;m<F.length;m+=1){var n=F[m];if(n.length>1){var G=iT(n,y,e.vertical||f,d,24,w);G&&g(n,G)}}else if("Polygon"===c.type)for(var o=0,H=hM(c.geometry,0);o<H.length;o+=1){var I=H[o],J=i1(I,16);g(I[0],new dO(J.x,J.y,0))}else if("LineString"===c.type)for(var p=0,K=c.geometry;p<K.length;p+=1){var q=K[p];g(q,new dO(q[0].x,q[0].y,0))}else if("Point"===c.type)for(var r=0,L=c.geometry;r<L.length;r+=1)for(var T=L[r],s=0,M=T;s<M.length;s+=1){var t=M[s];g([t],new dO(t.x,t.y,0))}}function i8(a,f,o,p,g,h,b,i,j,q,r,s,t,k,d){var l=function(X,j,w,M,k,N,O,x){for(var l=M.layout.get("text-rotate").evaluate(N,{})*Math.PI/180,y=[],m=0,z=j.positionedLines;m<z.length;m+=1)for(var A=z[m],n=0,B=A.positionedGlyphs;n<B.length;n+=1){var a=B[n];if(a.rect){var o=a.rect||{},p=4,C=!0,c=1,D=0,E=(k||x)&&a.vertical,b=a.metrics.advance*a.scale/2;if(x&&j.verticalizable){var P=(a.scale-1)*dK,Q=(dK-a.metrics.width*a.scale)/2;D=A.lineOffset/2-(a.imageName?-Q:P)}if(a.imageName){var F=O[a.imageName];C=F.sdf,c=F.pixelRatio,p=1/c}var R=k?[a.x+b,a.y]:[0,0],d=k?[0,0]:[a.x+b+w[0],a.y+w[1]-D],G=[0,0];E&&(G=d,d=[0,0]);var q=(a.metrics.left-p)*a.scale-b+d[0],r=(-a.metrics.top-p)*a.scale+d[1],H=q+o.w*a.scale/c,I=r+o.h*a.scale/c,s=new aY(q,r),t=new aY(H,r),u=new aY(q,I),v=new aY(H,I);if(E){var e=new aY(-b,b- -17),f=-Math.PI/2,J=dK/2-b,S=a.imageName?J:0,g=new aY(22-J,-S),h=new(Function.prototype.bind.apply(aY,[null].concat(G)));s._rotateAround(f,e)._add(g)._add(h),t._rotateAround(f,e)._add(g)._add(h),u._rotateAround(f,e)._add(g)._add(h),v._rotateAround(f,e)._add(g)._add(h)}if(l){var K=Math.sin(l),L=Math.cos(l),i=[L,-K,K,L];s._matMult(i),t._matMult(i),u._matMult(i),v._matMult(i)}var T=new aY(0,0),U=new aY(0,0),V=0,W=0;y.push({tl:s,tr:t,bl:u,br:v,tex:o,writingMode:j.writingMode,glyphOffset:R,sectionIndex:a.sectionIndex,isSDF:C,pixelOffsetTL:T,pixelOffsetBR:U,minFontScaleX:V,minFontScaleY:W})}}return y}(f,o,i,g,h,b,p,a.allowVerticalPlacement),m=a.textSizeData,c=null;"source"===m.kind?(c=[128*g.layout.get("text-size").evaluate(b,{})])[0]>32640&&cc(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===m.kind&&((c=[128*k.compositeTextSizes[0].evaluate(b,{},d),128*k.compositeTextSizes[1].evaluate(b,{},d)])[0]>32640||c[1]>32640)&&cc(a.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),a.addSymbols(a.text,l,c,i,h,b,q,f,j.lineStartIndex,j.lineLength,t,d);for(var e=0,n=r;e<n.length;e+=1)s[n[e]]=a.text.placedSymbolArray.length-1;return 4*l.length}function i9(a){for(var b in a)return a[b];return null}function ja(a,c,_,i,y,G,r,e,s,o,t,u,z,H,p,I,J,K,L,M,b,v,N,f,aa){var O,j,k,l,m,n=a.addToLineVertexArray(c,_),P=0,Q=0,R=0,S=0,A=-1,B=-1,g={},T=bP(""),C=0,D=0;if(void 0===e._unevaluatedLayout.getValue("text-radial-offset")?(C=(O=e.layout.get("text-offset").evaluate(b,{},f).map(function(a){return a*dK}))[0],D=O[1]):(C=e.layout.get("text-radial-offset").evaluate(b,{},f)*dK,D=i6),a.allowVerticalPlacement&&i.vertical){var U=e.layout.get("text-rotate").evaluate(b,{},f)+90,ab=i.vertical;l=new i_(s,c,o,t,u,ab,z,H,p,U),r&&(m=new i_(s,c,o,t,u,r,J,K,p,U))}if(y){var E=e.layout.get("icon-rotate").evaluate(b,{}),V="none"!==e.layout.get("icon-text-fit"),W=iW(y,E,N,V),F=r?iW(r,E,N,V):void 0;k=new i_(s,c,o,t,u,y,J,K,!1,E),P=4*W.length;var X=a.iconSizeData,q=null;"source"===X.kind?(q=[128*e.layout.get("icon-size").evaluate(b,{})])[0]>32640&&cc(a.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===X.kind&&((q=[128*v.compositeIconSizes[0].evaluate(b,{},f),128*v.compositeIconSizes[1].evaluate(b,{},f)])[0]>32640||q[1]>32640)&&cc(a.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),a.addSymbols(a.icon,W,q,M,L,b,!1,c,n.lineStartIndex,n.lineLength,-1,f),A=a.icon.placedSymbolArray.length-1,F&&(Q=4*F.length,a.addSymbols(a.icon,F,q,M,L,b,dM.vertical,c,n.lineStartIndex,n.lineLength,-1,f),B=a.icon.placedSymbolArray.length-1)}for(var Y in i.horizontal){var w=i.horizontal[Y];if(!j){T=bP(w.text);var ac=e.layout.get("text-rotate").evaluate(b,{},f);j=new i_(s,c,o,t,u,w,z,H,p,ac)}var Z=1===w.positionedLines.length;if(R+=i8(a,c,w,G,e,p,b,I,n,i.vertical?dM.horizontal:dM.horizontalOnly,Z?Object.keys(i.horizontal):[Y],g,A,v,f),Z)break}i.vertical&&(S+=i8(a,c,i.vertical,G,e,p,b,I,n,dM.vertical,["vertical"],g,B,v,f));var ad=j?j.boxStartIndex:a.collisionBoxArray.length,ae=j?j.boxEndIndex:a.collisionBoxArray.length,af=l?l.boxStartIndex:a.collisionBoxArray.length,ag=l?l.boxEndIndex:a.collisionBoxArray.length,ah=k?k.boxStartIndex:a.collisionBoxArray.length,ai=k?k.boxEndIndex:a.collisionBoxArray.length,aj=m?m.boxStartIndex:a.collisionBoxArray.length,ak=m?m.boxEndIndex:a.collisionBoxArray.length,d=-1,x=function(a,b){return a&&a.circleDiameter?Math.max(a.circleDiameter,b):b};d=x(j,d),d=x(l,d),d=x(k,d),d=x(m,d);var $=d> -1?1:0;$&&(d*=aa/dK),a.glyphOffsetArray.length>=h.MAX_GLYPHS&&cc("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&a.addToSortKeyRanges(a.symbolInstances.length,b.sortKey),a.symbolInstances.emplaceBack(c.x,c.y,g.right>=0?g.right:-1,g.center>=0?g.center:-1,g.left>=0?g.left:-1,g.vertical|| -1,A,B,T,ad,ae,af,ag,ah,ai,aj,ak,o,R,S,P,Q,$,0,z,C,D,d)}function jb(f,a,g,d){var b=f.compareText;if(a in b){for(var e=b[a],c=e.length-1;c>=0;c--)if(d.dist(e[c])<g)return!0}else b[a]=[];return b[a].push(d),!1}var jc=aC.VectorTileFeature.types,jd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function je(b,c,d,e,f,g,h,a,i,j,k,l,m){var n=a?Math.min(32640,Math.round(a[0])):0,o=a?Math.min(32640,Math.round(a[1])):0;b.emplaceBack(c,d,Math.round(32*e),Math.round(32*f),g,h,(n<<1)+(i?1:0),o,16*j,16*k,256*l,256*m)}function bW(b,a,c){b.emplaceBack(a.x,a.y,c),b.emplaceBack(a.x,a.y,c),b.emplaceBack(a.x,a.y,c),b.emplaceBack(a.x,a.y,c)}function jf(c){for(var a=0,b=c.sections;a<b.length;a+=1)if(gr(b[a].text))return!0;return!1}var aV=function(a){this.layoutVertexArray=new bF,this.indexArray=new a8,this.programConfigurations=a,this.segments=new N,this.dynamicLayoutVertexArray=new bG,this.opacityVertexArray=new bH,this.placedSymbolArray=new c5};aV.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},aV.prototype.upload=function(a,c,b,d){!this.isEmpty()&&(b&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ib.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,ic.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,jd,!0),this.opacityVertexBuffer.itemSize=1),(b||d)&&this.programConfigurations.upload(a))},aV.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},c("SymbolBuffers",aV);var bi=function(a,b,c){this.layoutVertexArray=new a,this.layoutAttributes=b,this.indexArray=new c,this.segments=new N,this.collisionVertexArray=new bJ};bi.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,id.members,!0)},bi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},c("CollisionBuffers",bi);var h=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=dn([]),this.placementViewportMatrix=dn([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=dP(this.zoom,d["text-size"]),this.iconSizeData=dP(this.zoom,d["icon-size"]);var b=this.layers[0].layout,e=b.get("symbol-sort-key"),c=b.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==c&& void 0!==e.constantOr(1);var f="viewport-y"===c||"auto"===c&&!this.sortFeaturesByKey;this.sortFeaturesByY=f&&(b.get("text-allow-overlap")||b.get("icon-allow-overlap")||b.get("text-ignore-placement")||b.get("icon-ignore-placement")),"point"===b.get("symbol-placement")&&(this.writingModes=b.get("text-writing-mode").map(function(a){return dM[a]})),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id}),this.sourceID=a.sourceID};h.prototype.createArrays=function(){this.text=new aV(new an(ib.members,this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new aV(new an(ib.members,this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.glyphOffsetArray=new c8,this.lineVertexArray=new c9,this.symbolInstances=new c7},h.prototype.calculateGlyphDependencies=function(b,c,e,f,g){for(var a=0;a<b.length;a++)if(c[b.charCodeAt(a)]=!0,(e||f)&&g){var d=ih[b.charAt(a)];d&&(c[d.charCodeAt(0)]=!0)}},h.prototype.populate=function(B,k,f){var d=this.layers[0],a=d.layout,l=a.get("text-font"),h=a.get("text-field"),m=a.get("icon-image"),q=("constant"!==h.value.kind||h.value.value instanceof aw&&!h.value.value.isEmpty()||h.value.value.toString().length>0)&&("constant"!==l.value.kind||l.value.value.length>0),r="constant"!==m.value.kind||!!m.value.value||Object.keys(m.parameters).length>0,C=a.get("symbol-sort-key");if(this.features=[],q||r){for(var s=k.iconDependencies,t=k.glyphDependencies,u=k.availableImages,D=new aP(this.zoom),n=0,v=B;n<v.length;n+=1){var i=v[n],b=i.feature,w=i.id,E=i.index,F=i.sourceLayerIndex,x=d._featureFilter.needGeometry,c={type:b.type,id:w,properties:b.properties,geometry:x?gN(b):[]};if(d._featureFilter.filter(D,c,f)){x||(c.geometry=gN(b));var e=void 0;if(q){var G=d.getValueAndResolveTokens("text-field",c,f,u),y=aw.factory(G);jf(y)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===c_()||this.hasRTLText&&c0.isParsed())&&(e=ig(y,d,c))}var g=void 0;if(r){var o=d.getValueAndResolveTokens("icon-image",c,f,u);g=o instanceof aL?o:aL.fromString(o)}if(e||g){var H=this.sortFeaturesByKey?C.evaluate(c,{},f):void 0,I={id:w,text:e,icon:g,index:E,sourceLayerIndex:F,geometry:gN(b),properties:b.properties,type:jc[b.type],sortKey:H};if(this.features.push(I),g&&(s[g.name]=!0),e){var J=l.evaluate(c,{},f).join(","),K="map"===a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(dM.vertical)>=0;for(var p=0,z=e.sections;p<z.length;p+=1){var j=z[p];if(j.image)s[j.image.name]=!0;else{var L=gi(e.toString()),A=j.fontStack||J,M=t[A]=t[A]||{};this.calculateGlyphDependencies(j.text,M,K,this.allowVerticalPlacement,L)}}}}}}"line"===a.get("symbol-placement")&&(this.features=function(k){var d={},c={},g=[],l=0;function m(a){g.push(k[a]),l++}function n(b,d,e){var a=c[b];return delete c[b],c[d]=a,g[a].geometry[0].pop(),g[a].geometry[0]=g[a].geometry[0].concat(e[0]),a}function o(c,b,e){var a=d[b];return delete d[b],d[c]=a,g[a].geometry[0].shift(),g[a].geometry[0]=e[0].concat(g[a].geometry[0]),a}function i(c,a,d){var b=d?a[0][a[0].length-1]:a[0][0];return c+":"+b.x+":"+b.y}for(var e=0;e<k.length;e++){var j=k[e],f=j.geometry,h=j.text?j.text.toString():null;if(!h){m(e);continue}var a=i(h,f),b=i(h,f,!0);if(a in c&&b in d&&c[a]!==d[b]){var p=o(a,b,f),q=n(a,b,g[p].geometry);delete d[a],delete c[b],c[i(h,g[q].geometry,!0)]=q,g[p].geometry=null}else a in c?n(a,b,f):b in d?o(a,b,f):(m(e),d[a]=l-1,c[b]=l-1)}return g.filter(function(a){return a.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(a,b){return a.sortKey-b.sortKey})}},h.prototype.update=function(a,b,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,b,this.layers,c),this.icon.programConfigurations.updatePaintArrays(a,b,this.layers,c))},h.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},h.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},h.prototype.upload=function(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},h.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},h.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},h.prototype.addToLineVertexArray=function(d,a){var h=this.lineVertexArray.length;if(void 0!==d.segment){for(var i=d.dist(a[d.segment+1]),j=d.dist(a[d.segment]),e={},b=d.segment+1;b<a.length;b++)e[b]={x:a[b].x,y:a[b].y,tileUnitDistanceFromAnchor:i},b<a.length-1&&(i+=a[b+1].dist(a[b]));for(var c=d.segment||0;c>=0;c--)e[c]={x:a[c].x,y:a[c].y,tileUnitDistanceFromAnchor:j},c>0&&(j+=a[c-1].dist(a[c]));for(var f=0;f<a.length;f++){var g=e[f];this.lineVertexArray.emplaceBack(g.x,g.y,g.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}},h.prototype.addSymbols=function(e,h,d,s,I,i,t,a,C,D,E,F){for(var r=e.indexArray,f=e.layoutVertexArray,k=e.segments.prepareSegment(4*h.length,f,r,i.sortKey),u=this.glyphOffsetArray.length,G=k.vertexLength,H=this.allowVerticalPlacement&&t===dM.vertical?Math.PI/2:0,v=i.text&&i.text.sections,j=0;j<h.length;j++){var b=h[j],w=b.tl,x=b.tr,y=b.bl,z=b.br,c=b.tex,l=b.pixelOffsetTL,m=b.pixelOffsetBR,n=b.minFontScaleX,o=b.minFontScaleY,A=b.glyphOffset,p=b.isSDF,B=b.sectionIndex,g=k.vertexLength,q=A[1];je(f,a.x,a.y,w.x,q+w.y,c.x,c.y,d,p,l.x,l.y,n,o),je(f,a.x,a.y,x.x,q+x.y,c.x+c.w,c.y,d,p,m.x,l.y,n,o),je(f,a.x,a.y,y.x,q+y.y,c.x,c.y+c.h,d,p,l.x,m.y,n,o),je(f,a.x,a.y,z.x,q+z.y,c.x+c.w,c.y+c.h,d,p,m.x,m.y,n,o),bW(e.dynamicLayoutVertexArray,a,H),r.emplaceBack(g,g+1,g+2),r.emplaceBack(g+1,g+2,g+3),k.vertexLength+=4,k.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),(j===h.length-1||B!==h[j+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(f.length,i,i.index,{},F,v&&v[B])}e.placedSymbolArray.emplaceBack(a.x,a.y,u,this.glyphOffsetArray.length-u,G,C,D,a.segment,d?d[0]:0,d?d[1]:0,s[0],s[1],t,0,!1,0,E)},h.prototype._addCollisionDebugVertex=function(c,d,a,e,f,b){return d.emplaceBack(0,0),c.emplaceBack(a.x,a.y,e,f,Math.round(b.x),Math.round(b.y))},h.prototype.addCollisionDebugVertices=function(j,k,l,m,b,c,n){var i=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),a=i.vertexLength,d=b.layoutVertexArray,e=b.collisionVertexArray,f=n.anchorX,g=n.anchorY;this._addCollisionDebugVertex(d,e,c,f,g,new aY(j,k)),this._addCollisionDebugVertex(d,e,c,f,g,new aY(l,k)),this._addCollisionDebugVertex(d,e,c,f,g,new aY(l,m)),this._addCollisionDebugVertex(d,e,c,f,g,new aY(j,m)),i.vertexLength+=4;var h=b.indexArray;h.emplaceBack(a,a+1),h.emplaceBack(a+1,a+2),h.emplaceBack(a+2,a+3),h.emplaceBack(a+3,a),i.primitiveLength+=4},h.prototype.addDebugCollisionBoxes=function(c,d,e,f){for(var b=c;b<d;b++){var a=this.collisionBoxArray.get(b),g=a.x1,h=a.y1,i=a.x2,j=a.y2;this.addCollisionDebugVertices(g,h,i,j,f?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,e)}},h.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bi(bI,ie.members,bK),this.iconCollisionBox=new bi(bI,ie.members,bK);for(var b=0;b<this.symbolInstances.length;b++){var a=this.symbolInstances.get(b);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}},h.prototype._deserializeCollisionBoxesForSymbol=function(f,k,l,m,n,o,p,q,r){for(var a={},g=k;g<l;g++){var b=f.get(g);a.textBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},a.textFeatureIndex=b.featureIndex;break}for(var h=m;h<n;h++){var c=f.get(h);a.verticalTextBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},a.verticalTextFeatureIndex=c.featureIndex;break}for(var i=o;i<p;i++){var d=f.get(i);a.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},a.iconFeatureIndex=d.featureIndex;break}for(var j=q;j<r;j++){var e=f.get(j);a.verticalIconBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},a.verticalIconFeatureIndex=e.featureIndex;break}return a},h.prototype.deserializeCollisionBoxes=function(c){this.collisionArrays=[];for(var b=0;b<this.symbolInstances.length;b++){var a=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}},h.prototype.hasTextData=function(){return this.text.segments.get().length>0},h.prototype.hasIconData=function(){return this.icon.segments.get().length>0},h.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},h.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},h.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},h.prototype.addIndicesForPlacedSymbol=function(b,d){for(var c=b.placedSymbolArray.get(d),e=c.vertexStartIndex+4*c.numGlyphs,a=c.vertexStartIndex;a<e;a+=4)b.indexArray.emplaceBack(a,a+1,a+2),b.indexArray.emplaceBack(a+1,a+2,a+3)},h.prototype.getSortedSymbolIndexes=function(b){if(this.sortedAngle===b&& void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(b),f=Math.cos(b),g=[],h=[],c=[],a=0;a<this.symbolInstances.length;++a){c.push(a);var d=this.symbolInstances.get(a);g.push(0|Math.round(e*d.anchorX+f*d.anchorY)),h.push(d.featureIndex)}return c.sort(function(a,b){return g[a]-g[b]||h[b]-h[a]}),c},h.prototype.addToSortKeyRanges=function(a,c){var b=this.sortKeyRanges[this.sortKeyRanges.length-1];b&&b.sortKey===c?b.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:a,symbolInstanceEnd:a+1})},h.prototype.sortFeatures=function(b){var f=this;if(this.sortFeaturesByY&&this.sortedAngle!==b&& !(this.text.segments.get().length>1)&&!(this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(b),this.sortedAngle=b,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var c=0,d=this.symbolInstanceIndexes;c<d.length;c+=1){var e=d[c],a=this.symbolInstances.get(e);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach(function(a,b,c){a>=0&&c.indexOf(a)===b&&f.addIndicesForPlacedSymbol(f.text,a)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},c("SymbolBucket",h,{omit:["layers","collisionBoxArray","features","compareText"]}),h.MAX_GLYPHS=65535,h.addDynamicAttributes=bW;var dU=new p({"symbol-placement":new e(b.layout_symbol["symbol-placement"]),"symbol-spacing":new e(b.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new e(b.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new f(b.layout_symbol["symbol-sort-key"]),"symbol-z-order":new e(b.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new e(b.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new e(b.layout_symbol["icon-ignore-placement"]),"icon-optional":new e(b.layout_symbol["icon-optional"]),"icon-rotation-alignment":new e(b.layout_symbol["icon-rotation-alignment"]),"icon-size":new f(b.layout_symbol["icon-size"]),"icon-text-fit":new e(b.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new e(b.layout_symbol["icon-text-fit-padding"]),"icon-image":new f(b.layout_symbol["icon-image"]),"icon-rotate":new f(b.layout_symbol["icon-rotate"]),"icon-padding":new e(b.layout_symbol["icon-padding"]),"icon-keep-upright":new e(b.layout_symbol["icon-keep-upright"]),"icon-offset":new f(b.layout_symbol["icon-offset"]),"icon-anchor":new f(b.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new e(b.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new e(b.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new e(b.layout_symbol["text-rotation-alignment"]),"text-field":new f(b.layout_symbol["text-field"]),"text-font":new f(b.layout_symbol["text-font"]),"text-size":new f(b.layout_symbol["text-size"]),"text-max-width":new f(b.layout_symbol["text-max-width"]),"text-line-height":new e(b.layout_symbol["text-line-height"]),"text-letter-spacing":new f(b.layout_symbol["text-letter-spacing"]),"text-justify":new f(b.layout_symbol["text-justify"]),"text-radial-offset":new f(b.layout_symbol["text-radial-offset"]),"text-variable-anchor":new e(b.layout_symbol["text-variable-anchor"]),"text-anchor":new f(b.layout_symbol["text-anchor"]),"text-max-angle":new e(b.layout_symbol["text-max-angle"]),"text-writing-mode":new e(b.layout_symbol["text-writing-mode"]),"text-rotate":new f(b.layout_symbol["text-rotate"]),"text-padding":new e(b.layout_symbol["text-padding"]),"text-keep-upright":new e(b.layout_symbol["text-keep-upright"]),"text-transform":new f(b.layout_symbol["text-transform"]),"text-offset":new f(b.layout_symbol["text-offset"]),"text-allow-overlap":new e(b.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new e(b.layout_symbol["text-ignore-placement"]),"text-optional":new e(b.layout_symbol["text-optional"])}),dV=new p({"icon-opacity":new f(b.paint_symbol["icon-opacity"]),"icon-color":new f(b.paint_symbol["icon-color"]),"icon-halo-color":new f(b.paint_symbol["icon-halo-color"]),"icon-halo-width":new f(b.paint_symbol["icon-halo-width"]),"icon-halo-blur":new f(b.paint_symbol["icon-halo-blur"]),"icon-translate":new e(b.paint_symbol["icon-translate"]),"icon-translate-anchor":new e(b.paint_symbol["icon-translate-anchor"]),"text-opacity":new f(b.paint_symbol["text-opacity"]),"text-color":new f(b.paint_symbol["text-color"],{runtimeType:Q,getOverride:function(a){return a.textColor},hasOverride:function(a){return!!a.textColor}}),"text-halo-color":new f(b.paint_symbol["text-halo-color"]),"text-halo-width":new f(b.paint_symbol["text-halo-width"]),"text-halo-blur":new f(b.paint_symbol["text-halo-blur"]),"text-translate":new e(b.paint_symbol["text-translate"]),"text-translate-anchor":new e(b.paint_symbol["text-translate-anchor"])}),jg={paint:dV,layout:dU},aH=function(a){this.type=a.property.overrides?a.property.overrides.runtimeType:cv,this.defaultValue=a};aH.prototype.evaluate=function(a){if(a.formattedSection){var b=this.defaultValue.property.overrides;if(b&&b.hasOverride(a.formattedSection))return b.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default},aH.prototype.eachChild=function(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)},aH.prototype.outputDefined=function(){return!1},aH.prototype.serialize=function(){return null},c("FormatSectionOverride",aH,{omit:["defaultValue"]});var dW=function(b){function a(a){b.call(this,a,jg)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.recalculate=function(g,h){if(b.prototype.recalculate.call(this,g,h),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var d=this.layout.get("text-writing-mode");if(d){for(var a=[],c=0,e=d;c<e.length;c+=1){var f=e[c];0>a.indexOf(f)&&a.push(f)}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},a.prototype.getValueAndResolveTokens=function(b,c,e,f){var g,a=this.layout.get(b).evaluate(c,{},e,f),d=this._unevaluatedLayout._values[b];return d.isDataDriven()||fN(d.value)||!a?a:(g=c.properties,a.replace(/{([^{}]+)}/g,function(b,a){return a in g?String(g[a]):""}))},a.prototype.createBucket=function(a){return new h(a)},a.prototype.queryRadius=function(){return 0},a.prototype.queryIntersectsFeature=function(){return!1},a.prototype._setPaintOverrides=function(){for(var c=0,e=jg.paint.overridableProperties;c<e.length;c+=1){var d=e[c];if(a.hasPaintOverride(this.layout,d)){var b=this.paint.get(d),h=new aH(b),f=new a$(h,b.property.specification),g=null;g="constant"===b.value.kind||"source"===b.value.kind?new a_("source",f):new aN("composite",f,b.value.zoomStops,b.value._interpolationType),this.paint._values[d]=new a3(b.property,g,b.parameters)}}},a.prototype._handleOverridablePaintPropertyUpdate=function(b,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&a.hasPaintOverride(this.layout,b)},a.hasPaintOverride=function(c,d){var a=c.get("text-field"),h=jg.paint.properties[d],e=!1,f=function(c){for(var a=0,b=c;a<b.length;a+=1){var d=b[a];if(h.overrides&&h.overrides.hasOverride(d)){e=!0;return}}};if("constant"===a.value.kind&&a.value.value instanceof aw)f(a.value.value.sections);else if("source"===a.value.kind){var g=function(a){e||(a instanceof S&&eU(a.value)===cx?f(a.value.sections):a instanceof T?f(a.sections):a.eachChild(g))},b=a.value;b._styleExpression&&g(b._styleExpression.expression)}return e},a}(x),dX=new p({"background-color":new e(b.paint_background["background-color"]),"background-pattern":new ak(b.paint_background["background-pattern"]),"background-opacity":new e(b.paint_background["background-opacity"])}),jh={paint:dX},dY=function(b){function a(a){b.call(this,a,jh)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a}(x),dZ=new p({"raster-opacity":new e(b.paint_raster["raster-opacity"]),"raster-hue-rotate":new e(b.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new e(b.paint_raster["raster-brightness-min"]),"raster-brightness-max":new e(b.paint_raster["raster-brightness-max"]),"raster-saturation":new e(b.paint_raster["raster-saturation"]),"raster-contrast":new e(b.paint_raster["raster-contrast"]),"raster-resampling":new e(b.paint_raster["raster-resampling"]),"raster-fade-duration":new e(b.paint_raster["raster-fade-duration"])}),ji={paint:dZ},d$=function(b){function a(a){b.call(this,a,ji)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a}(x),jj=function(b){function a(a){b.call(this,a,{}),this.implementation=a}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},a.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},a.prototype.recalculate=function(){},a.prototype.updateTransitions=function(){},a.prototype.hasTransition=function(){},a.prototype.serialize=function(){},a.prototype.onAdd=function(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},a.prototype.onRemove=function(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},a}(x),jk={circle:dq,heatmap:ds,hillshade:dt,fill:dx,"fill-extrusion":dC,line:dI,symbol:dW,background:dY,raster:d$},jl=self.HTMLImageElement,jm=self.HTMLCanvasElement,jn=self.HTMLVideoElement,jo=self.ImageData,jp=self.ImageBitmap,aI=function(a,b,c,d){this.context=a,this.format=c,this.texture=a.gl.createTexture(),this.update(b,d)};aI.prototype.update=function(b,c,g){var d=b.width,e=b.height,k=(!this.size||this.size[0]!==d||this.size[1]!==e)&&!g,f=this.context,a=f.gl;if(this.useMipmap=Boolean(c&&c.useMipmap),a.bindTexture(a.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===a.RGBA&&(!c|| !1!==c.premultiply)),k)this.size=[d,e],b instanceof jl||b instanceof jm||b instanceof jn||b instanceof jo||jp&&b instanceof jp?a.texImage2D(a.TEXTURE_2D,0,this.format,this.format,a.UNSIGNED_BYTE,b):a.texImage2D(a.TEXTURE_2D,0,this.format,d,e,0,this.format,a.UNSIGNED_BYTE,b.data);else{var h=g||{x:0,y:0},i=h.x,j=h.y;b instanceof jl||b instanceof jm||b instanceof jn||b instanceof jo||jp&&b instanceof jp?a.texSubImage2D(a.TEXTURE_2D,0,i,j,a.RGBA,a.UNSIGNED_BYTE,b):a.texSubImage2D(a.TEXTURE_2D,0,i,j,d,e,a.RGBA,a.UNSIGNED_BYTE,b.data)}this.useMipmap&&this.isSizePowerOfTwo()&&a.generateMipmap(a.TEXTURE_2D)},aI.prototype.bind=function(b,c,d){var a=this.context.gl;a.bindTexture(a.TEXTURE_2D,this.texture),d!==a.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=a.LINEAR),b!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d||b),this.filter=b),c!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,c),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,c),this.wrap=c)},aI.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},aI.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var bX=function(a){var b=this;this._callback=a,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){b._triggered=!1,b._callback()})};bX.prototype.trigger=function(){var a=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){a._triggered=!1,a._callback()},0))},bX.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ar=function(a,b,c){this.target=a,this.parent=b,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},b7(["receive","process"],this),this.invoker=new bX(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=cd()?a:self};function jq(b,c,d){var a=2*Math.PI*6378137/256/Math.pow(2,d);return[b*a-2*Math.PI*6378137/2,c*a-2*Math.PI*6378137/2]}ar.prototype.send=function(e,f,a,g,b){var h=this;void 0===b&&(b=!1);var c=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[c]=a);var d=eh(this.globalScope)?void 0:[];return this.target.postMessage({id:c,type:e,hasCallback:!!a,targetMapId:g,mustQueue:b,sourceMapId:this.mapId,data:gg(f,d)},d),{cancel:function(){a&&delete h.callbacks[c],h.target.postMessage({id:c,type:"<cancel>",targetMapId:g,sourceMapId:h.mapId})}}},ar.prototype.receive=function(d){var a=d.data,b=a.id;if(b&&(!a.targetMapId||this.mapId===a.targetMapId))if("<cancel>"===a.type){delete this.tasks[b];var c=this.cancelCallbacks[b];delete this.cancelCallbacks[b],c&&c()}else cd()||a.mustQueue?(this.tasks[b]=a,this.taskQueue.push(b),this.invoker.trigger()):this.processTask(b,a)},ar.prototype.process=function(){if(this.taskQueue.length){var a=this.taskQueue.shift(),b=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),b&&this.processTask(a,b)}},ar.prototype.processTask=function(c,a){var i=this;if("<response>"===a.type){var d=this.callbacks[c];delete this.callbacks[c],d&&(a.error?d(gh(a.error)):d(null,gh(a.data)))}else{var h=!1,j=eh(this.globalScope)?void 0:[],e=a.hasCallback?function(a,b){h=!0,delete i.cancelCallbacks[c],i.target.postMessage({id:c,type:"<response>",sourceMapId:i.mapId,error:a?gg(a):null,data:gg(b,j)},j)}:function(a){h=!0},b=null,f=gh(a.data);if(this.parent[a.type])b=this.parent[a.type](a.sourceMapId,f,e);else if(this.parent.getWorkerSource){var g=a.type.split(".");b=this.parent.getWorkerSource(a.sourceMapId,g[0],f.source)[g[1]](f,e)}else e(new Error("Could not find function "+a.type));!h&&b&&b.cancel&&(this.cancelCallbacks[c]=b.cancel)}},ar.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var n=function(a,b){a&&(b?this.setSouthWest(a).setNorthEast(b):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};n.prototype.setNorthEast=function(a){return this._ne=a instanceof P?new P(a.lng,a.lat):P.convert(a),this},n.prototype.setSouthWest=function(a){return this._sw=a instanceof P?new P(a.lng,a.lat):P.convert(a),this},n.prototype.extend=function(a){var b,c,d=this._sw,e=this._ne;if(a instanceof P)b=a,c=a;else if(a instanceof n){if(b=a._sw,c=a._ne,!b||!c)return this}else{if(Array.isArray(a)){if(4===a.length||a.every(Array.isArray)){var f=a;return this.extend(n.convert(f))}var g=a;return this.extend(P.convert(g))}return this}return d||e?(d.lng=Math.min(b.lng,d.lng),d.lat=Math.min(b.lat,d.lat),e.lng=Math.max(c.lng,e.lng),e.lat=Math.max(c.lat,e.lat)):(this._sw=new P(b.lng,b.lat),this._ne=new P(c.lng,c.lat)),this},n.prototype.getCenter=function(){return new P((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},n.prototype.getSouthWest=function(){return this._sw},n.prototype.getNorthEast=function(){return this._ne},n.prototype.getNorthWest=function(){return new P(this.getWest(),this.getNorth())},n.prototype.getSouthEast=function(){return new P(this.getEast(),this.getSouth())},n.prototype.getWest=function(){return this._sw.lng},n.prototype.getSouth=function(){return this._sw.lat},n.prototype.getEast=function(){return this._ne.lng},n.prototype.getNorth=function(){return this._ne.lat},n.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},n.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},n.prototype.isEmpty=function(){return!(this._sw&&this._ne)},n.prototype.contains=function(e){var b=P.convert(e),a=b.lng,c=b.lat,f=this._sw.lat<=c&&c<=this._ne.lat,d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),f&&d},n.convert=function(a){return!a||a instanceof n?a:new n(a)};var P=function(a,b){if(isNaN(a)||isNaN(b))throw new Error("Invalid LngLat object: ("+a+", "+b+")");if(this.lng=+a,this.lat=+b,this.lat>90||this.lat< -90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};P.prototype.wrap=function(){return new P(b4(this.lng,-180,180),this.lat)},P.prototype.toArray=function(){return[this.lng,this.lat]},P.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},P.prototype.distanceTo=function(b){var a=Math.PI/180,c=this.lat*a,d=b.lat*a,e=Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((b.lng-this.lng)*a);return 6371008.8*Math.acos(Math.min(e,1))},P.prototype.toBounds=function(a){void 0===a&&(a=0);var b=360*a/40075017,c=b/Math.cos(Math.PI/180*this.lat);return new n(new P(this.lng-c,this.lat-b),new P(this.lng+c,this.lat+b))},P.convert=function(a){if(a instanceof P)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new P(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new P(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var jr=2*Math.PI*6371008.8;function js(a){return jr*Math.cos(a*Math.PI/180)}function d_(a){return(180+a)/360}function d0(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function d1(a,b){return a/js(b)}function jt(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}var aJ=function(b,c,a){void 0===a&&(a=0),this.x=+b,this.y=+c,this.z=+a};aJ.fromLngLat=function(c,a){void 0===a&&(a=0);var b=P.convert(c);return new aJ(d_(b.lng),d0(b.lat),d1(a,b.lat))},aJ.prototype.toLngLat=function(){return new P(360*this.x-180,jt(this.y))},aJ.prototype.toAltitude=function(){return this.z*js(jt(this.y))},aJ.prototype.meterInMercatorCoordinateUnits=function(){return 1/jr*(1/Math.cos(jt(this.y)*Math.PI/180))};var as=function(a,b,c){this.z=a,this.x=b,this.y=c,this.key=ju(0,a,a,b,c)};as.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},as.prototype.url=function(f,g){var b,a,c,d,e,h=(b=this.x,a=this.y,d=jq(256*b,256*(a=Math.pow(2,c=this.z)-a-1),c),e=jq((b+1)*256,(a+1)*256,c),d[0]+","+d[1]+","+e[0]+","+e[1]),i=jv(this.z,this.x,this.y);return f[(this.x+this.y)%f.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===g?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",i).replace("{bbox-epsg-3857}",h)},as.prototype.getTilePoint=function(a){var b=Math.pow(2,this.z);return new aY((a.x*b-this.x)*8192,(a.y*b-this.y)*8192)},as.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var d2=function(b,a){this.wrap=b,this.canonical=a,this.key=ju(b,a.z,a.z,a.x,a.y)},r=function(a,b,c,d,e){this.overscaledZ=a,this.wrap=b,this.canonical=new as(c,+d,+e),this.key=ju(b,a,c,d,e)};function ju(a,d,c,e,f){(a*=2)<0&&(a=-1*a-1);var b=1<<c;return(b*b*a+b*f+e).toString(36)+c.toString(36)+d.toString(36)}function jv(d,e,f){for(var b,c="",a=d;a>0;a--)c+=(e&(b=1<<a-1)?1:0)+(f&b?2:0);return c}r.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},r.prototype.scaledTo=function(a){var b=this.canonical.z-a;return a>this.canonical.z?new r(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new r(a,this.wrap,a,this.canonical.x>>b,this.canonical.y>>b)},r.prototype.calculateScaledKey=function(a,b){var c=this.canonical.z-a;return a>this.canonical.z?ju(this.wrap*+b,a,this.canonical.z,this.canonical.x,this.canonical.y):ju(this.wrap*+b,a,a,this.canonical.x>>c,this.canonical.y>>c)},r.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var b=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>b&&a.canonical.y===this.canonical.y>>b},r.prototype.children=function(d){if(this.overscaledZ>=d)return[new r(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var a=this.canonical.z+1,b=2*this.canonical.x,c=2*this.canonical.y;return[new r(a,this.wrap,a,b,c),new r(a,this.wrap,a,b+1,c),new r(a,this.wrap,a,b,c+1),new r(a,this.wrap,a,b+1,c+1)]},r.prototype.isLessThan=function(a){return this.wrap<a.wrap|| !(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ|| !(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x|| !(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},r.prototype.wrapped=function(){return new r(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},r.prototype.unwrapTo=function(a){return new r(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},r.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},r.prototype.toUnwrapped=function(){return new d2(this.wrap,this.canonical)},r.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},r.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new aJ(a.x-this.wrap,a.y))},c("CanonicalTileID",as),c("OverscaledTileID",r,{omit:["posMatrix"]});var F=function(e,c,d){if(this.uid=e,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&"mapbox"!==d&&"terrarium"!==d)return cc('"'+d+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=c.height;var a=this.dim=c.height-2;this.data=new Uint32Array(c.data.buffer),this.encoding=d||"mapbox";for(var b=0;b<a;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(a,b)]=this.data[this._idx(a-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,a)]=this.data[this._idx(b,a-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(a,-1)]=this.data[this._idx(a-1,0)],this.data[this._idx(-1,a)]=this.data[this._idx(0,a-1)],this.data[this._idx(a,a)]=this.data[this._idx(a-1,a-1)]};F.prototype.get=function(c,d){var a=new Uint8Array(this.data.buffer),b=4*this._idx(c,d);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(a[b],a[b+1],a[b+2])},F.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},F.prototype._idx=function(a,b){if(a< -1||a>=this.dim+1||b< -1||b>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(b+1)*this.stride+(a+1)},F.prototype._unpackMapbox=function(a,b,c){return(65536*a+256*b+c)/10-1e4},F.prototype._unpackTerrarium=function(a,b,c){return 256*a+b+c/256-32768},F.prototype.getPixels=function(){return new ap({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},F.prototype.backfillBorder=function(i,a,b){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");var e=a*this.dim,f=a*this.dim+this.dim,g=b*this.dim,h=b*this.dim+this.dim;switch(a){case -1:e=f-1;break;case 1:f=e+1;break}switch(b){case -1:g=h-1;break;case 1:h=g+1;break}for(var j=-a*this.dim,k=-b*this.dim,c=g;c<h;c++)for(var d=e;d<f;d++)this.data[this._idx(d,c)]=i.data[this._idx(d+j,c+k)]},c("DEMData",F);var bj=function(b){this._stringToNumber={},this._numberToString=[];for(var a=0;a<b.length;a++){var c=b[a];this._stringToNumber[c]=a,this._numberToString[a]=c}};bj.prototype.encode=function(a){return this._stringToNumber[a]},bj.prototype.decode=function(a){return this._numberToString[a]};var bY=function(a,b,c,d,e){this.type="Feature",this._vectorTileFeature=a,a._z=b,a._x=c,a._y=d,this.properties=a.properties,this.id=e},bk={geometry:{configurable:!0}};bk.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},bk.geometry.set=function(a){this._geometry=a},bY.prototype.toJSON=function(){var b={geometry:this.geometry};for(var a in this)"_geometry"!==a&&"_vectorTileFeature"!==a&&(b[a]=this[a]);return b},Object.defineProperties(bY.prototype,bk);var at=function(){this.state={},this.stateChanges={},this.deletedStates={}};at.prototype.updateState=function(a,g,c){var b=String(g);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][b]=this.stateChanges[a][b]||{},b5(this.stateChanges[a][b],c),null===this.deletedStates[a])for(var d in this.deletedStates[a]={},this.state[a])d!==b&&(this.deletedStates[a][d]=null);else if(this.deletedStates[a]&&null===this.deletedStates[a][b])for(var e in this.deletedStates[a][b]={},this.state[a][b])c[e]||(this.deletedStates[a][b][e]=null);else for(var f in c)this.deletedStates[a]&&this.deletedStates[a][b]&&null===this.deletedStates[a][b][f]&&delete this.deletedStates[a][b][f]},at.prototype.removeFeatureState=function(a,d,c){if(null!==this.deletedStates[a]){var b=String(d);if(this.deletedStates[a]=this.deletedStates[a]||{},c&& void 0!==d)null!==this.deletedStates[a][b]&&(this.deletedStates[a][b]=this.deletedStates[a][b]||{},this.deletedStates[a][b][c]=null);else if(void 0!==d)if(this.stateChanges[a]&&this.stateChanges[a][b])for(c in this.deletedStates[a][b]={},this.stateChanges[a][b])this.deletedStates[a][b][c]=null;else this.deletedStates[a][b]=null;else this.deletedStates[a]=null}},at.prototype.getState=function(a,b){var c=String(b),f=this.state[a]||{},g=this.stateChanges[a]||{},d=b5({},f[c],g[c]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){var e=this.deletedStates[a][b];if(null===e)return{};for(var h in e)delete d[h]}return d},at.prototype.initializeTileState=function(a,b){a.setFeatureState(this.state,b)},at.prototype.coalesceChanges=function(h,l){var c={};for(var b in this.stateChanges){this.state[b]=this.state[b]||{};var i={};for(var d in this.stateChanges[b])this.state[b][d]||(this.state[b][d]={}),b5(this.state[b][d],this.stateChanges[b][d]),i[d]=this.state[b][d];c[b]=i}for(var a in this.deletedStates){this.state[a]=this.state[a]||{};var f={};if(null===this.deletedStates[a])for(var j in this.state[a])f[j]={},this.state[a][j]={};else for(var e in this.deletedStates[a]){if(null===this.deletedStates[a][e])this.state[a][e]={};else for(var g=0,k=Object.keys(this.deletedStates[a][e]);g<k.length;g+=1){var m=k[g];delete this.state[a][e][m]}f[e]=this.state[a][e]}c[a]=c[a]||{},b5(c[a],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(var n in h)h[n].setFeatureState(c,l)};var G=function(a,b){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new a1(8192,16,0),this.grid3D=new a1(8192,16,0),this.featureIndexArray=new db,this.promoteId=b};function jw(a,b,c,d,e){return b9(a,function(g,f){var a=b instanceof c2?b.get(f):null;return a&&a.evaluate?a.evaluate(c,d,e):a})}function jx(h){for(var b=1/0,c=1/0,d=-1/0,e=-1/0,f=0,g=h;f<g.length;f+=1){var a=g[f];b=Math.min(b,a.x),c=Math.min(c,a.y),d=Math.max(d,a.x),e=Math.max(e,a.y)}return{minX:b,minY:c,maxX:d,maxY:e}}function jy(a,b){return b-a}G.prototype.insert=function(m,e,g,h,i,j){var k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,h,i);for(var l=j?this.grid3D:this.grid,c=0;c<e.length;c++){for(var f=e[c],a=[1/0,1/0,-1/0,-1/0],d=0;d<f.length;d++){var b=f[d];a[0]=Math.min(a[0],b.x),a[1]=Math.min(a[1],b.y),a[2]=Math.max(a[2],b.x),a[3]=Math.max(a[3],b.y)}a[0]<8192&&a[1]<8192&&a[2]>=0&&a[3]>=0&&l.insert(k,a[0],a[1],a[2],a[3])}},G.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new aC.VectorTile(new bS(this.rawTileData)).layers,this.sourceLayerCoder=new bj(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},G.prototype.query=function(b,o,p,q){var r,s=this;this.loadVTLayers();for(var i=b.params||{},j=8192/b.tileSize/b.scale,t=cR(i.filter),k=b.queryGeometry,a=b.queryPadding*j,c=jx(k),e=this.grid.query(c.minX-a,c.minY-a,c.maxX+a,c.maxY+a),d=jx(b.cameraQueryGeometry),l=this.grid3D.query(d.minX-a,d.minY-a,d.maxX+a,d.maxY+a,function(c,d,e,f){return function(a,d,e,f,g){for(var h=0,j=a;h<j.length;h+=1){var b=j[h];if(d<=b.x&&e<=b.y&&f>=b.x&&g>=b.y)return!0}var k=[new aY(d,e),new aY(d,g),new aY(f,g),new aY(f,e)];if(a.length>2){for(var i=0,l=k;i<l.length;i+=1)if(gX(a,l[i]))return!0}for(var c=0;c<a.length-1;c++){var m=a[c],n=a[c+1];if(gY(m,n,k))return!0}return!1}(b.cameraQueryGeometry,c-a,d-a,e+a,f+a)}),f=0,h=l;f<h.length;f+=1){var m=h[f];e.push(m)}e.sort(jy);for(var n={},g=0;g<e.length;g++)!function(d){var a=e[d];if(a!==r){r=a;var c=s.featureIndexArray.get(a),f=null;s.loadMatchingFeature(n,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,t,i.layers,i.availableImages,o,p,q,function(a,c,d){return f||(f=gN(a)),c.queryIntersectsFeature(k,a,d,f,s.z,b.transform,j,b.pixelPosMatrix)})}}(g);return n},G.prototype.loadMatchingFeature=function(k,s,t,l,u,e,m,v,w,n,o){var g=this.bucketLayerIDs[s];if(!e||function(b,c){for(var a=0;a<b.length;a++)if(c.indexOf(b[a])>=0)return!0;return!1}(e,g)){var p=this.sourceLayerCoder.decode(t),a=this.vtLayers[p].feature(l);if(u.filter(new aP(this.tileID.overscaledZ),a))for(var h=this.getId(a,p),i=0;i<g.length;i++){var b=g[i];if(!(e&&0>e.indexOf(b))){var c=v[b];if(c){var f={};void 0!==h&&n&&(f=n.getState(c.sourceLayer||"_geojsonTileLayer",h));var d=w[b];d.paint=jw(d.paint,c.paint,a,f,m),d.layout=jw(d.layout,c.layout,a,f,m);var q=!o||o(a,c,f);if(q){var r=new bY(a,this.z,this.x,this.y,h);r.layer=d;var j=k[b];void 0===j&&(j=k[b]=[]),j.push({featureIndex:l,feature:r,intersectionZ:q})}}}}}},G.prototype.lookupSymbolFeatures=function(d,e,f,g,h,i,j,k){var b={};this.loadVTLayers();for(var l=cR(h),a=0,c=d;a<c.length;a+=1){var m=c[a];this.loadMatchingFeature(b,f,g,m,l,i,j,k,e)}return b},G.prototype.hasLayer=function(e){for(var a=0,c=this.bucketLayerIDs;a<c.length;a+=1)for(var f=c[a],b=0,d=f;b<d.length;b+=1)if(e===d[b])return!0;return!1},G.prototype.getId=function(b,c){var a=b.id;if(this.promoteId){var d="string"==typeof this.promoteId?this.promoteId:this.promoteId[c];"boolean"==typeof(a=b.properties[d])&&(a=Number(a))}return a},c("FeatureIndex",G,{omit:["rawTileData","sourceLayerCoder"]});var l=function(a,b){this.tileID=a,this.uid=b6(),this.uses=0,this.tileSize=b,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};l.prototype.registerFadeDuration=function(b){var a=b+this.timeAdded;!(a<cf.now())&&(this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a))},l.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},l.prototype.loadVectorData=function(a,b,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!a){this.collisionBoxArray=new bN;return}for(var g in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(c,d){var a={};if(!d)return a;for(var e=function(){var i,c=f[b],e=c.layerIds.map(function(a){return d.getLayer(a)}).filter(Boolean);if(0!==e.length){c.layers=e,c.stateDependentLayerIds&&(c.stateDependentLayers=c.stateDependentLayerIds.map(function(a){return e.filter(function(b){return b.id===a})[0]}));for(var g=0,h=e;g<h.length;g+=1)a[h[g].id]=c}},b=0,f=c;b<f.length;b+=1)e();return a}(a.buckets,b.style),this.hasSymbolBuckets=!1,this.buckets){var c=this.buckets[g];if(c instanceof h)if(this.hasSymbolBuckets=!0,f)c.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var i in this.buckets){var d=this.buckets[i];if(d instanceof h&&d.hasRTLText){this.hasRTLText=!0,gx();break}}for(var e in this.queryPadding=0,this.buckets){var j=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(e).queryRadius(j))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)},l.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},l.prototype.getBucket=function(a){return this.buckets[a.id]},l.prototype.upload=function(a){for(var d in this.buckets){var b=this.buckets[d];b.uploadPending()&&b.upload(a)}var c=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new aI(a,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new aI(a,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)},l.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)},l.prototype.queryRenderedFeatures=function(a,b,c,d,e,f,g,h,i,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:e,scale:f,tileSize:this.tileSize,pixelPosMatrix:j,transform:h,params:g,queryPadding:this.queryPadding*i},a,b,c):{}},l.prototype.querySourceFeatures=function(m,a){var b=this.latestFeatureIndex;if(b&&b.rawTileData){var g=b.loadVTLayers(),h=a?a.sourceLayer:"",c=g._geojsonTileLayer||g[h];if(c)for(var n=cR(a&&a.filter),d=this.tileID.canonical,i=d.z,j=d.x,k=d.y,o={z:i,x:j,y:k},e=0;e<c.length;e++){var f=c.feature(e);if(n.filter(new aP(this.tileID.overscaledZ),f)){var p=b.getId(f,h),l=new bY(f,i,j,k,p);l.tile=o,m.push(l)}}}},l.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},l.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},l.prototype.setExpiryData=function(b){var c=this.expirationTime;if(b.cacheControl){var d=ef(b.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else b.expires&&(this.expirationTime=new Date(b.expires).getTime());if(this.expirationTime){var e=Date.now(),a=!1;if(this.expirationTime>e)a=!1;else if(c)if(this.expirationTime<c)a=!0;else{var f=this.expirationTime-c;f?this.expirationTime=e+Math.max(f,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},l.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),2147483647)},l.prototype.setFeatureState=function(e,a){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var i=this.latestFeatureIndex.loadVTLayers();for(var b in this.buckets)if(a.style.hasLayer(b)){var c=this.buckets[b],f=c.layers[0].sourceLayer||"_geojsonTileLayer",g=i[f],d=e[f];if(g&&d&&0!==Object.keys(d).length){c.update(d,g,this.imageAtlas&&this.imageAtlas.patternPositions||{});var h=a&&a.style&&a.style.getLayer(b);h&&(this.queryPadding=Math.max(this.queryPadding,h.queryRadius(c)))}}}},l.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},l.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<cf.now()},l.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},l.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=cf.now()+a},l.prototype.setDependencies=function(d,e){for(var b={},a=0,c=e;a<c.length;a+=1)b[c[a]]=!0;this.dependencies[d]=b},l.prototype.hasDependency=function(f,g){for(var a=0,c=f;a<c.length;a+=1){var h=c[a],d=this.dependencies[h];if(d){for(var b=0,e=g;b<e.length;b+=1)if(d[e[b]])return!0}}return!1};var jz=self.performance,bZ=function(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},jz.mark(this._marks.start)};bZ.prototype.finish=function(){jz.mark(this._marks.end);var a=jz.getEntriesByName(this._marks.measure);return 0===a.length&&(jz.measure(this._marks.measure,this._marks.start,this._marks.end),a=jz.getEntriesByName(this._marks.measure),jz.clearMarks(this._marks.start),jz.clearMarks(this._marks.end),jz.clearMeasures(this._marks.measure)),a},a.Actor=ar,a.AlphaImage=aB,a.CanonicalTileID=as,a.CollisionBoxArray=bN,a.Color=s,a.DEMData=F,a.DataConstantProperty=e,a.DictionaryCoder=bj,a.EXTENT=8192,a.ErrorEvent=cs,a.EvaluationParameters=aP,a.Event=bq,a.Evented=A,a.FeatureIndex=G,a.FillBucket=y,a.FillExtrusionBucket=z,a.ImageAtlas=aF,a.ImagePosition=bh,a.LineBucket=o,a.LngLat=P,a.LngLatBounds=n,a.MercatorCoordinate=aJ,a.ONE_EM=dK,a.OverscaledTileID=r,a.Point=aY,a.Point$1=aY,a.Properties=p,a.Protobuf=bS,a.RGBAImage=ap,a.RequestManager=u,a.RequestPerformance=bZ,a.ResourceType=bp,a.SegmentVector=N,a.SourceFeatureState=at,a.StructArrayLayout1ui2=be,a.StructArrayLayout2f1f2i16=a7,a.StructArrayLayout2i4=a4,a.StructArrayLayout3ui6=a8,a.StructArrayLayout4i8=a5,a.SymbolBucket=h,a.Texture=aI,a.Tile=l,a.Transitionable=J,a.Uniform1f=de,a.Uniform1i=dd,a.Uniform2f=df,a.Uniform3f=dg,a.Uniform4f=dh,a.UniformColor=di,a.UniformMatrix4f=dj,a.UnwrappedTileID=d2,a.ValidationError=ct,a.WritingMode=dM,a.ZoomHistory=by,a.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a},a.addDynamicAttributes=bW,a.asyncAll=function(a,c,b){if(!a.length)return b(null,[]);var d=a.length,e=new Array(a.length),f=null;a.forEach(function(a,g){c(a,function(a,c){a&&(f=a),e[g]=c,0== --d&&b(f,e)})})},a.bezier=bm,a.bindAll=b7,a.browser=cf,a.cacheEntryPossiblyAdded=function(a){eB++,eB>ey&&(a.getActor().send("enforceCacheSizeLimit",ex),eB=0)},a.clamp=b3,a.clearTileCache=function(a){var b=self.caches.delete(ew);a&&b.catch(a).then(function(){return a()})},a.clipLine=dR,a.clone=function(b){var a=new ao(16);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},a.clone$1=cb,a.clone$2=function(b){var a=new ao(3);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a},a.collisionCircleLayout=dJ,a.config=cg,a.create=function(){var a=new ao(16);return ao!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},a.create$1=function(){var a=new ao(9);return ao!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},a.create$2=function(){var a=new ao(4);return ao!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},a.createCommonjsModule=aK,a.createExpression=cL,a.createLayout=m,a.createStyleLayer=function(a){return"custom"===a.type?new jj(a):new jk[a.type](a)},a.cross=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];return a[0]=e*i-f*h,a[1]=f*g-d*i,a[2]=d*h-e*g,a},a.deepEqual=b1,a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},a.dot$1=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},a.ease=b2,a.emitValidationErrors=cW,a.endsWith=b8,a.enforceCacheSizeLimit=function(a){ez(),d5&&d5.then(function(b){b.keys().then(function(d){for(var c=0;c<d.length-a;c++)b.delete(d[c])})})},a.evaluateSizeForFeature=bU,a.evaluateSizeForZoom=bV,a.evaluateVariableOffset=dS,a.evented=c$,a.extend=b5,a.featureFilter=cR,a.filterObject=ca,a.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},a.getAnchorAlignment=dN,a.getAnchorJustification=dT,a.getArrayBuffer=cq,a.getImage=cr,a.getJSON=function(a,b){return cp(b5(a,{type:"json"}),b)},a.getRTLTextPluginStatus=c_,a.getReferrer=co,a.getVideo=function(c,e){var a=self.document.createElement("video");a.muted=!0,a.onloadstart=function(){e(null,a)};for(var b=0;b<c.length;b++){var d=self.document.createElement("source");eE(c[b])||(a.crossOrigin="Anonymous"),d.src=c[b],a.appendChild(d)}return{cancel:function(){}}},a.identity=dn,a.invert=function(b,c){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14],s=c[15],t=d*i-e*h,u=d*j-f*h,v=d*k-g*h,w=e*j-f*i,x=e*k-g*i,y=f*k-g*j,z=l*q-m*p,A=l*r-n*p,B=l*s-o*p,C=m*r-n*q,D=m*s-o*q,E=n*s-o*r,a=t*E-u*D+v*C+w*B-x*A+y*z;return a?(a=1/a,b[0]=(i*E-j*D+k*C)*a,b[1]=(f*D-e*E-g*C)*a,b[2]=(q*y-r*x+s*w)*a,b[3]=(n*x-m*y-o*w)*a,b[4]=(j*B-h*E-k*A)*a,b[5]=(d*E-f*B+g*A)*a,b[6]=(r*v-p*y-s*u)*a,b[7]=(l*y-n*v+o*u)*a,b[8]=(h*D-i*B+k*z)*a,b[9]=(e*B-d*D-g*z)*a,b[10]=(p*x-q*v+s*t)*a,b[11]=(m*v-l*x-o*t)*a,b[12]=(i*A-h*C-j*z)*a,b[13]=(d*C-e*A+f*z)*a,b[14]=(q*u-p*w-r*t)*a,b[15]=(l*w-m*u+n*t)*a,b):null},a.isChar=cX,a.isMapboxURL=ci,a.keysDifference=function(c,d){var a=[];for(var b in c)b in d||a.push(b);return a},a.makeRequest=cp,a.mapObject=b9,a.mercatorXfromLng=d_,a.mercatorYfromLat=d0,a.mercatorZfromAltitude=d1,a.mul=bR,a.multiply=bR,a.mvt=aC,a.normalize=function(c,a){var d=a[0],e=a[1],f=a[2],b=d*d+e*e+f*f;return b>0&&(b=1/Math.sqrt(b)),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b,c},a.number=bs,a.offscreenCanvasSupported=cn,a.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},a.parseGlyphPBF=function(a){return new bS(a).readFields(iA,[])},a.pbf=bS,a.performSymbolLayout=function(a,q,r,s,t,i,c){a.createArrays();var j=512*a.overscaling;a.tilePixelRatio=8192/j,a.compareText={},a.iconsNeedLinear=!1;var d=a.layers[0].layout,b=a.layers[0]._unevaluatedLayout._values,e={};if("composite"===a.textSizeData.kind){var f=a.textSizeData,k=f.minZoom,l=f.maxZoom;e.compositeTextSizes=[b["text-size"].possiblyEvaluate(new aP(k),c),b["text-size"].possiblyEvaluate(new aP(l),c)]}if("composite"===a.iconSizeData.kind){var g=a.iconSizeData,m=g.minZoom,n=g.maxZoom;e.compositeIconSizes=[b["icon-size"].possiblyEvaluate(new aP(m),c),b["icon-size"].possiblyEvaluate(new aP(n),c)]}e.layoutTextSize=b["text-size"].possiblyEvaluate(new aP(a.zoom+1),c),e.layoutIconSize=b["icon-size"].possiblyEvaluate(new aP(a.zoom+1),c),e.textMaxSize=b["text-size"].possiblyEvaluate(new aP(18));for(var u=d.get("text-line-height")*dK,v="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),w=d.get("text-keep-upright"),x=d.get("text-size"),o=function(){var b=p[h],y=d.get("text-font").evaluate(b,{},c).join(","),z=x.evaluate(b,{},c),l=e.layoutTextSize.evaluate(b,{},c),O=e.layoutIconSize.evaluate(b,{},c),f={horizontal:{},vertical:void 0},i=b.text,j=[0,0];if(i){var H=i.toString(),P=d.get("text-letter-spacing").evaluate(b,{},c)*dK,A=gj(H)?P:0,m=d.get("text-anchor").evaluate(b,{},c),B=d.get("text-variable-anchor");if(!B){var I=d.get("text-radial-offset").evaluate(b,{},c);j=I?dS(m,[I*dK,i6]):d.get("text-offset").evaluate(b,{},c).map(function(a){return a*dK})}var g=v?"center":d.get("text-justify").evaluate(b,{},c),n=d.get("symbol-placement"),C="point"===n?d.get("text-max-width").evaluate(b,{},c)*dK:0,J=function(){a.allowVerticalPlacement&&gi(H)&&(f.vertical=iD(i,q,r,t,y,C,u,m,"left",A,j,dM.vertical,!0,n,l,z))};if(!v&&B){for(var K="auto"===g?B.map(function(a){return dT(a)}):[g],L=!1,D=0;D<K.length;D++){var o=K[D];if(!f.horizontal[o])if(L)f.horizontal[o]=f.horizontal[0];else{var E=iD(i,q,r,t,y,C,u,"center",o,A,j,dM.horizontal,!1,n,l,z);E&&(f.horizontal[o]=E,L=1===E.positionedLines.length)}}J()}else{"auto"===g&&(g=dT(m));var M=iD(i,q,r,t,y,C,u,m,g,A,j,dM.horizontal,!1,n,l,z);M&&(f.horizontal[g]=M),J(),gi(H)&&v&&w&&(f.vertical=iD(i,q,r,t,y,C,u,m,g,A,j,dM.vertical,!1,n,l,z))}}var F=void 0,N=!1;if(b.icon&&b.icon.name){var k=s[b.icon.name];k&&(F=iN(t[b.icon.name],d.get("icon-offset").evaluate(b,{},c),d.get("icon-anchor").evaluate(b,{},c)),N=k.sdf,void 0===a.sdfIcons?a.sdfIcons=k.sdf:a.sdfIcons!==k.sdf&&cc("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),k.pixelRatio!==a.pixelRatio?a.iconsNeedLinear=!0:0!==d.get("icon-rotate").constantOr(1)&&(a.iconsNeedLinear=!0))}var G=i9(f.horizontal)||f.vertical;a.iconsInText=!!G&&G.iconsInText,(G||F)&&i7(a,b,f,F,s,e,l,O,j,N,c)},h=0,p=a.features;h<p.length;h+=1)o();i&&a.generateCollisionDebugBuffers()},a.perspective=function(a,f,g,c,b){var d,e=1/Math.tan(f/2);return a[0]=e/g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=b&&b!==1/0?(d=1/(c-b),a[10]=(b+c)*d,a[14]=2*b*c*d):(a[10]=-1,a[14]=-2*c),a},a.pick=function(c,d){for(var e={},a=0;a<d.length;a++){var b=d[a];b in c&&(e[b]=c[b])}return e},a.plugin=c0,a.polygonIntersectsPolygon=dk,a.postMapLoadEvent=cm,a.postTurnstileEvent=cl,a.potpack=dL,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=c,a.registerForPluginStateChange=function(a){return a({pluginStatus:gt,pluginURL:gu}),c$.on("pluginStateChange",a),a},a.rotate=function(a,b,e){var f=b[0],g=b[1],h=b[2],i=b[3],c=Math.sin(e),d=Math.cos(e);return a[0]=f*d+h*c,a[1]=g*d+i*c,a[2]=-(f*c)+h*d,a[3]=-(g*c)+i*d,a},a.rotateX=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*d+j*c,a[5]=g*d+k*c,a[6]=h*d+l*c,a[7]=i*d+m*c,a[8]=j*d-f*c,a[9]=k*d-g*c,a[10]=l*d-h*c,a[11]=m*d-i*c,a},a.rotateZ=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*d+j*c,a[1]=g*d+k*c,a[2]=h*d+l*c,a[3]=i*d+m*c,a[4]=j*d-f*c,a[5]=k*d-g*c,a[6]=l*d-h*c,a[7]=m*d-i*c,a},a.scale=function(a,b,f){var c=f[0],d=f[1],e=f[2];return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a[4]=b[4]*d,a[5]=b[5]*d,a[6]=b[6]*d,a[7]=b[7]*d,a[8]=b[8]*e,a[9]=b[9]*e,a[10]=b[10]*e,a[11]=b[11]*e,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},a.scale$1=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a},a.scale$2=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a},a.setCacheLimits=function(a,b){ex=a,ey=b},a.setRTLTextPlugin=function(b,c,a){if(void 0===a&&(a=!1),gt===cY.deferred||gt===cY.loading||gt===cY.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");gu=cf.resolveURL(b),gt=cY.deferred,gs=c,gv(),a||gw()},a.sphericalToCartesian=function(c){var d=c[0],a=c[1],b=c[2];return a+=90,a*=Math.PI/180,b*=Math.PI/180,{x:d*Math.cos(a)*Math.sin(b),y:d*Math.sin(a)*Math.sin(b),z:d*Math.cos(b)}},a.sqrLen=function(a){var b=a[0],c=a[1];return b*b+c*c},a.styleSpec=b,a.sub=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a},a.symbolSize=dQ,a.transformMat3=function(b,c,a){var d=c[0],e=c[1],f=c[2];return b[0]=d*a[0]+e*a[3]+f*a[6],b[1]=d*a[1]+e*a[4]+f*a[7],b[2]=d*a[2]+e*a[5]+f*a[8],b},a.transformMat4=dp,a.translate=function(b,a,f){var g,h,i,j,k,l,m,n,o,p,q,r,c=f[0],d=f[1],e=f[2];return a===b?(b[12]=a[0]*c+a[4]*d+a[8]*e+a[12],b[13]=a[1]*c+a[5]*d+a[9]*e+a[13],b[14]=a[2]*c+a[6]*d+a[10]*e+a[14],b[15]=a[3]*c+a[7]*d+a[11]*e+a[15]):(g=a[0],h=a[1],i=a[2],j=a[3],k=a[4],l=a[5],m=a[6],n=a[7],o=a[8],p=a[9],q=a[10],r=a[11],b[0]=g,b[1]=h,b[2]=i,b[3]=j,b[4]=k,b[5]=l,b[6]=m,b[7]=n,b[8]=o,b[9]=p,b[10]=q,b[11]=r,b[12]=g*c+k*d+o*e+a[12],b[13]=h*c+l*d+p*e+a[13],b[14]=i*c+m*d+q*e+a[14],b[15]=j*c+n*d+r*e+a[15]),b},a.triggerPluginCompletionEvent=cZ,a.uniqueId=b6,a.validateCustomStyleLayer=function(a){var b=[],c=a.id;return void 0===c&&b.push({message:"layers."+c+': missing required property "id"'}),void 0===a.render&&b.push({message:"layers."+c+': missing required method "render"'}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&b.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),b},a.validateLight=cV,a.validateStyle=aO,a.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},a.vectorTile=aC,a.version=b0,a.warnOnce=cc,a.webpSupported=ch,a.window=self,a.wrap=b4}),a(["./shared"],function(c){"use strict";function s(a){var c=typeof a;if("number"===c||"boolean"===c||"string"===c||null==a)return JSON.stringify(a);if(Array.isArray(a)){for(var f="[",d=0,g=a;d<g.length;d+=1)f+=s(g[d])+",";return f+"]"}for(var e=Object.keys(a).sort(),h="{",b=0;b<e.length;b++)h+=JSON.stringify(e[b])+":"+s(a[e[b]])+",";return h+"}"}function t(e){for(var b="",a=0,d=c.refProperties;a<d.length;a+=1)b+="/"+s(e[d[a]]);return b}var i=function(a){this.keyCache={},a&&this.replace(a)};i.prototype.replace=function(a){this._layerConfigs={},this._layers={},this.update(a,[])},i.prototype.update=function(q,r){for(var u=this,d=0,j=q;d<j.length;d+=1){var a=j[d];this._layerConfigs[a.id]=a;var k=this._layers[a.id]=c.createStyleLayer(a);k._featureFilter=c.featureFilter(k.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(var e=0,l=r;e<l.length;e+=1){var f=l[e];delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f]}this.familiesBySource={};for(var s=function(b,c){for(var d={},a=0;a<b.length;a++){var e=c&&c[b[a].id]||t(b[a]);c&&(c[b[a].id]=e);var f=d[e];f||(f=d[e]=[]),f.push(b[a])}var g=[];for(var h in d)g.push(d[h]);return g}(c.values(this._layerConfigs),this.keyCache),g=0,m=s;g<m.length;g+=1){var n=m[g].map(function(a){return u._layers[a.id]}),h=n[0];if("none"!==h.visibility){var o=h.source||"",b=this.familiesBySource[o];b||(b=this.familiesBySource[o]={});var p=h.sourceLayer||"_geojsonTileLayer",i=b[p];i||(i=b[p]=[]),i.push(n)}}};var l=function(d){var e={},f=[];for(var g in d){var h=d[g],q=e[g]={};for(var i in h){var a=h[+i];if(a&&0!==a.bitmap.width&&0!==a.bitmap.height){var j={x:0,y:0,w:a.bitmap.width+2,h:a.bitmap.height+2};f.push(j),q[i]={rect:j,metrics:a.metrics}}}}var k=c.potpack(f),r=k.w,s=k.h,l=new c.AlphaImage({width:r||1,height:s||1});for(var m in d){var n=d[m];for(var o in n){var b=n[+o];if(b&&0!==b.bitmap.width&&0!==b.bitmap.height){var p=e[m][o].rect;c.AlphaImage.copy(b.bitmap,l,{x:0,y:0},{x:p.x+1,y:p.y+1},b.bitmap)}}}this.image=l,this.positions=e};c.register("GlyphAtlas",l);var m=function(a){this.tileID=new c.OverscaledTileID(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.uid=a.uid,this.zoom=a.zoom,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId};function u(d,e,f){for(var g=new c.EvaluationParameters(e),a=0,b=d;a<b.length;a+=1)b[a].recalculate(g,f)}function v(a,b){var d=c.getArrayBuffer(a.request,function(d,a,e,f){d?b(d):a&&b(null,{vectorTile:new c.vectorTile.VectorTile(new c.pbf(a)),rawData:a,cacheControl:e,expires:f})});return function(){d.cancel(),b()}}m.prototype.parse=function(i,w,m,j,E){var F,x,y,z,G=this;this.status="parsing",this.data=i,this.collisionBoxArray=new c.CollisionBoxArray;var A=new c.DictionaryCoder(Object.keys(i.layers).sort()),b=new c.FeatureIndex(this.tileID,this.promoteId);b.bucketLayerIDs=[];var B={},e={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:m},n=w.familiesBySource[this.source];for(var d in n){var f=i.layers[d];if(f){1===f.version&&c.warnOnce('Vector tile source "'+this.source+'" layer "'+d+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var o=A.encode(d),p=[],g=0;g<f.length;g++){var q=f.feature(g),C=b.getId(q,d);p.push({feature:q,id:C,index:g,sourceLayerIndex:o})}for(var k=0,r=n[d];k<r.length;k+=1){var h=r[k],a=h[0];!(a.minzoom&&this.zoom<Math.floor(a.minzoom))&&(a.maxzoom&&this.zoom>=a.maxzoom||"none"!==a.visibility&&(u(h,this.zoom,m),(B[a.id]=a.createBucket({index:b.bucketLayerIDs.length,layers:h,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(p,e,this.tileID.canonical),b.bucketLayerIDs.push(h.map(function(a){return a.id}))))}}}var s=c.mapObject(e.glyphDependencies,function(a){return Object.keys(a).map(Number)});Object.keys(s).length?j.send("getGlyphs",{uid:this.uid,stacks:s},function(a,b){F||(F=a,x=b,D.call(G))}):x={};var t=Object.keys(e.iconDependencies);t.length?j.send("getImages",{icons:t,source:this.source,tileID:this.tileID,type:"icons"},function(a,b){F||(F=a,y=b,D.call(G))}):y={};var v=Object.keys(e.patternDependencies);function D(){if(F)return E(F);if(x&&y&&z){var d=new l(x),f=new c.ImageAtlas(y,z);for(var g in B){var a=B[g];a instanceof c.SymbolBucket?(u(a.layers,this.zoom,m),c.performSymbolLayout(a,x,d.positions,y,f.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):a.hasPattern&&(a instanceof c.LineBucket||a instanceof c.FillBucket||a instanceof c.FillExtrusionBucket)&&(u(a.layers,this.zoom,m),a.addFeatures(e,this.tileID.canonical,f.patternPositions))}this.status="done",E(null,{buckets:c.values(B).filter(function(a){return!a.isEmpty()}),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:d.image,imageAtlas:f,glyphMap:this.returnDependencies?x:null,iconMap:this.returnDependencies?y:null,glyphPositions:this.returnDependencies?d.positions:null})}}v.length?j.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"patterns"},function(a,b){F||(F=a,z=b,D.call(G))}):z={},D.call(this)};var d=function(a,b,c,d){this.actor=a,this.layerIndex=b,this.availableImages=c,this.loadVectorData=d||v,this.loading={},this.loaded={}};d.prototype.loadTile=function(a,e){var f=this,b=a.uid;this.loading||(this.loading={});var g=!!a&&!!a.request&&!!a.request.collectResourceTiming&&new c.RequestPerformance(a.request),d=this.loading[b]=new m(a);d.abort=this.loadVectorData(a,function(h,a){if(delete f.loading[b],h||!a)return d.status="done",f.loaded[b]=d,e(h);var l=a.rawData,i={};a.expires&&(i.expires=a.expires),a.cacheControl&&(i.cacheControl=a.cacheControl);var k={};if(g){var j=g.finish();j&&(k.resourceTiming=JSON.parse(JSON.stringify(j)))}d.vectorTile=a.vectorTile,d.parse(a.vectorTile,f.layerIndex,f.availableImages,f.actor,function(a,b){if(a||!b)return e(a);e(null,c.extend({rawTileData:l.slice(0)},b,i,k))}),f.loaded=f.loaded||{},f.loaded[b]=d})},d.prototype.reloadTile=function(d,f){var g=this,b=this.loaded,e=d.uid,h=this;if(b&&b[e]){var a=b[e];a.showCollisionBoxes=d.showCollisionBoxes;var c=function(c,d){var b=a.reloadCallback;b&&(delete a.reloadCallback,a.parse(a.vectorTile,h.layerIndex,g.availableImages,h.actor,b)),f(c,d)};"parsing"===a.status?a.reloadCallback=c:"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,c):c())}},d.prototype.abortTile=function(c,d){var a=this.loading,b=c.uid;a&&a[b]&&a[b].abort&&(a[b].abort(),delete a[b]),d()},d.prototype.removeTile=function(c,d){var a=this.loaded,b=c.uid;a&&a[b]&&delete a[b],d()};var w=c.window.ImageBitmap,e=function(){this.loaded={}};e.prototype.loadTile=function(a,f){var d=a.uid,g=a.encoding,b=a.rawImageData,h=w&&b instanceof w?this.getImageData(b):b,e=new c.DEMData(d,h,g);this.loaded=this.loaded||{},this.loaded[d]=e,f(null,e)},e.prototype.getImageData=function(a){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(a.width,a.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=a.width,this.offscreenCanvas.height=a.height,this.offscreenCanvasContext.drawImage(a,0,0,a.width,a.height);var b=this.offscreenCanvasContext.getImageData(-1,-1,a.width+2,a.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new c.RGBAImage({width:b.width,height:b.height},b.data)},e.prototype.removeTile=function(c){var a=this.loaded,b=c.uid;a&&a[b]&&delete a[b]};var x=y;function y(b,c){var a,d=b&&b.type;if("FeatureCollection"===d)for(a=0;a<b.features.length;a++)y(b.features[a],c);else if("GeometryCollection"===d)for(a=0;a<b.geometries.length;a++)y(b.geometries[a],c);else if("Feature"===d)y(b.geometry,c);else if("Polygon"===d)z(b.coordinates,c);else if("MultiPolygon"===d)for(a=0;a<b.coordinates.length;a++)z(b.coordinates[a],c);return b}function z(a,c){if(0!==a.length){A(a[0],c);for(var b=1;b<a.length;b++)A(a[b],!c)}}function A(a,f){for(var d=0,b=0,e=a.length,c=e-1;b<e;c=b++)d+=(a[b][0]-a[c][0])*(a[c][1]+a[b][1]);d>=0!= !!f&&a.reverse()}var B=c.vectorTile.VectorTileFeature.prototype.toGeoJSON,j=function(a){this._feature=a,this.extent=c.EXTENT,this.type=a.type,this.properties=a.tags,"id"in a&&!isNaN(a.id)&&(this.id=parseInt(a.id,10))};j.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],a=0,f=this._feature.geometry;a<f.length;a+=1){var g=f[a];e.push([new c.Point$1(g[0],g[1])])}return e}for(var h=[],b=0,i=this._feature.geometry;b<i.length;b+=1){for(var m=i[b],j=[],d=0,k=m;d<k.length;d+=1){var l=k[d];j.push(new c.Point$1(l[0],l[1]))}h.push(j)}return h},j.prototype.toGeoJSON=function(a,b,c){return B.call(this,a,b,c)};var n=function(a){this.layers={"_geojsonTileLayer":this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=a.length,this._features=a};n.prototype.feature=function(a){return new j(this._features[a])};var o=c.vectorTile.VectorTileFeature,p=q;function q(a,b){this.options=b||{},this.features=a,this.length=a.length}function f(a,b){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=b||4096}q.prototype.feature=function(a){return new f(this.features[a],this.options.extent)},f.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var b=0;b<e.length;b++){for(var d=e[b],f=[],a=0;a<d.length;a++)f.push(new c.Point$1(d[a][0],d[a][1]));this.geometry.push(f)}return this.geometry},f.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var h=this.geometry,b=1/0,c=-1/0,d=1/0,e=-1/0,f=0;f<h.length;f++)for(var i=h[f],g=0;g<i.length;g++){var a=i[g];b=Math.min(b,a.x),c=Math.max(c,a.x),d=Math.min(d,a.y),e=Math.max(e,a.y)}return[b,d,c,e]},f.prototype.toGeoJSON=o.prototype.toGeoJSON;var g=r;function r(b){var a=new c.pbf;return C(b,a),a.finish()}function C(a,b){for(var c in a.layers)b.writeMessage(3,D,a.layers[c])}function D(c,b){b.writeVarintField(15,c.version||1),b.writeStringField(1,c.name||""),b.writeVarintField(5,c.extent||4096);var a,d={keys:[],values:[],keycache:{},valuecache:{}};for(a=0;a<c.length;a++)d.feature=c.feature(a),b.writeMessage(2,E,d);var e=d.keys;for(a=0;a<e.length;a++)b.writeStringField(3,e[a]);var f=d.values;for(a=0;a<f.length;a++)b.writeMessage(4,J,f[a])}function E(c,a){var b=c.feature;void 0!==b.id&&a.writeVarintField(1,b.id),a.writeMessage(2,F,c),a.writeVarintField(3,b.type),a.writeMessage(4,I,b)}function F(a,g){var h=a.feature,i=a.keys,j=a.values,k=a.keycache,l=a.valuecache;for(var c in h.properties){var d=k[c];void 0===d&&(i.push(c),d=i.length-1,k[c]=d),g.writeVarint(d);var b=h.properties[c],e=typeof b;"string"!==e&&"boolean"!==e&&"number"!==e&&(b=JSON.stringify(b));var m=e+":"+b,f=l[m];void 0===f&&(j.push(b),f=j.length-1,l[m]=f),g.writeVarint(f)}}function G(a,b){return(b<<3)+(7&a)}function H(a){return a<<1^a>>31}function I(f,a){for(var g=f.loadGeometry(),d=f.type,h=0,i=0,n=g.length,e=0;e<n;e++){var b=g[e],j=1;1===d&&(j=b.length),a.writeVarint(G(1,j));for(var k=3===d?b.length-1:b.length,c=0;c<k;c++){1===c&&1!==d&&a.writeVarint(G(2,k-1));var l=b[c].x-h,m=b[c].y-i;a.writeVarint(H(l)),a.writeVarint(H(m)),h+=l,i+=m}3===d&&a.writeVarint(G(7,1))}}function J(a,b){var c=typeof a;"string"===c?b.writeStringField(1,a):"boolean"===c?b.writeBooleanField(7,a):"number"===c&&(a%1!=0?b.writeDoubleField(3,a):a<0?b.writeSVarintField(6,a):b.writeVarintField(5,a))}function K(c,d,e,a,b,f){if(!(b-a<=e)){var g=a+b>>1;L(c,d,g,a,b,f%2),K(c,d,e,a,g-1,f+1),K(c,d,e,g+1,b,f+1)}}function L(g,b,e,c,d,h){for(;d>c;){if(d-c>600){var f=d-c+1,l=e-c+1,m=Math.log(f),j=.5*Math.exp(2*m/3),n=.5*Math.sqrt(m*j*(f-j)/f)*(l-f/2<0?-1:1),o=Math.max(c,Math.floor(e-l*j/f+n)),p=Math.min(d,Math.floor(e+(f-l)*j/f+n));L(g,b,e,o,p,h)}var k=b[2*e+h],i=c,a=d;for(M(g,b,c,e),b[2*d+h]>k&&M(g,b,c,d);i<a;){for(M(g,b,i,a),i++,a--;b[2*i+h]<k;)i++;for(;b[2*a+h]>k;)a--}b[2*c+h]===k?M(g,b,c,a):(a++,M(g,b,a,d)),a<=e&&(c=a+1),e<=a&&(d=a-1)}}function M(d,c,a,b){N(d,a,b),N(c,2*a,2*b),N(c,2*a+1,2*b+1)}function N(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function O(c,d,e,f){var a=c-e,b=d-f;return a*a+b*b}g.fromVectorTileJs=r,g.fromGeojsonVt=function(d,b){b=b||{};var c={};for(var a in d)c[a]=new p(d[a].features,b),c[a].name=a,c[a].version=b.version,c[a].extent=b.extent;return r({layers:c})},g.GeoJSONWrapper=p;var k=function(b,d,e,c,f){void 0===d&&(d=function(a){return a[0]}),void 0===e&&(e=function(a){return a[1]}),void 0===c&&(c=64),void 0===f&&(f=Float64Array),this.nodeSize=c,this.points=b;for(var i=b.length<65536?Uint16Array:Uint32Array,g=this.ids=new i(b.length),h=this.coords=new f(2*b.length),a=0;a<b.length;a++)g[a]=a,h[2*a]=d(b[a]),h[2*a+1]=e(b[a]);K(g,h,c,0,g.length-1,0)};k.prototype.range=function(a,b,c,d){return function(i,f,j,k,l,m,q){for(var b,c,a=[0,i.length-1,0],n=[];a.length;){var o=a.pop(),g=a.pop(),h=a.pop();if(g-h<=q){for(var d=h;d<=g;d++)b=f[2*d],c=f[2*d+1],b>=j&&b<=l&&c>=k&&c<=m&&n.push(i[d]);continue}var e=Math.floor((h+g)/2);b=f[2*e],c=f[2*e+1],b>=j&&b<=l&&c>=k&&c<=m&&n.push(i[e]);var p=(o+1)%2;(0===o?j<=b:k<=c)&&(a.push(h),a.push(e-1),a.push(p)),(0===o?l>=b:m>=c)&&(a.push(e+1),a.push(g),a.push(p))}return n}(this.ids,this.coords,a,b,c,d,this.nodeSize)},k.prototype.within=function(a,b,c){return function(j,e,f,g,b,q){for(var a=[0,j.length-1,0],k=[],o=b*b;a.length;){var l=a.pop(),h=a.pop(),i=a.pop();if(h-i<=q){for(var c=i;c<=h;c++)O(e[2*c],e[2*c+1],f,g)<=o&&k.push(j[c]);continue}var d=Math.floor((i+h)/2),m=e[2*d],n=e[2*d+1];O(m,n,f,g)<=o&&k.push(j[d]);var p=(l+1)%2;(0===l?f-b<=m:g-b<=n)&&(a.push(i),a.push(d-1),a.push(p)),(0===l?f+b>=m:g+b>=n)&&(a.push(d+1),a.push(h),a.push(p))}return k}(this.ids,this.coords,a,b,c,this.nodeSize)};var P={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(a){return a}},b=function(a){this.options=Y(Object.create(P),a),this.trees=new Array(this.options.maxZoom+1)};function Q(a,b,c,d,e){return{x:a,y:b,zoom:1/0,id:c,parentId:-1,numPoints:d,properties:e}}function R(b,c){var a=b.geometry.coordinates,d=a[0],e=a[1];return{x:U(d),y:V(e),zoom:1/0,index:c,parentId:-1}}function S(a){return{type:"Feature",id:a.id,properties:T(a),geometry:{type:"Point",coordinates:[W(a.x),X(a.y)]}}}function T(b){var a=b.numPoints;return Y(Y({},b.properties),{cluster:!0,cluster_id:b.id,point_count:a,point_count_abbreviated:a>=1e4?Math.round(a/1e3)+"k":a>=1e3?Math.round(a/100)/10+"k":a})}function U(a){return a/360+.5}function V(c){var b=Math.sin(c*Math.PI/180),a=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return a<0?0:a>1?1:a}function W(a){return(a-.5)*360}function X(a){return 360*Math.atan(Math.exp((180-360*a)*Math.PI/180))/Math.PI-90}function Y(a,b){for(var c in b)a[c]=b[c];return a}function Z(a){return a.x}function $(a){return a.y}function _(a,b,c,g){for(var d,f=g,k=c-b>>1,i=c-b,l=a[b],m=a[b+1],n=a[c],o=a[c+1],e=b+3;e<c;e+=3){var h=aa(a[e],a[e+1],l,m,n,o);if(h>f)d=e,f=h;else if(h===f){var j=Math.abs(e-k);j<i&&(d=e,i=j)}}f>g&&(d-b>3&&_(a,b,d,g),a[d+2]=f,c-d>3&&_(a,d,c,g))}function aa(f,g,c,d,h,i){var a=h-c,b=i-d;if(0!==a||0!==b){var e=((f-c)*a+(g-d)*b)/(a*a+b*b);e>1?(c=h,d=i):e>0&&(c+=a*e,d+=b*e)}return(a=f-c)*a+(b=g-d)*b}function ab(a,c,d,e){var b={id:void 0===a?null:a,type:c,geometry:d,tags:e,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return ac(b),b}function ac(d){var b=d.geometry,c=d.type;if("Point"===c||"MultiPoint"===c||"LineString"===c)ad(d,b);else if("Polygon"===c||"MultiLineString"===c)for(var a=0;a<b.length;a++)ad(d,b[a]);else if("MultiPolygon"===c)for(a=0;a<b.length;a++)for(var e=0;e<b[a].length;e++)ad(d,b[a][e])}function ad(a,c){for(var b=0;b<c.length;b+=3)a.minX=Math.min(a.minX,c[b]),a.minY=Math.min(a.minY,c[b+1]),a.maxX=Math.max(a.maxX,c[b]),a.maxY=Math.max(a.maxY,c[b+1])}function ae(i,b,e,j){if(b.geometry){var c=b.geometry.coordinates,f=b.geometry.type,g=Math.pow(e.tolerance/((1<<e.maxZoom)*e.extent),2),d=[],h=b.id;if(e.promoteId?h=b.properties[e.promoteId]:e.generateId&&(h=j||0),"Point"===f)af(c,d);else if("MultiPoint"===f)for(var a=0;a<c.length;a++)af(c[a],d);else if("LineString"===f)ag(c,d,g,!1);else if("MultiLineString"===f){if(e.lineMetrics){for(a=0;a<c.length;a++)d=[],ag(c[a],d,g,!1),i.push(ab(h,"LineString",d,b.properties));return}ah(c,d,g,!1)}else if("Polygon"===f)ah(c,d,g,!0);else if("MultiPolygon"===f)for(a=0;a<c.length;a++){var k=[];ah(c[a],k,g,!0),d.push(k)}else if("GeometryCollection"===f){for(a=0;a<b.geometry.geometries.length;a++)ae(i,{id:h,geometry:b.geometry.geometries[a],properties:b.properties},e,j);return}else throw new Error("Input data is not a valid GeoJSON object.");i.push(ab(h,f,d,b.properties))}}function af(b,a){a.push(ai(b[0])),a.push(aj(b[1])),a.push(0)}function ag(e,a,j,k){for(var f,g,h=0,b=0;b<e.length;b++){var c=ai(e[b][0]),d=aj(e[b][1]);a.push(c),a.push(d),a.push(0),b>0&&(k?h+=(f*d-c*g)/2:h+=Math.sqrt(Math.pow(c-f,2)+Math.pow(d-g,2))),f=c,g=d}var i=a.length-3;a[2]=1,_(a,0,i,j),a[i+2]=1,a.size=Math.abs(h),a.start=0,a.end=a.size}function ah(b,d,e,f){for(var a=0;a<b.length;a++){var c=[];ag(b[a],c,e,f),d.push(c)}}function ai(a){return a/360+.5}function aj(c){var b=Math.sin(c*Math.PI/180),a=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return a<0?0:a>1?1:a}function ak(j,m,d,e,f,n,o,p){if(d/=m,e/=m,n>=d&&o<e)return j;if(o<d||n>=e)return null;for(var i=[],k=0;k<j.length;k++){var c=j[k],h=c.geometry,a=c.type,q=0===f?c.minX:c.minY,r=0===f?c.maxX:c.maxY;if(q>=d&&r<e){i.push(c);continue}if(!(r<d)&&!(q>=e)){var b=[];if("Point"===a||"MultiPoint"===a)al(h,b,d,e,f);else if("LineString"===a)am(h,b,d,e,f,!1,p.lineMetrics);else if("MultiLineString"===a)ao(h,b,d,e,f,!1);else if("Polygon"===a)ao(h,b,d,e,f,!0);else if("MultiPolygon"===a)for(var g=0;g<h.length;g++){var l=[];ao(h[g],l,d,e,f,!0),l.length&&b.push(l)}if(b.length){if(p.lineMetrics&&"LineString"===a){for(g=0;g<b.length;g++)i.push(ab(c.id,a,b[g],c.tags));continue}("LineString"===a||"MultiLineString"===a)&&(1===b.length?(a="LineString",b=b[0]):a="MultiLineString"),("Point"===a||"MultiPoint"===a)&&(a=3===b.length?"Point":"MultiPoint"),i.push(ab(c.id,a,b,c.tags))}}}return i.length?i:null}function al(b,c,e,f,g){for(var a=0;a<b.length;a+=3){var d=b[a+g];d>=e&&d<=f&&(c.push(b[a]),c.push(b[a+1]),c.push(b[a+2]))}}function am(b,u,e,f,o,v,m){for(var n,g,a=an(b),p=0===o?aq:ar,q=b.start,h=0;h<b.length-3;h+=3){var c=b[h],d=b[h+1],s=b[h+2],k=b[h+3],l=b[h+4],i=0===o?c:d,r=0===o?k:l,t=!1;m&&(n=Math.sqrt(Math.pow(c-k,2)+Math.pow(d-l,2))),i<e?r>e&&(g=p(a,c,d,k,l,e),m&&(a.start=q+n*g)):i>f?r<f&&(g=p(a,c,d,k,l,f),m&&(a.start=q+n*g)):ap(a,c,d,s),r<e&&i>=e&&(g=p(a,c,d,k,l,e),t=!0),r>f&&i<=f&&(g=p(a,c,d,k,l,f),t=!0),!v&&t&&(m&&(a.end=q+n*g),u.push(a),a=an(b)),m&&(q+=n)}var j=b.length-3;c=b[j],d=b[j+1],s=b[j+2],i=0===o?c:d,i>=e&&i<=f&&ap(a,c,d,s),j=a.length-3,v&&j>=3&&(a[j]!==a[0]||a[j+1]!==a[1])&&ap(a,a[0],a[1],a[2]),a.length&&u.push(a)}function an(b){var a=[];return a.size=b.size,a.start=b.start,a.end=b.end,a}function ao(b,c,d,e,f,g){for(var a=0;a<b.length;a++)am(b[a],c,d,e,f,g,!1)}function ap(a,b,c,d){a.push(b),a.push(c),a.push(d)}function aq(a,b,c,f,g,d){var e=(d-b)/(f-b);return a.push(d),a.push(c+(g-c)*e),a.push(1),e}function ar(a,b,c,f,g,d){var e=(d-c)/(g-c);return a.push(b+(f-b)*e),a.push(d),a.push(1),e}function as(h,e){for(var i=[],f=0;f<h.length;f++){var d,a=h[f],c=a.type;if("Point"===c||"MultiPoint"===c||"LineString"===c)d=at(a.geometry,e);else if("MultiLineString"===c||"Polygon"===c){d=[];for(var b=0;b<a.geometry.length;b++)d.push(at(a.geometry[b],e))}else if("MultiPolygon"===c)for(b=0,d=[];b<a.geometry.length;b++){for(var j=[],g=0;g<a.geometry[b].length;g++)j.push(at(a.geometry[b][g],e));d.push(j)}i.push(ab(a.id,c,d,a.tags))}return i}function at(a,d){var b=[];b.size=a.size,void 0!==a.start&&(b.start=a.start,b.end=a.end);for(var c=0;c<a.length;c+=3)b.push(a[c]+d,a[c+1],a[c+2]);return b}function au(b,g){if(b.transformed)return b;var f,a,d,h=1<<b.z,i=b.x,j=b.y;for(f=0;f<b.features.length;f++){var e=b.features[f],c=e.geometry,l=e.type;if(e.geometry=[],1===l)for(a=0;a<c.length;a+=2)e.geometry.push(av(c[a],c[a+1],g,h,i,j));else for(a=0;a<c.length;a++){var k=[];for(d=0;d<c[a].length;d+=2)k.push(av(c[a][d],c[a][d+1],g,h,i,j));e.geometry.push(k)}}return b.transformed=!0,b}function av(c,d,a,b,e,f){return[Math.round(a*(c*b-e)),Math.round(a*(d*b-f))]}function aw(c,e,j,k,d){for(var l=e===d.maxZoom?0:d.tolerance/((1<<e)*d.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:k,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},b=0;b<c.length;b++){a.numFeatures++,ax(a,c[b],l,d);var f=c[b].minX,g=c[b].minY,h=c[b].maxX,i=c[b].maxY;f<a.minX&&(a.minX=f),g<a.minY&&(a.minY=g),h>a.maxX&&(a.maxX=h),i>a.maxY&&(a.maxY=i)}return a}function ax(f,d,h,m){var b=d.geometry,c=d.type,e=[];if("Point"===c||"MultiPoint"===c)for(var a=0;a<b.length;a+=3)e.push(b[a]),e.push(b[a+1]),f.numPoints++,f.numSimplified++;else if("LineString"===c)ay(e,b,f,h,!1,!1);else if("MultiLineString"===c||"Polygon"===c)for(a=0;a<b.length;a++)ay(e,b[a],f,h,"Polygon"===c,0===a);else if("MultiPolygon"===c)for(var i=0;i<b.length;i++){var j=b[i];for(a=0;a<j.length;a++)ay(e,j[a],f,h,!0,0===a)}if(e.length){var g=d.tags||null;if("LineString"===c&&m.lineMetrics){for(var k in g={},d.tags)g[k]=d.tags[k];g.mapbox_clip_start=b.start/b.size,g.mapbox_clip_end=b.end/b.size}var l={geometry:e,type:"Polygon"===c||"MultiPolygon"===c?3:"LineString"===c||"MultiLineString"===c?2:1,tags:g};null!==d.id&&(l.id=d.id),f.features.push(l)}}function ay(h,a,e,b,f,i){var g=b*b;if(b>0&&a.size<(f?g:b)){e.numPoints+=a.length/3;return}for(var d=[],c=0;c<a.length;c+=3)(0===b||a[c+2]>g)&&(e.numSimplified++,d.push(a[c]),d.push(a[c+1])),e.numPoints++;f&&az(d,i),h.push(d)}function az(b,f){for(var e=0,a=0,c=b.length,d=c-2;a<c;d=a,a+=2)e+=(b[a]-b[d])*(b[a+1]+b[d+1]);if(e>0===f)for(a=0,c=b.length;a<c/2;a+=2){var g=b[a],h=b[a+1];b[a]=b[c-2-a],b[a+1]=b[c-1-a],b[c-2-a]=g,b[c-1-a]=h}}function h(j,a){var i=(a=this.options=aB(Object.create(this.options),a)).debug;if(i&&console.time("preprocess data"),a.maxZoom<0||a.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(a.promoteId&&a.generateId)throw new Error("promoteId and generateId cannot be used together.");var d,e,b,c,f,g,h=function(a,d){var b=[];if("FeatureCollection"===a.type)for(var c=0;c<a.features.length;c++)ae(b,a.features[c],d,c);else"Feature"===a.type?ae(b,a,d):ae(b,{geometry:a},d);return b}(j,a);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",a.indexMaxZoom,a.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(h=(d=h,b=(e=a).buffer/e.extent,c=d,f=ak(d,1,-1-b,b,0,-1,2,e),g=ak(d,1,1-b,2+b,0,-1,2,e),(f||g)&&(c=ak(d,1,-b,1+b,0,-1,2,e)||[],f&&(c=as(f,1).concat(c)),g&&(c=c.concat(as(g,-1)))),c)).length&&this.splitTile(h,0,0,0),i&&(h.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function aA(a,b,c){return((1<<a)*c+b)*32+a}function aB(a,b){for(var c in b)a[c]=b[c];return a}function aC(f,b){var c=f.tileID.canonical;if(!this._geoJSONIndex)return b(null,null);var d=this._geoJSONIndex.getTile(c.z,c.x,c.y);if(!d)return b(null,null);var e=new n(d.features),a=g(e);(0!==a.byteOffset||a.byteLength!==a.buffer.byteLength)&&(a=new Uint8Array(a)),b(null,{vectorTile:e,rawData:a.buffer})}b.prototype.load=function(b){var f=this.options,c=f.log,j=f.minZoom,g=f.maxZoom,h=f.nodeSize;c&&console.time("total time");var i="prepare "+b.length+" points";c&&console.time(i),this.points=b;for(var a=[],d=0;d<b.length;d++)b[d].geometry&&a.push(R(b[d],d));this.trees[g+1]=new k(a,Z,$,h,Float32Array),c&&console.timeEnd(i);for(var e=g;e>=j;e--){var l=+Date.now();a=this._cluster(a,e),this.trees[e]=new k(a,Z,$,h,Float32Array),c&&console.log("z%d: %d clusters in %dms",e,a.length,+Date.now()-l)}return c&&console.timeEnd("total time"),this},b.prototype.getClusters=function(a,d){var b=((a[0]+180)%360+360)%360-180,e=Math.max(-90,Math.min(90,a[1])),c=180===a[2]?180:((a[2]+180)%360+360)%360-180,f=Math.max(-90,Math.min(90,a[3]));if(a[2]-a[0]>=360)b=-180,c=180;else if(b>c){var l=this.getClusters([b,e,180,f],d),m=this.getClusters([-180,e,c,f],d);return l.concat(m)}for(var i=this.trees[this._limitZoom(d)],n=i.range(U(b),V(f),U(c),V(e)),j=[],g=0,k=n;g<k.length;g+=1){var o=k[g],h=i.points[o];j.push(h.numPoints?S(h):this.points[h.index])}return j},b.prototype.getChildren=function(c){var j=this._getOriginId(c),h=this._getOriginZoom(c),d="No cluster with the specified id.",a=this.trees[h];if(!a)throw new Error(d);var e=a.points[j];if(!e)throw new Error(d);for(var k=this.options.radius/(this.options.extent*Math.pow(2,h-1)),l=a.within(e.x,e.y,k),f=[],g=0,i=l;g<i.length;g+=1){var m=i[g],b=a.points[m];b.parentId===c&&f.push(b.numPoints?S(b):this.points[b.index])}if(0===f.length)throw new Error(d);return f},b.prototype.getLeaves=function(d,a,b){a=a||10,b=b||0;var c=[];return this._appendLeaves(c,d,a,b,0),c},b.prototype.getTile=function(i,d,e){var b=this.trees[this._limitZoom(i)],a=Math.pow(2,i),j=this.options,k=j.extent,l=j.radius,c=l/k,g=(e-c)/a,h=(e+1+c)/a,f={features:[]};return this._addTileFeatures(b.range((d-c)/a,g,(d+1+c)/a,h),b.points,d,e,a,f),0===d&&this._addTileFeatures(b.range(1-c/a,g,1,h),b.points,a,e,a,f),d===a-1&&this._addTileFeatures(b.range(0,g,c/a,h),b.points,-1,e,a,f),f.features.length?f:null},b.prototype.getClusterExpansionZoom=function(a){for(var b=this._getOriginZoom(a)-1;b<=this.options.maxZoom;){var c=this.getChildren(a);if(b++,1!==c.length)break;a=c[0].properties.cluster_id}return b},b.prototype._appendLeaves=function(c,i,f,d,a){for(var j=this.getChildren(i),e=0,g=j;e<g.length;e+=1){var h=g[e],b=h.properties;if(b&&b.cluster?a+b.point_count<=d?a+=b.point_count:a=this._appendLeaves(c,b.cluster_id,f,d,a):a<d?a++:c.push(h),c.length===f)break}return a},b.prototype._addTileFeatures=function(h,i,j,k,d,l){for(var c=0,e=h;c<e.length;c+=1){var a=i[e[c]],f=a.numPoints,g={type:1,geometry:[[Math.round(this.options.extent*(a.x*d-j)),Math.round(this.options.extent*(a.y*d-k))]],tags:f?T(a):this.points[a.index].properties},b=void 0;f?b=a.id:this.options.generateId?b=a.index:this.points[a.index].id&&(b=this.points[a.index].id),void 0!==b&&(g.id=b),l.features.push(g)}},b.prototype._limitZoom=function(a){return Math.max(this.options.minZoom,Math.min(a,this.options.maxZoom+1))},b.prototype._cluster=function(m,c){for(var g=[],h=this.options,r=h.radius,s=h.extent,i=h.reduce,t=r/(s*Math.pow(2,c)),e=0;e<m.length;e++){var a=m[e];if(!(a.zoom<=c)){a.zoom=c;for(var n=this.trees[c+1],u=n.within(a.x,a.y,t),b=a.numPoints||1,o=a.x*b,p=a.y*b,f=i&&b>1?this._map(a,!0):null,j=(e<<5)+(c+1)+this.points.length,k=0,q=u;k<q.length;k+=1){var v=q[k],d=n.points[v];if(!(d.zoom<=c)){d.zoom=c;var l=d.numPoints||1;o+=d.x*l,p+=d.y*l,b+=l,d.parentId=j,i&&(f||(f=this._map(a,!0)),i(f,this._map(d)))}}1===b?g.push(a):(a.parentId=j,g.push(Q(o/b,p/b,j,b,f)))}}return g},b.prototype._getOriginId=function(a){return a-this.points.length>>5},b.prototype._getOriginZoom=function(a){return(a-this.points.length)%32},b.prototype._map=function(a,c){if(a.numPoints)return c?Y({},a.properties):a.properties;var d=this.points[a.index].properties,b=this.options.map(d);return c&&b===d?Y({},b):b},h.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},h.prototype.splitTile=function(g,c,d,b,m,x,y){for(var f=[g,c,d,b],e=this.options,j=e.debug;f.length;){b=f.pop(),d=f.pop(),c=f.pop(),g=f.pop();var h=1<<c,u=aA(c,d,b),a=this.tiles[u];if(!a&&(j>1&&console.time("creation"),a=this.tiles[u]=aw(g,c,d,b,e),this.tileCoords.push({z:c,x:d,y:b}),j)){j>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",c,d,b,a.numFeatures,a.numPoints,a.numSimplified),console.timeEnd("creation"));var v="z"+c;this.stats[v]=(this.stats[v]||0)+1,this.total++}if(a.source=g,m){if(c===e.maxZoom||c===m)continue;var w=1<<m-c;if(d!==Math.floor(x/w)||b!==Math.floor(y/w))continue}else if(c===e.indexMaxZoom||a.numPoints<=e.indexMaxPoints)continue;if(a.source=null,0!==g.length){j>1&&console.time("clipping");var n,o,p,q,k,l,i=.5*e.buffer/e.extent,r=.5-i,s=.5+i,t=1+i;n=o=p=q=null,k=ak(g,h,d-i,d+s,0,a.minX,a.maxX,e),l=ak(g,h,d+r,d+t,0,a.minX,a.maxX,e),g=null,k&&(n=ak(k,h,b-i,b+s,1,a.minY,a.maxY,e),o=ak(k,h,b+r,b+t,1,a.minY,a.maxY,e),k=null),l&&(p=ak(l,h,b-i,b+s,1,a.minY,a.maxY,e),q=ak(l,h,b+r,b+t,1,a.minY,a.maxY,e),l=null),j>1&&console.timeEnd("clipping"),f.push(n||[],c+1,2*d,2*b),f.push(o||[],c+1,2*d,2*b+1),f.push(p||[],c+1,2*d+1,2*b),f.push(q||[],c+1,2*d+1,2*b+1)}}},h.prototype.getTile=function(a,b,g){var k=this.options,l=k.extent,h=k.debug;if(a<0||a>24)return null;var j=1<<a,i=aA(a,b=(b%j+j)%j,g);if(this.tiles[i])return au(this.tiles[i],l);h>1&&console.log("drilling down to z%d-%d-%d",a,b,g);for(var c,d=a,e=b,f=g;!c&&d>0;)d--,e=Math.floor(e/2),f=Math.floor(f/2),c=this.tiles[aA(d,e,f)];return c&&c.source?(h>1&&console.log("found parent tile z%d-%d-%d",d,e,f),h>1&&console.time("drilling down"),this.splitTile(c.source,d,e,f,a,b,g),h>1&&console.timeEnd("drilling down"),this.tiles[i]?au(this.tiles[i],l):null):null};var aD=function(d){function a(b,c,e,a){d.call(this,b,c,e,aC),a&&(this.loadGeoJSON=a)}return d&&(a.__proto__=d),a.prototype=Object.create(d&&d.prototype),a.prototype.constructor=a,a.prototype.loadData=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=b,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},a.prototype._loadData=function(){var d=this;if(this._pendingCallback&&this._pendingLoadDataParams){var e=this._pendingCallback,a=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var f=!!a&&!!a.request&&!!a.request.collectResourceTiming&&new c.RequestPerformance(a.request);this.loadGeoJSON(a,function(i,c){if(i||!c)return e(i);if("object"!=typeof c)return e(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."));x(c,!0);try{var j,k;d._geoJSONIndex=a.cluster?new b(aE(a)).load(c.features):(j=c,k=a.geojsonVtOptions,new h(j,k))}catch(m){return e(m)}d.loaded={};var g={};if(f){var l=f.finish();l&&(g.resourceTiming={},g.resourceTiming[a.source]=JSON.parse(JSON.stringify(l)))}e(null,g)})}},a.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},a.prototype.reloadTile=function(a,b){var c=this.loaded,e=a.uid;return c&&c[e]?d.prototype.reloadTile.call(this,a,b):this.loadTile(a,b)},a.prototype.loadGeoJSON=function(a,b){if(a.request)c.getJSON(a.request,b);else if("string"!=typeof a.data)return b(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."));else try{return b(null,JSON.parse(a.data))}catch(d){return b(new Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."))}},a.prototype.removeSource=function(b,a){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),a()},a.prototype.getClusterExpansionZoom=function(b,a){try{a(null,this._geoJSONIndex.getClusterExpansionZoom(b.clusterId))}catch(c){a(c)}},a.prototype.getClusterChildren=function(b,a){try{a(null,this._geoJSONIndex.getChildren(b.clusterId))}catch(c){a(c)}},a.prototype.getClusterLeaves=function(a,b){try{b(null,this._geoJSONIndex.getLeaves(a.clusterId,a.limit,a.offset))}catch(c){b(c)}},a}(d);function aE(g){var a=g.superclusterOptions,d=g.clusterProperties;if(!d||!a)return a;for(var j={},k={},p={accumulated:null,zoom:0},q={properties:null},l=Object.keys(d),e=0,h=l;e<h.length;e+=1){var b=h[e],i=d[b],f=i[0],m=i[1],n=c.createExpression(m),o=c.createExpression("string"==typeof f?[f,["accumulated"],["get",b]]:f);j[b]=n.value,k[b]=o.value}return a.map=function(e){q.properties=e;for(var b={},a=0,c=l;a<c.length;a+=1){var d=c[a];b[d]=j[d].evaluate(p,q)}return b},a.reduce=function(c,e){q.properties=e;for(var a=0,d=l;a<d.length;a+=1){var b=d[a];p.accumulated=c[b],c[b]=k[b].evaluate(p,q)}},a}var a=function(a){var b=this;this.self=a,this.actor=new c.Actor(a,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:d,geojson:aD},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(a,c){if(b.workerSourceTypes[a])throw new Error('Worker source with name "'+a+'" already registered.');b.workerSourceTypes[a]=c},this.self.registerRTLTextPlugin=function(a){if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=a.applyArabicShaping,c.plugin.processBidirectionalText=a.processBidirectionalText,c.plugin.processStyledBidirectionalText=a.processStyledBidirectionalText}};return a.prototype.setReferrer=function(b,a){this.referrer=a},a.prototype.setImages=function(a,b,d){for(var e in this.availableImages[a]=b,this.workerSources[a]){var c=this.workerSources[a][e];for(var f in c)c[f].availableImages=b}d()},a.prototype.setLayers=function(a,b,c){this.getLayerIndex(a).replace(b),c()},a.prototype.updateLayers=function(b,a,c){this.getLayerIndex(b).update(a.layers,a.removedIds),c()},a.prototype.loadTile=function(b,a,c){this.getWorkerSource(b,a.type,a.source).loadTile(a,c)},a.prototype.loadDEMTile=function(b,a,c){this.getDEMWorkerSource(b,a.source).loadTile(a,c)},a.prototype.reloadTile=function(b,a,c){this.getWorkerSource(b,a.type,a.source).reloadTile(a,c)},a.prototype.abortTile=function(b,a,c){this.getWorkerSource(b,a.type,a.source).abortTile(a,c)},a.prototype.removeTile=function(b,a,c){this.getWorkerSource(b,a.type,a.source).removeTile(a,c)},a.prototype.removeDEMTile=function(b,a){this.getDEMWorkerSource(b,a.source).removeTile(a)},a.prototype.removeSource=function(b,a,c){if(this.workerSources[b]&&this.workerSources[b][a.type]&&this.workerSources[b][a.type][a.source]){var d=this.workerSources[b][a.type][a.source];delete this.workerSources[b][a.type][a.source],void 0!==d.removeSource?d.removeSource(a,c):c()}},a.prototype.loadWorkerSource=function(d,b,a){try{this.self.importScripts(b.url),a()}catch(c){a(c.toString())}},a.prototype.syncRTLPluginState=function(h,e,b){try{c.plugin.setState(e);var a=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&null!=a){this.self.importScripts(a);var d=c.plugin.isParsed(),f=d?void 0:new Error("RTL Text Plugin failed to import scripts from "+a);b(f,d)}}catch(g){b(g.toString())}},a.prototype.getAvailableImages=function(b){var a=this.availableImages[b];return a||(a=[]),a},a.prototype.getLayerIndex=function(b){var a=this.layerIndexes[b];return a||(a=this.layerIndexes[b]=new i),a},a.prototype.getWorkerSource=function(a,b,c){var e=this;if(this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][b]||(this.workerSources[a][b]={}),!this.workerSources[a][b][c]){var d={send:function(b,c,d){e.actor.send(b,c,d,a)}};this.workerSources[a][b][c]=new this.workerSourceTypes[b](d,this.getLayerIndex(a),this.getAvailableImages(a))}return this.workerSources[a][b][c]},a.prototype.getDEMWorkerSource=function(a,b){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][b]||(this.demWorkerSources[a][b]=new e),this.demWorkerSources[a][b]},a.prototype.enforceCacheSizeLimit=function(b,a){c.enforceCacheSizeLimit(a)},"undefined"!=typeof WorkerGlobalScope&& void 0!==c.window&&c.window instanceof WorkerGlobalScope&&(c.window.worker=new a(c.window)),a}),a(["./shared"],function(a){"use strict";var a9,ba,bb,bc,ap=a.createCommonjsModule(function(b){function a(a){return!c(a)}function c(a){return d()?e()?f()?g()?h()?i()?j()?k()?l()?n(a&&a.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support":"not a browser"}function d(){return"undefined"!=typeof window&&"undefined"!=typeof document}function e(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function f(){return Function.prototype&&Function.prototype.bind}function g(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function h(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function i(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a,b,d=new Blob([""],{type:"text/javascript"}),c=URL.createObjectURL(d);try{b=new Worker(c),a=!0}catch(e){a=!1}return b&&b.terminate(),URL.revokeObjectURL(c),a}function j(){return"Uint8ClampedArray"in window}function k(){return ArrayBuffer.isView}function l(){var a=document.createElement("canvas");a.width=a.height=1;var b=a.getContext("2d");if(!b)return!1;var c=b.getImageData(0,0,1,1);return c&&c.width===a.width}b.exports?b.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=c);var m={};function n(a){return void 0===m[a]&&(m[a]=o(a)),m[a]}function o(g){var f,b,d,c=(f=g,b=document.createElement("canvas"),((d=Object.create(a.webGLContextAttributes)).failIfMajorPerformanceCaveat=f,b.probablySupportsContext)?b.probablySupportsContext("webgl",d)||b.probablySupportsContext("experimental-webgl",d):b.supportsContext?b.supportsContext("webgl",d)||b.supportsContext("experimental-webgl",d):b.getContext("webgl",d)||b.getContext("experimental-webgl",d));if(!c)return!1;var e=c.createShader(c.VERTEX_SHADER);return!(!e||c.isContextLost())&&(c.shaderSource(e,"void main() {}"),c.compileShader(e),!0===c.getShaderParameter(e,c.COMPILE_STATUS))}a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),m={};m.create=function(e,c,d){var b=a.window.document.createElement(e);return void 0!==c&&(b.className=c),d&&d.appendChild(b),b},m.createNS=function(b,c){return a.window.document.createElementNS(b,c)};var bd=a.window.document.documentElement.style;function ad(a){if(!bd)return a[0];for(var b=0;b<a.length;b++)if(a[b]in bd)return a[b];return a[0]}var be=ad(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);m.disableDrag=function(){bd&&be&&(a9=bd[be],bd[be]="none")},m.enableDrag=function(){bd&&be&&(bd[be]=a9)};var bf=ad(["transform","WebkitTransform"]);m.setTransform=function(a,b){a.style[bf]=b};var aq=!1;try{var M=Object.defineProperty({},"passive",{get:function(){aq=!0}});a.window.addEventListener("test",M,M),a.window.removeEventListener("test",M,M)}catch(bg){aq=!1}m.addEventListener=function(b,c,d,a){void 0===a&&(a={}),"passive"in a&&aq?b.addEventListener(c,d,a):b.addEventListener(c,d,a.capture)},m.removeEventListener=function(b,c,d,a){void 0===a&&(a={}),"passive"in a&&aq?b.removeEventListener(c,d,a):b.removeEventListener(c,d,a.capture)};var bh=function(b){b.preventDefault(),b.stopPropagation(),a.window.removeEventListener("click",bh,!0)};function bi(b){var a=b.userImage;return!!(a&&a.render&&a.render())&&(b.data.replace(new Uint8Array(a.data.buffer)),!0)}m.suppressClick=function(){a.window.addEventListener("click",bh,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",bh,!0)},0)},m.mousePos=function(b,c){var d=b.getBoundingClientRect();return new a.Point(c.clientX-d.left-b.clientLeft,c.clientY-d.top-b.clientTop)},m.touchPos=function(c,d){for(var e=c.getBoundingClientRect(),f=[],b=0;b<d.length;b++)f.push(new a.Point(d[b].clientX-e.left-c.clientLeft,d[b].clientY-e.top-c.clientTop));return f},m.mouseButton=function(b){return void 0!==a.window.InstallTrigger&&2===b.button&&b.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button},m.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var bj=function(c){function b(){c.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.isLoaded=function(){return this.loaded},b.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var b=0,c=this.requestors;b<c.length;b+=1){var d=c[b],e=d.ids,f=d.callback;this._notify(e,f)}this.requestors=[]}},b.prototype.getImage=function(a){return this.images[a]},b.prototype.addImage=function(a,b){this._validate(a,b)&&(this.images[a]=b)},b.prototype._validate=function(d,b){var c=!0;return this._validateStretch(b.stretchX,b.data&&b.data.width)||(this.fire(new a.ErrorEvent(new Error('Image "'+d+'" has invalid "stretchX" value'))),c=!1),this._validateStretch(b.stretchY,b.data&&b.data.height)||(this.fire(new a.ErrorEvent(new Error('Image "'+d+'" has invalid "stretchY" value'))),c=!1),this._validateContent(b.content,b)||(this.fire(new a.ErrorEvent(new Error('Image "'+d+'" has invalid "content" value'))),c=!1),c},b.prototype._validateStretch=function(c,f){if(!c)return!0;for(var d=0,b=0,e=c;b<e.length;b+=1){var a=e[b];if(a[0]<d||a[1]<a[0]||f<a[1])return!1;d=a[1]}return!0},b.prototype._validateContent=function(a,b){return!a||4===a.length&& !(a[0]<0)&&!(b.data.width<a[0])&& !(a[1]<0)&&!(b.data.height<a[1])&& !(a[2]<0)&&!(b.data.width<a[2])&& !(a[3]<0)&&!(b.data.height<a[3])&& !(a[2]<a[0])&&!(a[3]<a[1])},b.prototype.updateImage=function(a,b){var c=this.images[a];b.version=c.version+1,this.images[a]=b,this.updatedImages[a]=!0},b.prototype.removeImage=function(a){var b=this.images[a];delete this.images[a],delete this.patterns[a],b.userImage&&b.userImage.onRemove&&b.userImage.onRemove()},b.prototype.listImages=function(){return Object.keys(this.images)},b.prototype.getImages=function(a,c){var d=!0;if(!this.isLoaded())for(var b=0,e=a;b<e.length;b+=1){var f=e[b];this.images[f]||(d=!1)}this.isLoaded()||d?this._notify(a,c):this.requestors.push({ids:a,callback:c})},b.prototype._notify=function(g,h){for(var e={},d=0,f=g;d<f.length;d+=1){var c=f[d];this.images[c]||this.fire(new a.Event("styleimagemissing",{id:c}));var b=this.images[c];b?e[c]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:a.warnOnce('Image "'+c+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}h(null,e)},b.prototype.getPixelSize=function(){var a=this.atlasImage,b=a.width,c=a.height;return{width:b,height:c}},b.prototype.getPattern=function(d){var c=this.patterns[d],b=this.getImage(d);if(!b)return null;if(c&&c.position.version===b.version)return c.position;if(c)c.position.version=b.version;else{var f=b.data.width+2,g=b.data.height+2,e={w:f,h:g,x:0,y:0},h=new a.ImagePosition(e,b);this.patterns[d]={bin:e,position:h}}return this._updatePatternAtlas(),this.patterns[d].position},b.prototype.bind=function(c){var b=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(c,this.atlasImage,b.RGBA),this.atlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE)},b.prototype._updatePatternAtlas=function(){var h=[];for(var l in this.patterns)h.push(this.patterns[l].bin);var i=a.potpack(h),m=i.w,n=i.h,c=this.atlasImage;for(var j in c.resize({width:m||1,height:n||1}),this.patterns){var k=this.patterns[j].bin,d=k.x+1,e=k.y+1,b=this.images[j].data,f=b.width,g=b.height;a.RGBAImage.copy(b,c,{x:0,y:0},{x:d,y:e},{width:f,height:g}),a.RGBAImage.copy(b,c,{x:0,y:g-1},{x:d,y:e-1},{width:f,height:1}),a.RGBAImage.copy(b,c,{x:0,y:0},{x:d,y:e+g},{width:f,height:1}),a.RGBAImage.copy(b,c,{x:f-1,y:0},{x:d-1,y:e},{width:1,height:g}),a.RGBAImage.copy(b,c,{x:0,y:0},{x:d+f,y:e},{width:1,height:g})}this.dirty=!0},b.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},b.prototype.dispatchRenderCallbacks=function(e){for(var b=0,c=e;b<c.length;b+=1){var a=c[b];if(!this.callbackDispatchedThisFrame[a]){this.callbackDispatchedThisFrame[a]=!0;var d=this.images[a];bi(d)&&this.updateImage(a,d)}}},b}(a.Evented),ae=af;function af(c,b,d,e,f,g){this.fontSize=c||24,this.buffer=void 0===b?3:b,this.cutoff=e||.25,this.fontFamily=f||"sans-serif",this.fontWeight=g||"normal",this.radius=d||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function bk(d,c,e,f,g,h,i){for(var a=0;a<c;a++){for(var b=0;b<e;b++)f[b]=d[b*c+a];for(bl(f,g,h,i,e),b=0;b<e;b++)d[b*c+a]=g[b]}for(b=0;b<e;b++){for(a=0;a<c;a++)f[a]=d[b*c+a];for(bl(f,g,h,i,c),a=0;a<c;a++)d[b*c+a]=Math.sqrt(g[a])}}function bl(e,h,c,d,g){c[0]=0,d[0]=-1e20,d[1]=1e20;for(var b=1,a=0;b<g;b++){for(var f=(e[b]+b*b-(e[c[a]]+c[a]*c[a]))/(2*b-2*c[a]);f<=d[a];)a--,f=(e[b]+b*b-(e[c[a]]+c[a]*c[a]))/(2*b-2*c[a]);a++,c[a]=b,d[a]=f,d[a+1]=1e20}for(b=0,a=0;b<g;b++){for(;d[a+1]<b;)a++;h[b]=(b-c[a])*(b-c[a])+e[c[a]]}}af.prototype.draw=function(d){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(d,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),c=new Uint8ClampedArray(this.size*this.size),a=0;a<this.size*this.size;a++){var b=e.data[4*a+3]/255;this.gridOuter[a]=1===b?0:0===b?1e20:Math.pow(Math.max(0,.5-b),2),this.gridInner[a]=1===b?1e20:0===b?0:Math.pow(Math.max(0,b-.5),2)}for(bk(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),bk(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),a=0;a<this.size*this.size;a++){var f=this.gridOuter[a]-this.gridInner[a];c[a]=Math.max(0,Math.min(255,Math.round(255-255*(f/this.radius+this.cutoff))))}return c},ae.default=af;var B=function(a,b){this.requestManager=a,this.localIdeographFontFamily=b,this.entries={}};B.prototype.setURL=function(a){this.url=a},B.prototype.getGlyphs=function(c,h){var i=this,d=[];for(var e in c)for(var b=0,f=c[e];b<f.length;b+=1){var g=f[b];d.push({stack:e,id:g})}a.asyncAll(d,function(h,f){var b=h.stack,c=h.id,a=i.entries[b];a||(a=i.entries[b]={glyphs:{},requests:{},ranges:{}});var d=a.glyphs[c];if(void 0!==d){f(null,{stack:b,id:c,glyph:d});return}if(d=i._tinySDF(a,b,c)){a.glyphs[c]=d,f(null,{stack:b,id:c,glyph:d});return}var e=Math.floor(c/256);if(256*e>65535){f(new Error("glyphs > 65535 not supported"));return}if(a.ranges[e]){f(null,{stack:b,id:c,glyph:d});return}var g=a.requests[e];g||(g=a.requests[e]=[],B.loadGlyphRange(b,e,i.url,i.requestManager,function(h,b){if(b){for(var c in b)i._doesCharSupportLocalGlyph(+c)||(a.glyphs[+c]=b[+c]);a.ranges[e]=!0}for(var d=0,f=g;d<f.length;d+=1)(0,f[d])(h,b);delete a.requests[e]})),g.push(function(a,d){a?f(a):d&&f(null,{stack:b,id:c,glyph:d[c]||null})})},function(e,f){if(e)h(e);else if(f){for(var b={},c=0,g=f;c<g.length;c+=1){var d=g[c],i=d.stack,j=d.id,a=d.glyph;(b[i]||(b[i]={}))[j]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics}}h(null,b)}})},B.prototype._doesCharSupportLocalGlyph=function(b){return!!this.localIdeographFontFamily&&(a.isChar["CJK Unified Ideographs"](b)||a.isChar["Hangul Syllables"](b)||a.isChar.Hiragana(b)||a.isChar.Katakana(b))},B.prototype._tinySDF=function(f,c,d){var g=this.localIdeographFontFamily;if(g&&this._doesCharSupportLocalGlyph(d)){var e=f.tinySDF;if(!e){var b="400";/bold/i.test(c)?b="900":/medium/i.test(c)?b="500":/light/i.test(c)&&(b="200"),e=f.tinySDF=new B.TinySDF(24,3,8,.25,g,b)}return{id:d,bitmap:new a.AlphaImage({width:30,height:30},e.draw(String.fromCharCode(d))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},B.loadGlyphRange=function(d,e,f,b,h){var c=256*e,g=b.transformRequest(b.normalizeGlyphsURL(f).replace("{fontstack}",d).replace("{range}",c+"-"+(c+255)),a.ResourceType.Glyphs);a.getArrayBuffer(g,function(c,d){if(c)h(c);else if(d){for(var e={},b=0,f=a.parseGlyphPBF(d);b<f.length;b+=1){var g=f[b];e[g.id]=g}h(null,e)}})},B.TinySDF=ae;var $=function(){this.specification=a.styleSpec.light.position};$.prototype.possiblyEvaluate=function(b,c){return a.sphericalToCartesian(b.expression.evaluate(c))},$.prototype.interpolate=function(b,c,d){return{x:a.number(b.x,c.x,d),y:a.number(b.y,c.y,d),z:a.number(b.z,c.z,d)}};var bm=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new $,color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),bn="-transition",bo=function(c){function b(b){c.call(this),this._transitionable=new a.Transitionable(bm),this.setLight(b),this._transitioning=this._transitionable.untransitioned()}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.getLight=function(){return this._transitionable.serialize()},b.prototype.setLight=function(c,d){if(void 0===d&&(d={}),!this._validate(a.validateLight,c,d))for(var b in c){var e=c[b];a.endsWith(b,bn)?this._transitionable.setTransition(b.slice(0,-bn.length),e):this._transitionable.setValue(b,e)}},b.prototype.updateTransitions=function(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)},b.prototype.hasTransition=function(){return this._transitioning.hasTransition()},b.prototype.recalculate=function(a){this.properties=this._transitioning.possiblyEvaluate(a)},b.prototype._validate=function(c,d,b){return(!b|| !1!==b.validate)&&a.emitValidationErrors(this,c.call(a.validateStyle,a.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},b}(a.Evented),C=function(a,b){this.width=a,this.height=b,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};C.prototype.getDash=function(b,c){var a=b.join(",")+String(c);return this.dashEntry[a]||(this.dashEntry[a]=this.addDash(b,c)),this.dashEntry[a]},C.prototype.getDashRanges=function(a,k,b){var j=a.length%2==1,d=[],e=j?-a[a.length-1]*b:0,f=a[0]*b,c=!0;d.push({left:e,right:f,isDash:c,zeroLength:0===a[0]});for(var g=a[0],h=1;h<a.length;h++){c=!c;var i=a[h];e=g*b,g+=i,f=g*b,d.push({left:e,right:f,isDash:c,zeroLength:0===i})}return d},C.prototype.addRoundDash=function(i,l,c){for(var f=l/2,d=-c;d<=c;d++)for(var m=this.nextRow+c+d,n=this.width*m,j=0,b=i[j],a=0;a<this.width;a++){a/b.right>1&&(b=i[++j]);var o=Math.abs(a-b.left),p=Math.abs(a-b.right),e=Math.min(o,p),g=void 0,h=d/c*(f+1);if(b.isDash){var k=f-Math.abs(h);g=Math.sqrt(e*e+k*k)}else g=f-Math.sqrt(e*e+h*h);this.data[n+a]=Math.max(0,Math.min(255,g+128))}},C.prototype.addRegularDash=function(a){for(var b=a.length-1;b>=0;--b){var e=a[b],f=a[b+1];e.zeroLength?a.splice(b,1):f&&f.isDash===e.isDash&&(f.left=e.left,a.splice(b,1))}var g=a[0],h=a[a.length-1];g.isDash===h.isDash&&(g.left=h.left-this.width,h.right=g.right+this.width);for(var k=this.width*this.nextRow,i=0,d=a[i],c=0;c<this.width;c++){c/d.right>1&&(d=a[++i]);var l=Math.abs(c-d.left),m=Math.abs(c-d.right),j=Math.min(l,m),n=d.isDash?j:-j;this.data[k+c]=Math.max(0,Math.min(255,n+128))}},C.prototype.addDash=function(d,f){var b=f?7:0,g=2*b+1;if(this.nextRow+g>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var c=0,e=0;e<d.length;e++)c+=d[e];if(0!==c){var h=this.width/c,i=this.getDashRanges(d,this.width,h);f?this.addRoundDash(i,h,b):this.addRegularDash(i)}var j={y:(this.nextRow+b+.5)/this.height,height:2*b/this.height,width:c};return this.nextRow+=g,this.dirty=!0,j},C.prototype.bind=function(b){var a=b.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var N=function e(f,g){this.workerPool=f,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),b=0;b<c.length;b++){var h=c[b],d=new e.Actor(h,g,this.id);d.name="Worker "+b,this.actors.push(d)}};function bp(b,c,e){var d=function(g,f){if(g)return e(g);if(f){var d=a.pick(a.extend(f,b),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);f.vector_layers&&(d.vectorLayers=f.vector_layers,d.vectorLayerIds=d.vectorLayers.map(function(a){return a.id})),d.tiles=c.canonicalizeTileset(d,b.url),e(null,d)}};return b.url?a.getJSON(c.transformRequest(c.normalizeSourceURL(b.url),a.ResourceType.Source),d):a.browser.frame(function(){return d(null,b)})}N.prototype.broadcast=function(c,d,b){b=b||function(){},a.asyncAll(this.actors,function(a,b){a.send(c,d,b)},b)},N.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},N.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},N.Actor=a.Actor;var ag=function(b,c,d){this.bounds=a.LngLatBounds.convert(this.validateBounds(b)),this.minzoom=c||0,this.maxzoom=d||24};ag.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},ag.prototype.contains=function(b){var c=Math.pow(2,b.z),d={minX:Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),minY:Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),maxX:Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),maxY:Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c)};return b.x>=d.minX&&b.x<d.maxX&&b.y>=d.minY&&b.y<d.maxY};var ar=function(c){function b(d,b,e,f){if(c.call(this),this.id=d,this.dispatcher=e,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(b,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},b),this._collectResourceTiming=b.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.load=function(){var b=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bp(this._options,this.map._requestManager,function(d,c){b._tileJSONRequest=null,b._loaded=!0,d?b.fire(new a.ErrorEvent(d)):c&&(a.extend(b,c),c.bounds&&(b.tileBounds=new ag(c.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(c.tiles,b.map._requestManager._customAccessToken),a.postMapLoadEvent(c.tiles,b.map._getMapId(),b.map._requestManager._skuToken,b.map._requestManager._customAccessToken),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},b.prototype.loaded=function(){return this._loaded},b.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},b.prototype.onAdd=function(a){this.map=a,this.load()},b.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},b.prototype.serialize=function(){return a.extend({},this._options)},b.prototype.loadTile=function(b,e){var f=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(f,a.ResourceType.Tile),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(d,c){return(delete b.request,b.aborted)?e(null):d&&404!==d.status?e(d):void(c&&c.resourceTiming&&(b.resourceTiming=c.resourceTiming),this.map._refreshExpiredTiles&&c&&b.setExpiryData(c),b.loadVectorData(c,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),e(null),b.reloadCallback&&(this.loadTile(b,b.reloadCallback),b.reloadCallback=null))}c.request.collectResourceTiming=this._collectResourceTiming,b.actor&&"expired"!==b.state?"loading"===b.state?b.reloadCallback=e:b.request=b.actor.send("reloadTile",c,d.bind(this)):(b.actor=this.dispatcher.getActor(),b.request=b.actor.send("loadTile",c,d.bind(this)))},b.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)},b.prototype.unloadTile=function(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)},b.prototype.hasTransition=function(){return!1},b}(a.Evented),ah=function(c){function b(d,b,e,f){c.call(this),this.id=d,this.dispatcher=e,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},b),a.extend(this,a.pick(b,["url","scheme","tileSize"]))}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.load=function(){var b=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bp(this._options,this.map._requestManager,function(d,c){b._tileJSONRequest=null,b._loaded=!0,d?b.fire(new a.ErrorEvent(d)):c&&(a.extend(b,c),c.bounds&&(b.tileBounds=new ag(c.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(c.tiles),a.postMapLoadEvent(c.tiles,b.map._getMapId(),b.map._requestManager._skuToken),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},b.prototype.loaded=function(){return this._loaded},b.prototype.onAdd=function(a){this.map=a,this.load()},b.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},b.prototype.serialize=function(){return a.extend({},this._options)},b.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},b.prototype.loadTile=function(b,d){var e=this,c=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);b.request=a.getImage(this.map._requestManager.transformRequest(c,a.ResourceType.Tile),function(h,c){if(delete b.request,b.aborted)b.state="unloaded",d(null);else if(h)b.state="errored",d(h);else if(c){e.map._refreshExpiredTiles&&b.setExpiryData(c),delete c.cacheControl,delete c.expires;var g=e.map.painter.context,f=g.gl;b.texture=e.map.painter.getTileTexture(c.width),b.texture?b.texture.update(c,{useMipmap:!0}):(b.texture=new a.Texture(g,c,f.RGBA,{useMipmap:!0}),b.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),g.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,g.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,g.extTextureFilterAnisotropicMax)),b.state="loaded",a.cacheEntryPossiblyAdded(e.dispatcher),d(null)}})},b.prototype.abortTile=function(a,b){a.request&&(a.request.cancel(),delete a.request),b()},b.prototype.unloadTile=function(a,b){a.texture&&this.map.painter.saveTileTexture(a.texture),b()},b.prototype.hasTransition=function(){return!1},b}(a.Evented),as=function(c){function b(d,b,e,f){c.call(this,d,b,e,f),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},b),this.encoding=b.encoding||"mapbox"}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},b.prototype.loadTile=function(b,d){var c=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function e(a,c){a&&(b.state="errored",d(a)),c&&(b.dem=c,b.needsHillshadePrepare=!0,b.state="loaded",d(null))}b.request=a.getImage(this.map._requestManager.transformRequest(c,a.ResourceType.Tile),(function(f,c){if(delete b.request,b.aborted)b.state="unloaded",d(null);else if(f)b.state="errored",d(f);else if(c){this.map._refreshExpiredTiles&&b.setExpiryData(c),delete c.cacheControl,delete c.expires;var g=a.window.ImageBitmap&&c instanceof a.window.ImageBitmap&&a.offscreenCanvasSupported()?c:a.browser.getImageData(c,1),h={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:g,encoding:this.encoding};b.actor&&"expired"!==b.state||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",h,e.bind(this)))}}).bind(this)),b.neighboringTiles=this._getNeighboringTiles(b.tileID)},b.prototype._getNeighboringTiles=function(c){var b=c.canonical,e=Math.pow(2,b.z),f=(b.x-1+e)%e,g=0===b.x?c.wrap-1:c.wrap,h=(b.x+1+e)%e,i=b.x+1===e?c.wrap+1:c.wrap,d={};return d[new a.OverscaledTileID(c.overscaledZ,g,b.z,f,b.y).key]={backfilled:!1},d[new a.OverscaledTileID(c.overscaledZ,i,b.z,h,b.y).key]={backfilled:!1},b.y>0&&(d[new a.OverscaledTileID(c.overscaledZ,g,b.z,f,b.y-1).key]={backfilled:!1},d[new a.OverscaledTileID(c.overscaledZ,c.wrap,b.z,b.x,b.y-1).key]={backfilled:!1},d[new a.OverscaledTileID(c.overscaledZ,i,b.z,h,b.y-1).key]={backfilled:!1}),b.y+1<e&&(d[new a.OverscaledTileID(c.overscaledZ,g,b.z,f,b.y+1).key]={backfilled:!1},d[new a.OverscaledTileID(c.overscaledZ,c.wrap,b.z,b.x,b.y+1).key]={backfilled:!1},d[new a.OverscaledTileID(c.overscaledZ,i,b.z,h,b.y+1).key]={backfilled:!1}),d},b.prototype.unloadTile=function(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})},b}(ah),at=function(c){function b(e,b,f,g){c.call(this),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(g),this._data=b.data,this._options=a.extend({},b),this._collectResourceTiming=b.collectResourceTiming,this._resourceTiming=[],void 0!==b.maxzoom&&(this.maxzoom=b.maxzoom),b.type&&(this.type=b.type),b.attribution&&(this.attribution=b.attribution),this.promoteId=b.promoteId;var d=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:b.cluster||!1,geojsonVtOptions:{buffer:(void 0!==b.buffer?b.buffer:128)*d,tolerance:(void 0!==b.tolerance?b.tolerance:.375)*d,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:b.lineMetrics||!1,generateId:b.generateId||!1},superclusterOptions:{maxZoom:void 0!==b.clusterMaxZoom?Math.min(b.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:a.EXTENT,radius:(b.clusterRadius||50)*d,log:!1,generateId:b.generateId||!1},clusterProperties:b.clusterProperties},b.workerOptions)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c){b.fire(new a.ErrorEvent(c));return}var d={dataType:"source",sourceDataType:"metadata"};b._collectResourceTiming&&b._resourceTiming&&b._resourceTiming.length>0&&(d.resourceTiming=b._resourceTiming,b._resourceTiming=[]),b.fire(new a.Event("data",d))})},b.prototype.onAdd=function(a){this.map=a,this.load()},b.prototype.setData=function(b){var c=this;return this._data=b,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b){c.fire(new a.ErrorEvent(b));return}var d={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(d.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",d))}),this},b.prototype.getClusterExpansionZoom=function(a,b){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},b),this},b.prototype.getClusterChildren=function(a,b){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},b),this},b.prototype.getClusterLeaves=function(a,b,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:b,offset:c},d),this},b.prototype._updateWorkerData=function(d){var e=this;this._loaded=!1;var b=a.extend({},this.workerOptions),c=this._data;"string"==typeof c?(b.request=this.map._requestManager.transformRequest(a.browser.resolveURL(c),a.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(c),this.actor.send(this.type+".loadData",b,function(c,a){e._removed||a&&a.abandoned||(e._loaded=!0,a&&a.resourceTiming&&a.resourceTiming[e.id]&&(e._resourceTiming=a.resourceTiming[e.id].slice(0)),e.actor.send(e.type+".coalesce",{source:b.source},null),d(c))})},b.prototype.loaded=function(){return this._loaded},b.prototype.loadTile=function(b,e){var f=this,c=b.actor?"reloadTile":"loadTile";b.actor=this.actor;var d={type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};b.request=this.actor.send(c,d,function(a,d){return(delete b.request,b.unloadVectorData(),b.aborted)?e(null):a?e(a):(b.loadVectorData(d,f.map.painter,"reloadTile"===c),e(null))})},b.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0},b.prototype.unloadTile=function(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})},b.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},b.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},b.prototype.hasTransition=function(){return!1},b}(a.Evented),bq=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),_=function(c){function b(b,a,d,e){c.call(this),this.id=b,this.dispatcher=d,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(e),this.options=a}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.load=function(b,c){var d=this;this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(e,f){d._loaded=!0,e?d.fire(new a.ErrorEvent(e)):f&&(d.image=f,b&&(d.coordinates=b),c&&c(),d._finishLoading())})},b.prototype.loaded=function(){return this._loaded},b.prototype.updateImage=function(a){var b=this;return this.image&&a.url&&(this.options.url=a.url,this.load(a.coordinates,function(){b.texture=null})),this},b.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},b.prototype.onAdd=function(a){this.map=a,this.load()},b.prototype.setCoordinates=function(c){var e=this;this.coordinates=c;var d=c.map(a.MercatorCoordinate.fromLngLat);this.tileID=br(d),this.minzoom=this.maxzoom=this.tileID.z;var b=d.map(function(a){return e.tileID.getTilePoint(a)._round()});return this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(b[0].x,b[0].y,0,0),this._boundsArray.emplaceBack(b[1].x,b[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(b[3].x,b[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(b[2].x,b[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},b.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var b=this.map.painter.context,c=b.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,bq.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(b,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){var d=this.tiles[e];"loaded"!==d.state&&(d.state="loaded",d.texture=this.texture)}}},b.prototype.loadTile=function(a,b){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},b(null)):(a.state="errored",b(null))},b.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},b.prototype.hasTransition=function(){return!1},b}(a.Evented);function br(k){for(var b=1/0,c=1/0,d=-1/0,e=-1/0,g=0,h=k;g<h.length;g+=1){var f=h[g];b=Math.min(b,f.x),c=Math.min(c,f.y),d=Math.max(d,f.x),e=Math.max(e,f.y)}var i=Math.max(0,Math.floor(-Math.log(Math.max(d-b,e-c))/Math.LN2)),j=Math.pow(2,i);return new a.CanonicalTileID(i,Math.floor((b+d)/2*j),Math.floor((c+e)/2*j))}var au=function(c){function b(b,a,d,e){c.call(this,b,a,d,e),this.roundZoom=!0,this.type="video",this.options=a}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.load=function(){var f=this;this._loaded=!1;var d=this.options;this.urls=[];for(var b=0,c=d.urls;b<c.length;b+=1){var e=c[b];this.urls.push(this.map._requestManager.transformRequest(e,a.ResourceType.Source).url)}a.getVideo(this.urls,function(b,c){f._loaded=!0,b?f.fire(new a.ErrorEvent(b)):c&&(f.video=c,f.video.loop=!0,f.video.addEventListener("playing",function(){f.map.triggerRepaint()}),f.map&&f.video.play(),f._finishLoading())})},b.prototype.pause=function(){this.video&&this.video.pause()},b.prototype.play=function(){this.video&&this.video.play()},b.prototype.seek=function(c){if(this.video){var b=this.video.seekable;c<b.start(0)||c>b.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+b.start(0)+" and "+b.end(0)+"-second mark."))):this.video.currentTime=c}},b.prototype.getVideo=function(){return this.video},b.prototype.onAdd=function(a){!this.map&&(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},b.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&!(this.video.readyState<2)){var c=this.map.painter.context,b=c.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,bq.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE),b.texSubImage2D(b.TEXTURE_2D,0,0,0,b.RGBA,b.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(c,this.video,b.RGBA),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE)),this.tiles){var d=this.tiles[e];"loaded"!==d.state&&(d.state="loaded",d.texture=this.texture)}}},b.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},b.prototype.hasTransition=function(){return this.video&&!this.video.paused},b}(_),av=function(c){function b(d,b,e,f){c.call(this,d,b,e,f),b.coordinates?(!Array.isArray(b.coordinates)||4!==b.coordinates.length||b.coordinates.some(function(a){return!Array.isArray(a)||2!==a.length||a.some(function(a){return"number"!=typeof a})}))&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+d,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+d,null,'missing required property "coordinates"'))),b.animate&&"boolean"!=typeof b.animate&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+d,null,'optional "animate" property must be a boolean value'))),b.canvas?"string"==typeof b.canvas||b.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+d,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+d,null,'missing required property "canvas"'))),this.options=b,this.animate=void 0===b.animate||b.animate}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},b.prototype.getCanvas=function(){return this.canvas},b.prototype.onAdd=function(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()},b.prototype.onRemove=function(){this.pause()},b.prototype.prepare=function(){var b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var c=this.map.painter.context,e=c.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,bq.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,e.RGBA,{premultiply:!0}),this.tiles){var d=this.tiles[f];"loaded"!==d.state&&(d.state="loaded",d.texture=this.texture)}}},b.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},b.prototype.hasTransition=function(){return this._playing},b.prototype._hasInvalidDimensions=function(){for(var a=0,b=[this.canvas.width,this.canvas.height];a<b.length;a+=1){var c=b[a];if(isNaN(c)||c<=0)return!0}return!1},b}(_),bs={vector:ar,raster:ah,"raster-dem":as,geojson:at,video:au,image:_,canvas:av},bt=function(c,d,e,f){var b=new bs[d.type](c,d,e,f);if(b.id!==c)throw new Error("Expected Source id to be "+c+" instead of "+b.id);return a.bindAll(["load","abort","unload","serialize","prepare"],b),b};function bu(c,d){var b=a.identity([]);return a.translate(b,b,[1,1,0]),a.scale(b,b,[.5*c.width,.5*c.height,1]),a.multiply(b,b,c.calculatePosMatrix(d.toUnwrapped()))}function bv(b,f,l,m,c,g){var n=function(d,a,e){if(d)for(var b=0,f=d;b<f.length;b+=1){var c=a[f[b]];if(c&&c.source===e&&"fill-extrusion"===c.type)return!0}else for(var h in a){var g=a[h];if(g.source===e&&"fill-extrusion"===g.type)return!0}return!1}(c&&c.layers,f,b.id),h=g.maxPitchScaleFactor(),i=b.tilesIn(m,h,n);i.sort(bw);for(var j=[],d=0,k=i;d<k.length;d+=1){var a=k[d];j.push({wrappedTileID:a.tileID.wrapped().key,queryResults:a.tile.queryRenderedFeatures(f,l,b._state,a.queryGeometry,a.cameraQueryGeometry,a.scale,c,g,h,bu(b.transform,a.tileID))})}var e=bx(j);for(var o in e)e[o].forEach(function(c){var a=c.feature,d=b.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=d});return e}function bw(c,d){var a=c.tileID,b=d.tileID;return a.overscaledZ-b.overscaledZ||a.canonical.y-b.canonical.y||a.wrap-b.wrap||a.canonical.x-b.canonical.x}function bx(n){for(var b={},f={},c=0,g=n;c<g.length;c+=1){var h=g[c],i=h.queryResults,j=h.wrappedTileID,k=f[j]=f[j]||{};for(var a in i)for(var o=i[a],l=k[a]=k[a]||{},p=b[a]=b[a]||[],d=0,m=o;d<m.length;d+=1){var e=m[d];l[e.featureIndex]||(l[e.featureIndex]=!0,p.push(e))}}return b}var p=function(a,b){this.max=a,this.onRemove=b,this.reset()};p.prototype.reset=function(){for(var d in this.data)for(var a=0,c=this.data[d];a<c.length;a+=1){var b=c[a];b.timeout&&clearTimeout(b.timeout),this.onRemove(b.value)}return this.data={},this.order=[],this},p.prototype.add=function(e,f,b){var g=this,a=e.wrapped().key;void 0===this.data[a]&&(this.data[a]=[]);var c={value:f,timeout:void 0};if(void 0!==b&&(c.timeout=setTimeout(function(){g.remove(e,c)},b)),this.data[a].push(c),this.order.push(a),this.order.length>this.max){var d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this},p.prototype.has=function(a){return a.wrapped().key in this.data},p.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},p.prototype._getAndRemoveByKey=function(a){var b=this.data[a].shift();return b.timeout&&clearTimeout(b.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),b.value},p.prototype.getByKey=function(b){var a=this.data[b];return a?a[0].value:null},p.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},p.prototype.remove=function(c,d){if(!this.has(c))return this;var a=c.wrapped().key,e=void 0===d?0:this.data[a].indexOf(d),b=this.data[a][e];return this.data[a].splice(e,1),b.timeout&&clearTimeout(b.timeout),0===this.data[a].length&&delete this.data[a],this.onRemove(b.value),this.order.splice(this.order.indexOf(a),1),this},p.prototype.setMaxSize=function(b){for(this.max=b;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},p.prototype.filter=function(h){var c=[];for(var i in this.data)for(var a=0,d=this.data[i];a<d.length;a+=1){var e=d[a];h(e.value)||c.push(e)}for(var b=0,f=c;b<f.length;b+=1){var g=f[b];this.remove(g.value.tileID,g)}};var aa=function(b,c,d){this.context=b;var a=b.gl;this.buffer=a.createBuffer(),this.dynamicDraw=Boolean(d),this.context.unbindVAO(),b.bindElementBuffer.set(this.buffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer};aa.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},aa.prototype.updateData=function(b){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,b.arrayBuffer)},aa.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var by={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},J=function(c,b,d,e){this.length=b.length,this.attributes=d,this.itemSize=b.bytesPerElement,this.dynamicDraw=e,this.context=c;var a=c.gl;this.buffer=a.createBuffer(),c.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};J.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},J.prototype.updateData=function(b){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,b.arrayBuffer)},J.prototype.enableAttributes=function(c,d){for(var a=0;a<this.attributes.length;a++){var e=this.attributes[a],b=d.attributes[e.name];void 0!==b&&c.enableVertexAttribArray(b)}},J.prototype.setVertexAttribPointers=function(c,e,f){for(var b=0;b<this.attributes.length;b++){var a=this.attributes[b],d=e.attributes[a.name];void 0!==d&&c.vertexAttribPointer(d,a.components,c[by[a.type]],!1,this.itemSize,a.offset+this.itemSize*(f||0))}},J.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var b=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};b.prototype.get=function(){return this.current},b.prototype.set=function(a){},b.prototype.getDefault=function(){return this.default},b.prototype.setDefault=function(){this.set(this.default)};var bz=function(c){function b(){c.apply(this,arguments)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return a.Color.transparent},b.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},b}(b),bA=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)},a}(b),bB=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)},a}(b),bC=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},a}(b),bD=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)},a}(b),bE=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)},a}(b),bF=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(a){var b=this.current;(a.func!==b.func||a.ref!==b.ref||a.mask!==b.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},a}(b),bG=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){var a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]},a.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},a}(b),bH=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(b){if(b!==this.current||this.dirty){var a=this.gl;b?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=b,this.dirty=!1}},a}(b),bI=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},a}(b),bJ=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(b){if(b!==this.current||this.dirty){var a=this.gl;b?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=b,this.dirty=!1}},a}(b),bK=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)},a}(b),bL=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(b){if(b!==this.current||this.dirty){var a=this.gl;b?a.enable(a.BLEND):a.disable(a.BLEND),this.current=b,this.dirty=!1}},a}(b),bM=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){var a=this.gl;return[a.ONE,a.ZERO]},a.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},a}(b),bN=function(c){function b(){c.apply(this,arguments)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return a.Color.transparent},b.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},b}(b),bO=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)},a}(b),bP=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(b){if(b!==this.current||this.dirty){var a=this.gl;b?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=b,this.dirty=!1}},a}(b),bQ=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)},a}(b),bR=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)},a}(b),bS=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)},a}(b),bT=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)},a}(b),bU=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){var a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]},a.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},a}(b),bV=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},a}(b),bW=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindRenderbuffer(b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},a}(b),bX=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindTexture(b.TEXTURE_2D,a),this.current=a,this.dirty=!1}},a}(b),bY=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},a}(b),bZ=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},a}(b),b$=function(b){function a(a){b.call(this,a),this.vao=a.extVertexArrayObject}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)},a}(b),b_=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},a}(b),b0=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},a}(b),b1=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},a}(b),ai=function(b){function a(a,c){b.call(this,a),this.context=a,this.parent=c}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.getDefault=function(){return null},a}(b),b2=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,b,0),this.current=b,this.dirty=!1}},a}(ai),b3=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.set=function(b){if(b!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,b),this.current=b,this.dirty=!1}},a}(ai),aw=function(a,c,d,e){this.context=a,this.width=c,this.height=d;var f=a.gl,b=this.framebuffer=f.createFramebuffer();this.colorAttachment=new b2(a,b),e&&(this.depthAttachment=new b3(a,b))};aw.prototype.destroy=function(){var a=this.context.gl,b=this.colorAttachment.get();if(b&&a.deleteTexture(b),this.depthAttachment){var c=this.depthAttachment.get();c&&a.deleteRenderbuffer(c)}a.deleteFramebuffer(this.framebuffer)};var K=function(a,b,c){this.func=a,this.mask=b,this.range=c};K.ReadOnly=!1,K.ReadWrite=!0,K.disabled=new K(519,K.ReadOnly,[0,1]);var aj=function(a,b,c,d,e,f){this.test=a,this.ref=b,this.mask=c,this.fail=d,this.depthFail=e,this.pass=f};aj.disabled=new aj({func:519,mask:0},0,0,7680,7680,7680);var t=function(a,b,c){this.blendFunction=a,this.blendColor=b,this.mask=c};t.Replace=[1,0],t.disabled=new t(t.Replace,a.Color.transparent,[!1,!1,!1,!1]),t.unblended=new t(t.Replace,a.Color.transparent,[!0,!0,!0,!0]),t.alphaBlended=new t([1,771],a.Color.transparent,[!0,!0,!0,!0]);var O=function(a,b,c){this.enable=a,this.mode=b,this.frontFace=c};O.disabled=new O(!1,1029,2305),O.backCCW=new O(!0,1029,2305);var n=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new bz(this),this.clearDepth=new bA(this),this.clearStencil=new bB(this),this.colorMask=new bC(this),this.depthMask=new bD(this),this.stencilMask=new bE(this),this.stencilFunc=new bF(this),this.stencilOp=new bG(this),this.stencilTest=new bH(this),this.depthRange=new bI(this),this.depthTest=new bJ(this),this.depthFunc=new bK(this),this.blend=new bL(this),this.blendFunc=new bM(this),this.blendColor=new bN(this),this.blendEquation=new bO(this),this.cullFace=new bP(this),this.cullFaceSide=new bQ(this),this.frontFace=new bR(this),this.program=new bS(this),this.activeTexture=new bT(this),this.viewport=new bU(this),this.bindFramebuffer=new bV(this),this.bindRenderbuffer=new bW(this),this.bindTexture=new bX(this),this.bindVertexBuffer=new bY(this),this.bindElementBuffer=new bZ(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new b$(this),this.pixelStoreUnpack=new b_(this),this.pixelStoreUnpackPremultiplyAlpha=new b0(this),this.pixelStoreUnpackFlipY=new b1(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query")};n.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},n.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},n.prototype.createIndexBuffer=function(a,b){return new aa(this,a,b)},n.prototype.createVertexBuffer=function(a,b,c){return new J(this,a,b,c)},n.prototype.createRenderbuffer=function(c,d,e){var a=this.gl,b=a.createRenderbuffer();return this.bindRenderbuffer.set(b),a.renderbufferStorage(a.RENDERBUFFER,c,d,e),this.bindRenderbuffer.set(null),b},n.prototype.createFramebuffer=function(a,b,c){return new aw(this,a,b,c)},n.prototype.clear=function(c){var d=c.color,e=c.depth,a=this.gl,b=0;d&&(b|=a.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(b|=a.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),a.clear(b)},n.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},n.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},n.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},n.prototype.setColorMode=function(b){a.deepEqual(b.blendFunction,t.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(b.blendFunction),this.blendColor.set(b.blendColor)),this.colorMask.set(b.mask)},n.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ak=function(c){function b(b,e,d){var f=this;c.call(this),this.id=b,this.dispatcher=d,this.on("data",function(a){"source"===a.dataType&&"metadata"===a.sourceDataType&&(f._sourceLoaded=!0),f._sourceLoaded&&!f._paused&&"source"===a.dataType&&"content"===a.sourceDataType&&(f.reload(),f.transform&&f.update(f.transform))}),this.on("error",function(){f._sourceErrored=!0}),this._source=bt(b,e,d,this),this._tiles={},this._cache=new p(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new a.SourceFeatureState}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},b.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},b.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var b in this._tiles){var a=this._tiles[b];if("loaded"!==a.state&&"errored"!==a.state)return!1}return!0},b.prototype.getSource=function(){return this._source},b.prototype.pause=function(){this._paused=!0},b.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},b.prototype._loadTile=function(a,b){return this._source.loadTile(a,b)},b.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})},b.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})},b.prototype.serialize=function(){return this._source.serialize()},b.prototype.prepare=function(b){for(var c in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var a=this._tiles[c];a.upload(b),a.prepare(this.map.style.imageManager)}},b.prototype.getIds=function(){return a.values(this._tiles).map(function(a){return a.tileID}).sort(b4).map(function(a){return a.key})},b.prototype.getRenderableIds=function(c){var e=this,b=[];for(var d in this._tiles)this._isIdRenderable(d,c)&&b.push(this._tiles[d]);return c?b.sort(function(g,h){var b=g.tileID,c=h.tileID,d=new a.Point(b.canonical.x,b.canonical.y)._rotate(e.transform.angle),f=new a.Point(c.canonical.x,c.canonical.y)._rotate(e.transform.angle);return b.overscaledZ-c.overscaledZ||f.y-d.y||f.x-d.x}).map(function(a){return a.tileID.key}):b.map(function(a){return a.tileID}).sort(b4).map(function(a){return a.key})},b.prototype.hasRenderableParent=function(b){var a=this.findLoadedParent(b,0);return!!a&&this._isIdRenderable(a.tileID.key)},b.prototype._isIdRenderable=function(a,b){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(b||!this._tiles[a].holdingForFade())},b.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}for(var a in this._cache.reset(),this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(a,"reloading")},b.prototype._reloadTile=function(b,c){var a=this._tiles[b];a&&("loading"!==a.state&&(a.state=c),this._loadTile(a,this._tileLoaded.bind(this,a,b,c)))},b.prototype._tileLoaded=function(b,d,e,c){if(c){b.state="errored",404!==c.status?this._source.fire(new a.ErrorEvent(c,{tile:b})):this.update(this.transform);return}b.timeAdded=a.browser.now(),"expired"===e&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(d,b),"raster-dem"===this.getSource().type&&b.dem&&this._backfillDEM(b),this._state.initializeTileState(b,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:b,coord:b.tileID}))},b.prototype._backfillDEM=function(a){for(var c=this.getRenderableIds(),b=0;b<c.length;b++){var d=c[b];if(a.neighboringTiles&&a.neighboringTiles[d]){var e=this.getTileByID(d);f(a,e),f(e,a)}}function f(a,c){a.needsHillshadePrepare=!0;var b=c.tileID.canonical.x-a.tileID.canonical.x,e=c.tileID.canonical.y-a.tileID.canonical.y,d=Math.pow(2,a.tileID.canonical.z),f=c.tileID.key;(0!==b||0!==e)&& !(Math.abs(e)>1)&&(Math.abs(b)>1&&(1===Math.abs(b+d)?b+=d:1===Math.abs(b-d)&&(b-=d)),c.dem&&a.dem&&(a.dem.backfillBorder(c.dem,b,e),a.neighboringTiles&&a.neighboringTiles[f]&&(a.neighboringTiles[f].backfilled=!0)))}},b.prototype.getTile=function(a){return this.getTileByID(a.key)},b.prototype.getTileByID=function(a){return this._tiles[a]},b.prototype._retainLoadedChildren=function(h,d,i,e){for(var f in this._tiles){var a=this._tiles[f];if(!e[f]&&a.hasData()&&!(a.tileID.overscaledZ<=d)&&!(a.tileID.overscaledZ>i)){for(var b=a.tileID;a&&a.tileID.overscaledZ>d+1;){var g=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[g.key])&&a.hasData()&&(b=g)}for(var c=b;c.overscaledZ>d;)if(h[(c=c.scaledTo(c.overscaledZ-1)).key]){e[b.key]=b;break}}}},b.prototype.findLoadedParent=function(a,d){if(a.key in this._loadedParentTiles){var b=this._loadedParentTiles[a.key];return b&&b.tileID.overscaledZ>=d?b:null}for(var c=a.overscaledZ-1;c>=d;c--){var f=a.scaledTo(c),e=this._getLoadedTile(f);if(e)return e}},b.prototype._getLoadedTile=function(b){var a=this._tiles[b.key];return a&&a.hasData()?a:this._cache.getByKey(b.wrapped().key)},b.prototype.updateCacheSize=function(a){var c=Math.ceil(a.width/this._source.tileSize)+1,d=Math.ceil(a.height/this._source.tileSize)+1,b=Math.floor(c*d*5),e="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(e)},b.prototype.handleWrapJump=function(b){var g=void 0===this._prevLng?b:this._prevLng,c=Math.round((b-g)/360);if(this._prevLng=b,c){var d={};for(var h in this._tiles){var a=this._tiles[h];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+c),d[a.tileID.key]=a}for(var e in this._tiles=d,this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(var f in this._tiles){var i=this._tiles[f];this._setTileReloadTimer(f,i)}}},b.prototype.update=function(e){var d,y=this;if(this.transform=e,this._sourceLoaded&&!this._paused){this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?d=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(b){return new a.OverscaledTileID(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)}):(d=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(d=d.filter(function(a){return y._source.hasTile(a)}))):d=[];var g=e.coveringZoomLevel(this._source),t=Math.max(g-b.maxOverzooming,this._source.minzoom),u=Math.max(g+b.maxUnderzooming,this._source.minzoom),c=this._updateRetainedTiles(d,g);if(b5(this._source.type)){for(var j={},o={},v=Object.keys(c),k=0,p=v;k<p.length;k+=1){var l=p[k],q=c[l],m=this._tiles[l];if(!(!m||m.fadeEndTime&&m.fadeEndTime<=a.browser.now())){var h=this.findLoadedParent(q,t);h&&(this._addTile(h.tileID),j[h.tileID.key]=h.tileID),o[l]=q}}for(var i in this._retainLoadedChildren(o,g,u,c),j)c[i]||(this._coveredTiles[i]=!0,c[i]=j[i])}for(var w in c)this._tiles[w].clearFadeHold();for(var x=a.keysDifference(this._tiles,c),n=0,r=x;n<r.length;n+=1){var s=r[n],f=this._tiles[s];f.hasSymbolBuckets&&!f.holdingForFade()?f.setHoldDuration(this.map._fadeDuration):(!f.hasSymbolBuckets||f.symbolFadeFinished())&&this._removeTile(s)}this._updateLoadedParentTileCache()}},b.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)},b.prototype._updateRetainedTiles=function(m,e){for(var a={},n={},t=Math.max(e-b.maxOverzooming,this._source.minzoom),u=Math.max(e+b.maxUnderzooming,this._source.minzoom),o={},i=0,p=m;i<p.length;i+=1){var f=p[i],v=this._addTile(f);a[f.key]=f,!v.hasData()&&e<this._source.maxzoom&&(o[f.key]=f)}this._retainLoadedChildren(o,e,u,a);for(var j=0,q=m;j<q.length;j+=1){var g=q[j],c=this._tiles[g.key];if(!c.hasData()){if(e+1>this._source.maxzoom){var k=g.children(this._source.maxzoom)[0],r=this.getTile(k);if(r&&r.hasData()){a[k.key]=k;continue}}else{var h=g.children(this._source.maxzoom);if(a[h[0].key]&&a[h[1].key]&&a[h[2].key]&&a[h[3].key])continue}for(var s=c.wasRequested(),l=g.overscaledZ-1;l>=t;--l){var d=g.scaledTo(l);if(n[d.key])break;if(n[d.key]=!0,(c=this.getTile(d))||!s||(c=this._addTile(d)),c&&(a[d.key]=d,s=c.wasRequested(),c.hasData()))break}}}return a},b.prototype._updateLoadedParentTileCache=function(){for(var g in this._loadedParentTiles={},this._tiles){for(var d=[],b=void 0,a=this._tiles[g].tileID;a.overscaledZ>0;){if(a.key in this._loadedParentTiles){b=this._loadedParentTiles[a.key];break}d.push(a.key);var e=a.scaledTo(a.overscaledZ-1);if(b=this._getLoadedTile(e))break;a=e}for(var c=0,f=d;c<f.length;c+=1){var h=f[c];this._loadedParentTiles[h]=b}}},b.prototype._addTile=function(c){var b=this._tiles[c.key];if(b)return b;(b=this._cache.getAndRemove(c))&&(this._setTileReloadTimer(c.key,b),b.tileID=c,this._state.initializeTileState(b,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,b)));var d=Boolean(b);return(d||(b=new a.Tile(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(b,this._tileLoaded.bind(this,b,c.key,b.state))),b)?(b.uses++,this._tiles[c.key]=b,d||this._source.fire(new a.Event("dataloading",{tile:b,coord:b.tileID,dataType:"source"})),b):null},b.prototype._setTileReloadTimer=function(a,c){var d=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var b=c.getExpiryTimeout();b&&(this._timers[a]=setTimeout(function(){d._reloadTile(a,"expired"),delete d._timers[a]},b))},b.prototype._removeTile=function(b){var a=this._tiles[b];a&&(a.uses--,delete this._tiles[b],this._timers[b]&&(clearTimeout(this._timers[b]),delete this._timers[b]),a.uses>0||(a.hasData()&&"reloading"!==a.state?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))},b.prototype.clearTiles=function(){for(var a in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(a);this._cache.reset()},b.prototype.tilesIn=function(c,q,m){var r=this,f=[],g=this.transform;if(!g)return f;for(var n=m?g.getCameraQueryGeometry(c):c,s=c.map(function(a){return g.pointCoordinate(a)}),o=n.map(function(a){return g.pointCoordinate(a)}),p=this.getIds(),h=1/0,i=1/0,j=-1/0,k=-1/0,d=0,l=o;d<l.length;d+=1){var b=l[d];h=Math.min(h,b.x),i=Math.min(i,b.y),j=Math.max(j,b.x),k=Math.max(k,b.y)}for(var e=0;e<p.length;e++)!function(m){var b=r._tiles[p[m]];if(!b.holdingForFade()){var e=b.tileID,l=Math.pow(2,g.zoom-b.tileID.overscaledZ),c=q*b.queryPadding*a.EXTENT/b.tileSize/l,d=[e.getTilePoint(new a.MercatorCoordinate(h,i)),e.getTilePoint(new a.MercatorCoordinate(j,k))];if(d[0].x-c<a.EXTENT&&d[0].y-c<a.EXTENT&&d[1].x+c>=0&&d[1].y+c>=0){var n=s.map(function(a){return e.getTilePoint(a)}),t=o.map(function(a){return e.getTilePoint(a)});f.push({tile:b,tileID:e,queryGeometry:n,cameraQueryGeometry:t,scale:l})}}}(e);return f},b.prototype.getVisibleCoordinates=function(e){for(var f=this,b=this.getRenderableIds(e).map(function(a){return f._tiles[a].tileID}),a=0,c=b;a<c.length;a+=1){var d=c[a];d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped())}return b},b.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(b5(this._source.type))for(var c in this._tiles){var b=this._tiles[c];if(void 0!==b.fadeEndTime&&b.fadeEndTime>=a.browser.now())return!0}return!1},b.prototype.setFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.updateState(a,b,c)},b.prototype.removeFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.removeFeatureState(a,b,c)},b.prototype.getFeatureState=function(a,b){return a=a||"_geojsonTileLayer",this._state.getState(a,b)},b.prototype.setDependencies=function(b,c,d){var a=this._tiles[b];a&&a.setDependencies(c,d)},b.prototype.reloadTilesForDependencies=function(b,c){for(var a in this._tiles)this._tiles[a].hasDependency(b,c)&&this._reloadTile(a,"reloading");this._cache.filter(function(a){return!a.hasDependency(b,c)})},b}(a.Evented);function b4(a,b){var c=Math.abs(2*a.wrap)- +(a.wrap<0),d=Math.abs(2*b.wrap)- +(b.wrap<0);return a.overscaledZ-b.overscaledZ||d-c||b.canonical.y-a.canonical.y||b.canonical.x-a.canonical.x}function b5(a){return"raster"===a||"image"===a||"video"===a}function b6(){return new a.window.Worker(a8.workerUrl)}ak.maxOverzooming=10,ak.maxUnderzooming=3;var b7="mapboxgl_preloaded_worker_pool",z=function(){this.active={}};z.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<z.workerCount;)this.workers.push(new b6);return this.active[a]=!0,this.workers.slice()},z.prototype.release=function(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},z.prototype.isPreloaded=function(){return!!this.active[b7]},z.prototype.numActive=function(){return Object.keys(this.active).length};var ax=Math.floor(a.browser.hardwareConcurrency/2);function b8(){return ba||(ba=new z),ba}function b9(c,e){var d={};for(var b in c)"ref"!==b&&(d[b]=c[b]);return a.refProperties.forEach(function(a){a in e&&(d[a]=e[a])}),d}function ca(a){a=a.slice();for(var d=Object.create(null),c=0;c<a.length;c++)d[a[c].id]=a[c];for(var b=0;b<a.length;b++)"ref"in a[b]&&(a[b]=b9(a[b],d[a[b].ref]));return a}z.workerCount=Math.max(Math.min(ax,6),1);var al={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function cb(a,b,c){c.push({command:al.addSource,args:[a,b[a]]})}function cc(a,b,c){b.push({command:al.removeSource,args:[a]}),c[a]=!0}function cd(a,c,b,d){cc(a,b,d),cb(a,c,b)}function ce(d,e,c){var b;for(b in d[c])if(d[c].hasOwnProperty(b)&&"data"!==b&&!a.deepEqual(d[c][b],e[c][b]))return!1;for(b in e[c])if(e[c].hasOwnProperty(b)&&"data"!==b&&!a.deepEqual(d[c][b],e[c][b]))return!1;return!0}function cf(d,c,e,f,g,h){var b;for(b in c=c||{},d=d||{})d.hasOwnProperty(b)&&(a.deepEqual(d[b],c[b])||e.push({command:h,args:[f,b,c[b],g]}));for(b in c)!(!c.hasOwnProperty(b)||d.hasOwnProperty(b))&&(a.deepEqual(d[b],c[b])||e.push({command:h,args:[f,b,c[b],g]}))}function cg(a){return a.id}function ch(a,b){return a[b.id]=b,a}var am=function(a,b){this.reset(a,b)};am.prototype.reset=function(b,c){this.points=b||[],this._distances=[0];for(var a=1;a<this.points.length;a++)this._distances[a]=this._distances[a-1]+this.points[a].dist(this.points[a-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding},am.prototype.lerp=function(c){if(1===this.points.length)return this.points[0];c=a.clamp(c,0,1);for(var b=1,d=this._distances[b],e=c*this.paddedLength+this.padding;d<e&&b<this._distances.length;)d=this._distances[++b];var f=b-1,g=this._distances[f],h=d-g,i=h>0?(e-g)/h:0;return this.points[f].mult(1-i).add(this.points[b].mult(i))};var g=function(a,b,c){var e=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(a/c),this.yCellCount=Math.ceil(b/c);for(var d=0;d<this.xCellCount*this.yCellCount;d++)e.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=b,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/b,this.boxUid=0,this.circleUid=0};function ci(e,f,g,c,d){var b=a.create();return f?(a.scale(b,b,[1/d,1/d,1]),g||a.rotateZ(b,b,c.angle)):a.multiply(b,c.labelPlaneMatrix,e),b}function cj(e,f,g,c,d){if(!f)return c.glCoordMatrix;var b=a.clone(e);return a.scale(b,b,[d,d,1]),g||a.rotateZ(b,b,-c.angle),b}function ck(d,e){var b=[d.x,d.y,0,1];cv(b,b,e);var c=b[3];return{point:new a.Point(b[0]/c,b[1]/c),signedDistanceFromCamera:c}}function cl(a,b){return .5+.5*(a/b)}function cm(a,b){var c=a[0]/a[3],d=a[1]/a[3];return c>= -b[0]&&c<=b[0]&&d>= -b[1]&&d<=b[1]}function cn(c,i,e,f,j,n,y,o){var p=f?c.textSizeData:c.iconSizeData,z=a.evaluateSizeForZoom(p,e.transform.zoom),A=[256/e.width*2+1,256/e.height*2+1],d=f?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;d.clear();for(var q=c.lineVertexArray,r=f?c.text.placedSymbolArray:c.icon.placedSymbolArray,s=e.transform.width/e.transform.height,g=!1,k=0;k<r.length;k++){var b=r.get(k);if(b.hidden||b.writingMode===a.WritingMode.vertical&&!g){cu(b.numGlyphs,d);continue}g=!1;var h=[b.anchorX,b.anchorY,0,1];if(a.transformMat4(h,h,i),!cm(h,A)){cu(b.numGlyphs,d);continue}var B=h[3],t=cl(e.transform.cameraToCenterDistance,B),u=a.evaluateSizeForFeature(p,z,b),v=y?u/t:u*t,l=new a.Point(b.anchorX,b.anchorY),w=ck(l,j).point,x={},m=cq(b,v,!1,o,i,j,n,c.glyphOffsetArray,q,d,w,l,x,s);g=m.useVertical,(m.notEnoughRoom||g||m.needsFlipping&&cq(b,v,!0,o,i,j,n,c.glyphOffsetArray,q,d,w,l,x,s).notEnoughRoom)&&cu(b.numGlyphs,d)}f?c.text.dynamicLayoutVertexBuffer.updateData(d):c.icon.dynamicLayoutVertexBuffer.updateData(d)}function co(b,c,d,e,f,g,h,a,i,j,k){var p=a.glyphStartIndex+a.numGlyphs,l=a.lineStartIndex,m=a.lineStartIndex+a.lineLength,q=c.getoffsetX(a.glyphStartIndex),r=c.getoffsetX(p-1),n=cs(b*q,d,e,f,g,h,a.segment,l,m,i,j,k);if(!n)return null;var o=cs(b*r,d,e,f,g,h,a.segment,l,m,i,j,k);return o?{first:n,last:o}:null}function cp(d,b,c,e){if(d===a.WritingMode.horizontal){var f=Math.abs(c.y-b.y),g=Math.abs(c.x-b.x)*e;if(f>g)return{useVertical:!0}}return(d===a.WritingMode.vertical?b.y<c.y:b.x>c.x)?{needsFlipping:!0}:null}function cq(b,D,c,r,i,j,s,k,d,E,l,e,m,t){var f,g=D/24,n=b.lineOffsetX*g,o=b.lineOffsetY*g;if(b.numGlyphs>1){var F=b.glyphStartIndex+b.numGlyphs,G=b.lineStartIndex,H=b.lineStartIndex+b.lineLength,h=co(g,k,n,o,c,l,e,b,d,j,m);if(!h)return{notEnoughRoom:!0};var I=ck(h.first.point,s).point,J=ck(h.last.point,s).point;if(r&&!c){var u=cp(b.writingMode,I,J,t);if(u)return u}f=[h.first];for(var p=b.glyphStartIndex+1;p<F-1;p++)f.push(cs(g*k.getoffsetX(p),n,o,c,l,e,b.segment,G,H,d,j,m));f.push(h.last)}else{if(r&&!c){var v=ck(e,i).point,w=b.lineStartIndex+b.segment+1,x=new a.Point(d.getx(w),d.gety(w)),y=ck(x,i),K=y.signedDistanceFromCamera>0?y.point:cr(e,x,v,1,i),z=cp(b.writingMode,v,K,t);if(z)return z}var A=cs(g*k.getoffsetX(b.glyphStartIndex),n,o,c,l,e,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,d,j,m);if(!A)return{notEnoughRoom:!0};f=[A]}for(var q=0,B=f;q<B.length;q+=1){var C=B[q];a.addDynamicAttributes(E,C.point,C.angle)}return{}}function cr(a,d,b,e,f){var g=ck(a.add(a.sub(d)._unit()),f).point,c=b.sub(g);return b.add(c._mult(e/c.mag()))}function cs(n,o,z,p,q,A,r,i,B,g,s,t){var u=p?n-o:n+o,e=u>0?1:-1,j=0;p&&(e*=-1,j=Math.PI),e<0&&(j+=Math.PI);for(var c=e>0?i+r:i+r+1,b=q,d=q,f=0,h=0,k=Math.abs(u),l=[];f+h<=k;){if((c+=e)<i||c>=B)return null;if(d=b,l.push(b),void 0===(b=t[c])){var v=new a.Point(g.getx(c),g.gety(c)),w=ck(v,s);if(w.signedDistanceFromCamera>0)b=t[c]=w.point;else{var x=c-e;b=cr(0===f?A:new a.Point(g.getx(x),g.gety(x)),v,d,k-f+1,s)}}f+=h,h=d.dist(b)}var y=b.sub(d),m=y.mult((k-f)/h)._add(d);m._add(y._unit()._perp()._mult(z*e));var C=j+Math.atan2(b.y-d.y,b.x-d.x);return l.push(m),{point:m,angle:C,path:l}}g.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},g.prototype.insert=function(e,a,b,c,d){this._forEachCell(a,b,c,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d)},g.prototype.insertCircle=function(d,b,c,a){this._forEachCell(b-a,c-a,b+a,c+a,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(b),this.circles.push(c),this.circles.push(a)},g.prototype._insertBoxCell=function(c,d,e,f,a,b){this.boxCells[a].push(b)},g.prototype._insertCircleCell=function(c,d,e,f,a,b){this.circleCells[a].push(b)},g.prototype._query=function(f,g,h,i,d,j){if(h<0||f>this.width||i<0||g>this.height)return!d&&[];var a=[];if(f<=0&&g<=0&&this.width<=h&&this.height<=i){if(d)return!0;for(var b=0;b<this.boxKeys.length;b++)a.push({key:this.boxKeys[b],x1:this.bboxes[4*b],y1:this.bboxes[4*b+1],x2:this.bboxes[4*b+2],y2:this.bboxes[4*b+3]});for(var c=0;c<this.circleKeys.length;c++){var k=this.circles[3*c],l=this.circles[3*c+1],e=this.circles[3*c+2];a.push({key:this.circleKeys[c],x1:k-e,y1:l-e,x2:k+e,y2:l+e})}return j?a.filter(j):a}var m={hitTest:d,seenUids:{box:{},circle:{}}};return this._forEachCell(f,g,h,i,this._queryCell,a,m,j),d?a.length>0:a},g.prototype._queryCircle=function(b,c,a,d,j){var f=b-a,g=b+a,h=c-a,i=c+a;if(g<0||f>this.width||i<0||h>this.height)return!d&&[];var e=[];return this._forEachCell(f,h,g,i,this._queryCellCircle,e,{hitTest:d,circle:{x:b,y:c,radius:a},seenUids:{box:{},circle:{}}},j),d?e.length>0:e},g.prototype.query=function(a,b,c,d,e){return this._query(a,b,c,d,!1,e)},g.prototype.hitTest=function(a,b,c,d,e){return this._query(a,b,c,d,!0,e)},g.prototype.hitTestCircle=function(a,b,c,d){return this._queryCircle(a,b,c,!0,d)},g.prototype._queryCell=function(n,o,p,q,r,g,k,h){var i=k.seenUids,s=this.boxCells[r];if(null!==s)for(var a=this.bboxes,l=0,t=s;l<t.length;l+=1){var e=t[l];if(!i.box[e]){i.box[e]=!0;var b=4*e;if(n<=a[b+2]&&o<=a[b+3]&&p>=a[b+0]&&q>=a[b+1]&&(!h||h(this.boxKeys[e]))){if(k.hitTest)return g.push(!0),!0;g.push({key:this.boxKeys[e],x1:a[b],y1:a[b+1],x2:a[b+2],y2:a[b+3]})}}}var u=this.circleCells[r];if(null!==u)for(var c=this.circles,m=0,v=u;m<v.length;m+=1){var f=v[m];if(!i.circle[f]){i.circle[f]=!0;var d=3*f;if(this._circleAndRectCollide(c[d],c[d+1],c[d+2],n,o,p,q)&&(!h||h(this.circleKeys[f]))){if(k.hitTest)return g.push(!0),!0;var w=c[d],x=c[d+1],j=c[d+2];g.push({key:this.circleKeys[f],x1:w-j,y1:x-j,x2:w+j,y2:x+j})}}}},g.prototype._queryCellCircle=function(s,t,u,v,l,m,n,b){var a=n.circle,c=n.seenUids,o=this.boxCells[l];if(null!==o)for(var d=this.bboxes,h=0,p=o;h<p.length;h+=1){var e=p[h];if(!c.box[e]){c.box[e]=!0;var f=4*e;if(this._circleAndRectCollide(a.x,a.y,a.radius,d[f+0],d[f+1],d[f+2],d[f+3])&&(!b||b(this.boxKeys[e])))return m.push(!0),!0}}var q=this.circleCells[l];if(null!==q)for(var i=this.circles,j=0,r=q;j<r.length;j+=1){var g=r[j];if(!c.circle[g]){c.circle[g]=!0;var k=3*g;if(this._circlesCollide(i[k],i[k+1],i[k+2],a.x,a.y,a.radius)&&(!b||b(this.circleKeys[g])))return m.push(!0),!0}}},g.prototype._forEachCell=function(c,d,e,f,g,h,i,j){for(var k=this._convertToXCellCoord(c),l=this._convertToYCellCoord(d),m=this._convertToXCellCoord(e),n=this._convertToYCellCoord(f),a=k;a<=m;a++)for(var b=l;b<=n;b++){var o=this.xCellCount*b+a;if(g.call(this,c,d,e,f,o,h,i,j))return}},g.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},g.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},g.prototype._circlesCollide=function(d,e,f,g,h,i){var a=g-d,b=h-e,c=f+i;return c*c>a*a+b*b},g.prototype._circleAndRectCollide=function(j,k,a,f,g,l,m){var b=(l-f)/2,d=Math.abs(j-(f+b));if(d>b+a)return!1;var c=(m-g)/2,e=Math.abs(k-(g+c));if(e>c+a)return!1;if(d<=b||e<=c)return!0;var h=d-b,i=e-c;return h*h+i*i<=a*a};var ct=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function cu(d,a){for(var b=0;b<d;b++){var c=a.length;a.resize(c+4),a.float32.set(ct,3*c)}}function cv(b,e,a){var c=e[0],d=e[1];return b[0]=a[0]*c+a[4]*d+a[12],b[1]=a[1]*c+a[5]*d+a[13],b[3]=a[3]*c+a[7]*d+a[15],b}var u=function(a,b,c){void 0===b&&(b=new g(a.width+200,a.height+200,25)),void 0===c&&(c=new g(a.width+200,a.height+200,25)),this.transform=a,this.grid=b,this.ignoredGrid=c,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function cw(b,c,d){return c*(a.EXTENT/(b.tileSize*Math.pow(2,d-b.tileID.overscaledZ)))}u.prototype.placeCollisionBox=function(a,h,i,j,k){var b=this.projectAndGetPerspectiveRatio(j,a.anchorPointX,a.anchorPointY),c=i*b.perspectiveRatio,d=a.x1*c+b.point.x,e=a.y1*c+b.point.y,f=a.x2*c+b.point.x,g=a.y2*c+b.point.y;return!this.isInsideGrid(d,e,f,g)|| !h&&this.grid.hitTest(d,e,f,g,k)?{box:[],offscreen:!1}:{box:[d,e,f,g],offscreen:this.isOffscreen(d,e,f,g)}},u.prototype.placeCollisionCircles=function(M,i,N,O,y,P,z,Q,A,R,S,T,U){var B=[],n=new a.Point(i.anchorX,i.anchorY),V=ck(n,P),o=cl(this.transform.cameraToCenterDistance,V.signedDistanceFromCamera),p=(R?y/o:y*o)/a.ONE_EM,W=ck(n,z).point,X=i.lineOffsetX*p,Y=i.lineOffsetY*p,q=co(p,O,X,Y,!1,W,n,i,N,z,{}),j=!1,r=!1,s=!0;if(q){for(var c=.5*T*o+U,f=new a.Point(-100,-100),g=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),k=new am,C=q.first,D=q.last,b=[],t=C.path.length-1;t>=1;t--)b.push(C.path[t]);for(var u=1;u<D.path.length;u++)b.push(D.path[u]);var Z=2.5*c;if(Q){var E=b.map(function(a){return ck(a,Q)});b=E.some(function(a){return a.signedDistanceFromCamera<=0})?[]:E.map(function(a){return a.point})}var F=[];if(b.length>0){for(var d=b[0].clone(),e=b[0].clone(),h=1;h<b.length;h++)d.x=Math.min(d.x,b[h].x),d.y=Math.min(d.y,b[h].y),e.x=Math.max(e.x,b[h].x),e.y=Math.max(e.y,b[h].y);F=d.x>=f.x&&e.x<=g.x&&d.y>=f.y&&e.y<=g.y?[b]:e.x<f.x||d.x>g.x||e.y<f.y||d.y>g.y?[]:a.clipLine([b],f.x,f.y,g.x,g.y)}for(var v=0,G=F;v<G.length;v+=1){var $=G[v];k.reset($,.25*c);var w=0;w=k.length<=.5*c?1:Math.ceil(k.paddedLength/Z)+1;for(var x=0;x<w;x++){var _=x/Math.max(w-1,1),H=k.lerp(_),l=H.x+100,m=H.y+100;B.push(l,m,c,0);var I=l-c,J=m-c,K=l+c,L=m+c;if(s=s&&this.isOffscreen(I,J,K,L),r=r||this.isInsideGrid(I,J,K,L),!M&&this.grid.hitTestCircle(l,m,c,S)&&(j=!0,!A))return{circles:[],offscreen:!1,collisionDetected:j}}}}return{circles:(A||!j)&&r?B:[],offscreen:s,collisionDetected:j}},u.prototype.queryRenderedSymbols=function(m){if(0===m.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var n=[],e=1/0,f=1/0,g=-1/0,h=-1/0,k=0,o=m;k<o.length;k+=1){var p=o[k],d=new a.Point(p.x+100,p.y+100);e=Math.min(e,d.x),f=Math.min(f,d.y),g=Math.max(g,d.x),h=Math.max(h,d.y),n.push(d)}for(var r=this.grid.query(e,f,g,h).concat(this.ignoredGrid.query(e,f,g,h)),i={},j={},l=0,q=r;l<q.length;l+=1){var c=q[l],b=c.key;if(void 0===i[b.bucketInstanceId]&&(i[b.bucketInstanceId]={}),!i[b.bucketInstanceId][b.featureIndex]){var s=[new a.Point(c.x1,c.y1),new a.Point(c.x2,c.y1),new a.Point(c.x2,c.y2),new a.Point(c.x1,c.y2)];a.polygonIntersectsPolygon(n,s)&&(i[b.bucketInstanceId][b.featureIndex]=!0,void 0===j[b.bucketInstanceId]&&(j[b.bucketInstanceId]=[]),j[b.bucketInstanceId].push(b.featureIndex))}}return j},u.prototype.insertCollisionBox=function(a,b,c,d,e){(b?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:d,collisionGroupID:e},a[0],a[1],a[2],a[3])},u.prototype.insertCollisionCircles=function(b,c,d,e,f){for(var g=c?this.ignoredGrid:this.grid,h={bucketInstanceId:d,featureIndex:e,collisionGroupID:f},a=0;a<b.length;a+=4)g.insertCircle(h,b[a],b[a+1],b[a+2])},u.prototype.projectAndGetPerspectiveRatio=function(c,d,e){var b=[d,e,0,1];return cv(b,b,c),{point:new a.Point((b[0]/b[3]+1)/2*this.transform.width+100,(-b[1]/b[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/b[3])}},u.prototype.isOffscreen=function(a,b,c,d){return c<100||a>=this.screenRightBoundary||d<100||b>this.screenBottomBoundary},u.prototype.isInsideGrid=function(a,b,c,d){return c>=0&&a<this.gridRightBoundary&&d>=0&&b<this.gridBottomBoundary},u.prototype.getViewportMatrix=function(){var b=a.identity([]);return a.translate(b,b,[-100,-100,0]),b};var ay=function(a,b,c,d){a?this.opacity=Math.max(0,Math.min(1,a.opacity+(a.placed?b:-b))):this.opacity=d&&c?1:0,this.placed=c};ay.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var az=function(a,b,d,e,c){this.text=new ay(a?a.text:null,b,d,c),this.icon=new ay(a?a.icon:null,b,e,c)};az.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var cx=function(a,b,c){this.text=a,this.icon=b,this.skipFade=c},cy=function(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]},cz=function(a,b,c,d,e){this.bucketInstanceId=a,this.featureIndex=b,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=e},aA=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function cA(b,f,g,h,c){var d=a.getAnchorAlignment(b),i=d.horizontalAlign,j=d.verticalAlign,e=a.evaluateVariableOffset(b,h);return new a.Point(-(i-.5)*f+e[0]*c,-(j-.5)*g+e[1]*c)}function cB(b,e,f,g,h,d){var i=b.x1,j=b.x2,k=b.y1,l=b.y2,m=b.anchorPointX,n=b.anchorPointY,c=new a.Point(e,f);return g&&c._rotate(h?d:-d),{x1:i+c.x,y1:k+c.y,x2:j+c.x,y2:l+c.y,anchorPointX:m,anchorPointY:n}}aA.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var b=++this.maxGroupID;this.collisionGroups[a]={ID:b,predicate:function(a){return a.collisionGroupID===b}}}return this.collisionGroups[a]};var k=function(b,c,d,a){this.transform=b.clone(),this.collisionIndex=new u(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new aA(d),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}};function cC(a,b,c,d,e){a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0)}function cD(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var b=a.placed?1:0,c=Math.floor(127*a.opacity);return 33554432*c+16777216*b+131072*c+65536*b+512*c+256*b+2*c+b}k.prototype.getBucketParts=function(i,j,c,q){var b=c.getBucket(j),k=c.latestFeatureIndex;if(b&&k&&j.id===b.layerIds[0]){var r=c.collisionBoxArray,d=b.layers[0].layout,s=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),t=c.tileSize/a.EXTENT,e=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),f="map"===d.get("text-pitch-alignment"),l="map"===d.get("text-rotation-alignment"),m=cw(c,1,this.transform.zoom),u=ci(e,f,l,this.transform,m),n=null;if(f){var v=cj(e,f,l,this.transform,m);n=a.multiply([],this.transform.labelPlaneMatrix,v)}this.retainedQueryData[b.bucketInstanceId]=new cz(b.bucketInstanceId,k,b.sourceLayerIndex,b.index,c.tileID);var o={bucket:b,layout:d,posMatrix:e,textLabelPlaneMatrix:u,labelToScreenMatrix:n,scale:s,textPixelRatio:t,holdingForFade:c.holdingForFade(),collisionBoxArray:r,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(q)for(var g=0,p=b.sortKeyRanges;g<p.length;g+=1){var h=p[g],w=h.sortKey,x=h.symbolInstanceStart,y=h.symbolInstanceEnd;i.push({sortKey:w,symbolInstanceStart:x,symbolInstanceEnd:y,parameters:o})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:o})}},k.prototype.attemptAnchorPlacement=function(c,s,f,g,h,i,j,k,l,m,n,a,d,e,o){var p,q=[a.textOffset0,a.textOffset1],b=cA(c,f,g,q,h),r=this.collisionIndex.placeCollisionBox(cB(s,b.x,b.y,i,j,this.transform.angle),n,k,l,m.predicate);if((!o||0!==this.collisionIndex.placeCollisionBox(cB(o,b.x,b.y,i,j,this.transform.angle),n,k,l,m.predicate).box.length)&&r.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[a.crossTileID]&&this.prevPlacement.placements[a.crossTileID]&&this.prevPlacement.placements[a.crossTileID].text&&(p=this.prevPlacement.variableOffsets[a.crossTileID].anchor),this.variableOffsets[a.crossTileID]={textOffset:q,width:f,height:g,anchor:c,textBoxScale:h,prevAnchor:p},this.markUsedJustification(d,c,a,e),d.allowVerticalPlacement&&(this.markUsedOrientation(d,e,a),this.placedOrientations[a.crossTileID]=e),{shift:b,placedGlyphBoxes:r}},k.prototype.placeLayerBucketPart=function(f,t,o){var u=this,c=f.parameters,b=c.bucket,d=c.layout,p=c.posMatrix,v=c.textLabelPlaneMatrix,w=c.labelToScreenMatrix,x=c.textPixelRatio,y=c.holdingForFade,h=c.collisionBoxArray,z=c.partiallyEvaluatedTextSize,A=c.collisionGroup,q=d.get("text-optional"),r=d.get("icon-optional"),i=d.get("text-allow-overlap"),j=d.get("icon-allow-overlap"),B="map"===d.get("text-rotation-alignment"),C="map"===d.get("text-pitch-alignment"),D="none"!==d.get("icon-text-fit"),s="viewport-y"===d.get("symbol-z-order"),E=i&&(j||!b.hasIconData()||r),F=j&&(i||!b.hasTextData()||q);!b.collisionArrays&&h&&b.deserializeCollisionBoxes(h);var k=function(c,f){if(!t[c.crossTileID]){if(y){u.placements[c.crossTileID]=new cx(!1,!1,!1);return}var e=!1,l=!1,m=!0,$=null,h={box:null,offscreen:null},s={box:null,offscreen:null},k=null,g=null,G=null,I=0,J=0,M=0;f.textFeatureIndex?I=f.textFeatureIndex:c.useRuntimeCollisionCircles&&(I=c.featureIndex),f.verticalTextFeatureIndex&&(J=f.verticalTextFeatureIndex);var V=f.textBox;if(V){var N=function(f){var d=a.WritingMode.horizontal;if(b.allowVerticalPlacement&&!f&&u.prevPlacement){var e=u.prevPlacement.placedOrientations[c.crossTileID];e&&(u.placedOrientations[c.crossTileID]=e,d=e,u.markUsedOrientation(b,d,c))}return d},O=function(e,i){if(b.allowVerticalPlacement&&c.numVerticalGlyphVertices>0&&f.verticalTextBox)for(var d=0,g=b.writingModes;d<g.length&&(g[d]===a.WritingMode.vertical?s=h=i():h=e(),!h||!h.box||!h.box.length);d+=1);else h=e()};if(d.get("text-variable-anchor")){var K=d.get("text-variable-anchor");if(u.prevPlacement&&u.prevPlacement.variableOffsets[c.crossTileID]){var P=u.prevPlacement.variableOffsets[c.crossTileID];K.indexOf(P.anchor)>0&&(K=K.filter(function(a){return a!==P.anchor})).unshift(P.anchor)}var _=function(a,h,k){for(var l=a.x2-a.x1,m=a.y2-a.y1,n=c.textBoxScale,o=D&&!j?h:null,d={box:[],offscreen:!1},q=i?2*K.length:K.length,f=0;f<q;++f){var r=K[f%K.length],s=f>=K.length,g=u.attemptAnchorPlacement(r,a,l,m,n,B,C,x,p,A,s,c,b,k,o);if(g&&(d=g.placedGlyphBoxes)&&d.box&&d.box.length){e=!0,$=g.shift;break}}return d};O(function(){return _(V,f.iconBox,a.WritingMode.horizontal)},function(){var d=f.verticalTextBox,e=h&&h.box&&h.box.length;return b.allowVerticalPlacement&&!e&&c.numVerticalGlyphVertices>0&&d?_(d,f.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),h&&(e=h.box,m=h.offscreen);var W=N(h&&h.box);if(!e&&u.prevPlacement){var L=u.prevPlacement.variableOffsets[c.crossTileID];L&&(u.variableOffsets[c.crossTileID]=L,u.markUsedJustification(b,L.anchor,c,W))}}else{var aa=function(e,d){var a=u.collisionIndex.placeCollisionBox(e,i,x,p,A.predicate);return a&&a.box&&a.box.length&&(u.markUsedOrientation(b,d,c),u.placedOrientations[c.crossTileID]=d),a};O(function(){return aa(V,a.WritingMode.horizontal)},function(){var d=f.verticalTextBox;return b.allowVerticalPlacement&&c.numVerticalGlyphVertices>0&&d?aa(d,a.WritingMode.vertical):{box:null,offscreen:null}}),N(h&&h.box&&h.box.length)}}if(e=(k=h)&&k.box&&k.box.length>0,m=k&&k.offscreen,c.useRuntimeCollisionCircles){var Q=b.text.placedSymbolArray.get(c.centerJustifiedTextSymbolIndex),X=a.evaluateSizeForFeature(b.textSizeData,z,Q),Y=d.get("text-padding"),Z=c.collisionCircleDiameter;g=u.collisionIndex.placeCollisionCircles(i,Q,b.lineVertexArray,b.glyphOffsetArray,X,p,v,w,o,C,A.predicate,Z,Y),e=i||g.circles.length>0&&!g.collisionDetected,m=m&&g.offscreen}if(f.iconFeatureIndex&&(M=f.iconFeatureIndex),f.iconBox){var R=function(a){var b=D&&$?cB(a,$.x,$.y,B,C,u.transform.angle):a;return u.collisionIndex.placeCollisionBox(b,j,x,p,A.predicate)};l=s&&s.box&&s.box.length&&f.verticalIconBox?(G=R(f.verticalIconBox)).box.length>0:(G=R(f.iconBox)).box.length>0,m=m&&G.offscreen}var S=q||0===c.numHorizontalGlyphVertices&&0===c.numVerticalGlyphVertices,T=r||0===c.numIconVertices;if(S||T?T?S||(l=l&&e):e=l&&e:l=e=l&&e,e&&k&&k.box&&(s&&s.box&&J?u.collisionIndex.insertCollisionBox(k.box,d.get("text-ignore-placement"),b.bucketInstanceId,J,A.ID):u.collisionIndex.insertCollisionBox(k.box,d.get("text-ignore-placement"),b.bucketInstanceId,I,A.ID)),l&&G&&u.collisionIndex.insertCollisionBox(G.box,d.get("icon-ignore-placement"),b.bucketInstanceId,M,A.ID),g&&(e&&u.collisionIndex.insertCollisionCircles(g.circles,d.get("text-ignore-placement"),b.bucketInstanceId,I,A.ID),o)){var U=b.bucketInstanceId,n=u.collisionCircleArrays[U];void 0===n&&(n=u.collisionCircleArrays[U]=new cy);for(var H=0;H<g.circles.length;H+=4)n.circles.push(g.circles[H+0]),n.circles.push(g.circles[H+1]),n.circles.push(g.circles[H+2]),n.circles.push(g.collisionDetected?1:0)}u.placements[c.crossTileID]=new cx(e||E,l||F,m||b.justReloaded),t[c.crossTileID]=!0}};if(s)for(var l=b.getSortedSymbolIndexes(this.transform.angle),g=l.length-1;g>=0;--g){var m=l[g];k(b.symbolInstances.get(m),b.collisionArrays[m])}else for(var e=f.symbolInstanceStart;e<f.symbolInstanceEnd;e++)k(b.symbolInstances.get(e),b.collisionArrays[e]);if(o&&b.bucketInstanceId in this.collisionCircleArrays){var n=this.collisionCircleArrays[b.bucketInstanceId];a.invert(n.invProjMatrix,p),n.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1},k.prototype.markUsedJustification=function(f,h,b,i){var d,j={left:b.leftJustifiedTextSymbolIndex,center:b.centerJustifiedTextSymbolIndex,right:b.rightJustifiedTextSymbolIndex};d=i===a.WritingMode.vertical?b.verticalPlacedTextSymbolIndex:j[a.getAnchorJustification(h)];for(var k=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex,b.verticalPlacedTextSymbolIndex],e=0,g=k;e<g.length;e+=1){var c=g[e];c>=0&&(d>=0&&c!==d?f.text.placedSymbolArray.get(c).crossTileID=0:f.text.placedSymbolArray.get(c).crossTileID=b.crossTileID)}},k.prototype.markUsedOrientation=function(e,b,c){for(var g=b===a.WritingMode.horizontal||b===a.WritingMode.horizontalOnly?b:0,h=b===a.WritingMode.vertical?b:0,i=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex],d=0,f=i;d<f.length;d+=1){var j=f[d];e.text.placedSymbolArray.get(j).placedOrientation=g}c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=h)},k.prototype.commit=function(f){this.commitTime=f,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,c=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var i=a?a.symbolFadeChange(f):1,j=a?a.opacities:{},m=a?a.variableOffsets:{},n=a?a.placedOrientations:{};for(var g in this.placements){var b=this.placements[g],h=j[g];h?(this.opacities[g]=new az(h,i,b.text,b.icon),c=c||b.text!==h.text.placed||b.icon!==h.icon.placed):(this.opacities[g]=new az(null,i,b.text,b.icon,b.skipFade),c=c||b.text||b.icon)}for(var k in j){var l=j[k];if(!this.opacities[k]){var o=new az(l,i,!1,!1);o.isHidden()||(this.opacities[k]=o,c=c||l.text.placed||l.icon.placed)}}for(var d in m)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=m[d]);for(var e in n)this.placedOrientations[e]||!this.opacities[e]||this.opacities[e].isHidden()||(this.placedOrientations[e]=n[e]);c?this.lastPlacementChangeTime=f:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:f)},k.prototype.updateLayerOpacities=function(d,f){for(var g={},a=0,e=f;a<e.length;a+=1){var b=e[a],c=b.getBucket(d);c&&b.latestFeatureIndex&&d.id===c.layerIds[0]&&this.updateBucketOpacities(c,g,b.collisionBoxArray)}},k.prototype.updateBucketOpacities=function(b,i,f){var j=this;b.hasTextData()&&b.text.opacityVertexArray.clear(),b.hasIconData()&&b.icon.opacityVertexArray.clear(),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexArray.clear(),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexArray.clear();var c=b.layers[0].layout,k=new az(null,0,!1,!1,!0),g=c.get("text-allow-overlap"),h=c.get("icon-allow-overlap"),l=c.get("text-variable-anchor"),m="map"===c.get("text-rotation-alignment"),n="map"===c.get("text-pitch-alignment"),o="none"!==c.get("icon-text-fit"),p=new az(null,0,g&&(h||!b.hasIconData()||c.get("icon-optional")),h&&(g||!b.hasTextData()||c.get("text-optional")),!0);!b.collisionArrays&&f&&(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData())&&b.deserializeCollisionBoxes(f);for(var q=function(b,c,d){for(var a=0;a<c/4;a++)b.opacityVertexArray.emplaceBack(d)},d=0;d<b.symbolInstances.length;d++)!function(w){var c=b.symbolInstances.get(w),x=c.numHorizontalGlyphVertices,y=c.numVerticalGlyphVertices,h=c.crossTileID,E=i[h],d=j.opacities[h];E?d=k:d||(d=p,j.opacities[h]=d),i[h]=!0;var F=c.numIconVertices>0,r=j.placedOrientations[c.crossTileID],t=r===a.WritingMode.vertical,s=r===a.WritingMode.horizontal||r===a.WritingMode.horizontalOnly;if(x>0||y>0){var z=cD(d.text),G=t?cE:z;q(b.text,x,G);var H=s?cE:z;q(b.text,y,H);var I=d.text.isHidden();[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach(function(a){a>=0&&(b.text.placedSymbolArray.get(a).hidden=I||t?1:0)}),c.verticalPlacedTextSymbolIndex>=0&&(b.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).hidden=I||s?1:0);var A=j.variableOffsets[c.crossTileID];A&&j.markUsedJustification(b,A.anchor,c,r);var u=j.placedOrientations[c.crossTileID];u&&(j.markUsedJustification(b,"left",c,u),j.markUsedOrientation(b,u,c))}if(F){var B=cD(d.icon),C=!(o&&c.verticalPlacedIconSymbolIndex&&t);if(c.placedIconSymbolIndex>=0){var J=C?B:cE;q(b.icon,c.numIconVertices,J),b.icon.placedSymbolArray.get(c.placedIconSymbolIndex).hidden=d.icon.isHidden()}if(c.verticalPlacedIconSymbolIndex>=0){var K=C?cE:B;q(b.icon,c.numVerticalIconVertices,K),b.icon.placedSymbolArray.get(c.verticalPlacedIconSymbolIndex).hidden=d.icon.isHidden()}}if(b.hasIconCollisionBoxData()||b.hasTextCollisionBoxData()){var f=b.collisionArrays[w];if(f){var e=new a.Point(0,0);if(f.textBox||f.verticalTextBox){var v=!0;if(l){var g=j.variableOffsets[h];g?(e=cA(g.anchor,g.width,g.height,g.textOffset,g.textBoxScale),m&&e._rotate(n?j.transform.angle:-j.transform.angle)):v=!1}f.textBox&&cC(b.textCollisionBox.collisionVertexArray,d.text.placed,!v||t,e.x,e.y),f.verticalTextBox&&cC(b.textCollisionBox.collisionVertexArray,d.text.placed,!v||s,e.x,e.y)}var D=Boolean(!s&&f.verticalIconBox);f.iconBox&&cC(b.iconCollisionBox.collisionVertexArray,d.icon.placed,D,o?e.x:0,o?e.y:0),f.verticalIconBox&&cC(b.iconCollisionBox.collisionVertexArray,d.icon.placed,!D,o?e.x:0,o?e.y:0)}}}(d);if(b.sortFeatures(this.transform.angle),this.retainedQueryData[b.bucketInstanceId]&&(this.retainedQueryData[b.bucketInstanceId].featureSortOrder=b.featureSortOrder),b.hasTextData()&&b.text.opacityVertexBuffer&&b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray),b.hasIconData()&&b.icon.opacityVertexBuffer&&b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray),b.hasIconCollisionBoxData()&&b.iconCollisionBox.collisionVertexBuffer&&b.iconCollisionBox.collisionVertexBuffer.updateData(b.iconCollisionBox.collisionVertexArray),b.hasTextCollisionBoxData()&&b.textCollisionBox.collisionVertexBuffer&&b.textCollisionBox.collisionVertexBuffer.updateData(b.textCollisionBox.collisionVertexArray),b.bucketInstanceId in this.collisionCircleArrays){var e=this.collisionCircleArrays[b.bucketInstanceId];b.placementInvProjMatrix=e.invProjMatrix,b.placementViewportMatrix=e.viewportMatrix,b.collisionCircleArray=e.circles,delete this.collisionCircleArrays[b.bucketInstanceId]}},k.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},k.prototype.zoomAdjustment=function(a){return Math.max(0,(this.transform.zoom-a)/1.5)},k.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},k.prototype.stillRecent=function(b,a){var c=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*c>b},k.prototype.setStale=function(){this.stale=!0};var cE=0,aB=function(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&& void 0!==a.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};aB.prototype.continuePlacement=function(b,c,e,f,d){for(var a=this._bucketParts;this._currentTileIndex<b.length;){var g=b[this._currentTileIndex];if(c.getBucketParts(a,f,g,this._sortAcrossTiles),this._currentTileIndex++,d())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(function(a,b){return a.sortKey-b.sortKey}));this._currentPartIndex<a.length;){var h=a[this._currentPartIndex];if(c.placeLayerBucketPart(h,this._seenCrossTileIDs,e),this._currentPartIndex++,d())return!0}return!1};var ab=function(a,b,c,d,e,f,g){this.placement=new k(a,e,f,g),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=d,this._done=!1};ab.prototype.isDone=function(){return this._done},ab.prototype.continuePlacement=function(d,e,f){for(var g=this,h=a.browser.now();this._currentPlacementIndex>=0;){var b=e[d[this._currentPlacementIndex]],c=this.placement.collisionIndex.transform.zoom;if("symbol"===b.type&&(!b.minzoom||b.minzoom<=c)&&(!b.maxzoom||b.maxzoom>c)){if(this._inProgressLayer||(this._inProgressLayer=new aB(b)),this._inProgressLayer.continuePlacement(f[b.source],this.placement,this._showCollisionBoxes,b,function(){var b=a.browser.now()-h;return!g._forceFullPlacement&&b>2}))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ab.prototype.commit=function(a){return this.placement.commit(a),this.placement};var cF=512/a.EXTENT/2,an=function(d,e,f){this.tileID=d,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(var a=0;a<e.length;a++){var b=e.get(a),c=b.key;this.indexedSymbolInstances[c]||(this.indexedSymbolInstances[c]=[]),this.indexedSymbolInstances[c].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,d)})}};an.prototype.getScaledCoordinates=function(c,b){var d=cF/Math.pow(2,b.canonical.z-this.tileID.canonical.z);return{x:Math.floor((b.canonical.x*a.EXTENT+c.anchorX)*d),y:Math.floor((b.canonical.y*a.EXTENT+c.anchorY)*d)}},an.prototype.findMatches=function(f,c,g){for(var h=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),d=0;d<f.length;d++){var b=f.get(d);if(!b.crossTileID){var i=this.indexedSymbolInstances[b.key];if(i)for(var j=this.getScaledCoordinates(b,c),e=0,k=i;e<k.length;e+=1){var a=k[e];if(Math.abs(a.coord.x-j.x)<=h&&Math.abs(a.coord.y-j.y)<=h&&!g[a.crossTileID]){g[a.crossTileID]=!0,b.crossTileID=a.crossTileID;break}}}}};var aC=function(){this.maxCrossTileID=0};aC.prototype.generate=function(){return++this.maxCrossTileID};var P=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};P.prototype.handleWrapJump=function(b){var c=Math.round((b-this.lng)/360);if(0!==c)for(var d in this.indexes){var e=this.indexes[d],f={};for(var g in e){var a=e[g];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+c),f[a.tileID.key]=a}this.indexes[d]=f}this.lng=b},P.prototype.addBucket=function(a,b,k){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===b.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var c=0;c<b.symbolInstances.length;c++)b.symbolInstances.get(c).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});var d=this.usedCrossTileIDs[a.overscaledZ];for(var e in this.indexes){var f=this.indexes[e];if(Number(e)>a.overscaledZ)for(var l in f){var i=f[l];i.tileID.isChildOf(a)&&i.findMatches(b.symbolInstances,a,d)}else{var j=f[a.scaledTo(Number(e)).key];j&&j.findMatches(b.symbolInstances,a,d)}}for(var g=0;g<b.symbolInstances.length;g++){var h=b.symbolInstances.get(g);h.crossTileID||(h.crossTileID=k.generate(),d[h.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new an(a,b.symbolInstances,b.bucketInstanceId),!0},P.prototype.removeBucketCrossTileIDs=function(d,b){for(var e in b.indexedSymbolInstances)for(var a=0,c=b.indexedSymbolInstances[e];a<c.length;a+=1){var f=c[a];delete this.usedCrossTileIDs[d][f.crossTileID]}},P.prototype.removeStaleBuckets=function(e){var c=!1;for(var d in this.indexes){var a=this.indexes[d];for(var b in a)e[a[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,a[b]),delete a[b],c=!0)}return c};var ao=function(){this.layerIndexes={},this.crossTileIDs=new aC,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ao.prototype.addLayer=function(c,i,j){var b=this.layerIndexes[c.id];void 0===b&&(b=this.layerIndexes[c.id]=new P);var d=!1,f={};b.handleWrapJump(j);for(var e=0,g=i;e<g.length;e+=1){var h=g[e],a=h.getBucket(c);a&&c.id===a.layerIds[0]&&(a.bucketInstanceId||(a.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(h.tileID,a,this.crossTileIDs)&&(d=!0),f[a.bucketInstanceId]=!0)}return b.removeStaleBuckets(f)&&(d=!0),d},ao.prototype.pruneUnusedLayers=function(b){var c={};for(var a in b.forEach(function(a){c[a]=!0}),this.layerIndexes)c[a]||delete this.layerIndexes[a]};var cG=function(c,b){return a.emitValidationErrors(c,b&&b.filter(function(a){return"source.canvas"!==a.identifier}))},cH=a.pick(al,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),cI=a.pick(al,["setCenter","setZoom","setBearing","setPitch"]),cJ=function(){var c={},f=a.styleSpec.$version;for(var b in a.styleSpec.$root){var d=a.styleSpec.$root[b];if(d.required){var e=null;null!=(e="version"===b?f:"array"===d.type?[]:{})&&(c[b]=e)}}return c}(),Q=function(c){function b(e,d){var f=this;void 0===d&&(d={}),c.call(this),this.map=e,this.dispatcher=new N(b8(),this),this.imageManager=new bj,this.imageManager.setEventedParent(this),this.glyphManager=new B(e._requestManager,d.localIdeographFontFamily),this.lineAtlas=new C(256,512),this.crossTileSymbolIndex=new ao,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var g=this;this._rtlTextPluginCallback=b.registerForPluginStateChange(function(b){var c={pluginStatus:b.pluginStatus,pluginURL:b.pluginURL};g.dispatcher.broadcast("syncRTLPluginState",c,function(c,b){if(a.triggerPluginCompletionEvent(c),b&&b.every(function(a){return a}))for(var d in g.sourceCaches)g.sourceCaches[d].reload()})}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){var c=f.sourceCaches[a.sourceId];if(c){var b=c.getSource();if(b&&b.vectorLayerIds)for(var e in f._layers){var d=f._layers[e];d.source===b.id&&f._validateLayer(d)}}}})}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.loadURL=function(c,b){var e=this;void 0===b&&(b={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var f="boolean"==typeof b.validate?b.validate:!a.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,b.accessToken);var d=this.map._requestManager.transformRequest(c,a.ResourceType.Style);this._request=a.getJSON(d,function(b,c){e._request=null,b?e.fire(new a.ErrorEvent(b)):c&&e._load(c,f)})},b.prototype.loadJSON=function(c,b){var d=this;void 0===b&&(b={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){d._request=null,d._load(c,!1!==b.validate)})},b.prototype.loadEmpty=function(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(cJ,!1)},b.prototype._load=function(b,h){if(!(h&&cG(this,a.validateStyle(b)))){for(var e in this._loaded=!0,this.stylesheet=b,b.sources)this.addSource(e,b.sources[e],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs);var f=ca(this.stylesheet.layers);this._order=f.map(function(a){return a.id}),this._layers={},this._serializedLayers={};for(var d=0,g=f;d<g.length;d+=1){var c=g[d];(c=a.createStyleLayer(c)).setEventedParent(this,{layer:{id:c.id}}),this._layers[c.id]=c,this._serializedLayers[c.id]=c.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new bo(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},b.prototype._loadSprite=function(b){var c=this;this._spriteRequest=function(c,b,e){var f,g,h,d=a.browser.devicePixelRatio>1?"@2x":"",i=a.getJSON(b.transformRequest(b.normalizeSpriteURL(c,d,".json"),a.ResourceType.SpriteJSON),function(a,b){i=null,h||(h=a,f=b,k())}),j=a.getImage(b.transformRequest(b.normalizeSpriteURL(c,d,".png"),a.ResourceType.SpriteImage),function(a,b){j=null,h||(h=a,g=b,k())});function k(){if(h)e(h);else if(f&&g){var l=a.browser.getImageData(g),c={};for(var d in f){var b=f[d],i=b.width,j=b.height,m=b.x,n=b.y,o=b.sdf,p=b.pixelRatio,q=b.stretchX,r=b.stretchY,s=b.content,k=new a.RGBAImage({width:i,height:j});a.RGBAImage.copy(l,k,{x:m,y:n},{x:0,y:0},{width:i,height:j}),c[d]={data:k,pixelRatio:p,sdf:o,stretchX:q,stretchY:r,content:s}}e(null,c)}}return{cancel:function(){i&&(i.cancel(),i=null),j&&(j.cancel(),j=null)}}}(b,this.map._requestManager,function(d,b){if(c._spriteRequest=null,d)c.fire(new a.ErrorEvent(d));else if(b)for(var e in b)c.imageManager.addImage(e,b[e]);c.imageManager.setLoaded(!0),c._availableImages=c.imageManager.listImages(),c.dispatcher.broadcast("setImages",c._availableImages),c.fire(new a.Event("data",{dataType:"style"}))})},b.prototype._validateLayer=function(c){var e=this.sourceCaches[c.source];if(e){var d=c.sourceLayer;if(d){var b=e.getSource();("geojson"===b.type||b.vectorLayerIds&& -1===b.vectorLayerIds.indexOf(d))&&this.fire(new a.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+b.id+'" as specified by style layer "'+c.id+'"')))}}},b.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()},b.prototype._serializeLayers=function(e){for(var b=[],a=0,c=e;a<c.length;a+=1){var f=c[a],d=this._layers[f];"custom"!==d.type&&b.push(d.serialize())}return b},b.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var b in this._layers)if(this._layers[b].hasTransition())return!0;return!1},b.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},b.prototype.update=function(b){if(this._loaded){var j=this._changed;if(this._changed){var f=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);for(var d in(f.length||g.length)&&this._updateWorkerLayers(f,g),this._updatedSources){var h=this._updatedSources[d];"reload"===h?this._reloadSource(d):"clear"===h&&this._clearSource(d)}for(var k in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[k].updateTransitions(b);this.light.updateTransitions(b),this._resetUpdates()}for(var l in this.sourceCaches)this.sourceCaches[l].used=!1;for(var e=0,i=this._order;e<i.length;e+=1){var m=i[e],c=this._layers[m];c.recalculate(b,this._availableImages),!c.isHidden(b.zoom)&&c.source&&(this.sourceCaches[c.source].used=!0)}this.light.recalculate(b),this.z=b.zoom,j&&this.fire(new a.Event("data",{dataType:"style"}))}},b.prototype._updateTilesForChangedImages=function(){var a=Object.keys(this._changedImages);if(a.length){for(var b in this.sourceCaches)this.sourceCaches[b].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}},b.prototype._updateWorkerLayers=function(a,b){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:b})},b.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},b.prototype.setState=function(b){var e=this;if(this._checkLoaded(),cG(this,a.validateStyle(b)))return!1;(b=a.clone$1(b)).layers=ca(b.layers);var c=(function(c,b){if(!c)return[{command:al.setStyle,args:[b]}];var d=[];try{if(!a.deepEqual(c.version,b.version))return[{command:al.setStyle,args:[b]}];a.deepEqual(c.center,b.center)||d.push({command:al.setCenter,args:[b.center]}),a.deepEqual(c.zoom,b.zoom)||d.push({command:al.setZoom,args:[b.zoom]}),a.deepEqual(c.bearing,b.bearing)||d.push({command:al.setBearing,args:[b.bearing]}),a.deepEqual(c.pitch,b.pitch)||d.push({command:al.setPitch,args:[b.pitch]}),a.deepEqual(c.sprite,b.sprite)||d.push({command:al.setSprite,args:[b.sprite]}),a.deepEqual(c.glyphs,b.glyphs)||d.push({command:al.setGlyphs,args:[b.glyphs]}),a.deepEqual(c.transition,b.transition)||d.push({command:al.setTransition,args:[b.transition]}),a.deepEqual(c.light,b.light)||d.push({command:al.setLight,args:[b.light]});var f={},e=[];!function(d,c,e,f){var b;for(b in d=d||{},c=c||{},d)d.hasOwnProperty(b)&&(c.hasOwnProperty(b)||cc(b,e,f));for(b in c)c.hasOwnProperty(b)&&(d.hasOwnProperty(b)?a.deepEqual(d[b],c[b])||("geojson"===d[b].type&&"geojson"===c[b].type&&ce(d,c,b)?e.push({command:al.setGeoJSONSourceData,args:[b,c[b].data]}):cd(b,c,e,f)):cb(b,c,e))}(c.sources,b.sources,e,f);var g=[];c.layers&&c.layers.forEach(function(a){f[a.source]?d.push({command:al.removeLayer,args:[a.id]}):g.push(a)}),d=d.concat(e),function(m,k,g){k=k||[];var f,i,c,e,d,l,b,n=(m=m||[]).map(cg),j=k.map(cg),p=m.reduce(ch,{}),o=k.reduce(ch,{}),h=n.slice(),q=Object.create(null);for(f=0,i=0;f<n.length;f++)c=n[f],o.hasOwnProperty(c)?i++:(g.push({command:al.removeLayer,args:[c]}),h.splice(h.indexOf(c,i),1));for(f=0,i=0;f<j.length;f++)c=j[j.length-1-f],h[h.length-1-f]!==c&&(p.hasOwnProperty(c)?(g.push({command:al.removeLayer,args:[c]}),h.splice(h.lastIndexOf(c,h.length-i),1)):i++,l=h[h.length-f],g.push({command:al.addLayer,args:[o[c],l]}),h.splice(h.length-f,0,c),q[c]=!0);for(f=0;f<j.length;f++)if(e=p[c=j[f]],d=o[c],!(q[c]||a.deepEqual(e,d))){if(!a.deepEqual(e.source,d.source)||!a.deepEqual(e["source-layer"],d["source-layer"])||!a.deepEqual(e.type,d.type)){g.push({command:al.removeLayer,args:[c]}),l=h[h.lastIndexOf(c)+1],g.push({command:al.addLayer,args:[d,l]});continue}for(b in cf(e.layout,d.layout,g,c,null,al.setLayoutProperty),cf(e.paint,d.paint,g,c,null,al.setPaintProperty),a.deepEqual(e.filter,d.filter)||g.push({command:al.setFilter,args:[c,d.filter]}),a.deepEqual(e.minzoom,d.minzoom)&&a.deepEqual(e.maxzoom,d.maxzoom)||g.push({command:al.setLayerZoomRange,args:[c,d.minzoom,d.maxzoom]}),e)e.hasOwnProperty(b)&&"layout"!==b&&"paint"!==b&&"filter"!==b&&"metadata"!==b&&"minzoom"!==b&&"maxzoom"!==b&&(0===b.indexOf("paint.")?cf(e[b],d[b],g,c,b.slice(6),al.setPaintProperty):a.deepEqual(e[b],d[b])||g.push({command:al.setLayerProperty,args:[c,b,d[b]]}));for(b in d)!(!d.hasOwnProperty(b)||e.hasOwnProperty(b))&&"layout"!==b&&"paint"!==b&&"filter"!==b&&"metadata"!==b&&"minzoom"!==b&&"maxzoom"!==b&&(0===b.indexOf("paint.")?cf(e[b],d[b],g,c,b.slice(6),al.setPaintProperty):a.deepEqual(e[b],d[b])||g.push({command:al.setLayerProperty,args:[c,b,d[b]]}))}}(g,b.layers,d)}catch(h){console.warn("Unable to compute style diff:",h),d=[{command:al.setStyle,args:[b]}]}return d})(this.serialize(),b).filter(function(a){return!(a.command in cI)});if(0===c.length)return!1;var d=c.filter(function(a){return!(a.command in cH)});if(d.length>0)throw new Error("Unimplemented: "+d.map(function(a){return a.command}).join(", ")+".");return c.forEach(function(a){"setTransition"!==a.command&&e[a.command].apply(e,a.args)}),this.stylesheet=b,!0},b.prototype.addImage=function(b,c){if(this.getImage(b))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(b,c),this._availableImages=this.imageManager.listImages(),this._changedImages[b]=!0,this._changed=!0,this.fire(new a.Event("data",{dataType:"style"}))},b.prototype.updateImage=function(a,b){this.imageManager.updateImage(a,b)},b.prototype.getImage=function(a){return this.imageManager.getImage(a)},b.prototype.removeImage=function(b){if(!this.getImage(b))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(b),this._availableImages=this.imageManager.listImages(),this._changedImages[b]=!0,this._changed=!0,this.fire(new a.Event("data",{dataType:"style"}))},b.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},b.prototype.addSource=function(c,b,d){var f=this;if(void 0===d&&(d={}),this._checkLoaded(),void 0!==this.sourceCaches[c])throw new Error("There is already a source with this ID");if(!b.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(b).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(b.type)>=0&&this._validate(a.validateStyle.source,"sources."+c,b,null,d))){this.map&&this.map._collectResourceTiming&&(b.collectResourceTiming=!0);var e=this.sourceCaches[c]=new ak(c,b,this.dispatcher);e.style=this,e.setEventedParent(this,function(){return{isSourceLoaded:f.loaded(),source:e.serialize(),sourceId:c}}),e.onAdd(this.map),this._changed=!0}},b.prototype.removeSource=function(b){if(this._checkLoaded(),void 0===this.sourceCaches[b])throw new Error("There is no source with this ID");for(var d in this._layers)if(this._layers[d].source===b)return this.fire(new a.ErrorEvent(new Error('Source "'+b+'" cannot be removed while layer "'+d+'" is using it.')));var c=this.sourceCaches[b];delete this.sourceCaches[b],delete this._updatedSources[b],c.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b})),c.setEventedParent(null),c.clearTiles(),c.onRemove&&c.onRemove(this.map),this._changed=!0},b.prototype.setGeoJSONSourceData=function(a,b){this._checkLoaded(),this.sourceCaches[a].getSource().setData(b),this._changed=!0},b.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},b.prototype.addLayer=function(c,e,f){void 0===f&&(f={}),this._checkLoaded();var b,d=c.id;if(this.getLayer(d)){this.fire(new a.ErrorEvent(new Error('Layer with id "'+d+'" already exists on this map')));return}if("custom"===c.type){if(cG(this,a.validateCustomStyleLayer(c)))return;b=a.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(d,c.source),c=a.clone$1(c),c=a.extend(c,{source:d})),this._validate(a.validateStyle.layer,"layers."+d,c,{arrayIndex:-1},f))return;b=a.createStyleLayer(c),this._validateLayer(b),b.setEventedParent(this,{layer:{id:d}}),this._serializedLayers[b.id]=b.serialize()}var g=e?this._order.indexOf(e):this._order.length;if(e&& -1===g){this.fire(new a.ErrorEvent(new Error('Layer with id "'+e+'" does not exist on this map.')));return}if(this._order.splice(g,0,d),this._layerOrderChanged=!0,this._layers[d]=b,this._removedLayers[d]&&b.source&&"custom"!==b.type){var h=this._removedLayers[d];delete this._removedLayers[d],h.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)},b.prototype.moveLayer=function(b,c){if(this._checkLoaded(),this._changed=!0,!this._layers[b]){this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be moved.")));return}if(b!==c){var e=this._order.indexOf(b);this._order.splice(e,1);var d=c?this._order.indexOf(c):this._order.length;if(c&& -1===d){this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));return}this._order.splice(d,0,b),this._layerOrderChanged=!0}},b.prototype.removeLayer=function(b){this._checkLoaded();var c=this._layers[b];if(!c){this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be removed.")));return}c.setEventedParent(null);var d=this._order.indexOf(b);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[b]=c,delete this._layers[b],delete this._serializedLayers[b],delete this._updatedLayers[b],delete this._updatedPaintProps[b],c.onRemove&&c.onRemove(this.map)},b.prototype.getLayer=function(a){return this._layers[a]},b.prototype.hasLayer=function(a){return a in this._layers},b.prototype.setLayerZoomRange=function(e,c,d){this._checkLoaded();var b=this.getLayer(e);if(!b){this.fire(new a.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")));return}(b.minzoom!==c||b.maxzoom!==d)&&(null!=c&&(b.minzoom=c),null!=d&&(b.maxzoom=d),this._updateLayer(b))},b.prototype.setFilter=function(e,c,d){void 0===d&&(d={}),this._checkLoaded();var b=this.getLayer(e);if(!b){this.fire(new a.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")));return}if(!a.deepEqual(b.filter,c)){if(null==c){b.filter=void 0,this._updateLayer(b);return}this._validate(a.validateStyle.filter,"layers."+b.id+".filter",c,null,d)||(b.filter=a.clone$1(c),this._updateLayer(b))}},b.prototype.getFilter=function(b){return a.clone$1(this.getLayer(b).filter)},b.prototype.setLayoutProperty=function(d,e,f,c){void 0===c&&(c={}),this._checkLoaded();var b=this.getLayer(d);if(!b){this.fire(new a.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be styled.")));return}a.deepEqual(b.getLayoutProperty(e),f)||(b.setLayoutProperty(e,f,c),this._updateLayer(b))},b.prototype.getLayoutProperty=function(b,d){var c=this.getLayer(b);if(!c){this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style.")));return}return c.getLayoutProperty(d)},b.prototype.setPaintProperty=function(c,e,f,d){void 0===d&&(d={}),this._checkLoaded();var b=this.getLayer(c);if(!b){this.fire(new a.ErrorEvent(new Error("The layer '"+c+"' does not exist in the map's style and cannot be styled.")));return}a.deepEqual(b.getPaintProperty(e),f)||(b.setPaintProperty(e,f,d)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[c]=!0)},b.prototype.getPaintProperty=function(a,b){return this.getLayer(a).getPaintProperty(b)},b.prototype.setFeatureState=function(b,g){this._checkLoaded();var e=b.source,c=b.sourceLayer,d=this.sourceCaches[e];if(void 0===d){this.fire(new a.ErrorEvent(new Error("The source '"+e+"' does not exist in the map's style.")));return}var f=d.getSource().type;if("geojson"===f&&c){this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if("vector"===f&&!c){this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}void 0===b.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(c,b.id,g)},b.prototype.removeFeatureState=function(b,d){this._checkLoaded();var e=b.source,c=this.sourceCaches[e];if(void 0===c){this.fire(new a.ErrorEvent(new Error("The source '"+e+"' does not exist in the map's style.")));return}var f=c.getSource().type,g="vector"===f?b.sourceLayer:void 0;if("vector"===f&&!g){this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(d&&"string"!=typeof b.id&&"number"!=typeof b.id){this.fire(new a.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}c.removeFeatureState(g,b.id,d)},b.prototype.getFeatureState=function(b){this._checkLoaded();var d=b.source,e=b.sourceLayer,c=this.sourceCaches[d];if(void 0===c){this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")));return}if("vector"===c.getSource().type&&!e){this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return void 0===b.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),c.getFeatureState(e,b.id)},b.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},b.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._serializeLayers(this._order)},function(a){return void 0!==a})},b.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&"raster"!==this.sourceCaches[a.source].getSource().type&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},b.prototype._flattenAndSortRenderedFeatures=function(k){for(var x=this,l=function(a){return"fill-extrusion"===x._layers[a].type},m={},a=[],b=this._order.length-1;b>=0;b--){var d=this._order[b];if(l(d)){m[d]=b;for(var e=0,n=k;e<n.length;e+=1){var o=n[e][d];if(o)for(var f=0,p=o;f<p.length;f+=1){var v=p[f];a.push(v)}}}}a.sort(function(a,b){return b.intersectionZ-a.intersectionZ});for(var g=[],c=this._order.length-1;c>=0;c--){var q=this._order[c];if(l(q))for(var h=a.length-1;h>=0;h--){var r=a[h].feature;if(m[r.layer.id]<c)break;g.push(r),a.pop()}else for(var i=0,s=k;i<s.length;i+=1){var t=s[i][q];if(t)for(var j=0,u=t;j<u.length;j+=1){var w=u[j];g.push(w.feature)}}}return g},b.prototype.queryRenderedFeatures=function(e,b,k){b&&b.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",b.filter,null,b);var f={};if(b&&b.layers){if(!Array.isArray(b.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var c=0,g=b.layers;c<g.length;c+=1){var h=g[c],i=this._layers[h];if(!i)return this.fire(new a.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be queried for features."))),[];f[i.source]=!0}}var d=[];for(var j in b.availableImages=this._availableImages,this.sourceCaches)(!b.layers||f[j])&&d.push(bv(this.sourceCaches[j],this._layers,this._serializedLayers,e,b,k));return this.placement&&d.push(function(o,p,q,f,r,g,h){for(var c={},i=g.queryRenderedSymbols(f),a=[],b=0,d=Object.keys(i).map(Number);b<d.length;b+=1){var j=d[b];a.push(h[j])}a.sort(bw);for(var k=function(){var a=l[e],f=a.featureIndex.lookupSymbolFeatures(i[a.bucketInstanceId],p,a.bucketIndex,a.sourceLayerIndex,r.filter,r.layers,r.availableImages,o);for(var b in f){var j=c[b]=c[b]||[],g=f[b];g.sort(function(c,d){var b=a.featureSortOrder;if(!b)return d.featureIndex-c.featureIndex;var e=b.indexOf(c.featureIndex),f=b.indexOf(d.featureIndex);return f-e});for(var d=0,h=g;d<h.length;d+=1){var k=h[d];j.push(k)}}},e=0,l=a;e<l.length;e+=1)k();var m=function(a){c[a].forEach(function(c){var b=c.feature,d=q[o[a].source].getFeatureState(b.layer["source-layer"],b.id);b.source=b.layer.source,b.layer["source-layer"]&&(b.sourceLayer=b.layer["source-layer"]),b.state=d})};for(var n in c)m(n);return c}(this._layers,this._serializedLayers,this.sourceCaches,e,b,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)},b.prototype.querySourceFeatures=function(d,b){b&&b.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",b.filter,null,b);var c=this.sourceCaches[d];return c?function(g,h){for(var b=g.getRenderableIds().map(function(a){return g.getTileByID(a)}),c=[],d={},a=0;a<b.length;a++){var e=b[a],f=e.tileID.canonical.key;d[f]||(d[f]=!0,e.querySourceFeatures(c,h))}return c}(c,b):[]},b.prototype.addSourceType=function(a,c,d){return b.getSourceType(a)?d(new Error('A source type called "'+a+'" already exists.')):(b.setSourceType(a,c),c.workerSourceURL)?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:c.workerSourceURL},d):d(null,null)},b.prototype.getLight=function(){return this.light.getLight()},b.prototype.setLight=function(b,c){void 0===c&&(c={}),this._checkLoaded();var f=this.light.getLight(),d=!1;for(var e in b)if(!a.deepEqual(b[e],f[e])){d=!0;break}if(d){var g={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(b,c),this.light.updateTransitions(g)}},b.prototype._validate=function(c,d,e,f,b){return void 0===b&&(b={}),(!b|| !1!==b.validate)&&cG(this,c.call(a.validateStyle,a.extend({key:d,style:this.serialize(),value:e,styleSpec:a.styleSpec},f)))},b.prototype._remove=function(){for(var c in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[c].setEventedParent(null);for(var b in this.sourceCaches)this.sourceCaches[b].clearTiles(),this.sourceCaches[b].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},b.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},b.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},b.prototype._updateSources=function(a){for(var b in this.sourceCaches)this.sourceCaches[b].update(a)},b.prototype._generateCollisionBoxes=function(){for(var a in this.sourceCaches)this._reloadSource(a)},b.prototype._updatePlacement=function(f,n,j,o,c){void 0===c&&(c=!1);for(var e=!1,k=!1,d={},g=0,l=this._order;g<l.length;g+=1){var p=l[g],b=this._layers[p];if("symbol"===b.type){if(!d[b.source]){var q=this.sourceCaches[b.source];d[b.source]=q.getRenderableIds(!0).map(function(a){return q.getTileByID(a)}).sort(function(a,b){return b.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(b.tileID)?-1:1)})}var r=this.crossTileSymbolIndex.addLayer(b,d[b.source],f.center.lng);e=e||r}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((c=c||this._layerOrderChanged||0===j)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now(),f.zoom))&&(this.pauseablePlacement=new ab(f,this._order,c,n,j,o,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,d),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),k=!0),e&&this.pauseablePlacement.placement.setStale()),k||e)for(var h=0,m=this._order;h<m.length;h+=1){var s=m[h],i=this._layers[s];"symbol"===i.type&&this.placement.updateLayerOpacities(i,d[i.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},b.prototype._releaseSymbolFadeTiles=function(){for(var a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()},b.prototype.getImages=function(d,a,c){this.imageManager.getImages(a.icons,c),this._updateTilesForChangedImages();var b=this.sourceCaches[a.source];b&&b.setDependencies(a.tileID.key,a.type,a.icons)},b.prototype.getGlyphs=function(c,a,b){this.glyphManager.getGlyphs(a.stacks,b)},b.prototype.getResource=function(d,b,c){return a.makeRequest(b,c)},b}(a.Evented);Q.getSourceType=function(a){return bs[a]},Q.setSourceType=function(a,b){bs[a]=b},Q.registerForPluginStateChange=a.registerForPluginStateChange;var cK=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),aD=cL("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),aE=cL("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),aF=cL("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),aG=cL("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),aH=cL("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),aI=cL("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),aJ=cL("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),aK=cL("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),aL=cL("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),aM=cL("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),aN=cL("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),aO=cL("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),aP=cL("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),aQ=cL("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),aR=cL("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),aS=cL("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),aT=cL("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),aU=cL("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),aV=cL("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),aW=cL("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),aX=cL("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),aY=cL("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),aZ=cL("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),a$=cL("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),a_=cL("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),a0=cL("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function cL(a,b){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d={};return{fragmentSource:a=a.replace(c,function(f,e,b,c,a){return(d[a]=!0,"define"===e)?"\n#ifndef HAS_UNIFORM_u_"+a+"\nvarying "+b+" "+c+" "+a+";\n#else\nuniform "+b+" "+c+" u_"+a+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+a+"\n    "+b+" "+c+" "+a+" = u_"+a+";\n#endif\n"}),vertexSource:b=b.replace(c,function(h,g,b,c,a){var f="float"===c?"vec2":"vec4",e=a.match(/color/)?"color":f;return d[a]?"define"===g?"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float u_"+a+"_t;\nattribute "+b+" "+f+" a_"+a+";\nvarying "+b+" "+c+" "+a+";\n#else\nuniform "+b+" "+c+" u_"+a+";\n#endif\n":"vec4"===e?"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = a_"+a+";\n#else\n    "+b+" "+c+" "+a+" = u_"+a+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = unpack_mix_"+e+"(a_"+a+", u_"+a+"_t);\n#else\n    "+b+" "+c+" "+a+" = u_"+a+";\n#endif\n":"define"===g?"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float u_"+a+"_t;\nattribute "+b+" "+f+" a_"+a+";\n#else\nuniform "+b+" "+c+" u_"+a+";\n#endif\n":"vec4"===e?"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+b+" "+c+" "+a+" = a_"+a+";\n#else\n    "+b+" "+c+" "+a+" = u_"+a+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+b+" "+c+" "+a+" = unpack_mix_"+e+"(a_"+a+", u_"+a+"_t);\n#else\n    "+b+" "+c+" "+a+" = u_"+a+";\n#endif\n"})}}var cM=Object.freeze({__proto__:null,prelude:aD,background:aE,backgroundPattern:aF,circle:aG,clippingMask:aH,heatmap:aI,heatmapTexture:aJ,collisionBox:aK,collisionCircle:aL,debug:aM,fill:aN,fillOutline:aO,fillOutlinePattern:aP,fillPattern:aQ,fillExtrusion:aR,fillExtrusionPattern:aS,hillshadePrepare:aT,hillshade:aU,line:aV,lineGradient:aW,linePattern:aX,lineSDF:aY,raster:aZ,symbolIcon:a$,symbolSDF:a_,symbolTextAndIcon:a0}),ac=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ac.prototype.bind=function(f,h,i,b,a,j,c,d){this.context=f;for(var g=this.boundPaintVertexBuffers.length!==b.length,e=0;!g&&e<b.length;e++)this.boundPaintVertexBuffers[e]!==b[e]&&(g=!0);var k=!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==i||g||this.boundIndexBuffer!==a||this.boundVertexOffset!==j||this.boundDynamicVertexBuffer!==c||this.boundDynamicVertexBuffer2!==d;!f.extVertexArrayObject||k?this.freshBind(h,i,b,a,j,c,d):(f.bindVertexArrayOES.set(this.vao),c&&c.bind(),a&&a.dynamicDraw&&a.bind(),d&&d.bind())},ac.prototype.freshBind=function(a,g,h,i,f,c,d){var j,n=a.numAttributes,e=this.context,b=e.gl;if(e.extVertexArrayObject)this.vao&&this.destroy(),this.vao=e.extVertexArrayObject.createVertexArrayOES(),e.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=a,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=i,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=c,this.boundDynamicVertexBuffer2=d;else{j=e.currentNumAttributes||0;for(var k=n;k<j;k++)b.disableVertexAttribArray(k)}g.enableAttributes(b,a);for(var l=0,o=h;l<o.length;l+=1)o[l].enableAttributes(b,a);c&&c.enableAttributes(b,a),d&&d.enableAttributes(b,a),g.bind(),g.setVertexAttribPointers(b,a,f);for(var m=0,p=h;m<p.length;m+=1){var q=p[m];q.bind(),q.setVertexAttribPointers(b,a,f)}c&&(c.bind(),c.setVertexAttribPointers(b,a,f)),i&&i.bind(),d&&(d.bind(),d.setVertexAttribPointers(b,a,f)),e.currentNumAttributes=n},ac.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var a1=function(f,m,b,o,p){var a=f.gl;this.program=a.createProgram();var g=b?b.defines():[];p&&g.push("#define OVERDRAW_INSPECTOR;");var q=g.concat(aD.fragmentSource,m.fragmentSource).join("\n"),r=g.concat(aD.vertexSource,m.vertexSource).join("\n"),c=a.createShader(a.FRAGMENT_SHADER);if(a.isContextLost()){this.failedToCreate=!0;return}a.shaderSource(c,q),a.compileShader(c),a.attachShader(this.program,c);var d=a.createShader(a.VERTEX_SHADER);if(a.isContextLost()){this.failedToCreate=!0;return}a.shaderSource(d,r),a.compileShader(d),a.attachShader(this.program,d);for(var n=b?b.layoutAttributes:[],e=0;e<n.length;e++)a.bindAttribLocation(this.program,e,n[e].name);a.linkProgram(this.program),a.deleteShader(d),a.deleteShader(c),this.numAttributes=a.getProgramParameter(this.program,a.ACTIVE_ATTRIBUTES),this.attributes={};for(var h={},i=0;i<this.numAttributes;i++){var j=a.getActiveAttrib(this.program,i);j&&(this.attributes[j.name]=a.getAttribLocation(this.program,j.name))}for(var s=a.getProgramParameter(this.program,a.ACTIVE_UNIFORMS),k=0;k<s;k++){var l=a.getActiveUniform(this.program,k);l&&(h[l.name]=a.getUniformLocation(this.program,l.name))}this.fixedUniforms=o(f,h),this.binderUniforms=b?b.getUniforms(f,h):[]};function cN(b,c,a){var h=1/cw(a,1,c.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),e=a.tileSize*Math.pow(2,c.transform.tileZoom)/d,f=e*(a.tileID.canonical.x+a.tileID.wrap*d),g=e*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[h,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[f>>16,g>>16],u_pixel_coord_lower:[65535&f,65535&g]}}a1.prototype.draw=function(a,g,m,n,o,p,q,h,r,s,t,u,v,d,w,x){var e,b=a.gl;if(!this.failedToCreate){for(var i in a.program.set(this.program),a.setDepthMode(m),a.setStencilMode(n),a.setColorMode(o),a.setCullFace(p),this.fixedUniforms)this.fixedUniforms[i].set(q[i]);d&&d.setUniforms(a,this.binderUniforms,u,{zoom:v});for(var j=((e={})[b.LINES]=2,e[b.TRIANGLES]=3,e[b.LINE_STRIP]=1,e)[g],f=0,k=t.get();f<k.length;f+=1){var c=k[f],l=c.vaos||(c.vaos={});(l[h]||(l[h]=new ac)).bind(a,this,r,d?d.getPaintVertexBuffers():[],s,c.vertexOffset,w,x),b.drawElements(g,c.primitiveLength*j,b.UNSIGNED_SHORT,c.primitiveOffset*j*2)}}};var cO=function(h,f,i,j){var b=f.style.light,c=b.properties.get("position"),d=[c.x,c.y,c.z],g=a.create$1();"viewport"===b.properties.get("anchor")&&a.fromRotation(g,-f.transform.angle),a.transformMat3(d,d,g);var e=b.properties.get("color");return{u_matrix:h,u_lightpos:d,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[e.r,e.g,e.b],u_vertical_gradient:+i,u_opacity:j}},cP=function(a){return{u_matrix:a}},cQ=function(b,c,d,e){return a.extend(cP(b),cN(d,c,e))},cR=function(f,i,g,b){var c,d,e=f.transform;if("map"===b.paint.get("circle-pitch-alignment")){var h=cw(g,1,e.zoom);c=!0,d=[h,h]}else c=!1,d=e.pixelsToGLUnits;return{u_camera_to_center_distance:e.cameraToCenterDistance,u_scale_with_map:+("map"===b.paint.get("circle-pitch-scale")),u_matrix:f.translatePosMatrix(i.posMatrix,g,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_pitch_with_map:+c,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:d}},cS=function(e,a,b){var c=cw(b,1,a.zoom),d=Math.pow(2,a.zoom-b.tileID.overscaledZ),f=b.tileID.overscaleFactor();return{u_matrix:e,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[a.pixelsToGLUnits[0]/(c*d),a.pixelsToGLUnits[1]/(c*d)],u_overscale_factor:f}},cT=function(b,c,a){return void 0===a&&(a=1),{u_matrix:b,u_color:c,u_overlay:0,u_overlay_scale:a}},cU=function(a){return{u_matrix:a}},cV=function(b,e,f,g){var c=a.create();a.ortho(c,0,b.width,b.height,0,0,1);var d=b.context.gl;return{u_matrix:c,u_world:[d.drawingBufferWidth,d.drawingBufferHeight],u_image:f,u_color_ramp:g,u_opacity:e.paint.get("heatmap-opacity")}},cW=function(b,c,a){var e=a.paint.get("hillshade-shadow-color"),f=a.paint.get("hillshade-highlight-color"),g=a.paint.get("hillshade-accent-color"),d=a.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===a.paint.get("hillshade-illumination-anchor")&&(d-=b.transform.angle);var h=!b.options.moving;return{u_matrix:b.transform.calculatePosMatrix(c.tileID.toUnwrapped(),h),u_image:0,u_latrange:cY(b,c.tileID),u_light:[a.paint.get("hillshade-exaggeration"),d],u_shadow:e,u_highlight:f,u_accent:g}},cX=function(e,c,f){var d=c.stride,b=a.create();return a.ortho(b,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(b,b,[0,-a.EXTENT,0]),{u_matrix:b,u_image:1,u_dimension:[d,d],u_zoom:e.overscaledZ,u_maxzoom:f,u_unpack:c.getUnpackVector()}};function cY(e,b){var c=Math.pow(2,b.canonical.z),d=b.canonical.y;return[new a.MercatorCoordinate(0,d/c).toLngLat().lat,new a.MercatorCoordinate(0,(d+1)/c).toLngLat().lat]}var cZ=function(c,d,e){var b=c.transform;return{u_matrix:c2(c,d,e),u_ratio:1/cw(d,1,b.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},c$=function(b,c,d){return a.extend(cZ(b,c,d),{u_image:0})},c_=function(e,b,f,d){var c=e.transform,g=c1(b,c);return{u_matrix:c2(e,b,f),u_texsize:b.imageAtlasTexture.size,u_ratio:1/cw(b,1,c.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[g,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/c.pixelsToGLUnits[0],1/c.pixelsToGLUnits[1]]}},c0=function(b,g,h,i,c){var n=b.transform,d=b.lineAtlas,j=c1(g,n),k="round"===h.layout.get("line-cap"),e=d.getDash(i.from,k),f=d.getDash(i.to,k),l=e.width*c.fromScale,m=f.width*c.toScale;return a.extend(cZ(b,g,h),{u_patternscale_a:[j/l,-e.height/2],u_patternscale_b:[j/m,-f.height/2],u_sdfgamma:d.width/(256*Math.min(l,m)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:e.y,u_tex_y_b:f.y,u_mix:c.t})};function c1(a,b){return 1/cw(a,1,b.tileZoom)}function c2(c,a,b){return c.translatePosMatrix(a.tileID.posMatrix,a,b.paint.get("line-translate"),b.paint.get("line-translate-anchor"))}function c3(a){a*=Math.PI/180;var c=Math.sin(a),b=Math.cos(a);return[(2*b+1)/3,(-Math.sqrt(3)*c-b+1)/3,(Math.sqrt(3)*c-b+1)/3]}function c4(a){return a>0?1/(1-a):1+a}function c5(a){return a>0?1-1/(1.001-a):-a}var c6=function(a,b,e,f,d,g,h,i,j,k){var c=d.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:b?b.uSizeT:0,u_size:b?b.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+e,u_aspect_ratio:c.width/c.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:h,u_coord_matrix:i,u_is_text:+j,u_pitch_with_map:+f,u_texsize:k,u_texture:0}},c7=function(e,f,g,b,c,h,i,j,k,l,m){var d=c.transform;return a.extend(c6(e,f,g,b,c,h,i,j,k,l),{u_gamma_scale:b?Math.cos(d._pitch)*d.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+m})},c8=function(o,p,q,r,s,t){var g,d,c,b,e,f,h,m,n,i,j,k,l;return a.extend((g=r,d=t,c=q,b=s,e=c.imageManager.getPattern(g.from.toString()),f=c.imageManager.getPattern(g.to.toString()),h=c.imageManager.getPixelSize(),m=h.width,n=h.height,i=Math.pow(2,b.tileID.overscaledZ),j=b.tileSize*Math.pow(2,c.transform.tileZoom)/i,k=j*(b.tileID.canonical.x+b.tileID.wrap*i),l=j*b.tileID.canonical.y,{u_image:0,u_pattern_tl_a:e.tl,u_pattern_br_a:e.br,u_pattern_tl_b:f.tl,u_pattern_br_b:f.br,u_texsize:[m,n],u_mix:d.t,u_pattern_size_a:e.displaySize,u_pattern_size_b:f.displaySize,u_scale_a:d.fromScale,u_scale_b:d.toScale,u_tile_units_to_pixels:1/cw(b,1,c.transform.tileZoom),u_pixel_coord_upper:[k>>16,l>>16],u_pixel_coord_lower:[65535&k,65535&l]}),{u_matrix:o,u_opacity:p})},c9={fillExtrusion:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fillExtrusionPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_height_factor:new a.Uniform1f(b,c.u_height_factor),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fill:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},fillPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},fillOutline:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world)}},fillOutlinePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform3f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},circle:function(b,c){return{u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(b,c.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},collisionBox:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(b,c.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_overscale_factor:new a.Uniform1f(b,c.u_overscale_factor)}},collisionCircle:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_inv_matrix:new a.UniformMatrix4f(b,c.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(b,c.u_viewport_size)}},debug:function(b,c){return{u_color:new a.UniformColor(b,c.u_color),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_overlay:new a.Uniform1i(b,c.u_overlay),u_overlay_scale:new a.Uniform1f(b,c.u_overlay_scale)}},clippingMask:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmap:function(b,c){return{u_extrude_scale:new a.Uniform1f(b,c.u_extrude_scale),u_intensity:new a.Uniform1f(b,c.u_intensity),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmapTexture:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_color_ramp:new a.Uniform1i(b,c.u_color_ramp),u_opacity:new a.Uniform1f(b,c.u_opacity)}},hillshade:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_latrange:new a.Uniform2f(b,c.u_latrange),u_light:new a.Uniform2f(b,c.u_light),u_shadow:new a.UniformColor(b,c.u_shadow),u_highlight:new a.UniformColor(b,c.u_highlight),u_accent:new a.UniformColor(b,c.u_accent)}},hillshadePrepare:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_dimension:new a.Uniform2f(b,c.u_dimension),u_zoom:new a.Uniform1f(b,c.u_zoom),u_maxzoom:new a.Uniform1f(b,c.u_maxzoom),u_unpack:new a.Uniform4f(b,c.u_unpack)}},line:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels)}},lineGradient:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_image:new a.Uniform1i(b,c.u_image)}},linePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_texsize:new a.Uniform2f(b,c.u_texsize),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_image:new a.Uniform1i(b,c.u_image),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_scale:new a.Uniform3f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},lineSDF:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(b,c.u_patternscale_a),u_patternscale_b:new a.Uniform2f(b,c.u_patternscale_b),u_sdfgamma:new a.Uniform1f(b,c.u_sdfgamma),u_image:new a.Uniform1i(b,c.u_image),u_tex_y_a:new a.Uniform1f(b,c.u_tex_y_a),u_tex_y_b:new a.Uniform1f(b,c.u_tex_y_b),u_mix:new a.Uniform1f(b,c.u_mix)}},raster:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_tl_parent:new a.Uniform2f(b,c.u_tl_parent),u_scale_parent:new a.Uniform1f(b,c.u_scale_parent),u_buffer_scale:new a.Uniform1f(b,c.u_buffer_scale),u_fade_t:new a.Uniform1f(b,c.u_fade_t),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image0:new a.Uniform1i(b,c.u_image0),u_image1:new a.Uniform1i(b,c.u_image1),u_brightness_low:new a.Uniform1f(b,c.u_brightness_low),u_brightness_high:new a.Uniform1f(b,c.u_brightness_high),u_saturation_factor:new a.Uniform1f(b,c.u_saturation_factor),u_contrast_factor:new a.Uniform1f(b,c.u_contrast_factor),u_spin_weights:new a.Uniform3f(b,c.u_spin_weights)}},symbolIcon:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1i(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture)}},symbolSDF:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1i(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture),u_gamma_scale:new a.Uniform1f(b,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(b,c.u_is_halo)}},symbolTextAndIcon:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1i(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texsize_icon:new a.Uniform2f(b,c.u_texsize_icon),u_texture:new a.Uniform1i(b,c.u_texture),u_texture_icon:new a.Uniform1i(b,c.u_texture_icon),u_gamma_scale:new a.Uniform1f(b,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(b,c.u_is_halo)}},background:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_color:new a.UniformColor(b,c.u_color)}},backgroundPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image:new a.Uniform1i(b,c.u_image),u_pattern_tl_a:new a.Uniform2f(b,c.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(b,c.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(b,c.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(b,c.u_pattern_br_b),u_texsize:new a.Uniform2f(b,c.u_texsize),u_mix:new a.Uniform1f(b,c.u_mix),u_pattern_size_a:new a.Uniform2f(b,c.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(b,c.u_pattern_size_b),u_scale_a:new a.Uniform1f(b,c.u_scale_a),u_scale_b:new a.Uniform1f(b,c.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(b,c.u_tile_units_to_pixels)}}};function da(b,N,s,C,t,P,D){for(var e=b.context,E=e.gl,Q=b.useProgram("collisionBox"),j=[],f=0,F=0,u=0;u<C.length;u++){var v=C[u],w=N.getTile(v),d=w.getBucket(s);if(d){var x=v.posMatrix;(0!==t[0]||0!==t[1])&&(x=b.translatePosMatrix(v.posMatrix,w,t,P));var g=D?d.textCollisionBox:d.iconCollisionBox,y=d.collisionCircleArray;if(y.length>0){var k=a.create(),R=x;a.mul(k,d.placementInvProjMatrix,b.transform.glCoordMatrix),a.mul(k,k,d.placementViewportMatrix),j.push({circleArray:y,circleOffset:F,transform:R,invTransform:k}),f+=y.length/4,F=f}g&&Q.draw(e,E.LINES,K.disabled,aj.disabled,b.colorModeForRenderPass(),O.disabled,cS(x,b.transform,w),s.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,null,b.transform.zoom,null,null,g.collisionVertexBuffer)}}if(D&&j.length){var S=b.useProgram("collisionCircle"),c=new a.StructArrayLayout2f1f2i16;c.resize(4*f),c._trim();for(var l=0,z=0,G=j;z<G.length;z+=1)for(var h=G[z],A=0;A<h.circleArray.length/4;A++){var m=4*A,n=h.circleArray[m+0],o=h.circleArray[m+1],p=h.circleArray[m+2],q=h.circleArray[m+3];c.emplace(l++,n,o,p,q,0),c.emplace(l++,n,o,p,q,1),c.emplace(l++,n,o,p,q,2),c.emplace(l++,n,o,p,q,3)}(!bb||bb.length<2*f)&&(bb=db(f));for(var H=e.createIndexBuffer(bb,!0),I=e.createVertexBuffer(c,a.collisionCircleLayout.members,!0),B=0,J=j;B<J.length;B+=1){var L,M,r,i=J[B],T=(L=i.transform,M=i.invTransform,r=b.transform,{u_matrix:L,u_inv_matrix:M,u_camera_to_center_distance:r.cameraToCenterDistance,u_viewport_size:[r.width,r.height]});S.draw(e,E.TRIANGLES,K.disabled,aj.disabled,b.colorModeForRenderPass(),O.disabled,T,s.id,I,H,a.SegmentVector.simpleSegment(0,2*i.circleOffset,i.circleArray.length,i.circleArray.length/2),null,b.transform.zoom,null,null,null)}I.destroy(),H.destroy()}}function db(f){var e=2*f,b=new a.StructArrayLayout3ui6;b.resize(e),b._trim();for(var c=0;c<e;c++){var d=6*c;b.uint16[d+0]=4*c+0,b.uint16[d+1]=4*c+1,b.uint16[d+2]=4*c+2,b.uint16[d+3]=4*c+2,b.uint16[d+4]=4*c+3,b.uint16[d+5]=4*c+0}return b}var dc=a.identity(new Float32Array(16));function dd(b,g,h,i,c,d){var e=a.getAnchorAlignment(b),j=e.horizontalAlign,k=e.verticalAlign,f=a.evaluateVariableOffset(b,i);return new a.Point((-(j-.5)*g/c+f[0])*d,(-(k-.5)*h/c+f[1])*d)}function de(c,z,i,A,B,m,n,C,D,E,o){var p=c.text.placedSymbolArray,f=c.text.dynamicLayoutVertexArray,e=c.icon.dynamicLayoutVertexArray,q={};f.clear();for(var j=0;j<p.length;j++){var b=p.get(j),F=c.allowVerticalPlacement&&!b.placedOrientation,d=b.hidden||!b.crossTileID||F?null:A[b.crossTileID];if(d){var r=new a.Point(b.anchorX,b.anchorY),s=ck(r,i?C:n),G=cl(m.cameraToCenterDistance,s.signedDistanceFromCamera),t=B.evaluateSizeForFeature(c.textSizeData,E,b)*G/a.ONE_EM;i&&(t*=c.tilePixelRatio/D);for(var H=d.width,I=d.height,J=d.anchor,K=d.textOffset,L=d.textBoxScale,k=dd(J,H,I,K,L,t),u=i?ck(r.add(k),n).point:s.point.add(z?k.rotate(-m.angle):k),v=c.allowVerticalPlacement&&b.placedOrientation===a.WritingMode.vertical?Math.PI/2:0,w=0;w<b.numGlyphs;w++)a.addDynamicAttributes(f,u,v);o&&b.associatedIconIndex>=0&&(q[b.associatedIconIndex]={shiftedAnchor:u,angle:v})}else cu(b.numGlyphs,f)}if(o){e.clear();for(var x=c.icon.placedSymbolArray,g=0;g<x.length;g++){var h=x.get(g);if(h.hidden)cu(h.numGlyphs,e);else{var l=q[g];if(l)for(var y=0;y<h.numGlyphs;y++)a.addDynamicAttributes(e,l.shiftedAnchor,l.angle);else cu(h.numGlyphs,e)}}c.icon.dynamicLayoutVertexBuffer.updateData(e)}c.text.dynamicLayoutVertexBuffer.updateData(f)}function df(a,b,c){return c.iconsInText&&b?"symbolTextAndIcon":a?"symbolSDF":"symbolIcon"}function dg(b,ah,e,ai,f,E,F,aj,ak,al,G,H){for(var q=b.context,h=q.gl,I=b.transform,o="map"===aj,i="map"===ak,r=o&&"point"!==e.layout.get("symbol-placement"),s=o&&!i&&!r,J=void 0!==e.layout.get("symbol-sort-key").constantOr(1),L=b.depthModeForSublayer(0,K.ReadOnly),M=e.layout.get("text-variable-anchor"),p=[],t=0,N=ai;t<N.length;t+=1){var O,P,Q,R,S,T,U,V,W,X,l=N[t],g=ah.getTile(l),d=g.getBucket(e);if(d){var j=f?d.text:d.icon;if(j&&j.segments.get().length){var am=j.programConfigurations.get(e.id),m=f||d.sdfIcons,k=f?d.textSizeData:d.iconSizeData,Y=i||0!==I.pitch,an=b.useProgram(df(m,f,d),am),u=a.evaluateSizeForZoom(k,I.zoom),n=void 0,Z=[0,0],v=void 0,w=void 0,$=null,_=void 0;if(f){if(v=g.glyphAtlasTexture,w=h.LINEAR,n=g.glyphAtlasTexture.size,d.iconsInText){Z=g.imageAtlasTexture.size,$=g.imageAtlasTexture;var ao="composite"===k.kind||"camera"===k.kind;_=Y||b.options.rotating||b.options.zooming||ao?h.LINEAR:h.NEAREST}}else{var ap=1!==e.layout.get("icon-size").constantOr(0)||d.iconsNeedLinear;v=g.imageAtlasTexture,w=m||b.options.rotating||b.options.zooming||ap||Y?h.LINEAR:h.NEAREST,n=g.imageAtlasTexture.size}var aa=cw(g,1,b.transform.zoom),ab=ci(l.posMatrix,i,o,b.transform,aa),ac=cj(l.posMatrix,i,o,b.transform,aa),aq=M&&d.hasTextData(),ar="none"!==e.layout.get("icon-text-fit")&&aq&&d.hasIconData();r&&cn(d,l.posMatrix,b,f,ab,ac,i,al);var x=b.translatePosMatrix(l.posMatrix,g,E,F),y=r||f&&M||ar?dc:ab,z=b.translatePosMatrix(ac,g,E,F,!0),as=m&&0!==e.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1),ad={program:an,buffers:j,uniformValues:m?d.iconsInText?(O=k.kind,P=u,Q=s,R=i,S=b,T=x,U=y,V=z,W=n,X=Z,a.extend(c7(O,P,Q,R,S,T,U,V,!0,W,!0),{u_texsize_icon:X,u_texture_icon:1})):c7(k.kind,u,s,i,b,x,y,z,f,n,!0):c6(k.kind,u,s,i,b,x,y,z,f,n),atlasTexture:v,atlasTextureIcon:$,atlasInterpolation:w,atlasInterpolationIcon:_,isSDF:m,hasHalo:as};if(J)for(var at=j.segments.get(),A=0,ae=at;A<ae.length;A+=1){var af=ae[A];p.push({segments:new a.SegmentVector([af]),sortKey:af.sortKey,state:ad})}else p.push({segments:j.segments,sortKey:0,state:ad})}}}J&&p.sort(function(a,b){return a.sortKey-b.sortKey});for(var B=0,ag=p;B<ag.length;B+=1){var C=ag[B],c=C.state;if(q.activeTexture.set(h.TEXTURE0),c.atlasTexture.bind(c.atlasInterpolation,h.CLAMP_TO_EDGE),c.atlasTextureIcon&&(q.activeTexture.set(h.TEXTURE1),c.atlasTextureIcon&&c.atlasTextureIcon.bind(c.atlasInterpolationIcon,h.CLAMP_TO_EDGE)),c.isSDF){var D=c.uniformValues;c.hasHalo&&(D.u_is_halo=1,dh(c.buffers,C.segments,e,b,c.program,L,G,H,D)),D.u_is_halo=0}dh(c.buffers,C.segments,e,b,c.program,L,G,H,c.uniformValues)}}function dh(a,e,b,c,f,g,h,i,j){var d=c.context,k=d.gl;f.draw(d,k.TRIANGLES,g,h,i,O.disabled,j,b.id,a.layoutVertexBuffer,a.indexBuffer,e,b.paint,c.transform.zoom,a.programConfigurations.get(b.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function di(b,E,c,F,G,H,t){var k,h,l,m,n,e=b.context.gl,o=c.paint.get("fill-pattern"),g=o&&o.constantOr(1),p=c.getCrossfadeParameters();t?(h=g&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=e.LINES):(h=g?"fillPattern":"fill",k=e.TRIANGLES);for(var q=0,u=F;q<u.length;q+=1){var r=u[q],d=E.getTile(r);if(!g||d.patternsLoaded()){var f=d.getBucket(c);if(f){var i=f.programConfigurations.get(c.id),I=b.useProgram(h,i);g&&(b.context.activeTexture.set(e.TEXTURE0),d.imageAtlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE),i.updatePaintBuffers(p));var s=o.constantOr(null);if(s&&d.imageAtlas){var v=d.imageAtlas,w=v.patternPositions[s.to.toString()],x=v.patternPositions[s.from.toString()];w&&x&&i.setConstantPatternPositions(w,x)}var j=b.translatePosMatrix(r.posMatrix,d,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(t){m=f.indexBuffer2,n=f.segments2;var y,z,A,B,C,D=[e.drawingBufferWidth,e.drawingBufferHeight];l="fillOutlinePattern"===h&&g?(y=j,z=b,A=p,B=d,C=D,a.extend(cQ(y,z,A,B),{u_world:C})):{u_matrix:j,u_world:D}}else m=f.indexBuffer,n=f.segments,l=g?cQ(j,b,p,d):cP(j);I.draw(b.context,k,G,b.stencilModeForClipping(r),H,O.disabled,l,c.id,f.layoutVertexBuffer,m,n,c.paint,b.transform.zoom,i)}}}}function dj(c,C,b,D,E,F,G){for(var g=c.context,h=g.gl,o=b.paint.get("fill-extrusion-pattern"),i=o.constantOr(1),p=b.getCrossfadeParameters(),q=b.paint.get("fill-extrusion-opacity"),j=0,r=D;j<r.length;j+=1){var k=r[j],d=C.getTile(k),e=d.getBucket(b);if(e){var f=e.programConfigurations.get(b.id),H=c.useProgram(i?"fillExtrusionPattern":"fillExtrusion",f);i&&(c.context.activeTexture.set(h.TEXTURE0),d.imageAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),f.updatePaintBuffers(p));var l=o.constantOr(null);if(l&&d.imageAtlas){var s=d.imageAtlas,t=s.patternPositions[l.to.toString()],u=s.patternPositions[l.from.toString()];t&&u&&f.setConstantPatternPositions(t,u)}var v,m,w,x,y,z,n,A=c.translatePosMatrix(k.posMatrix,d,b.paint.get("fill-extrusion-translate"),b.paint.get("fill-extrusion-translate-anchor")),B=b.paint.get("fill-extrusion-vertical-gradient"),I=i?(v=A,m=c,w=B,x=q,y=k,z=p,n=d,a.extend(cO(v,m,w,x),cN(z,m,n),{u_height_factor:-Math.pow(2,y.overscaledZ)/n.tileSize/8})):cO(A,c,B,q);H.draw(g,g.gl.TRIANGLES,E,F,G,O.backCCW,I,b.id,e.layoutVertexBuffer,e.indexBuffer,e.segments,b.paint,c.transform.zoom,f)}}}function dk(a,d,e,g,h,i){var c=a.context,b=c.gl,f=d.fbo;if(f){var j=a.useProgram("hillshade");c.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,f.colorAttachment.get());var k=cW(a,d,e);j.draw(c,b.TRIANGLES,g,h,i,O.disabled,k,e.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function dl(e,b,l,m,n,o,p){var d=e.context,c=d.gl,f=b.dem;if(f&&f.data){var g=f.dim,q=f.stride,i=f.getPixels();if(d.activeTexture.set(c.TEXTURE1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),b.demTexture=b.demTexture||e.getTileTexture(q),b.demTexture){var j=b.demTexture;j.update(i,{premultiply:!1}),j.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else b.demTexture=new a.Texture(d,i,c.RGBA,{premultiply:!1}),b.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);d.activeTexture.set(c.TEXTURE0);var h=b.fbo;if(!h){var k=new a.Texture(d,{width:g,height:g,data:null},c.RGBA);k.bind(c.LINEAR,c.CLAMP_TO_EDGE),(h=b.fbo=d.createFramebuffer(g,g,!0)).colorAttachment.set(k.texture)}d.bindFramebuffer.set(h.framebuffer),d.viewport.set([0,0,g,g]),e.useProgram("hillshadePrepare").draw(d,c.TRIANGLES,n,o,p,O.disabled,cX(b.tileID,f,m),l.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),b.needsHillshadePrepare=!1}}function dm(b,c,k,l,m){var d=l.paint.get("raster-fade-duration");if(!(d>0))return{opacity:1,mix:0};var e=a.browser.now(),f=(e-b.timeAdded)/d,n=c?(e-c.timeAdded)/d:-1,g=k.getSource(),h=m.coveringZoomLevel({tileSize:g.tileSize,roundZoom:g.roundZoom}),i=!c||Math.abs(c.tileID.overscaledZ-h)>Math.abs(b.tileID.overscaledZ-h),j=i&&b.refreshedUponExpiration?1:a.clamp(i?f:1-n,0,1);return(b.refreshedUponExpiration&&f>=1&&(b.refreshedUponExpiration=!1),c)?{opacity:1,mix:1-j}:{opacity:j,mix:0}}var dn=new a.Color(1,0,0,1),dp=new a.Color(0,1,0,1),dq=new a.Color(0,0,1,1),dr=new a.Color(1,0,1,1),ds=new a.Color(0,1,1,1);function dt(a,c,b,d){dv(a,0,c+b/2,a.transform.width,b,d)}function du(a,c,b,d){dv(a,c-b/2,0,b,a.transform.height,d)}function dv(d,e,f,g,h,i){var c=d.context,b=c.gl;b.enable(b.SCISSOR_TEST),b.scissor(e*a.browser.devicePixelRatio,f*a.browser.devicePixelRatio,g*a.browser.devicePixelRatio,h*a.browser.devicePixelRatio),c.clear({color:i}),b.disable(b.SCISSOR_TEST)}function dw(b,f,c){var e=b.context,d=e.gl,g=c.posMatrix,h=b.useProgram("debug"),i=K.disabled,j=aj.disabled,n=b.colorModeForRenderPass(),k="$debug";e.activeTexture.set(d.TEXTURE0),b.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),h.draw(e,d.LINE_STRIP,i,j,n,O.disabled,cT(g,a.Color.red),k,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments);var l=f.getTileByID(c.key).latestRawTileData,o=l&&l.byteLength||0,p=512/Math.min(f.getTile(c).tileSize,512)*(c.overscaledZ/b.transform.zoom)*.5,m=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(m+=" => "+c.overscaledZ),dx(b,m+" "+Math.floor(o/1024)+"kb"),h.draw(e,d.TRIANGLES,i,j,t.alphaBlended,O.disabled,cT(g,a.Color.transparent,p),k,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments)}function dx(b,d){b.initDebugOverlayCanvas();var c=b.debugOverlayCanvas,e=b.context.gl,a=b.debugOverlayCanvas.getContext("2d");a.clearRect(0,0,c.width,c.height),a.shadowColor="white",a.shadowBlur=2,a.lineWidth=1.5,a.strokeStyle="white",a.textBaseline="top",a.font="bold 36px Open Sans, sans-serif",a.fillText(d,5,5),a.strokeText(d,5,5),b.debugOverlayTexture.update(c),b.debugOverlayTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}var dy={symbol:function(c,d,b,e,h){if("translucent"===c.renderPass){var f=aj.disabled,g=c.colorModeForRenderPass();b.layout.get("text-variable-anchor")&&function(m,c,h,n,o,p,q){for(var d=c.transform,i="map"===o,j="map"===p,e=0,k=m;e<k.length;e+=1){var f=k[e],g=n.getTile(f),b=g.getBucket(h);if(b&&b.text&&b.text.segments.get().length){var r=b.textSizeData,l=a.evaluateSizeForZoom(r,d.zoom),s=cw(g,1,c.transform.zoom),t=ci(f.posMatrix,j,i,c.transform,s),u="none"!==h.layout.get("icon-text-fit")&&b.hasIconData();if(l){var v=Math.pow(2,d.zoom-g.tileID.overscaledZ);de(b,i,j,q,a.symbolSize,d,t,f.posMatrix,v,l,u)}}}}(e,c,b,d,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),h),0!==b.paint.get("icon-opacity").constantOr(1)&&dg(c,d,b,e,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),f,g),0!==b.paint.get("text-opacity").constantOr(1)&&dg(c,d,b,e,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),f,g),d.map.showCollisionBoxes&&(da(c,d,b,e,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),!0),da(c,d,b,e,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),!1))}},circle:function(c,u,b,j){if("translucent"===c.renderPass){var v=b.paint.get("circle-opacity"),w=b.paint.get("circle-stroke-width"),x=b.paint.get("circle-stroke-opacity"),k=void 0!==b.layout.get("circle-sort-key").constantOr(1);if(0!==v.constantOr(1)||0!==w.constantOr(1)&&0!==x.constantOr(1)){for(var l=c.context,y=l.gl,z=c.depthModeForSublayer(0,K.ReadOnly),A=aj.disabled,B=c.colorModeForRenderPass(),f=[],g=0;g<j.length;g++){var m=j[g],n=u.getTile(m),d=n.getBucket(b);if(d){var o=d.programConfigurations.get(b.id),C=c.useProgram("circle",o),D=d.layoutVertexBuffer,E=d.indexBuffer,F=cR(c,m,n,b),p={programConfiguration:o,program:C,layoutVertexBuffer:D,indexBuffer:E,uniformValues:F};if(k)for(var G=d.segments.get(),h=0,q=G;h<q.length;h+=1){var r=q[h];f.push({segments:new a.SegmentVector([r]),sortKey:r.sortKey,state:p})}else f.push({segments:d.segments,sortKey:0,state:p})}}k&&f.sort(function(a,b){return a.sortKey-b.sortKey});for(var i=0,s=f;i<s.length;i+=1){var t=s[i],e=t.state,H=e.programConfiguration,I=e.program,J=e.layoutVertexBuffer,L=e.indexBuffer,M=e.uniformValues,N=t.segments;I.draw(l,y.TRIANGLES,z,A,B,O.disabled,M,b.id,J,L,N,b.paint,c.transform.zoom,H)}}}},heatmap:function(b,i,c,j){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){var d=b.context,f=d.gl,q=aj.disabled,r=new t([f.ONE,f.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(b,d,h){var a=b.gl;b.activeTexture.set(a.TEXTURE1),b.viewport.set([0,0,d.width/4,d.height/4]);var e=h.heatmapFbo;if(e)a.bindTexture(a.TEXTURE_2D,e.colorAttachment.get()),b.bindFramebuffer.set(e.framebuffer);else{var f,g,i,j,c,k,l=a.createTexture();a.bindTexture(a.TEXTURE_2D,l),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),e=h.heatmapFbo=b.createFramebuffer(d.width/4,d.height/4,!1),f=b,g=d,i=l,j=e,c=f.gl,k=f.extRenderToTextureHalfFloat?f.extTextureHalfFloat.HALF_FLOAT_OES:c.UNSIGNED_BYTE,c.texImage2D(c.TEXTURE_2D,0,c.RGBA,g.width/4,g.height/4,0,c.RGBA,k,null),j.colorAttachment.set(i)}})(d,b,c),d.clear({color:a.Color.transparent});for(var g=0;g<j.length;g++){var h=j[g];if(!i.hasRenderableParent(h)){var k=i.getTile(h),e=k.getBucket(c);if(e){var l,m,n,o,p=e.programConfigurations.get(c.id),s=b.useProgram("heatmap",p),u=b.transform,v=u.zoom;s.draw(d,f.TRIANGLES,K.disabled,q,r,O.disabled,(l=h.posMatrix,m=k,n=v,o=c.paint.get("heatmap-intensity"),{u_matrix:l,u_extrude_scale:cw(m,1,n),u_intensity:o}),c.id,e.layoutVertexBuffer,e.indexBuffer,e.segments,c.paint,b.transform.zoom,p)}}}d.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(b,d){var e=b.context,c=e.gl,g=d.heatmapFbo;if(g){e.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,g.colorAttachment.get()),e.activeTexture.set(c.TEXTURE1);var f=d.colorRampTexture;f||(f=d.colorRampTexture=new a.Texture(e,d.colorRamp,c.RGBA)),f.bind(c.LINEAR,c.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(e,c.TRIANGLES,K.disabled,aj.disabled,b.colorModeForRenderPass(),O.disabled,cV(b,d,0,1),d.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,d.paint,b.transform.zoom)}}(b,c))},line:function(c,x,b,y){if("translucent"===c.renderPass){var z=b.paint.get("line-opacity"),A=b.paint.get("line-width");if(0!==z.constantOr(1)&&0!==A.constantOr(1)){var B=c.depthModeForSublayer(0,K.ReadOnly),C=c.colorModeForRenderPass(),h=b.paint.get("line-dasharray"),p=b.paint.get("line-pattern"),i=p.constantOr(1),k=b.paint.get("line-gradient"),l=b.getCrossfadeParameters(),D=i?"linePattern":h?"lineSDF":k?"lineGradient":"line",f=c.context,d=f.gl,q=!0;if(k){f.activeTexture.set(d.TEXTURE0);var m=b.gradientTexture;if(!b.gradient)return;m||(m=b.gradientTexture=new a.Texture(f,b.gradient,d.RGBA)),m.bind(d.LINEAR,d.CLAMP_TO_EDGE)}for(var n=0,r=y;n<r.length;n+=1){var s=r[n],e=x.getTile(s);if(!i||e.patternsLoaded()){var g=e.getBucket(b);if(g){var j=g.programConfigurations.get(b.id),E=c.context.program.get(),t=c.useProgram(D,j),F=q||t.program!==E,o=p.constantOr(null);if(o&&e.imageAtlas){var u=e.imageAtlas,v=u.patternPositions[o.to.toString()],w=u.patternPositions[o.from.toString()];v&&w&&j.setConstantPatternPositions(v,w)}var G=i?c_(c,e,b,l):h?c0(c,e,b,h,l):k?c$(c,e,b):cZ(c,e,b);i?(f.activeTexture.set(d.TEXTURE0),e.imageAtlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),j.updatePaintBuffers(l)):h&&(F||c.lineAtlas.dirty)&&(f.activeTexture.set(d.TEXTURE0),c.lineAtlas.bind(f)),t.draw(f,d.TRIANGLES,B,c.stencilModeForClipping(s),C,O.disabled,G,b.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,b.paint,c.transform.zoom,j),q=!1}}}}}},fill:function(b,d,c,e){var h=c.paint.get("fill-color"),f=c.paint.get("fill-opacity");if(0!==f.constantOr(1)){var g=b.colorModeForRenderPass(),i=c.paint.get("fill-pattern"),j=b.opaquePassEnabledForLayer()&& !i.constantOr(1)&&1===h.constantOr(a.Color.transparent).a&&1===f.constantOr(0)?"opaque":"translucent";if(b.renderPass===j){var k=b.depthModeForSublayer(1,"opaque"===b.renderPass?K.ReadWrite:K.ReadOnly);di(b,d,c,e,k,g,!1)}if("translucent"===b.renderPass&&c.paint.get("fill-antialias")){var l=b.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,K.ReadOnly);di(b,d,c,e,l,g,!0)}}},"fill-extrusion":function(a,c,b,d){var f=b.paint.get("fill-extrusion-opacity");if(0!==f&&"translucent"===a.renderPass){var e=new K(a.context.gl.LEQUAL,K.ReadWrite,a.depthRangeFor3D);if(1!==f||b.paint.get("fill-extrusion-pattern").constantOr(1))dj(a,c,b,d,e,aj.disabled,t.disabled),dj(a,c,b,d,e,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var g=a.colorModeForRenderPass();dj(a,c,b,d,e,aj.disabled,g)}}},hillshade:function(a,d,e,f){if("offscreen"===a.renderPass||"translucent"===a.renderPass){for(var l=a.context,m=d.getSource().maxzoom,g=a.depthModeForSublayer(0,K.ReadOnly),h=a.colorModeForRenderPass(),i="translucent"===a.renderPass?a.stencilConfigForOverlap(f):[{},f],n=i[0],o=i[1],b=0,j=o;b<j.length;b+=1){var k=j[b],c=d.getTile(k);c.needsHillshadePrepare&&"offscreen"===a.renderPass?dl(a,c,e,m,g,aj.disabled,h):"translucent"===a.renderPass&&dk(a,c,e,g,n[k.overscaledZ],h)}l.viewport.set([0,0,a.width,a.height])}},raster:function(a,h,c,l){if("translucent"===a.renderPass&&0!==c.paint.get("raster-opacity")&&l.length)for(var f=a.context,b=f.gl,i=h.getSource(),q=a.useProgram("raster"),r=a.colorModeForRenderPass(),s=i instanceof _?[{},l]:a.stencilConfigForOverlap(l),A=s[0],m=s[1],B=m[m.length-1].overscaledZ,C=!a.options.moving,n=0,t=m;n<t.length;n+=1){var g=t[n],u=a.depthModeForSublayer(g.overscaledZ-B,1===c.paint.get("raster-opacity")?K.ReadWrite:K.ReadOnly,b.LESS),d=h.getTile(g),D=a.transform.calculatePosMatrix(g.toUnwrapped(),C);d.registerFadeDuration(c.paint.get("raster-fade-duration"));var v,w,x,o,e,j=h.findLoadedParent(g,0),E=dm(d,j,h,c,a.transform),k=void 0,y=void 0,p="nearest"===c.paint.get("raster-resampling")?b.NEAREST:b.LINEAR;f.activeTexture.set(b.TEXTURE0),d.texture.bind(p,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),f.activeTexture.set(b.TEXTURE1),j?(j.texture.bind(p,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),k=Math.pow(2,j.tileID.overscaledZ-d.tileID.overscaledZ),y=[d.tileID.canonical.x*k%1,d.tileID.canonical.y*k%1]):d.texture.bind(p,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST);var z=(v=D,w=y||[0,0],x=k||1,o=E,e=c,{u_matrix:v,u_tl_parent:w,u_scale_parent:x,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*e.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:e.paint.get("raster-brightness-min"),u_brightness_high:e.paint.get("raster-brightness-max"),u_saturation_factor:c5(e.paint.get("raster-saturation")),u_contrast_factor:c4(e.paint.get("raster-contrast")),u_spin_weights:c3(e.paint.get("raster-hue-rotate"))});i instanceof _?q.draw(f,b.TRIANGLES,u,aj.disabled,r,O.disabled,z,c.id,i.boundsBuffer,a.quadTriangleIndexBuffer,i.boundsSegments):q.draw(f,b.TRIANGLES,u,A[g.overscaledZ],r,O.disabled,z,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,v,c){var g=c.paint.get("background-color"),d=c.paint.get("background-opacity");if(0!==d){var e=a.context,h=e.gl,i=a.transform,j=i.tileSize,b=c.paint.get("background-pattern");if(!a.isPatternMissing(b)){var k=!b&&1===g.a&&1===d&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===k){var o=aj.disabled,p=a.depthModeForSublayer(0,"opaque"===k?K.ReadWrite:K.ReadOnly),q=a.colorModeForRenderPass(),r=a.useProgram(b?"backgroundPattern":"background"),s=i.coveringTiles({tileSize:j});b&&(e.activeTexture.set(h.TEXTURE0),a.imageManager.bind(a.context));for(var t=c.getCrossfadeParameters(),f=0,l=s;f<l.length;f+=1){var m=l[f],n=a.transform.calculatePosMatrix(m.toUnwrapped()),u=b?c8(n,d,a,b,{tileID:m,tileSize:j},t):{u_matrix:n,u_opacity:d,u_color:g};r.draw(e,h.TRIANGLES,p,o,q,O.disabled,u,c.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(c,d,b){for(var a=0;a<b.length;a++)dw(c,d,b[a])},custom:function(a,g,e){var b=a.context,c=e.implementation;if("offscreen"===a.renderPass){var d=c.prerender;d&&(a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),d.call(c,b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass){a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),b.setStencilMode(aj.disabled);var f="3d"===c.renderingMode?new K(a.context.gl.LEQUAL,K.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,K.ReadOnly);b.setDepthMode(f),c.render(b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState(),b.bindFramebuffer.set(null)}}},e=function(a,b){this.context=new n(a),this.transform=b,this._tileTextures={},this.setup(),this.numSublayers=ak.maxUnderzooming+ak.maxOverzooming+1,this.depthEpsilon=152587890625e-16,this.crossTileSymbolIndex=new ao,this.gpuTimers={}};e.prototype.resize=function(d,e){if(this.width=d*a.browser.devicePixelRatio,this.height=e*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var b=0,c=this.style._order;b<c.length;b+=1){var f=c[b];this.style._layers[f].resize()}},e.prototype.setup=function(){var b=this.context,d=new a.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(a.EXTENT,0),d.emplaceBack(0,a.EXTENT),d.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=b.createVertexBuffer(d,cK.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);var e=new a.StructArrayLayout2i4;e.emplaceBack(0,0),e.emplaceBack(a.EXTENT,0),e.emplaceBack(0,a.EXTENT),e.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=b.createVertexBuffer(e,cK.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);var f=new a.StructArrayLayout4i8;f.emplaceBack(0,0,0,0),f.emplaceBack(a.EXTENT,0,a.EXTENT,0),f.emplaceBack(0,a.EXTENT,0,a.EXTENT),f.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=b.createVertexBuffer(f,bq.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);var g=new a.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=b.createVertexBuffer(g,cK.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);var c=new a.StructArrayLayout1ui2;c.emplaceBack(0),c.emplaceBack(1),c.emplaceBack(3),c.emplaceBack(2),c.emplaceBack(0),this.tileBorderIndexBuffer=b.createIndexBuffer(c);var i=new a.StructArrayLayout3ui6;i.emplaceBack(0,1,2),i.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=b.createIndexBuffer(i),this.emptyTexture=new a.Texture(b,{width:1,height:1,data:new Uint8Array([0,0,0,0])},b.gl.RGBA);var h=this.context.gl;this.stencilClearMode=new aj({func:h.ALWAYS,mask:0},0,255,h.ZERO,h.ZERO,h.ZERO)},e.prototype.clearStencil=function(){var d=this.context,c=d.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var b=a.create();a.ortho(b,0,this.width,this.height,0,0,1),a.scale(b,b,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,c.TRIANGLES,K.disabled,this.stencilClearMode,t.disabled,O.disabled,cU(b),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},e.prototype._renderTileClippingMasks=function(d,b){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&b&&b.length){this.currentStencilSource=d.source;var c=this.context,a=c.gl;this.nextStencilID+b.length>256&&this.clearStencil(),c.setColorMode(t.disabled),c.setDepthMode(K.disabled);var h=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var e=0,f=b;e<f.length;e+=1){var g=f[e],i=this._tileClippingMaskIDs[g.key]=this.nextStencilID++;h.draw(c,a.TRIANGLES,K.disabled,new aj({func:a.ALWAYS,mask:0},i,255,a.KEEP,a.KEEP,a.REPLACE),t.disabled,O.disabled,cU(g.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},e.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var b=this.nextStencilID++,a=this.context.gl;return new aj({func:a.NOTEQUAL,mask:255},b,255,a.KEEP,a.KEEP,a.REPLACE)},e.prototype.stencilModeForClipping=function(b){var a=this.context.gl;return new aj({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[b.key],0,a.KEEP,a.KEEP,a.REPLACE)},e.prototype.stencilConfigForOverlap=function(h){var f,b=this.context.gl,a=h.sort(function(a,b){return b.overscaledZ-a.overscaledZ}),e=a[a.length-1].overscaledZ,c=a[0].overscaledZ-e+1;if(c>1){this.currentStencilSource=void 0,this.nextStencilID+c>256&&this.clearStencil();for(var g={},d=0;d<c;d++)g[d+e]=new aj({func:b.GEQUAL,mask:255},d+this.nextStencilID,255,b.KEEP,b.KEEP,b.REPLACE);return this.nextStencilID+=c,[g,a]}return[((f={})[e]=aj.disabled,f),a]},e.prototype.colorModeForRenderPass=function(){var c=this.context.gl;if(this._showOverdrawInspector){var b=.125;return new t([c.CONSTANT_COLOR,c.ONE],new a.Color(b,b,b,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.unblended:t.alphaBlended},e.prototype.depthModeForSublayer=function(b,c,d){if(!this.opaquePassEnabledForLayer())return K.disabled;var a=1-((1+this.currentLayer)*this.numSublayers+b)*this.depthEpsilon;return new K(d||this.context.gl.LEQUAL,c,[a,a])},e.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},e.prototype.render=function(e,m){var n,o,p,q,r,H,b,h,s,I=this;this.style=e,this.options=m,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var c=this.style._order,d=this.style.sourceCaches;for(var B in d){var v=d[B];v.used&&v.prepare(this.context)}var j={},t={},w={};for(var i in d){var x=d[i];j[i]=x.getVisibleCoordinates(),t[i]=j[i].slice().reverse(),w[i]=x.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var k=0;k<c.length;k++){var C=c[k];if(this.style._layers[C].is3D()){this.opaquePassCutoff=k;break}}this.renderPass="offscreen";for(var u=0,y=c;u<y.length;u+=1){var D=y[u],f=this.style._layers[D];if(!(!f.hasOffscreenPass()||f.isHidden(this.transform.zoom))){var z=t[f.source];("custom"===f.type||z.length)&&this.renderLayer(this,d[f.source],f,z)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){var l=this.style._layers[c[this.currentLayer]],E=d[l.source],A=j[l.source];this._renderTileClippingMasks(l,A),this.renderLayer(this,E,l,A)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){var g=this.style._layers[c[this.currentLayer]],F=d[g.source],G=("symbol"===g.type?w:t)[g.source];this._renderTileClippingMasks(g,j[g.source]),this.renderLayer(this,F,g,G)}this.options.showTileBoundaries&&(a.values(this.style._layers).forEach(function(a){a.source&&!a.isHidden(I.transform.zoom)&&(a.source!==(H&&H.id)&&(H=I.style.sourceCaches[a.source]),(!r||r.getSource().maxzoom<H.getSource().maxzoom)&&(r=H))}),r&&dy.debug(this,r,r.getVisibleCoordinates())),this.options.showPadding&&(b=this,h=b.transform.padding,dt(b,b.transform.height-(h.top||0),3,dn),dt(b,h.bottom||0,3,dp),du(b,h.left||0,3,dq),du(b,b.transform.width-(h.right||0),3,dr),s=b.transform.centerPoint,n=b,o=s.x,p=b.transform.height-s.y,q=ds,dv(n,o-1,p-10,2,20,q),dv(n,o-10,p-1,20,2,q)),this.context.setDefault()},e.prototype.renderLayer=function(c,d,a,b){!a.isHidden(this.transform.zoom)&&("background"===a.type||"custom"===a.type||b.length)&&(this.id=a.id,this.gpuTimingStart(a),dy[a.type](c,d,a,b,this.style.placement.variableOffsets),this.gpuTimingEnd())},e.prototype.gpuTimingStart=function(c){if(this.options.gpuTiming){var b=this.context.extTimerQuery,a=this.gpuTimers[c.id];a||(a=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:b.createQueryEXT()}),a.calls++,b.beginQueryEXT(b.TIME_ELAPSED_EXT,a.query)}},e.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}},e.prototype.collectGpuTimers=function(){var a=this.gpuTimers;return this.gpuTimers={},a},e.prototype.queryGpuTimers=function(b){var c={};for(var d in b){var e=b[d],a=this.context.extTimerQuery,f=a.getQueryObjectEXT(e.query,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(e.query),c[d]=f}return c},e.prototype.translatePosMatrix=function(e,f,b,g,c){if(!b[0]&&!b[1])return e;var d=c?"map"===g?this.transform.angle:0:"viewport"===g?-this.transform.angle:0;if(d){var h=Math.sin(d),i=Math.cos(d);b=[b[0]*i-b[1]*h,b[0]*h+b[1]*i]}var k=[c?b[0]:cw(f,b[0],this.transform.zoom),c?b[1]:cw(f,b[1],this.transform.zoom),0],j=new Float32Array(16);return a.translate(j,e,k),j},e.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size[0]];b?b.push(a):this._tileTextures[a.size[0]]=[a]},e.prototype.getTileTexture=function(b){var a=this._tileTextures[b];return a&&a.length>0?a.pop():null},e.prototype.isPatternMissing=function(a){if(!a)return!1;if(!a.from||!a.to)return!0;var b=this.imageManager.getPattern(a.from.toString()),c=this.imageManager.getPattern(a.to.toString());return!b||!c},e.prototype.useProgram=function(a,b){this.cache=this.cache||{};var c=""+a+(b?b.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new a1(this.context,cM[a],b,c9[a],this._showOverdrawInspector)),this.cache[c]},e.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},e.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)},e.prototype.initDebugOverlayCanvas=function(){if(null==this.debugOverlayCanvas){this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var b=this.context.gl;this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,b.RGBA)}},e.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var a2=function(a,b){this.points=a,this.planes=b};a2.fromInvProjectionMatrix=function(e,f,b){var g=Math.pow(2,b),c=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(b){return a.transformMat4([],b,e)}).map(function(b){return a.scale$1([],b,1/b[3]/f*g)}),d=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(b){var e=a.sub([],c[b[0]],c[b[1]]),f=a.sub([],c[b[2]],c[b[1]]),d=a.normalize([],a.cross([],e,f)),g=-a.dot(d,c[b[1]]);return d.concat(g)});return new a2(c,d)};var R=function(b,c){this.min=b,this.max=c,this.center=a.scale$2([],a.add([],this.min,this.max),.5)};R.prototype.quadrant=function(e){for(var c=[e%2==0,e<2],f=a.clone$2(this.min),d=a.clone$2(this.max),b=0;b<c.length;b++)f[b]=c[b]?this.min[b]:this.center[b],d[b]=c[b]?this.center[b]:this.max[b];return d[2]=this.max[2],new R(f,d)},R.prototype.distanceX=function(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]},R.prototype.distanceY=function(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]},R.prototype.intersects=function(c){for(var d=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],k=!0,e=0;e<c.planes.length;e++){for(var m=c.planes[e],f=0,g=0;g<d.length;g++)f+=a.dot$1(m,d[g])>=0;if(0===f)return 0;f!==d.length&&(k=!1)}if(k)return 2;for(var b=0;b<3;b++){for(var h=Number.MAX_VALUE,i=-Number.MAX_VALUE,j=0;j<c.points.length;j++){var l=c.points[j][b]-this.min[b];h=Math.min(h,l),i=Math.max(i,l)}if(i<0||h>this.max[b]-this.min[b])return 0}return 1};var L=function(a,b,c,d){if(void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),isNaN(a)||a<0||isNaN(b)||b<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=b,this.left=c,this.right=d};L.prototype.interpolate=function(b,c,d){return null!=c.top&&null!=b.top&&(this.top=a.number(b.top,c.top,d)),null!=c.bottom&&null!=b.bottom&&(this.bottom=a.number(b.bottom,c.bottom,d)),null!=c.left&&null!=b.left&&(this.left=a.number(b.left,c.left,d)),null!=c.right&&null!=b.right&&(this.right=a.number(b.right,c.right,d)),this},L.prototype.getCenter=function(b,c){var d=a.clamp((this.left+b-this.right)/2,0,b),e=a.clamp((this.top+c-this.bottom)/2,0,c);return new a.Point(d,e)},L.prototype.equals=function(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right},L.prototype.clone=function(){return new L(this.top,this.bottom,this.left,this.right)},L.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var c=function(e,f,b,c,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===d||d,this._minZoom=e||0,this._maxZoom=f||22,this._minPitch=null==b?0:b,this._maxPitch=null==c?60:c,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new L,this._posMatrixCache={},this._alignedPosMatrixCache={}},d={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};c.prototype.clone=function(){var a=new c(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._calcMatrices(),a},d.minZoom.get=function(){return this._minZoom},d.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},d.maxZoom.get=function(){return this._maxZoom},d.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},d.minPitch.get=function(){return this._minPitch},d.minPitch.set=function(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))},d.maxPitch.get=function(){return this._maxPitch},d.maxPitch.set=function(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))},d.renderWorldCopies.get=function(){return this._renderWorldCopies},d.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},d.worldSize.get=function(){return this.tileSize*this.scale},d.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},d.size.get=function(){return new a.Point(this.width,this.height)},d.bearing.get=function(){return-this.angle/Math.PI*180},d.bearing.set=function(c){var b=-a.wrap(c,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},d.pitch.get=function(){return this._pitch/Math.PI*180},d.pitch.set=function(c){var b=a.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())},d.fov.get=function(){return this._fov/Math.PI*180},d.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},d.zoom.get=function(){return this._zoom},d.zoom.set=function(b){var a=Math.min(Math.max(b,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},d.center.get=function(){return this._center},d.center.set=function(a){(a.lat!==this._center.lat||a.lng!==this._center.lng)&&(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},d.padding.get=function(){return this._edgeInsets.toJSON()},d.padding.set=function(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())},d.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},c.prototype.isPaddingEqual=function(a){return this._edgeInsets.equals(a)},c.prototype.interpolatePadding=function(a,b,c){this._unmodified=!1,this._edgeInsets.interpolate(a,b,c),this._constrain(),this._calcMatrices()},c.prototype.coveringZoomLevel=function(a){var b=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,b)},c.prototype.getVisibleUnwrappedCoordinates=function(c){var d=[new a.UnwrappedTileID(0,c)];if(this._renderWorldCopies)for(var e=this.pointCoordinate(new a.Point(0,0)),f=this.pointCoordinate(new a.Point(this.width,0)),g=this.pointCoordinate(new a.Point(this.width,this.height)),h=this.pointCoordinate(new a.Point(0,this.height)),j=Math.floor(Math.min(e.x,f.x,g.x,h.x)),k=Math.floor(Math.max(e.x,f.x,g.x,h.x)),i=1,b=j-i;b<=k+i;b++)0!==b&&d.push(new a.UnwrappedTileID(b,c));return d},c.prototype.coveringTiles=function(d){var c=this.coveringZoomLevel(d),s=c;if(void 0!==d.minzoom&&c<d.minzoom)return[];void 0!==d.maxzoom&&c>d.maxzoom&&(c=d.maxzoom);var n=a.MercatorCoordinate.fromLngLat(this.center),o=Math.pow(2,c),g=[o*n.x,o*n.y,0],t=a2.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c),p=d.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(p=c);var i=function(a){return{aabb:new R([a*o,0,0],[(a+1)*o,o,0]),zoom:0,x:0,y:0,wrap:a,fullyVisible:!1}},e=[],q=[],j=c,u=d.reparseOverscaled?s:c;if(this._renderWorldCopies)for(var h=1;h<=3;h++)e.push(i(-h)),e.push(i(h));for(e.push(i(0));e.length>0;){var b=e.pop(),k=b.x,l=b.y,m=b.fullyVisible;if(!m){var r=b.aabb.intersects(t);if(0===r)continue;m=2===r}var v=b.aabb.distanceX(g),w=b.aabb.distanceY(g),x=Math.max(Math.abs(v),Math.abs(w)),y=3+(1<<j-b.zoom)-2;if(b.zoom===j||x>y&&b.zoom>=p){q.push({tileID:new a.OverscaledTileID(b.zoom===j?u:b.zoom,b.wrap,b.zoom,k,l),distanceSq:a.sqrLen([g[0]-.5-k,g[1]-.5-l])});continue}for(var f=0;f<4;f++){var z=(k<<1)+f%2,A=(l<<1)+(f>>1);e.push({aabb:b.aabb.quadrant(f),zoom:b.zoom+1,x:z,y:A,wrap:b.wrap,fullyVisible:m})}}return q.sort(function(a,b){return a.distanceSq-b.distanceSq}).map(function(a){return a.tileID})},c.prototype.resize=function(a,b){this.width=a,this.height=b,this.pixelsToGLUnits=[2/a,-2/b],this._constrain(),this._calcMatrices()},d.unmodified.get=function(){return this._unmodified},c.prototype.zoomScale=function(a){return Math.pow(2,a)},c.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},c.prototype.project=function(b){var c=a.clamp(b.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(b.lng)*this.worldSize,a.mercatorYfromLat(c)*this.worldSize)},c.prototype.unproject=function(b){return new a.MercatorCoordinate(b.x/this.worldSize,b.y/this.worldSize).toLngLat()},d.point.get=function(){return this.project(this.center)},c.prototype.setLocationAtPoint=function(e,f){var b=this.pointCoordinate(f),c=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(e),g=new a.MercatorCoordinate(d.x-(b.x-c.x),d.y-(b.y-c.y));this.center=this.coordinateLocation(g),this._renderWorldCopies&&(this.center=this.center.wrap())},c.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},c.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},c.prototype.locationCoordinate=function(b){return a.MercatorCoordinate.fromLngLat(b)},c.prototype.coordinateLocation=function(a){return a.toLngLat()},c.prototype.pointCoordinate=function(d){var b=[d.x,d.y,0,1],c=[d.x,d.y,1,1];a.transformMat4(b,b,this.pixelMatrixInverse),a.transformMat4(c,c,this.pixelMatrixInverse);var e=b[3],f=c[3],j=b[0]/e,k=c[0]/f,l=b[1]/e,m=c[1]/f,g=b[2]/e,h=c[2]/f,i=g===h?0:(0-g)/(h-g);return new a.MercatorCoordinate(a.number(j,k,i)/this.worldSize,a.number(l,m,i)/this.worldSize)},c.prototype.coordinatePoint=function(c){var b=[c.x*this.worldSize,c.y*this.worldSize,0,1];return a.transformMat4(b,b,this.pixelMatrix),new a.Point(b[0]/b[3],b[1]/b[3])},c.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},c.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},c.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},c.prototype.calculatePosMatrix=function(h,c){void 0===c&&(c=!1);var d=h.key,e=c?this._alignedPosMatrixCache:this._posMatrixCache;if(e[d])return e[d];var f=h.canonical,g=this.worldSize/this.zoomScale(f.z),i=f.x+Math.pow(2,f.z)*h.wrap,b=a.identity(new Float64Array(16));return a.translate(b,b,[i*g,f.y*g,0]),a.scale(b,b,[g/a.EXTENT,g/a.EXTENT,1]),a.multiply(b,c?this.alignedProjMatrix:this.projMatrix,b),e[d]=new Float32Array(b),e[d]},c.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},c.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,m,h,i,b=-90,c=90,d=-180,e=180,f=this.size,n=this._unmodified;if(this.latRange){var o=this.latRange;b=a.mercatorYfromLat(o[1])*this.worldSize,c=a.mercatorYfromLat(o[0])*this.worldSize,l=c-b<f.y?f.y/(c-b):0}if(this.lngRange){var p=this.lngRange;d=a.mercatorXfromLng(p[0])*this.worldSize,e=a.mercatorXfromLng(p[1])*this.worldSize,m=e-d<f.x?f.x/(e-d):0}var g=this.point,q=Math.max(m||0,l||0);if(q){this.center=this.unproject(new a.Point(m?(e+d)/2:g.x,l?(c+b)/2:g.y)),this.zoom+=this.scaleZoom(q),this._unmodified=n,this._constraining=!1;return}if(this.latRange){var r=g.y,j=f.y/2;r-j<b&&(i=b+j),r+j>c&&(i=c-j)}if(this.lngRange){var s=g.x,k=f.x/2;s-k<d&&(h=d+k),s+k>e&&(h=e-k)}(void 0!==h|| void 0!==i)&&(this.center=this.unproject(new a.Point(void 0!==h?h:g.x,void 0!==i?i:g.y))),this._unmodified=n,this._constraining=!1}},c.prototype._calcMatrices=function(){if(this.height){var o=this._fov/2,c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(o)*this.height;var p=Math.PI/2+this._pitch,i=this._fov*(.5+c.y/this.height),q=Math.sin(i)*this.cameraToCenterDistance/Math.sin(a.clamp(Math.PI-p-i,.01,Math.PI-.01)),j=this.point,d=j.x,e=j.y,r=Math.cos(Math.PI/2-this._pitch)*q+this.cameraToCenterDistance,s=this.height/50,b=new Float64Array(16);a.perspective(b,this._fov,this.width/this.height,s,1.01*r),b[8]=-(2*c.x)/this.width,b[9]=2*c.y/this.height,a.scale(b,b,[1,-1,1]),a.translate(b,b,[0,0,-this.cameraToCenterDistance]),a.rotateX(b,b,this._pitch),a.rotateZ(b,b,this.angle),a.translate(b,b,[-d,-e,0]),this.mercatorMatrix=a.scale([],b,[this.worldSize,this.worldSize,this.worldSize]),a.scale(b,b,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=b,this.invProjMatrix=a.invert([],this.projMatrix);var k=this.width%2/2,l=this.height%2/2,m=Math.cos(this.angle),n=Math.sin(this.angle),f=d-Math.round(d)+m*k+n*l,g=e-Math.round(e)+m*l+n*k,h=new Float64Array(b);if(a.translate(h,h,[f>.5?f-1:f,g>.5?g-1:g,0]),this.alignedProjMatrix=h,b=a.create(),a.scale(b,b,[this.width/2,-this.height/2,1]),a.translate(b,b,[1,-1,0]),this.labelPlaneMatrix=b,b=a.create(),a.scale(b,b,[1,-1,1]),a.translate(b,b,[-1,-1,0]),a.scale(b,b,[2/this.width,2/this.height,1]),this.glCoordMatrix=b,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),b=a.invert(new Float64Array(16),this.pixelMatrix),!b)throw new Error("failed to invert matrix");this.pixelMatrixInverse=b,this._posMatrixCache={},this._alignedPosMatrixCache={}}},c.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var b=this.pointCoordinate(new a.Point(0,0)),c=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance},c.prototype.getCameraPoint=function(){var b=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,b))},c.prototype.getCameraQueryGeometry=function(h){var b=this.getCameraPoint();if(1===h.length)return[h[0],b];for(var c=b.x,d=b.y,e=b.x,f=b.y,i=0,j=h;i<j.length;i+=1){var g=j[i];c=Math.min(c,g.x),d=Math.min(d,g.y),e=Math.max(e,g.x),f=Math.max(f,g.y)}return[new a.Point(c,d),new a.Point(e,d),new a.Point(e,f),new a.Point(c,f),new a.Point(c,d)]},Object.defineProperties(c.prototype,d);var D=function(b){var c,d,e,f;this._hashName=b&&encodeURIComponent(b),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(c=this._updateHashUnthrottled.bind(this),d=!1,e=null,f=function(){e=null,d&&(c(),e=setTimeout(f,300),d=!1)},function(){return d=!0,e||f(),e})};D.prototype.addTo=function(b){return this._map=b,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},D.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},D.prototype.getHashString=function(k){var f=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,c=Math.pow(10,Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10)),g=Math.round(f.lng*c)/c,h=Math.round(f.lat*c)/c,i=this._map.getBearing(),e=this._map.getPitch(),b="";if(k?b+="/"+g+"/"+h+"/"+d:b+=d+"/"+h+"/"+g,(i||e)&&(b+="/"+Math.round(10*i)/10),e&&(b+="/"+Math.round(e)),this._hashName){var l=this._hashName,m=!1,j=a.window.location.hash.slice(1).split("&").map(function(a){var c=a.split("=")[0];return c===l?(m=!0,c+"="+b):a}).filter(function(a){return a});return m||j.push(l+"="+b),"#"+j.join("&")}return"#"+b},D.prototype._getCurrentHash=function(){var b,d=this,c=a.window.location.hash.replace("#","");return this._hashName?(c.split("&").map(function(a){return a.split("=")}).forEach(function(a){a[0]===d._hashName&&(b=a)}),(b?b[1]||"":"").split("/")):c.split("/")},D.prototype._onHashChange=function(){var a=this._getCurrentHash();if(a.length>=3&&!a.some(function(a){return isNaN(a)})){var b=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:b,pitch:+(a[4]||0)}),!0}return!1},D.prototype._updateHashUnthrottled=function(){var b=this.getHashString();try{a.window.history.replaceState(a.window.history.state,"",b)}catch(c){}};var S={linearity:.3,easing:a.bezier(0,0,.3,1)},dz=a.extend({deceleration:2500,maxSpeed:1400},S),dA=a.extend({deceleration:20,maxSpeed:1400},S),dB=a.extend({deceleration:1e3,maxSpeed:360},S),dC=a.extend({deceleration:1e3,maxSpeed:90},S),T=function(a){this._map=a,this.clear()};function dD(a,b){(!a.duration||a.duration<b.duration)&&(a.duration=b.duration,a.easing=b.easing)}function dE(g,h,b){var c=b.maxSpeed,d=b.linearity,i=b.deceleration,e=a.clamp(g*d/(h/1e3),-c,c),f=Math.abs(e)/(i*d);return{easing:b.easing,duration:1e3*f,amount:e*(f/2)}}T.prototype.clear=function(){this._inertiaBuffer=[]},T.prototype.record=function(b){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.browser.now(),settings:b})},T.prototype._drainInertiaBuffer=function(){for(var b=this._inertiaBuffer,c=a.browser.now();b.length>0&&c-b[0].time>160;)b.shift()},T.prototype._onMoveEnd=function(m){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var b={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0},f=0,g=this._inertiaBuffer;f<g.length;f+=1){var d=g[f].settings;b.zoom+=d.zoomDelta||0,b.bearing+=d.bearingDelta||0,b.pitch+=d.pitchDelta||0,d.panDelta&&b.pan._add(d.panDelta),d.around&&(b.around=d.around),d.pinchAround&&(b.pinchAround=d.pinchAround)}var e=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(b.pan.mag()){var h=dE(b.pan.mag(),e,a.extend({},dz,m||{}));c.offset=b.pan.mult(h.amount/b.pan.mag()),c.center=this._map.transform.center,dD(c,h)}if(b.zoom){var i=dE(b.zoom,e,dA);c.zoom=this._map.transform.zoom+i.amount,dD(c,i)}if(b.bearing){var j=dE(b.bearing,e,dB);c.bearing=this._map.transform.bearing+a.clamp(j.amount,-179,179),dD(c,j)}if(b.pitch){var k=dE(b.pitch,e,dC);c.pitch=this._map.transform.pitch+k.amount,dD(c,k)}if(c.zoom||c.bearing){var l=void 0===b.pinchAround?b.around:b.pinchAround;c.around=l?this._map.unproject(l):this._map.getCenter()}return this.clear(),a.extend(c,{noMoveStart:!0})}};var dF=function(c){function b(g,b,e,d){void 0===d&&(d={});var f=m.mousePos(b.getCanvasContainer(),e),h=b.unproject(f);c.call(this,g,a.extend({point:f,lngLat:h,originalEvent:e},d)),this._defaultPrevented=!1,this.target=b}c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b;var d={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,d),b}(a.Event),dG=function(c){function b(e,f,b){var h="touchend"===e?b.changedTouches:b.touches,d=m.touchPos(f.getCanvasContainer(),h),i=d.map(function(a){return f.unproject(a)}),g=d.reduce(function(a,b,d,c){return a.add(b.div(c.length))},new a.Point(0,0)),j=f.unproject(g);c.call(this,e,{points:d,point:g,lngLats:i,lngLat:j,originalEvent:b}),this._defaultPrevented=!1}c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b;var d={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,d),b}(a.Event),dH=function(b){function a(a,d,c){b.call(this,a,{originalEvent:c}),this._defaultPrevented=!1}b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a;var c={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,c),a}(a.Event),h=function(a,b){this._map=a,this._clickTolerance=b.clickTolerance};h.prototype.reset=function(){delete this._mousedownPos},h.prototype.wheel=function(a){return this._firePreventable(new dH(a.type,this._map,a))},h.prototype.mousedown=function(a,b){return this._mousedownPos=b,this._firePreventable(new dF(a.type,this._map,a))},h.prototype.mouseup=function(a){this._map.fire(new dF(a.type,this._map,a))},h.prototype.click=function(a,b){this._mousedownPos&&this._mousedownPos.dist(b)>=this._clickTolerance||this._map.fire(new dF(a.type,this._map,a))},h.prototype.dblclick=function(a){return this._firePreventable(new dF(a.type,this._map,a))},h.prototype.mouseover=function(a){this._map.fire(new dF(a.type,this._map,a))},h.prototype.mouseout=function(a){this._map.fire(new dF(a.type,this._map,a))},h.prototype.touchstart=function(a){return this._firePreventable(new dG(a.type,this._map,a))},h.prototype.touchmove=function(a){this._map.fire(new dG(a.type,this._map,a))},h.prototype.touchend=function(a){this._map.fire(new dG(a.type,this._map,a))},h.prototype.touchcancel=function(a){this._map.fire(new dG(a.type,this._map,a))},h.prototype._firePreventable=function(a){if(this._map.fire(a),a.defaultPrevented)return{}},h.prototype.isEnabled=function(){return!0},h.prototype.isActive=function(){return!1},h.prototype.enable=function(){},h.prototype.disable=function(){};var v=function(a){this._map=a};v.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},v.prototype.mousemove=function(a){this._map.fire(new dF(a.type,this._map,a))},v.prototype.mousedown=function(){this._delayContextMenu=!0},v.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new dF("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},v.prototype.contextmenu=function(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new dF(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()},v.prototype.isEnabled=function(){return!0},v.prototype.isActive=function(){return!1},v.prototype.enable=function(){},v.prototype.disable=function(){};var q=function(a,b){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=b.clickTolerance||1};function dI(b,d){for(var c={},a=0;a<b.length;a++)c[b[a].identifier]=d[a];return c}q.prototype.isEnabled=function(){return!!this._enabled},q.prototype.isActive=function(){return!!this._active},q.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},q.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},q.prototype.mousedown=function(a,b){this.isEnabled()&&a.shiftKey&&0===a.button&&(m.disableDrag(),this._startPos=this._lastPos=b,this._active=!0)},q.prototype.mousemoveWindow=function(e,f){if(this._active){var a=f;if(!(this._lastPos.equals(a)|| !this._box&&a.dist(this._startPos)<this._clickTolerance)){var b=this._startPos;this._lastPos=a,this._box||(this._box=m.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var c=Math.min(b.x,a.x),g=Math.max(b.x,a.x),d=Math.min(b.y,a.y),h=Math.max(b.y,a.y);m.setTransform(this._box,"translate("+c+"px,"+d+"px)"),this._box.style.width=g-c+"px",this._box.style.height=h-d+"px"}}},q.prototype.mouseupWindow=function(b,e){var f=this;if(this._active&&0===b.button){var c=this._startPos,d=e;if(this.reset(),m.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:b})),{cameraAnimation:function(a){return a.fitScreenCoordinates(c,d,f._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",b)}},q.prototype.keydown=function(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))},q.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(m.remove(this._box),this._box=null),m.enableDrag(),delete this._startPos,delete this._lastPos},q.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,{originalEvent:c}))};var U=function(a){this.reset(),this.numTouches=a.numTouches};U.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},U.prototype.touchstart=function(d,c,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=d.timeStamp),b.length===this.numTouches&&(this.centroid=function(c){for(var d=new a.Point(0,0),b=0,e=c;b<e.length;b+=1){var f=e[b];d._add(f)}return d.div(c.length)}(c),this.touches=dI(b,c)))},U.prototype.touchmove=function(g,c,d){if(!this.aborted&&this.centroid){var e=dI(d,c);for(var a in this.touches){var f=this.touches[a],b=e[a];(!b||b.dist(f)>30)&&(this.aborted=!0)}}},U.prototype.touchend=function(b,d,c){if((!this.centroid||b.timeStamp-this.startTime>500)&&(this.aborted=!0),0===c.length){var a=!this.aborted&&this.centroid;if(this.reset(),a)return a}};var V=function(a){this.singleTap=new U(a),this.numTaps=a.numTaps,this.reset()};V.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},V.prototype.touchstart=function(a,b,c){this.singleTap.touchstart(a,b,c)},V.prototype.touchmove=function(a,b,c){this.singleTap.touchmove(a,b,c)},V.prototype.touchend=function(b,c,d){var a=this.singleTap.touchend(b,c,d);if(a){var e=b.timeStamp-this.lastTime<500,f=!this.lastTap||30>this.lastTap.dist(a);if(e&&f||this.reset(),this.count++,this.lastTime=b.timeStamp,this.lastTap=a,this.count===this.numTaps)return this.reset(),a}};var w=function(){this._zoomIn=new V({numTouches:1,numTaps:2}),this._zoomOut=new V({numTouches:2,numTaps:1}),this.reset()};w.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},w.prototype.touchstart=function(a,b,c){this._zoomIn.touchstart(a,b,c),this._zoomOut.touchstart(a,b,c)},w.prototype.touchmove=function(a,b,c){this._zoomIn.touchmove(a,b,c),this._zoomOut.touchmove(a,b,c)},w.prototype.touchend=function(a,b,c){var f=this,d=this._zoomIn.touchend(a,b,c),e=this._zoomOut.touchend(a,b,c);return d?(this._active=!0,a.preventDefault(),setTimeout(function(){return f.reset()},0),{cameraAnimation:function(b){return b.easeTo({duration:300,zoom:b.getZoom()+1,around:b.unproject(d)},{originalEvent:a})}}):e?(this._active=!0,a.preventDefault(),setTimeout(function(){return f.reset()},0),{cameraAnimation:function(b){return b.easeTo({duration:300,zoom:b.getZoom()-1,around:b.unproject(e)},{originalEvent:a})}}):void 0},w.prototype.touchcancel=function(){this.reset()},w.prototype.enable=function(){this._enabled=!0},w.prototype.disable=function(){this._enabled=!1,this.reset()},w.prototype.isEnabled=function(){return this._enabled},w.prototype.isActive=function(){return this._active};var l=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};l.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},l.prototype._correctButton=function(a,b){return!1},l.prototype._move=function(a,b){return{}},l.prototype.mousedown=function(a,c){if(!this._lastPoint){var b=m.mouseButton(a);this._correctButton(a,b)&&(this._lastPoint=c,this._eventButton=b)}},l.prototype.mousemoveWindow=function(c,a){var b=this._lastPoint;if(b&&(c.preventDefault(),!(!this._moved&&a.dist(b)<this._clickTolerance)))return this._moved=!0,this._lastPoint=a,this._move(b,a)},l.prototype.mouseupWindow=function(a){m.mouseButton(a)===this._eventButton&&(this._moved&&m.suppressClick(),this.reset())},l.prototype.enable=function(){this._enabled=!0},l.prototype.disable=function(){this._enabled=!1,this.reset()},l.prototype.isEnabled=function(){return this._enabled},l.prototype.isActive=function(){return this._active};var dJ=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.mousedown=function(a,c){b.prototype.mousedown.call(this,a,c),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(a,b){return 0===b&&!a.ctrlKey},a.prototype._move=function(b,a){return{around:a,panDelta:a.sub(b)}},a}(l),dK=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._correctButton=function(b,a){return 0===a&&b.ctrlKey||2===a},a.prototype._move=function(b,c){var a=(c.x-b.x)*.8;if(a)return this._active=!0,{bearingDelta:a}},a.prototype.contextmenu=function(a){a.preventDefault()},a}(l),dL=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype._correctButton=function(b,a){return 0===a&&b.ctrlKey||2===a},a.prototype._move=function(b,c){var a=-((c.y-b.y)*.5);if(a)return this._active=!0,{pitchDelta:a}},a.prototype.contextmenu=function(a){a.preventDefault()},a}(l),r=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};r.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)},r.prototype.touchstart=function(a,b,c){return this._calculateTransform(a,b,c)},r.prototype.touchmove=function(a,b,c){if(this._active)return a.preventDefault(),this._calculateTransform(a,b,c)},r.prototype.touchend=function(b,c,a){this._calculateTransform(b,c,a),this._active&&a.length<this._minTouches&&this.reset()},r.prototype.touchcancel=function(){this.reset()},r.prototype._calculateTransform=function(l,k,g){g.length>0&&(this._active=!0);var b=dI(g,k),h=new a.Point(0,0),d=new a.Point(0,0),c=0;for(var e in b){var f=b[e],i=this._touches[e];i&&(h._add(f),d._add(f.sub(i)),c++,b[e]=f)}if(this._touches=b,!(c<this._minTouches)&&d.mag()){var j=d.div(c);if(this._sum._add(j),!(this._sum.mag()<this._clickTolerance))return{around:h.div(c),panDelta:j}}},r.prototype.enable=function(){this._enabled=!0},r.prototype.disable=function(){this._enabled=!1,this.reset()},r.prototype.isEnabled=function(){return this._enabled},r.prototype.isActive=function(){return this._active};var i=function(){this.reset()};function dM(b,c,d){for(var a=0;a<b.length;a++)if(b[a].identifier===d)return c[a]}function dN(a,b){return Math.log(a/b)/Math.LN2}i.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},i.prototype._start=function(a){},i.prototype._move=function(a,b,c){return{}},i.prototype.touchstart=function(c,b,a){this._firstTwoTouches||a.length<2||(this._firstTwoTouches=[a[0].identifier,a[1].identifier],this._start([b[0],b[1]]))},i.prototype.touchmove=function(c,d,e){if(this._firstTwoTouches){c.preventDefault();var f=this._firstTwoTouches,g=f[0],h=f[1],a=dM(e,d,g),b=dM(e,d,h);if(a&&b){var i=this._aroundCenter?null:a.add(b).div(2);return this._move([a,b],i,c)}}},i.prototype.touchend=function(h,a,b){if(this._firstTwoTouches){var c=this._firstTwoTouches,d=c[0],e=c[1],f=dM(b,a,d),g=dM(b,a,e);f&&g||(this._active&&m.suppressClick(),this.reset())}},i.prototype.touchcancel=function(){this.reset()},i.prototype.enable=function(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around},i.prototype.disable=function(){this._enabled=!1,this.reset()},i.prototype.isEnabled=function(){return this._enabled},i.prototype.isActive=function(){return this._active};var dO=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.reset=function(){b.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(a){this._startDistance=this._distance=a[0].dist(a[1])},a.prototype._move=function(a,b){var c=this._distance;if(this._distance=a[0].dist(a[1]),!(!this._active&&.1>Math.abs(dN(this._distance,this._startDistance))))return this._active=!0,{zoomDelta:dN(this._distance,c),pinchAround:b}},a}(i);function dP(a,b){return 180*a.angleWith(b)/Math.PI}var dQ=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.reset=function(){b.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])},a.prototype._move=function(a,b){var c=this._vector;if(this._vector=a[0].sub(a[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:dP(this._vector,c),pinchAround:b}},a.prototype._isBelowThreshold=function(a){this._minDiameter=Math.min(this._minDiameter,a.mag());var b=Math.PI*this._minDiameter;return Math.abs(dP(a,this._startVector))<25/b*360},a}(i);function dR(a){return Math.abs(a.y)>Math.abs(a.x)}var dS=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a.prototype.reset=function(){b.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(a){this._lastPoints=a,dR(a[0].sub(a[1]))&&(this._valid=!1)},a.prototype._move=function(a,e,d){var b=a[0].sub(this._lastPoints[0]),c=a[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(b,c,d.timeStamp),this._valid)return this._lastPoints=a,this._active=!0,{pitchDelta:-0.5*((b.y+c.y)/2)}},a.prototype.gestureBeginsVertically=function(a,b,c){if(void 0!==this._valid)return this._valid;var d=a.mag()>=2,e=b.mag()>=2;if(d||e){if(!d||!e){if(void 0===this._firstMove&&(this._firstMove=c),c-this._firstMove<100)return;return!1}var f=a.y>0==b.y>0;return dR(a)&&dR(b)&&f}},a}(i),dT={panStep:100,bearingStep:15,pitchStep:10},E=function(){var a=dT;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep};function dU(a){return a*(2-a)}E.prototype.reset=function(){this._active=!1},E.prototype.keydown=function(a){var g=this;if(!a.altKey&&!a.ctrlKey&&!a.metaKey){var b=0,c=0,d=0,e=0,f=0;switch(a.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:a.shiftKey?c=-1:(a.preventDefault(),e=-1);break;case 39:a.shiftKey?c=1:(a.preventDefault(),e=1);break;case 38:a.shiftKey?d=1:(a.preventDefault(),f=-1);break;case 40:a.shiftKey?d=-1:(a.preventDefault(),f=1);break;default:return}return{cameraAnimation:function(h){var i=h.getZoom();h.easeTo({duration:300,easeId:"keyboardHandler",easing:dU,zoom:b?Math.round(i)+b*(a.shiftKey?2:1):i,bearing:h.getBearing()+c*g._bearingStep,pitch:h.getPitch()+d*g._pitchStep,offset:[-e*g._panStep,-f*g._panStep],center:h.getCenter()},{originalEvent:a})}}}},E.prototype.enable=function(){this._enabled=!0},E.prototype.disable=function(){this._enabled=!1,this.reset()},E.prototype.isEnabled=function(){return this._enabled},E.prototype.isActive=function(){return this._active};var dV=1/450,j=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=dV,a.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};j.prototype.setZoomRate=function(a){this._defaultZoomRate=a},j.prototype.setWheelZoomRate=function(a){this._wheelZoomRate=a},j.prototype.isEnabled=function(){return!!this._enabled},j.prototype.isActive=function(){return!!this._active|| void 0!==this._finishTimeout},j.prototype.isZooming=function(){return!!this._zooming},j.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},j.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},j.prototype.wheel=function(c){if(this.isEnabled()){var b=c.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,d=a.browser.now(),e=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,0!==b&&b%4.000244140625==0?this._type="wheel":0!==b&&4>Math.abs(b)?this._type="trackpad":e>400?(this._type=null,this._lastValue=b,this._timeout=setTimeout(this._onTimeout,40,c)):!this._type&&(this._type=200>Math.abs(e*b)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,b+=this._lastValue)),c.shiftKey&&b&&(b/=4),this._type&&(this._lastWheelEvent=c,this._delta-=b,this._active||this._start(c)),c.preventDefault()}},j.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)},j.prototype._start=function(b){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var c=m.mousePos(this._el,b);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(c)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},j.prototype.renderFrame=function(){return this._onScrollFrame()},j.prototype._onScrollFrame=function(){var e,m=this;if(this._frameId&&(this._frameId=null,this.isActive())){var b=this._map.transform;if(0!==this._delta){var j="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,c=2/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&0!==c&&(c=1/c);var k="number"==typeof this._targetZoom?b.zoomScale(this._targetZoom):b.scale;this._targetZoom=Math.min(b.maxZoom,Math.max(b.minZoom,b.scaleZoom(k*c))),"wheel"===this._type&&(this._startZoom=b.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var f="number"==typeof this._targetZoom?this._targetZoom:b.zoom,g=this._startZoom,h=this._easing,d=!1;if("wheel"===this._type&&g&&h){var i=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1),l=h(i);e=a.number(g,f,l),i<1?this._frameId||(this._frameId=!0):d=!0}else e=f,d=!0;return this._active=!0,d&&(this._active=!1,this._finishTimeout=setTimeout(function(){m._zooming=!1,m._handler._triggerRenderFrame(),delete m._targetZoom,delete m._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!d,zoomDelta:e-b.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},j.prototype._smoothOutEasing=function(g){var c=a.ease;if(this._prevEase){var b=this._prevEase,e=(a.browser.now()-b.start)/b.duration,f=b.easing(e+.01)-b.easing(e),d=.27/Math.sqrt(f*f+1e-4)*.01,h=Math.sqrt(.0729-d*d);c=a.bezier(d,h,.25,1)}return this._prevEase={start:a.browser.now(),duration:g,easing:c},c},j.prototype.reset=function(){this._active=!1};var W=function(a,b){this._clickZoom=a,this._tapZoom=b};W.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},W.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},W.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},W.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var F=function(){this.reset()};F.prototype.reset=function(){this._active=!1},F.prototype.dblclick=function(a,b){return a.preventDefault(),{cameraAnimation:function(c){c.easeTo({duration:300,zoom:c.getZoom()+(a.shiftKey?-1:1),around:c.unproject(b)},{originalEvent:a})}}},F.prototype.enable=function(){this._enabled=!0},F.prototype.disable=function(){this._enabled=!1,this.reset()},F.prototype.isEnabled=function(){return this._enabled},F.prototype.isActive=function(){return this._active};var x=function(){this._tap=new V({numTouches:1,numTaps:1}),this.reset()};x.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},x.prototype.touchstart=function(b,c,a){!this._swipePoint&&(this._tapTime&&b.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?a.length>0&&(this._swipePoint=c[0],this._swipeTouch=a[0].identifier):this._tap.touchstart(b,c,a))},x.prototype.touchmove=function(a,b,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;var d=b[0],e=d.y-this._swipePoint.y;return this._swipePoint=d,a.preventDefault(),this._active=!0,{zoomDelta:e/128}}}else this._tap.touchmove(a,b,c)},x.prototype.touchend=function(a,c,b){this._tapTime?this._swipePoint&&0===b.length&&this.reset():this._tap.touchend(a,c,b)&&(this._tapTime=a.timeStamp)},x.prototype.touchcancel=function(){this.reset()},x.prototype.enable=function(){this._enabled=!0},x.prototype.disable=function(){this._enabled=!1,this.reset()},x.prototype.isEnabled=function(){return this._enabled},x.prototype.isActive=function(){return this._active};var X=function(a,b,c){this._el=a,this._mousePan=b,this._touchPan=c};X.prototype.enable=function(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},X.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},X.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},X.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Y=function(a,b,c){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=b,this._mousePitch=c};Y.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Y.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Y.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Y.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var G=function(a,b,c,d){this._el=a,this._touchZoom=b,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0};G.prototype.enable=function(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},G.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},G.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},G.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},G.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},G.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var dW=function(a){return a.zoom||a.drag||a.pitch||a.rotate},dX=function(b){function a(){b.apply(this,arguments)}return b&&(a.__proto__=b),a.prototype=Object.create(b&&b.prototype),a.prototype.constructor=a,a}(a.Event);function dY(a){return a.panDelta&&a.panDelta.mag()||a.zoomDelta||a.bearingDelta||a.pitchDelta}var f=function(e,f){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new T(e),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),a.bindAll(["handleEvent","handleWindowEvent"],this);var b=this._el;this._listeners=[[b,"touchstart",{passive:!1}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[a.window,"blur",void 0]];for(var c=0,g=this._listeners;c<g.length;c+=1){var d=g[c],h=d[0],i=d[1],j=d[2];m.addEventListener(h,i,h===a.window.document?this.handleWindowEvent:this.handleEvent,j)}};f.prototype.destroy=function(){for(var b=0,d=this._listeners;b<d.length;b+=1){var c=d[b],e=c[0],f=c[1],g=c[2];m.removeEventListener(e,f,e===a.window.document?this.handleWindowEvent:this.handleEvent,g)}},f.prototype._addDefaultHandlers=function(b){var a=this._map,e=a.getCanvasContainer();this._add("mapEvent",new h(a,b));var t=a.boxZoom=new q(a,b);this._add("boxZoom",t);var f=new w,g=new F;a.doubleClickZoom=new W(g,f),this._add("tapZoom",f),this._add("clickZoom",g);var i=new x;this._add("tapDragZoom",i);var u=a.touchPitch=new dS;this._add("touchPitch",u);var k=new dK(b),l=new dL(b);a.dragRotate=new Y(b,k,l),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",l,["mouseRotate"]);var m=new dJ(b),n=new r(b);a.dragPan=new X(e,m,n),this._add("mousePan",m),this._add("touchPan",n,["touchZoom","touchRotate"]);var o=new dQ,p=new dO;a.touchZoomRotate=new G(e,p,o,i),this._add("touchRotate",o,["touchPan","touchZoom"]),this._add("touchZoom",p,["touchPan","touchRotate"]);var y=a.scrollZoom=new j(a,this);this._add("scrollZoom",y,["mousePan"]);var z=a.keyboard=new E;this._add("keyboard",z),this._add("blockableMapEvent",new v(a));for(var c=0,s=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];c<s.length;c+=1){var d=s[c];b.interactive&&b[d]&&a[d].enable(b[d])}},f.prototype._add=function(a,b,c){this._handlers.push({handlerName:a,handler:b,allowed:c}),this._handlersById[a]=b},f.prototype.stop=function(){if(!this._updatingCamera){for(var a=0,b=this._handlers;a<b.length;a+=1)b[a].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},f.prototype.isActive=function(){for(var a=0,b=this._handlers;a<b.length;a+=1)if(b[a].handler.isActive())return!0;return!1},f.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},f.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},f.prototype.isMoving=function(){return Boolean(dW(this._eventsInProgress))||this.isZooming()},f.prototype._blockedByActive=function(c,a,d){for(var b in c)if(b!==d&&(!a||0>a.indexOf(b)))return!0;return!1},f.prototype.handleWindowEvent=function(a){this.handleEvent(a,a.type+"Window")},f.prototype._getMapTouches=function(e){for(var b=[],a=0,c=e;a<c.length;a+=1){var d=c[a],f=d.target;this._el.contains(f)&&b.push(d)}return b},f.prototype.handleEvent=function(a,k){if("blur"===a.type){this.stop();return}this._updatingCamera=!0;for(var l="renderFrame"===a.type?void 0:a,c={needsRenderFrame:!1},n={},d={},f=a.touches?this._getMapTouches(a.touches):void 0,r=f?m.touchPos(this._el,f):m.mousePos(this._el,a),g=0,o=this._handlers;g<o.length;g+=1){var h=o[g],i=h.handlerName,b=h.handler,s=h.allowed;if(b.isEnabled()){var e=void 0;this._blockedByActive(d,s,i)?b.reset():b[k||a.type]&&(e=b[k||a.type](a,r,f),this.mergeHandlerResult(c,n,e,i,l),e&&e.needsRenderFrame&&this._triggerRenderFrame()),(e||b.isActive())&&(d[i]=b)}}var j={};for(var p in this._previousActiveHandlers)d[p]||(j[p]=l);this._previousActiveHandlers=d,(Object.keys(j).length||dY(c))&&(this._changes.push([c,n,j]),this._triggerRenderFrame()),(Object.keys(d).length||dY(c))&&this._map._stop(!0),this._updatingCamera=!1;var q=c.cameraAnimation;q&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],q(this._map))},f.prototype.mergeHandlerResult=function(e,c,b,f,g){if(b){a.extend(e,b);var d={handlerName:f,originalEvent:b.originalEvent||g};void 0!==b.zoomDelta&&(c.zoom=d),void 0!==b.panDelta&&(c.drag=d),void 0!==b.pitchDelta&&(c.pitch=d),void 0!==b.bearingDelta&&(c.rotate=d)}},f.prototype._applyChanges=function(){for(var c={},f={},g={},d=0,h=this._changes;d<h.length;d+=1){var e=h[d],b=e[0],i=e[1],j=e[2];b.panDelta&&(c.panDelta=(c.panDelta||new a.Point(0,0))._add(b.panDelta)),b.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+b.pitchDelta),void 0!==b.around&&(c.around=b.around),void 0!==b.pinchAround&&(c.pinchAround=b.pinchAround),b.noInertia&&(c.noInertia=b.noInertia),a.extend(f,i),a.extend(g,j)}this._updateMapTransform(c,f,g),this._changes=[]},f.prototype._updateMapTransform=function(a,e,f){var d=this._map,c=d.transform;if(!dY(a))return this._fireEvents(e,f);var g=a.panDelta,h=a.zoomDelta,i=a.bearingDelta,j=a.pitchDelta,b=a.around,k=a.pinchAround;void 0!==k&&(b=k),d._stop(!0),b=b||d.transform.centerPoint;var l=c.pointLocation(g?b.sub(g):b);i&&(c.bearing+=i),j&&(c.pitch+=j),h&&(c.zoom+=h),c.setLocationAtPoint(l,b),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(e,f)},f.prototype._fireEvents=function(b,q){var e,v=this,j=dW(this._eventsInProgress),c=dW(b),g={};for(var d in b){var r=b[d].originalEvent;this._eventsInProgress[d]||(g[d+"start"]=r),this._eventsInProgress[d]=b[d]}for(var k in!j&&c&&this._fireEvent("movestart",c.originalEvent),g)this._fireEvent(k,g[k]);for(var l in b.rotate&&(this._bearingChanged=!0),c&&this._fireEvent("move",c.originalEvent),b){var s=b[l].originalEvent;this._fireEvent(l,s)}var h={};for(var i in this._eventsInProgress){var m=this._eventsInProgress[i],n=m.handlerName,t=m.originalEvent;this._handlersById[n].isActive()||(delete this._eventsInProgress[i],e=q[n]||t,h[i+"end"]=e)}for(var o in h)this._fireEvent(o,h[o]);var u=dW(this._eventsInProgress);if((j||c)&&!u){this._updatingCamera=!0;var f=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),p=function(a){return 0!==a&& -v._bearingSnap<a&&a<v._bearingSnap};f?(p(f.bearing||this._map.getBearing())&&(f.bearing=0),this._map.easeTo(f,{originalEvent:e})):(this._map.fire(new a.Event("moveend",{originalEvent:e})),p(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},f.prototype._fireEvent=function(c,b){this._map.fire(new a.Event(c,b?{originalEvent:b}:{}))},f.prototype._triggerRenderFrame=function(){var a=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(b){delete a._frameId,a.handleEvent(new dX("renderFrame",{timeStamp:b})),a._applyChanges()}))};var a3=function(c){function b(b,d){c.call(this),this._moving=!1,this._zooming=!1,this.transform=b,this._bearingSnap=d.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},b.prototype.setCenter=function(a,b){return this.jumpTo({center:a},b)},b.prototype.panBy=function(b,c,d){return b=a.Point.convert(b).mult(-1),this.panTo(this.transform.center,a.extend({offset:b},c),d)},b.prototype.panTo=function(b,c,d){return this.easeTo(a.extend({center:b},c),d)},b.prototype.getZoom=function(){return this.transform.zoom},b.prototype.setZoom=function(a,b){return this.jumpTo({zoom:a},b),this},b.prototype.zoomTo=function(b,c,d){return this.easeTo(a.extend({zoom:b},c),d)},b.prototype.zoomIn=function(a,b){return this.zoomTo(this.getZoom()+1,a,b),this},b.prototype.zoomOut=function(a,b){return this.zoomTo(this.getZoom()-1,a,b),this},b.prototype.getBearing=function(){return this.transform.bearing},b.prototype.setBearing=function(a,b){return this.jumpTo({bearing:a},b),this},b.prototype.getPadding=function(){return this.transform.padding},b.prototype.setPadding=function(a,b){return this.jumpTo({padding:a},b),this},b.prototype.rotateTo=function(b,c,d){return this.easeTo(a.extend({bearing:b},c),d)},b.prototype.resetNorth=function(b,c){return this.rotateTo(0,a.extend({duration:1e3},b),c),this},b.prototype.resetNorthPitch=function(b,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},b),c),this},b.prototype.snapToNorth=function(a,b){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,b):this},b.prototype.getPitch=function(){return this.transform.pitch},b.prototype.setPitch=function(a,b){return this.jumpTo({pitch:a},b),this},b.prototype.cameraForBounds=function(b,c){return b=a.LngLatBounds.convert(b),this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),0,c)},b.prototype._cameraForBoxAndBearing=function(q,r,h,b){var i={top:0,bottom:0,right:0,left:0};if("number"==typeof(b=a.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},b)).padding){var d=b.padding;b.padding={top:d,bottom:d,right:d,left:d}}b.padding=a.extend(i,b.padding);var c=this.transform,e=c.padding,j=c.project(a.LngLat.convert(q)),k=c.project(a.LngLat.convert(r)),f=j.rotate(-h*Math.PI/180),g=k.rotate(-h*Math.PI/180),s=new a.Point(Math.max(f.x,g.x),Math.max(f.y,g.y)),t=new a.Point(Math.min(f.x,g.x),Math.min(f.y,g.y)),l=s.sub(t),m=(c.width-(e.left+e.right+b.padding.left+b.padding.right))/l.x,n=(c.height-(e.top+e.bottom+b.padding.top+b.padding.bottom))/l.y;if(n<0||m<0){a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var o=Math.min(c.scaleZoom(c.scale*Math.min(m,n)),b.maxZoom),p=a.Point.convert(b.offset),u=(b.padding.left-b.padding.right)/2,v=(b.padding.top-b.padding.bottom)/2,w=new a.Point(p.x+u,p.y+v),x=w.mult(c.scale/c.zoomScale(o)),y=c.unproject(j.add(k).div(2).sub(x));return{center:y,zoom:o,bearing:h}},b.prototype.fitBounds=function(b,a,c){return this._fitInternal(this.cameraForBounds(b,a),a,c)},b.prototype.fitScreenCoordinates=function(c,d,e,b,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(c)),this.transform.pointLocation(a.Point.convert(d)),e,b),b,f)},b.prototype._fitInternal=function(c,b,d){return c?(delete(b=a.extend(c,b)).padding,b.linear?this.easeTo(b,d):this.flyTo(b,d)):this},b.prototype.jumpTo=function(b,c){this.stop();var d=this.transform,e=!1,f=!1,g=!1;return"zoom"in b&&d.zoom!== +b.zoom&&(e=!0,d.zoom=+b.zoom),void 0!==b.center&&(d.center=a.LngLat.convert(b.center)),"bearing"in b&&d.bearing!== +b.bearing&&(f=!0,d.bearing=+b.bearing),"pitch"in b&&d.pitch!== +b.pitch&&(g=!0,d.pitch=+b.pitch),null==b.padding||d.isPaddingEqual(b.padding)||(d.padding=b.padding),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),e&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),f&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),g&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},b.prototype.easeTo=function(b,k){var f,l,t=this;this._stop(!1,b.easeId),(!1===(b=a.extend({offset:[0,0],duration:500,easing:a.ease},b)).animate|| !b.essential&&a.browser.prefersReducedMotion)&&(b.duration=0);var c=this.transform,d=this.getZoom(),e=this.getBearing(),g=this.getPitch(),u=this.getPadding(),h="zoom"in b?+b.zoom:d,m="bearing"in b?this._normalizeBearing(b.bearing,e):e,n="pitch"in b?+b.pitch:g,o="padding"in b?b.padding:c.padding,p=a.Point.convert(b.offset),q=c.centerPoint.add(p),i=c.pointLocation(q),j=a.LngLat.convert(b.center||i);this._normalizeCenter(j);var r=c.project(i),v=c.project(j).sub(r),w=c.zoomScale(h-d);b.around&&(f=a.LngLat.convert(b.around),l=c.locationPoint(f));var s={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||h!==d,this._rotating=this._rotating||e!==m,this._pitching=this._pitching||n!==g,this._padding=!c.isPaddingEqual(o),this._easeId=b.easeId,this._prepareEase(k,b.noMoveStart,s),clearTimeout(this._easeEndTimeoutID),this._ease(function(b){if(t._zooming&&(c.zoom=a.number(d,h,b)),t._rotating&&(c.bearing=a.number(e,m,b)),t._pitching&&(c.pitch=a.number(g,n,b)),t._padding&&(c.interpolatePadding(u,o,b),q=c.centerPoint.add(p)),f)c.setLocationAtPoint(f,l);else{var j=c.zoomScale(c.zoom-d),s=h>d?Math.min(2,w):Math.max(.5,w),x=Math.pow(s,1-b),i=c.unproject(r.add(v.mult(b*x)).mult(j));c.setLocationAtPoint(c.renderWorldCopies?i.wrap():i,q)}t._fireMoveEvents(k)},function(a){t._afterEase(k,a)},b),this},b.prototype._prepareEase=function(c,d,b){void 0===b&&(b={}),this._moving=!0,d||b.moving||this.fire(new a.Event("movestart",c)),this._zooming&&!b.zooming&&this.fire(new a.Event("zoomstart",c)),this._rotating&&!b.rotating&&this.fire(new a.Event("rotatestart",c)),this._pitching&&!b.pitching&&this.fire(new a.Event("pitchstart",c))},b.prototype._fireMoveEvents=function(b){this.fire(new a.Event("move",b)),this._zooming&&this.fire(new a.Event("zoom",b)),this._rotating&&this.fire(new a.Event("rotate",b)),this._pitching&&this.fire(new a.Event("pitch",b))},b.prototype._afterEase=function(b,c){if(!this._easeId||!c||this._easeId!==c){delete this._easeId;var d=this._zooming,e=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new a.Event("zoomend",b)),e&&this.fire(new a.Event("rotateend",b)),f&&this.fire(new a.Event("pitchend",b)),this.fire(new a.Event("moveend",b))}},b.prototype.flyTo=function(b,g){var F=this;if(!b.essential&&a.browser.prefersReducedMotion){var q=a.pick(b,["center","zoom","bearing","pitch","around"]);return this.jumpTo(q,g)}this.stop(),b=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},b);var c=this.transform,f=this.getZoom(),h=this.getBearing(),k=this.getPitch(),G=this.getPadding(),l="zoom"in b?a.clamp(+b.zoom,c.minZoom,c.maxZoom):f,r="bearing"in b?this._normalizeBearing(b.bearing,h):h,s="pitch"in b?+b.pitch:k,t="padding"in b?b.padding:c.padding,u=c.zoomScale(l-f),v=a.Point.convert(b.offset),w=c.centerPoint.add(v),m=c.pointLocation(w),n=a.LngLat.convert(b.center||m);this._normalizeCenter(n);var x=c.project(m),y=c.project(n).sub(x),d=b.curve,e=Math.max(c.width,c.height),i=e/u,o=y.mag();if("minZoom"in b){var z=a.clamp(Math.min(b.minZoom,f,l),c.minZoom,c.maxZoom),A=e/c.zoomScale(z-f);d=Math.sqrt(A/o*2)}var H=d*d;function p(b){var a=(i*i-e*e+(b?-1:1)*H*H*o*o)/(2*(b?i:e)*H*o);return Math.log(Math.sqrt(a*a+1)-a)}function I(a){return(Math.exp(a)-Math.exp(-a))/2}function J(a){return(Math.exp(a)+Math.exp(-a))/2}var B=p(0),C=function(a){return J(B)/J(B+d*a)},D=function(b){var a;return e*((J(B)*(I(a=B+d*b)/J(a))-I(B))/H)/o},j=(p(1)-B)/d;if(1e-6>Math.abs(o)||!isFinite(j)){if(1e-6>Math.abs(e-i))return this.easeTo(b,g);var K=i<e?-1:1;j=Math.abs(Math.log(i/e))/d,D=function(){return 0},C=function(a){return Math.exp(K*d*a)}}if("duration"in b)b.duration=+b.duration;else{var E="screenSpeed"in b?+b.screenSpeed/d:+b.speed;b.duration=1e3*j/E}return b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=h!==r,this._pitching=s!==k,this._padding=!c.isPaddingEqual(t),this._prepareEase(g,!1),this._ease(function(b){var d=b*j,e=1/C(d);c.zoom=1===b?l:f+c.scaleZoom(e),F._rotating&&(c.bearing=a.number(h,r,b)),F._pitching&&(c.pitch=a.number(k,s,b)),F._padding&&(c.interpolatePadding(G,t,b),w=c.centerPoint.add(v));var i=1===b?n:c.unproject(x.add(y.mult(D(d))).mult(e));c.setLocationAtPoint(c.renderWorldCopies?i.wrap():i,w),F._fireMoveEvents(g)},function(){return F._afterEase(g)},b),this},b.prototype.isEasing=function(){return!!this._easeFrameId},b.prototype.stop=function(){return this._stop()},b.prototype._stop=function(b,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,c)}if(!b){var a=this.handlers;a&&a.stop()}return this},b.prototype._ease=function(c,d,b){!1===b.animate||0===b.duration?(c(1),d()):(this._easeStart=a.browser.now(),this._easeOptions=b,this._onEaseFrame=c,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},b.prototype._renderFrameCallback=function(){var b=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},b.prototype._normalizeBearing=function(b,c){var d=Math.abs((b=a.wrap(b,-180,180))-c);return Math.abs(b-360-c)<d&&(b-=360),Math.abs(b+360-c)<d&&(b+=360),b},b.prototype._normalizeCenter=function(b){var a=this.transform;if(a.renderWorldCopies&&!a.lngRange){var c=b.lng-a.center.lng;b.lng+=c>180?-360:c< -180?360:0}},b}(a.Evented),y=function(b){void 0===b&&(b={}),this.options=b,a.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};y.prototype.getDefaultPosition=function(){return"bottom-right"},y.prototype.onAdd=function(b){var a=this.options&&this.options.compact;return this._map=b,this._container=m.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=m.create("div","mapboxgl-ctrl-attrib-inner",this._container),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===a&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},y.prototype.onRemove=function(){m.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},y.prototype._updateEditLink=function(){var b=this._editLink;b||(b=this._editLink=this._container.querySelector(".mapbox-improve-map"));var c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(b){var d=c.reduce(function(b,a,d){return a.value&&(b+=a.key+"="+a.value+(d<c.length-1?"&":"")),b},"?");b.href=a.config.FEEDBACK_URL+"/"+d+(this._map._hash?this._map._hash.getHashString(!0):""),b.rel="noopener nofollow"}},y.prototype._updateData=function(a){a&&("metadata"===a.sourceDataType||"style"===a.dataType)&&(this._updateAttributions(),this._updateEditLink())},y.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(a){return"string"!=typeof a?"":a})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}var e=this._map.style.sourceCaches;for(var g in e){var f=e[g];if(f.used){var b=f.getSource();b.attribution&&0>a.indexOf(b.attribution)&&a.push(b.attribution)}}a.sort(function(a,b){return a.length-b.length});var c=(a=a.filter(function(c,d){for(var b=d+1;b<a.length;b++)if(a[b].indexOf(c)>=0)return!1;return!0})).join(" | ");c!==this._attribHTML&&(this._attribHTML=c,a.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},y.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var H=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};H.prototype.onAdd=function(b){this._map=b,this._container=m.create("div","mapboxgl-ctrl");var a=m.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},H.prototype.onRemove=function(){m.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},H.prototype.getDefaultPosition=function(){return"bottom-left"},H.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},H.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var b in a)if(a[b].getSource().mapbox_logo)return!0;return!1}},H.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var b=a[0];this._map.getCanvasContainer().offsetWidth<250?b.classList.add("mapboxgl-compact"):b.classList.remove("mapboxgl-compact")}};var Z=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Z.prototype.add=function(b){var a=++this._id;return this._queue.push({callback:b,id:a,cancelled:!1}),a},Z.prototype.remove=function(e){for(var b=this._currentlyRunning,f=b?this._queue.concat(b):this._queue,a=0,c=f;a<c.length;a+=1){var d=c[a];if(d.id===e){d.cancelled=!0;return}}},Z.prototype.run=function(a){void 0===a&&(a=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var b=0,c=e;b<c.length;b+=1){var d=c[b];if(!d.cancelled&&(d.callback(a),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Z.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var dZ={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},d$=a.window.HTMLImageElement,d_=a.window.HTMLElement,d0=a.window.ImageBitmap,d1={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},a4=function(g){function b(b){var h=this;if(null!=(b=a.extend({},d1,b)).minZoom&&null!=b.maxZoom&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=b.minPitch&&null!=b.maxPitch&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=b.minPitch&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=b.maxPitch&&b.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var d=new c(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies);if(g.call(this,d,b),this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new Z,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},dZ,b.locale),this._requestManager=new a.RequestManager(b.transformRequest,b.accessToken),"string"==typeof b.container){if(this._container=a.window.document.getElementById(b.container),!this._container)throw new Error("Container '"+b.container+"' not found.")}else if(b.container instanceof d_)this._container=b.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(b.maxBounds&&this.setMaxBounds(b.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return h._update(!1)}),this.on("moveend",function(){return h._update(!1)}),this.on("zoom",function(){return h._update(!0)}),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new f(this,b);var e="string"==typeof b.hash&&b.hash||void 0;this._hash=b.hash&&new D(e).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,a.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new y({customAttribution:b.customAttribution})),this.addControl(new H,b.logoPosition),this.on("style.load",function(){h.transform.unmodified&&h.jumpTo(h.style.stylesheet)}),this.on("data",function(b){h._update("style"===b.dataType),h.fire(new a.Event(b.dataType+"data",b))}),this.on("dataloading",function(b){h.fire(new a.Event(b.dataType+"dataloading",b))})}g&&(b.__proto__=g),b.prototype=Object.create(g&&g.prototype),b.prototype.constructor=b;var d={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return b.prototype._getMapId=function(){return this._mapId},b.prototype.addControl=function(b,c){if(void 0===c&&b.getDefaultPosition&&(c=b.getDefaultPosition()),void 0===c&&(c="top-right"),!b||!b.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var e=b.onAdd(this);this._controls.push(b);var d=this._controlPositions[c];return -1!==c.indexOf("bottom")?d.insertBefore(e,d.firstChild):d.appendChild(e),this},b.prototype.removeControl=function(b){if(!b||!b.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var c=this._controls.indexOf(b);return c> -1&&this._controls.splice(c,1),b.onRemove(this),this},b.prototype.resize=function(b){var e=this._containerDimensions(),c=e[0],d=e[1];this._resizeCanvas(c,d),this.transform.resize(c,d),this.painter.resize(c,d);var f=!this._moving;return f&&(this.stop(),this.fire(new a.Event("movestart",b)).fire(new a.Event("move",b))),this.fire(new a.Event("resize",b)),f&&this.fire(new a.Event("moveend",b)),this},b.prototype.getBounds=function(){return this.transform.getBounds()},b.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},b.prototype.setMaxBounds=function(b){return this.transform.setMaxBounds(a.LngLatBounds.convert(b)),this._update()},b.prototype.setMinZoom=function(a){if((a=null==a?-2:a)>= -2&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},b.prototype.getMinZoom=function(){return this.transform.minZoom},b.prototype.setMaxZoom=function(a){if((a=null==a?22:a)>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw new Error("maxZoom must be greater than the current minZoom")},b.prototype.getMaxZoom=function(){return this.transform.maxZoom},b.prototype.setMinPitch=function(a){if((a=null==a?0:a)<0)throw new Error("minPitch must be greater than or equal to 0");if(a>=0&&a<=this.transform.maxPitch)return this.transform.minPitch=a,this._update(),this.getPitch()<a&&this.setPitch(a),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},b.prototype.getMinPitch=function(){return this.transform.minPitch},b.prototype.setMaxPitch=function(a){if((a=null==a?60:a)>60)throw new Error("maxPitch must be less than or equal to 60");if(a>=this.transform.minPitch)return this.transform.maxPitch=a,this._update(),this.getPitch()>a&&this.setPitch(a),this;throw new Error("maxPitch must be greater than the current minPitch")},b.prototype.getMaxPitch=function(){return this.transform.maxPitch},b.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},b.prototype.setRenderWorldCopies=function(a){return this.transform.renderWorldCopies=a,this._update()},b.prototype.project=function(b){return this.transform.locationPoint(a.LngLat.convert(b))},b.prototype.unproject=function(b){return this.transform.pointLocation(a.Point.convert(b))},b.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},b.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},b.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},b.prototype._createDelegatedListener=function(a,b,c){var d,e=this;if("mouseenter"===a||"mouseover"===a){var f=!1;return{layer:b,listener:c,delegates:{mousemove:function(d){var g=e.getLayer(b)?e.queryRenderedFeatures(d.point,{layers:[b]}):[];g.length?f||(f=!0,c.call(e,new dF(a,e,d.originalEvent,{features:g}))):f=!1},mouseout:function(){f=!1}}}}if("mouseleave"===a||"mouseout"===a){var g=!1;return{layer:b,listener:c,delegates:{mousemove:function(d){(e.getLayer(b)?e.queryRenderedFeatures(d.point,{layers:[b]}):[]).length?g=!0:g&&(g=!1,c.call(e,new dF(a,e,d.originalEvent)))},mouseout:function(b){g&&(g=!1,c.call(e,new dF(a,e,b.originalEvent)))}}}}return{layer:b,listener:c,delegates:((d={})[a]=function(a){var d=e.getLayer(b)?e.queryRenderedFeatures(a.point,{layers:[b]}):[];d.length&&(a.features=d,c.call(e,a),delete a.features)},d)}},b.prototype.on=function(a,c,d){if(void 0===d)return g.prototype.on.call(this,a,c);var b=this._createDelegatedListener(a,c,d);for(var e in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[a]=this._delegatedListeners[a]||[],this._delegatedListeners[a].push(b),b.delegates)this.on(e,b.delegates[e]);return this},b.prototype.once=function(a,b,c){if(void 0===c)return g.prototype.once.call(this,a,b);var d=this._createDelegatedListener(a,b,c);for(var e in d.delegates)this.once(e,d.delegates[e]);return this},b.prototype.off=function(a,b,c){var d=this;return void 0===c?g.prototype.off.call(this,a,b):(this._delegatedListeners&&this._delegatedListeners[a]&&function(i){for(var g=i[a],e=0;e<g.length;e++){var f=g[e];if(f.layer===b&&f.listener===c){for(var h in f.delegates)d.off(h,f.delegates[h]);return g.splice(e,1),d}}}(this._delegatedListeners),this)},b.prototype.queryRenderedFeatures=function(b,c){if(!this.style)return[];if(void 0!==c|| void 0===b||b instanceof a.Point||Array.isArray(b)||(c=b,b=void 0),c=c||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||"number"==typeof b[0])f=[a.Point.convert(b)];else{var f,d=a.Point.convert(b[0]),e=a.Point.convert(b[1]);f=[d,new a.Point(e.x,d.y),e,new a.Point(d.x,e.y),d]}return this.style.queryRenderedFeatures(f,c,this.transform)},b.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,b)},b.prototype.setStyle=function(c,b){return!1!==(b=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},b)).diff&&b.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&c?(this._diffStyle(c,b),this):(this._localIdeographFontFamily=b.localIdeographFontFamily,this._updateStyle(c,b))},b.prototype._getUIString=function(a){var b=this._locale[a];if(null==b)throw new Error("Missing UI string '"+a+"'");return b},b.prototype._updateStyle=function(a,b){return(this.style&&(this.style.setEventedParent(null),this.style._remove()),a)?(this.style=new Q(this,b||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof a?this.style.loadURL(a):this.style.loadJSON(a),this):(delete this.style,this)},b.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Q(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},b.prototype._diffStyle=function(b,c){var f=this;if("string"==typeof b){var d=this._requestManager.normalizeStyleURL(b),e=this._requestManager.transformRequest(d,a.ResourceType.Style);a.getJSON(e,function(b,d){b?f.fire(new a.ErrorEvent(b)):d&&f._updateDiff(d,c)})}else"object"==typeof b&&this._updateDiff(b,c)},b.prototype._updateDiff=function(c,d){try{this.style.setState(c)&&this._update(!0)}catch(b){a.warnOnce("Unable to perform style diff: "+(b.message||b.error||b)+".  Rebuilding the style from scratch."),this._updateStyle(c,d)}},b.prototype.getStyle=function(){if(this.style)return this.style.serialize()},b.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},b.prototype.addSource=function(a,b){return this._lazyInitEmptyStyle(),this.style.addSource(a,b),this._update(!0)},b.prototype.isSourceLoaded=function(b){var c=this.style&&this.style.sourceCaches[b];if(void 0===c){this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+b+"'")));return}return c.loaded()},b.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var d in a){var b=a[d]._tiles;for(var e in b){var c=b[e];if(!("loaded"===c.state||"errored"===c.state))return!1}}return!0},b.prototype.addSourceType=function(a,b,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(a,b,c)},b.prototype.removeSource=function(a){return this.style.removeSource(a),this._update(!0)},b.prototype.getSource=function(a){return this.style.getSource(a)},b.prototype.addImage=function(f,b,c){void 0===c&&(c={});var d=c.pixelRatio;void 0===d&&(d=1);var e=c.sdf;void 0===e&&(e=!1);var i=c.stretchX,j=c.stretchY,k=c.content;if(this._lazyInitEmptyStyle(),b instanceof d$||d0&&b instanceof d0){var g=a.browser.getImageData(b),l=g.width,m=g.height,n=g.data;this.style.addImage(f,{data:new a.RGBAImage({width:l,height:m},n),pixelRatio:d,stretchX:i,stretchY:j,content:k,sdf:e,version:0})}else{if(void 0===b.width|| void 0===b.height)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var o=b.width,p=b.height,q=b.data,h=b;this.style.addImage(f,{data:new a.RGBAImage({width:o,height:p},new Uint8Array(q)),pixelRatio:d,stretchX:i,stretchY:j,content:k,sdf:e,version:0,userImage:h}),h.onAdd&&h.onAdd(this,f)}},b.prototype.updateImage=function(e,b){var c=this.style.getImage(e);if(!c)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var d=b instanceof d$||d0&&b instanceof d0?a.browser.getImageData(b):b,f=d.width,g=d.height,h=d.data;return void 0===f|| void 0===g?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):f!==c.data.width||g!==c.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):void(c.data.replace(h,!(b instanceof d$||d0&&b instanceof d0)),this.style.updateImage(e,c))},b.prototype.hasImage=function(b){return b?!!this.style.getImage(b):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},b.prototype.removeImage=function(a){this.style.removeImage(a)},b.prototype.loadImage=function(b,c){a.getImage(this._requestManager.transformRequest(b,a.ResourceType.Image),c)},b.prototype.listImages=function(){return this.style.listImages()},b.prototype.addLayer=function(a,b){return this._lazyInitEmptyStyle(),this.style.addLayer(a,b),this._update(!0)},b.prototype.moveLayer=function(a,b){return this.style.moveLayer(a,b),this._update(!0)},b.prototype.removeLayer=function(a){return this.style.removeLayer(a),this._update(!0)},b.prototype.getLayer=function(a){return this.style.getLayer(a)},b.prototype.setLayerZoomRange=function(a,b,c){return this.style.setLayerZoomRange(a,b,c),this._update(!0)},b.prototype.setFilter=function(b,c,a){return void 0===a&&(a={}),this.style.setFilter(b,c,a),this._update(!0)},b.prototype.getFilter=function(a){return this.style.getFilter(a)},b.prototype.setPaintProperty=function(b,c,d,a){return void 0===a&&(a={}),this.style.setPaintProperty(b,c,d,a),this._update(!0)},b.prototype.getPaintProperty=function(a,b){return this.style.getPaintProperty(a,b)},b.prototype.setLayoutProperty=function(b,c,d,a){return void 0===a&&(a={}),this.style.setLayoutProperty(b,c,d,a),this._update(!0)},b.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,b)},b.prototype.setLight=function(b,a){return void 0===a&&(a={}),this._lazyInitEmptyStyle(),this.style.setLight(b,a),this._update(!0)},b.prototype.getLight=function(){return this.style.getLight()},b.prototype.setFeatureState=function(a,b){return this.style.setFeatureState(a,b),this._update()},b.prototype.removeFeatureState=function(a,b){return this.style.removeFeatureState(a,b),this._update()},b.prototype.getFeatureState=function(a){return this.style.getFeatureState(a)},b.prototype.getContainer=function(){return this._container},b.prototype.getCanvasContainer=function(){return this._canvasContainer},b.prototype.getCanvas=function(){return this._canvas},b.prototype._containerDimensions=function(){var a=0,b=0;return this._container&&(a=this._container.clientWidth||400,b=this._container.clientHeight||300),[a,b]},b.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},b.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map"),(this._missingCSSCanary=m.create("div","mapboxgl-canary",a)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=m.create("div","mapboxgl-canvas-container",a);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=m.create("canvas","mapboxgl-canvas",b),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var c=this._containerDimensions();this._resizeCanvas(c[0],c[1]);var d=this._controlContainer=m.create("div","mapboxgl-control-container",a),e=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){e[a]=m.create("div","mapboxgl-ctrl-"+a,d)})},b.prototype._resizeCanvas=function(b,c){var d=a.browser.devicePixelRatio||1;this._canvas.width=d*b,this._canvas.height=d*c,this._canvas.style.width=b+"px",this._canvas.style.height=c+"px"},b.prototype._setupPainter=function(){var c=a.extend({},ap.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),b=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);if(!b){this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new e(b,this.transform),a.webpSupported.testSupport(b)},b.prototype._contextLost=function(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:b}))},b.prototype._contextRestored=function(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:b}))},b.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},b.prototype._update=function(a){return this.style&&(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this.triggerRepaint()),this},b.prototype._requestRenderFrame=function(a){return this._update(),this._renderTaskQueue.add(a)},b.prototype._cancelRenderFrame=function(a){this._renderTaskQueue.remove(a)},b.prototype._render=function(j){var c,k=this,e=0,b=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=b.createQueryEXT(),b.beginQueryEXT(b.TIME_ELAPSED_EXT,c),e=a.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(j),!this._removed){var f=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var g=this.transform.zoom,h=a.browser.now();this.style.zoomHistory.update(g,h);var i=new a.EvaluationParameters(g,{now:h,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),d=i.crossFadingFactor();(1!==d||d!==this._crossFadingFactor)&&(f=!0,this._crossFadingFactor=d),this.style.update(i)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||f)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var l=a.browser.now()-e;b.endQueryEXT(b.TIME_ELAPSED_EXT,c),setTimeout(function(){var d=b.getQueryObjectEXT(c,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(c),k.fire(new a.Event("gpu-timing-frame",{cpuTime:l,gpuTime:d}))},50)}if(this.listens("gpu-timing-layer")){var m=this.painter.collectGpuTimers();setTimeout(function(){var b=k.painter.queryGpuTimers(m);k.fire(new a.Event("gpu-timing-layer",{layerTimes:b}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new a.Event("idle"))),this}},b.prototype.remove=function(){this._hash&&this._hash.remove();for(var b=0,c=this._controls;b<c.length;b+=1)c[b].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));var d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),d2(this._canvasContainer),d2(this._controlContainer),d2(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new a.Event("remove"))},b.prototype.triggerRepaint=function(){var b=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(a){b._frame=null,b._render(a)}))},b.prototype._onWindowOnline=function(){this._update()},b.prototype._onWindowResize=function(a){this._trackResize&&this.resize({originalEvent:a})._update()},d.showTileBoundaries.get=function(){return!!this._showTileBoundaries},d.showTileBoundaries.set=function(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())},d.showPadding.get=function(){return!!this._showPadding},d.showPadding.set=function(a){this._showPadding!==a&&(this._showPadding=a,this._update())},d.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},d.showCollisionBoxes.set=function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,a?this.style._generateCollisionBoxes():this._update())},d.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},d.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())},d.repaint.get=function(){return!!this._repaint},d.repaint.set=function(a){this._repaint!==a&&(this._repaint=a,this.triggerRepaint())},d.vertices.get=function(){return!!this._vertices},d.vertices.set=function(a){this._vertices=a,this._update()},b.prototype._setCacheLimits=function(b,c){a.setCacheLimits(b,c)},d.version.get=function(){return a.version},Object.defineProperties(b.prototype,d),b}(a3);function d2(a){a.parentNode&&a.parentNode.removeChild(a)}var d3={showCompass:!0,showZoom:!0,visualizePitch:!1},A=function(b){var c=this;this.options=a.extend({},d3,b),this._container=m.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(a){return c._map.zoomIn({},{originalEvent:a})}),m.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(a){return c._map.zoomOut({},{originalEvent:a})}),m.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(a){c.options.visualizePitch?c._map.resetNorthPitch({},{originalEvent:a}):c._map.resetNorth({},{originalEvent:a})}),this._compassIcon=m.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};A.prototype._updateZoomButtons=function(){var a=this._map.getZoom();this._zoomInButton.disabled=a===this._map.getMaxZoom(),this._zoomOutButton.disabled=a===this._map.getMinZoom()},A.prototype._rotateCompassArrow=function(){var a=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=a},A.prototype.onAdd=function(a){return this._map=a,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new o(this._map,this._compass,this.options.visualizePitch)),this._container},A.prototype.onRemove=function(){m.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},A.prototype._createButton=function(b,c){var a=m.create("button",b,this._container);return a.type="button",a.addEventListener("click",c),a},A.prototype._setButtonTitle=function(a,c){var b=this._map._getUIString("NavigationControl."+c);a.title=b,a.setAttribute("aria-label",b)};var o=function(c,b,d){void 0===d&&(d=!1),this._clickTolerance=10,this.element=b,this.mouseRotate=new dK({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,d&&(this.mousePitch=new dL({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener(b,"mousedown",this.mousedown),m.addEventListener(b,"touchstart",this.touchstart,{passive:!1}),m.addEventListener(b,"touchmove",this.touchmove),m.addEventListener(b,"touchend",this.touchend),m.addEventListener(b,"touchcancel",this.reset)};function d4(b,d,c){if(b=new a.LngLat(b.lng,b.lat),d){var f=new a.LngLat(b.lng-360,b.lat),g=new a.LngLat(b.lng+360,b.lat),h=c.locationPoint(b).distSqr(d);c.locationPoint(f).distSqr(d)<h?b=f:c.locationPoint(g).distSqr(d)<h&&(b=g)}for(;Math.abs(b.lng-c.center.lng)>180;){var e=c.locationPoint(b);if(e.x>=0&&e.y>=0&&e.x<=c.width&&e.y<=c.height)break;b.lng>c.center.lng?b.lng-=360:b.lng+=360}return b}o.prototype.down=function(a,b){this.mouseRotate.mousedown(a,b),this.mousePitch&&this.mousePitch.mousedown(a,b),m.disableDrag()},o.prototype.move=function(d,e){var a=this.map,b=this.mouseRotate.mousemoveWindow(d,e);if(b&&b.bearingDelta&&a.setBearing(a.getBearing()+b.bearingDelta),this.mousePitch){var c=this.mousePitch.mousemoveWindow(d,e);c&&c.pitchDelta&&a.setPitch(a.getPitch()+c.pitchDelta)}},o.prototype.off=function(){var a=this.element;m.removeEventListener(a,"mousedown",this.mousedown),m.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),m.removeEventListener(a,"touchmove",this.touchmove),m.removeEventListener(a,"touchend",this.touchend),m.removeEventListener(a,"touchcancel",this.reset),this.offTemp()},o.prototype.offTemp=function(){m.enableDrag(),m.removeEventListener(a.window,"mousemove",this.mousemove),m.removeEventListener(a.window,"mouseup",this.mouseup)},o.prototype.mousedown=function(b){this.down(a.extend({},b,{ctrlKey:!0,preventDefault:function(){return b.preventDefault()}}),m.mousePos(this.element,b)),m.addEventListener(a.window,"mousemove",this.mousemove),m.addEventListener(a.window,"mouseup",this.mouseup)},o.prototype.mousemove=function(a){this.move(a,m.mousePos(this.element,a))},o.prototype.mouseup=function(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()},o.prototype.touchstart=function(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=m.touchPos(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return a.preventDefault()}},this._startPos))},o.prototype.touchmove=function(a){1!==a.targetTouches.length?this.reset():(this._lastPos=m.touchPos(this.element,a.targetTouches)[0],this.move({preventDefault:function(){return a.preventDefault()}},this._lastPos))},o.prototype.touchend=function(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},o.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var d5={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function d6(c,d,a){var b=c.classList;for(var e in d5)b.remove("mapboxgl-"+a+"-anchor-"+e);b.add("mapboxgl-"+a+"-anchor-"+d)}var a5=function(c){function b(b,q){var w=this;if(c.call(this),(b instanceof a.window.HTMLElement||q)&&(b=a.extend({element:b},q)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=b&&b.anchor||"center",this._color=b&&b.color||"#3FB1CE",this._draggable=b&&b.draggable||!1,this._state="inactive",this._rotation=b&&b.rotation||0,this._rotationAlignment=b&&b.rotationAlignment||"auto",this._pitchAlignment=b&&b.pitchAlignment&&"auto"!==b.pitchAlignment?b.pitchAlignment:this._rotationAlignment,b&&b.element)this._element=b.element,this._offset=a.Point.convert(b&&b.offset||[0,0]);else{this._defaultMarker=!0,this._element=m.create("div"),this._element.setAttribute("aria-label","Map marker");var e=m.createNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"display","block"),e.setAttributeNS(null,"height","41px"),e.setAttributeNS(null,"width","27px"),e.setAttributeNS(null,"viewBox","0 0 27 41");var i=m.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"stroke","none"),i.setAttributeNS(null,"stroke-width","1"),i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"fill-rule","evenodd");var d=m.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"fill-rule","nonzero");var j=m.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(3.0, 29.0)"),j.setAttributeNS(null,"fill","#000000");for(var v=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],n=0,r=v;n<r.length;n+=1){var s=r[n],f=m.createNS("http://www.w3.org/2000/svg","ellipse");f.setAttributeNS(null,"opacity","0.04"),f.setAttributeNS(null,"cx","10.5"),f.setAttributeNS(null,"cy","5.80029008"),f.setAttributeNS(null,"rx",s.rx),f.setAttributeNS(null,"ry",s.ry),j.appendChild(f)}var o=m.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill",this._color);var t=m.createNS("http://www.w3.org/2000/svg","path");t.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),o.appendChild(t);var k=m.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"opacity","0.25"),k.setAttributeNS(null,"fill","#000000");var u=m.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),k.appendChild(u);var p=m.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(6.0, 7.0)"),p.setAttributeNS(null,"fill","#FFFFFF");var l=m.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=m.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var h=m.createNS("http://www.w3.org/2000/svg","circle");h.setAttributeNS(null,"fill","#FFFFFF"),h.setAttributeNS(null,"cx","5.5"),h.setAttributeNS(null,"cy","5.5"),h.setAttributeNS(null,"r","5.4999962"),l.appendChild(g),l.appendChild(h),d.appendChild(j),d.appendChild(o),d.appendChild(k),d.appendChild(p),d.appendChild(l),e.appendChild(d),this._element.appendChild(e),this._offset=a.Point.convert(b&&b.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(a){a.preventDefault()}),this._element.addEventListener("mousedown",function(a){a.preventDefault()}),this._element.addEventListener("focus",function(){var a=w._map.getContainer();a.scrollTop=0,a.scrollLeft=0}),d6(this._element,this._anchor,"marker"),this._popup=null}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},b.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),m.remove(this._element),this._popup&&this._popup.remove(),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},b.prototype.getElement=function(){return this._element},b.prototype.setPopup=function(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){var b=38.1,a=13.5,d=Math.sqrt(Math.pow(a,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-b],"bottom-left":[d,-((b-a+d)*1)],"bottom-right":[-d,-((b-a+d)*1)],left:[a,-((b-a)*1)],right:[-a,-((b-a)*1)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},b.prototype._onKeyPress=function(a){var b=a.code,c=a.charCode||a.keyCode;("Space"===b||"Enter"===b||32===c||13===c)&&this.togglePopup()},b.prototype._onMapClick=function(c){var a=c.originalEvent.target,b=this._element;this._popup&&(a===b||b.contains(a))&&this.togglePopup()},b.prototype.getPopup=function(){return this._popup},b.prototype.togglePopup=function(){var a=this._popup;return a&&(a.isOpen()?a.remove():a.addTo(this._map)),this},b.prototype._update=function(c){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=d4(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var a="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?a="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(a="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var b="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?b="rotateX(0deg)":"map"===this._pitchAlignment&&(b="rotateX("+this._map.getPitch()+"deg)"),c&&"moveend"!==c.type||(this._pos=this._pos.round()),m.setTransform(this._element,d5[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+b+" "+a)}},b.prototype.getOffset=function(){return this._offset},b.prototype.setOffset=function(b){return this._offset=a.Point.convert(b),this._update(),this},b.prototype._onMove=function(b){this._pos=b.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))},b.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"},b.prototype._addDragHandler=function(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},b.prototype.setDraggable=function(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},b.prototype.isDraggable=function(){return this._draggable},b.prototype.setRotation=function(a){return this._rotation=a||0,this._update(),this},b.prototype.getRotation=function(){return this._rotation},b.prototype.setRotationAlignment=function(a){return this._rotationAlignment=a||"auto",this._update(),this},b.prototype.getRotationAlignment=function(){return this._rotationAlignment},b.prototype.setPitchAlignment=function(a){return this._pitchAlignment=a&&"auto"!==a?a:this._rotationAlignment,this._update(),this},b.prototype.getPitchAlignment=function(){return this._pitchAlignment},b}(a.Evented),d7={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},d8=0,d9=!1,a6=function(c){function b(b){c.call(this),this.options=a.extend({},d7,b),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.onAdd=function(c){var b;return this._map=c,this._container=m.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),b=this._setupUI,void 0!==bc?b(bc):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(function(a){b(bc="denied"!==a.state)}):b(bc=!!a.window.navigator.geolocation),this._container},b.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),m.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,d8=0,d9=!1},b.prototype._isOutOfMapMaxBounds=function(c){var a=this._map.getMaxBounds(),b=c.coords;return a&&(b.longitude<a.getWest()||b.longitude>a.getEast()||b.latitude<a.getSouth()||b.latitude>a.getNorth())},b.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},b.prototype._onSuccess=function(b){if(this._map){if(this._isOutOfMapMaxBounds(b)){this._setErrorState(),this.fire(new a.Event("outofmaxbounds",b)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(b),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",b)),this._finish()}},b.prototype._updateCamera=function(b){var c=new a.LngLat(b.coords.longitude,b.coords.latitude),d=b.coords.accuracy,e=this._map.getBearing(),f=a.extend({bearing:e},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(d),f,{geolocateSource:!0})},b.prototype._updateMarker=function(b){if(b){var c=new a.LngLat(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},b.prototype._updateCircleRadius=function(){var a=this._map._container.clientHeight/2,c=this._map.unproject([0,a]),d=this._map.unproject([1,a]),e=c.distanceTo(d),b=Math.ceil(2*this._accuracy/e);this._circleElement.style.width=b+"px",this._circleElement.style.height=b+"px"},b.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},b.prototype._onError=function(b){if(this._map){if(this.options.trackUserLocation)if(1===b.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===b.code&&d9)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",b)),this._finish()}},b.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},b.prototype._setupUI=function(d){var e=this;if(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=m.create("button","mapboxgl-ctrl-geolocate",this._container),m.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===d){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}else{var c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=m.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new a5(this._dotElement),this._circleElement=m.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new a5({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(b){var c=b.originalEvent&&"resize"===b.originalEvent.type;b.geolocateSource||"ACTIVE_LOCK"!==e._watchState||c||(e._watchState="BACKGROUND",e._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),e._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),e.fire(new a.Event("trackuserlocationend")))})},b.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":d8--,d9=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if("OFF"===this._watchState&& void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),d8++,d8>1?(b={maximumAge:6e5,timeout:0},d9=!0):(b=this.options.positionOptions,d9=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},b.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},b}(a.Evented),ea={maxWidth:100,unit:"metric"},I=function(b){this.options=a.extend({},ea,b),a.bindAll(["_onMove","setUnit"],this)};function eb(a,d,b){var c=b&&b.maxWidth||100,g=a._container.clientHeight/2,h=a.unproject([0,g]),i=a.unproject([c,g]),e=h.distanceTo(i);if(b&&"imperial"===b.unit){var f=3.2808*e;f>5280?ec(d,c,f/5280,a._getUIString("ScaleControl.Miles")):ec(d,c,f,a._getUIString("ScaleControl.Feet"))}else b&&"nautical"===b.unit?ec(d,c,e/1852,a._getUIString("ScaleControl.NauticalMiles")):e>=1e3?ec(d,c,e/1e3,a._getUIString("ScaleControl.Kilometers")):ec(d,c,e,a._getUIString("ScaleControl.Meters"))}function ec(a,d,b,e){var c=ed(b);a.style.width=d*(c/b)+"px",a.innerHTML=c+"&nbsp;"+e}function ed(c){var d,b,e=Math.pow(10,(""+Math.floor(c)).length-1),a=c/e;return e*(a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:a>=1?1:(b=Math.pow(10,Math.ceil(-Math.log(d=a)/Math.LN10)),Math.round(d*b)/b))}I.prototype.getDefaultPosition=function(){return"bottom-left"},I.prototype._onMove=function(){eb(this._map,this._container,this.options)},I.prototype.onAdd=function(a){return this._map=a,this._container=m.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},I.prototype.onRemove=function(){m.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},I.prototype.setUnit=function(a){this.options.unit=a,eb(this._map,this._container,this.options)};var s=function(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof a.window.HTMLElement?this._container=b.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange")};s.prototype.onAdd=function(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=m.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},s.prototype.onRemove=function(){m.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},s.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},s.prototype._setupUI=function(){var b=this._fullscreenButton=m.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);m.create("span","mapboxgl-ctrl-icon",b).setAttribute("aria-hidden",!0),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},s.prototype._updateTitle=function(){var a=this._getTitle();this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.title=a},s.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},s.prototype._isFullscreen=function(){return this._fullscreen},s.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},s.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var ee={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},a7=function(c){function b(b){c.call(this),this.options=a.extend(Object.create(ee),b),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return c&&(b.__proto__=c),b.prototype=Object.create(c&&c.prototype),b.prototype.constructor=b,b.prototype.addTo=function(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},b.prototype.isOpen=function(){return!!this._map},b.prototype.remove=function(){return this._content&&m.remove(this._content),this._container&&(m.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this},b.prototype.getLngLat=function(){return this._lngLat},b.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},b.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},b.prototype.getElement=function(){return this._container},b.prototype.setText=function(b){return this.setDOMContent(a.window.document.createTextNode(b))},b.prototype.setHTML=function(e){var b,c=a.window.document.createDocumentFragment(),d=a.window.document.createElement("body");for(d.innerHTML=e;b=d.firstChild;)c.appendChild(b);return this.setDOMContent(c)},b.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},b.prototype.setMaxWidth=function(a){return this.options.maxWidth=a,this._update(),this},b.prototype.setDOMContent=function(a){return this._createContent(),this._content.appendChild(a),this._update(),this},b.prototype.addClassName=function(a){this._container&&this._container.classList.add(a)},b.prototype.removeClassName=function(a){this._container&&this._container.classList.remove(a)},b.prototype.toggleClassName=function(a){if(this._container)return this._container.classList.toggle(a)},b.prototype._createContent=function(){this._content&&m.remove(this._content),this._content=m.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=m.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},b.prototype._onMouseUp=function(a){this._update(a.point)},b.prototype._onMouseMove=function(a){this._update(a.point)},b.prototype._onDrag=function(a){this._update(a.point)},b.prototype._update=function(d){var j=this,i=this._lngLat||this._trackPointer;if(this._map&&i&&this._content&&(!this._container&&(this._container=m.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=m.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(a){return j._container.classList.add(a)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=d4(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||d)){var a=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat),b=this.options.anchor,e=ef(this.options.offset);if(!b){var c,f=this._container.offsetWidth,g=this._container.offsetHeight;c=a.y+e.bottom.y<g?["top"]:a.y>this._map.transform.height-g?["bottom"]:[],a.x<f/2?c.push("left"):a.x>this._map.transform.width-f/2&&c.push("right"),b=0===c.length?"bottom":c.join("-")}var h=a.add(e[b]).round();m.setTransform(this._container,d5[b]+" translate("+h.x+"px,"+h.y+"px)"),d6(this._container,b,"popup")}},b.prototype._onClose=function(){this.remove()},b}(a.Evented);function ef(b){if(!b)return ef(new a.Point(0,0));if("number"==typeof b){var d=Math.round(Math.sqrt(.5*Math.pow(b,2)));return{center:new a.Point(0,0),top:new a.Point(0,b),"top-left":new a.Point(d,d),"top-right":new a.Point(-d,d),bottom:new a.Point(0,-b),"bottom-left":new a.Point(d,-d),"bottom-right":new a.Point(-d,-d),left:new a.Point(b,0),right:new a.Point(-b,0)}}if(!(b instanceof a.Point||Array.isArray(b)))return{center:a.Point.convert(b.center||[0,0]),top:a.Point.convert(b.top||[0,0]),"top-left":a.Point.convert(b["top-left"]||[0,0]),"top-right":a.Point.convert(b["top-right"]||[0,0]),bottom:a.Point.convert(b.bottom||[0,0]),"bottom-left":a.Point.convert(b["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(b["bottom-right"]||[0,0]),left:a.Point.convert(b.left||[0,0]),right:a.Point.convert(b.right||[0,0])};var c=a.Point.convert(b);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}var a8={version:a.version,supported:ap,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:a4,NavigationControl:A,GeolocateControl:a6,AttributionControl:y,ScaleControl:I,FullscreenControl:s,Popup:a7,Marker:a5,Style:Q,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,prewarm:function(){b8().acquire(b7)},clearPrewarmedResources:function(){var a=ba;a&&(a.isPreloaded()&&1===a.numActive()?(a.release(b7),ba=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(token){a.config.ACCESS_TOKEN=token},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(url){a.config.API_URL=url},get workerCount(){return z.workerCount},set workerCount(count){z.workerCount=count},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(numRequests){a.config.MAX_PARALLEL_IMAGE_REQUESTS=numRequests},clearStorage:function(b){a.clearTileCache(b)},workerUrl:""};return a8}),b})},{}],240:[function(b,a,c){"use strict";a.exports=Math.log2||function(a){return Math.log(a)*Math.LOG2E}},{}],241:[function(a,b,c){"use strict";b.exports=function(a,b){b||(b=a,a=window);var f=0,g=0,h=0,i={shift:!1,alt:!1,control:!1,meta:!1},j=!1;function k(a){var b=!1;return"altKey"in a&&(b=b||a.altKey!==i.alt,i.alt=!!a.altKey),"shiftKey"in a&&(b=b||a.shiftKey!==i.shift,i.shift=!!a.shiftKey),"ctrlKey"in a&&(b=b||a.ctrlKey!==i.control,i.control=!!a.ctrlKey),"metaKey"in a&&(b=b||a.metaKey!==i.meta,i.meta=!!a.metaKey),b}function l(c,a){var e=d.x(a),j=d.y(a);"buttons"in a&&(c=0|a.buttons),(c!==f||e!==g||j!==h||k(a))&&(f=0|c,g=e||0,h=j||0,b&&b(f,g,h,i))}function m(a){l(0,a)}function n(){(f||g||h||i.shift||i.alt||i.meta||i.control)&&(g=h=0,f=0,i.shift=i.alt=i.control=i.meta=!1,b&&b(0,0,0,i))}function o(a){k(a)&&b&&b(f,g,h,i)}function p(a){0===d.buttons(a)?l(0,a):l(f,a)}function q(a){l(f|d.buttons(a),a)}function r(a){l(f& ~d.buttons(a),a)}function e(){j||(j=!0,a.addEventListener("mousemove",p),a.addEventListener("mousedown",q),a.addEventListener("mouseup",r),a.addEventListener("mouseleave",m),a.addEventListener("mouseenter",m),a.addEventListener("mouseout",m),a.addEventListener("mouseover",m),a.addEventListener("blur",n),a.addEventListener("keyup",o),a.addEventListener("keydown",o),a.addEventListener("keypress",o),a!==window&&(window.addEventListener("blur",n),window.addEventListener("keyup",o),window.addEventListener("keydown",o),window.addEventListener("keypress",o)))}e();var c={element:a};return Object.defineProperties(c,{enabled:{get:function(){return j},set:function(b){b?e():j&&(j=!1,a.removeEventListener("mousemove",p),a.removeEventListener("mousedown",q),a.removeEventListener("mouseup",r),a.removeEventListener("mouseleave",m),a.removeEventListener("mouseenter",m),a.removeEventListener("mouseout",m),a.removeEventListener("mouseover",m),a.removeEventListener("blur",n),a.removeEventListener("keyup",o),a.removeEventListener("keydown",o),a.removeEventListener("keypress",o),a!==window&&(window.removeEventListener("blur",n),window.removeEventListener("keyup",o),window.removeEventListener("keydown",o),window.removeEventListener("keypress",o)))},enumerable:!0},buttons:{get:function(){return f},enumerable:!0},x:{get:function(){return g},enumerable:!0},y:{get:function(){return h},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),c};var d=a("mouse-event")},{"mouse-event":243}],242:[function(b,a,c){var d={left:0,top:0};a.exports=function(b,e,a){e=e||b.currentTarget||b.srcElement,Array.isArray(a)||(a=[0,0]);var c,g=b.clientX||0,h=b.clientY||0,f=(c=e)===window||c===document||c===document.body?d:c.getBoundingClientRect();return a[0]=g-f.left,a[1]=h-f.top,a}},{}],243:[function(c,d,a){"use strict";function b(a){return a.target||a.srcElement||window}a.buttons=function(b){if("object"==typeof b){if("buttons"in b)return b.buttons;if("which"in b){var a=b.which;if(2===a)return 4;if(3===a)return 2;if(a>0)return 1<<a-1}else if("button"in b){var a=b.button;if(1===a)return 4;if(2===a)return 2;if(a>=0)return 1<<a}}return 0},a.element=b,a.x=function(a){if("object"==typeof a){if("offsetX"in a)return a.offsetX;var c=b(a).getBoundingClientRect();return a.clientX-c.left}return 0},a.y=function(a){if("object"==typeof a){if("offsetY"in a)return a.offsetY;var c=b(a).getBoundingClientRect();return a.clientY-c.top}return 0}},{}],244:[function(a,b,c){"use strict";var d=a("to-px");b.exports=function(a,b,e){"function"==typeof a&&(e=!!b,b=a,a=window);var f=d("ex",a),c=function(a){e&&a.preventDefault();var d=a.deltaX||0,g=a.deltaY||0,h=a.deltaZ||0,i=a.deltaMode,c=1;switch(i){case 1:c=f;break;case 2:c=window.innerHeight;break}if(d*=c,g*=c,h*=c,d||g||h)return b(d,g,h,a)};return a.addEventListener("wheel",c),c}},{"to-px":315}],245:[function(b,d,e){(function(b,c){(function(){!function(b,c,e){c[b]=c[b]||e(),void 0!==d&&d.exports?d.exports=c[b]:"function"==typeof a&&a.amd&&a(function(){return c[b]})}("Promise",void 0!==b?b:this,function(){"use strict";var a,f,e,g=Object.prototype.toString,h=void 0!==c?function(a){return c(a)}:setTimeout;try{Object.defineProperty({},"x",{}),a=function(a,b,c,d){return Object.defineProperty(a,b,{value:c,writable:!0,configurable:!1!==d})}}catch(i){a=function(a,b,c){return a[b]=c,a}}function j(a,b){e.add(a,b),f||(f=h(e.drain))}function k(a){var b,c=typeof a;return null!=a&&("object"==c||"function"==c)&&(b=a.then),"function"==typeof b&&b}function l(){for(var a=0;a<this.chain.length;a++)m(this,1===this.state?this.chain[a].success:this.chain[a].failure,this.chain[a]);this.chain.length=0}function m(c,d,a){var b,e;try{!1===d?a.reject(c.msg):(b=!0===d?c.msg:d.call(void 0,c.msg))===a.promise?a.reject(TypeError("Promise-chain cycle")):(e=k(b))?e.call(b,a.resolve,a.reject):a.resolve(b)}catch(f){a.reject(f)}}function n(b){var c,a=this;if(!a.triggered){a.triggered=!0,a.def&&(a=a.def);try{(c=k(b))?j(function(){var d=new q(a);try{c.call(b,function(){n.apply(d,arguments)},function(){o.apply(d,arguments)})}catch(e){o.call(d,e)}}):(a.msg=b,a.state=1,a.chain.length>0&&j(l,a))}catch(d){o.call(new q(a),d)}}}function o(b){var a=this;!a.triggered&&(a.triggered=!0,a.def&&(a=a.def),a.msg=b,a.state=2,a.chain.length>0&&j(l,a))}function p(c,b,d,e){for(var a=0;a<b.length;a++)!function(a){c.resolve(b[a]).then(function(b){d(a,b)},e)}(a)}function q(a){this.def=a,this.triggered=!1}function r(a){this.promise=a,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function b(a){if("function"!=typeof a)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var b=new r(this);this.then=function(c,d){var a={success:"function"!=typeof c||c,failure:"function"==typeof d&&d};return a.promise=new this.constructor(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");a.resolve=b,a.reject=c}),b.chain.push(a),0!==b.state&&j(l,b),a.promise},this.catch=function(a){return this.then(void 0,a)};try{a.call(void 0,function(a){n.call(b,a)},function(a){o.call(b,a)})}catch(c){o.call(b,c)}}e=function(){var a,b,c;function d(a,b){this.fn=a,this.self=b,this.next=void 0}return{add:function(e,f){c=new d(e,f),b?b.next=c:a=c,b=c,c=void 0},drain:function(){var c=a;for(a=b=f=void 0;c;)c.fn.call(c.self),c=c.next}}}();var d=a({},"constructor",b,!1);return b.prototype=d,a(d,"__NPO__",0,!1),a(b,"resolve",function(a){return a&&"object"==typeof a&&1===a.__NPO__?a:new this(function(b,c){if("function"!=typeof b||"function"!=typeof c)throw TypeError("Not a function");b(a)})}),a(b,"reject",function(a){return new this(function(c,b){if("function"!=typeof c||"function"!=typeof b)throw TypeError("Not a function");b(a)})}),a(b,"all",function(b){var a=this;return"[object Array]"!=g.call(b)?a.reject(TypeError("Not an array")):0===b.length?a.resolve([]):new a(function(d,c){if("function"!=typeof d||"function"!=typeof c)throw TypeError("Not a function");var e=b.length,f=Array(e),g=0;p(a,b,function(a,b){f[a]=b,++g===e&&d(f)},c)})}),a(b,"race",function(b){var a=this;return"[object Array]"!=g.call(b)?a.reject(TypeError("Not an array")):new a(function(d,c){if("function"!=typeof d||"function"!=typeof c)throw TypeError("Not a function");p(a,b,function(b,a){d(a)},c)})}),b})}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},b("timers").setImmediate)},{timers:312}],246:[function(b,a,c){var d=Math.PI,e=j(120);function f(c,d,a,b){return["C",c,d,a,b,a,b]}function g(e,f,a,b,c,d){return["C",e/3+2/3*a,f/3+2/3*b,c/3+2/3*a,d/3+2/3*b,c,d]}function h(l,m,f,c,s,F,q,j,k,p){if(p)b=p[0],a=p[1],w=p[2],x=p[3];else{var t=i(l,m,-s);l=t.x,m=t.y;var n=(l-(j=(t=i(j,k,-s)).x))/2,o=(m-(k=t.y))/2,u=n*n/(f*f)+o*o/(c*c);u>1&&(f*=u=Math.sqrt(u),c*=u);var y=f*f,z=c*c,v=(F==q?-1:1)*Math.sqrt(Math.abs((y*z-y*o*o-z*n*n)/(y*o*o+z*n*n)));v==1/0&&(v=1);var w=v*f*o/c+(l+j)/2,x=-(v*c)*n/f+(m+k)/2,b=Math.asin(((m-x)/c).toFixed(9)),a=Math.asin(((k-x)/c).toFixed(9));b=l<w?d-b:b,a=j<w?d-a:a,b<0&&(b=2*d+b),a<0&&(a=2*d+a),q&&b>a&&(b-=2*d),!q&&a>b&&(a-=2*d)}if(Math.abs(a-b)>e)var G=a,H=j,I=k,A=h(j=w+f*Math.cos(a=b+e*(q&&a>b?1:-1)),k=x+c*Math.sin(a),f,c,s,0,q,H,I,[a,G,w,x]);var B=Math.tan((a-b)/4),C=4/3*f*B,D=4/3*c*B,g=[2*l-(l+C*Math.sin(b)),2*m-(m-D*Math.cos(b)),j+C*Math.sin(a),k-D*Math.cos(a),j,k];if(p)return g;A&&(g=g.concat(A));for(var r=0;r<g.length;){var E=i(g[r],g[r+1],s);g[r++]=E.x,g[r++]=E.y}return g}function i(b,c,a){return{x:b*Math.cos(a)-c*Math.sin(a),y:b*Math.sin(a)+c*Math.cos(a)}}function j(a){return a*(d/180)}a.exports=function(q){for(var d,k=[],l=0,m=0,r=0,s=0,e=null,i=null,b=0,c=0,n=0,u=q.length;n<u;n++){var a=q[n],t=a[0];switch(t){case"M":r=a[1],s=a[2];break;case"A":(a=h(b,c,a[1],a[2],j(a[3]),a[4],a[5],a[6],a[7])).unshift("C"),a.length>7&&(k.push(a.splice(0,7)),a.unshift("C"));break;case"S":var o=b,p=c;("C"==d||"S"==d)&&(o+=o-l,p+=p-m),a=["C",o,p,a[1],a[2],a[3],a[4]];break;case"T":"Q"==d||"T"==d?(e=2*b-e,i=2*c-i):(e=b,i=c),a=g(b,c,e,i,a[1],a[2]);break;case"Q":e=a[1],i=a[2],a=g(b,c,a[1],a[2],a[3],a[4]);break;case"L":a=f(b,c,a[1],a[2]);break;case"H":a=f(b,c,a[1],c);break;case"V":a=f(b,c,b,a[1]);break;case"Z":a=f(b,c,r,s);break}d=t,b=a[a.length-2],c=a[a.length-1],a.length>4?(l=a[a.length-4],m=a[a.length-3]):(l=b,m=c),k.push(a)}return k}},{}],247:[function(b,a,c){"use strict";var d=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;a.exports=!function(){try{if(!Object.assign)return!1;var b=new String("abc");if(b[5]="de","5"===Object.getOwnPropertyNames(b)[0])return!1;for(var c={},a=0;a<10;a++)c["_"+String.fromCharCode(a)]=a;var d=Object.getOwnPropertyNames(c).map(function(a){return c[a]});if("0123456789"!==d.join(""))return!1;var e={};if("abcdefghijklmnopqrst".split("").forEach(function(a){e[a]=a}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},e)).join(""))return!1;return!0}catch(f){return!1}}()?function(j,k){for(var a,b,g=function(a){if(null==a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}(j),h=1;h<arguments.length;h++){for(var i in a=Object(arguments[h]))e.call(a,i)&&(g[i]=a[i]);if(d){b=d(a);for(var c=0;c<b.length;c++)f.call(a,b[c])&&(g[b[c]]=a[b[c]])}}return g}:Object.assign},{}],248:[function(e,b,f){"use strict";function c(b,a){if("string"!=typeof b)return[b];var c=[b];"string"==typeof a||Array.isArray(a)?a={brackets:a}:a||(a={});var e=a.brackets?Array.isArray(a.brackets)?a.brackets:[a.brackets]:["{}","[]","()"],d=a.escape||"___",f=!!a.flat;e.forEach(function(a){var e=new RegExp(["\\",a[0],"[^\\",a[0],"\\",a[1],"]*\\",a[1]].join("")),b=[];function f(f,g,h){var e=c.push(f.slice(a[0].length,-a[1].length))-1;return b.push(e),d+e+d}c.forEach(function(a,d){for(var b,g=0;a!=b;)if(b=a,a=a.replace(e,f),g++ >1e4)throw Error("References have circular dependency. Please, check them.");c[d]=a}),b=b.reverse(),c=c.map(function(c){return b.forEach(function(b){c=c.replace(new RegExp("(\\"+d+b+"\\"+d+")","g"),a[0]+"$1"+a[1])}),c})});var h=new RegExp("\\"+d+"([0-9]+)\\"+d);function g(a,d,f){for(var b,c=[],e=0;b=h.exec(a);){if(e++ >1e4)throw Error("Circular references in parenthesis");c.push(a.slice(0,b.index)),c.push(g(d[b[1]],d)),a=a.slice(b.index+b[0].length)}return c.push(a),c}return f?c:g(c[0],c)}function d(c,b){if(b&&b.flat){var d,e=b&&b.escape||"___",a=c[0];if(!a)return"";for(var f=new RegExp("\\"+e+"([0-9]+)\\"+e),g=0;a!=d;){if(g++ >1e4)throw Error("Circular references in "+c);d=a,a=a.replace(f,h)}return a}return c.reduce(function b(c,a){return Array.isArray(a)&&(a=a.reduce(b,"")),c+a},"");function h(b,a){if(null==c[a])throw Error("Reference "+a+"is undefined");return c[a]}}function a(a,b){return Array.isArray(a)?d(a,b):c(a,b)}a.parse=c,a.stringify=d,b.exports=a},{}],249:[function(a,b,c){"use strict";var d=a("pick-by-alias");b.exports=function(a){var b;return arguments.length>1&&(a=arguments),"string"==typeof a?a=a.split(/\s/).map(parseFloat):"number"==typeof a&&(a=[a]),a.length&&"number"==typeof a[0]?b=1===a.length?{width:a[0],height:a[0],x:0,y:0}:2===a.length?{width:a[0],height:a[1],x:0,y:0}:{x:a[0],y:a[1],width:a[2]-a[0]||0,height:a[3]-a[1]||0}:a&&(b={x:(a=d(a,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:a.top||0},null==a.width?a.right?b.width=a.right-b.x:b.width=0:b.width=a.width,null==a.height?a.bottom?b.height=a.bottom-b.y:b.height=0:b.height=a.height),b}},{"pick-by-alias":253}],250:[function(b,a,c){a.exports=function(a){var b=[];return a.replace(e,function(f,c,a){var e=c.toLowerCase();for(a=g(a),"m"==e&&a.length>2&&(b.push([c].concat(a.splice(0,2))),e="l",c="m"==c?"l":"L");;){if(a.length==d[e])return a.unshift(c),b.push(a);if(a.length<d[e])throw new Error("malformed path data");b.push([c].concat(a.splice(0,d[e])))}}),b};var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig,f=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function g(b){var a=b.match(f);return a?a.map(Number):[]}},{}],251:[function(b,a,c){a.exports=function(b,a){a||(a=[0,""]);var c=parseFloat(b=String(b),10);return a[0]=c,a[1]=b.match(/[\d.\-\+]*\s*(.*)/)[1]||"",a}},{}],252:[function(a,b,c){(function(a){(function(){(function(){var d,e,c,f;"undefined"!=typeof performance&&null!==performance&&performance.now?b.exports=function(){return performance.now()}:null!=a&&a.hrtime?(b.exports=function(){return(d()-f)/1e6},e=a.hrtime,f=(d=function(){var a;return 1e9*(a=e())[0]+a[1]})()-1e9*a.uptime()):Date.now?(b.exports=function(){return Date.now()-c},c=Date.now()):(b.exports=function(){return new Date().getTime()-c},c=new Date().getTime())}).call(this)}).call(this)}).call(this,a("_process"))},{"_process":278}],253:[function(b,a,c){"use strict";a.exports=function(d,b,g){var a,c,h={};if("string"==typeof b&&(b=e(b)),Array.isArray(b)){var l={};for(c=0;c<b.length;c++)l[b[c]]=!0;b=l}for(a in b)b[a]=e(b[a]);var i={};for(a in b){var f=b[a];if(Array.isArray(f))for(c=0;c<f.length;c++){var j=f[c];if(g&&(i[j]=!0),j in d){if(h[a]=d[j],g)for(var k=c;k<f.length;k++)i[f[k]]=!0;break}}else a in d&&(b[a]&&(h[a]=d[a]),g&&(i[a]=!0))}if(g)for(a in d)i[a]||(h[a]=d[a]);return h};var d={};function e(a){return d[a]?d[a]:("string"==typeof a&&(a=d[a]=a.split(/\s*,\s*|\s+/)),a)}},{}],254:[function(b,a,c){a.exports=function(i,b,a,d){var m=i[0],e=i[1],f=!1;void 0===a&&(a=0),void 0===d&&(d=b.length);for(var j=d-a,c=0,g=j-1;c<j;g=c++){var k=b[c+a][0],h=b[c+a][1],n=b[g+a][0],l=b[g+a][1],o=h>e!=l>e&&m<(n-k)*(e-h)/(l-h)+k;o&&(f=!f)}return f}},{}],255:[function(a,c,e){var b,f=a("./lib/build-log"),d=a("./lib/epsilon"),g=a("./lib/intersecter"),h=a("./lib/segment-chainer"),i=a("./lib/segment-selector"),j=a("./lib/geojson"),k=!1,l=d();function m(a,c,d){var e=b.segments(a),f=b.segments(c),g=b.combine(e,f),h=d(g);return b.polygon(h)}b={buildLog:function(a){return!0===a?k=f():!1===a&&(k=!1),!1!==k&&k.list},epsilon:function(a){return l.epsilon(a)},segments:function(a){var b=g(!0,l,k);return a.regions.forEach(b.addRegion),{segments:b.calculate(a.inverted),inverted:a.inverted}},combine:function(a,b){return{combined:g(!1,l,k).calculate(a.segments,a.inverted,b.segments,b.inverted),inverted1:a.inverted,inverted2:b.inverted}},selectUnion:function(a){return{segments:i.union(a.combined,k),inverted:a.inverted1||a.inverted2}},selectIntersect:function(a){return{segments:i.intersect(a.combined,k),inverted:a.inverted1&&a.inverted2}},selectDifference:function(a){return{segments:i.difference(a.combined,k),inverted:a.inverted1&&!a.inverted2}},selectDifferenceRev:function(a){return{segments:i.differenceRev(a.combined,k),inverted:!a.inverted1&&a.inverted2}},selectXor:function(a){return{segments:i.xor(a.combined,k),inverted:a.inverted1!==a.inverted2}},polygon:function(a){return{regions:h(a.segments,l,k),inverted:a.inverted}},polygonFromGeoJSON:function(a){return j.toPolygon(b,a)},polygonToGeoJSON:function(a){return j.fromPolygon(b,l,a)},union:function(a,c){return m(a,c,b.selectUnion)},intersect:function(a,c){return m(a,c,b.selectIntersect)},difference:function(a,c){return m(a,c,b.selectDifference)},differenceRev:function(a,c){return m(a,c,b.selectDifferenceRev)},xor:function(a,c){return m(a,c,b.selectXor)}},"object"==typeof window&&(window.PolyBool=b),c.exports=b},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(b,a,c){a.exports=function(){var a,b=0,c=!1;function d(c,b){return a.list.push({type:c,data:b?JSON.parse(JSON.stringify(b)):void 0}),a}return a={list:[],segmentId:function(){return b++},checkIntersection:function(a,b){return d("check",{seg1:a,seg2:b})},segmentChop:function(a,b){return d("div_seg",{seg:a,pt:b}),d("chop",{seg:a,pt:b})},statusRemove:function(a){return d("pop_seg",{seg:a})},segmentUpdate:function(a){return d("seg_update",{seg:a})},segmentNew:function(a,b){return d("new_seg",{seg:a,primary:b})},segmentRemove:function(a){return d("rem_seg",{seg:a})},tempStatus:function(a,b,c){return d("temp_status",{seg:a,above:b,below:c})},rewind:function(a){return d("rewind",{seg:a})},status:function(a,b,c){return d("status",{seg:a,above:b,below:c})},vert:function(b){return b===c?a:(c=b,d("vert",{x:b}))},log:function(a){return"string"!=typeof a&&(a=JSON.stringify(a,!1,"  ")),d("log",{txt:a})},reset:function(){return d("reset")},selected:function(a){return d("selected",{segs:a})},chainStart:function(a){return d("chain_start",{seg:a})},chainRemoveHead:function(a,b){return d("chain_rem_head",{index:a,pt:b})},chainRemoveTail:function(a,b){return d("chain_rem_tail",{index:a,pt:b})},chainNew:function(a,b){return d("chain_new",{pt1:a,pt2:b})},chainMatch:function(a){return d("chain_match",{index:a})},chainClose:function(a){return d("chain_close",{index:a})},chainAddHead:function(a,b){return d("chain_add_head",{index:a,pt:b})},chainAddTail:function(a,b){return d("chain_add_tail",{index:a,pt:b})},chainConnect:function(a,b){return d("chain_con",{index1:a,index2:b})},chainReverse:function(a){return d("chain_rev",{index:a})},chainJoin:function(a,b){return d("chain_join",{index1:a,index2:b})},done:function(){return d("done")}}}},{}],257:[function(b,a,c){a.exports=function(a){"number"!=typeof a&&(a=1e-10);var b={epsilon:function(b){return"number"==typeof b&&(a=b),a},pointAboveOrOnLine:function(b,c,d){var e=c[0],f=c[1],g=d[0],h=d[1],i=b[0],j=b[1];return(g-e)*(j-f)-(h-f)*(i-e)>= -a},pointBetween:function(e,b,f){var h=e[1]-b[1],c=f[0]-b[0],i=e[0]-b[0],d=f[1]-b[1],g=i*c+h*d;return!(g<a)&&!(g-(c*c+d*d)> -a)},pointsSameX:function(b,c){return Math.abs(b[0]-c[0])<a},pointsSameY:function(b,c){return Math.abs(b[1]-c[1])<a},pointsSame:function(a,c){return b.pointsSameX(a,c)&&b.pointsSameY(a,c)},pointsCompare:function(a,c){return b.pointsSameX(a,c)?b.pointsSameY(a,c)?0:a[1]<c[1]?-1:1:a[0]<c[0]?-1:1},pointsCollinear:function(c,b,d){var e=c[0]-b[0],f=c[1]-b[1],g=b[0]-d[0],h=b[1]-d[1];return Math.abs(e*h-g*f)<a},linesIntersect:function(c,j,e,k){var g=j[0]-c[0],h=j[1]-c[1],l=k[0]-e[0],m=k[1]-e[1],i=g*m-h*l;if(Math.abs(i)<a)return!1;var n=c[0]-e[0],o=c[1]-e[1],d=(l*o-m*n)/i,f=(g*o-h*n)/i,b={alongA:0,alongB:0,pt:[c[0]+d*g,c[1]+d*h]};return d<= -a?b.alongA=-2:d<a?b.alongA=-1:d-1<= -a?b.alongA=0:d-1<a?b.alongA=1:b.alongA=2,f<= -a?b.alongB=-2:f<a?b.alongB=-1:f-1<= -a?b.alongB=0:f-1<a?b.alongB=1:b.alongB=2,b},pointInsideRegion:function(i,b){for(var k=i[0],e=i[1],j=b[b.length-1][0],f=b[b.length-1][1],g=!1,c=0;c<b.length;c++){var h=b[c][0],d=b[c][1];d-e>a!=f-e>a&&(j-h)*(e-d)/(f-d)+h-k>a&&(g=!g),j=h,f=d}return g}};return b}},{}],258:[function(b,a,c){a.exports={toPolygon:function(a,b){function e(b){if(b.length<=0)return a.segments({inverted:!1,regions:[]});function e(b){var c=b.slice(0,b.length-1);return a.segments({inverted:!1,regions:[c]})}for(var c=e(b[0]),d=1;d<b.length;d++)c=a.selectDifference(a.combine(c,e(b[d])));return c}if("Polygon"===b.type)return a.polygon(e(b.coordinates));if("MultiPolygon"===b.type){for(var c=a.segments({inverted:!1,regions:[]}),d=0;d<b.coordinates.length;d++)c=a.selectUnion(a.combine(c,e(b.coordinates[d])));return a.polygon(c)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,j,b){function k(a,b){return j.pointInsideRegion([(a[0][0]+a[1][0])*.5,(a[0][1]+a[1][1])*.5],b)}function g(a){return{region:a,children:[]}}b=e.polygon(e.segments(b));var d=g(null);function h(b,d){for(var a=0;a<b.children.length;a++){var c=b.children[a];if(k(d,c.region)){h(c,d);return}}for(var e=g(d),a=0;a<b.children.length;a++){var c=b.children[a];k(c.region,d)&&(e.children.push(c),b.children.splice(a,1),a--)}b.children.push(e)}for(var a=0;a<b.regions.length;a++){var f=b.regions[a];f.length<3||h(d,f)}function l(a,i){for(var f=0,g=a[a.length-1][0],h=a[a.length-1][1],b=[],c=0;c<a.length;c++){var d=a[c][0],e=a[c][1];b.push([d,e]),f+=e*g-d*h,g=d,h=e}return f<0!==i&&b.reverse(),b.push([b[0][0],b[0][1]]),b}var c=[];function i(a){var d=[l(a.region,!1)];c.push(d);for(var b=0;b<a.children.length;b++)d.push(m(a.children[b]))}function m(a){for(var b=0;b<a.children.length;b++)i(a.children[b]);return l(a.region,!0)}for(var a=0;a<d.children.length;a++)i(d.children[a]);return c.length<=0?{type:"Polygon",coordinates:[]}:1==c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}}},{}],259:[function(a,b,c){var d=a("./linked-list");b.exports=function(a,b,c){function e(a,b){return{id:c?c.segmentId():-1,start:a,end:b,myFill:{above:null,below:null},otherFill:null}}function f(b,d,a){return{id:c?c.segmentId():-1,start:b,end:d,myFill:{above:a.myFill.above,below:a.myFill.below},otherFill:null}}var g=d.create();function h(a,c){g.insertBefore(a,function(g){var h,k,i,d,e,f,j;return h=a.isStart,k=a.pt,i=c,d=g.isStart,e=g.pt,f=g.other.pt,j=b.pointsCompare(k,e),(0!==j?j:b.pointsSame(i,f)?0:h!==d?h?1:-1:b.pointAboveOrOnLine(i,d?e:f,d?f:e)?1:-1)<0})}function i(f,g){var a,i,j,b,c,k,e,l=(a=f,i=g,h(j=d.node({isStart:!0,pt:a.start,seg:a,primary:i,other:null,status:null}),a.end),j);return b=l,c=f,k=g,e=d.node({isStart:!1,pt:c.end,seg:c,primary:k,other:b,status:null}),b.other=e,h(e,b.pt),l}function j(b,e){var a,d,g=f(e,b.seg.end,b.seg);return a=b,d=e,c&&c.segmentChop(a.seg,d),a.other.remove(),a.seg.end=d,a.other.pt=d,h(a.other,a.pt),i(g,b.primary)}function k(o,r){var p=d.create();function s(a){return p.findTransition(function(i){var e,f,g,h,c,d;return e=a,f=i.ev,g=e.seg.start,h=e.seg.end,c=f.seg.start,d=f.seg.end,(b.pointsCollinear(g,c,d)?b.pointsCollinear(h,c,d)?1:b.pointAboveOrOnLine(h,c,d)?1:-1:b.pointAboveOrOnLine(g,c,d)?1:-1)>0})}function t(i,d){var k=i.seg,l=d.seg,g=k.start,e=k.end,h=l.start,f=l.end;c&&c.checkIntersection(k,l);var a=b.linesIntersect(g,e,h,f);if(!1===a){if(!b.pointsCollinear(g,e,h))return!1;if(b.pointsSame(g,f)||b.pointsSame(e,h))return!1;var m=b.pointsSame(g,h),n=b.pointsSame(e,f);if(m&&n)return d;var p=!m&&b.pointBetween(g,h,f),o=!n&&b.pointBetween(e,h,f);if(m)return o?j(d,e):j(i,f),d;p&&(n||(o?j(d,e):j(i,f)),j(d,g))}else 0===a.alongA&&(-1===a.alongB?j(i,h):0===a.alongB?j(i,a.pt):1===a.alongB&&j(i,f)),0===a.alongB&&(-1===a.alongA?j(d,g):0===a.alongA?j(d,a.pt):1===a.alongA&&j(d,e));return!1}for(var q=[];!g.isEmpty();){var e=g.getHead();if(c&&c.vert(e.pt[0]),e.isStart){c&&c.segmentNew(e.seg,e.primary);var l,l,n,i=s(e),m=i.before?i.before.ev:null,f=i.after?i.after.ev:null;function u(){if(m){var a=t(e,m);if(a)return a}return!!f&&t(e,f)}c&&c.tempStatus(e.seg,!!m&&m.seg,!!f&&f.seg);var k=u();if(k&&(a?(l=null===e.seg.myFill.below||e.seg.myFill.above!==e.seg.myFill.below)&&(k.seg.myFill.above=!k.seg.myFill.above):k.seg.otherFill=e.seg.myFill,c&&c.segmentUpdate(k.seg),e.other.remove(),e.remove()),g.getHead()!==e){c&&c.rewind(e.seg);continue}a?(l=null===e.seg.myFill.below||e.seg.myFill.above!==e.seg.myFill.below,f?e.seg.myFill.below=f.seg.myFill.above:e.seg.myFill.below=o,l?e.seg.myFill.above=!e.seg.myFill.below:e.seg.myFill.above=e.seg.myFill.below):null===e.seg.otherFill&&(n=f?e.primary===f.primary?f.seg.otherFill.above:f.seg.myFill.above:e.primary?r:o,e.seg.otherFill={above:n,below:n}),c&&c.status(e.seg,!!m&&m.seg,!!f&&f.seg),e.other.status=i.insert(d.node({ev:e}))}else{var h=e.status;if(null===h)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(p.exists(h.prev)&&p.exists(h.next)&&t(h.prev.ev,h.next.ev),c&&c.statusRemove(h.ev.seg),h.remove(),!e.primary){var v=e.seg.myFill;e.seg.myFill=e.seg.otherFill,e.seg.otherFill=v}q.push(e.seg)}g.getHead().remove()}return c&&c.done(),q}return a?{addRegion:function(c){for(var d,a=c[c.length-1],f=0;f<c.length;f++){d=a,a=c[f];var g=b.pointsCompare(d,a);0!==g&&i(e(g<0?d:a,g<0?a:d),!0)}},calculate:function(a){return k(a,!1)}}:{calculate:function(a,b,c,d){return a.forEach(function(a){i(f(a.start,a.end,a),!0)}),c.forEach(function(a){i(f(a.start,a.end,a),!1)}),k(b,d)}}}},{"./linked-list":260}],260:[function(b,a,c){a.exports={create:function(){var a={root:{root:!0,next:null},exists:function(b){return null!==b&&b!==a.root},isEmpty:function(){return null===a.root.next},getHead:function(){return a.root.next},insertBefore:function(c,e){for(var d=a.root,b=a.root.next;null!==b;){if(e(b)){c.prev=b.prev,c.next=b,b.prev.next=c,b.prev=c;return}d=b,b=b.next}d.next=c,c.prev=d,c.next=null},findTransition:function(d){for(var c=a.root,b=a.root.next;null!==b&&!d(b);)c=b,b=b.next;return{before:c===a.root?null:c,after:b,insert:function(a){return a.prev=c,a.next=b,c.next=a,null!==b&&(b.prev=a),a}}}};return a},node:function(a){return a.prev=null,a.next=null,a.remove=function(){a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.prev=null,a.next=null},a}}},{}],261:[function(b,a,c){a.exports=function(a,c,d){var e=[],b=[];return a.forEach(function(s){var l=s.start,m=s.end;if(c.pointsSame(l,m)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}d&&d.chainStart(s);var f={index:0,matches_head:!1,matches_pt1:!1},p={index:0,matches_head:!1,matches_pt1:!1},t=f;function q(a,b,c){return(t.index=a,t.matches_head=b,t.matches_pt1=c,t===f)?(t=p,!1):(t=null,!0)}for(var j=0;j<e.length;j++){var a=e[j],u=a[0];a[1];var v=a[a.length-1];if(a[a.length-2],c.pointsSame(u,l)){if(q(j,!0,!0))break}else if(c.pointsSame(u,m)){if(q(j,!0,!1))break}else if(c.pointsSame(v,l)){if(q(j,!1,!0))break}else if(c.pointsSame(v,m)&&q(j,!1,!1))break}if(t===f){e.push([l,m]),d&&d.chainNew(l,m);return}if(t===p){d&&d.chainMatch(f.index);var w=f.index,i=f.matches_pt1?m:l,k=f.matches_head,a=e[w],o=k?a[0]:a[a.length-1],x=k?a[1]:a[a.length-2],y=k?a[a.length-1]:a[0],A=k?a[a.length-2]:a[1];if(c.pointsCollinear(x,o,i)&&(k?(d&&d.chainRemoveHead(f.index,i),a.shift()):(d&&d.chainRemoveTail(f.index,i),a.pop()),o=x),c.pointsSame(y,i)){e.splice(w,1),c.pointsCollinear(A,y,o)&&(k?(d&&d.chainRemoveTail(f.index,o),a.pop()):(d&&d.chainRemoveHead(f.index,o),a.shift())),d&&d.chainClose(f.index),b.push(a);return}k?(d&&d.chainAddHead(f.index,i),a.unshift(i)):(d&&d.chainAddTail(f.index,i),a.push(i));return}function r(a){d&&d.chainReverse(a),e[a].reverse()}function n(b,f){var a=e[b],g=e[f],h=a[a.length-1],j=a[a.length-2],i=g[0],k=g[1];c.pointsCollinear(j,h,i)&&(d&&d.chainRemoveTail(b,h),a.pop(),h=j),c.pointsCollinear(h,i,k)&&(d&&d.chainRemoveHead(f,i),g.shift()),d&&d.chainJoin(b,f),e[b]=a.concat(g),e.splice(f,1)}var g=f.index,h=p.index;d&&d.chainConnect(g,h);var z=e[g].length<e[h].length;f.matches_head?p.matches_head?z?(r(g),n(g,h)):(r(h),n(h,g)):n(h,g):p.matches_head?n(g,h):z?(r(g),n(h,g)):(r(h),n(g,h))}),b}},{}],262:[function(b,a,c){function d(c,d,a){var b=[];return c.forEach(function(c){var e=(c.myFill.above?8:0)+(c.myFill.below?4:0)+(c.otherFill&&c.otherFill.above?2:0)+(c.otherFill&&c.otherFill.below?1:0);0!==d[e]&&b.push({id:a?a.segmentId():-1,start:c.start,end:c.end,myFill:{above:1===d[e],below:2===d[e]},otherFill:null})}),a&&a.selected(b),b}a.exports={union:function(a,b){return d(a,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],b)},intersect:function(a,b){return d(a,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],b)},difference:function(a,b){return d(a,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],b)},differenceRev:function(a,b){return d(a,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],b)},xor:function(a,b){return d(a,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],b)}}},{}],263:[function(d,g,a){"use strict";var e=d("stream").Transform,f=d("stream-parser");function b(){e.call(this,{readableObjectMode:!0})}function c(c,a,b){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=c,a&&(this.code=a),b&&(this.statusCode=b)}b.prototype=Object.create(e.prototype),b.prototype.constructor=b,f(b.prototype),a.ParserStream=b,a.sliceEq=function(c,d,a){for(var e=d,b=0;b<a.length;)if(c[e++]!==a[b++])return!1;return!0},a.str2arr=function(b,d){var c=[],a=0;if(d&&"hex"===d)for(;a<b.length;)c.push(parseInt(b.slice(a,a+2),16)),a+=2;else for(;a<b.length;a++)c.push(255&b.charCodeAt(a));return c},a.readUInt16LE=function(a,b){return a[b]|a[b+1]<<8},a.readUInt16BE=function(a,b){return a[b+1]|a[b]<<8},a.readUInt32LE=function(a,b){return a[b]|a[b+1]<<8|a[b+2]<<16|16777216*a[b+3]},a.readUInt32BE=function(a,b){return a[b+3]|a[b+2]<<8|a[b+1]<<16|16777216*a[b]},c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,a.ProbeError=c},{stream:286,"stream-parser":302}],264:[function(c,b,d){"use strict";function e(b,c){var a=new Error(b);return a.code=c,a}function f(a){try{return decodeURIComponent(escape(a))}catch(b){return a}}function a(c,b,d){this.input=c.subarray(b,d),this.start=b;var a=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\0"!==a&&"MM\0*"!==a)throw e("invalid TIFF signature","EBADDATA");this.big_endian="M"===a[0]}a.prototype.each=function(b){this.aborted=!1;var c=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:c}];this.ifds_to_read.length>0&&!this.aborted;){var a=this.ifds_to_read.shift();a.offset&&this.scan_ifd(a.id,a.offset,b)}},a.prototype.read_uint16=function(a){var b=this.input;if(a+2>b.length)throw e("unexpected EOF","EBADDATA");return this.big_endian?256*b[a]+b[a+1]:b[a]+256*b[a+1]},a.prototype.read_uint32=function(a){var b=this.input;if(a+4>b.length)throw e("unexpected EOF","EBADDATA");return this.big_endian?16777216*b[a]+65536*b[a+1]+256*b[a+2]+b[a+3]:b[a]+256*b[a+1]+65536*b[a+2]+16777216*b[a+3]},a.prototype.is_subifd_link=function(a,b){return 0===a&&34665===b||0===a&&34853===b||34665===a&&40965===b},a.prototype.exif_format_length=function(a){switch(a){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},a.prototype.exif_format_read=function(c,b){var a;switch(c){case 1:case 2:return a=this.input[b];case 6:return(a=this.input[b])|(128&a)*33554430;case 3:return a=this.read_uint16(b);case 8:return(a=this.read_uint16(b))|(32768&a)*131070;case 4:return a=this.read_uint32(b);case 9:return 0|(a=this.read_uint32(b));case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},a.prototype.scan_ifd=function(d,b,q){var r=this.read_uint16(b);b+=2;for(var k=0;k<r;k++){var g=this.read_uint16(b),c=this.read_uint16(b+2),h=this.read_uint32(b+4),l=this.exif_format_length(c),i=h*l,j=i<=4?b+8:this.read_uint32(b+8),m=!1;if(j+i>this.input.length)throw e("unexpected EOF","EBADDATA");for(var a=[],n=j,o=0;o<h;o++,n+=l){var p=this.exif_format_read(c,n);if(null===p){a=null;break}a.push(p)}if(Array.isArray(a)&&2===c&&(a=f(String.fromCharCode.apply(null,a)))&&"\0"===a[a.length-1]&&(a=a.slice(0,-1)),this.is_subifd_link(d,g)&&Array.isArray(a)&&Number.isInteger(a[0])&&a[0]>0&&(this.ifds_to_read.push({id:g,offset:a[0]}),m=!0),!1===q({is_big_endian:this.big_endian,ifd:d,tag:g,format:c,count:h,entry_offset:b+this.start,data_length:i,data_offset:j+this.start,value:a,is_subifd_link:m})){this.aborted=!0;return}b+=12}0===d&&this.ifds_to_read.push({id:1,offset:this.read_uint32(b)})},b.exports.ExifParser=a,b.exports.get_orientation=function(b){var c=0;try{return new a(b,0,b.length).each(function(a){if(0===a.ifd&&274===a.tag&&Array.isArray(a.value))return c=a.value[0],!1}),c}catch(d){return -1}}},{}],265:[function(b,a,d){"use strict";var e=b("./common").readUInt16BE,f=b("./common").readUInt32BE;function c(b,a){if(b.length<4+a)return null;var c=f(b,a);return b.length<c+a||c<8?null:{boxtype:String.fromCharCode.apply(null,b.slice(a+4,a+8)),data:b.slice(a+8,a+c),end:a+c}}function g(e,b){for(var d=0;;){var a=c(e,d);if(!a)break;switch(a.boxtype){case"ispe":b.sizes.push({width:f(a.data,4),height:f(a.data,8)});break;case"irot":b.transforms.push({type:"irot",value:3&a.data[0]});break;case"imir":b.transforms.push({type:"imir",value:1&a.data[0]});break}d=a.end}}function h(c,d,e){for(var a=0,b=0;b<e;b++)a=256*a+(c[d+b]||0);return a}function i(a,j){for(var c=a[4]>>4&15,d=15&a[4],f=a[5]>>4&15,k=e(a,6),b=8,g=0;g<k;g++){var l=e(a,b),m=e(a,b+=2),n=h(a,b+=2,f);b+=f;var i=e(a,b);if(b+=2,0===m&&1===i){var o=h(a,b,c),p=h(a,b+c,d);j.item_loc[l]={length:p,offset:o+n}}b+=i*(c+d)}}function j(d,i){for(var j=e(d,4),f=6,g=0;g<j;g++){var a=c(d,f);if(!a)break;if("infe"===a.boxtype){for(var k=e(a.data,4),h="",b=8;b<a.data.length&&a.data[b];b++)h+=String.fromCharCode(a.data[b]);i.item_inf[h]=k}f=a.end}}function k(d,e){for(var b=0;;){var a=c(d,b);if(!a)break;"ipco"===a.boxtype&&g(a.data,e),b=a.end}}a.exports.unbox=c,a.exports.readSizeFromMeta=function(h){var a={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(e,b){for(var d=4;;){var a=c(e,d);if(!a)break;"iprp"===a.boxtype&&k(a.data,b),"iloc"===a.boxtype&&i(a.data,b),"iinf"===a.boxtype&&j(a.data,b),d=a.end}}(h,a),a.sizes.length){var e,b,d,f=(b=(e=a.sizes).reduce(function(a,b){return a.width>b.width||a.width===b.width&&a.height>b.height?a:b}),d=e.reduce(function(a,b){return a.height>b.height||a.height===b.height&&a.width>b.width?a:b}),b.width>d.height||b.width===d.height&&b.height>d.width?b:d),l=1;a.transforms.forEach(function(a){var b={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},c={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if("imir"===a.type&&(0===a.value?l=c[l]:(l=b[l=c[l]],l=b[l])),"irot"===a.type)for(var d=0;d<a.value;d++)l=b[l]});var g=null;return a.item_inf.Exif&&(g=a.item_loc[a.item_inf.Exif]),{width:f.width,height:f.height,orientation:a.transforms.length?l:null,variants:a.sizes,exif_location:g}}},a.exports.getMimeType=function(d){var b=String.fromCharCode.apply(null,d.slice(0,4)),a={};a[b]=!0;for(var c=8;c<d.length;c+=4)a[String.fromCharCode.apply(null,d.slice(c,c+4))]=!0;if(a.mif1||a.msf1||a.miaf)return"avif"===b||"avis"===b||"avio"===b?{type:"avif",mime:"image/avif"}:"heic"===b||"heix"===b?{type:"heic",mime:"image/heic"}:"hevc"===b||"hevx"===b?{type:"heic",mime:"image/heic-sequence"}:a.avif||a.avis?{type:"avif",mime:"image/avif"}:a.heic||a.heix||a.hevc||a.hevx||a.heis?a.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(a,b,d){"use strict";var c=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt32BE,g=a("../miaf_utils"),h=a("../exif_utils"),i=c("ftyp");b.exports=function(b){if(e(b,4,i)){var j=g.unbox(b,0);if(j){var k=g.getMimeType(j.data);if(k){for(var l,m=j.end;;){var c=g.unbox(b,m);if(!c)break;if(m=c.end,"mdat"===c.boxtype)return;if("meta"===c.boxtype){l=c.data;break}}if(l){var a=g.readSizeFromMeta(l);if(a){var d={width:a.width,height:a.height,type:k.type,mime:k.mime,wUnits:"px",hUnits:"px"};if(a.variants.length>1&&(d.variants=a.variants),a.orientation&&(d.orientation=a.orientation),a.exif_location&&a.exif_location.offset+a.exif_location.length<=b.length){var o=f(b,a.exif_location.offset),p=b.slice(a.exif_location.offset+o+4,a.exif_location.offset+a.exif_location.length),n=h.get_orientation(p);n>0&&(d.orientation=n)}return d}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(a,b,d){"use strict";var c=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt16LE,g=c("BM");b.exports=function(a){if(!(a.length<26)&&e(a,0,g))return{width:f(a,18),height:f(a,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(a,c,d){"use strict";var b=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt16LE,g=b("GIF87a"),h=b("GIF89a");c.exports=function(a){if(!(a.length<10)&&(e(a,0,g)||e(a,0,h)))return{width:f(a,6),height:f(a,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(a,b,c){"use strict";var d=a("../common").readUInt16LE;b.exports=function(a){var j=d(a,0),k=d(a,2),e=d(a,4);if(0===j&&1===k&&e){for(var f=[],b={width:0,height:0},c=0;c<e;c++){var g=a[6+16*c]||256,h=a[6+16*c+1]||256,i={width:g,height:h};f.push(i),(g>b.width||h>b.height)&&(b=i)}return{width:b.width,height:b.height,variants:f,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(a,b,d){"use strict";var e=a("../common").readUInt16BE,c=a("../common").str2arr,f=a("../common").sliceEq,g=a("../exif_utils"),h=c("Exif\0\0");b.exports=function(a){if(!(a.length<2)&&255===a[0]&&216===a[1]&&255===a[2])for(var c=2;;){for(;;){if(a.length-c<2)return;if(255===a[c++])break}for(var d,i,b=a[c++];255===b;)b=a[c++];if(208<=b&&b<=217||1===b)d=0;else{if(!(192<=b)||!(b<=254))return;if(a.length-c<2)return;d=e(a,c)-2,c+=2}if(217===b||218===b)return;if(225===b&&d>=10&&f(a,c,h)&&(i=g.get_orientation(a.slice(c+6,c+d))),d>=5&&192<=b&&b<=207&&196!==b&&200!==b&&204!==b){if(a.length-c<d)return;var j={width:e(a,c+3),height:e(a,c+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return i>0&&(j.orientation=i),j}c+=d}}},{"../common":263,"../exif_utils":264}],271:[function(a,c,d){"use strict";var b=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt32BE,g=b("\x89PNG\r\n\x1a\n"),h=b("IHDR");c.exports=function(a){if(!(a.length<24)&&e(a,0,g)&&e(a,12,h))return{width:f(a,16),height:f(a,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(a,b,d){"use strict";var c=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt32BE,g=c("8BPS\0\x01");b.exports=function(a){if(!(a.length<22)&&e(a,0,g))return{width:f(a,18),height:f(a,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(b,a,c){"use strict";function d(a){return 32===a||9===a||13===a||10===a}function e(a){return"number"==typeof a&&isFinite(a)&&a>0}var f=/<[-_.:a-zA-Z0-9][^>]*>/,g=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,h=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,i=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,j=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,k=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function l(a){return k.test(a)?a.match(k)[0]:"px"}a.exports=function(p){if(function(a){var b=0,c=a.length;for(239===a[0]&&187===a[1]&&191===a[2]&&(b=3);b<c&&d(a[b]);)b++;return b!==c&&60===a[b]}(p)){for(var u="",q=0;q<p.length;q++)u+=String.fromCharCode(p[q]);var v=(u.match(f)||[""])[0];if(g.test(v)){var r,m,n,o,a=(m=(r=v).match(h),n=r.match(i),o=r.match(j),{width:m&&(m[1]||m[2]),height:n&&(n[1]||n[2]),viewbox:o&&(o[1]||o[2])}),c=parseFloat(a.width),k=parseFloat(a.height);if(a.width&&a.height){if(!e(c)||!e(k))return;return{width:c,height:k,type:"svg",mime:"image/svg+xml",wUnits:l(a.width),hUnits:l(a.height)}}var w=(a.viewbox||"").split(" "),b={width:w[2],height:w[3]},s=parseFloat(b.width),t=parseFloat(b.height);if(e(s)&&e(t)&&l(b.width)===l(b.height)){var x=s/t;if(a.width){if(!e(c))return;return{width:c,height:c/x,type:"svg",mime:"image/svg+xml",wUnits:l(a.width),hUnits:l(a.width)}}if(a.height){if(!e(k))return;return{width:k*x,height:k,type:"svg",mime:"image/svg+xml",wUnits:l(a.height),hUnits:l(a.height)}}return{width:s,height:t,type:"svg",mime:"image/svg+xml",wUnits:l(b.width),hUnits:l(b.height)}}}}}},{}],274:[function(a,c,d){"use strict";var b=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt16LE,g=a("../common").readUInt16BE,h=a("../common").readUInt32LE,i=a("../common").readUInt32BE,j=b("II*\0"),k=b("MM\0*");function l(a,b,c){return c?g(a,b):f(a,b)}function m(a,b,c){return c?i(a,b):h(a,b)}function n(a,b,c){var d=l(a,b+2,c);return 1!==m(a,b+4,c)||3!==d&&4!==d?null:3===d?l(a,b+8,c):m(a,b+8,c)}c.exports=function(a){if(!(a.length<8)&&(e(a,0,j)||e(a,0,k))){var c,f,g,i,d=77===a[0],o=m(a,4,d)-8;if(!(o<0)){var b=o+8;if(!(a.length-b<2)){var h=12*l(a,b+0,d);if(!(h<=0)&&(b+=2,!(a.length-b<h))){for(c=0;c<h;c+=12)256===(i=l(a,b+c,d))?f=n(a,b+c,d):257===i&&(g=n(a,b+c,d));if(f&&g)return{width:f,height:g,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":263}],275:[function(a,c,d){"use strict";var b=a("../common").str2arr,e=a("../common").sliceEq,f=a("../common").readUInt16LE,g=a("../common").readUInt32LE,h=a("../exif_utils"),i=b("RIFF"),j=b("WEBP");function k(a,b){if(157===a[b+3]&&1===a[b+4]&&42===a[b+5])return{width:16383&f(a,b+6),height:16383&f(a,b+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function l(a,b){if(47===a[b]){var c=g(a,b+1);return{width:(16383&c)+1,height:(c>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function m(b,a){return{width:(b[a+6]<<16|b[a+5]<<8|b[a+4])+1,height:(b[a+9]<<a|b[a+8]<<8|b[a+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}c.exports=function(b){if(!(b.length<16)&&(e(b,0,i)||e(b,8,j))){var a=12,c=null,n=0,o=g(b,4)+8;if(!(o>b.length)){for(;a+8<o;){if(0===b[a]){a++;continue}var f=String.fromCharCode.apply(null,b.slice(a,a+4)),d=g(b,a+4);"VP8 "===f&&d>=10?c=c||k(b,a+8):"VP8L"===f&&d>=9?c=c||l(b,a+8):"VP8X"===f&&d>=10?c=c||m(b,a+8):"EXIF"===f&&(n=h.get_orientation(b.slice(a+8,a+8+d)),a=1/0),a+=8+d}if(c)return n>0&&(c.orientation=n),c}}}},{"../common":263,"../exif_utils":264}],276:[function(a,b,c){"use strict";b.exports={avif:a("./parse_sync/avif"),bmp:a("./parse_sync/bmp"),gif:a("./parse_sync/gif"),ico:a("./parse_sync/ico"),jpeg:a("./parse_sync/jpeg"),png:a("./parse_sync/png"),psd:a("./parse_sync/psd"),svg:a("./parse_sync/svg"),tiff:a("./parse_sync/tiff"),webp:a("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(b,a,d){"use strict";var c=b("./lib/parsers_sync");a.exports=function(a){return function(e){for(var b=Object.keys(c),a=0;a<b.length;a++){var d=c[b[a]](e);if(d)return d}return null}(a)},a.exports.parsers=c},{"./lib/parsers_sync":276}],278:[function(e,c,f){var g,h,i,a=c.exports={};function j(){throw new Error("setTimeout has not been defined")}function k(){throw new Error("clearTimeout has not been defined")}function l(a){if(g===setTimeout)return setTimeout(a,0);if((g===j||!g)&&setTimeout)return g=setTimeout,setTimeout(a,0);try{return g(a,0)}catch(b){try{return g.call(null,a,0)}catch(c){return g.call(this,a,0)}}}!function(){try{g="function"==typeof setTimeout?setTimeout:j}catch(a){g=j}try{h="function"==typeof clearTimeout?clearTimeout:k}catch(b){h=k}}();var m=[],n=!1,o=-1;function p(){n&&i&&(n=!1,i.length?m=i.concat(m):o=-1,m.length&&q())}function q(){if(!n){var b=l(p);n=!0;for(var a=m.length;a;){for(i=m,m=[];++o<a;)i&&i[o].run();o=-1,a=m.length}i=null,n=!1,function(a){if(h===clearTimeout)return clearTimeout(a);if((h===k||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(a);try{h(a)}catch(b){try{return h.call(null,a)}catch(c){return h.call(this,a)}}}(b)}}function d(a,b){this.fun=a,this.array=b}function b(){}a.nextTick=function(c){var b=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];m.push(new d(c,b)),1!==m.length||n||l(q)},d.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=b,a.addListener=b,a.once=b,a.off=b,a.removeListener=b,a.removeAllListeners=b,a.emit=b,a.prependListener=b,a.prependOnceListener=b,a.listeners=function(a){return[]},a.binding=function(a){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(a){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],279:[function(a,b,d){(function(c){(function(){for(var j=a("performance-now"),d="undefined"==typeof window?c:window,g=["moz","webkit"],e="AnimationFrame",h=d["request"+e],i=d["cancel"+e]||d["cancelRequest"+e],f=0;!h&&f<g.length;f++)h=d[g[f]+"Request"+e],i=d[g[f]+"Cancel"+e]||d[g[f]+"CancelRequest"+e];if(!h||!i){var k=0,l=0,m=[],n=1e3/60;h=function(c){if(0===m.length){var a=j(),b=Math.max(0,n-(a-k));k=b+a,setTimeout(function(){var b=m.slice(0);m.length=0;for(var a=0;a<b.length;a++)if(!b[a].cancelled)try{b[a].callback(k)}catch(c){setTimeout(function(){throw c},0)}},Math.round(b))}return m.push({handle:++l,callback:c,cancelled:!1}),l},i=function(b){for(var a=0;a<m.length;a++)m[a].handle===b&&(m[a].cancelled=!0)}}b.exports=function(a){return h.call(d,a)},b.exports.cancel=function(){i.apply(d,arguments)},b.exports.polyfill=function(a){a||(a=d),a.requestAnimationFrame=h,a.cancelAnimationFrame=i}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":252}],280:[function(a,c,d){"use strict";var e=a("array-bounds"),f=a("color-normalize"),g=a("update-diff"),h=a("pick-by-alias"),i=a("object-assign"),j=a("flatten-vertex-data"),b=a("to-float32"),k=b.float32,l=b.fract32;c.exports=function(a,b){if("function"==typeof a?(b||(b={}),b.regl=a):b=a,b.length&&(b.positions=b),!(a=b.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var r,d,n,o,p,c,q=a._gl,t={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},s=[];return o=a.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),d=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),n=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),p=a.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),c=a.buffer({usage:"static",type:"float",data:m}),x(b),r=a({vert:"\n		precision highp float;\n\n		attribute vec2 position, positionFract;\n		attribute vec4 error;\n		attribute vec4 color;\n\n		attribute vec2 direction, lineOffset, capOffset;\n\n		uniform vec4 viewport;\n		uniform float lineWidth, capSize;\n		uniform vec2 scale, scaleFract, translate, translateFract;\n\n		varying vec4 fragColor;\n\n		void main() {\n			fragColor = color / 255.;\n\n			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n			vec2 position = position + dxy;\n\n			vec2 pos = (position + translate) * scale\n				+ (positionFract + translateFract) * scale\n				+ (position + translate) * scaleFract\n				+ (positionFract + translateFract) * scaleFract;\n\n			pos += pixelOffset / viewport.zw;\n\n			gl_Position = vec4(pos * 2. - 1., 0, 1);\n		}\n		",frag:"\n		precision highp float;\n\n		varying vec4 fragColor;\n\n		uniform float opacity;\n\n		void main() {\n			gl_FragColor = fragColor;\n			gl_FragColor.a *= opacity;\n		}\n		",uniforms:{range:a.prop("range"),lineWidth:a.prop("lineWidth"),capSize:a.prop("capSize"),opacity:a.prop("opacity"),scale:a.prop("scale"),translate:a.prop("translate"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),viewport:function(a,b){return[b.viewport.x,b.viewport.y,a.viewportWidth,a.viewportHeight]}},attributes:{color:{buffer:o,offset:function(b,a){return 4*a.offset},divisor:1},position:{buffer:d,offset:function(b,a){return 8*a.offset},divisor:1},positionFract:{buffer:n,offset:function(b,a){return 8*a.offset},divisor:1},error:{buffer:p,offset:function(b,a){return 16*a.offset},divisor:1},direction:{buffer:c,stride:24,offset:0},lineOffset:{buffer:c,stride:24,offset:8},capOffset:{buffer:c,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport"),stencil:!1,instances:a.prop("count"),count:m.length}),i(u,{update:x,draw:v,destroy:y,regl:a,gl:q,canvas:q.canvas,groups:s}),u;function u(a){a?x(a):null===a&&y(),v()}function v(b){if("number"==typeof b)return w(b);b&&!Array.isArray(b)&&(b=[b]),a._refresh(),s.forEach(function(a,c){if(a){if(b&&(b[c]?a.draw=!0:a.draw=!1),!a.draw){a.draw=!0;return}w(c)}})}function w(a){"number"==typeof a&&(a=s[a]),null!=a&&a&&a.count&&a.color&&a.opacity&&a.positions&&a.positions.length>1&&(a.scaleRatio=[a.scale[0]*a.viewport.width,a.scale[1]*a.viewport.height],r(a),a.after&&a.after(a))}function x(a){if(a){null!=a.length?"number"==typeof a[0]&&(a=[{positions:a}]):Array.isArray(a)||(a=[a]);var r=0,v=0;if(u.groups=s=a.map(function(a,c){var b=s[c];return a&&("function"==typeof a?a={after:a}:"number"==typeof a[0]&&(a={positions:a}),a=h(a,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),b||(s[c]=b={id:c,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},a=i({},t,a)),g(b,a,[{lineWidth:function(a){return .5*+a},capSize:function(a){return .5*+a},opacity:parseFloat,errors:function(a){return v+=(a=j(a)).length,a},positions:function(a,b){return a=j(a,"float64"),b.count=Math.floor(a.length/2),b.bounds=e(a,2),b.offset=r,r+=b.count,a}},{color:function(a,g){var b=g.count;if(a||(a="transparent"),!Array.isArray(a)||"number"==typeof a[0]){var h=a;a=Array(b);for(var d=0;d<b;d++)a[d]=h}if(a.length<b)throw Error("Not enough colors");for(var e=new Uint8Array(4*b),c=0;c<b;c++){var i=f(a[c],"uint8");e.set(i,4*c)}return e},range:function(a,b,d){var c=b.bounds;return a||(a=c),b.scale=[1/(a[2]-a[0]),1/(a[3]-a[1])],b.translate=[-a[0],-a[1]],b.scaleFract=l(b.scale),b.translateFract=l(b.translate),a},viewport:function(a){var b;return Array.isArray(a)?b={x:a[0],y:a[1],width:a[2]-a[0],height:a[3]-a[1]}:a?(b={x:a.x||a.left||0,y:a.y||a.top||0},a.right?b.width=a.right-b.x:b.width=a.w||a.width||0,a.bottom?b.height=a.bottom-b.y:b.height=a.h||a.height||0):b={x:0,y:0,width:q.drawingBufferWidth,height:q.drawingBufferHeight},b}}])),b}),r||v){var b=s.reduce(function(b,a,c){return b+(a?a.count:0)},0),c=new Float64Array(2*b),w=new Uint8Array(4*b),x=new Float32Array(4*b);s.forEach(function(a,h){if(a){var d=a.positions,e=a.count,b=a.offset,f=a.color,g=a.errors;e&&(w.set(f,4*b),x.set(g,4*b),c.set(d,2*b))}});var m=k(c);d(m),n(l(c,m)),o(w),p(x)}}}function y(){d.destroy(),n.destroy(),o.destroy(),p.destroy(),c.destroy()}};var m=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(b,d,f){"use strict";var g=b("color-normalize"),h=b("array-bounds"),i=b("object-assign"),j=b("glslify"),k=b("pick-by-alias"),l=b("flatten-vertex-data"),m=b("earcut"),n=b("array-normalize"),c=b("to-float32"),o=c.float32,p=c.fract32,e=b("es6-weak-map"),q=b("parse-rect"),r=b("array-find-index");function a(b,c){if(!(this instanceof a))return new a(b,c);if("function"==typeof b?(c||(c={}),c.regl=b):c=b,c.length&&(c.positions=c),!(b=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=b._gl,this.regl=b,this.passes=[],this.shaders=a.shaders.has(b)?a.shaders.get(b):a.shaders.set(b,a.createShaders(b)).get(b),this.update(c)}d.exports=a,a.dashMult=2,a.maxPatternLength=256,a.precisionThreshold=3e6,a.maxPoints=1e4,a.maxLines=2048,a.shaders=new e,a.createShaders=function(a){var d,c=a.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),b={primitive:"triangle strip",instances:a.prop("count"),count:4,offset:0,uniforms:{miterMode:function(b,a){return"round"===a.join?2:1},miterLimit:a.prop("miterLimit"),scale:a.prop("scale"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),translate:a.prop("translate"),thickness:a.prop("thickness"),dashTexture:a.prop("dashTexture"),opacity:a.prop("opacity"),pixelRatio:a.context("pixelRatio"),id:a.prop("id"),dashLength:a.prop("dashLength"),viewport:function(a,b){return[b.viewport.x,b.viewport.y,a.viewportWidth,a.viewportHeight]},depth:a.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(b,a){return!a.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport")},e=a(i({vert:j(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n	// the order is important\n	return position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n	float lineStart = 1. - lineEnd;\n	float lineOffset = lineTop * 2. - 1.;\n\n	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n	tangent = normalize(diff * scale * viewport.zw);\n	vec2 normal = vec2(-tangent.y, tangent.x);\n\n	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n		+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n	fragColor = color / 255.;\n}\n"]),frag:j(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n	float alpha = 1.;\n\n	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n	float dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n	gl_FragColor = fragColor;\n	gl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:c,divisor:0,stride:8,offset:0},lineTop:{buffer:c,divisor:0,stride:8,offset:4},aCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:a.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:a.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:a.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},b));try{d=a(i({cull:{enable:!0,face:"back"},vert:j(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n	vec2 diff = b - a;\n	vec2 perp = normalize(vec2(-diff.y, diff.x));\n	return dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n	vec2 normalWidth = thickness / scaleRatio;\n\n	float lineStart = 1. - lineEnd;\n	float lineBot = 1. - lineTop;\n\n	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n	vec2 prevDiff = aCoord - prevCoord;\n	vec2 currDiff = bCoord - aCoord;\n	vec2 nextDiff = nextCoord - bCoord;\n\n	vec2 prevTangent = normalize(prevDiff * scaleRatio);\n	vec2 currTangent = normalize(currDiff * scaleRatio);\n	vec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n	vec2 currNormal = vec2(-currTangent.y, currTangent.x);\n	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n	vec2 startJoinDirection = normalize(prevTangent - currTangent);\n	vec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n	// collapsed/unidirectional segment cases\n	// FIXME: there should be more elegant solution\n	vec2 prevTanDiff = abs(prevTangent - currTangent);\n	vec2 nextTanDiff = abs(nextTangent - currTangent);\n	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n		startJoinDirection = currNormal;\n	}\n	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n		endJoinDirection = currNormal;\n	}\n	if (aCoord == bCoord) {\n		endJoinDirection = startJoinDirection;\n		currNormal = prevNormal;\n		currTangent = prevTangent;\n	}\n\n	tangent = currTangent;\n\n	//calculate join shifts relative to normals\n	float startJoinShift = dot(currNormal, startJoinDirection);\n	float endJoinShift = dot(currNormal, endJoinDirection);\n\n	float startMiterRatio = abs(1. / startJoinShift);\n	float endMiterRatio = abs(1. / endJoinShift);\n\n	vec2 startJoin = startJoinDirection * startMiterRatio;\n	vec2 endJoin = endJoinDirection * endMiterRatio;\n\n	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n	startTopJoin = sign(startJoinShift) * startJoin * .5;\n	startBotJoin = -startTopJoin;\n\n	endTopJoin = sign(endJoinShift) * endJoin * .5;\n	endBotJoin = -endTopJoin;\n\n	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n	//miter anti-clipping\n	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n	//prevent close to reverse direction switch\n	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n	if (prevReverse) {\n		//make join rectangular\n		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n	}\n	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n		//handle miter clipping\n		bTopCoord -= normalWidth * endTopJoin;\n		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n	}\n\n	if (nextReverse) {\n		//make join rectangular\n		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n	}\n	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n		//handle miter clipping\n		aBotCoord -= normalWidth * startBotJoin;\n		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n	}\n\n	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n	//position is normalized 0..1 coord on the screen\n	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n	enableStartMiter = step(dot(currTangent, prevTangent), .5);\n	enableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n	//bevel miter cutoffs\n	if (miterMode == 1.) {\n		if (enableStartMiter == 1.) {\n			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n			startCutoff = vec4(aCoord, aCoord);\n			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			startCutoff += viewport.xyxy;\n			startCutoff += startMiterWidth.xyxy;\n		}\n\n		if (enableEndMiter == 1.) {\n			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n			endCutoff = vec4(bCoord, bCoord);\n			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			endCutoff += viewport.xyxy;\n			endCutoff += endMiterWidth.xyxy;\n		}\n	}\n\n	//round miter cutoffs\n	else if (miterMode == 2.) {\n		if (enableStartMiter == 1.) {\n			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n			startCutoff = vec4(aCoord, aCoord);\n			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			startCutoff += viewport.xyxy;\n			startCutoff += startMiterWidth.xyxy;\n		}\n\n		if (enableEndMiter == 1.) {\n			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n			endCutoff = vec4(bCoord, bCoord);\n			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			endCutoff += viewport.xyxy;\n			endCutoff += endMiterWidth.xyxy;\n		}\n	}\n}\n"]),frag:j(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n	vec2 diff = b - a;\n	vec2 perp = normalize(vec2(-diff.y, diff.x));\n	return dot(p - a, perp);\n}\n\nvoid main() {\n	float alpha = 1., distToStart, distToEnd;\n	float cutoff = thickness * .5;\n\n	//bevel miter\n	if (miterMode == 1.) {\n		if (enableStartMiter == 1.) {\n			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n			if (distToStart < -1.) {\n				discard;\n				return;\n			}\n			alpha *= min(max(distToStart + 1., 0.), 1.);\n		}\n\n		if (enableEndMiter == 1.) {\n			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n			if (distToEnd < -1.) {\n				discard;\n				return;\n			}\n			alpha *= min(max(distToEnd + 1., 0.), 1.);\n		}\n	}\n\n	// round miter\n	else if (miterMode == 2.) {\n		if (enableStartMiter == 1.) {\n			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n			if (distToStart < 0.) {\n				float radius = length(gl_FragCoord.xy - startCoord);\n\n				if(radius > cutoff + .5) {\n					discard;\n					return;\n				}\n\n				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n			}\n		}\n\n		if (enableEndMiter == 1.) {\n			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n			if (distToEnd < 0.) {\n				float radius = length(gl_FragCoord.xy - endCoord);\n\n				if(radius > cutoff + .5) {\n					discard;\n					return;\n				}\n\n				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n			}\n		}\n	}\n\n	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n	float dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n	gl_FragColor = fragColor;\n	gl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:c,divisor:0,stride:8,offset:0},lineTop:{buffer:c,divisor:0,stride:8,offset:4},aColor:{buffer:a.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:a.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:a.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},b))}catch(f){d=e}return{fill:a({primitive:"triangle",elements:function(b,a){return a.triangles},offset:0,vert:j(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n	vec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n	fragColor = color / 255.;\n	fragColor.a *= opacity;\n}\n"]),frag:j(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n	gl_FragColor = fragColor;\n}\n"]),uniforms:{scale:a.prop("scale"),color:a.prop("fill"),scaleFract:a.prop("scaleFract"),translateFract:a.prop("translateFract"),translate:a.prop("translate"),opacity:a.prop("opacity"),pixelRatio:a.context("pixelRatio"),id:a.prop("id"),viewport:function(a,b){return[b.viewport.x,b.viewport.y,a.viewportWidth,a.viewportHeight]}},attributes:{position:{buffer:a.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:a.prop("positionFractBuffer"),stride:8,offset:8}},blend:b.blend,depth:{enable:!1},scissor:b.scissor,stencil:b.stencil,viewport:b.viewport}),rect:e,miter:d}},a.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},a.prototype.render=function(){for(var c,a=[],b=arguments.length;b--;)a[b]=arguments[b];a.length&&(c=this).update.apply(c,a),this.draw()},a.prototype.draw=function(){for(var d=this,b=[],c=arguments.length;c--;)b[c]=arguments[c];return(b.length?b:this.passes).forEach(function(b,e){var c;if(b&&Array.isArray(b))return(c=d).draw.apply(c,b);"number"==typeof b&&(b=d.passes[b]),b&&b.count>1&&b.opacity&&(d.regl._refresh(),b.fill&&b.triangles&&b.triangles.length>2&&d.shaders.fill(b),b.thickness&&(b.scale[0]*b.viewport.width>a.precisionThreshold||b.scale[1]*b.viewport.height>a.precisionThreshold?d.shaders.rect(b):"rect"===b.join|| !b.join&&(b.thickness<=2||b.count>=a.maxPoints)?d.shaders.rect(b):d.shaders.miter(b)))}),this},a.prototype.update=function(b){var j=this;if(b){null!=b.length?"number"==typeof b[0]&&(b=[{positions:b}]):Array.isArray(b)||(b=[b]);var s=this.regl,t=this.gl;if(b.forEach(function(c,x){var b=j.passes[x];if(void 0!==c){if(null===c){j.passes[x]=null;return}if("number"==typeof c[0]&&(c={positions:c}),c=k(c,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),b||(j.passes[x]=b={id:x,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:s.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:s.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:s.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:s.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},c=i({},a.defaults,c)),null!=c.thickness&&(b.thickness=parseFloat(c.thickness)),null!=c.opacity&&(b.opacity=parseFloat(c.opacity)),null!=c.miterLimit&&(b.miterLimit=parseFloat(c.miterLimit)),null!=c.overlay&&(b.overlay=!!c.overlay,x<a.maxLines&&(b.depth=2*(a.maxLines-1-x%a.maxLines)/a.maxLines-1)),null!=c.join&&(b.join=c.join),null!=c.hole&&(b.hole=c.hole),null!=c.fill&&(b.fill=c.fill?g(c.fill,"uint8"):null),null!=c.viewport&&(b.viewport=q(c.viewport)),b.viewport||(b.viewport=q([t.drawingBufferWidth,t.drawingBufferHeight])),null!=c.close&&(b.close=c.close),null===c.positions&&(c.positions=[]),c.positions){if(c.positions.x&&c.positions.y){var e,d,V=c.positions.x,W=c.positions.y;d=b.count=Math.max(V.length,W.length),e=new Float64Array(2*d);for(var y=0;y<d;y++)e[2*y]=V[y],e[2*y+1]=W[y]}else e=l(c.positions,"float64"),d=b.count=Math.floor(e.length/2);var ab=b.bounds=h(e,2);if(b.fill){for(var O=[],v={},H=0,z=0,X=0,ac=b.count;z<ac;z++){var I=e[2*z],J=e[2*z+1];isNaN(I)||isNaN(J)||null==I||null==J?(I=e[2*H],J=e[2*H+1],v[z]=H):H=z,O[X++]=I,O[X++]=J}if(c.splitNull){b.count-1 in v||(v[b.count]=b.count-1);var K=Object.keys(v).map(Number).sort(function(a,b){return a-b}),B=[],ao=0,Y=null!=b.hole?b.hole[0]:null;if(null!=Y){var ad=r(K,function(a){return a>=Y});(K=K.slice(0,ad)).push(Y)}for(var ae=function(c){var a=m(O.slice(2*ao,2*K[c]).concat(Y?O.slice(2*Y):[]),(b.hole||[]).map(function(a){return a-Y+(K[c]-ao)}));a=a.map(function(a){return a+ao+(a+ao<K[c]?0:Y-K[c])}),B.push.apply(B,a),ao=K[c]+1},P=0;P<K.length;P++)ae(P);for(var C=0,af=B.length;C<af;C++)null!=v[B[C]]&&(B[C]=v[B[C]]);b.triangles=B}else{for(var D=m(O,b.hole||[]),E=0,ag=D.length;E<ag;E++)null!=v[D[E]]&&(D[E]=v[D[E]]);b.triangles=D}}var u=new Float64Array(e);n(u,2,ab);var f=new Float64Array(2*d+6);b.close?e[0]===e[2*d-2]&&e[1]===e[2*d-1]?(f[0]=u[2*d-4],f[1]=u[2*d-3]):(f[0]=u[2*d-2],f[1]=u[2*d-1]):(f[0]=u[0],f[1]=u[1]),f.set(u,2),b.close?e[0]===e[2*d-2]&&e[1]===e[2*d-1]?(f[2*d+2]=u[2],f[2*d+3]=u[3],b.count-=1):(f[2*d+2]=u[0],f[2*d+3]=u[1],f[2*d+4]=u[2],f[2*d+5]=u[3]):(f[2*d+2]=u[2*d-2],f[2*d+3]=u[2*d-1],f[2*d+4]=u[2*d-2],f[2*d+5]=u[2*d-1]);var Z=o(f);b.positionBuffer(Z);var ah=p(f,Z);b.positionFractBuffer(ah)}if(c.range?b.range=c.range:b.range||(b.range=b.bounds),(c.range||c.positions)&&b.count){var A=b.bounds,ai=A[2]-A[0],aj=A[3]-A[1],Q=b.range[2]-b.range[0],R=b.range[3]-b.range[1];b.scale=[ai/Q,aj/R],b.translate=[-b.range[0]/Q+A[0]/Q||0,-b.range[1]/R+A[1]/R||0],b.scaleFract=p(b.scale),b.translateFract=p(b.translate)}if(c.dashes){var F,G=0;if(!c.dashes||c.dashes.length<2)G=1,F=new Uint8Array([255,255,255,255,255,255,255,255]);else{G=0;for(var S=0;S<c.dashes.length;++S)G+=c.dashes[S];F=new Uint8Array(G*a.dashMult);for(var ak=0,$=255,_=0;_<2;_++)for(var T=0;T<c.dashes.length;++T){for(var aa=0,al=c.dashes[T]*a.dashMult*.5;aa<al;++aa)F[ak++]=$;$^=255}}b.dashLength=G,b.dashTexture({channels:1,data:F,width:F.length,height:1,mag:"linear",min:"linear"},0,0)}if(c.color){var L=b.count,w=c.color;w||(w="transparent");var M=new Uint8Array(4*L+4);if(Array.isArray(w)&&"number"!=typeof w[0]){for(var N=0;N<L;N++){var am=g(w[N],"uint8");M.set(am,4*N)}M.set(g(w[0],"uint8"),4*L)}else for(var an=g(w,"uint8"),U=0;U<L+1;U++)M.set(an,4*U);b.colorBuffer({usage:"dynamic",type:"uint8",data:M})}}}),b.length<this.passes.length){for(var e=b.length;e<this.passes.length;e++){var c=this.passes[e];c&&(c.colorBuffer.destroy(),c.positionBuffer.destroy(),c.dashTexture.destroy())}this.passes.length=b.length}for(var f=[],d=0;d<this.passes.length;d++)null!==this.passes[d]&&f.push(this.passes[d]);return this.passes=f,this}},a.prototype.destroy=function(){return this.passes.forEach(function(a){a.colorBuffer.destroy(),a.positionBuffer.destroy(),a.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(a,c,d){"use strict";function e(a,b){return h(a)||j(a,b)||k(a,b)||n()}function f(a){return g(a)||i(a)||k(a)||m()}function g(a){if(Array.isArray(a))return l(a)}function h(a){if(Array.isArray(a))return a}function i(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function j(b,e){var f,g,a=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=a){var c=[],d=!0,h=!1;try{for(a=a.call(b);!(d=(f=a.next()).done)&&(c.push(f.value),!e||c.length!==e);d=!0);}catch(i){h=!0,g=i}finally{try{d||null==a.return||a.return()}finally{if(h)throw g}}return c}}function k(a,c){if(a){if("string"==typeof a)return l(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);if("Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b)return Array.from(a);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return l(a,c)}}function l(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=a("color-normalize"),p=a("array-bounds"),q=a("color-id"),r=a("@plotly/point-cluster"),s=a("object-assign"),t=a("glslify"),u=a("pick-by-alias"),v=a("update-diff"),w=a("flatten-vertex-data"),x=a("is-iexplorer"),y=a("to-float32"),z=a("parse-rect"),A=b;function b(a,c){var p=this;if(!(this instanceof b))return new b(a,c);"function"==typeof a?(c||(c={}),c.regl=a):(c=a,a=null),c&&c.length&&(c.positions=c);var f,h=(a=c.regl)._gl,j=[],k={},l=[],m=[null],n=[null],g=255,o=100;this.tooManyColors=x,f=a.texture({data:new Uint8Array(4*g),width:g,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),s(this,{regl:a,gl:h,groups:l,markerCache:n,markerTextures:m,palette:j,paletteIds:k,paletteTexture:f,maxColors:g,maxSize:o,canvas:h.canvas}),this.update(c);var i={uniforms:{constPointSize:!!c.constPointSize,opacity:a.prop("opacity"),paletteSize:function(a,b){return[p.tooManyColors?0:g,f.height]},pixelRatio:a.context("pixelRatio"),scale:a.prop("scale"),scaleFract:a.prop("scaleFract"),translate:a.prop("translate"),translateFract:a.prop("translateFract"),markerTexture:a.prop("markerTexture"),paletteTexture:f},attributes:{x:function(b,a){return a.xAttr||{buffer:a.positionBuffer,stride:8,offset:0}},y:function(b,a){return a.yAttr||{buffer:a.positionBuffer,stride:8,offset:4}},xFract:function(b,a){return a.xAttr?{constant:[0,0]}:{buffer:a.positionFractBuffer,stride:8,offset:0}},yFract:function(b,a){return a.yAttr?{constant:[0,0]}:{buffer:a.positionFractBuffer,stride:8,offset:4}},size:function(b,a){return a.size.length?{buffer:a.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*a.size/p.maxSize)]}},borderSize:function(b,a){return a.borderSize.length?{buffer:a.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*a.borderSize/p.maxSize)]}},colorId:function(b,a){return a.color.length?{buffer:a.colorBuffer,stride:p.tooManyColors?8:4,offset:0}:{constant:p.tooManyColors?j.slice(4*a.color,4*a.color+4):[a.color]}},borderColorId:function(b,a){return a.borderColor.length?{buffer:a.colorBuffer,stride:p.tooManyColors?8:4,offset:p.tooManyColors?4:2}:{constant:p.tooManyColors?j.slice(4*a.borderColor,4*a.borderColor+4):[a.borderColor]}},isActive:function(b,a){return!0===a.activation?{constant:[1]}:a.activation?a.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:a.prop("viewport")},viewport:a.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:a.prop("elements"),count:a.prop("count"),offset:a.prop("offset"),primitive:"points"},d=s({},i);d.frag=t(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\nuniform sampler2D markerTexture;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),d.vert=t(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=a(d);var e=s({},i);e.frag=t(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nuniform float opacity;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n	float t;\n	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n	return t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n	float radius, alpha = 1.0, delta = fragWidth;\n\n	radius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n	if (radius > 1.0 + delta) {\n		discard;\n	}\n\n	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n	float borderRadius = fragBorderRadius;\n	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n	vec4 color = mix(fragColor, fragBorderColor, ratio);\n	color.a *= alpha * opacity;\n	gl_FragColor = color;\n}\n"]),e.vert=t(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 paletteSize, scale, scaleFract, translate, translateFract;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),x&&(e.frag=e.frag.replace("smoothstep","smoothStep"),d.frag=d.frag.replace("smoothstep","smoothStep")),this.drawCircle=a(e)}b.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},b.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},b.prototype.draw=function(){for(var f=this,d=arguments.length,a=new Array(d),b=0;b<d;b++)a[b]=arguments[b];var e=this.groups;if(1===a.length&&Array.isArray(a[0])&&(null===a[0][0]||Array.isArray(a[0][0]))&&(a=a[0]),this.regl._refresh(),a.length)for(var c=0;c<a.length;c++)this.drawItem(c,a[c]);else e.forEach(function(b,a){f.drawItem(a)});return this},b.prototype.drawItem=function(e,b){var g=this.groups,a=g[e];if("number"==typeof b&&(e=b,a=g[b],b=null),a&&a.count&&a.opacity){a.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,a,b));for(var d=[],c=1;c<a.activation.length;c++)a.activation[c]&&(!0===a.activation[c]||a.activation[c].data.length)&&d.push.apply(d,f(this.getMarkerDrawOptions(c,a,b)));d.length&&this.drawMarker(d)}},b.prototype.getMarkerDrawOptions=function(b,a,c){var d=a.range,h=a.tree,i=a.viewport,f=a.activation,j=a.selectionBuffer,t=a.count;if(this.regl,!h)return c?[s({},a,{markerTexture:this.markerTextures[b],activation:f[b],count:c.length,elements:c,offset:0})]:[s({},a,{markerTexture:this.markerTextures[b],activation:f[b],offset:0})];var k=[],l=h.range(d,{lod:!0,px:[(d[2]-d[0])/i.width,(d[3]-d[1])/i.height]});if(c){for(var m=f[b].data,n=new Uint8Array(t),g=0;g<c.length;g++){var o=c[g];n[o]=m?m[o]:1}j.subdata(n)}for(var p=l.length;p--;){var q=e(l[p],2),r=q[0],u=q[1];k.push(s({},a,{markerTexture:this.markerTextures[b],activation:c?j:f[b],offset:r,count:u-r}))}return k},b.prototype.update=function(){for(var f=this,d=arguments.length,a=new Array(d),c=0;c<d;c++)a[c]=arguments[c];if(a.length){1===a.length&&Array.isArray(a[0])&&(a=a[0]);var e=this.groups,g=this.gl,h=this.regl,i=this.maxSize,j=this.maxColors,k=this.palette;this.groups=e=a.map(function(a,F){var m=e[F];if(void 0===a)return m;null===a?a={positions:null}:"function"==typeof a?a={ondraw:a}:"number"==typeof a[0]&&(a={positions:a}),null===(a=u(a,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(a.positions=[]),null!=a.tooManyColors&&(f.tooManyColors=a.tooManyColors),m||(e[F]=m={id:F,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:h.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:h.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},a=s({},b.defaults,a)),!a.positions||"marker"in a||(a.marker=m.marker,delete m.marker),!a.marker||"positions"in a||(a.positions=m.positions,delete m.positions);var I=0,J=0;if(v(m,a,[{snap:!0,size:function(a,c){return null==a&&(a=b.defaults.size),I+=a&&a.length?1:0,a},borderSize:function(a,c){return null==a&&(a=b.defaults.borderSize),I+=a&&a.length?1:0,a},opacity:parseFloat,color:function(a,c){return null==a&&(a=b.defaults.color),a=f.updateColor(a),J++,a},borderColor:function(a,c){return null==a&&(a=b.defaults.borderColor),a=f.updateColor(a),J++,a},bounds:function(b,c,a){return"range"in a||(a.range=null),b},positions:function(a,b,d){var c=b.snap,j=b.positionBuffer,k=b.positionFractBuffer,l=b.selectionBuffer;if(a.x||a.y)return a.x.length?b.xAttr={buffer:h.buffer(a.x),offset:0,stride:4,count:a.x.length}:b.xAttr={buffer:a.x.buffer,offset:4*a.x.offset||0,stride:4*(a.x.stride||1),count:a.x.count},a.y.length?b.yAttr={buffer:h.buffer(a.y),offset:0,stride:4,count:a.y.length}:b.yAttr={buffer:a.y.buffer,offset:4*a.y.offset||0,stride:4*(a.y.stride||1),count:a.y.count},b.count=Math.max(b.xAttr.count,b.yAttr.count),a;a=w(a,"float64");var e=b.count=Math.floor(a.length/2),f=b.bounds=e?p(a,2):null;if(d.range||b.range||(delete b.range,d.range=f),d.marker||b.marker||(delete b.marker,d.marker=null),c&&(!0===c||e>c)?b.tree=r(a,{bounds:f}):c&&c.length&&(b.tree=c),b.tree){var g={primitive:"points",usage:"static",data:b.tree,type:"uint32"};b.elements?b.elements(g):b.elements=h.elements(g)}var i=y.float32(a);return j({data:i,usage:"dynamic"}),k({data:y.fract32(a,i),usage:"dynamic"}),l({data:new Uint8Array(e),type:"uint8",usage:"stream"}),a}},{marker:function(d,g,l){var b=g.activation;if(b.forEach(function(a){return a&&a.destroy&&a.destroy()}),b.length=0,d&&"number"!=typeof d[0]){for(var c=[],e=0,k=Math.min(d.length,g.count);e<k;e++){var i=f.addMarker(d[e]);c[i]||(c[i]=new Uint8Array(g.count)),c[i][e]=1}for(var a=0;a<c.length;a++)if(c[a]){var j={data:c[a],type:"uint8",usage:"static"};b[a]?b[a](j):b[a]=h.buffer(j),b[a].data=c[a]}}else b[f.addMarker(d)]=!0;return d},range:function(a,b,d){var c=b.bounds;if(c)return a||(a=c),b.scale=[1/(a[2]-a[0]),1/(a[3]-a[1])],b.translate=[-a[0],-a[1]],b.scaleFract=y.fract(b.scale),b.translateFract=y.fract(b.translate),a},viewport:function(a){return z(a||[g.drawingBufferWidth,g.drawingBufferHeight])}}]),I){var t=m,H=t.count,x=t.size,A=t.borderSize,K=t.sizeBuffer,G=new Uint8Array(2*H);if(x.length||A.length)for(var n=0;n<H;n++)G[2*n]=Math.round((null==x[n]?x:x[n])*255/i),G[2*n+1]=Math.round((null==A[n]?A:A[n])*255/i);K({data:G,usage:"dynamic"})}if(J){var c,B=m,C=B.count,o=B.color,q=B.borderColor,L=B.colorBuffer;if(f.tooManyColors){if(o.length||q.length){c=new Uint8Array(8*C);for(var d=0;d<C;d++){var D=o[d];c[8*d]=k[4*D],c[8*d+1]=k[4*D+1],c[8*d+2]=k[4*D+2],c[8*d+3]=k[4*D+3];var E=q[d];c[8*d+4]=k[4*E],c[8*d+5]=k[4*E+1],c[8*d+6]=k[4*E+2],c[8*d+7]=k[4*E+3]}}}else if(o.length||q.length){c=new Uint8Array(4*C+2);for(var l=0;l<C;l++)null!=o[l]&&(c[4*l]=o[l]%j,c[4*l+1]=Math.floor(o[l]/j)),null!=q[l]&&(c[4*l+2]=q[l]%j,c[4*l+3]=Math.floor(q[l]/j))}L({data:c||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return m})}},b.prototype.addMarker=function(a){var b,e=this.markerTextures,g=this.regl,f=this.markerCache,c=null==a?0:f.indexOf(a);if(c>=0)return c;if(a instanceof Uint8Array||a instanceof Uint8ClampedArray)b=a;else{b=new Uint8Array(a.length);for(var d=0,h=a.length;d<h;d++)b[d]=255*a[d]}var i=Math.floor(Math.sqrt(b.length));return c=e.length,f.push(a),e.push(g.texture({channels:1,data:b,radius:i,mag:"linear",min:"linear"})),c},b.prototype.updateColor=function(a){var i=this.paletteIds,b=this.palette,l=this.maxColors;Array.isArray(a)||(a=[a]);var e=[];if("number"==typeof a[0]){var j=[];if(Array.isArray(a))for(var f=0;f<a.length;f+=4)j.push(a.slice(f,f+4));else for(var g=0;g<a.length;g+=4)j.push(a.subarray(g,g+4));a=j}for(var h=0;h<a.length;h++){var c=a[h],k=q(c=o(c,"uint8"),!1);if(null==i[k]){var d=b.length;i[k]=Math.floor(d/4),b[d]=c[0],b[d+1]=c[1],b[d+2]=c[2],b[d+3]=c[3]}e[h]=i[k]}return!this.tooManyColors&&b.length>4*l&&(this.tooManyColors=!0),this.updatePalette(b),1===e.length?e[0]:e},b.prototype.updatePalette=function(a){if(!this.tooManyColors){var b=this.maxColors,d=this.paletteTexture,c=Math.ceil(.25*a.length/b);if(c>1){a=a.slice();for(var e=.25*a.length%b;e<c*b;e++)a.push(0,0,0,0)}d.height<c&&d.resize(b,c),d.subimage({width:Math.min(.25*a.length,b),height:c,data:a},0,0)}},b.prototype.destroy=function(){return this.groups.forEach(function(a){a.sizeBuffer.destroy(),a.positionBuffer.destroy(),a.positionFractBuffer.destroy(),a.colorBuffer.destroy(),a.activation.forEach(function(a){return a&&a.destroy&&a.destroy()}),a.selectionBuffer.destroy(),a.elements&&a.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(a){return a&&a.destroy&&a.destroy()}),this};var B=a("object-assign");c.exports=function(c,d){var a=new A(c,d),b=a.render.bind(a);return B(b,{render:b,update:a.update.bind(a),draw:a.draw.bind(a),destroy:a.destroy.bind(a),regl:a.regl,gl:a.gl,canvas:a.gl.canvas,groups:a.groups,markers:a.markerCache,palette:a.palette}),b}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(a,c,d){"use strict";var e=a("regl-scatter2d"),f=a("pick-by-alias"),g=a("array-bounds"),h=a("raf"),i=a("array-range"),j=a("parse-rect"),k=a("flatten-vertex-data");function b(a,c){if(!(this instanceof b))return new b(a,c);this.traces=[],this.passes={},this.regl=a,this.scatter=e(a),this.canvas=this.scatter.canvas}function l(a,b,c){return(null!=a.id?a.id:a)<<16|(255&b)<<8|255&c}function m(g,h,i){var c,d,e,f,a=g[h],b=g[i];return a.length>2?(a[0],a[2],c=a[1],d=a[3]):a.length?(c=a[0],d=a[1]):(a.x,c=a.y,a.x+a.width,d=a.y+a.height),b.length>2?(e=b[0],f=b[2],b[1],b[3]):b.length?(e=b[0],f=b[1]):(e=b.x,b.y,f=b.x+b.width,b.y+b.height),[e,c,f,d]}function n(a){if("number"==typeof a)return[a,a,a,a];if(2===a.length)return[a[0],a[1],a[0],a[1]];var b=j(a);return[b.x,b.y,b.x+b.width,b.y+b.height]}c.exports=b,b.prototype.render=function(){for(var c,d=this,a=[],b=arguments.length;b--;)a[b]=arguments[b];return(a.length&&(c=this).update.apply(c,a),this.regl.attributes.preserveDrawingBuffer)?this.draw():(this.dirty?null==this.planned&&(this.planned=h(function(){d.draw(),d.dirty=!0,d.planned=null})):(this.draw(),this.dirty=!0,h(function(){d.dirty=!1})),this)},b.prototype.update=function(){for(var f,a=[],d=arguments.length;d--;)a[d]=arguments[d];if(a.length){for(var b=0;b<a.length;b++)this.updateItem(b,a[b]);this.traces=this.traces.filter(Boolean);for(var g=[],h=0,c=0;c<this.traces.length;c++){for(var i=this.traces[c],j=this.traces[c].passes,e=0;e<j.length;e++)g.push(this.passes[j[e]]);i.passOffset=h,h+=i.passes.length}return(f=this.scatter).update.apply(f,g),this}},b.prototype.updateItem=function(p,w){var B,x=this.regl;if(null===w)return this.traces[p]=null,this;if(!w)return this;var b=f(w,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),a=this.traces[p]||(this.traces[p]={id:p,buffer:x.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:j([x._gl.drawingBufferWidth,x._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=b.color&&(a.color=b.color),null!=b.size&&(a.size=b.size),null!=b.marker&&(a.marker=b.marker),null!=b.borderColor&&(a.borderColor=b.borderColor),null!=b.borderSize&&(a.borderSize=b.borderSize),null!=b.opacity&&(a.opacity=b.opacity),b.viewport&&(a.viewport=j(b.viewport)),null!=b.diagonal&&(a.diagonal=b.diagonal),null!=b.upper&&(a.upper=b.upper),null!=b.lower&&(a.lower=b.lower),b.data){a.buffer(k(b.data)),a.columns=b.data.length,a.count=b.data[0].length,a.bounds=[];for(var q=0;q<a.columns;q++)a.bounds[q]=g(b.data[q],1)}b.range&&(a.range=b.range,B=a.range&&"number"!=typeof a.range[0]),b.domain&&(a.domain=b.domain);var C=!1;null!=b.padding&&(Array.isArray(b.padding)&&b.padding.length===a.columns&&"number"==typeof b.padding[b.padding.length-1]?(a.padding=b.padding.map(n),C=!0):a.padding=n(b.padding));var i=a.columns,o=a.count,y=a.viewport.width,z=a.viewport.height,r=a.viewport.x,s=a.viewport.y,t=y/i,u=z/i;a.passes=[];for(var c=0;c<i;c++)for(var d=0;d<i;d++)if((a.diagonal||d!==c)&&(a.upper||!(c>d))&&(a.lower||!(c<d))){var A=l(a.id,c,d),e=this.passes[A]||(this.passes[A]={});if(b.data&&(b.transpose?e.positions={x:{buffer:a.buffer,offset:d,count:o,stride:i},y:{buffer:a.buffer,offset:c,count:o,stride:i}}:e.positions={x:{buffer:a.buffer,offset:d*o,count:o},y:{buffer:a.buffer,offset:c*o,count:o}},e.bounds=m(a.bounds,c,d)),b.domain||b.viewport||b.data){var h=C?m(a.padding,c,d):a.padding;if(a.domain){var v=m(a.domain,c,d),D=v[0],E=v[1],F=v[2],G=v[3];e.viewport=[r+D*y+h[0],s+E*z+h[1],r+F*y-h[2],s+G*z-h[3]]}else e.viewport=[r+d*t+t*h[0],s+c*u+u*h[1],r+(d+1)*t-t*h[2],s+(c+1)*u-u*h[3]]}b.color&&(e.color=a.color),b.size&&(e.size=a.size),b.marker&&(e.marker=a.marker),b.borderSize&&(e.borderSize=a.borderSize),b.borderColor&&(e.borderColor=a.borderColor),b.opacity&&(e.opacity=a.opacity),b.range&&(e.range=B?m(a.range,c,d):a.range||e.bounds),a.passes.push(A)}return this},b.prototype.draw=function(){for(var e,a=[],c=arguments.length;c--;)a[c]=arguments[c];if(a.length){for(var d=[],b=0;b<a.length;b++)if("number"==typeof a[b]){var f=this.traces[a[b]],k=f.passes,g=f.passOffset;d.push.apply(d,i(g,g+k.length))}else if(a[b].length){var l=a[b],h=this.traces[b],j=h.passes,m=h.passOffset;j=j.map(function(b,a){d[m+a]=l})}(e=this.scatter).draw.apply(e,d)}else this.scatter.draw();return this},b.prototype.destroy=function(){return this.traces.forEach(function(a){a.buffer&&a.buffer.destroy&&a.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(b,c,d){!function(e,b){"object"==typeof d&& void 0!==c?c.exports=b():"function"==typeof a&&a.amd?a(b):e.createREGL=b()}(this,function(){function k(a,b){this.id=aa++,this.type=a,this.data=b}function x(a){if(0===a.length)return[];var b=a.charAt(0),c=a.charAt(a.length-1);if(1<a.length&&b===c&&('"'===b||"'"===b))return['"'+a.substr(1,a.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(b=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(a))return x(a.substr(0,b.index)).concat(x(b[1])).concat(x(a.substr(b.index+b[0].length)));if(1===(b=a.split(".")).length)return['"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(c=0,a=[];c<b.length;++c)a=a.concat(x(b[c]));return a}function l(a){return"["+x(a).join("][")+"]"}function m(a,b){return"function"==typeof a?new k(0,a):"number"==typeof a||"boolean"==typeof a?new k(5,a):Array.isArray(a)?new k(6,a.map(function(a,c){return m(a,b+"["+c+"]")})):a instanceof k?a:void 0}function y(a){return"string"==typeof a?a.split():a}function z(a){return"string"==typeof a?document.querySelector(a):a}function A(b,d){for(var c=Array(b),a=0;a<b;++a)c[a]=d(a);return c}function B(a){var c,b;return a>>>=c=(65535<a)<<4,a>>>=b=(255<a)<<3,c|=b,b=(15<a)<<2,a>>>=b,c|=b,b=(3<a)<<1,c|b|a>>>b>>1}function h(){function a(b){a:{for(var a=16;268435456>=a;a*=16)if(b<=a){b=a;break a}b=0}return 0<(a=c[B(b)>>2]).length?a.pop():new ArrayBuffer(b)}function b(a){c[B(a.byteLength)>>2].push(a)}var c=A(8,function(){return[]});return{alloc:a,free:b,allocType:function(d,b){var c=null;switch(d){case 5120:c=new Int8Array(a(b),0,b);break;case 5121:c=new Uint8Array(a(b),0,b);break;case 5122:c=new Int16Array(a(2*b),0,b);break;case 5123:c=new Uint16Array(a(2*b),0,b);break;case 5124:c=new Int32Array(a(4*b),0,b);break;case 5125:c=new Uint32Array(a(4*b),0,b);break;case 5126:c=new Float32Array(a(4*b),0,b);break;default:return null}return c.length!==b?c.subarray(0,b):c},freeType:function(a){b(a.buffer)}}}function C(a){return!!a&&"object"==typeof a&&Array.isArray(a.shape)&&Array.isArray(a.stride)&&"number"==typeof a.offset&&a.shape.length===a.stride.length&&(Array.isArray(a.data)||af(a.data))}function D(d,e,f,g,h,i){for(var a=0;a<e;++a)for(var j=d[a],b=0;b<f;++b)for(var k=j[b],c=0;c<g;++c)h[i++]=k[c]}function E(f,b,c,g,d){for(var e=1,a=c+1;a<b.length;++a)e*=b[a];var h=b[c];if(4==b.length-c){var i=b[c+1],j=b[c+2];for(a=0,b=b[c+3];a<h;++a)D(f[a],i,j,b,g,d),d+=e}else for(a=0;a<h;++a)E(f[a],b,c+1,g,d),d+=e}function F(a){return 0|p[Object.prototype.toString.call(a)]}function G(c,b){for(var a=0;a<b.length;++a)c[a]=b[a]}function H(c,d,e,f,g,h,i){for(var j=0,a=0;a<e;++a)for(var b=0;b<f;++b)c[j++]=d[g*a+h*b+i]}function I(b){for(var d=o.allocType(5123,b.length),a=0;a<b.length;++a)if(isNaN(b[a]))d[a]=65535;else if(1/0===b[a])d[a]=31744;else if(-1/0===b[a])d[a]=64512;else{q[0]=b[a];var c=am[0],f=c>>>31<<15,e=(c<<1>>>24)-127,c=c>>13&1023;d[a]=-24>e?f:-14>e?f+(c+1024>> -14-e):15<e?f+31744:f+(e+15<<10)+c}return d}function J(a){return Array.isArray(a)||af(a)}function e(a){return"[object "+a+"]"}function K(a){return Array.isArray(a)&&(0===a.length||"number"==typeof a[0])}function L(a){return!!(Array.isArray(a)&&0!==a.length&&J(a[0]))}function M(a){return Object.prototype.toString.call(a)}function N(a){if(!a)return!1;var b=M(a);return 0<=ap.indexOf(b)||K(a)||L(a)||C(a)}function O(a,b){36193===a.type?(a.data=I(b),o.freeType(b)):a.data=b}function P(b,g,d,e,h,i){if(b=void 0!==a[b]?a[b]:c[b]*f[g],i&&(b*=6),h){for(e=0;1<=d;)e+=b*d*d,d/=2;return e}return b*d*e}function Q(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function R(a,b){return a>>>b|a<<32-b}function S(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c}function T(a){return Array.prototype.slice.call(a)}function U(a){return T(a).join("")}function V(a){return Array.isArray(a)||af(a)||C(a)}function W(a){return a.sort(function(a,b){return"viewport"===a?-1:"viewport"===b?1:a<b?-1:1})}function n(a,b,c,d){this.thisDep=a,this.contextDep=b,this.propDep=c,this.append=d}function X(a){return a&&!(a.thisDep||a.contextDep||a.propDep)}function Y(a){return new n(!1,!1,!1,a)}function Z(c,d){var a=c.type;if(0===a)return a=c.data.length,new n(!0,1<=a,2<=a,d);if(4===a)return a=c.data,new n(a.thisDep,a.contextDep,a.propDep,d);if(5===a)return new n(!1,!1,!1,d);if(6===a){for(var e=a=!1,f=!1,g=0;g<c.data.length;++g){var b=c.data[g];1===b.type?f=!0:2===b.type?e=!0:3===b.type?a=!0:0===b.type?(a=!0,1<=(b=b.data)&&(e=!0),2<=b&&(f=!0)):4===b.type&&(a=a||b.data.thisDep,e=e||b.data.contextDep,f=f||b.data.propDep)}return new n(a,e,f,d)}return new n(3===a,2===a,1===a,d)}function $(b,c){for(var a=0;a<b.length;++a)if(b[a]===c)return a;return -1}var _=function(c,d){for(var b=Object.keys(d),a=0;a<b.length;++a)c[b[a]]=d[b[a]];return c},aa=0,ab={DynamicVariable:k,define:function(a,b){return new k(a,l(b+""))},isDynamic:function(a){return"function"==typeof a&&!a._reglType||a instanceof k},unbox:m,accessor:l},ac={next:"function"==typeof requestAnimationFrame?function(a){return requestAnimationFrame(a)}:function(a){return setTimeout(a,16)},cancel:"function"==typeof cancelAnimationFrame?function(a){return cancelAnimationFrame(a)}:clearTimeout},ad="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},o=h();o.zero=h();var ae=function(a,e){var f=1;e.ext_texture_filter_anisotropic&&(f=a.getParameter(34047));var g=1,h=1;e.webgl_draw_buffers&&(g=a.getParameter(34852),h=a.getParameter(36063));var b=!!e.oes_texture_float;if(b){b=a.createTexture(),a.bindTexture(3553,b),a.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var d=a.createFramebuffer();if(a.bindFramebuffer(36160,d),a.framebufferTexture2D(36160,36064,3553,b,0),a.bindTexture(3553,null),36053!==a.checkFramebufferStatus(36160))b=!1;else{a.viewport(0,0,1,1),a.clearColor(1,0,0,1),a.clear(16384);var c=o.allocType(5126,4);a.readPixels(0,0,1,1,6408,5126,c),a.getError()?b=!1:(a.deleteFramebuffer(d),a.deleteTexture(b),b=1===c[0]),o.freeType(c)}}return c=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(c=a.createTexture(),d=o.allocType(5121,36),a.activeTexture(33984),a.bindTexture(34067,c),a.texImage2D(34069,0,6408,3,3,0,6408,5121,d),o.freeType(d),a.bindTexture(34067,null),a.deleteTexture(c),c=!a.getError()),{colorBits:[a.getParameter(3410),a.getParameter(3411),a.getParameter(3412),a.getParameter(3413)],depthBits:a.getParameter(3414),stencilBits:a.getParameter(3415),subpixelBits:a.getParameter(3408),extensions:Object.keys(e).filter(function(a){return!!e[a]}),maxAnisotropic:f,maxDrawbuffers:g,maxColorAttachments:h,pointSizeDims:a.getParameter(33901),lineWidthDims:a.getParameter(33902),maxViewportDims:a.getParameter(3386),maxCombinedTextureUnits:a.getParameter(35661),maxCubeMapSize:a.getParameter(34076),maxRenderbufferSize:a.getParameter(34024),maxTextureUnits:a.getParameter(34930),maxTextureSize:a.getParameter(3379),maxAttributes:a.getParameter(34921),maxVertexUniforms:a.getParameter(36347),maxVertexTextureUnits:a.getParameter(35660),maxVaryingVectors:a.getParameter(36348),maxFragmentUniforms:a.getParameter(36349),glsl:a.getParameter(35724),renderer:a.getParameter(7937),vendor:a.getParameter(7936),version:a.getParameter(7938),readFloat:b,npotTextureCube:c}},af=function(a){return a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Float32Array||a instanceof Float64Array||a instanceof Uint8ClampedArray},ag=function(a){return Object.keys(a).map(function(b){return a[b]})},i={shape:function(a){for(var b=[];a.length;a=a[0])b.push(a.length);return b},flatten:function(f,a,b,d){var e=1;if(a.length)for(var c=0;c<a.length;++c)e*=a[c];else e=0;switch(b=d||o.allocType(b,e),a.length){case 0:break;case 1:for(d=a[0],a=0;a<d;++a)b[a]=f[a];break;case 2:for(d=a[0],a=a[1],c=e=0;c<d;++c)for(var h=f[c],g=0;g<a;++g)b[e++]=h[g];break;case 3:D(f,a[0],a[1],a[2],b,0);break;default:E(f,a,0,b,0)}return b}},p={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ah={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,"float":5126,float32:5126},ai={dynamic:35048,stream:35040,static:35044},aj=i.flatten,ak=i.shape,d=[];d[5120]=1,d[5122]=2,d[5124]=4,d[5121]=1,d[5123]=2,d[5125]=4,d[5126]=4;var al={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},q=new Float32Array(1),am=new Uint32Array(q.buffer),an=[9984,9986,9985,9987],ao=[0,6409,6410,6407,6408],c={};c[6409]=c[6406]=c[6402]=1,c[34041]=c[6410]=2,c[6407]=c[35904]=3,c[6408]=c[35906]=4;var r=e("HTMLCanvasElement"),s=e("OffscreenCanvas"),t=e("CanvasRenderingContext2D"),u=e("ImageBitmap"),v=e("HTMLImageElement"),w=e("HTMLVideoElement"),ap=Object.keys(p).concat([r,s,t,u,v,w]),f=[];f[5121]=1,f[5126]=4,f[36193]=2,f[5123]=2,f[5125]=4;var a=[];a[32854]=2,a[32855]=2,a[36194]=2,a[34041]=4,a[33776]=.5,a[33777]=.5,a[33778]=1,a[33779]=1,a[35986]=.5,a[35987]=1,a[34798]=1,a[35840]=.5,a[35841]=.25,a[35842]=.5,a[35843]=.25,a[36196]=.5;var b=[];b[32854]=2,b[32855]=2,b[36194]=2,b[33189]=2,b[36168]=1,b[34041]=4,b[35907]=4,b[34836]=16,b[34842]=8,b[34843]=6;var aq=function(g,c,h,d,e){function f(a){this.id=k++,this.refCount=1,this.renderbuffer=a,this.format=32854,this.height=this.width=0,e.profile&&(this.stats={size:0})}function i(a){var b=a.renderbuffer;g.bindRenderbuffer(36161,null),g.deleteRenderbuffer(b),a.renderbuffer=null,a.refCount=0,delete l[a.id],d.renderbufferCount--}var a={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};c.ext_srgb&&(a.srgba=35907),c.ext_color_buffer_half_float&&(a.rgba16f=34842,a.rgb16f=34843),c.webgl_color_buffer_float&&(a.rgba32f=34836);var j=[];Object.keys(a).forEach(function(b){j[a[b]]=b});var k=0,l={};return f.prototype.decRef=function(){0>= --this.refCount&&i(this)},e.profile&&(d.getTotalRenderbufferSize=function(){var a=0;return Object.keys(l).forEach(function(b){a+=l[b].stats.size}),a}),{create:function(i,k){function c(d,l){var i=0,f=0,k=32854;if("object"==typeof d&&d?("shape"in d?(i=0|(f=d.shape)[0],f=0|f[1]):("radius"in d&&(i=f=0|d.radius),"width"in d&&(i=0|d.width),"height"in d&&(f=0|d.height)),"format"in d&&(k=a[d.format])):"number"==typeof d?(i=0|d,f="number"==typeof l?0|l:i):d||(i=f=1),i!==h.width||f!==h.height||k!==h.format)return c.width=h.width=i,c.height=h.height=f,h.format=k,g.bindRenderbuffer(36161,h.renderbuffer),g.renderbufferStorage(36161,k,i,f),e.profile&&(h.stats.size=b[h.format]*h.width*h.height),c.format=j[h.format],c}var h=new f(g.createRenderbuffer());return l[h.id]=h,d.renderbufferCount++,c(i,k),c.resize=function(f,i){var a=0|f,d=0|i||a;return a===h.width&&d===h.height||(c.width=h.width=a,c.height=h.height=d,g.bindRenderbuffer(36161,h.renderbuffer),g.renderbufferStorage(36161,h.format,a,d),e.profile&&(h.stats.size=b[h.format]*h.width*h.height)),c},c._reglType="renderbuffer",c._renderbuffer=h,e.profile&&(c.stats=h.stats),c.destroy=function(){h.decRef()},c},clear:function(){ag(l).forEach(i)},restore:function(){ag(l).forEach(function(a){a.renderbuffer=g.createRenderbuffer(),g.bindRenderbuffer(36161,a.renderbuffer),g.renderbufferStorage(36161,a.format,a.width,a.height)}),g.bindRenderbuffer(36161,null)}}},j=[];j[6408]=4,j[6407]=3;var g=[];g[5121]=1,g[5126]=4,g[36193]=2;var ar=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],as=["x","y","z","w"],at="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),au={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},av={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},aw={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ax={cw:2304,ccw:2305},ay=new n(!1,!1,!1,function(){}),az=function(c,a){function d(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function b(b,c,e){var a=g.pop()||new d;a.startQueryIndex=b,a.endQueryIndex=c,a.sum=0,a.stats=e,h.push(a)}if(!a.ext_disjoint_timer_query)return null;var e=[],f=[],g=[],h=[],i=[],j=[];return{beginQuery:function(d){var c=e.pop()||a.ext_disjoint_timer_query.createQueryEXT();a.ext_disjoint_timer_query.beginQueryEXT(35007,c),f.push(c),b(f.length-1,f.length,d)},endQuery:function(){a.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:b,update:function(){var c,d;if(0!==(c=f.length)){j.length=Math.max(j.length,c+1),i.length=Math.max(i.length,c+1),i[0]=0;var b=j[0]=0;for(d=c=0;d<f.length;++d){var k=f[d];a.ext_disjoint_timer_query.getQueryObjectEXT(k,34919)?(b+=a.ext_disjoint_timer_query.getQueryObjectEXT(k,34918),e.push(k)):f[c++]=k,i[d+1]=b,j[d+1]=c}for(f.length=c,d=c=0;d<h.length;++d){var b=h[d],l=b.startQueryIndex,k=b.endQueryIndex;b.sum+=i[k]-i[l],l=j[l],k=j[k],k===l?(b.stats.gpuTime+=b.sum/1e6,g.push(b)):(b.startQueryIndex=l,b.endQueryIndex=k,h[c++]=b)}h.length=c}},getNumPendingQueries:function(){return f.length},clear:function(){e.push.apply(e,f);for(var b=0;b<e.length;b++)a.ext_disjoint_timer_query.deleteQueryEXT(e[b]);f.length=0,e.length=0},restore:function(){f.length=0,e.length=0}}};return function(b){function aO(){if(0===aW.length)aM&&aM.update(),a$=null;else{a$=ac.next(aO),aT();for(var b=aW.length-1;0<=b;--b){var c=aW[b];c&&c(E,null,0)}a.flush(),aM&&aM.update()}}function aP(){!a$&&0<aW.length&&(a$=ac.next(aO))}function aQ(){a$&&(ac.cancel(aO),a$=null)}function aF(a){a.preventDefault(),aQ(),aX.forEach(function(a){a()})}function aG(b){a.getError(),aA.restore(),aN.restore(),aa.restore(),x.restore(),aD.restore(),m.restore(),aC.restore(),aM&&aM.restore(),aE.procs.refresh(),aP(),aY.forEach(function(a){a()})}function B(a){function b(a,d){var b={},c={};return Object.keys(a).forEach(function(f){var e=a[f];if(ab.isDynamic(e))c[f]=ab.unbox(e,f);else{if(d&&Array.isArray(e)){for(var g=0;g<e.length;++g)if(ab.isDynamic(e[g])){c[f]=ab.unbox(e,f);return}}b[f]=e}}),{dynamic:c,static:b}}var e=b(a.context||{},!0),f=b(a.uniforms||{},!0),g=b(a.attributes||{},!1);a=b(function(c){function b(b){if(b in a){var c=a[b];delete a[b],Object.keys(c).forEach(function(d){a[b+"."+d]=c[d]})}}var a=_({},c);return delete a.uniforms,delete a.attributes,delete a.context,delete a.vao,"stencil"in a&&a.stencil.op&&(a.stencil.opBack=a.stencil.opFront=a.stencil.op,delete a.stencil.op),b("blend"),b("depth"),b("cull"),b("stencil"),b("polygonOffset"),b("scissor"),b("sample"),"vao"in c&&(a.vao=c.vao),a}(a),!1);var d={gpuTime:0,cpuTime:0,count:0},c=aE.compile(a,g,f,e,d),h=c.draw,i=c.batch,j=c.scope,k=[];return _(function(a,c){var b;if("function"==typeof a)return j.call(this,null,a,0);if("function"==typeof c)if("number"==typeof a)for(b=0;b<a;++b)j.call(this,null,c,b);else if(!Array.isArray(a))return j.call(this,a,c,0);else for(b=0;b<a.length;++b)j.call(this,a[b],c,b);else if("number"==typeof a){if(0<a)return i.call(this,function(a){for(;k.length<a;)k.push(null);return k}(0|a),0|a)}else if(!Array.isArray(a))return h.call(this,a);else if(a.length)return i.call(this,a,a.length)},{stats:d,destroy:function(){c.destroy()}})}function aR(e,b){var d=0;aE.procs.poll();var c=b.color;c&&(a.clearColor(+c[0]||0,+c[1]||0,+c[2]||0,+c[3]||0),d|=16384),"depth"in b&&(a.clearDepth(+b.depth),d|=256),"stencil"in b&&(a.clearStencil(0|b.stencil),d|=1024),a.clear(d)}function aH(a){return aW.push(a),aP(),{cancel:function(){function b(){var a=$(aW,b);aW[a]=aW[aW.length-1],--aW.length,0>=aW.length&&aQ()}var c=$(aW,a);aW[c]=b}}}function aS(){var b=aV.viewport,c=aV.scissor_box;b[0]=b[1]=c[0]=c[1]=0,E.viewportWidth=E.framebufferWidth=E.drawingBufferWidth=b[2]=c[2]=a.drawingBufferWidth,E.viewportHeight=E.framebufferHeight=E.drawingBufferHeight=b[3]=c[3]=a.drawingBufferHeight}function aT(){E.tick+=1,E.time=aI(),aS(),aE.procs.poll()}function ap(){x.refresh(),aS(),aE.procs.refresh(),aM&&aM.update()}function aI(){return(ad()-aU)/1e3}if(!(b=function(d){var b,f,c,e,a=d||{};d={};var j=[],k=[],h="undefined"==typeof window?1:window.devicePixelRatio,l=!1,m={},g=function(a){},i=function(){};if("string"==typeof a?b=document.querySelector(a):"object"==typeof a&&("string"==typeof a.nodeName&&"function"==typeof a.appendChild&&"function"==typeof a.getBoundingClientRect?b=a:"function"==typeof a.drawArrays||"function"==typeof a.drawElements?c=(e=a).canvas:("gl"in a?e=a.gl:"canvas"in a?c=z(a.canvas):"container"in a&&(f=z(a.container)),"attributes"in a&&(d=a.attributes),"extensions"in a&&(j=y(a.extensions)),"optionalExtensions"in a&&(k=y(a.optionalExtensions)),"onDone"in a&&(g=a.onDone),"profile"in a&&(l=!!a.profile),"pixelRatio"in a&&(h=+a.pixelRatio),"cachedCode"in a&&(m=a.cachedCode))),b&&("canvas"===b.nodeName.toLowerCase()?c=b:f=b),!e){if(!c){if(!(b=function(a,e,f){function c(){var d=window.innerWidth,c=window.innerHeight;a!==document.body&&(d=(c=b.getBoundingClientRect()).right-c.left,c=c.bottom-c.top),b.width=f*d,b.height=f*c}var d,b=document.createElement("canvas");return _(b.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),a.appendChild(b),a===document.body&&(b.style.position="absolute",_(a.style,{margin:0,padding:0})),a!==document.body&&"function"==typeof ResizeObserver?(d=new ResizeObserver(function(){setTimeout(c)})).observe(a):window.addEventListener("resize",c,!1),c(),{canvas:b,onDestroy:function(){d?d.disconnect():window.removeEventListener("resize",c),a.removeChild(b)}}}(f||document.body,g,h)))return null;c=b.canvas,i=b.onDestroy}void 0===d.premultipliedAlpha&&(d.premultipliedAlpha=!0),e=function(b,c){function a(a){try{return b.getContext(a,c)}catch(d){return null}}return a("webgl")||a("experimental-webgl")||a("webgl-experimental")}(c,d)}return e?{gl:e,canvas:c,container:f,extensions:j,optionalExtensions:k,pixelRatio:h,profile:l,cachedCode:m,onDone:g,onDestroy:i}:(i(),g("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(b)))return null;var a=b.gl,l=a.getContextAttributes();a.isContextLost();var aA=function(f,a){function c(a){var b;a=a.toLowerCase();try{b=e[a]=f.getExtension(a)}catch(c){}return!!b}for(var e={},b=0;b<a.extensions.length;++b){var d=a.extensions[b];if(!c(d))return a.onDestroy(),a.onDone('"'+d+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return a.optionalExtensions.forEach(c),{extensions:e,restore:function(){Object.keys(e).forEach(function(a){if(e[a]&&!c(a))throw Error("(regl): error restoring extension "+a)})}}}(a,b);if(!aA)return null;var aJ,aK,q=(aJ={"":0},aK=[""],{id:function(a){var b=aJ[a];return b||(b=aJ[a]=aK.length,aK.push(a)),b},str:function(a){return aK[a]}}),f={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},aL=b.cachedCode||{},e=aA.extensions,aM=az(a,e),aU=ad(),k=a.drawingBufferWidth,D=a.drawingBufferHeight,E={tick:0,time:0,viewportWidth:k,viewportHeight:D,framebufferWidth:k,framebufferHeight:D,drawingBufferWidth:k,drawingBufferHeight:D,pixelRatio:b.pixelRatio},k={elements:null,primitive:4,count:-1,offset:0,instances:-1},h=ae(a,e),aa=function(f,b,c,g){function a(a){this.id=j++,this.buffer=f.createBuffer(),this.type=a,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,c.profile&&(this.stats={size:0})}function h(a,b,c){a.byteLength=b.byteLength,f.bufferData(a.type,b,c)}function e(b,a,d,e,c,f){if(b.usage=d,Array.isArray(a)){if(b.dtype=e||5126,0<a.length)if(Array.isArray(a[0])){c=ak(a);for(var g=e=1;g<c.length;++g)e*=c[g];b.dimension=e,a=aj(a,c,b.dtype),h(b,a,d),f?b.persistentData=a:o.freeType(a)}else"number"==typeof a[0]?(b.dimension=c,G(c=o.allocType(b.dtype,a.length),a),h(b,c,d),f?b.persistentData=c:o.freeType(c)):af(a[0])&&(b.dimension=a[0].length,b.dtype=e||F(a[0])||5126,a=aj(a,[a.length,a[0].length],b.dtype),h(b,a,d),f?b.persistentData=a:o.freeType(a))}else if(af(a))b.dtype=e||F(a),b.dimension=c,h(b,a,d),f&&(b.persistentData=new Uint8Array(new Uint8Array(a.buffer)));else if(C(a)){c=a.shape;var k=a.stride,g=a.offset,j=0,i=0,l=0,m=0;1===c.length?(j=c[0],i=1,l=k[0],m=0):2===c.length&&(j=c[0],i=c[1],l=k[0],m=k[1]),b.dtype=e||F(a.data)||5126,b.dimension=i,H(c=o.allocType(b.dtype,j*i),a.data,j,i,l,m,g),h(b,c,d),f?b.persistentData=c:o.freeType(c)}else a instanceof ArrayBuffer&&(b.dtype=5121,b.dimension=c,h(b,a,d),f&&(b.persistentData=new Uint8Array(new Uint8Array(a))))}function i(a){b.bufferCount--,g(a),f.deleteBuffer(a.buffer),a.buffer=null,delete k[a.id]}var j=0,k={};a.prototype.bind=function(){f.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){i(this)};var l=[];return c.profile&&(b.getTotalBufferSize=function(){var a=0;return Object.keys(k).forEach(function(b){a+=k[b].stats.size}),a}),{create:function(j,l,m,n){function g(a){var i=35044,j=null,b=0,k=0,l=1;return Array.isArray(a)||af(a)||C(a)||a instanceof ArrayBuffer?j=a:"number"==typeof a?b=0|a:a&&("data"in a&&(j=a.data),"usage"in a&&(i=ai[a.usage]),"type"in a&&(k=ah[a.type]),"dimension"in a&&(l=0|a.dimension),"length"in a&&(b=0|a.length)),h.bind(),j?e(h,j,i,k,l,n):(b&&f.bufferData(h.type,b,i),h.dtype=k||5121,h.usage=i,h.dimension=l,h.byteLength=b),c.profile&&(h.stats.size=h.byteLength*d[h.dtype]),g}b.bufferCount++;var h=new a(l);return k[h.id]=h,m||g(j),g._reglType="buffer",g._buffer=h,g.subdata=function(a,l){var b,d=0|(l||0);if(h.bind(),af(a)||a instanceof ArrayBuffer)f.bufferSubData(h.type,d,a);else if(Array.isArray(a)){if(0<a.length)if("number"==typeof a[0]){var c=o.allocType(h.dtype,a.length);G(c,a),f.bufferSubData(h.type,d,c),o.freeType(c)}else(Array.isArray(a[0])||af(a[0]))&&(b=ak(a),c=aj(a,b,h.dtype),f.bufferSubData(h.type,d,c),o.freeType(c))}else if(C(a)){b=a.shape;var i=a.stride,e=c=0,j=0,k=0;1===b.length?(c=b[0],e=1,j=i[0],k=0):2===b.length&&(c=b[0],e=b[1],j=i[0],k=i[1]),b=Array.isArray(a.data)?h.dtype:F(a.data),H(b=o.allocType(b,c*e),a.data,c,e,j,k,a.offset),f.bufferSubData(h.type,d,b),o.freeType(b)}return g},c.profile&&(g.stats=h.stats),g.destroy=function(){i(h)},g},createStream:function(c,d){var b=l.pop();return b||(b=new a(c)),b.bind(),e(b,d,35040,0,1,!1),b},destroyStream:function(a){l.push(a)},clear:function(){ag(k).forEach(i),l.forEach(i)},getBuffer:function(b){return b&&b._buffer instanceof a?b._buffer:null},restore:function(){ag(k).forEach(function(a){a.buffer=f.createBuffer(),f.bindBuffer(a.type,a.buffer),f.bufferData(a.type,a.persistentData||a.byteLength,a.usage)})},_initBuffer:e}}(a,f,b,function(a){return aC.destroyBuffer(a)}),aB=function(d,a,e,f){function b(a){this.id=j++,i[this.id]=this,this.buffer=a,this.primType=4,this.type=this.vertCount=0}function g(c,b,h,g,k,j,i){var f;if(c.buffer.bind(),b?((f=i)||af(b)&&(!C(b)||af(b.data))||(f=a.oes_element_index_uint?5125:5123),e._initBuffer(c.buffer,b,h,f,3)):(d.bufferData(34963,j,h),c.buffer.dtype=f||5121,c.buffer.usage=h,c.buffer.dimension=3,c.buffer.byteLength=j),f=i,!i){switch(c.buffer.dtype){case 5121:case 5120:f=5121;break;case 5123:case 5122:f=5123;break;case 5125:case 5124:f=5125}c.buffer.dtype=f}c.type=f,0>(b=k)&&(b=c.buffer.byteLength,5123===f?b>>=1:5125===f&&(b>>=2)),c.vertCount=b,b=g,0>g&&(b=4,1===(g=c.buffer.dimension)&&(b=0),2===g&&(b=1),3===g&&(b=4)),c.primType=b}function h(a){f.elementsCount--,delete i[a.id],a.buffer.destroy(),a.buffer=null}var i={},j=0,c={uint8:5121,uint16:5123};a.oes_element_index_uint&&(c.uint32=5125),b.prototype.bind=function(){this.buffer.bind()};var k=[];return{create:function(d,k){function a(b){if(b)if("number"==typeof b)i(b),j.primType=4,j.vertCount=0|b,j.type=5121;else{var f=null,k=35044,l=-1,h=-1,e=0,d=0;Array.isArray(b)||af(b)||C(b)?f=b:("data"in b&&(f=b.data),"usage"in b&&(k=ai[b.usage]),"primitive"in b&&(l=al[b.primitive]),"count"in b&&(h=0|b.count),"type"in b&&(d=c[b.type]),"length"in b)?e=0|b.length:(e=h,5123===d||5122===d)?e*=2:(5125===d||5124===d)&&(e*=4),g(j,f,k,l,h,e,d)}else i(),j.primType=4,j.vertCount=0,j.type=5121;return a}var i=e.create(null,34963,!0),j=new b(i._buffer);return f.elementsCount++,a(d),a._reglType="elements",a._elements=j,a.subdata=function(b,c){return i.subdata(b,c),a},a.destroy=function(){h(j)},a},createStream:function(c){var a=k.pop();return a||(a=new b(e.create(null,34963,!0,!1)._buffer)),g(a,c,35040,-1,-1,0,0),a},destroyStream:function(a){k.push(a)},getElements:function(a){return"function"==typeof a&&a._elements instanceof b?a._elements:null},clear:function(){ag(i).forEach(h)}}}(a,e,aa,f),aC=function(g,b,a,h,i,j,k){function c(){this.id=++l,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var a=b.oes_vertex_array_object;this.vao=a?a.createVertexArrayOES():null,m[this.id]=this,this.buffers=[]}var d=a.maxAttributes,e=Array(d);for(a=0;a<d;++a)e[a]=new Q;var l=0,m={},f={Record:Q,scope:{},state:e,currentVAO:null,targetVAO:null,restore:b.oes_vertex_array_object?function(){b.oes_vertex_array_object&&ag(m).forEach(function(a){a.refresh()})}:function(){},createVAO:function(b){function a(c){Array.isArray(c)?(l=c,d.elements&&d.ownsElements&&d.elements.destroy(),d.elements=null,d.ownsElements=!1,d.offset=0,d.count=0,d.instances=-1,d.primitive=4):(c.elements?(l=c.elements,d.ownsElements?("function"==typeof l&&"elements"===l._reglType?d.elements.destroy():d.elements(l),d.ownsElements=!1):j.getElements(c.elements)?(d.elements=c.elements,d.ownsElements=!1):(d.elements=j.create(c.elements),d.ownsElements=!0)):(d.elements=null,d.ownsElements=!1),l=c.attributes,d.offset=0,d.count=-1,d.instances=-1,d.primitive=4,d.elements&&(d.count=d.elements._elements.vertCount,d.primitive=d.elements._elements.primType),"offset"in c&&(d.offset=0|c.offset),"count"in c&&(d.count=0|c.count),"instances"in c&&(d.instances=0|c.instances),"primitive"in c&&(d.primitive=al[c.primitive])),c={};var k=d.attributes;k.length=l.length;for(var g=0;g<l.length;++g){var l,f,e=l[g],b=k[g]=new Q,h=e.data||e;Array.isArray(h)||af(h)||C(h)?(d.buffers[g]&&(f=d.buffers[g],af(h)&&f._buffer.byteLength>=h.byteLength?f.subdata(h):(f.destroy(),d.buffers[g]=null)),d.buffers[g]||(f=d.buffers[g]=i.create(e,34962,!1,!0)),b.buffer=i.getBuffer(f),b.size=0|b.buffer.dimension,b.normalized=!1,b.type=b.buffer.dtype,b.offset=0,b.stride=0,b.divisor=0,b.state=1,c[g]=1):i.getBuffer(e)?(b.buffer=i.getBuffer(e),b.size=0|b.buffer.dimension,b.normalized=!1,b.type=b.buffer.dtype,b.offset=0,b.stride=0,b.divisor=0,b.state=1):i.getBuffer(e.buffer)?(b.buffer=i.getBuffer(e.buffer),b.size=0|(+e.size||b.buffer.dimension),b.normalized=!!e.normalized,b.type="type"in e?ah[e.type]:b.buffer.dtype,b.offset=0|(e.offset||0),b.stride=0|(e.stride||0),b.divisor=0|(e.divisor||0),b.state=1):"x"in e&&(b.x=+e.x||0,b.y=+e.y||0,b.z=+e.z||0,b.w=+e.w||0,b.state=2)}for(f=0;f<d.buffers.length;++f)!c[f]&&d.buffers[f]&&(d.buffers[f].destroy(),d.buffers[f]=null);return d.refresh(),a}var d=new c;return h.vaoCount+=1,a.destroy=function(){for(var a=0;a<d.buffers.length;++a)d.buffers[a]&&d.buffers[a].destroy();d.buffers.length=0,d.ownsElements&&(d.elements.destroy(),d.elements=null,d.ownsElements=!1),d.destroy()},a._vao=d,a._reglType="vao",a(b)},getVAO:function(a){return"function"==typeof a&&a._vao?a._vao:null},destroyBuffer:function(c){for(var a=0;a<e.length;++a){var b=e[a];b.buffer===c&&(g.disableVertexAttribArray(a),b.buffer=null)}},setVAO:b.oes_vertex_array_object?function(a){if(a!==f.currentVAO){var c=b.oes_vertex_array_object;a?c.bindVertexArrayOES(a.vao):c.bindVertexArrayOES(null),f.currentVAO=a}}:function(d){if(d!==f.currentVAO){if(d)d.bindAttrs();else{for(var h=b.angle_instanced_arrays,c=0;c<e.length;++c){var a=e[c];a.buffer?(g.enableVertexAttribArray(c),a.buffer.bind(),g.vertexAttribPointer(c,a.size,a.type,a.normalized,a.stride,a.offfset),h&&a.divisor&&h.vertexAttribDivisorANGLE(c,a.divisor)):(g.disableVertexAttribArray(c),g.vertexAttrib4f(c,a.x,a.y,a.z,a.w))}k.elements?g.bindBuffer(34963,k.elements.buffer.buffer):g.bindBuffer(34963,null)}f.currentVAO=d}},clear:b.oes_vertex_array_object?function(){ag(m).forEach(function(a){a.destroy()})}:function(){}};return c.prototype.bindAttrs=function(){for(var c=b.angle_instanced_arrays,f=this.attributes,e=0;e<f.length;++e){var a=f[e];a.buffer?(g.enableVertexAttribArray(e),g.bindBuffer(34962,a.buffer.buffer),g.vertexAttribPointer(e,a.size,a.type,a.normalized,a.stride,a.offset),c&&a.divisor&&c.vertexAttribDivisorANGLE(e,a.divisor)):(g.disableVertexAttribArray(e),g.vertexAttrib4f(e,a.x,a.y,a.z,a.w))}for(c=f.length;c<d;++c)g.disableVertexAttribArray(c);(c=j.getElements(this.elements))?g.bindBuffer(34963,c.buffer.buffer):g.bindBuffer(34963,null)},c.prototype.refresh=function(){var a=b.oes_vertex_array_object;a&&(a.bindVertexArrayOES(this.vao),this.bindAttrs(),f.currentVAO=null,a.bindVertexArrayOES(null))},c.prototype.destroy=function(){if(this.vao){var a=b.oes_vertex_array_object;this===f.currentVAO&&(f.currentVAO=null,a.bindVertexArrayOES(null)),a.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),m[this.id]&&(delete m[this.id],--h.vaoCount)},f}(a,e,h,f,aa,aB,k),aN=function(d,e,a,b){function f(a,b,c,d){this.name=a,this.id=b,this.location=c,this.info=d}function g(a,c){for(var b=0;b<a.length;++b)if(a[b].id===c.id){a[b].location=c.location;return}a.push(c)}function c(c,b,f){var a=(f=35632===c?j:k)[b];if(!a){var g=e.str(b),a=d.createShader(c);d.shaderSource(a,g),d.compileShader(a),f[b]=a}return a}function h(a,c){this.id=n++,this.fragId=a,this.vertId=c,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,b.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function i(k,i,a){h=c(35632,k.fragId);var h,j=c(35633,k.vertId);if(i=k.program=d.createProgram(),d.attachShader(i,h),d.attachShader(i,j),a)for(h=0;h<a.length;++h)j=a[h],d.bindAttribLocation(i,j[0],j[1]);d.linkProgram(i),j=d.getProgramParameter(i,35718),b.profile&&(k.stats.uniformsCount=j);var n=k.uniforms;for(h=0;h<j;++h)if(a=d.getActiveUniform(i,h))if(1<a.size)for(var l=0;l<a.size;++l){var m=a.name.replace("[0]","["+l+"]");g(n,new f(m,e.id(m),d.getUniformLocation(i,m),a))}else g(n,new f(a.name,e.id(a.name),d.getUniformLocation(i,a.name),a));for(j=d.getProgramParameter(i,35721),b.profile&&(k.stats.attributesCount=j),k=k.attributes,h=0;h<j;++h)(a=d.getActiveAttrib(i,h))&&g(k,new f(a.name,e.id(a.name),d.getAttribLocation(i,a.name),a))}var j={},k={},l={},m=[],n=0;return b.profile&&(a.getMaxUniformsCount=function(){var a=0;return m.forEach(function(b){b.stats.uniformsCount>a&&(a=b.stats.uniformsCount)}),a},a.getMaxAttributesCount=function(){var a=0;return m.forEach(function(b){b.stats.attributesCount>a&&(a=b.stats.attributesCount)}),a}),{clear:function(){var b=d.deleteShader.bind(d);ag(j).forEach(b),j={},ag(k).forEach(b),k={},m.forEach(function(a){d.deleteProgram(a.program)}),m.length=0,l={},a.shaderCount=0},program:function(f,g,o,n){var b=l[g];b||(b=l[g]={});var c=b[f];if(c&&(c.refCount++,!n))return c;var e=new h(g,f);return a.shaderCount++,i(e,o,n),c||(b[f]=e),m.push(e),_(e,{destroy:function(){if(e.refCount--,0>=e.refCount){d.deleteProgram(e.program);var c=m.indexOf(e);m.splice(c,1),a.shaderCount--}0>=b[e.vertId].refCount&&(d.deleteShader(k[e.vertId]),delete k[e.vertId],delete l[e.fragId][e.vertId]),Object.keys(l[e.fragId]).length||(d.deleteShader(j[e.fragId]),delete j[e.fragId],delete l[e.fragId])}})},restore:function(){j={},k={};for(var a=0;a<m.length;++a)i(m[a],null,m[a].attributes.map(function(a){return[a.location,a.name]}))},shader:c,frag:-1,vert:-1}}(a,q,f,b),x=function(j,a,f,y,z,k,l){function A(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function B(a,b){a.internalformat=b.internalformat,a.format=b.format,a.type=b.type,a.compressed=b.compressed,a.premultiplyAlpha=b.premultiplyAlpha,a.flipY=b.flipY,a.unpackAlignment=b.unpackAlignment,a.colorSpace=b.colorSpace,a.width=b.width,a.height=b.height,a.channels=b.channels}function D(f,a){if("object"==typeof a&&a){"premultiplyAlpha"in a&&(f.premultiplyAlpha=a.premultiplyAlpha),"flipY"in a&&(f.flipY=a.flipY),"alignment"in a&&(f.unpackAlignment=a.alignment),"colorSpace"in a&&(f.colorSpace=ae[a.colorSpace]),"type"in a&&(f.type=b[a.type]);var g=f.width,h=f.height,j=f.channels,i=!1;"shape"in a?(g=a.shape[0],h=a.shape[1],3===a.shape.length&&(j=a.shape[2],i=!0)):("radius"in a&&(g=h=a.radius),"width"in a&&(g=a.width),"height"in a&&(h=a.height),"channels"in a&&(j=a.channels,i=!0)),f.width=0|g,f.height=0|h,f.channels=0|j,g=!1,"format"in a&&(g=a.format,h=f.internalformat=d[g],f.format=ap[h],g in b&&!("type"in a)&&(f.type=b[g]),g in e&&(f.compressed=!0),g=!0),!i&&g?f.channels=c[f.format]:i&&!g&&f.channels!==ao[f.format]&&(f.format=f.internalformat=ao[f.channels])}}function E(a){j.pixelStorei(37440,a.flipY),j.pixelStorei(37441,a.premultiplyAlpha),j.pixelStorei(37443,a.colorSpace),j.pixelStorei(3317,a.unpackAlignment)}function F(){A.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function G(a,e){var b=null;if(N(e)?b=e:e&&(D(a,e),"x"in e&&(a.xOffset=0|e.x),"y"in e&&(a.yOffset=0|e.y),N(e.data)&&(b=e.data)),e.copy){var g=z.viewportWidth,c=z.viewportHeight;a.width=a.width||g-a.xOffset,a.height=a.height||c-a.yOffset,a.needsCopy=!0}else if(b){if(af(b))a.channels=a.channels||4,a.data=b,"type"in e||5121!==a.type||(a.type=0|p[Object.prototype.toString.call(b)]);else if(K(b)){switch(a.channels=a.channels||4,c=(g=b).length,a.type){case 5121:case 5123:case 5125:case 5126:(c=o.allocType(a.type,c)).set(g),a.data=c;break;case 36193:a.data=I(g)}a.alignment=1,a.needsFree=!0}else if(C(b)){g=b.data,Array.isArray(g)||5121!==a.type||(a.type=0|p[Object.prototype.toString.call(g)]);var j,k,d,h,c=b.shape,f=b.stride;3===c.length?(d=c[2],h=f[2]):h=d=1,j=c[0],k=c[1],c=f[0],f=f[1],a.alignment=1,a.width=j,a.height=k,a.channels=d,a.format=a.internalformat=ao[d],a.needsFree=!0,j=h,b=b.offset,d=a.width,h=a.height,k=a.channels;for(var q=o.allocType(36193===a.type?5126:a.type,d*h*k),x=0,l=0;l<h;++l)for(var m=0;m<d;++m)for(var n=0;n<k;++n)q[x++]=g[c*m+f*l+j*n+b];O(a,q)}else if(M(b)===r||M(b)===s||M(b)===t)M(b)===r||M(b)===s?a.element=b:a.element=b.canvas,a.width=a.element.width,a.height=a.element.height,a.channels=4;else if(M(b)===u)a.element=b,a.width=b.width,a.height=b.height,a.channels=4;else if(M(b)===v)a.element=b,a.width=b.naturalWidth,a.height=b.naturalHeight,a.channels=4;else if(M(b)===w)a.element=b,a.width=b.videoWidth,a.height=b.videoHeight,a.channels=4;else if(L(b)){for(h=0,g=a.width||b[0].length,c=a.height||b.length,f=a.channels,f=J(b[0][0])?f||b[0][0].length:f||1,j=i.shape(b),d=1;h<j.length;++h)d*=j[h];d=o.allocType(36193===a.type?5126:a.type,d),i.flatten(b,j,"",d),O(a,d),a.alignment=1,a.width=g,a.height=c,a.channels=f,a.format=a.internalformat=ao[f],a.needsFree=!0}}else a.width=a.width||1,a.height=a.height||1,a.channels=a.channels||4}function H(a,b,c,d,e){var h=a.element,i=a.data,m=a.internalformat,k=a.format,l=a.type,f=a.width,g=a.height;E(a),h?j.texSubImage2D(b,e,c,d,k,l,h):a.compressed?j.compressedTexSubImage2D(b,e,c,d,m,f,g,i):a.needsCopy?(y(),j.copyTexSubImage2D(b,e,c,d,a.xOffset,a.yOffset,f,g)):j.texSubImage2D(b,e,c,d,f,g,k,l,i)}function Q(){return aq.pop()||new F}function R(a){a.needsFree&&o.freeType(a.data),F.call(a),aq.push(a)}function S(){A.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function T(a,c,d){var b=a.images[0]=Q();a.mipmask=1,b.width=a.width=c,b.height=a.height=d,b.channels=a.channels=4}function U(a,d){var b=null;if(N(d))B(b=a.images[0]=Q(),a),G(b,d),a.mipmask=1;else if(D(a,d),Array.isArray(d.mipmap))for(var e=d.mipmap,c=0;c<e.length;++c)B(b=a.images[c]=Q(),a),b.width>>=c,b.height>>=c,G(b,e[c]),a.mipmask|=1<<c;else B(b=a.images[0]=Q(),a),G(b,d),a.mipmask=1;B(a,a.images[0])}function V(m,n){for(var f=m.images,b=0;b<f.length&&f[b];++b){var a=f[b],d=n,e=b,i=a.element,k=a.data,o=a.internalformat,c=a.format,l=a.type,g=a.width,h=a.height;E(a),i?j.texImage2D(d,e,c,c,l,i):a.compressed?j.compressedTexImage2D(d,e,o,g,h,0,k):a.needsCopy?(y(),j.copyTexImage2D(d,e,c,a.xOffset,a.yOffset,g,h,0)):j.texImage2D(d,e,c,g,h,0,c,l,k||null)}}function W(){var a=ar.pop()||new S;A.call(a);for(var b=a.mipmask=0;16>b;++b)a.images[b]=null;return a}function X(c){for(var b=c.images,a=0;a<b.length;++a)b[a]&&R(b[a]),b[a]=null;ar.push(c)}function Y(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Z(b,a){"min"in a&&(b.minFilter=q[a.min],!(0<=an.indexOf(b.minFilter))||"faces"in a||(b.genMipmaps=!0)),"mag"in a&&(b.magFilter=g[a.mag]);var c=b.wrapS,e=b.wrapT;if("wrap"in a){var d=a.wrap;"string"==typeof d?c=e=n[d]:Array.isArray(d)&&(c=n[d[0]],e=n[d[1]])}else"wrapS"in a&&(c=n[a.wrapS]),"wrapT"in a&&(e=n[a.wrapT]);if(b.wrapS=c,b.wrapT=e,"anisotropic"in a&&(b.anisotropic=a.anisotropic),"mipmap"in a){switch(c=!1,typeof a.mipmap){case"string":b.mipmapHint=ad[a.mipmap],c=b.genMipmaps=!0;break;case"boolean":c=b.genMipmaps=a.mipmap;break;case"object":b.genMipmaps=!1,c=!0}!c||"min"in a||(b.minFilter=9984)}}function $(b,c){j.texParameteri(c,10241,b.minFilter),j.texParameteri(c,10240,b.magFilter),j.texParameteri(c,10242,b.wrapS),j.texParameteri(c,10243,b.wrapT),a.ext_texture_filter_anisotropic&&j.texParameteri(c,34046,b.anisotropic),b.genMipmaps&&(j.hint(33170,b.mipmapHint),j.generateMipmap(c))}function m(a){A.call(this),this.mipmask=0,this.internalformat=6408,this.id=as++,this.refCount=1,this.target=a,this.texture=j.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Y,l.profile&&(this.stats={size:0})}function aa(a){j.activeTexture(33984),j.bindTexture(a.target,a.texture)}function ab(){var a=au[0];a?j.bindTexture(a.target,a.texture):j.bindTexture(3553,null)}function ac(a){var c=a.texture,b=a.unit,d=a.target;0<=b&&(j.activeTexture(33984+b),j.bindTexture(d,null),au[b]=null),j.deleteTexture(c),a.texture=null,a.params=null,a.pixels=null,a.refCount=0,delete at[a.id],k.textureCount--}var ad={"don't care":4352,"dont care":4352,nice:4354,fast:4353},n={repeat:10497,clamp:33071,mirror:33648},g={nearest:9728,linear:9729},q=_({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},g),ae={none:0,browser:37444},b={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},d={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},e={};a.ext_srgb&&(d.srgb=35904,d.srgba=35906),a.oes_texture_float&&(b.float32=b.float=5126),a.oes_texture_half_float&&(b.float16=b["half float"]=36193),a.webgl_depth_texture&&(_(d,{depth:6402,"depth stencil":34041}),_(b,{uint16:5123,uint32:5125,"depth stencil":34042})),a.webgl_compressed_texture_s3tc&&_(e,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),a.webgl_compressed_texture_atc&&_(e,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),a.webgl_compressed_texture_pvrtc&&_(e,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),a.webgl_compressed_texture_etc1&&(e["rgb etc1"]=36196);var ah=Array.prototype.slice.call(j.getParameter(34467));Object.keys(e).forEach(function(a){var b=e[a];0<=ah.indexOf(b)&&(d[a]=b)});var h=Object.keys(d);f.textureFormats=h;var ai=[];Object.keys(d).forEach(function(a){ai[d[a]]=a});var aj=[];Object.keys(b).forEach(function(a){aj[b[a]]=a});var ak=[];Object.keys(g).forEach(function(a){ak[g[a]]=a});var al=[];Object.keys(q).forEach(function(a){al[q[a]]=a});var am=[];Object.keys(n).forEach(function(a){am[n[a]]=a});var ap=h.reduce(function(c,e){var b=d[e];return 6409===b||6406===b||6409===b||6410===b||6402===b||34041===b||a.ext_srgb&&(35904===b||35906===b)?c[b]=b:32855===b||0<=e.indexOf("rgba")?c[b]=6408:c[b]=6407,c},{}),aq=[],ar=[],as=0,at={},x=f.maxTextureUnits,au=Array(x).map(function(){return null});return _(m.prototype,{bind:function(){this.bindCount+=1;var a=this.unit;if(0>a){for(var b=0;b<x;++b){var c=au[b];if(c){if(0<c.bindCount)continue;c.unit=-1}au[b]=this,a=b;break}l.profile&&k.maxTextureUnits<a+1&&(k.maxTextureUnits=a+1),this.unit=a,j.activeTexture(33984+a),j.bindTexture(this.target,this.texture)}return a},unbind:function(){--this.bindCount},decRef:function(){0>= --this.refCount&&ac(this)}}),l.profile&&(k.getTotalTextureSize=function(){var a=0;return Object.keys(at).forEach(function(b){a+=at[b].stats.size}),a}),{create2D:function(c,d){function a(e,f){var d=b.texInfo;Y.call(d);var c=W();return"number"==typeof e?"number"==typeof f?T(c,0|e,0|f):T(c,0|e,0|e):e?(Z(d,e),U(c,e)):T(c,1,1),d.genMipmaps&&(c.mipmask=(c.width<<1)-1),b.mipmask=c.mipmask,B(b,c),b.internalformat=c.internalformat,a.width=c.width,a.height=c.height,aa(b),V(c,3553),$(d,3553),ab(),X(c),l.profile&&(b.stats.size=P(b.internalformat,b.type,c.width,c.height,d.genMipmaps,!1)),a.format=ai[b.internalformat],a.type=aj[b.type],a.mag=ak[d.magFilter],a.min=al[d.minFilter],a.wrapS=am[d.wrapS],a.wrapT=am[d.wrapT],a}var b=new m(3553);return at[b.id]=b,k.textureCount++,a(c,d),a.subimage=function(g,e,f,d){e|=0,f|=0,d|=0;var c=Q();return B(c,b),c.width=0,c.height=0,G(c,g),c.width=c.width||(b.width>>d)-e,c.height=c.height||(b.height>>d)-f,aa(b),H(c,3553,e,f,d),ab(),R(c),a},a.resize=function(h,i){var c=0|h,e=0|i||c;if(c===b.width&&e===b.height)return a;a.width=b.width=c,a.height=b.height=e,aa(b);for(var d=0;b.mipmask>>d;++d){var f=c>>d,g=e>>d;if(!f||!g)break;j.texImage2D(3553,d,b.format,f,g,0,b.format,b.type,null)}return ab(),l.profile&&(b.stats.size=P(b.internalformat,b.type,c,e,!1,!1)),a},a._reglType="texture2d",a._texture=b,l.profile&&(a.stats=b.stats),a.destroy=function(){b.decRef()},a},createCube:function(c,d,e,f,g,h){function a(d,f,g,h,j,k){var c,e=b.texInfo;for(Y.call(e),c=0;6>c;++c)i[c]=W();if("number"!=typeof d&&d){if("object"==typeof d)if(f)U(i[0],d),U(i[1],f),U(i[2],g),U(i[3],h),U(i[4],j),U(i[5],k);else if(Z(e,d),D(b,d),"faces"in d)for(d=d.faces,c=0;6>c;++c)B(i[c],b),U(i[c],d[c]);else for(c=0;6>c;++c)U(i[c],d)}else for(d=0|d||1,c=0;6>c;++c)T(i[c],d,d);for(B(b,i[0]),b.mipmask=e.genMipmaps?(i[0].width<<1)-1:i[0].mipmask,b.internalformat=i[0].internalformat,a.width=i[0].width,a.height=i[0].height,aa(b),c=0;6>c;++c)V(i[c],34069+c);for($(e,34067),ab(),l.profile&&(b.stats.size=P(b.internalformat,b.type,a.width,a.height,e.genMipmaps,!0)),a.format=ai[b.internalformat],a.type=aj[b.type],a.mag=ak[e.magFilter],a.min=al[e.minFilter],a.wrapS=am[e.wrapS],a.wrapT=am[e.wrapT],c=0;6>c;++c)X(i[c]);return a}var b=new m(34067);at[b.id]=b,k.cubeCount++;var i=Array(6);return a(c,d,e,f,g,h),a.subimage=function(g,h,e,f,d){e|=0,f|=0,d|=0;var c=Q();return B(c,b),c.width=0,c.height=0,G(c,h),c.width=c.width||(b.width>>d)-e,c.height=c.height||(b.height>>d)-f,aa(b),H(c,34069+g,e,f,d),ab(),R(c),a},a.resize=function(c){if((c|=0)!==b.width){a.width=b.width=c,a.height=b.height=c,aa(b);for(var e=0;6>e;++e)for(var d=0;b.mipmask>>d;++d)j.texImage2D(34069+e,d,b.format,c>>d,c>>d,0,b.format,b.type,null);return ab(),l.profile&&(b.stats.size=P(b.internalformat,b.type,a.width,a.height,!1,!0)),a}},a._reglType="textureCube",a._texture=b,l.profile&&(a.stats=b.stats),a.destroy=function(){b.decRef()},a},clear:function(){for(var a=0;a<x;++a)j.activeTexture(33984+a),j.bindTexture(3553,null),au[a]=null;ag(at).forEach(ac),k.cubeCount=0,k.textureCount=0},getTexture:function(a){return null},restore:function(){for(var a=0;a<x;++a){var b=au[a];b&&(b.bindCount=0,b.unit=-1,au[a]=null)}ag(at).forEach(function(a){a.texture=j.createTexture(),j.bindTexture(a.target,a.texture);for(var b=0;32>b;++b)if(0!=(a.mipmask&1<<b))if(3553===a.target)j.texImage2D(3553,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);else for(var c=0;6>c;++c)j.texImage2D(34069+c,b,a.internalformat,a.width>>b,a.height>>b,0,a.internalformat,a.type,null);$(a.texInfo,a.target)})},refresh:function(){for(var a=0;a<x;++a){var b=au[a];b&&(b.bindCount=0,b.unit=-1,au[a]=null),j.activeTexture(33984+a),j.bindTexture(3553,null),j.bindTexture(34067,null)}}}}(a,e,h,function(){aE.procs.poll()},E,f,b),aD=aq(a,e,h,f,b),m=function(f,a,h,i,k,l){function m(a,b,c){this.target=a,this.texture=b,this.renderbuffer=c;var d=a=0;b?(a=b.width,d=b.height):c&&(a=c.width,d=c.height),this.width=a,this.height=d}function n(a){a&&(a.texture&&a.texture._texture.decRef(),a.renderbuffer&&a.renderbuffer._renderbuffer.decRef())}function o(a,b,c){a&&(a.texture?a.texture._texture.refCount+=1:a.renderbuffer._renderbuffer.refCount+=1)}function p(b,a){a&&(a.texture?f.framebufferTexture2D(36160,b,a.target,a.texture._texture.texture,0):f.framebufferRenderbuffer(36160,b,36161,a.renderbuffer._renderbuffer.renderbuffer))}function q(a){var c=3553,d=null,e=null,b=a;return"object"==typeof a&&(b=a.data,"target"in a&&(c=0|a.target)),"texture2d"===(a=b._reglType)?d=b:"textureCube"===a?d=b:"renderbuffer"===a&&(e=b,c=36161),new m(c,d,e)}function r(a,b,d,c,e){return d?((a=i.create2D({width:a,height:b,format:c,type:e}))._texture.refCount=0,new m(3553,a,null)):((a=k.create({width:a,height:b,format:c}))._renderbuffer.refCount=0,new m(36161,null,a))}function s(a){return a&&(a.texture||a.renderbuffer)}function t(a,b,c){a&&(a.texture?a.texture.resize(b,c):a.renderbuffer&&a.renderbuffer.resize(b,c),a.width=b,a.height=c)}function u(){this.id=z++,A[this.id]=this,this.framebuffer=f.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(a){a.colorAttachments.forEach(n),n(a.depthAttachment),n(a.stencilAttachment),n(a.depthStencilAttachment)}function w(a){f.deleteFramebuffer(a.framebuffer),a.framebuffer=null,l.framebufferCount--,delete A[a.id]}function x(b){f.bindFramebuffer(36160,b.framebuffer);var a,c=b.colorAttachments;for(a=0;a<c.length;++a)p(36064+a,c[a]);for(a=c.length;a<h.maxColorAttachments;++a)f.framebufferTexture2D(36160,36064+a,3553,null,0);f.framebufferTexture2D(36160,33306,3553,null,0),f.framebufferTexture2D(36160,36096,3553,null,0),f.framebufferTexture2D(36160,36128,3553,null,0),p(36096,b.depthAttachment),p(36128,b.stencilAttachment),p(33306,b.depthStencilAttachment),f.checkFramebufferStatus(36160),f.isContextLost(),f.bindFramebuffer(36160,e.next?e.next.framebuffer:null),e.cur=e.next,f.getError()}function d(c,d){function a(c,E){var d,h=0,e=0,k=!0,l=!0;d=null;var p=!0,m="rgba",n="uint8",B=1,z=null,A=null,C=null,D=!1;"number"==typeof c?(h=0|c,e=0|E||h):c?("shape"in c?(h=(e=c.shape)[0],e=e[1]):("radius"in c&&(h=e=c.radius),"width"in c&&(h=c.width),"height"in c&&(e=c.height)),("color"in c||"colors"in c)&&(d=c.color||c.colors,Array.isArray(d)),!d&&("colorCount"in c&&(B=0|c.colorCount),"colorTexture"in c&&(p=!!c.colorTexture,m="rgba4"),"colorType"in c&&(n=c.colorType,!p)&&("half float"===n||"float16"===n?m="rgba16f":("float"===n||"float32"===n)&&(m="rgba32f")),"colorFormat"in c&&(m=c.colorFormat,0<=y.indexOf(m)?p=!0:0<=b.indexOf(m)&&(p=!1))),("depthTexture"in c||"depthStencilTexture"in c)&&(D=!(!c.depthTexture&&!c.depthStencilTexture)),"depth"in c&&("boolean"==typeof c.depth?k=c.depth:(z=c.depth,l=!1)),"stencil"in c&&("boolean"==typeof c.stencil?l=c.stencil:(A=c.stencil,k=!1)),"depthStencil"in c&&("boolean"==typeof c.depthStencil?k=l=c.depthStencil:(C=c.depthStencil,l=k=!1))):h=e=1;var i=null,t=null,u=null,w=null;if(Array.isArray(d))i=d.map(q);else if(d)i=[q(d)];else for(i=Array(B),d=0;d<B;++d)i[d]=r(h,e,p,m,n);for(h=h||i[0].width,e=e||i[0].height,z?t=q(z):k&&!l&&(t=r(h,e,D,"depth","uint32")),A?u=q(A):l&&!k&&(u=r(h,e,!1,"stencil","uint8")),C?w=q(C):!z&&!A&&l&&k&&(w=r(h,e,D,"depth stencil","depth stencil")),k=null,d=0;d<i.length;++d)o(i[d],h,e),i[d]&&i[d].texture&&(l=j[i[d].texture._texture.format]*g[i[d].texture._texture.type],null===k&&(k=l));return o(t,h,e),o(u,h,e),o(w,h,e),v(f),f.width=h,f.height=e,f.colorAttachments=i,f.depthAttachment=t,f.stencilAttachment=u,f.depthStencilAttachment=w,a.color=i.map(s),a.depth=s(t),a.stencil=s(u),a.depthStencil=s(w),a.width=f.width,a.height=f.height,x(f),a}var f=new u;return l.framebufferCount++,a(c,d),_(a,{resize:function(g,h){var b=Math.max(0|g,1),c=Math.max(0|h||b,1);if(b===f.width&&c===f.height)return a;for(var e=f.colorAttachments,d=0;d<e.length;++d)t(e[d],b,c);return t(f.depthAttachment,b,c),t(f.stencilAttachment,b,c),t(f.depthStencilAttachment,b,c),f.width=a.width=b,f.height=a.height=c,x(f),a},_reglType:"framebuffer",_framebuffer:f,destroy:function(){w(f),v(f)},use:function(b){e.setFBO({framebuffer:a},b)}})}var e={cur:null,next:null,dirty:!1,setFBO:null},y=["rgba"],b=["rgba4","rgb565","rgb5 a1"];a.ext_srgb&&b.push("srgba"),a.ext_color_buffer_half_float&&b.push("rgba16f","rgb16f"),a.webgl_color_buffer_float&&b.push("rgba32f");var c=["uint8"];a.oes_texture_half_float&&c.push("half float","float16"),a.oes_texture_float&&c.push("float","float32");var z=0,A={};return _(e,{getFramebuffer:function(a){return"function"==typeof a&&"framebuffer"===a._reglType&&(a=a._framebuffer)instanceof u?a:null},create:d,createCube:function(b){function a(b){var e,f={color:null},g=0,h=null;e="rgba";var k="uint8",j=1;if("number"==typeof b?g=0|b:b?("shape"in b?g=b.shape[0]:("radius"in b&&(g=0|b.radius),"width"in b?g=0|b.width:"height"in b&&(g=0|b.height)),("color"in b||"colors"in b)&&(h=b.color||b.colors,Array.isArray(h)),h||("colorCount"in b&&(j=0|b.colorCount),"colorType"in b&&(k=b.colorType),"colorFormat"in b&&(e=b.colorFormat)),"depth"in b&&(f.depth=b.depth),"stencil"in b&&(f.stencil=b.stencil),"depthStencil"in b&&(f.depthStencil=b.depthStencil)):g=1,h)if(Array.isArray(h))for(b=[],e=0;e<h.length;++e)b[e]=h[e];else b=[h];else for(b=Array(j),h={radius:g,format:e,type:k},e=0;e<j;++e)b[e]=i.createCube(h);for(e=0,f.color=Array(b.length);e<b.length;++e)j=b[e],g=g||j.width,f.color[e]={target:34069,data:b[e]};for(e=0;6>e;++e){for(j=0;j<b.length;++j)f.color[j].target=34069+e;0<e&&(f.depth=c[0].depth,f.stencil=c[0].stencil,f.depthStencil=c[0].depthStencil),c[e]?c[e](f):c[e]=d(f)}return _(a,{width:g,height:g,color:b})}var c=Array(6);return a(b),_(a,{faces:c,resize:function(b){var d=0|b;if(d===a.width)return a;var e=a.color;for(b=0;b<e.length;++b)e[b].resize(d);for(b=0;6>b;++b)c[b].resize(d);return a.width=a.height=d,a},_reglType:"framebufferCube",destroy:function(){c.forEach(function(a){a.destroy()})}})},clear:function(){ag(A).forEach(w)},restore:function(){e.cur=null,e.next=null,e.dirty=!0,ag(A).forEach(function(a){a.framebuffer=f.createFramebuffer(),x(a)})}})}(a,e,h,x,aD,f),aE=function(i,y,g,r,z,B,P,C,D,k,E,F,G,H,Q,I){function $(a){return a.replace(".","_")}function d(b,c,d){var a=$(b);aA.push(b),u[a]=t[a]=!!d,M[a]=c}function a(c,d,b){var a=$(c);aA.push(c),Array.isArray(b)?(t[a]=b.slice(),u[a]=b.slice()):t[a]=u[a]=b,N[a]=d}function K(){var a=function(a){function b(){var a=[],b=[];return _(function(){a.push.apply(a,T(arguments))},{def:function(){var c="v"+f++;return b.push(c),0<arguments.length&&(a.push(c,"="),a.push.apply(a,T(arguments)),a.push(";")),c},toString:function(){return U([0<b.length?"var "+b.join(",")+";":"",U(a)])}})}function c(){function d(b,d){c(b,d,"=",a.def(b,d),";")}var a=b(),c=b(),e=a.toString,f=c.toString;return _(function(){a.apply(a,T(arguments))},{def:a.def,entry:a,exit:c,save:d,set:function(b,c,e){d(b,c),a(b,c,"=",e,";")},toString:function(){return e()+f()}})}var e=a&&a.cache,f=0,g=[],h=[],i=[],d=b(),j={};return{global:d,link:function(b,c){var d=c&&c.stable;if(!d){for(var a=0;a<h.length;++a)if(h[a]===b&&!i[a])return g[a]}return a="g"+f++,g.push(a),h.push(b),i.push(d),a},block:b,proc:function(e,b){function d(){var a="a"+f.length;return f.push(a),a}var f=[];b=b||0;for(var a=0;a<b;++a)d();var a=c(),g=a.toString;return j[e]=_(a,{arg:d,toString:function(){return U(["function(",f.join(),"){",g(),"}"])}})},scope:c,cond:function(){var d=U(arguments),a=c(),b=c(),e=a.toString,f=b.toString;return _(a,{then:function(){return a.apply(a,T(arguments)),this},"else":function(){return b.apply(b,T(arguments)),this},toString:function(){var a=f();return a&&(a="else{"+a+"}"),U(["if(",d,"){",e(),"}",a])}})},compile:function(){var c=['"use strict";',d,"return {"];Object.keys(j).forEach(function(a){c.push('"',a,'":',j[a].toString(),",")}),c.push("}");var b,a=U(c).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return e&&e[b=function(c){for(var a,d="",b=0;b<c.length;b++)a=c.charCodeAt(b),d+="0123456789abcdef".charAt(a>>>4&15)+"0123456789abcdef".charAt(15&a);return d}(function(a){for(var j,e=Array(a.length>>2),b=0;b<e.length;b++)e[b]=0;for(b=0;b<8*a.length;b+=8)e[b>>5]|=(255&a.charCodeAt(b/8))<<24-b%32;var d=8*a.length;a=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var k,l,o,i,m,n,h,p,c,g,f,b=Array(64);for(e[d>>5]|=128<<24-d%32,e[(d+64>>9<<4)+15]=d,p=0;p<e.length;p+=16){for(c=0,d=a[0],k=a[1],l=a[2],o=a[3],i=a[4],m=a[5],n=a[6],h=a[7];64>c;c++)16>c?b[c]=e[c+p]:(g=c,f=b[c-2],f=R(f,17)^R(f,19)^f>>>10,f=S(f,b[c-7]),j=b[c-15],j=R(j,7)^R(j,18)^j>>>3,b[g]=S(S(f,j),b[c-16])),g=S(S(S(S(h,g=R(g=i,6)^R(g,11)^R(g,25)),i&m^ ~i&n),ar[c]),b[c]),f=S(h=R(h=d,2)^R(h,13)^R(h,22),d&k^d&l^k&l),h=n,n=m,m=i,i=S(o,g),o=l,l=k,k=d,d=S(g,f);a[0]=S(d,a[0]),a[1]=S(k,a[1]),a[2]=S(l,a[2]),a[3]=S(o,a[3]),a[4]=S(i,a[4]),a[5]=S(m,a[5]),a[6]=S(n,a[6]),a[7]=S(h,a[7])}for(b=0,e="";b<32*a.length;b+=8)e+=String.fromCharCode(a[b>>5]>>>24-b%32&255);return e}(function(d){for(var a,e,b="",c=-1;++c<d.length;)a=d.charCodeAt(c),e=c+1<d.length?d.charCodeAt(c+1):0,55296<=a&&56319>=a&&56320<=e&&57343>=e&&(a=65536+((1023&a)<<10)+(1023&e),c++),127>=a?b+=String.fromCharCode(a):2047>=a?b+=String.fromCharCode(192|a>>>6&31,128|63&a):65535>=a?b+=String.fromCharCode(224|a>>>12&15,128|a>>>6&63,128|63&a):2097151>=a&&(b+=String.fromCharCode(240|a>>>18&7,128|a>>>12&63,128|a>>>6&63,128|63&a));return b}(a)))]?e[b].apply(null,h):(a=Function.apply(null,g.concat(a)),e&&(e[b]=a),a.apply(null,h))}}}({cache:Q}),b=a.link,c=a.global;a.id=aC++,a.batchId="0";var d=b(aB),e=a.shared={props:"a0"};Object.keys(aB).forEach(function(a){e[a]=c.def(d,".",a)});var f=a.next={},g=a.current={};Object.keys(N).forEach(function(a){Array.isArray(t[a])&&(f[a]=c.def(e.next,".",a),g[a]=c.def(e.current,".",a))});var h=a.constants={};Object.keys(v).forEach(function(a){h[a]=c.def(JSON.stringify(v[a]))}),a.invoke=function(d,c){switch(c.type){case 0:var f=["this",e.context,e.props,a.batchId];return d.def(b(c.data),".call(",f.slice(0,Math.max(c.data.length+1,4)),")");case 1:return d.def(e.props,c.data);case 2:return d.def(e.context,c.data);case 3:return d.def("this",c.data);case 4:return c.data.append(a,d),c.data.ref;case 5:return c.data.toString();case 6:return c.data.map(function(b){return a.invoke(d,b)})}},a.attribCache={};var i={};return a.scopeAttrib=function(a){if((a=y.id(a))in i)return i[a];var c=k.scope[a];return c||(c=k.scope[a]=new aq),i[a]=b(c)},a}function aa(a,b,c){var e=a.shared.context,d=a.scope();Object.keys(c).forEach(function(f){b.save(e,"."+f);var g=c[f].append(a,b);Array.isArray(g)?d(e,".",f,"=[",g.join(),"];"):d(e,".",f,"=",g,";")}),b(d)}function s(b,a,g,h){var e,c=b.shared,i=c.gl,f=c.framebuffer;L&&(e=a.def(c.extensions,".webgl_draw_buffers"));var d=b.constants,c=d.drawBuffer,d=d.backBuffer;b=g?g.append(b,a):a.def(f,".next"),h||a("if(",b,"!==",f,".cur){"),a("if(",b,"){",i,".bindFramebuffer(",36160,",",b,".framebuffer);"),L&&a(e,".drawBuffersWEBGL(",c,"[",b,".colorAttachments.length]);"),a("}else{",i,".bindFramebuffer(",36160,",null);"),L&&a(e,".drawBuffersWEBGL(",d,");"),a("}",f,".cur=",b,";"),h||a("}")}function ac(a,e,f){var b=a.shared,g=b.gl,h=a.current,i=a.next,c=b.current,j=b.next,d=a.cond(c,".dirty");aA.forEach(function(b){if(!((b=$(b))in f.state)){var e,l;if(b in i){e=i[b],l=h[b];var k=A(t[b].length,function(a){return d.def(e,"[",a,"]")});d(a.cond(k.map(function(a,b){return a+"!=="+l+"["+b+"]"}).join("||")).then(g,".",N[b],"(",k,");",k.map(function(a,b){return l+"["+b+"]="+a}).join(";"),";"))}else e=d.def(j,".",b),d(k=a.cond(e,"!==",c,".",b)),b in M?k(a.cond(e).then(g,".enable(",M[b],");").else(g,".disable(",M[b],");"),c,".",b,"=",e,";"):k(g,".",N[b],"(",e,");",c,".",b,"=",e,";")}}),0===Object.keys(f.state).length&&d(c,".dirty=false;"),e(d)}function ad(a,d,c,e){var f,b=a.shared,g=a.current,h=b.current,i=b.gl;W(Object.keys(c)).forEach(function(b){var k=c[b];if(!e||e(k)){var j=k.append(a,d);if(M[b]){var l=M[b];X(k)?(f=a.link(j,{stable:!0}),d(a.cond(f).then(i,".enable(",l,");").else(i,".disable(",l,");")),d(h,".",b,"=",f,";")):(d(a.cond(j).then(i,".enable(",l,");").else(i,".disable(",l,");")),d(h,".",b,"=",j,";"))}else if(J(j)){var m=g[b];d(i,".",N[b],"(",j,");",j.map(function(a,b){return m+"["+b+"]="+a}).join(";"),";")}else X(k)?(f=a.link(j,{stable:!0}),d(i,".",N[b],"(",f,");",h,".",b,"=",f,";")):d(i,".",N[b],"(",j,");",h,".",b,"=",j,";")}})}function ae(a,b){m&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays"))}function af(b,c,a,i,j){function k(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function f(a){a(l=c.def(),"=",k(),";"),"string"==typeof j?a(n,".count+=",j,";"):a(n,".count++;"),H&&(i?a(m=c.def(),"=",o,".getNumPendingQueries();"):a(o,".beginQuery(",n,");"))}function g(a){a(n,".cpuTime+=",k(),"-",l,";"),H&&(i?a(o,".pushScopeStats(",m,",",o,".getNumPendingQueries(),",n,");"):a(o,".endQuery();"))}function e(a){var b=c.def(h,".profile");c(h,".profile=",a,";"),c.exit(h,".profile=",b,";")}var l,m,d=b.shared,n=b.stats,h=d.current,o=d.timer;if(a=a.profile){if(X(a)){a.enable?(f(c),g(c.exit),e("true")):e("false");return}e(a=a.append(b,c))}else a=c.def(h,".profile");f(d=b.block()),c("if(",a,"){",d,"}"),g(b=b.block()),c.exit("if(",a,"){",b,"}")}function ag(a,c,d,b,e){var f=a.shared;b.forEach(function(b){var g,i=b.name,h=d.attributes[i];if(h){if(!e(h))return;g=h.append(a,c)}else{if(!e(ay))return;var j=a.scopeAttrib(i);g={},Object.keys(new aq).forEach(function(a){g[a]=c.def(j,".",a)})}!function(d,i,b){function e(){c("if(!",k,".buffer){",j,".enableVertexAttribArray(",h,");}");var e,d=b.type;e=b.size?c.def(b.size,"||",i):i,c("if(",k,".type!==",d,"||",k,".size!==",e,"||",o.map(function(a){return k+"."+a+"!=="+b[a]}).join("||"),"){",j,".bindBuffer(",34962,",",l,".buffer);",j,".vertexAttribPointer(",[h,e,d,b.normalized,b.stride,b.offset],");",k,".type=",d,";",k,".size=",e,";",o.map(function(a){return k+"."+a+"="+b[a]+";"}).join(""),"}"),m&&c("if(",k,".divisor!==",d=b.divisor,"){",a.instancing,".vertexAttribDivisorANGLE(",[h,d],");",k,".divisor=",d,";}")}function g(){c("if(",k,".buffer){",j,".disableVertexAttribArray(",h,");",k,".buffer=null;","}if(",as.map(function(a,b){return k+"."+a+"!=="+n[b]}).join("||"),"){",j,".vertexAttrib4f(",h,",",n,");",as.map(function(a,b){return k+"."+a+"="+n[b]+";"}).join(""),"}")}var j=f.gl,h=c.def(d,".location"),k=c.def(f.attributes,"[",h,"]");d=b.state;var l=b.buffer,n=[b.x,b.y,b.z,b.w],o=["buffer","normalized","offset","stride"];1===d?e():2===d?g():(c("if(",d,"===",1,"){"),e(),c("}else{"),g(),c("}"))}(a.link(b),function(a){switch(a){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(b.info.type),g)})}function ai(h,c,q,m,n,j){for(var a,o=h.shared,i=o.gl,k=0;k<m.length;++k){var d,f=m[k],e=f.name,b=f.info.type,g=q.uniforms[e],f=h.link(f)+".location";if(g){if(!n(g))continue;if(X(g)){if(e=g.value,35678===b||35680===b)c(i,".uniform1i(",f,",",(b=h.link(e._texture||e.color[0]._texture))+".bind());"),c.exit(b,".unbind();");else if(35674===b||35675===b||35676===b)e=h.global.def("new Float32Array(["+Array.prototype.slice.call(e)+"])"),g=2,35675===b?g=3:35676===b&&(g=4),c(i,".uniformMatrix",g,"fv(",f,",false,",e,");");else{switch(b){case 5126:a="1f";break;case 35664:a="2f";break;case 35665:a="3f";break;case 35666:a="4f";break;case 35670:a="1i";break;case 5124:a="1i";break;case 35671:a="2i";break;case 35667:a="2i";break;case 35672:a="3i";break;case 35668:a="3i";break;case 35673:a="4i";break;case 35669:a="4i"}c(i,".uniform",a,"(",f,",",J(e)?Array.prototype.slice.call(e):e,");")}continue}d=g.append(h,c)}else{if(!n(ay))continue;d=c.def(o.uniforms,"[",y.id(e),"]")}switch(35678===b?c("if(",d,"&&",d,'._reglType==="framebuffer"){',d,"=",d,".color[0];","}"):35680===b&&c("if(",d,"&&",d,'._reglType==="framebufferCube"){',d,"=",d,".color[0];","}"),e=1,b){case 35678:case 35680:b=c.def(d,"._texture"),c(i,".uniform1i(",f,",",b,".bind());"),c.exit(b,".unbind();");continue;case 5124:case 35670:a="1i";break;case 35667:case 35671:a="2i",e=2;break;case 35668:case 35672:a="3i",e=3;break;case 35669:case 35673:a="4i",e=4;break;case 5126:a="1f";break;case 35664:a="2f",e=2;break;case 35665:a="3f",e=3;break;case 35666:a="4f",e=4;break;case 35674:a="Matrix2fv";break;case 35675:a="Matrix3fv";break;case 35676:a="Matrix4fv"}if("M"===a.charAt(0)){c(i,".uniform",a,"(",f,",");var f=Math.pow(b-35674+2,2),p=h.global.def("new Float32Array(",f,")");Array.isArray(d)?c("false,(",A(f,function(a){return p+"["+a+"]="+d[a]}),",",p,")"):c("false,(Array.isArray(",d,")||",d," instanceof Float32Array)?",d,":(",A(f,function(a){return p+"["+a+"]="+d+"["+a+"]"}),",",p,")"),c(");")}else{if(1<e){for(var b=[],l=[],g=0;g<e;++g)Array.isArray(d)?l.push(d[g]):l.push(c.def(d+"["+g+"]")),j&&b.push(c.def());j&&c("if(!",h.batchId,"||",b.map(function(a,b){return a+"!=="+l[b]}).join("||"),"){",b.map(function(a,b){return a+"="+l[b]+";"}).join("")),c(i,".uniform",a,"(",f,",",l.join(","),");")}else j&&(b=c.def(),c("if(!",h.batchId,"||",b,"!==",d,"){",b,"=",d,";")),c(i,".uniform",a,"(",f,",",d,");");j&&c("}")}}}function aj(g,o,c,j){function k(b){var a=f[b];return a?a.contextDep&&j.contextDynamic||a.propDep?a.append(g,c):a.append(g,o):o.def(r,".",b)}function p(){function a(){c(s,".drawElementsInstancedANGLE(",[u,n,w,v+"<<(("+w+"-5121)>>1)",e],");")}function b(){c(s,".drawArraysInstancedANGLE(",[u,v,n,e],");")}t&&"null"!==t?x?a():(c("if(",t,"){"),a(),c("}else{"),b(),c("}")):b()}function q(){function a(){c(l+".drawElements("+[u,n,w,v+"<<(("+w+"-5121)>>1)"]+");")}function b(){c(l+".drawArrays("+[u,v,n]+");")}t&&"null"!==t?x?a():(c("if(",t,"){"),a(),c("}else{"),b(),c("}")):b()}var a,d,b,h,e,s,i=g.shared,l=i.gl,r=i.draw,f=j.draw,t=(a=f.elements,d=o,a?((a.contextDep&&j.contextDynamic||a.propDep)&&(d=c),a=a.append(g,d),f.elementsActive&&d("if("+a+")"+l+".bindBuffer(34963,"+a+".buffer.buffer);")):(a=d.def(),d(a,"=",r,".","elements",";","if(",a,"){",l,".bindBuffer(",34963,",",a,".buffer.buffer);}","else if(",i.vao,".currentVAO){",a,"=",g.shared.elements+".getElements("+i.vao,".currentVAO.elements);",az?"":"if("+a+")"+l+".bindBuffer(34963,"+a+".buffer.buffer);","}")),a),u=k("primitive"),v=k("offset"),n=(b=f.count,h=o,b?((b.contextDep&&j.contextDynamic||b.propDep)&&(h=c),b=b.append(g,h)):b=h.def(r,".","count"),b);if("number"==typeof n){if(0===n)return}else c("if(",n,"){"),c.exit("}");m&&(e=k("instances"),s=g.instancing);var w=t+".type",x=f.elements&&X(f.elements)&&!f.vaoActive;m&&("number"!=typeof e||0<=e)?"string"==typeof e?(c("if(",e,">0){"),p(),c("}else if(",e,"<0){"),q(),c("}")):p():q()}function ak(c,a,d,e,b){return b=(a=K()).proc("body",b),m&&(a.instancing=b.def(a.shared.extensions,".angle_instanced_arrays")),c(a,b,d,e),a.compile().body}function am(a,b,c,d){ae(a,b),c.useVAO?c.drawVAO?b(a.shared.vao,".setVAO(",c.drawVAO.append(a,b),");"):b(a.shared.vao,".setVAO(",a.shared.vao,".targetVAO);"):(b(a.shared.vao,".setVAO(null);"),ag(a,b,c,d.attributes,function(){return!0})),ai(a,b,c,d.uniforms,function(){return!0},!1),aj(a,b,b,c)}function an(a,b,c,d){function e(){return!0}a.batchId="a1",ae(a,b),ag(a,b,c,d.attributes,e),ai(a,b,c,d.uniforms,e,!1),aj(a,b,b,c)}function ao(a,f,b,e){function h(a){return a.contextDep&&k||a.propDep}function j(a){return!h(a)}ae(a,f);var k=b.contextDep,g=f.def(),i=f.def();a.shared.props=i,a.batchId=g;var d=a.scope(),c=a.scope();f(d.entry,"for(",g,"=0;",g,"<","a1",";++",g,"){",i,"=","a0","[",g,"];",c,"}",d.exit),b.needsContext&&aa(a,c,b.context),b.needsFramebuffer&&s(a,c,b.framebuffer),ad(a,c,b.state,h),b.profile&&h(b.profile)&&af(a,c,b,!1,!0),e?(b.useVAO?b.drawVAO?h(b.drawVAO)?c(a.shared.vao,".setVAO(",b.drawVAO.append(a,c),");"):d(a.shared.vao,".setVAO(",b.drawVAO.append(a,d),");"):d(a.shared.vao,".setVAO(",a.shared.vao,".targetVAO);"):(d(a.shared.vao,".setVAO(null);"),ag(a,d,b,e.attributes,j),ag(a,c,b,e.attributes,h)),ai(a,d,b,e.uniforms,j,!1),ai(a,c,b,e.uniforms,h,!0),aj(a,d,c,b)):(f=a.global.def("{}"),e=b.shader.progVar.append(a,c),i=c.def(e,".id"),d=c.def(f,"[",i,"]"),c(a.shared.gl,".useProgram(",e,".program);","if(!",d,"){",d,"=",f,"[",i,"]=",a.link(function(c){return ak(an,a,b,c,2)}),"(",e,");}",d,".call(this,a0[",g,"],",g,");"))}function ap(d,a,b){var c=a.static[b];if(c&&function(a){if("object"==typeof a&&!J(a)){for(var c=Object.keys(a),b=0;b<c.length;++b)if(ab.isDynamic(a[c[b]]))return!0;return!1}}(c)){var j=d.global,e=Object.keys(c),f=!1,g=!1,h=!1,i=d.global.def("{}");e.forEach(function(b){var a=c[b];if(ab.isDynamic(a))"function"==typeof a&&(a=c[b]=ab.unbox(a)),b=Z(a,null),f=f||b.thisDep,h=h||b.propDep,g=g||b.contextDep;else{switch(j(i,".",b,"="),typeof a){case"number":j(a);break;case"string":j('"',a,'"');break;case"object":Array.isArray(a)&&j("[",a.join(),"]");break;default:j(d.link(a))}j(";")}}),a.dynamic[b]=new ab.DynamicVariable(4,{thisDep:f,contextDep:g,propDep:h,ref:i,append:function(a,b){e.forEach(function(e){var d=c[e];ab.isDynamic(d)&&(d=a.invoke(b,d),b(i,".",e,"=",d,";"))})}}),delete a.static[b]}}var aq=k.Record,l={add:32774,subtract:32778,"reverse subtract":32779};g.ext_blend_minmax&&(l.min=32775,l.max=32776);var m=g.angle_instanced_arrays,L=g.webgl_draw_buffers,az=g.oes_vertex_array_object,t={dirty:!0,profile:I.profile},u={},aA=[],M={},N={};d("dither",3024),d("blend.enable",3042),a("blend.color","blendColor",[0,0,0,0]),a("blend.equation","blendEquationSeparate",[32774,32774]),a("blend.func","blendFuncSeparate",[1,0,1,0]),d("depth.enable",2929,!0),a("depth.func","depthFunc",513),a("depth.range","depthRange",[0,1]),a("depth.mask","depthMask",!0),a("colorMask","colorMask",[!0,!0,!0,!0]),d("cull.enable",2884),a("cull.face","cullFace",1029),a("frontFace","frontFace",2305),a("lineWidth","lineWidth",1),d("polygonOffset.enable",32823),a("polygonOffset.offset","polygonOffset",[0,0]),d("sample.alpha",32926),d("sample.enable",32928),a("sample.coverage","sampleCoverage",[1,!1]),d("stencil.enable",2960),a("stencil.mask","stencilMask",-1),a("stencil.func","stencilFunc",[519,0,-1]),a("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),a("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),d("scissor.enable",3089),a("scissor.box","scissor",[0,0,i.drawingBufferWidth,i.drawingBufferHeight]),a("viewport","viewport",[0,0,i.drawingBufferWidth,i.drawingBufferHeight]);var aB={gl:i,context:G,strings:y,next:u,current:t,draw:F,elements:B,buffer:z,shader:E,attributes:k.state,vao:k,uniforms:D,framebuffer:C,extensions:g,timer:H,isBufferArgs:V},v={primTypes:al,compareFuncs:av,blendFuncs:au,blendEquations:l,stencilOps:aw,glTypes:ah,orientationType:ax};L&&(v.backBuffer=[1029],v.drawBuffer=A(r.maxDrawbuffers,function(a){return 0===a?[0]:A(a,function(a){return 36064+a})}));var w,b,o,e,j,f,h,O,x,f,c,p,q,aC=0;return{next:u,current:t,procs:(o=(b=K()).proc("poll"),e=b.proc("refresh"),j=b.block(),o(j),e(j),f=b.shared,h=f.gl,O=f.next,x=f.current,j(x,".dirty=false;"),s(b,o),s(b,e,null,!0),m&&(w=b.link(m)),g.oes_vertex_array_object&&e(b.link(g.oes_vertex_array_object),".bindVertexArrayOES(null);"),f=e.def(f.attributes),c=e.def(0),p=b.cond(c,".buffer"),p.then(h,".enableVertexAttribArray(i);",h,".bindBuffer(",34962,",",c,".buffer.buffer);",h,".vertexAttribPointer(i,",c,".size,",c,".type,",c,".normalized,",c,".stride,",c,".offset);").else(h,".disableVertexAttribArray(i);",h,".vertexAttrib4f(i,",c,".x,",c,".y,",c,".z,",c,".w);",c,".buffer=null;"),q=b.link(r.maxAttributes,{stable:!0}),e("for(var i=0;i<",q,";++i){",c,"=",f,"[i];",p,"}"),m&&e("for(var i=0;i<",q,";++i){",w,".vertexAttribDivisorANGLE(i,",f,"[i].divisor);","}"),e(b.shared.vao,".currentVAO=null;",b.shared.vao,".setVAO(",b.shared.vao,".targetVAO);"),Object.keys(M).forEach(function(a){var f=M[a],c=j.def(O,".",a),d=b.block();d("if(",c,"){",h,".enable(",f,")}else{",h,".disable(",f,")}",x,".",a,"=",c,";"),e(d),o("if(",c,"!==",x,".",a,"){",d,"}")}),Object.keys(N).forEach(function(a){var d,g,f=N[a],i=t[a],c=b.block();c(h,".",f,"("),J(i)?(f=i.length,d=b.global.def(O,".",a),g=b.global.def(x,".",a),c(A(f,function(a){return d+"["+a+"]"}),");",A(f,function(a){return g+"["+a+"]="+d+"["+a+"];"}).join("")),o("if(",A(f,function(a){return d+"["+a+"]!=="+g+"["+a+"]"}).join("||"),"){",c,"}")):(d=j.def(O,".",a),g=j.def(x,".",a),c(d,");",x,".",a,"=",d,";"),o("if(",d,"!==",g,"){",c,"}")),e(c)}),b.compile()),compile:function(d,c,e,f,h){var a=K();a.stats=a.link(h),Object.keys(c.static).forEach(function(b){ap(a,c,b)}),at.forEach(function(b){ap(a,d,b)});var b=function(b,h,H,I,c){function i(a){var b=O[a];b&&(w[a]=b)}var j,m,o,p,q,r,s,t,u,K,L,v,e=function(f,d){var a=f.static;if("string"==typeof a.frag&&"string"==typeof a.vert){if(0<Object.keys(d.dynamic).length)return null;var a=d.static,b=Object.keys(a);if(0<b.length&&"number"==typeof a[b[0]]){for(var e=[],c=0;c<b.length;++c)e.push([0|a[b[c]],b[c]]);return e}}return null}(b,h),a=function(b,f){var c=b.static,d=b.dynamic;if("framebuffer"in c){var a=c.framebuffer;return a?(a=C.getFramebuffer(a),Y(function(e,d){var c=e.link(a),b=e.shared;return d.set(b.framebuffer,".next",c),b=b.context,d.set(b,".framebufferWidth",c+".width"),d.set(b,".framebufferHeight",c+".height"),c})):Y(function(c,b){var a=c.shared;return b.set(a.framebuffer,".next","null"),a=a.context,b.set(a,".framebufferWidth",a+".drawingBufferWidth"),b.set(a,".framebufferHeight",a+".drawingBufferHeight"),"null"})}if("framebuffer"in d){var e=d.framebuffer;return Z(e,function(d,c){var a=d.invoke(c,e),b=d.shared,f=b.framebuffer,a=c.def(f,".getFramebuffer(",a,")");return c.set(f,".next",a),b=b.context,c.set(b,".framebufferWidth",a+"?"+a+".width:"+b+".drawingBufferWidth"),c.set(b,".framebufferHeight",a+"?"+a+".height:"+b+".drawingBufferHeight"),a})}return null}(b,c),O=function(a,c,d){function b(a){if(a in e){var b=e[a];a=!0;var d,g,i=0|b.x,j=0|b.y;return"width"in b?d=0|b.width:a=!1,"height"in b?g=0|b.height:a=!1,new n(!a&&c&&c.thisDep,!a&&c&&c.contextDep,!a&&c&&c.propDep,function(h,a){var c=h.shared.context,e=d;"width"in b||(e=a.def(c,".","framebufferWidth","-",i));var f=g;return"height"in b||(f=a.def(c,".","framebufferHeight","-",j)),[i,j,e,f]})}if(a in f){var h=f[a];return a=Z(h,function(c,b){var a=c.invoke(b,h),d=c.shared.context,e=b.def(a,".x|0"),f=b.def(a,".y|0"),g=b.def('"width" in ',a,"?",a,".width|0:","(",d,".","framebufferWidth","-",e,")"),a=b.def('"height" in ',a,"?",a,".height|0:","(",d,".","framebufferHeight","-",f,")");return[e,f,g,a]}),c&&(a.thisDep=a.thisDep||c.thisDep,a.contextDep=a.contextDep||c.contextDep,a.propDep=a.propDep||c.propDep),a}return c?new n(c.thisDep,c.contextDep,c.propDep,function(c,a){var b=c.shared.context;return[0,0,a.def(b,".","framebufferWidth"),a.def(b,".","framebufferHeight")]}):null}var e=a.static,f=a.dynamic;if(a=b("viewport")){var g=a;a=new n(a.thisDep,a.contextDep,a.propDep,function(c,a){var b=g.append(c,a),d=c.shared.context;return a.set(d,".viewportWidth",b[2]),a.set(d,".viewportHeight",b[3]),b})}return{viewport:a,scissor_box:b("scissor.box")}}(b,a,c),d=function(a,i){function b(a,b){if(a in j){var g=0|j[a];return b?c.offset=g:c.instances=g,Y(function(a,c){return b&&(a.OFFSET=g),g})}if(a in l){var h=l[a];return Z(h,function(a,d){var c=a.invoke(d,h);return b&&(a.OFFSET=c),c})}if(b){if(f)return Y(function(a,b){return a.OFFSET=0});if(d)return new n(e.thisDep,e.contextDep,e.propDep,function(a,b){return b.def(a.shared.vao+".currentVAO?"+a.shared.vao+".currentVAO.offset:0")})}else if(d)return new n(e.thisDep,e.contextDep,e.propDep,function(a,b){return b.def(a.shared.vao+".currentVAO?"+a.shared.vao+".currentVAO.instances:-1")});return null}var j=a.static,l=a.dynamic,c={},d=!1,e=function(){if("vao"in j){var a=j.vao;return null!==a&&null===k.getVAO(a)&&(a=k.createVAO(a)),d=!0,c.vao=a,Y(function(c){var b=k.getVAO(a);return b?c.link(b):"null"})}if("vao"in l){d=!0;var b=l.vao;return Z(b,function(a,c){var d=a.invoke(c,b);return c.def(a.shared.vao+".getVAO("+d+")")})}return null}(),f=!1,g=function(){if("elements"in j){var a=j.elements;if(c.elements=a,V(a)){var b=c.elements=B.create(a,!0),a=B.getElements(b);f=!0}else a&&(a=B.getElements(a),f=!0);return(b=Y(function(b,d){if(a){var c=b.link(a);return b.ELEMENTS=c}return b.ELEMENTS=null})).value=a,b}if("elements"in l){f=!0;var g=l.elements;return Z(g,function(b,c){var a=b.shared,e=a.isBufferArgs,a=a.elements,d=b.invoke(c,g),f=c.def("null"),e=c.def(e,"(",d,")"),d=b.cond(e).then(f,"=",a,".createStream(",d,");").else(f,"=",a,".getElements(",d,");");return c.entry(d),c.exit(b.cond(e).then(a,".destroyStream(",f,");")),b.ELEMENTS=f})}return d?new n(e.thisDep,e.contextDep,e.propDep,function(a,b){return b.def(a.shared.vao+".currentVAO?"+a.shared.elements+".getElements("+a.shared.vao+".currentVAO.elements):null")}):null}(),h=b("offset",!0);return{elements:g,primitive:function(){if("primitive"in j){var a=j.primitive;return c.primitive=a,Y(function(b,c){return al[a]})}if("primitive"in l){var b=l.primitive;return Z(b,function(a,c){var d=a.constants.primTypes,e=a.invoke(c,b);return c.def(d,"[",e,"]")})}return f?X(g)?g.value?Y(function(a,b){return b.def(a.ELEMENTS,".primType")}):Y(function(){return 4}):new n(g.thisDep,g.contextDep,g.propDep,function(b,c){var a=b.ELEMENTS;return c.def(a,"?",a,".primType:",4)}):d?new n(e.thisDep,e.contextDep,e.propDep,function(a,b){return b.def(a.shared.vao+".currentVAO?"+a.shared.vao+".currentVAO.primitive:4")}):null}(),count:function(){if("count"in j){var a=0|j.count;return c.count=a,Y(function(){return a})}if("count"in l){var b=l.count;return Z(b,function(a,c){return a.invoke(c,b)})}return f?X(g)?g?h?new n(h.thisDep,h.contextDep,h.propDep,function(a,b){return b.def(a.ELEMENTS,".vertCount-",a.OFFSET)}):Y(function(a,b){return b.def(a.ELEMENTS,".vertCount")}):Y(function(){return -1}):new n(g.thisDep||h.thisDep,g.contextDep||h.contextDep,g.propDep||h.propDep,function(b,c){var a=b.ELEMENTS;return b.OFFSET?c.def(a,"?",a,".vertCount-",b.OFFSET,":-1"):c.def(a,"?",a,".vertCount:-1")}):d?new n(e.thisDep,e.contextDep,e.propDep,function(a,b){return b.def(a.shared.vao,".currentVAO?",a.shared.vao,".currentVAO.count:-1")}):null}(),instances:b("instances",!1),offset:h,vao:e,vaoActive:d,elementsActive:f,static:c}}(b,c),w=(K=(u=b).static,L=u.dynamic,v={},aA.forEach(function(b){function a(a,e){if(b in K){var f=a(K[b]);v[c]=Y(function(){return f})}else if(b in L){var d=L[b];v[c]=Z(d,function(a,b){return e(a,b,a.invoke(b,d))})}}var c=$(b);switch(b){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return a(function(a){return a},function(b,c,a){return a});case"depth.func":return a(function(a){return av[a]},function(a,b,c){return b.def(a.constants.compareFuncs,"[",c,"]")});case"depth.range":return a(function(a){return a},function(b,a,c){return b=a.def("+",c,"[0]"),a=a.def("+",c,"[1]"),[b,a]});case"blend.func":return a(function(a){return[au["srcRGB"in a?a.srcRGB:a.src],au["dstRGB"in a?a.dstRGB:a.dst],au["srcAlpha"in a?a.srcAlpha:a.src],au["dstAlpha"in a?a.dstAlpha:a.dst]]},function(a,b,g){function c(a,c){return b.def('"',a,c,'" in ',g,"?",g,".",a,c,":",g,".",a)}a=a.constants.blendFuncs;var d=c("src","RGB"),e=c("dst","RGB"),d=b.def(a,"[",d,"]"),f=b.def(a,"[",c("src","Alpha"),"]"),e=b.def(a,"[",e,"]");return[d,e,f,a=b.def(a,"[",c("dst","Alpha"),"]")]});case"blend.equation":return a(function(a){return"string"==typeof a?[l[a],l[a]]:"object"==typeof a?[l[a.rgb],l[a.alpha]]:void 0},function(a,c,b){var d=a.constants.blendEquations,e=c.def(),f=c.def();return(a=a.cond("typeof ",b,'==="string"')).then(e,"=",f,"=",d,"[",b,"];"),a.else(e,"=",d,"[",b,".rgb];",f,"=",d,"[",b,".alpha];"),c(a),[e,f]});case"blend.color":return a(function(a){return A(4,function(b){return+a[b]})},function(a,b,c){return A(4,function(a){return b.def("+",c,"[",a,"]")})});case"stencil.mask":return a(function(a){return 0|a},function(c,a,b){return a.def(b,"|0")});case"stencil.func":return a(function(a){return[av[a.cmp||"keep"],a.ref||0,"mask"in a?a.mask:-1]},function(c,b,a){c=b.def('"cmp" in ',a,"?",c.constants.compareFuncs,"[",a,".cmp]",":",7680);var d=b.def(a,".ref|0");return[c,d,b=b.def('"mask" in ',a,"?",a,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return a(function(a){return["stencil.opBack"===b?1029:1028,aw[a.fail||"keep"],aw[a.zfail||"keep"],aw[a.zpass||"keep"]]},function(c,d,e){function a(a){return d.def('"',a,'" in ',e,"?",f,"[",e,".",a,"]:",7680)}var f=c.constants.stencilOps;return["stencil.opBack"===b?1029:1028,a("fail"),a("zfail"),a("zpass")]});case"polygonOffset.offset":return a(function(a){return[0|a.factor,0|a.units]},function(b,a,c){return b=a.def(c,".factor|0"),a=a.def(c,".units|0"),[b,a]});case"cull.face":return a(function(b){var a=0;return"front"===b?a=1028:"back"===b&&(a=1029),a},function(c,a,b){return a.def(b,'==="front"?',1028,":",1029)});case"lineWidth":return a(function(a){return a},function(b,c,a){return a});case"frontFace":return a(function(a){return ax[a]},function(c,a,b){return a.def(b+'==="cw"?2304:2305')});case"colorMask":return a(function(a){return a.map(function(a){return!!a})},function(a,b,c){return A(4,function(a){return"!!"+c+"["+a+"]"})});case"sample.coverage":return a(function(a){return["value"in a?a.value:1,!!a.invert]},function(c,a,b){return c=a.def('"value" in ',b,"?+",b,".value:1"),a=a.def("!!",b,".invert"),[c,a]})}}),v),f=function(c,g,f){function d(a){if(a in h){var b=y.id(h[a]);return(a=Y(function(){return b})).id=b,a}if(a in i){var c=i[a];return Z(c,function(a,b){var d=a.invoke(b,c);return b.def(a.shared.strings,".id(",d,")")})}return null}var h=c.static,i=c.dynamic,a=d("frag"),b=d("vert"),e=null;return X(a)&&X(b)?(e=E.program(b.id,a.id,null,f),c=Y(function(a,b){return a.link(e)})):c=new n(a&&a.thisDep||b&&b.thisDep,a&&a.contextDep||b&&b.contextDep,a&&a.propDep||b&&b.propDep,function(d,c){var f,g,e=d.shared.shader;return g=a?a.append(d,c):c.def(e,".","frag"),f=b?b.append(d,c):c.def(e,".","vert"),c.def(e+".program("+f+","+g+")")}),{frag:a,vert:b,progVar:c,program:e}}(b,c,e);i("viewport"),i($("scissor.box"));var x,D,F,G,M=0<Object.keys(w).length,a={framebuffer:a,draw:d,shader:f,state:w,dirty:M,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(a.profile=function(a){var b,c=a.static;if(a=a.dynamic,"profile"in c){var d=!!c.profile;(b=Y(function(a,b){return d})).enable=d}else if("profile"in a){var e=a.profile;b=Z(e,function(a,b){return a.invoke(b,e)})}return b}(b,c),a.uniforms=(D=(x=H).static,F=x.dynamic,G={},Object.keys(D).forEach(function(d){var a,b=D[d];if("number"==typeof b||"boolean"==typeof b)a=Y(function(){return b});else if("function"==typeof b){var c=b._reglType;"texture2d"===c||"textureCube"===c?a=Y(function(a){return a.link(b)}):("framebuffer"===c||"framebufferCube"===c)&&(a=Y(function(a){return a.link(b.color[0])}))}else J(b)&&(a=Y(function(a){return a.global.def("[",A(b.length,function(a){return b[a]}),"]")}));a.value=b,G[d]=a}),Object.keys(F).forEach(function(a){var b=F[a];G[a]=Z(b,function(a,c){return a.invoke(c,b)})}),G),a.drawVAO=a.scopeVAO=d.vao,!a.drawVAO&&f.program&&!e&&g.angle_instanced_arrays&&d.static.elements){var N=!0;if(b=f.program.attributes.map(function(a){return a=h.static[a],N=N&&!!a,a}),N&&0<b.length){var P=k.getVAO(k.createVAO({attributes:b,elements:d.static.elements}));a.drawVAO=new n(null,null,null,function(a,b){return a.link(P)}),a.useVAO=!0}}return e?a.useVAO=!0:a.attributes=(m=(j=h).static,o=j.dynamic,p={},Object.keys(m).forEach(function(d){var a=m[d],k=y.id(d),b=new aq;if(V(a))b.state=1,b.buffer=z.getBuffer(z.create(a,34962,!1,!0)),b.type=0;else{var c=z.getBuffer(a);if(c)b.state=1,b.buffer=c,b.type=0;else if("constant"in a){var e=a.constant;b.buffer="null",b.state=2,"number"==typeof e?b.x=e:as.forEach(function(c,a){a<e.length&&(b[c]=e[a])})}else{var c=V(a.buffer)?z.getBuffer(z.create(a.buffer,34962,!1,!0)):z.getBuffer(a.buffer),g=0|a.offset,h=0|a.stride,i=0|a.size,j=!!a.normalized,f=0;"type"in a&&(f=ah[a.type]),a=0|a.divisor,b.buffer=c,b.state=1,b.size=i,b.normalized=j,b.type=f||c.dtype,b.offset=g,b.stride=h,b.divisor=a}}p[d]=Y(function(d,e){var c=d.attribCache;if(k in c)return c[k];var a={isStream:!1};return Object.keys(b).forEach(function(c){a[c]=b[c]}),b.buffer&&(a.buffer=d.link(b.buffer),a.type=a.type||a.buffer+".dtype"),c[k]=a})}),Object.keys(o).forEach(function(a){var b=o[a];p[a]=Z(b,function(h,f){function g(b){f(e[b],"=",a,".",b,"|0;")}var a=h.invoke(f,b),d=h.shared,l=h.constants,j=d.isBufferArgs,d=d.buffer,e={isStream:f.def(!1)},k=new aq;k.state=1,Object.keys(k).forEach(function(a){e[a]=f.def(""+k[a])});var c=e.buffer,i=e.type;return f("if(",j,"(",a,")){",e.isStream,"=true;",c,"=",d,".createStream(",34962,",",a,");",i,"=",c,".dtype;","}else{",c,"=",d,".getBuffer(",a,");","if(",c,"){",i,"=",c,".dtype;",'}else if("constant" in ',a,"){",e.state,"=",2,";","if(typeof "+a+'.constant === "number"){',e[as[0]],"=",a,".constant;",as.slice(1).map(function(a){return e[a]}).join("="),"=0;","}else{",as.map(function(c,b){return e[c]+"="+a+".constant.length>"+b+"?"+a+".constant["+b+"]:0;"}).join(""),"}}else{","if(",j,"(",a,".buffer)){",c,"=",d,".createStream(",34962,",",a,".buffer);","}else{",c,"=",d,".getBuffer(",a,".buffer);","}",i,'="type" in ',a,"?",l.glTypes,"[",a,".type]:",c,".dtype;",e.normalized,"=!!",a,".normalized;"),g("size"),g("offset"),g("stride"),g("divisor"),f("}}"),f.exit("if(",e.isStream,"){",d,".destroyStream(",c,");","}"),e})}),p),a.context=(r=(q=I).static,s=q.dynamic,t={},Object.keys(r).forEach(function(a){var b=r[a];t[a]=Y(function(a,c){return"number"==typeof b||"boolean"==typeof b?""+b:a.link(b)})}),Object.keys(s).forEach(function(a){var b=s[a];t[a]=Z(b,function(a,c){return a.invoke(c,b)})}),t),a}(d,c,e,f,a);return b.shader.program&&(b.shader.program.attributes.sort(function(a,b){return a.name<b.name?-1:1}),b.shader.program.uniforms.sort(function(a,b){return a.name<b.name?-1:1})),!function(a,c){var b=a.proc("draw",1);ae(a,b),aa(a,b,c.context),s(a,b,c.framebuffer),ac(a,b,c),ad(a,b,c.state),af(a,b,c,!1,!0);var e=c.shader.progVar.append(a,b);if(b(a.shared.gl,".useProgram(",e,".program);"),c.shader.program)am(a,b,c,c.shader.program);else{b(a.shared.vao,".setVAO(null);");var f=a.global.def("{}"),g=b.def(e,".id"),d=b.def(f,"[",g,"]");b(a.cond(d).then(d,".call(this,a0);").else(d,"=",f,"[",g,"]=",a.link(function(b){return ak(am,a,c,b,1)}),"(",e,");",d,".call(this,a0);"))}0<Object.keys(c.state).length&&b(a.shared.current,".dirty=true;"),a.shared.vao&&b(a.shared.vao,".setVAO(null);")}(a,b),!function(a,b){function f(f){var e=b.shader[f];e&&(isNaN(e=e.append(a,c))?c.set(d.shader,"."+f,e):c.set(d.shader,"."+f,a.link(e,{stable:!0})))}var c=a.proc("scope",3);a.batchId="a2";var d=a.shared,g=d.current;if(aa(a,c,b.context),b.framebuffer&&b.framebuffer.append(a,c),W(Object.keys(b.state)).forEach(function(f){var g=b.state[f],e=g.append(a,c);J(e)?e.forEach(function(b,d){isNaN(b)?c.set(a.next[f],"["+d+"]",b):c.set(a.next[f],"["+d+"]",a.link(b,{stable:!0}))}):X(g)?c.set(d.next,"."+f,a.link(e,{stable:!0})):c.set(d.next,"."+f,e)}),af(a,c,b,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(f){var e=b.draw[f];e&&(isNaN(e=e.append(a,c))?c.set(d.draw,"."+f,e):c.set(d.draw,"."+f,a.link(e),{stable:!0}))}),Object.keys(b.uniforms).forEach(function(f){var e=b.uniforms[f].append(a,c);Array.isArray(e)&&(e="["+e.map(function(b){return isNaN(b)?b:a.link(b,{stable:!0})})+"]"),c.set(d.uniforms,"["+a.link(y.id(f),{stable:!0})+"]",e)}),Object.keys(b.attributes).forEach(function(d){var e=b.attributes[d].append(a,c),f=a.scopeAttrib(d);Object.keys(new aq).forEach(function(a){c.set(f,"."+a,e[a])})}),b.scopeVAO){var e=b.scopeVAO.append(a,c);isNaN(e)?c.set(d.vao,".targetVAO",e):c.set(d.vao,".targetVAO",a.link(e,{stable:!0}))}f("vert"),f("frag"),0<Object.keys(b.state).length&&(c(g,".dirty=true;"),c.exit(g,".dirty=true;")),c("a1(",a.shared.context,",a0,",a.batchId,");")}(a,b),!function(a,b){function i(a){return a.contextDep&&g||a.propDep}var c=a.proc("batch",2);a.batchId="0",ae(a,c);var g=!1,d=!0;Object.keys(b.context).forEach(function(a){g=g||b.context[a].propDep}),g||(aa(a,c,b.context),d=!1);var e=b.framebuffer,f=!1;if(e?(e.propDep?g=f=!0:e.contextDep&&g&&(f=!0),f||s(a,c,e)):s(a,c,null),b.state.viewport&&b.state.viewport.propDep&&(g=!0),ac(a,c,b),ad(a,c,b.state,function(a){return!i(a)}),b.profile&&i(b.profile)||af(a,c,b,!1,"a1"),b.contextDep=g,b.needsContext=d,b.needsFramebuffer=f,(d=b.shader.progVar).contextDep&&g||d.propDep)ao(a,c,b,null);else if(d=d.append(a,c),c(a.shared.gl,".useProgram(",d,".program);"),b.shader.program)ao(a,c,b,b.shader.program);else{c(a.shared.vao,".setVAO(null);");var e=a.global.def("{}"),f=c.def(d,".id"),h=c.def(e,"[",f,"]");c(a.cond(h).then(h,".call(this,a0,a1);").else(h,"=",e,"[",f,"]=",a.link(function(c){return ak(ao,a,b,c,2)}),"(",d,");",h,".call(this,a0,a1);"))}0<Object.keys(b.state).length&&c(a.shared.current,".dirty=true;"),a.shared.vao&&c(a.shared.vao,".setVAO(null);")}(a,b),_(a.compile(),{destroy:function(){b.shader.program.destroy()}})}}}(a,q,e,h,aa,aB,x,m,{},aC,aN,k,E,aM,aL,b),q=function(a,b,c,d,e,f,g){function h(e){g=null===b.next?5121:b.next.colorAttachments[0].texture._texture.type;var g,h=0,i=0,j=d.framebufferWidth,k=d.framebufferHeight,f=null;return af(e)?f=e:e&&(h=0|e.x,i=0|e.y,j=0|(e.width||d.framebufferWidth-h),k=0|(e.height||d.framebufferHeight-i),f=e.data||null),c(),e=j*k*4,f||(5121===g?f=new Uint8Array(e):5126===g&&(f=f||new Float32Array(e))),a.pixelStorei(3333,4),a.readPixels(h,i,j,k,6408,g,f),f}return function(a){var c,d;return a&&"framebuffer"in a?(c=a,b.setFBO({framebuffer:c.framebuffer},function(){d=h(c)}),d):h(a)}}(a,m,aE.procs.poll,E,l,e,h),aV=aE.next,am=a.canvas,aW=[],aX=[],aY=[],aZ=[b.onDestroy],a$=null;am&&(am.addEventListener("webglcontextlost",aF,!1),am.addEventListener("webglcontextrestored",aG,!1));var a_=m.setFBO=B({framebuffer:ab.define.call(null,1,"framebuffer")});return ap(),l=_(B,{clear:function(a){if("framebuffer"in a)if(a.framebuffer&&"framebufferCube"===a.framebuffer_reglType)for(var b=0;6>b;++b)a_(_({framebuffer:a.framebuffer.faces[b]},a),aR);else a_(a,aR);else aR(null,a)},prop:ab.define.bind(null,1),context:ab.define.bind(null,2),"this":ab.define.bind(null,3),draw:B({}),buffer:function(a){return aa.create(a,34962,!1,!1)},elements:function(a){return aB.create(a,!1)},texture:x.create2D,cube:x.createCube,renderbuffer:aD.create,framebuffer:m.create,framebufferCube:m.createCube,vao:aC.createVAO,attributes:l,frame:aH,on:function(c,b){var a;switch(c){case"frame":return aH(b);case"lost":a=aX;break;case"restore":a=aY;break;case"destroy":a=aZ}return a.push(b),{cancel:function(){for(var c=0;c<a.length;++c)if(a[c]===b){a[c]=a[a.length-1],a.pop();break}}}},limits:h,hasExtension:function(a){return 0<=h.extensions.indexOf(a.toLowerCase())},read:q,destroy:function(){aW.length=0,aQ(),am&&(am.removeEventListener("webglcontextlost",aF),am.removeEventListener("webglcontextrestored",aG)),aN.clear(),m.clear(),aD.clear(),aC.clear(),x.clear(),aB.clear(),aa.clear(),aM&&aM.clear(),aZ.forEach(function(a){a()})},_gl:a,_refresh:ap,poll:function(){aT(),aM&&aM.update()},now:aI,stats:f,getCachedCode:function(){return aL},preloadCachedCode:function(a){Object.entries(a).forEach(function(a){aL[a[0]]=a[1]})}}),b.onDone(null,l),l}})},{}],285:[function(f,g,d){var c=f("buffer"),b=c.Buffer;function e(a,c){for(var b in a)c[b]=a[b]}function a(a,c,d){return b(a,c,d)}b.from&&b.alloc&&b.allocUnsafe&&b.allocUnsafeSlow?g.exports=c:(e(c,d),d.Buffer=a),a.prototype=Object.create(b.prototype),e(b,a),a.from=function(a,c,d){if("number"==typeof a)throw new TypeError("Argument must not be a number");return b(a,c,d)},a.alloc=function(d,c,e){if("number"!=typeof d)throw new TypeError("Argument must be a number");var a=b(d);return void 0!==c?"string"==typeof e?a.fill(c,e):a.fill(c):a.fill(0),a},a.allocUnsafe=function(a){if("number"!=typeof a)throw new TypeError("Argument must be a number");return b(a)},a.allocUnsafeSlow=function(a){if("number"!=typeof a)throw new TypeError("Argument must be a number");return c.SlowBuffer(a)}},{buffer:85}],286:[function(b,c,e){c.exports=a;var d=b("events").EventEmitter;function a(){d.call(this)}b("inherits")(a,d),a.Readable=b("readable-stream/lib/_stream_readable.js"),a.Writable=b("readable-stream/lib/_stream_writable.js"),a.Duplex=b("readable-stream/lib/_stream_duplex.js"),a.Transform=b("readable-stream/lib/_stream_transform.js"),a.PassThrough=b("readable-stream/lib/_stream_passthrough.js"),a.finished=b("readable-stream/lib/internal/streams/end-of-stream.js"),a.pipeline=b("readable-stream/lib/internal/streams/pipeline.js"),a.Stream=a,a.prototype.pipe=function(b,e){var a=this;function g(c){b.writable&& !1===b.write(c)&&a.pause&&a.pause()}function h(){a.readable&&a.resume&&a.resume()}a.on("data",g),b.on("drain",h),b._isStdio||e&& !1===e.end||(a.on("end",j),a.on("close",k));var i=!1;function j(){i||(i=!0,b.end())}function k(){i||(i=!0,"function"==typeof b.destroy&&b.destroy())}function f(a){if(c(),0===d.listenerCount(this,"error"))throw a}function c(){a.removeListener("data",g),b.removeListener("drain",h),a.removeListener("end",j),a.removeListener("close",k),a.removeListener("error",f),b.removeListener("error",f),a.removeListener("end",c),a.removeListener("close",c),b.removeListener("close",c)}return a.on("error",f),b.on("error",f),a.on("end",c),a.on("close",c),b.on("close",c),b.emit("pipe",a),b}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(d,b,e){"use strict";var c={};function a(d,e,a){a||(a=Error);var b=function(d){var a,b;function c(f,g,h){var a,b,c;return d.call(this,(a=f,b=g,c=h,"string"==typeof e?e:e(a,b,c)))||this}return a=c,b=d,a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b,c}(a);b.prototype.name=a.name,b.prototype.code=d,c[d]=b}function f(a,b){if(!Array.isArray(a))return"of ".concat(b," ").concat(String(a));var c=a.length;return(a=a.map(function(a){return String(a)}),c>2)?"one of ".concat(b," ").concat(a.slice(0,c-1).join(", "),", or ")+a[c-1]:2===c?"one of ".concat(b," ").concat(a[0]," or ").concat(a[1]):"of ".concat(b," ").concat(a[0])}a("ERR_INVALID_OPT_VALUE",function(a,b){return'The value "'+b+'" is invalid for option "'+a+'"'},TypeError),a("ERR_INVALID_ARG_TYPE",function(b,a,h){if("string"==typeof a&&(k="not ",a.substr(!l||l<0?0:+l,k.length)===k)?(i="must not be",a=a.replace(/^not /,"")):i="must be",m=b,n=" argument",(void 0===o||o>m.length)&&(o=m.length),m.substring(o-n.length,o)===n)g="The ".concat(b," ").concat(i," ").concat(f(a,"type"));else{var k,l,m,n,o,d,e,c,i,g,j=(d=b,"number"!=typeof c&&(c=0),c+(e=".").length>d.length|| -1===d.indexOf(e,c))?"argument":"property";g='The "'.concat(b,'" ').concat(j," ").concat(i," ").concat(f(a,"type"))}return g+=". Received type ".concat(typeof h)},TypeError),a("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),a("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),a("ERR_STREAM_PREMATURE_CLOSE","Premature close"),a("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),a("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),a("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),a("ERR_STREAM_WRITE_AFTER_END","write after end"),a("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),a("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),a("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),b.exports.codes=c},{}],288:[function(a,b,c){(function(c){(function(){"use strict";var i=Object.keys||function(b){var a=[];for(var c in b)a.push(c);return a};b.exports=d;var j=a("./_stream_readable"),g=a("./_stream_writable");a("inherits")(d,j);for(var h=i(g.prototype),e=0;e<h.length;e++){var f=h[e];d.prototype[f]||(d.prototype[f]=g.prototype[f])}function d(a){if(!(this instanceof d))return new d(a);j.call(this,a),g.call(this,a),this.allowHalfOpen=!0,a&&(!1===a.readable&&(this.readable=!1),!1===a.writable&&(this.writable=!1),!1===a.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",k)))}function k(){this._writableState.ended||c.nextTick(l,this)}function l(a){a.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&& void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(a){void 0!==this._readableState&& void 0!==this._writableState&&(this._readableState.destroyed=a,this._writableState.destroyed=a)}})}).call(this)}).call(this,a("_process"))},{"./_stream_readable":290,"./_stream_writable":292,"_process":278,inherits:231}],289:[function(a,c,e){"use strict";c.exports=b;var d=a("./_stream_transform");function b(a){if(!(this instanceof b))return new b(a);d.call(this,a)}a("inherits")(b,d),b.prototype._transform=function(a,c,b){b(null,a)}},{"./_stream_transform":291,inherits:231}],290:[function(a,b,d){(function(c,d){(function(){"use strict";b.exports=e,e.ReadableState=A,a("events").EventEmitter;var k=function(a,b){return a.listeners(b).length},i=a("./internal/streams/stream"),l=a("buffer").Buffer,m=d.Uint8Array||function(){},g=a("util");o=g&&g.debuglog?g.debuglog("stream"):function(){};var n,o,p,q,r,s=a("./internal/streams/buffer_list"),h=a("./internal/streams/destroy"),t=a("./internal/streams/state").getHighWaterMark,f=a("../errors").codes,u=f.ERR_INVALID_ARG_TYPE,v=f.ERR_STREAM_PUSH_AFTER_EOF,w=f.ERR_METHOD_NOT_IMPLEMENTED,x=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;a("inherits")(e,i);var y=h.errorOrDestroy,z=["error","close","destroy","pause","resume"];function A(b,d,c){n=n||a("./_stream_duplex"),b=b||{},"boolean"!=typeof c&&(c=d instanceof n),this.objectMode=!!b.objectMode,c&&(this.objectMode=this.objectMode||!!b.readableObjectMode),this.highWaterMark=t(this,b,"readableHighWaterMark",c),this.buffer=new s,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==b.emitClose,this.autoDestroy=!!b.autoDestroy,this.destroyed=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(p||(p=a("string_decoder/").StringDecoder),this.decoder=new p(b.encoding),this.encoding=b.encoding)}function e(b){if(n=n||a("./_stream_duplex"),!(this instanceof e))return new e(b);var c=this instanceof n;this._readableState=new A(b,this,c),this.readable=!0,b&&("function"==typeof b.read&&(this._read=b.read),"function"==typeof b.destroy&&(this._destroy=b.destroy)),i.call(this)}function B(c,b,g,e,h){o("readableAddChunk",b);var f,d,a=c._readableState;if(null===b)a.reading=!1,F(c,a);else if(h||(d=D(a,b)),d)y(c,d);else if(a.objectMode||b&&b.length>0)if("string"==typeof b||a.objectMode||Object.getPrototypeOf(b)===l.prototype||(b=(f=b,l.from(f))),e)a.endEmitted?y(c,new x):C(c,a,b,!0);else if(a.ended)y(c,new v);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!g?(b=a.decoder.write(b),a.objectMode||0!==b.length?C(c,a,b,!1):I(c,a)):C(c,a,b,!1)}else e||(a.reading=!1,I(c,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function C(c,a,b,d){a.flowing&&0===a.length&&!a.sync?(a.awaitDrain=0,c.emit("data",b)):(a.length+=a.objectMode?1:b.length,d?a.buffer.unshift(b):a.buffer.push(b),a.needReadable&&G(c)),I(c,a)}function D(d,a){var c,b;return b=a,l.isBuffer(b)||b instanceof m||"string"==typeof a|| void 0===a||d.objectMode||(c=new u("chunk",["string","Buffer","Uint8Array"],a)),c}function E(c,b){if(c<=0||0===b.length&&b.ended)return 0;if(b.objectMode)return 1;if(c!=c)return b.flowing&&b.length?b.buffer.head.data.length:b.length;if(c>b.highWaterMark){var a;b.highWaterMark=((a=c)>=1073741824?a=1073741824:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++),a)}return c<=b.length?c:b.ended?b.length:(b.needReadable=!0,0)}function F(c,a){if(o("onEofChunk"),!a.ended){if(a.decoder){var b=a.decoder.end();b&&b.length&&(a.buffer.push(b),a.length+=a.objectMode?1:b.length)}a.ended=!0,a.sync?G(c):(a.needReadable=!1,a.emittedReadable||(a.emittedReadable=!0,H(c)))}}function G(b){var a=b._readableState;o("emitReadable",a.needReadable,a.emittedReadable),a.needReadable=!1,a.emittedReadable||(o("emitReadable",a.flowing),a.emittedReadable=!0,c.nextTick(H,b))}function H(b){var a=b._readableState;o("emitReadable_",a.destroyed,a.length,a.ended),!a.destroyed&&(a.length||a.ended)&&(b.emit("readable"),a.emittedReadable=!1),a.needReadable=!a.flowing&&!a.ended&&a.length<=a.highWaterMark,N(b)}function I(b,a){a.readingMore||(a.readingMore=!0,c.nextTick(J,b,a))}function J(b,a){for(;!a.reading&&!a.ended&&(a.length<a.highWaterMark||a.flowing&&0===a.length);){var c=a.length;if(o("maybeReadMore read 0"),b.read(0),c===a.length)break}a.readingMore=!1}function K(a){var b=a._readableState;b.readableListening=a.listenerCount("readable")>0,b.resumeScheduled&&!b.paused?b.flowing=!0:a.listenerCount("data")>0&&a.resume()}function L(a){o("readable nexttick read 0"),a.read(0)}function M(b,a){o("resume",a.reading),a.reading||b.read(0),a.resumeScheduled=!1,b.emit("resume"),N(b),a.flowing&&!a.reading&&b.read(0)}function N(a){var b=a._readableState;for(o("flow",b.flowing);b.flowing&&null!==a.read(););}function j(c,a){var b;return 0===a.length?null:(a.objectMode?b=a.buffer.shift():!c||c>=a.length?(b=a.decoder?a.buffer.join(""):1===a.buffer.length?a.buffer.first():a.buffer.concat(a.length),a.buffer.clear()):b=a.buffer.consume(c,a.decoder),b)}function O(b){var a=b._readableState;o("endReadable",a.endEmitted),a.endEmitted||(a.ended=!0,c.nextTick(P,a,b))}function P(a,b){if(o("endReadableNT",a.endEmitted,a.length),!a.endEmitted&&0===a.length&&(a.endEmitted=!0,b.readable=!1,b.emit("end"),a.autoDestroy)){var c=b._writableState;(!c||c.autoDestroy&&c.finished)&&b.destroy()}}function Q(b,c){for(var a=0,d=b.length;a<d;a++)if(b[a]===c)return a;return -1}Object.defineProperty(e.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(a){this._readableState&&(this._readableState.destroyed=a)}}),e.prototype.destroy=h.destroy,e.prototype._undestroy=h.undestroy,e.prototype._destroy=function(a,b){b(a)},e.prototype.push=function(b,a){var c,d=this._readableState;return d.objectMode?c=!0:"string"==typeof b&&((a=a||d.defaultEncoding)!==d.encoding&&(b=l.from(b,a),a=""),c=!0),B(this,b,a,!1,c)},e.prototype.unshift=function(a){return B(this,a,null,!0,!1)},e.prototype.isPaused=function(){return!1===this._readableState.flowing},e.prototype.setEncoding=function(e){p||(p=a("string_decoder/").StringDecoder);var d=new p(e);this._readableState.decoder=d,this._readableState.encoding=this._readableState.decoder.encoding;for(var b=this._readableState.buffer.head,c="";null!==b;)c+=d.write(b.data),b=b.next;return this._readableState.buffer.clear(),""!==c&&this._readableState.buffer.push(c),this._readableState.length=c.length,this},e.prototype.read=function(b){o("read",b),b=parseInt(b,10);var c,a=this._readableState,e=b;if(0!==b&&(a.emittedReadable=!1),0===b&&a.needReadable&&((0!==a.highWaterMark?a.length>=a.highWaterMark:a.length>0)||a.ended))return o("read: emitReadable",a.length,a.ended),0===a.length&&a.ended?O(this):G(this),null;if(0===(b=E(b,a))&&a.ended)return 0===a.length&&O(this),null;var d=a.needReadable;return o("need readable",d),(0===a.length||a.length-b<a.highWaterMark)&&o("length less than watermark",d=!0),a.ended||a.reading?o("reading or ended",d=!1):d&&(o("do read"),a.reading=!0,a.sync=!0,0===a.length&&(a.needReadable=!0),this._read(a.highWaterMark),a.sync=!1,a.reading||(b=E(e,a))),null===(c=b>0?j(b,a):null)?(a.needReadable=a.length<=a.highWaterMark,b=0):(a.length-=b,a.awaitDrain=0),0===a.length&&(a.ended||(a.needReadable=!0),e!==b&&a.ended&&O(this)),null!==c&&this.emit("data",c),c},e.prototype._read=function(a){y(this,new w("_read()"))},e.prototype.pipe=function(a,e){var g,d=this,b=this._readableState;switch(b.pipesCount){case 0:b.pipes=a;break;case 1:b.pipes=[b.pipes,a];break;default:b.pipes.push(a);break}b.pipesCount+=1,o("pipe count=%d opts=%j",b.pipesCount,e);var f=e&& !1===e.end||a===c.stdout||a===c.stderr?s:p;function h(b,a){o("onunpipe"),b===d&&a&& !1===a.hasUnpiped&&(a.hasUnpiped=!0,r())}function p(){o("onend"),a.end()}b.endEmitted?c.nextTick(f):d.once("end",f),a.on("unpipe",h);var i=(g=d,function(){var a=g._readableState;o("pipeOnDrain",a.awaitDrain),a.awaitDrain&&a.awaitDrain--,0===a.awaitDrain&&k(g,"data")&&(a.flowing=!0,N(g))});a.on("drain",i);var q=!1;function r(){o("cleanup"),a.removeListener("close",m),a.removeListener("finish",n),a.removeListener("drain",i),a.removeListener("error",l),a.removeListener("unpipe",h),d.removeListener("end",p),d.removeListener("end",s),d.removeListener("data",j),q=!0,b.awaitDrain&&(!a._writableState||a._writableState.needDrain)&&i()}function j(e){o("ondata");var c=a.write(e);o("dest.write",c),!1===c&&((1===b.pipesCount&&b.pipes===a||b.pipesCount>1&& -1!==Q(b.pipes,a))&&!q&&(o("false write response, pause",b.awaitDrain),b.awaitDrain++),d.pause())}function l(b){o("onerror",b),s(),a.removeListener("error",l),0===k(a,"error")&&y(a,b)}function m(){a.removeListener("finish",n),s()}function n(){o("onfinish"),a.removeListener("close",m),s()}function s(){o("unpipe"),d.unpipe(a)}return d.on("data",j),function(a,b,c){if("function"==typeof a.prependListener)return a.prependListener(b,c);a._events&&a._events[b]?Array.isArray(a._events[b])?a._events[b].unshift(c):a._events[b]=[c,a._events[b]]:a.on(b,c)}(a,"error",l),a.once("close",m),a.once("finish",n),a.emit("pipe",d),b.flowing||(o("pipe resume"),d.resume()),a},e.prototype.unpipe=function(b){var a=this._readableState,d={hasUnpiped:!1};if(0===a.pipesCount)return this;if(1===a.pipesCount)return b&&b!==a.pipes||(b||(b=a.pipes),a.pipes=null,a.pipesCount=0,a.flowing=!1,b&&b.emit("unpipe",this,d)),this;if(!b){var f=a.pipes,g=a.pipesCount;a.pipes=null,a.pipesCount=0,a.flowing=!1;for(var c=0;c<g;c++)f[c].emit("unpipe",this,{hasUnpiped:!1});return this}var e=Q(a.pipes,b);return -1===e||(a.pipes.splice(e,1),a.pipesCount-=1,1===a.pipesCount&&(a.pipes=a.pipes[0]),b.emit("unpipe",this,d)),this},e.prototype.on=function(b,d){var e=i.prototype.on.call(this,b,d),a=this._readableState;return"data"===b?(a.readableListening=this.listenerCount("readable")>0,!1!==a.flowing&&this.resume()):"readable"!==b||a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.flowing=!1,a.emittedReadable=!1,o("on readable",a.length,a.reading),a.length?G(this):a.reading||c.nextTick(L,this)),e},e.prototype.addListener=e.prototype.on,e.prototype.removeListener=function(a,b){var d=i.prototype.removeListener.call(this,a,b);return"readable"===a&&c.nextTick(K,this),d},e.prototype.removeAllListeners=function(a){var b=i.prototype.removeAllListeners.apply(this,arguments);return("readable"===a|| void 0===a)&&c.nextTick(K,this),b},e.prototype.resume=function(){var d,b,a=this._readableState;return a.flowing||(o("resume"),a.flowing=!a.readableListening,d=this,(b=a).resumeScheduled||(b.resumeScheduled=!0,c.nextTick(M,d,b))),a.paused=!1,this},e.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},e.prototype.wrap=function(a){var d=this,e=this._readableState,f=!1;for(var b in a.on("end",function(){if(o("wrapped end"),e.decoder&&!e.ended){var a=e.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(b){o("wrapped data"),e.decoder&&(b=e.decoder.write(b)),(!e.objectMode||null!=b)&&(e.objectMode||b&&b.length)&&(d.push(b)||(f=!0,a.pause()))}),a)void 0===this[b]&&"function"==typeof a[b]&&(this[b]=function(b){return function(){return a[b].apply(a,arguments)}}(b));for(var c=0;c<z.length;c++)a.on(z[c],this.emit.bind(this,z[c]));return this._read=function(b){o("wrapped _read",b),f&&(f=!1,a.resume())},this},"function"==typeof Symbol&&(e.prototype[Symbol.asyncIterator]=function(){return void 0===q&&(q=a("./internal/streams/async_iterator")),q(this)}),Object.defineProperty(e.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(e.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(e.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(a){this._readableState&&(this._readableState.flowing=a)}}),e._fromList=j,Object.defineProperty(e.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(e.from=function(b,c){return void 0===r&&(r=a("./internal/streams/from")),r(e,b,c)})}).call(this)}).call(this,a("_process"),void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,"_process":278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(c,d,f){"use strict";d.exports=a;var b=c("../errors").codes,g=b.ERR_METHOD_NOT_IMPLEMENTED,h=b.ERR_MULTIPLE_CALLBACK,i=b.ERR_TRANSFORM_ALREADY_TRANSFORMING,j=b.ERR_TRANSFORM_WITH_LENGTH_0,e=c("./_stream_duplex");function k(e,c){var b=this._transformState;b.transforming=!1;var d=b.writecb;if(null===d)return this.emit("error",new h);b.writechunk=null,b.writecb=null,null!=c&&this.push(c),d(e);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function a(b){if(!(this instanceof a))return new a(b);e.call(this,b),this._transformState={afterTransform:k.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&("function"==typeof b.transform&&(this._transform=b.transform),"function"==typeof b.flush&&(this._flush=b.flush)),this.on("prefinish",l)}function l(){var a=this;"function"!=typeof this._flush||this._readableState.destroyed?m(this,null,null):this._flush(function(b,c){m(a,b,c)})}function m(a,b,c){if(b)return a.emit("error",b);if(null!=c&&a.push(c),a._writableState.length)throw new j;if(a._transformState.transforming)throw new i;return a.push(null)}c("inherits")(a,e),a.prototype.push=function(a,b){return this._transformState.needTransform=!1,e.prototype.push.call(this,a,b)},a.prototype._transform=function(b,c,a){a(new g("_transform()"))},a.prototype._write=function(c,d,e){var a=this._transformState;if(a.writecb=e,a.writechunk=c,a.writeencoding=d,!a.transforming){var b=this._readableState;(a.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},a.prototype._read=function(b){var a=this._transformState;null===a.writechunk||a.transforming?a.needTransform=!0:(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform))},a.prototype._destroy=function(a,b){e.prototype._destroy.call(this,a,function(a){b(a)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(a,b,d){(function(c,d){(function(){"use strict";function k(a){var b=this;this.next=null,this.entry=null,this.finish=function(){I(b,a)}}b.exports=e,e.WritableState=j;var l,h,m={deprecate:a("util-deprecate")},i=a("./internal/streams/stream"),n=a("buffer").Buffer,o=d.Uint8Array||function(){},g=a("./internal/streams/destroy"),p=a("./internal/streams/state").getHighWaterMark,f=a("../errors").codes,q=f.ERR_INVALID_ARG_TYPE,r=f.ERR_METHOD_NOT_IMPLEMENTED,s=f.ERR_MULTIPLE_CALLBACK,t=f.ERR_STREAM_CANNOT_PIPE,u=f.ERR_STREAM_DESTROYED,v=f.ERR_STREAM_NULL_VALUES,w=f.ERR_STREAM_WRITE_AFTER_END,x=f.ERR_UNKNOWN_ENCODING,y=g.errorOrDestroy;function z(){}function j(b,d,c){l=l||a("./_stream_duplex"),b=b||{},"boolean"!=typeof c&&(c=d instanceof l),this.objectMode=!!b.objectMode,c&&(this.objectMode=this.objectMode||!!b.writableObjectMode),this.highWaterMark=p(this,b,"writableHighWaterMark",c),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var e=!1===b.decodeStrings;this.decodeStrings=!e,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){B(d,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==b.emitClose,this.autoDestroy=!!b.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new k(this)}function e(b){var c=this instanceof(l=l||a("./_stream_duplex"));if(!c&&!h.call(e,this))return new e(b);this._writableState=new j(b,this,c),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev),"function"==typeof b.destroy&&(this._destroy=b.destroy),"function"==typeof b.final&&(this._final=b.final)),i.call(this)}function A(b,a,d,e,c,f,g){a.writelen=e,a.writecb=g,a.writing=!0,a.sync=!0,a.destroyed?a.onwrite(new u("write")):d?b._writev(c,a.onwrite):b._write(c,f,a.onwrite),a.sync=!1}function B(d,k){var e,b,g,l,f,i,a=d._writableState,m=a.sync,h=a.writecb;if("function"!=typeof h)throw new s;if((e=a).writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0,k)b=d,g=a,l=m,f=k,i=h,--g.pendingcb,l?(c.nextTick(i,f),c.nextTick(H,b,g),b._writableState.errorEmitted=!0,y(b,f)):(i(f),b._writableState.errorEmitted=!0,y(b,f),H(b,g));else{var j=F(a)||d.destroyed;j||a.corked||a.bufferProcessing||!a.bufferedRequest||E(d,a),m?c.nextTick(C,d,a,j,h):C(d,a,j,h)}}function C(b,a,c,d){c||D(b,a),a.pendingcb--,d(),H(b,a)}function D(b,a){0===a.length&&a.needDrain&&(a.needDrain=!1,b.emit("drain"))}function E(d,a){a.bufferProcessing=!0;var b=a.bufferedRequest;if(d._writev&&b&&b.next){var i=a.bufferedRequestCount,e=new Array(i),c=a.corkedRequestsFree;c.entry=b;for(var f=0,g=!0;b;)e[f]=b,b.isBuf||(g=!1),b=b.next,f+=1;e.allBuffers=g,A(d,a,!0,a.length,e,"",c.finish),a.pendingcb++,a.lastBufferedRequest=null,c.next?(a.corkedRequestsFree=c.next,c.next=null):a.corkedRequestsFree=new k(a),a.bufferedRequestCount=0}else{for(;b;){var h=b.chunk,j=b.encoding,l=b.callback,m=a.objectMode?1:h.length;if(A(d,a,!1,m,h,j,l),b=b.next,a.bufferedRequestCount--,a.writing)break}null===b&&(a.lastBufferedRequest=null)}a.bufferedRequest=b,a.bufferProcessing=!1}function F(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function G(a,b){a._final(function(c){b.pendingcb--,c&&y(a,c),b.prefinished=!0,a.emit("prefinish"),H(a,b)})}function H(d,b){var e,a,g=F(b);if(g&&(e=d,(a=b).prefinished||a.finalCalled||("function"!=typeof e._final||a.destroyed?(a.prefinished=!0,e.emit("prefinish")):(a.pendingcb++,a.finalCalled=!0,c.nextTick(G,e,a))),0===b.pendingcb&&(b.finished=!0,d.emit("finish"),b.autoDestroy))){var f=d._readableState;(!f||f.autoDestroy&&f.endEmitted)&&d.destroy()}return g}function I(b,c,d){var a=b.entry;for(b.entry=null;a;){var e=a.callback;c.pendingcb--,e(d),a=a.next}c.corkedRequestsFree.next=b}a("inherits")(e,i),j.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(j.prototype,"buffer",{get:m.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(a){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(e,Symbol.hasInstance,{value:function(a){return!!h.call(this,a)||this===e&&a&&a._writableState instanceof j}})):h=function(a){return a instanceof this},e.prototype.pipe=function(){y(this,new t)},e.prototype.write=function(b,a,d){var j,k,l,m,p,r,g,s,f,i,e=this._writableState,t=!1,h=!e.objectMode&&(i=b,n.isBuffer(i)||i instanceof o);return h&&!n.isBuffer(b)&&(b=(j=b,n.from(j))),("function"==typeof a&&(d=a,a=null),h?a="buffer":a||(a=e.defaultEncoding),"function"!=typeof d&&(d=z),e.ending)?(k=this,l=d,y(k,m=new w),c.nextTick(l,m)):(h||(p=this,r=e,g=b,s=d,null===g?f=new v:"string"==typeof g||r.objectMode||(f=new q("chunk",["string","Buffer"],g)),!f||(y(p,f),c.nextTick(s,f),0)))&&(e.pendingcb++,t=function(m,a,e,b,d,g){if(!e){var f,c,h,i=(f=a,c=b,h=d,f.objectMode|| !1===f.decodeStrings||"string"!=typeof c||(c=n.from(c,h)),c);b!==i&&(e=!0,d="buffer",b=i)}var j=a.objectMode?1:b.length;a.length+=j;var k=a.length<a.highWaterMark;if(k||(a.needDrain=!0),a.writing||a.corked){var l=a.lastBufferedRequest;a.lastBufferedRequest={chunk:b,encoding:d,isBuf:e,callback:g,next:null},l?l.next=a.lastBufferedRequest:a.bufferedRequest=a.lastBufferedRequest,a.bufferedRequestCount+=1}else A(m,a,!1,j,b,d,g);return k}(this,e,h,b,a,d)),t},e.prototype.cork=function(){this._writableState.corked++},e.prototype.uncork=function(){var a=this._writableState;!a.corked||(a.corked--,a.writing||a.corked||a.bufferProcessing||!a.bufferedRequest||E(this,a))},e.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())> -1))throw new x(a);return this._writableState.defaultEncoding=a,this},Object.defineProperty(e.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(e.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),e.prototype._write=function(b,c,a){a(new r("_write()"))},e.prototype._writev=null,e.prototype.end=function(a,b,h){var e,d,f,g=this._writableState;return"function"==typeof a?(h=a,a=null,b=null):"function"==typeof b&&(h=b,b=null),null!=a&&this.write(a,b),g.corked&&(g.corked=1,this.uncork()),g.ending||(e=this,d=g,f=h,d.ending=!0,H(e,d),f&&(d.finished?c.nextTick(f):e.once("finish",f)),d.ended=!0,e.writable=!1),this},Object.defineProperty(e.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(e.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(a){this._writableState&&(this._writableState.destroyed=a)}}),e.prototype.destroy=g.destroy,e.prototype._undestroy=g.undestroy,e.prototype._destroy=function(a,b){b(a)}}).call(this)}).call(this,a("_process"),void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,"_process":278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(a,b,c){(function(c){(function(){"use strict";function e(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var d,h=a("./end-of-stream"),i=Symbol("lastResolve"),j=Symbol("lastReject"),k=Symbol("error"),l=Symbol("ended"),m=Symbol("lastPromise"),n=Symbol("handlePromise"),f=Symbol("stream");function o(a,b){return{value:a,done:b}}function p(a){var b=a[i];if(null!==b){var c=a[f].read();null!==c&&(a[m]=null,a[i]=null,a[j]=null,b(o(c,!1)))}}function q(a){c.nextTick(p,a)}var g=Object.getPrototypeOf(function(){}),r=Object.setPrototypeOf((e(d={get stream(){return this[f]},next:function(){var g,h,a,i=this,b=this[k];if(null!==b)return Promise.reject(b);if(this[l])return Promise.resolve(o(void 0,!0));if(this[f].destroyed)return new Promise(function(a,b){c.nextTick(function(){i[k]?b(i[k]):a(o(void 0,!0))})});var d=this[m];if(d)a=new Promise((g=d,h=this,function(b,a){g.then(function(){if(h[l]){b(o(void 0,!0));return}h[n](b,a)},a)}));else{var e=this[f].read();if(null!==e)return Promise.resolve(o(e,!1));a=new Promise(this[n])}return this[m]=a,a}},Symbol.asyncIterator,function(){return this}),e(d,"return",function(){var a=this;return new Promise(function(b,c){a[f].destroy(null,function(a){if(a){c(a);return}b(o(void 0,!0))})})}),d),g);b.exports=function(b){var a,c=Object.create(r,(e(a={},f,{value:b,writable:!0}),e(a,i,{value:null,writable:!0}),e(a,j,{value:null,writable:!0}),e(a,k,{value:null,writable:!0}),e(a,l,{value:b._readableState.endEmitted,writable:!0}),e(a,n,{value:function(a,d){var b=c[f].read();b?(c[m]=null,c[i]=null,c[j]=null,a(o(b,!1))):(c[i]=a,c[j]=d)},writable:!0}),a));return c[m]=null,h(b,function(a){if(a&&"ERR_STREAM_PREMATURE_CLOSE"!==a.code){var b=c[j];null!==b&&(c[m]=null,c[i]=null,c[j]=null,b(a)),c[k]=a;return}var d=c[i];null!==d&&(c[m]=null,c[i]=null,c[j]=null,d(o(void 0,!0))),c[l]=!0}),b.on("readable",q.bind(null,c)),c}}).call(this)}).call(this,a("_process"))},{"./end-of-stream":296,"_process":278}],294:[function(a,c,d){"use strict";function e(c,d){var a=Object.keys(c);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(c);d&&(b=b.filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})),a.push.apply(a,b)}return a}function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function g(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var h=a("buffer").Buffer,b=a("util").inspect,i=b&&b.custom||"inspect";function j(a,b,c){h.prototype.copy.call(a,b,c)}c.exports=function(){var a,c,d;function k(){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,k),this.head=null,this.tail=null,this.length=0}return a=k,c=[{key:"push",value:function(b){var a={data:b,next:null};this.length>0?this.tail.next=a:this.head=a,this.tail=a,++this.length}},{key:"unshift",value:function(b){var a={data:b,next:this.head};0===this.length&&(this.tail=a),this.head=a,++this.length}},{key:"shift",value:function(){if(0!==this.length){var a=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,a}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(c){if(0===this.length)return"";for(var a=this.head,b=""+a.data;a=a.next;)b+=c+a.data;return b}},{key:"concat",value:function(d){if(0===this.length)return h.alloc(0);for(var b=h.allocUnsafe(d>>>0),a=this.head,c=0;a;)j(a.data,b,c),c+=a.data.length,a=a.next;return b}},{key:"consume",value:function(a,c){var b;return a<this.head.data.length?(b=this.head.data.slice(0,a),this.head.data=this.head.data.slice(a)):b=a===this.head.data.length?this.shift():c?this._getString(a):this._getBuffer(a),b}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(c){var a=this.head,f=1,d=a.data;for(c-=d.length;a=a.next;){var b=a.data,e=c>b.length?b.length:c;if(e===b.length?d+=b:d+=b.slice(0,c),0==(c-=e)){e===b.length?(++f,a.next?this.head=a.next:this.head=this.tail=null):(this.head=a,a.data=b.slice(e));break}++f}return this.length-=f,d}},{key:"_getBuffer",value:function(b){var d=h.allocUnsafe(b),a=this.head,f=1;for(a.data.copy(d),b-=a.data.length;a=a.next;){var c=a.data,e=b>c.length?c.length:b;if(c.copy(d,d.length-b,0,e),0==(b-=e)){e===c.length?(++f,a.next?this.head=a.next:this.head=this.tail=null):(this.head=a,a.data=c.slice(e));break}++f}return this.length-=f,d}},{key:i,value:function(c,a){return b(this,function(c){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?e(Object(b),!0).forEach(function(a){f(c,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(b)):e(Object(b)).forEach(function(a){Object.defineProperty(c,a,Object.getOwnPropertyDescriptor(b,a))})}return c}({},a,{depth:0,customInspect:!1}))}}],g(a.prototype,c),d&&g(a,d),k}()},{buffer:85,util:83}],295:[function(a,b,c){(function(a){(function(){"use strict";function c(a,b){e(a,b),d(a)}function d(a){(!a._writableState||a._writableState.emitClose)&&(!a._readableState||a._readableState.emitClose)&&a.emit("close")}function e(a,b){a.emit("error",b)}b.exports={destroy:function(b,f){var i=this,g=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return g||h?(f?f(b):b&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,a.nextTick(e,this,b)):a.nextTick(e,this,b)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(b||null,function(b){!f&&b?i._writableState?i._writableState.errorEmitted?a.nextTick(d,i):(i._writableState.errorEmitted=!0,a.nextTick(c,i,b)):a.nextTick(c,i,b):f?(a.nextTick(d,i),f(b)):a.nextTick(d,i)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(a,b){var c=a._readableState,d=a._writableState;c&&c.autoDestroy||d&&d.autoDestroy?a.destroy(b):a.emit("error",b)}}}).call(this)}).call(this,a("_process"))},{"_process":278}],296:[function(a,b,d){"use strict";var e=a("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function f(){}function c(a,b,d){if("function"==typeof b)return c(a,null,b);b||(b={}),d=(o=d||f,p=!1,function(){if(!p){p=!0;for(var b=arguments.length,c=new Array(b),a=0;a<b;a++)c[a]=arguments[a];o.apply(this,c)}});var o,p,g,q=b.readable|| !1!==b.readable&&a.readable,l=b.writable|| !1!==b.writable&&a.writable,h=function(){a.writable||i()},r=a._writableState&&a._writableState.finished,i=function(){l=!1,r=!0,q||d.call(a)},s=a._readableState&&a._readableState.endEmitted,m=function(){q=!1,s=!0,l||d.call(a)},n=function(b){d.call(a,b)},j=function(){var b;return q&&!s?(a._readableState&&a._readableState.ended||(b=new e),d.call(a,b)):l&&!r?(a._writableState&&a._writableState.ended||(b=new e),d.call(a,b)):void 0},k=function(){a.req.on("finish",i)};return(g=a).setHeader&&"function"==typeof g.abort?(a.on("complete",i),a.on("abort",j),a.req?k():a.on("request",k)):l&&!a._writableState&&(a.on("end",h),a.on("close",h)),a.on("end",m),a.on("finish",i),!1!==b.error&&a.on("error",n),a.on("close",j),function(){a.removeListener("complete",i),a.removeListener("abort",j),a.removeListener("request",k),a.req&&a.req.removeListener("finish",i),a.removeListener("end",h),a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("end",m),a.removeListener("error",n),a.removeListener("close",j)}}b.exports=c},{"../../../errors":287}],297:[function(b,a,c){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(b,c,d){"use strict";var e,a=b("../../../errors").codes,f=a.ERR_MISSING_ARGS,g=a.ERR_STREAM_DESTROYED;function h(a){if(a)throw a}function i(a){a()}function j(a,b){return a.pipe(b)}c.exports=function(){for(var l,k=arguments.length,a=new Array(k),c=0;c<k;c++)a[c]=arguments[c];var d,m=(d=a).length?"function"!=typeof d[d.length-1]?h:d.pop():h;if(Array.isArray(a[0])&&(a=a[0]),a.length<2)throw new f("streams");var n=a.map(function(d,c){var f=c<a.length-1;return function(a,d,f,c){c=(h=c,i=!1,function(){i||(i=!0,h.apply(void 0,arguments))});var h,i,j=!1;a.on("close",function(){j=!0}),void 0===e&&(e=b("./end-of-stream")),e(a,{readable:d,writable:f},function(a){if(a)return c(a);j=!0,c()});var k=!1;return function(d){if(!j&&!k){var b;if(k=!0,(b=a).setHeader&&"function"==typeof b.abort)return a.abort();if("function"==typeof a.destroy)return a.destroy();c(d||new g("pipe"))}}}(d,f,c>0,function(a){l||(l=a),a&&n.forEach(i),f||(n.forEach(i),m(l))})});return a.reduce(j)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(a,b,c){"use strict";var d=a("../../../errors").codes.ERR_INVALID_OPT_VALUE;b.exports={getHighWaterMark:function(h,i,c,e){var b,f,g,a=(b=i,f=e,g=c,null!=b.highWaterMark?b.highWaterMark:f?b[g]:null);if(null!=a){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var j=e?c:"highWaterMark";throw new d(j,a)}return Math.floor(a)}return h.objectMode?16:16384}}},{"../../../errors":287}],300:[function(a,b,c){b.exports=a("events").EventEmitter},{events:84}],301:[function(b,e,c){"use strict";var d=b("safe-buffer").Buffer,f=d.isEncoding||function(a){switch((a=""+a)&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(b){var a;switch(this.encoding=function(a){var b=function(a){var b;if(!a)return"utf8";for(;;)switch(a){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return a;default:if(b)return;a=(""+a).toLowerCase(),b=!0}}(a);if("string"!=typeof b&&(d.isEncoding===f||!f(a)))throw new Error("Unknown encoding: "+a);return b||a}(b),this.encoding){case"utf16le":this.text=i,this.end=j,a=4;break;case"utf8":this.fillLast=h,a=4;break;case"base64":this.text=k,this.end=l,a=3;break;default:this.write=m,this.end=n;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(a)}function g(a){return a<=127?0:a>>5==6?2:a>>4==14?3:a>>3==30?4:a>>6==2?-1:-2}function h(a){var b=this.lastTotal-this.lastNeed,c=function(a,b,c){if((192&b[0])!=128)return a.lastNeed=0,"\uFFFD";if(a.lastNeed>1&&b.length>1){if((192&b[1])!=128)return a.lastNeed=1,"\uFFFD";if(a.lastNeed>2&&b.length>2&&(192&b[2])!=128)return a.lastNeed=2,"\uFFFD"}}(this,a,b);return void 0!==c?c:this.lastNeed<=a.length?(a.copy(this.lastChar,b,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(a.copy(this.lastChar,b,0,a.length),this.lastNeed-=a.length)}function i(a,c){if((a.length-c)%2==0){var b=a.toString("utf16le",c);if(b){var d=b.charCodeAt(b.length-1);if(d>=55296&&d<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1],b.slice(0,-1)}return b}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=a[a.length-1],a.toString("utf16le",c,a.length-1)}function j(a){var b=a&&a.length?this.write(a):"";if(this.lastNeed){var c=this.lastTotal-this.lastNeed;return b+this.lastChar.toString("utf16le",0,c)}return b}function k(a,c){var b=(a.length-c)%3;return 0===b?a.toString("base64",c):(this.lastNeed=3-b,this.lastTotal=3,1===b?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]),a.toString("base64",c,a.length-b))}function l(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+this.lastChar.toString("base64",0,3-this.lastNeed):b}function m(a){return a.toString(this.encoding)}function n(a){return a&&a.length?this.write(a):""}c.StringDecoder=a,a.prototype.write=function(a){var c,b;if(0===a.length)return"";if(this.lastNeed){if(void 0===(c=this.fillLast(a)))return"";b=this.lastNeed,this.lastNeed=0}else b=0;return b<a.length?c?c+this.text(a,b):this.text(a,b):c||""},a.prototype.end=function(a){var b=a&&a.length?this.write(a):"";return this.lastNeed?b+"\uFFFD":b},a.prototype.text=function(a,b){var c=function(d,c,e){var b=c.length-1;if(b<e)return 0;var a=g(c[b]);return a>=0?(a>0&&(d.lastNeed=a-1),a):--b<e|| -2===a?0:(a=g(c[b]))>=0?(a>0&&(d.lastNeed=a-2),a):--b<e|| -2===a?0:(a=g(c[b]))>=0?(a>0&&(2===a?a=0:d.lastNeed=a-3),a):0}(this,a,b);if(!this.lastNeed)return a.toString("utf8",b);this.lastTotal=c;var d=a.length-(c-this.lastNeed);return a.copy(this.lastChar,0,d),a.toString("utf8",b,d)},a.prototype.fillLast=function(a){if(this.lastNeed<=a.length)return a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length),this.lastNeed-=a.length}},{"safe-buffer":285}],302:[function(a,b,c){(function(c,d){(function(){var e=a("assert"),f=a("debug")("stream-parser");function g(a){f("initializing parser stream"),a._parserBytesLeft=0,a._parserBuffers=[],a._parserBuffered=0,a._parserState=-1,a._parserCallback=null,"function"==typeof a.push&&(a._parserOutput=a.push.bind(a)),a._parserInit=!0}function h(a,b){e(!this._parserCallback,'there is already a "callback" set!'),e(isFinite(a)&&a>0,'can only buffer a finite number of bytes > 0, got "'+a+'"'),this._parserInit||g(this),f("buffering %o bytes",a),this._parserBytesLeft=a,this._parserCallback=b,this._parserState=0}function i(a,b){e(!this._parserCallback,'there is already a "callback" set!'),e(a>0,'can only skip > 0 bytes, got "'+a+'"'),this._parserInit||g(this),f("skipping %o bytes",a),this._parserBytesLeft=a,this._parserCallback=b,this._parserState=1}function j(a,b){e(!this._parserCallback,'There is already a "callback" set!'),e(a>0,'can only pass through > 0 bytes, got "'+a+'"'),this._parserInit||g(this),f("passing through %o bytes",a),this._parserBytesLeft=a,this._parserCallback=b,this._parserState=2}function k(a,b,c){this._parserInit||g(this),f("write(%o bytes)",a.length),"function"==typeof b&&(c=b),n(this,a,null,c)}function l(b,a,c){this._parserInit||g(this),f("transform(%o bytes)",b.length),"function"!=typeof a&&(a=this._parserOutput),n(this,b,a,c)}function c(a,b,e,d){return a._parserBytesLeft<=0?d(new Error("got data but not currently parsing anything")):b.length<=a._parserBytesLeft?function(){return m(a,b,e,d)}:function(){var f=b.slice(0,a._parserBytesLeft);return m(a,f,e,function(g){return g?d(g):b.length>f.length?function(){return c(a,b.slice(f.length),e,d)}:void 0})}}function m(a,b,h,e){if(a._parserBytesLeft-=b.length,f("%o bytes left for stream piece",a._parserBytesLeft),0===a._parserState?(a._parserBuffers.push(b),a._parserBuffered+=b.length):2===a._parserState&&h(b),0!==a._parserBytesLeft)return e;var g=a._parserCallback;if(g&&0===a._parserState&&a._parserBuffers.length>1&&(b=d.concat(a._parserBuffers,a._parserBuffered)),0!==a._parserState&&(b=null),a._parserCallback=null,a._parserBuffered=0,a._parserState=-1,a._parserBuffers.splice(0),g){var c=[];b&&c.push(b),h&&c.push(h);var i=g.length>c.length;i&&c.push(o(e));var j=g.apply(a,c);if(!i||e===j)return e}}b.exports=function(a){var b=a&&"function"==typeof a._transform,c=a&&"function"==typeof a._write;if(!b&&!c)throw new Error("must pass a Writable or Transform stream in");f("extending Parser into stream"),a._bytes=h,a._skipBytes=i,b&&(a._passthrough=j),b?a._transform=l:a._write=k};var n=o(c);function o(a){return function(){for(var b=a.apply(this,arguments);"function"==typeof b;)b=b();return b}}}).call(this)}).call(this,a("_process"),a("buffer").Buffer)},{"_process":278,assert:75,buffer:85,debug:303}],303:[function(a,b,c){(function(d){(function(){function e(){var a;try{a=c.storage.debug}catch(b){}return!a&& void 0!==d&&"env"in d&&(a=d.env.DEBUG),a}(c=b.exports=a("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},c.formatArgs=function(a){var b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),b){var d="color: "+this.color;a.splice(1,0,d,"color: inherit");var f=0,e=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(f++,"%c"===a&&(e=f))}),a.splice(e,0,d)}},c.save=function(a){try{null==a?c.storage.removeItem("debug"):c.storage.debug=a}catch(b){}},c.load=e,c.useColors=function(){return"undefined"!=typeof window&&!!window.process&&"renderer"===window.process.type||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},c.storage="undefined"!=typeof chrome&& void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(a){}}(),c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){try{return JSON.stringify(a)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}},c.enable(e())}).call(this)}).call(this,a("_process"))},{"./debug":304,"_process":278}],304:[function(c,d,a){var e;function b(c){function b(){if(b.enabled){var d=b,f=+new Date,h=f-(e||f);d.diff=h,d.prev=e,d.curr=f,e=f;for(var c=new Array(arguments.length),g=0;g<c.length;g++)c[g]=arguments[g];c[0]=a.coerce(c[0]),"string"!=typeof c[0]&&c.unshift("%O");var i=0;c[0]=c[0].replace(/%([a-zA-Z%])/g,function(b,f){if("%%"===b)return b;i++;var e=a.formatters[f];if("function"==typeof e){var g=c[i];b=e.call(d,g),c.splice(i,1),i--}return b}),a.formatArgs.call(d,c),(b.log||a.log||console.log.bind(console)).apply(d,c)}}return b.namespace=c,b.enabled=a.enabled(c),b.useColors=a.useColors(),b.color=function(c){var d,b=0;for(d in c)b=(b<<5)-b+c.charCodeAt(d),b|=0;return a.colors[Math.abs(b)%a.colors.length]}(c),"function"==typeof a.init&&a.init(b),b}(a=d.exports=b.debug=b.default=b).coerce=function(a){return a instanceof Error?a.stack||a.message:a},a.disable=function(){a.enable("")},a.enable=function(b){a.save(b),a.names=[],a.skips=[];for(var d=("string"==typeof b?b:"").split(/[\s,]+/),e=d.length,c=0;c<e;c++)d[c]&&("-"===(b=d[c].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+b.substr(1)+"$")):a.names.push(new RegExp("^"+b+"$")))},a.enabled=function(d){var b,c;for(b=0,c=a.skips.length;b<c;b++)if(a.skips[b].test(d))return!1;for(b=0,c=a.names.length;b<c;b++)if(a.names[b].test(d))return!0;return!1},a.humanize=c("ms"),a.names=[],a.skips=[],a.formatters={}},{ms:305}],305:[function(b,a,c){function d(a,b,c){return a<b?void 0:a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}a.exports=function(b,e){e=e||{};var c,a,f=typeof b;if("string"===f&&b.length>0)return function(b){if(!((b=String(b)).length>100)){var c=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(b);if(c){var a=parseFloat(c[1]),d=(c[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return 864e5*a;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*a;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*a;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(b);if("number"===f&& !1===isNaN(b))return e.long?d(c=b,864e5,"day")||d(c,36e5,"hour")||d(c,6e4,"minute")||d(c,1e3,"second")||c+" ms":(a=b)>=864e5?Math.round(a/864e5)+"d":a>=36e5?Math.round(a/36e5)+"h":a>=6e4?Math.round(a/6e4)+"m":a>=1e3?Math.round(a/1e3)+"s":a+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(b))}},{}],306:[function(a,b,c){"use strict";var d=a("parenthesis");b.exports=function(i,f,a){if(null==i)throw Error("First argument should be a string");if(null==f)throw Error("Separator should be a string or a RegExp");a?("string"==typeof a||Array.isArray(a))&&(a={ignore:a}):a={},null==a.escape&&(a.escape=!0),null==a.ignore?a.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xab\xbb"]:("string"==typeof a.ignore&&(a.ignore=[a.ignore]),a.ignore=a.ignore.map(function(a){return 1===a.length&&(a+=a),a}));var g=d.parse(i,{flat:!0,brackets:a.ignore}),c=g[0].split(f);if(a.escape){for(var h=[],b=0;b<c.length;b++){var e=c[b],j=c[b+1];"\\"===e[e.length-1]&&"\\"!==e[e.length-2]?(h.push(e+f+j),b++):h.push(e)}c=h}for(var b=0;b<c.length;b++)g[0]=c[b],c[b]=d.stringify(g,{flat:!0});return c}},{parenthesis:248}],307:[function(b,a,c){"use strict";a.exports=function(h){for(var f,b=h.length,g=new Array(b),i=new Array(b),j=new Array(b),k=new Array(b),l=new Array(b),m=new Array(b),a=0;a<b;++a)g[a]=-1,i[a]=0,j[a]=!1,k[a]=0,l[a]=-1,m[a]=[];var p=0,n=[],e=[];function o(a){var o=[a],f=[a];for(g[a]=i[a]=p,j[a]=!0,p+=1;f.length>0;){var r=h[a=f[f.length-1]];if(k[a]<r.length){for(var b=k[a];b<r.length;++b){var c=r[b];if(g[c]<0){g[c]=i[c]=p,j[c]=!0,p+=1,o.push(c),f.push(c);break}j[c]&&(i[a]=0|Math.min(i[a],i[c])),l[c]>=0&&m[a].push(l[c])}k[a]=b}else{if(i[a]===g[a]){for(var u=[],q=[],s=0,b=o.length-1;b>=0;--b){var d=o[b];if(j[d]=!1,u.push(d),q.push(m[d]),s+=m[d].length,l[d]=n.length,d===a){o.length=b;break}}n.push(u);for(var v=new Array(s),b=0;b<q.length;b++)for(var t=0;t<q[b].length;t++)v[--s]=q[b][t];e.push(v)}f.pop()}}}for(var a=0;a<b;++a)g[a]<0&&o(a);for(var a=0;a<e.length;a++){var c=e[a];if(0!==c.length){c.sort(function(a,b){return a-b}),f=[c[0]];for(var d=1;d<c.length;d++)c[d]!==c[d-1]&&f.push(c[d]);e[a]=f}}return{components:n,adjacencyList:e}}},{}],308:[function(c,b,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var d=function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return function(h,d){var a=[],b=!0,e=!1,f=void 0;try{for(var g,c=h[Symbol.iterator]();!(b=(g=c.next()).done)&&(a.push(g.value),!d||a.length!==d);b=!0);}catch(i){e=!0,f=i}finally{try{!b&&c.return&&c.return()}finally{if(e)throw f}}return a}(a,b);throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=2*Math.PI,f=function(a,f,g,b,c,h,i){var d=a.x,e=a.y;return{x:b*(d*=f)-c*(e*=g)+h,y:c*d+b*e+i}},g=function(b,a){var c=1.5707963267948966===a?.551915024494:-1.5707963267948966===a?-0.551915024494:4/3*Math.tan(a/4),f=Math.cos(b),g=Math.sin(b),d=Math.cos(b+a),e=Math.sin(b+a);return[{x:f-g*c,y:g+f*c},{x:d+e*c,y:e-d*c},{x:d,y:e}]},h=function(b,c,d,e){var a=b*d+c*e;return a>1&&(a=1),a< -1&&(a=-1),(b*e-c*d<0?-1:1)*Math.acos(a)},i=function(t,u,v,w,b,c,x,k,n,o,f,g){var l=Math.pow(b,2),m=Math.pow(c,2),p=Math.pow(f,2),q=Math.pow(g,2),a=l*m-l*q-m*p;a<0&&(a=0),a/=l*q+m*p;var i=(a=Math.sqrt(a)*(x===k?-1:1))*b/c*g,j=-(a*c)/b*f,r=(f-i)/b,s=(g-j)/c,y=h(1,0,r,s),d=h(r,s,(-f-i)/b,(-g-j)/c);return 0===k&&d>0&&(d-=e),1===k&&d<0&&(d+=e),[o*i-n*j+(t+v)/2,n*i+o*j+(u+w)/2,y,d]};a.default=function(a){var k=a.px,l=a.py,m=a.cx,n=a.cy,b=a.rx,c=a.ry,u=a.xAxisRotation,v=void 0===u?0:u,w=a.largeArcFlag,C=void 0===w?0:w,x=a.sweepFlag,D=void 0===x?0:x,y=[];if(0===b||0===c)return[];var o=Math.sin(v*e/360),p=Math.cos(v*e/360),q=p*(k-m)/2+o*(l-n)/2,r=-o*(k-m)/2+p*(l-n)/2;if(0===q&&0===r)return[];b=Math.abs(b),c=Math.abs(c);var s=Math.pow(q,2)/Math.pow(b,2)+Math.pow(r,2)/Math.pow(c,2);s>1&&(b*=Math.sqrt(s),c*=Math.sqrt(s));var E=i(k,l,m,n,b,c,C,D,o,p,q,r),h=d(E,4),F=h[0],G=h[1],z=h[2],j=h[3],t=Math.abs(j)/(e/4);1e-7>Math.abs(1-t)&&(t=1);var A=Math.max(Math.ceil(t),1);j/=A;for(var B=0;B<A;B++)y.push(g(z,j)),z+=j;return y.map(function(a){var d=f(a[0],b,c,p,o,F,G),h=d.x,i=d.y,e=f(a[1],b,c,p,o,F,G),j=e.x,k=e.y,g=f(a[2],b,c,p,o,F,G),l=g.x,m=g.y;return{x1:h,y1:i,x2:j,y2:k,x:l,y:m}})},b.exports=a.default},{}],309:[function(a,b,c){"use strict";var d=a("parse-svg-path"),e=a("abs-svg-path"),f=a("normalize-svg-path"),g=a("is-svg-path"),h=a("assert");b.exports=function(a){if(Array.isArray(a)&&1===a.length&&"string"==typeof a[0]&&(a=a[0]),"string"==typeof a&&(h(g(a),"String is not an SVG path."),a=d(a)),h(Array.isArray(a),"Argument should be a string or an array of path segments."),!(a=f(a=e(a))).length)return[0,0,0,0];for(var c=[1/0,1/0,-1/0,-1/0],j=0,k=a.length;j<k;j++)for(var i=a[j].slice(1),b=0;b<i.length;b+=2)i[b+0]<c[0]&&(c[0]=i[b+0]),i[b+1]<c[1]&&(c[1]=i[b+1]),i[b+0]>c[2]&&(c[2]=i[b+0]),i[b+1]>c[3]&&(c[3]=i[b+1]);return c}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(a,b,c){"use strict";b.exports=function(s){for(var m=[],n=0,o=0,t=0,u=0,h=null,i=null,b=0,c=0,p=0,w=s.length;p<w;p++){var a=s[p],v=a[0];switch(v){case"M":t=a[1],u=a[2];break;case"A":var k=d({px:b,py:c,cx:a[6],cy:a[7],rx:a[1],ry:a[2],xAxisRotation:a[3],largeArcFlag:a[4],sweepFlag:a[5]});if(!k.length)continue;for(var j,g,l=0;l<k.length;l++)a=["C",(g=k[l]).x1,g.y1,g.x2,g.y2,g.x,g.y],l<k.length-1&&m.push(a);break;case"S":var q=b,r=c;("C"==j||"S"==j)&&(q+=q-n,r+=r-o),a=["C",q,r,a[1],a[2],a[3],a[4]];break;case"T":"Q"==j||"T"==j?(h=2*b-h,i=2*c-i):(h=b,i=c),a=f(b,c,h,i,a[1],a[2]);break;case"Q":h=a[1],i=a[2],a=f(b,c,a[1],a[2],a[3],a[4]);break;case"L":a=e(b,c,a[1],a[2]);break;case"H":a=e(b,c,a[1],c);break;case"V":a=e(b,c,b,a[1]);break;case"Z":a=e(b,c,t,u);break}j=v,b=a[a.length-2],c=a[a.length-1],a.length>4?(n=a[a.length-4],o=a[a.length-3]):(n=b,o=c),m.push(a)}return m};var d=a("svg-arc-to-cubic-bezier");function e(c,d,a,b){return["C",c,d,a,b,a,b]}function f(e,f,a,b,c,d){return["C",e/3+2/3*a,f/3+2/3*b,c/3+2/3*a,d/3+2/3*b,c,d]}},{"svg-arc-to-cubic-bezier":308}],311:[function(a,b,d){"use strict";var e,f=a("svg-path-bounds"),g=a("parse-svg-path"),h=a("draw-svg-path"),i=a("is-svg-path"),j=a("bitmap-sdf"),c=document.createElement("canvas"),k=c.getContext("2d");b.exports=function(d,a){if(!i(d))throw Error("Argument should be valid svg path string");a||(a={}),a.shape?(l=a.shape[0],m=a.shape[1]):(l=c.width=a.w||a.width||200,m=c.height=a.h||a.height||200);var l,m,b=a.stroke||0,n=a.viewbox||a.viewBox||f(d),o=[l/(n[2]-n[0]),m/(n[3]-n[1])],p=Math.min(o[0]||0,o[1]||0)/2;if(k.fillStyle="black",k.fillRect(0,0,l,m),k.fillStyle="white",b&&("number"!=typeof b&&(b=1),b>0?k.strokeStyle="white":k.strokeStyle="black",k.lineWidth=Math.abs(b)),k.translate(.5*l,.5*m),k.scale(p,p),function(){if(null!=e)return e;var a=document.createElement("canvas").getContext("2d");if(a.canvas.width=a.canvas.height=1,!window.Path2D)return e=!1;var c=new Path2D("M0,0h1v1h-1v-1Z");a.fillStyle="black",a.fill(c);var b=a.getImageData(0,0,1,1);return e=b&&b.data&&255===b.data[3]}()){var q=new Path2D(d);k.fill(q),b&&k.stroke(q)}else h(k,g(d)),k.fill(),b&&k.stroke();return k.setTransform(1,0,0,1,0,0),j(k,{cutoff:null!=a.cutoff?a.cutoff:.5,radius:null!=a.radius?a.radius:.5*Math.min(l,m)})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(a,b,c){(function(b,d){(function(){var f=a("process/browser.js").nextTick,g=Function.prototype.apply,h=Array.prototype.slice,i={},j=0;function e(a,b){this._id=a,this._clearFn=b}c.setTimeout=function(){return new e(g.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new e(g.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},e.prototype.unref=e.prototype.ref=function(){},e.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof b?b:function(b){var a=j++,d=!(arguments.length<2)&&h.call(arguments,1);return i[a]=!0,f(function(){i[a]&&(d?b.apply(null,d):b.call(null),c.clearImmediate(a))}),a},c.clearImmediate="function"==typeof d?d:function(a){delete i[a]}}).call(this)}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(b,c,d){!function(e){var i=/^\s+/,j=/\s+$/,k=0,l=e.round,m=e.min,n=e.max,o=e.random;function b(a,d){if(d=d||{},(a=a||"")instanceof b)return a;if(!(this instanceof b))return new b(a,d);var c=p(a);this._originalInput=a,this._r=c.r,this._g=c.g,this._b=c.b,this._a=c.a,this._roundA=l(100*this._a)/100,this._format=d.format||c.format,this._gradientType=d.gradientType,this._r<1&&(this._r=l(this._r)),this._g<1&&(this._g=l(this._g)),this._b<1&&(this._b=l(this._b)),this._ok=c.ok,this._tc_id=k++}function p(a){var b={r:0,g:0,b:0},c=1,d=null,g=null,h=null,e=!1,f=!1;return"string"==typeof a&&(a=X(a)),"object"==typeof a&&(W(a.r)&&W(a.g)&&W(a.b)?(b=q(a.r,a.g,a.b),e=!0,f="%"===String(a.r).substr(-1)?"prgb":"rgb"):W(a.h)&&W(a.s)&&W(a.v)?(d=S(a.s),g=S(a.v),b=u(a.h,d,g),e=!0,f="hsv"):W(a.h)&&W(a.s)&&W(a.l)&&(d=S(a.s),h=S(a.l),b=s(a.h,d,h),e=!0,f="hsl"),a.hasOwnProperty("a")&&(c=a.a)),c=L(c),{ok:e,format:a.format||f,r:m(255,n(b.r,0)),g:m(255,n(b.g,0)),b:m(255,n(b.b,0)),a:c}}function q(a,b,c){return{r:255*M(a,255),g:255*M(b,255),b:255*M(c,255)}}function r(c,a,b){var d,h,e=n(c=M(c,255),a=M(a,255),b=M(b,255)),f=m(c,a,b),i=(e+f)/2;if(e==f)d=h=0;else{var g=e-f;switch(h=i>.5?g/(2-e-f):g/(e+f),e){case c:d=(a-b)/g+(a<b?6:0);break;case a:d=(b-c)/g+2;break;case b:d=(c-a)/g+4;break}d/=6}return{h:d,s:h,l:i}}function s(c,b,a){var e,f,g;function h(b,c,a){return(a<0&&(a+=1),a>1&&(a-=1),a<1/6)?b+(c-b)*6*a:a<.5?c:a<2/3?b+(c-b)*(2/3-a)*6:b}if(c=M(c,360),b=M(b,100),a=M(a,100),0===b)e=f=g=a;else{var d=a<.5?a*(1+b):a+b-a*b,i=2*a-d;e=h(i,d,c+1/3),f=h(i,d,c),g=h(i,d,c-1/3)}return{r:255*e,g:255*f,b:255*g}}function t(c,a,b){var d,g,e=n(c=M(c,255),a=M(a,255),b=M(b,255)),h=m(c,a,b),f=e-h;if(g=0===e?0:f/e,e==h)d=0;else{switch(e){case c:d=(a-b)/f+(a<b?6:0);break;case a:d=(b-c)/f+2;break;case b:d=(c-a)/f+4;break}d/=6}return{h:d,s:g,v:e}}function u(d,c,a){d=6*M(d,360),c=M(c,100);var i=e.floor(d),j=d-i,b=(a=M(a,100))*(1-c),f=a*(1-j*c),g=a*(1-(1-j)*c),h=i%6,k=[a,f,b,b,g,a][h],l=[g,a,a,f,b,b][h],m=[b,b,g,a,a,f][h];return{r:255*k,g:255*l,b:255*m}}function v(b,c,d,e){var a=[R(l(b).toString(16)),R(l(c).toString(16)),R(l(d).toString(16))];return e&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function w(a,b,c,d){return[R(T(d)),R(l(a).toString(16)),R(l(b).toString(16)),R(l(c).toString(16))].join("")}function x(d,a){a=0===a?0:a||10;var c=b(d).toHsl();return c.s-=a/100,c.s=N(c.s),b(c)}function y(d,a){a=0===a?0:a||10;var c=b(d).toHsl();return c.s+=a/100,c.s=N(c.s),b(c)}function z(a){return b(a).desaturate(100)}function A(d,a){a=0===a?0:a||10;var c=b(d).toHsl();return c.l+=a/100,c.l=N(c.l),b(c)}function B(d,c){c=0===c?0:c||10;var a=b(d).toRgb();return a.r=n(0,m(255,a.r-l(-(255*(c/100))))),a.g=n(0,m(255,a.g-l(-(255*(c/100))))),a.b=n(0,m(255,a.b-l(-(255*(c/100))))),b(a)}function C(d,a){a=0===a?0:a||10;var c=b(d).toHsl();return c.l-=a/100,c.l=N(c.l),b(c)}function D(d,e){var a=b(d).toHsl(),c=(a.h+e)%360;return a.h=c<0?360+c:c,b(a)}function E(c){var a=b(c).toHsl();return a.h=(a.h+180)%360,b(a)}function F(c){var a=b(c).toHsl(),d=a.h;return[b(c),b({h:(d+120)%360,s:a.s,l:a.l}),b({h:(d+240)%360,s:a.s,l:a.l})]}function G(d){var a=b(d).toHsl(),c=a.h;return[b(d),b({h:(c+90)%360,s:a.s,l:a.l}),b({h:(c+180)%360,s:a.s,l:a.l}),b({h:(c+270)%360,s:a.s,l:a.l})]}function H(c){var a=b(c).toHsl(),d=a.h;return[b(c),b({h:(d+72)%360,s:a.s,l:a.l}),b({h:(d+216)%360,s:a.s,l:a.l})]}function I(e,c,d){c=c||6,d=d||30;var a=b(e).toHsl(),f=360/d,g=[b(e)];for(a.h=(a.h-(f*c>>1)+720)%360;--c;)a.h=(a.h+f)%360,g.push(b(a));return g}function J(f,a){a=a||6;for(var c=b(f).toHsv(),g=c.h,h=c.s,d=c.v,e=[],i=1/a;a--;)e.push(b({h:g,s:h,v:d})),d=(d+i)%1;return e}b.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},getLuminance:function(){var a,b,c,f,g,h,d=this.toRgb();return a=d.r/255,b=d.g/255,c=d.b/255,f=a<=.03928?a/12.92:e.pow((a+.055)/1.055,2.4),g=b<=.03928?b/12.92:e.pow((b+.055)/1.055,2.4),h=c<=.03928?c/12.92:e.pow((c+.055)/1.055,2.4),.2126*f+.7152*g+.0722*h},setAlpha:function(a){return this._a=L(a),this._roundA=l(100*this._a)/100,this},toHsv:function(){var a=t(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=t(this._r,this._g,this._b),b=l(360*a.h),c=l(100*a.s),d=l(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=r(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=r(this._r,this._g,this._b),b=l(360*a.h),c=l(100*a.s),d=l(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+d+"%)":"hsla("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHex:function(a){return v(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(g){var b,c,d,e,f,a;return b=this._r,c=this._g,d=this._b,e=this._a,f=g,a=[R(l(b).toString(16)),R(l(c).toString(16)),R(l(d).toString(16)),R(T(e))],f&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:l(this._r),g:l(this._g),b:l(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+l(this._r)+", "+l(this._g)+", "+l(this._b)+")":"rgba("+l(this._r)+", "+l(this._g)+", "+l(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:l(100*M(this._r,255))+"%",g:l(100*M(this._g,255))+"%",b:l(100*M(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+l(100*M(this._r,255))+"%, "+l(100*M(this._g,255))+"%, "+l(100*M(this._b,255))+"%)":"rgba("+l(100*M(this._r,255))+"%, "+l(100*M(this._g,255))+"%, "+l(100*M(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(K[v(this._r,this._g,this._b,!0)]||!1)},toFilter:function(c){var d="#"+w(this._r,this._g,this._b,this._a),e=d,f=this._gradientType?"GradientType = 1, ":"";if(c){var a=b(c);e="#"+w(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+f+"startColorstr="+d+",endColorstr="+e+")"},toString:function(a){var c=!!a;a=a||this._format;var b=!1,d=this._a<1&&this._a>=0;return!c&&d&&("hex"===a||"hex6"===a||"hex3"===a||"hex4"===a||"hex8"===a||"name"===a)?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(b=this.toRgbString()),"prgb"===a&&(b=this.toPercentageRgbString()),("hex"===a||"hex6"===a)&&(b=this.toHexString()),"hex3"===a&&(b=this.toHexString(!0)),"hex4"===a&&(b=this.toHex8String(!0)),"hex8"===a&&(b=this.toHex8String()),"name"===a&&(b=this.toName()),"hsl"===a&&(b=this.toHslString()),"hsv"===a&&(b=this.toHsvString()),b||this.toHexString())},clone:function(){return b(this.toString())},_applyModification:function(b,c){var a=b.apply(null,[this].concat([].slice.call(c)));return this._r=a._r,this._g=a._g,this._b=a._b,this.setAlpha(a._a),this},lighten:function(){return this._applyModification(A,arguments)},brighten:function(){return this._applyModification(B,arguments)},darken:function(){return this._applyModification(C,arguments)},desaturate:function(){return this._applyModification(x,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(z,arguments)},spin:function(){return this._applyModification(D,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(E,arguments)},monochromatic:function(){return this._applyCombination(J,arguments)},splitcomplement:function(){return this._applyCombination(H,arguments)},triad:function(){return this._applyCombination(F,arguments)},tetrad:function(){return this._applyCombination(G,arguments)}},b.fromRatio=function(a,e){if("object"==typeof a){var d={};for(var c in a)a.hasOwnProperty(c)&&("a"===c?d[c]=a[c]:d[c]=S(a[c]));a=d}return b(a,e)},b.equals=function(a,c){return!!a&&!!c&&b(a).toRgbString()==b(c).toRgbString()},b.random=function(){return b.fromRatio({r:o(),g:o(),b:o()})},b.mix=function(f,g,c){c=0===c?0:c||50;var a=b(f).toRgb(),d=b(g).toRgb(),e=c/100;return b({r:(d.r-a.r)*e+a.r,g:(d.g-a.g)*e+a.g,b:(d.b-a.b)*e+a.b,a:(d.a-a.a)*e+a.a})},b.readability=function(d,f){var a=b(d),c=b(f);return(e.max(a.getLuminance(),c.getLuminance())+.05)/(e.min(a.getLuminance(),c.getLuminance())+.05)},b.isReadable=function(e,f,g){var d,a,c=b.readability(e,f);switch(a=!1,(d=Y(g)).level+d.size){case"AAsmall":case"AAAlarge":a=c>=4.5;break;case"AAlarge":a=c>=3;break;case"AAAsmall":a=c>=7;break}return a},b.mostReadable=function(d,e,a){var g,h,i,j,f=null,k=0;h=(a=a||{}).includeFallbackColors,i=a.level,j=a.size;for(var c=0;c<e.length;c++)(g=b.readability(d,e[c]))>k&&(k=g,f=b(e[c]));return b.isReadable(d,f,{level:i,size:j})||!h?f:(a.includeFallbackColors=!1,b.mostReadable(d,["#fff","#000"],a))};var h=b.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=b.hexNames=function(a){var c={};for(var b in a)a.hasOwnProperty(b)&&(c[a[b]]=b);return c}(h);function L(a){return(isNaN(a=parseFloat(a))||a<0||a>1)&&(a=1),a}function M(a,b){P(a)&&(a="100%");var c=Q(a);return(a=m(b,n(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),1e-6>e.abs(a-b))?1:a%b/parseFloat(b)}function N(a){return m(1,n(0,a))}function O(a){return parseInt(a,16)}function P(a){return"string"==typeof a&& -1!=a.indexOf(".")&&1===parseFloat(a)}function Q(a){return"string"==typeof a&& -1!=a.indexOf("%")}function R(a){return 1==a.length?"0"+a:""+a}function S(a){return a<=1&&(a=100*a+"%"),a}function T(a){return e.round(255*parseFloat(a)).toString(16)}function U(a){return O(a)/255}var d,f,g,V=(f="[\\s|\\(]+("+(d="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+d+")[,|\\s]+("+d+")\\s*\\)?",g="[\\s|\\(]+("+d+")[,|\\s]+("+d+")[,|\\s]+("+d+")[,|\\s]+("+d+")\\s*\\)?",{CSS_UNIT:new RegExp(d),rgb:new RegExp("rgb"+f),rgba:new RegExp("rgba"+g),hsl:new RegExp("hsl"+f),hsla:new RegExp("hsla"+g),hsv:new RegExp("hsv"+f),hsva:new RegExp("hsva"+g),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function W(a){return!!V.CSS_UNIT.exec(a)}function X(b){b=b.replace(i,"").replace(j,"").toLowerCase();var a,c=!1;if(h[b])b=h[b],c=!0;else if("transparent"==b)return{r:0,g:0,b:0,a:0,format:"name"};return(a=V.rgb.exec(b))?{r:a[1],g:a[2],b:a[3]}:(a=V.rgba.exec(b))?{r:a[1],g:a[2],b:a[3],a:a[4]}:(a=V.hsl.exec(b))?{h:a[1],s:a[2],l:a[3]}:(a=V.hsla.exec(b))?{h:a[1],s:a[2],l:a[3],a:a[4]}:(a=V.hsv.exec(b))?{h:a[1],s:a[2],v:a[3]}:(a=V.hsva.exec(b))?{h:a[1],s:a[2],v:a[3],a:a[4]}:(a=V.hex8.exec(b))?{r:O(a[1]),g:O(a[2]),b:O(a[3]),a:U(a[4]),format:c?"name":"hex8"}:(a=V.hex6.exec(b))?{r:O(a[1]),g:O(a[2]),b:O(a[3]),format:c?"name":"hex"}:(a=V.hex4.exec(b))?{r:O(a[1]+""+a[1]),g:O(a[2]+""+a[2]),b:O(a[3]+""+a[3]),a:U(a[4]+""+a[4]),format:c?"name":"hex8"}:!!(a=V.hex3.exec(b))&&{r:O(a[1]+""+a[1]),g:O(a[2]+""+a[2]),b:O(a[3]+""+a[3]),format:c?"name":"hex"}}function Y(c){var a,b;return a=((c=c||{level:"AA",size:"small"}).level||"AA").toUpperCase(),b=(c.size||"small").toLowerCase(),"AA"!==a&&"AAA"!==a&&(a="AA"),"small"!==b&&"large"!==b&&(b="small"),{level:a,size:b}}void 0!==c&&c.exports?c.exports=b:"function"==typeof a&&a.amd?a(function(){return b}):window.tinycolor=b}(Math)},{}],314:[function(b,a,c){"use strict";a.exports=e,a.exports.float32=a.exports.float=e,a.exports.fract32=a.exports.fract=function(a,b){if(a.length){if(a instanceof Float32Array)return new Float32Array(a.length);b instanceof Float32Array||(b=e(a));for(var c=0,d=b.length;c<d;c++)b[c]=a[c]-b[c];return b}return e(a-e(a))};var d=new Float32Array(1);function e(a){return a.length?a instanceof Float32Array?a:new Float32Array(a):(d[0]=a,d[0])}},{}],315:[function(a,b,d){"use strict";var e=a("parse-unit");function f(a,d){var b=e(getComputedStyle(a).getPropertyValue(d));return b[0]*c(b[1],a)}function c(b,a){switch(a=a||document.body,b=(b||"px").trim().toLowerCase(),(a===window||a===document)&&(a=document.body),b){case"%":return a.clientHeight/100;case"ch":case"ex":var e,d,c,g;return e=b,d=a,(c=document.createElement("div")).style["font-size"]="128"+e,d.appendChild(c),g=f(c,"font-size")/128,d.removeChild(c),g;case"em":return f(a,"font-size");case"rem":return f(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 37.79527559055118;case"mm":return 3.7795275590551185;case"pt":return 1.3333333333333333;case"pc":return 16}return 1}b.exports=c},{"parse-unit":251}],316:[function(b,c,d){!function(b,e){"object"==typeof d&& void 0!==c?e(d):"function"==typeof a&&a.amd?a(["exports"],e):e((b=b||self).topojson=b.topojson||{})}(this,function(a){"use strict";function g(a){return a}function b(a){if(null==a)return g;var b,c,d=a.scale[0],e=a.scale[1],f=a.translate[0],h=a.translate[1];return function(a,k){k||(b=c=0);var g=2,j=a.length,i=new Array(j);for(i[0]=(b+=a[0])*d+f,i[1]=(c+=a[1])*e+h;g<j;)i[g]=a[g],++g;return i}}function c(a){var d,i=b(a.transform),c=1/0,e=c,f=-c,g=-c;function j(a){(a=i(a))[0]<c&&(c=a[0]),a[0]>f&&(f=a[0]),a[1]<e&&(e=a[1]),a[1]>g&&(g=a[1])}function h(a){switch(a.type){case"GeometryCollection":a.geometries.forEach(h);break;case"Point":j(a.coordinates);break;case"MultiPoint":a.coordinates.forEach(j);break}}for(d in a.arcs.forEach(function(d){for(var a,b=-1,h=d.length;++b<h;)(a=i(d[b],b))[0]<c&&(c=a[0]),a[0]>f&&(f=a[0]),a[1]<e&&(e=a[1]),a[1]>g&&(g=a[1])}),a.objects)h(a.objects[d]);return[c,e,f,g]}function h(f,a){var b=a.id,c=a.bbox,d=null==a.properties?{}:a.properties,e=i(f,a);return null==b&&null==c?{type:"Feature",properties:d,geometry:e}:null==c?{type:"Feature",id:b,properties:d,geometry:e}:{type:"Feature",id:b,bbox:c,properties:d,geometry:e}}function i(a,c){var e=b(a.transform),f=a.arcs;function g(a,b){b.length&&b.pop();for(var d=f[a<0?~a:a],c=0,g=d.length;c<g;++c)b.push(e(d[c],c));a<0&&function(a,e){for(var d,b=a.length,c=b-e;c< --b;)d=a[c],a[c++]=a[b],a[b]=d}(b,g)}function h(a){return e(a)}function i(c){for(var a=[],b=0,d=c.length;b<d;++b)g(c[b],a);return a.length<2&&a.push(a[0]),a}function j(b){for(var a=i(b);a.length<4;)a.push(a[0]);return a}function k(a){return a.map(j)}function d(a){var b,c=a.type;switch(c){case"GeometryCollection":return{type:c,geometries:a.geometries.map(d)};case"Point":b=h(a.coordinates);break;case"MultiPoint":b=a.coordinates.map(h);break;case"LineString":b=i(a.arcs);break;case"MultiLineString":b=a.arcs.map(i);break;case"Polygon":b=k(a.arcs);break;case"MultiPolygon":b=a.arcs.map(k);break;default:return null}return{type:c,coordinates:b}}return d(c)}function j(f,a){var g={},b={},c={},e=[],h=-1;function d(b,c){for(var d in b){var a=b[d];delete c[a.start],delete a.start,delete a.end,a.forEach(function(a){g[a<0?~a:a]=1}),e.push(a)}}return a.forEach(function(b,e){var d,c=f.arcs[b<0?~b:b];!(c.length<3)||c[1][0]||c[1][1]||(d=a[++h],a[h]=b,a[e]=d)}),a.forEach(function(g){var e,h,i,l,a,d,o=(e=g,l=(i=f.arcs[e<0?~e:e])[0],f.transform?(h=[0,0],i.forEach(function(a){h[0]+=a[0],h[1]+=a[1]})):h=i[i.length-1],e<0?[h,l]:[l,h]),j=o[0],k=o[1];if(a=c[j])if(delete c[a.end],a.push(g),a.end=k,d=b[k]){delete b[d.start];var m=d===a?a:a.concat(d);b[m.start=a.start]=c[m.end=d.end]=m}else b[a.start]=c[a.end]=a;else if(a=b[k])if(delete b[a.start],a.unshift(g),a.start=j,d=c[j]){delete c[d.end];var n=d===a?a:d.concat(a);b[n.start=d.start]=c[n.end=a.end]=n}else b[a.start]=c[a.end]=a;else b[(a=[g]).start=j]=c[a.end=k]=a}),d(c,b),d(b,c),a.forEach(function(a){g[a<0?~a:a]||e.push([a])}),e}function d(c,e,f){var b,a,d;if(arguments.length>1)b=k(c,e,f);else for(a=0,b=new Array(d=c.arcs.length);a<d;++a)b[a]=a;return{type:"MultiLineString",arcs:j(c,b)}}function k(f,a,b){var g,c=[],d=[];function h(a){var b=a<0?~a:a;(d[b]||(d[b]=[])).push({i:a,g:g})}function i(a){a.forEach(h)}function j(a){a.forEach(i)}function e(a){switch(g=a,a.type){case"GeometryCollection":a.geometries.forEach(e);break;case"LineString":i(a.arcs);break;case"MultiLineString":case"Polygon":j(a.arcs);break;case"MultiPolygon":!function(a){a.forEach(j)}(a.arcs);break}}return e(a),d.forEach(null==b?function(a){c.push(a[0].i)}:function(a){b(a[0].g,a[a.length-1].g)&&c.push(a[0].i)}),c}function e(e,b){var f={},a=[],c=[];function d(a){switch(a.type){case"GeometryCollection":a.geometries.forEach(d);break;case"Polygon":g(a.arcs);break;case"MultiPolygon":a.arcs.forEach(g);break}}function g(b){b.forEach(function(a){a.forEach(function(a){(f[a=a<0?~a:a]||(f[a]=[])).push(b)})}),a.push(b)}function h(a){return function(b){for(var c,d=-1,e=b.length,a=b[e-1],f=0;++d<e;)c=a,a=b[d],f+=c[0]*a[1]-c[1]*a[0];return Math.abs(f)}(i(e,{type:"Polygon",arcs:[a]}).coordinates[0])}return b.forEach(d),a.forEach(function(a){if(!a._){var b=[],d=[a];for(a._=1,c.push(b);a=d.pop();)b.push(a),a.forEach(function(a){a.forEach(function(a){f[a<0?~a:a].forEach(function(a){a._||(a._=1,d.push(a))})})})}}),a.forEach(function(a){delete a._}),{type:"MultiPolygon",arcs:c.map(function(k){var c,a=[];if(k.forEach(function(b){b.forEach(function(b){b.forEach(function(b){f[b<0?~b:b].length<2&&a.push(b)})})}),(c=(a=j(e,a)).length)>1)for(var d,g,b=1,i=h(a[0]);b<c;++b)(d=h(a[b]))>i&&(g=a[0],a[0]=a[b],a[b]=g,i=d);return a}).filter(function(a){return a.length>0})}}function l(d,e){for(var a=0,b=d.length;a<b;){var c=a+b>>>1;d[c]<e?a=c+1:b=c}return a}function f(a){if(null==a)return g;var b,c,d=a.scale[0],e=a.scale[1],f=a.translate[0],h=a.translate[1];return function(a,m){m||(b=c=0);var g=2,j=a.length,i=new Array(j),k=Math.round((a[0]-f)/d),l=Math.round((a[1]-h)/e);for(i[0]=k-b,b=k,i[1]=l-c,c=l;g<j;)i[g]=a[g],++g;return i}}a.bbox=c,a.feature=function(b,a){return"string"==typeof a&&(a=b.objects[a]),"GeometryCollection"===a.type?{type:"FeatureCollection",features:a.geometries.map(function(a){return h(b,a)})}:h(b,a)},a.merge=function(a){return i(a,e.apply(this,arguments))},a.mergeArcs=e,a.mesh=function(a){return i(a,d.apply(this,arguments))},a.meshArcs=d,a.neighbors=function(i){var j={},f=i.map(function(){return[]});function n(a,b){a.forEach(function(a){a<0&&(a=~a);var c=j[a];c?c.push(b):j[a]=[b]})}function k(a,b){a.forEach(function(a){n(a,b)})}function o(a,b){"GeometryCollection"===a.type?a.geometries.forEach(function(a){o(a,b)}):a.type in p&&p[a.type](a.arcs,b)}var p={LineString:n,MultiLineString:k,Polygon:k,MultiPolygon:function(a,b){a.forEach(function(a){k(a,b)})}};for(var b in i.forEach(o),j)for(var g=j[b],m=g.length,c=0;c<m;++c)for(var h=c+1;h<m;++h){var a,d=g[c],e=g[h];(a=f[d])[b=l(a,e)]!==e&&a.splice(b,0,e),(a=f[e])[b=l(a,d)]!==d&&a.splice(b,0,d)}return f},a.quantize=function(a,b){if(a.transform)throw new Error("already quantized");if(b&&b.scale)m=a.bbox;else{if(!((h=Math.floor(b))>=2))throw new Error("n must be \u22652");var h,d=(m=a.bbox||c(a))[0],e=m[1],i=m[2],j=m[3];b={scale:[i-d?(i-d)/(h-1):1,j-e?(j-e)/(h-1):1],translate:[d,e]}}var m,g,o=f(b),k=a.objects,l={};function p(a){return o(a)}function n(a){var b;switch(a.type){case"GeometryCollection":b={type:"GeometryCollection",geometries:a.geometries.map(n)};break;case"Point":b={type:"Point",coordinates:p(a.coordinates)};break;case"MultiPoint":b={type:"MultiPoint",coordinates:a.coordinates.map(p)};break;default:return a}return null!=a.id&&(b.id=a.id),null!=a.bbox&&(b.bbox=a.bbox),null!=a.properties&&(b.properties=a.properties),b}for(g in k)l[g]=n(k[g]);return{type:"Topology",bbox:m,transform:b,objects:l,arcs:a.arcs.map(function(c){var d,e=0,b=1,f=c.length,a=new Array(f);for(a[0]=o(c[0],0);++e<f;)((d=o(c[e],e))[0]||d[1])&&(a[b++]=d);return 1===b&&(a[b++]=[0,0]),a.length=b,a})}},a.transform=b,a.untransform=f,Object.defineProperty(a,"__esModule",{value:!0})})},{}],317:[function(a,b,c){"use strict";var d=a("../prototype/is");b.exports=function(a){if("function"!=typeof a)return!1;if(!hasOwnProperty.call(a,"length"))return!1;try{if("number"!=typeof a.length)return!1;if("function"!=typeof a.call)return!1;if("function"!=typeof a.apply)return!1}catch(b){return!1}return!d(a)}},{"../prototype/is":324}],318:[function(a,b,c){"use strict";var d=a("../value/is"),e=a("../object/is"),f=a("../string/coerce"),g=a("./to-short-string"),h=function(a,b){return a.replace("%v",g(b))};b.exports=function(b,g,a){if(!e(a))throw new TypeError(h(g,b));if(!d(b)){if("default"in a)return a.default;if(a.isOptional)return null}var c=f(a.errorMessage);throw d(c)||(c=g),new TypeError(h(c,b))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(b,a,c){"use strict";a.exports=function(a){try{return a.toString()}catch(b){try{return String(a)}catch(c){return null}}}},{}],320:[function(a,b,c){"use strict";var d=a("./safe-to-string"),e=/[\n\r\u2028\u2029]/g;b.exports=function(b){var a=d(b);return null===a?"<Non-coercible to string value>":(a.length>100&&(a=a.slice(0,99)+"\u2026"),a=a.replace(e,function(a){switch(a){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(a,b,c){"use strict";var d=a("../value/is"),e={object:!0,"function":!0,undefined:!0};b.exports=function(a){return!!d(a)&&hasOwnProperty.call(e,typeof a)}},{"../value/is":327}],322:[function(a,b,c){"use strict";var d=a("../lib/resolve-exception"),e=a("./is");b.exports=function(a){return e(a)?a:d(a,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(a,b,c){"use strict";var d=a("../function/is"),e=/^\s*class[\s{/}]/,f=Function.prototype.toString;b.exports=function(a){return!!d(a)&&!e.test(f.call(a))}},{"../function/is":317}],324:[function(a,b,c){"use strict";var d=a("../object/is");b.exports=function(a){if(!d(a))return!1;try{if(!a.constructor)return!1;return a.constructor.prototype===a}catch(b){return!1}}},{"../object/is":321}],325:[function(a,b,c){"use strict";var d=a("../value/is"),e=a("../object/is"),f=Object.prototype.toString;b.exports=function(a){if(!d(a))return null;if(e(a)){var b=a.toString;if("function"!=typeof b)return null;if(b===f)return null}try{return""+a}catch(c){return null}}},{"../object/is":321,"../value/is":327}],326:[function(a,b,c){"use strict";var d=a("../lib/resolve-exception"),e=a("./is");b.exports=function(a){return e(a)?a:d(a,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(b,a,c){"use strict";var d=void 0;a.exports=function(a){return a!==d&&null!==a}},{}],328:[function(a,b,d){(function(b){(function(){"use strict";var u=a("bit-twiddle"),c=a("dup"),v=a("buffer").Buffer;b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:c([32,0]),UINT16:c([32,0]),UINT32:c([32,0]),BIGUINT64:c([32,0]),INT8:c([32,0]),INT16:c([32,0]),INT32:c([32,0]),BIGINT64:c([32,0]),FLOAT:c([32,0]),DOUBLE:c([32,0]),DATA:c([32,0]),UINT8C:c([32,0]),BUFFER:c([32,0])});var w="undefined"!=typeof Uint8ClampedArray,x="undefined"!=typeof BigUint64Array,y="undefined"!=typeof BigInt64Array,e=b.__TYPEDARRAY_POOL;e.UINT8C||(e.UINT8C=c([32,0])),e.BIGUINT64||(e.BIGUINT64=c([32,0])),e.BIGINT64||(e.BIGINT64=c([32,0])),e.BUFFER||(e.BUFFER=c([32,0]));var z=e.DATA,A=e.BUFFER;function f(a){if(a){var b=a.length||a.byteLength;z[u.log2(b)].push(a)}}function g(a){var a=u.nextPow2(a),b=z[u.log2(a)];return b.length>0?b.pop():new ArrayBuffer(a)}function h(a){return new Uint8Array(g(a),0,a)}function i(a){return new Uint16Array(g(2*a),0,a)}function j(a){return new Uint32Array(g(4*a),0,a)}function k(a){return new Int8Array(g(a),0,a)}function l(a){return new Int16Array(g(2*a),0,a)}function m(a){return new Int32Array(g(4*a),0,a)}function n(a){return new Float32Array(g(4*a),0,a)}function o(a){return new Float64Array(g(8*a),0,a)}function p(a){return w?new Uint8ClampedArray(g(a),0,a):h(a)}function q(a){return x?new BigUint64Array(g(8*a),0,a):null}function r(a){return y?new BigInt64Array(g(8*a),0,a):null}function s(a){return new DataView(g(a),0,a)}function t(a){a=u.nextPow2(a);var c=u.log2(a),b=A[c];return b.length>0?b.pop():new v(a)}d.free=function(a){if(v.isBuffer(a))A[u.log2(a.length)].push(a);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),!a)return;var b=a.length||a.byteLength;z[0|u.log2(b)].push(a)}},d.freeUint8=d.freeUint16=d.freeUint32=d.freeBigUint64=d.freeInt8=d.freeInt16=d.freeInt32=d.freeBigInt64=d.freeFloat32=d.freeFloat=d.freeFloat64=d.freeDouble=d.freeUint8Clamped=d.freeDataView=function(a){f(a.buffer)},d.freeArrayBuffer=f,d.freeBuffer=function(a){A[u.log2(a.length)].push(a)},d.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return g(a);switch(b){case"uint8":return h(a);case"uint16":return i(a);case"uint32":return j(a);case"int8":return k(a);case"int16":return l(a);case"int32":return m(a);case"float":case"float32":return n(a);case"double":case"float64":return o(a);case"uint8_clamped":return p(a);case"bigint64":return r(a);case"biguint64":return q(a);case"buffer":return t(a);case"data":case"dataview":return s(a);default:return null}return null},d.mallocArrayBuffer=g,d.mallocUint8=h,d.mallocUint16=i,d.mallocUint32=j,d.mallocInt8=k,d.mallocInt16=l,d.mallocInt32=m,d.mallocFloat32=d.mallocFloat=n,d.mallocFloat64=d.mallocDouble=o,d.mallocUint8Clamped=p,d.mallocBigUint64=q,d.mallocBigInt64=r,d.mallocDataView=s,d.mallocBuffer=t,d.clearCache=function(){for(var a=0;a<32;++a)e.UINT8[a].length=0,e.UINT16[a].length=0,e.UINT32[a].length=0,e.INT8[a].length=0,e.INT16[a].length=0,e.INT32[a].length=0,e.FLOAT[a].length=0,e.DOUBLE[a].length=0,e.BIGUINT64[a].length=0,e.BIGINT64[a].length=0,e.UINT8C[a].length=0,z[a].length=0,A[a].length=0}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(b,a,c){var d=/[\'\"]/;a.exports=function(a){return a?(d.test(a.charAt(0))&&(a=a.substr(1)),d.test(a.charAt(a.length-1))&&(a=a.substr(0,a.length-1)),a):""}},{}],330:[function(b,a,c){"use strict";a.exports=function(d,b,e){Array.isArray(e)||(e=[].slice.call(arguments,2));for(var f=0,h=e.length;f<h;f++){var g,c=e[f];for(var a in c)if((void 0===b[a]||Array.isArray(b[a])||d[a]!==b[a])&&a in b){if(!0===c[a])g=b[a];else if(!1===c[a])continue;else if("function"==typeof c[a]&& void 0===(g=c[a](b[a],d,b)))continue;d[a]=g}}return d}},{}],331:[function(a,b,d){(function(a){(function(){b.exports=function(a,b){if(c("noDeprecation"))return a;var d=!1;return function(){if(!d){if(c("throwDeprecation"))throw new Error(b);c("traceDeprecation")?console.trace(b):console.warn(b),d=!0}return a.apply(this,arguments)}};function c(c){try{if(!a.localStorage)return!1}catch(d){return!1}var b=a.localStorage[c];return null!=b&&"true"===String(b).toLowerCase()}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],332:[function(a,b,c){var d=a("get-canvas-context");b.exports=function(a){return d("webgl",a)}},{"get-canvas-context":194}],333:[function(c,e,f){var a=c("../main"),d=c("object-assign"),g=a.instance();function b(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}b.prototype=new a.baseCalendar,d(b.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(b,f){if("string"==typeof b){var c=b.match(i);return c?c[0]:""}var d=this._validateYear(b),e=b.month(),a=""+this.toChineseMonth(d,e);return f&&a.length<2&&(a="0"+a),this.isIntercalaryMonth(d,e)&&(a+="i"),a},monthNames:function(a){if("string"==typeof a){var c=a.match(j);return c?c[0]:""}var d=this._validateYear(a),e=a.month(),b=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(d,e)-1];return this.isIntercalaryMonth(d,e)&&(b="\u95F0"+b),b},monthNamesShort:function(a){if("string"==typeof a){var c=a.match(k);return c?c[0]:""}var d=this._validateYear(a),e=a.month(),b=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(d,e)-1];return this.isIntercalaryMonth(d,e)&&(b="\u95F0"+b),b},parseMonth:function(b,a){b=this._validateYear(b);var c,d=parseInt(a);if(isNaN(d))"\u95F0"===a[0]&&(c=!0,a=a.substring(1)),"\u6708"===a[a.length-1]&&(a=a.substring(0,a.length-1)),d=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(a);else{var e=a[a.length-1];c="i"===e||"I"===e}return this.toMonthIndex(b,d,c)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(a,b){if(a.year&&(a=a.year()),"number"!=typeof a||a<1888||a>2111)throw b.replace(/\{0\}/,this.local.name);return a},toMonthIndex:function(e,b,d){var c=this.intercalaryMonth(e);if(d&&b!==c||b<1||b>12)throw a.local.invalidMonth.replace(/\{0\}/,this.local.name);return c?!d&&b<=c?b-1:b:b-1},toChineseMonth:function(c,b){c.year&&(b=(c=c.year()).month());var d=this.intercalaryMonth(c);if(b<0||b>(d?12:11))throw a.local.invalidMonth.replace(/\{0\}/,this.local.name);return d?b<d?b+1:b:b+1},intercalaryMonth:function(a){return l[(a=this._validateYear(a))-l[0]]>>13},isIntercalaryMonth:function(a,b){a.year&&(b=(a=a.year()).month());var c=this.intercalaryMonth(a);return!!c&&c===b},leapYear:function(a){return 0!==this.intercalaryMonth(a)},weekOfYear:function(d,e,f){var b,c=m[this._validateYear(d,a.local.invalidyear)-m[0]];return(b=g.newDate(c>>9&4095,c>>5&15,31&c)).add(4-(b.dayOfWeek()||7),"d"),1+Math.floor((this.toJD(d,e,f)-b.toJD())/7)},monthsInYear:function(a){return this.leapYear(a)?13:12},daysInMonth:function(b,c){b.year&&(c=b.month(),b=b.year());var d=l[(b=this._validateYear(b))-l[0]];if(c>(d>>13?12:11))throw a.local.invalidMonth.replace(/\{0\}/,this.local.name);return d&1<<12-c?30:29},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(b,c,d){var e=this._validate(b,i,d,a.local.invalidDate);b=this._validateYear(e.year()),c=e.month(),d=e.day();var h=this.isIntercalaryMonth(b,c),i=this.toChineseMonth(b,c),f=o(b,i,d,h);return g.toJD(f.year,f.month,f.day)},fromJD:function(c){var b=g.fromJD(c),a=n(b.year(),b.month(),b.day()),d=this.toMonthIndex(a.year,a.month,a.isIntercalary);return this.newDate(a.year,d,a.day)},fromString:function(c){var a=c.match(h),b=this._validateYear(+a[1]),d=+a[2],e=!!a[3],f=this.toMonthIndex(b,d,e),g=+a[4];return this.newDate(b,f,g)},add:function(c,j,f){var g=c.year(),h=c.month(),k=this.isIntercalaryMonth(g,h),d=this.toChineseMonth(g,h),a=Object.getPrototypeOf(b.prototype).add.call(this,c,j,f);if("y"===f){var e=a.year(),l=a.month(),m=this.isIntercalaryMonth(e,d),i=k&&m?this.toMonthIndex(e,d,!0):this.toMonthIndex(e,d,!1);i!==l&&a.month(i)}return a}});var h=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,i=/^\d?\d[iI]?/m,j=/^??[]?/m,k=/^??[]?/m;a.calendars.chinese=b;var l=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],m=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function n(d,e,g,n){if("object"==typeof d)b=d,a=e||{};else{var b,a,h,c;if(!("number"==typeof d&&d>=1888&&d<=2111))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof e&&e>=1&&e<=12))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof g&&g>=1&&g<=31))throw new Error("Solar day outside range 1 - 31");b={year:d,month:e,day:g},a=n||{}}var f=m[b.year-m[0]],o=b.year<<9|b.month<<5|b.day;a.year=o>=f?b.year:b.year-1,f=m[a.year-m[0]];var p=new Date(f>>9&4095,(f>>5&15)-1,31&f),q=new Date(b.year,b.month-1,b.day);h=Math.round((q-p)/864e5);var j=l[a.year-l[0]];for(c=0;c<13;c++){var k=j&1<<12-c?30:29;if(h<k)break;h-=k}var i=j>>13;return!i||c<i?(a.isIntercalary=!1,a.month=1+c):c===i?(a.isIntercalary=!0,a.month=c):(a.isIntercalary=!1,a.month=c),a.day=1+h,a}function o(b,c,d,f,p){if("object"==typeof b)a=b,e=c||{};else{if(!("number"==typeof b&&b>=1888&&b<=2111))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof c&&c>=1&&c<=12))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof d&&d>=1&&d<=30))throw new Error("Lunar day outside range 1 - 30");"object"==typeof f?(q=!1,e=f):(q=!!f,e=p||{}),a={year:b,month:c,day:d,isIntercalary:q}}j=a.day-1;var j,k,e,a,q,n=l[a.year-l[0]],o=n>>13;k=o?a.month>o?a.month:a.isIntercalary?a.month:a.month-1:a.month-1;for(var g=0;g<k;g++)j+=n&1<<12-g?30:29;var h=m[a.year-m[0]],i=new Date(h>>9&4095,(h>>5&15)-1,(31&h)+j);return e.year=i.getFullYear(),e.month=1+i.getMonth(),e.day=i.getDate(),e}},{"../main":347,"object-assign":247}],334:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),a=b.year()+(0>b.year()?1:0);return a%4==3||a%4== -1},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear||c.regionalOptions[""].invalidYear),13},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(b,d){var a=this._validate(b,d,this.minDay,c.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(13===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(a,d,e){var b=this._validate(a,d,e,c.local.invalidDate);return(a=b.year())<0&&a++,b.day()+(b.month()-1)*30+(a-1)*365+Math.floor(a/4)+this.jdEpoch-1},fromJD:function(c){var a=Math.floor(c)+.5-this.jdEpoch,b=Math.floor((a-Math.floor((a+366)/1461))/365)+1;b<=0&&b--,a=Math.floor(c)+.5-this.newDate(b,1,1).toJD();var d=Math.floor(a/30)+1;return this.newDate(b,d,a-(d-1)*30+1)}}),c.calendars.coptic=a},{"../main":347,"object-assign":247}],335:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),!1},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),13},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),400},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(a,b){var d=this._validate(a,b,this.minDay,c.local.invalidMonth);return this.daysPerMonth[d.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(a,b,d){return(this._validate(a,b,d,c.local.invalidDate).day()+1)%8},weekDay:function(b,c,d){var a=this.dayOfWeek(b,c,d);return a>=2&&a<=6},extraInfo:function(a,b,d){return{century:g[Math.floor((this._validate(a,b,d,c.local.invalidDate).year()-1)/100)+1]||""}},toJD:function(d,a,e){var b=this._validate(d,a,e,c.local.invalidDate);return d=b.year()+(0>b.year()?1:0),a=b.month(),e=b.day(),e+(a>1?16:0)+(a>2?(a-2)*32:0)+(d-1)*400+this.jdEpoch-1},fromJD:function(a){a=Math.floor(a+.5)-Math.floor(this.jdEpoch)-1;var b=Math.floor(a/400)+1;a-=(b-1)*400,a+=a>15?16:0;var c=Math.floor(a/32)+1;return this.newDate(b<=0?b-1:b,c,a-(c-1)*32+1)}});var g={20:"Fruitbat",21:"Anchovy"};c.calendars.discworld=a},{"../main":347,"object-assign":247}],336:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),a=b.year()+(0>b.year()?1:0);return a%4==3||a%4== -1},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear||c.regionalOptions[""].invalidYear),13},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(b,d){var a=this._validate(b,d,this.minDay,c.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(13===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(a,d,e){var b=this._validate(a,d,e,c.local.invalidDate);return(a=b.year())<0&&a++,b.day()+(b.month()-1)*30+(a-1)*365+Math.floor(a/4)+this.jdEpoch-1},fromJD:function(c){var a=Math.floor(c)+.5-this.jdEpoch,b=Math.floor((a-Math.floor((a+366)/1461))/365)+1;b<=0&&b--,a=Math.floor(c)+.5-this.newDate(b,1,1).toJD();var d=Math.floor(a/30)+1;return this.newDate(b,d,a-(d-1)*30+1)}}),c.calendars.ethiopian=a},{"../main":347,"object-assign":247}],337:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}function g(a,b){return a-b*Math.floor(a/b)}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear);return this._leapYear(b.year())},_leapYear:function(a){return 7>g(7*(a=a<0?a+1:a)+1,19)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),this._leapYear(a.year?a.year():a)?13:12},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(a){return a=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear).year(),this.toJD(-1===a?1:a+1,7,1)-this.toJD(a,7,1)},daysInMonth:function(a,b){return a.year&&(b=a.month(),a=a.year()),this._validate(a,b,this.minDay,c.local.invalidMonth),12===b&&this.leapYear(a)?30:8===b&&5===g(this.daysInYear(a),10)?30:9===b&&3===g(this.daysInYear(a),10)?29:this.daysPerMonth[b-1]},weekDay:function(a,b,c){return 6!==this.dayOfWeek(a,b,c)},extraInfo:function(b,d,e){var a=this._validate(b,d,e,c.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(b,d,f){var g=this._validate(b,d,f,c.local.invalidDate);b=g.year(),d=g.month(),f=g.day();var h=b<=0?b+1:b,e=this.jdEpoch+this._delay1(h)+this._delay2(h)+f+1;if(d<7){for(var a=7;a<=this.monthsInYear(b);a++)e+=this.daysInMonth(b,a);for(var a=1;a<d;a++)e+=this.daysInMonth(b,a)}else for(var a=7;a<d;a++)e+=this.daysInMonth(b,a);return e},_delay1:function(c){var b=Math.floor((235*c-234)/19),a=29*b+Math.floor((12084+13753*b)/25920);return 3>g(3*(a+1),7)&&a++,a},_delay2:function(a){var c=this._delay1(a-1),b=this._delay1(a);return this._delay1(a+1)-b==356?2:b-c==382?1:0},fromJD:function(b){b=Math.floor(b)+.5;for(var a=Math.floor((b-this.jdEpoch)*98496/35975351)-1;b>=this.toJD(-1===a?1:a+1,7,1);)a++;for(var c=b<this.toJD(a,1,1)?7:1;b>this.toJD(a,c,this.daysInMonth(a,c));)c++;var d=b-this.toJD(a,c,1)+1;return this.newDate(a,c,d)}}),c.calendars.hebrew=a},{"../main":347,"object-assign":247}],338:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(a){return(11*this._validate(a,this.minMonth,this.minDay,c.local.invalidYear).year()+14)%30<11},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(a){return this.leapYear(a)?355:354},daysInMonth:function(b,d){var a=this._validate(b,d,this.minDay,c.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(a,b,c){return 5!==this.dayOfWeek(a,b,c)},toJD:function(a,b,d){var e=this._validate(a,b,d,c.local.invalidDate);return a=e.year(),b=e.month(),d=e.day(),a=a<=0?a+1:a,d+Math.ceil(29.5*(b-1))+(a-1)*354+Math.floor((3+11*a)/30)+this.jdEpoch-1},fromJD:function(b){b=Math.floor(b)+.5;var a=Math.floor((30*(b-this.jdEpoch)+10646)/10631);a=a<=0?a-1:a;var c=Math.min(12,Math.ceil((b-29-this.toJD(a,1,1))/29.5)+1),d=b-this.toJD(a,c,1)+1;return this.newDate(a,c,d)}}),c.calendars.islamic=a},{"../main":347,"object-assign":247}],339:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),a=0>b.year()?b.year()+1:b.year();return a%4==0},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(4-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(b,d){var a=this._validate(b,d,this.minDay,c.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(2===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(a,b,d){var e=this._validate(a,b,d,c.local.invalidDate);return a=e.year(),b=e.month(),d=e.day(),a<0&&a++,b<=2&&(a--,b+=12),Math.floor(365.25*(a+4716))+Math.floor(30.6001*(b+1))+d-1524.5},fromJD:function(g){var a=Math.floor(g+.5)+1524,d=Math.floor((a-122.1)/365.25),e=Math.floor(365.25*d),b=Math.floor((a-e)/30.6001),f=b-Math.floor(b<14?1:13),c=d-Math.floor(f>2?4716:4715);return c<=0&&c--,this.newDate(c,f,a-e-Math.floor(30.6001*b))}}),c.calendars.julian=a},{"../main":347,"object-assign":247}],340:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}function g(a,b){return a-b*Math.floor(a/b)}function h(a,b){return g(a-1,b)+1}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),!1},formatYear:function(a){var b=Math.floor((a=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear).year())/400);return a%=400,b+"."+Math.floor((a+=a<0?400:0)/20)+"."+a%20},forYear:function(a){if((a=a.split(".")).length<3)throw"Invalid Mayan year";for(var c=0,b=0;b<a.length;b++){var d=parseInt(a[b],10);if(Math.abs(d)>19||b>0&&d<0)throw"Invalid Mayan year";c=20*c+d}return c},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),18},weekOfYear:function(a,b,d){return this._validate(a,b,d,c.local.invalidDate),0},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,c.local.invalidYear),360},daysInMonth:function(a,b){return this._validate(a,b,this.minDay,c.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(a,b,d){return this._validate(a,b,d,c.local.invalidDate).day()},weekDay:function(a,b,d){return this._validate(a,b,d,c.local.invalidDate),!0},extraInfo:function(e,f,g){var d=this._validate(e,f,g,c.local.invalidDate).toJD(),a=this._toHaab(d),b=this._toTzolkin(d);return{haabMonthName:this.local.haabMonths[a[0]-1],haabMonth:a[0],haabDay:a[1],tzolkinDayName:this.local.tzolkinMonths[b[0]-1],tzolkinDay:b[0],tzolkinTrecena:b[1]}},_toHaab:function(b){var a=g((b-=this.jdEpoch)+8+340,365);return[Math.floor(a/20)+1,g(a,20)]},_toTzolkin:function(a){return[h((a-=this.jdEpoch)+20,20),h(a+4,13)]},toJD:function(b,d,e){var a=this._validate(b,d,e,c.local.invalidDate);return a.day()+20*a.month()+360*a.year()+this.jdEpoch},fromJD:function(a){a=Math.floor(a)+.5-this.jdEpoch;var b=Math.floor(a/360);return a%=360,a+=a<0?360:0,this.newDate(b,Math.floor(a/20),a%20)}}),c.calendars.mayan=a},{"../main":347,"object-assign":247}],341:[function(c,e,f){var a=c("../main"),d=c("object-assign");function b(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}b.prototype=new a.baseCalendar;var g=a.instance("gregorian");d(b.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(c){var b=this._validate(c,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return g.leapYear(b.year()+(1>b.year()?1:0)+1469)},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(c,d){var b=this._validate(c,d,this.minDay,a.local.invalidMonth);return this.daysPerMonth[b.month()-1]+(12===b.month()&&this.leapYear(b.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(b,f,h){var c=this._validate(b,f,h,a.local.invalidMonth),b=c.year();b<0&&b++;for(var e=c.day(),d=1;d<c.month();d++)e+=this.daysPerMonth[d-1];return e+g.toJD(b+1468,3,13)},fromJD:function(b){b=Math.floor(b+.5);for(var a=Math.floor((b-(this.jdEpoch-1))/366);b>=this.toJD(a+1,1,1);)a++;for(var d=b-Math.floor(this.toJD(a,1,1)+.5)+1,c=1;d>this.daysInMonth(a,c);)d-=this.daysInMonth(a,c),c++;return this.newDate(a,c,d)}}),a.calendars.nanakshahi=b},{"../main":347,"object-assign":247}],342:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(a){return this.daysInYear(a)!==this.daysPerYear},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(a){if(a=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[a])return this.daysPerYear;for(var d=0,b=this.minMonth;b<=12;b++)d+=this.NEPALI_CALENDAR_DATA[a][b];return d},daysInMonth:function(a,b){return a.year&&(b=a.month(),a=a.year()),this._validate(a,b,this.minDay,c.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[a]?this.daysPerMonth[b-1]:this.NEPALI_CALENDAR_DATA[a][b]},weekDay:function(a,b,c){return 6!==this.dayOfWeek(a,b,c)},toJD:function(e,f,g){var h=this._validate(e,f,g,c.local.invalidDate);e=h.year(),f=h.month(),g=h.day();var i=c.instance(),b=0,a=f,d=e;this._createMissingCalendarData(e);var j=e-(a>9||9===a&&g>=this.NEPALI_CALENDAR_DATA[d][0]?56:57);for(9!==f&&(b=g,a--);9!==a;)a<=0&&(a=12,d--),b+=this.NEPALI_CALENDAR_DATA[d][a],a--;return 9===f?(b+=g-this.NEPALI_CALENDAR_DATA[d][0])<0&&(b+=i.daysInYear(j)):b+=this.NEPALI_CALENDAR_DATA[d][9]-this.NEPALI_CALENDAR_DATA[d][0],i.newDate(j,1,1).add(b,"d").toJD()},fromJD:function(g){var e=c.instance().fromJD(g),h=e.year(),f=e.dayOfYear(),a=h+56;this._createMissingCalendarData(a);for(var b=9,i=this.NEPALI_CALENDAR_DATA[a][0],d=this.NEPALI_CALENDAR_DATA[a][b]-i+1;f>d;)b++,b>12&&(b=1,a++),d+=this.NEPALI_CALENDAR_DATA[a][b];var j=this.NEPALI_CALENDAR_DATA[a][b]-(d-f);return this.newDate(a,b,j)},_createMissingCalendarData:function(b){var c=this.daysPerMonth.slice(0);c.unshift(17);for(var a=b-1;a<b+2;a++)void 0===this.NEPALI_CALENDAR_DATA[a]&&(this.NEPALI_CALENDAR_DATA[a]=c)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),c.calendars.nepali=a},{"../main":347,"object-assign":247}],343:[function(c,e,f){var b=c("../main"),d=c("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}function g(a,b){return a-b*Math.floor(a/b)}a.prototype=new b.baseCalendar,d(a.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xe6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xe6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(c){var a=this._validate(c,this.minMonth,this.minDay,b.local.invalidYear);return((a.year()-(a.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-((a.dayOfWeek()+1)%7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(c,d){var a=this._validate(c,d,this.minDay,b.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(12===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(a,b,c){return 5!==this.dayOfWeek(a,b,c)},toJD:function(c,a,d){var e=this._validate(c,a,d,b.local.invalidDate);c=e.year(),a=e.month(),d=e.day();var f=c-(c>=0?474:473),h=474+g(f,2820);return d+(a<=7?(a-1)*31:(a-1)*30+6)+Math.floor((682*h-110)/2816)+(h-1)*365+1029983*Math.floor(f/2820)+this.jdEpoch-1},fromJD:function(b){var e=(b=Math.floor(b)+.5)-this.toJD(475,1,1),j=Math.floor(e/1029983),c=g(e,1029983),f=2820;if(1029982!==c){var h=Math.floor(c/366);f=Math.floor((2134*h+2816*g(c,366)+2815)/1028522)+h+1}var a=f+2820*j+474;a=a<=0?a-1:a;var d=b-this.toJD(a,1,1)+1,i=d<=186?Math.ceil(d/31):Math.ceil((d-6)/30),k=b-this.toJD(a,i,1)+1;return this.newDate(a,i,k)}}),b.calendars.persian=a,b.calendars.jalali=a},{"../main":347,"object-assign":247}],344:[function(c,e,f){var a=c("../main"),d=c("object-assign"),g=a.instance();function b(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}b.prototype=new a.baseCalendar,d(b.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(b){var c=this._validate(b,this.minMonth,this.minDay,a.local.invalidYear),b=this._t2gYear(c.year());return g.leapYear(b)},weekOfYear:function(b,d,e){var c=this._validate(b,this.minMonth,this.minDay,a.local.invalidYear),b=this._t2gYear(c.year());return g.weekOfYear(b,c.month(),c.day())},daysInMonth:function(c,d){var b=this._validate(c,d,this.minDay,a.local.invalidMonth);return this.daysPerMonth[b.month()-1]+(2===b.month()&&this.leapYear(b.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(b,d,e){var c=this._validate(b,d,e,a.local.invalidDate),b=this._t2gYear(c.year());return g.toJD(b,c.month(),c.day())},fromJD:function(b){var a=g.fromJD(b),c=this._g2tYear(a.year());return this.newDate(c,a.month(),a.day())},_t2gYear:function(a){return a+this.yearsOffset+(a>= -this.yearsOffset&&a<= -1?1:0)},_g2tYear:function(a){return a-this.yearsOffset-(a>=1&&a<=this.yearsOffset?1:0)}}),a.calendars.taiwan=b},{"../main":347,"object-assign":247}],345:[function(c,e,f){var a=c("../main"),d=c("object-assign"),g=a.instance();function b(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}b.prototype=new a.baseCalendar,d(b.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(b){var c=this._validate(b,this.minMonth,this.minDay,a.local.invalidYear),b=this._t2gYear(c.year());return g.leapYear(b)},weekOfYear:function(b,d,e){var c=this._validate(b,this.minMonth,this.minDay,a.local.invalidYear),b=this._t2gYear(c.year());return g.weekOfYear(b,c.month(),c.day())},daysInMonth:function(c,d){var b=this._validate(c,d,this.minDay,a.local.invalidMonth);return this.daysPerMonth[b.month()-1]+(2===b.month()&&this.leapYear(b.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(b,d,e){var c=this._validate(b,d,e,a.local.invalidDate),b=this._t2gYear(c.year());return g.toJD(b,c.month(),c.day())},fromJD:function(b){var a=g.fromJD(b),c=this._g2tYear(a.year());return this.newDate(c,a.month(),a.day())},_t2gYear:function(a){return a-this.yearsOffset-(a>=1&&a<=this.yearsOffset?1:0)},_g2tYear:function(a){return a+this.yearsOffset+(a>= -this.yearsOffset&&a<= -1?1:0)}}),a.calendars.thai=b},{"../main":347,"object-assign":247}],346:[function(b,e,f){var c=b("../main"),d=b("object-assign");function a(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}a.prototype=new c.baseCalendar,d(a.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,c.local.invalidYear);return 355===this.daysInYear(b.year())},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(c){for(var b=0,a=1;a<=12;a++)b+=this.daysInMonth(c,a);return b},daysInMonth:function(d,e){for(var f=this._validate(d,e,this.minDay,c.local.invalidMonth).toJD()-24e5+.5,a=0,b=0;b<g.length;b++){if(g[b]>f)return g[a]-g[a-1];a++}return 30},weekDay:function(a,b,c){return 5!==this.dayOfWeek(a,b,c)},toJD:function(b,d,e){var a=this._validate(b,d,e,c.local.invalidDate),f=12*(a.year()-1)+a.month()-15292,h=a.day()+g[f-1]-1;return h+24e5-.5},fromJD:function(f){for(var c=f-24e5+.5,a=0,b=0;b<g.length&&!(g[b]>c);b++)a++;var d=a+15292,e=Math.floor((d-1)/12),h=c-g[a-1]+1;return this.newDate(e+1,d-12*e,h)},isValid:function(a,d,e){var b=c.baseCalendar.prototype.isValid.apply(this,arguments);return b&&(b=(a=null!=a.year?a.year:a)>=1276&&a<=1500),b},_validate:function(d,e,f,b){var a=c.baseCalendar.prototype._validate.apply(this,arguments);if(a.year<1276||a.year>1500)throw b.replace(/\{0\}/,this.local.name);return a}}),c.calendars.ummalqura=a;var g=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(g,h,i){var a=g("object-assign");function e(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function f(a,b,c,e){if(this._calendar=a,this._year=b,this._month=c,this._day=e,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(d.local.invalidDate||d.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function j(a,b){return a=""+a,"000000".substring(0,b-a.length)+a}function b(){this.shortYearCutoff="+10"}function c(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}a(e.prototype,{instance:function(a,b){a=(a||"gregorian").toLowerCase(),b=b||"";var c=this._localCals[a+"-"+b];if(!c&&this.calendars[a]&&(c=new this.calendars[a](b),this._localCals[a+"-"+b]=c),!c)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return c},newDate:function(a,c,d,b,e){return(b=(null!=a&&a.year?a.calendar():"string"==typeof b?this.instance(b,e):b)||this.instance()).newDate(a,c,d)},substituteDigits:function(a){return function(b){return(b+"").replace(/[0-9]/g,function(b){return a[b]})}},substituteChineseDigits:function(a,b){return function(d){for(var c="",e=0;d>0;){var f=d%10;c=(0===f?"":a[f]+b[e])+c,e++,d=Math.floor(d/10)}return 0===c.indexOf(a[1]+b[1])&&(c=c.substr(1)),c||a[0]}}}),a(f.prototype,{newDate:function(a,b,c){return this._calendar.newDate(null==a?this:a,b,c)},year:function(a){return 0===arguments.length?this._year:this.set(a,"y")},month:function(a){return 0===arguments.length?this._month:this.set(a,"m")},day:function(a){return 0===arguments.length?this._day:this.set(a,"d")},date:function(a,b,c){if(!this._calendar.isValid(a,b,c))throw(d.local.invalidDate||d.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=b,this._day=c,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,b){return this._calendar.add(this,a,b)},set:function(a,b){return this._calendar.set(this,a,b)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(d.local.differentCalendars||d.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var b=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return 0===b?0:b<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(0>this.year()?"-":"")+j(Math.abs(this.year()),4)+"-"+j(this.month(),2)+"-"+j(this.day(),2)}}),a(b.prototype,{_validateLevel:0,newDate:function(a,b,c){return null==a?this.today():(a.year&&(this._validate(a,b,c,d.local.invalidDate||d.regionalOptions[""].invalidDate),c=a.day(),b=a.month(),a=a.year()),new f(this,a,b,c))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){return 0>this._validate(a,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear).year()?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(b){var a=this._validate(b,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear);return(0>a.year()?"-":"")+j(Math.abs(a.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear),12},monthOfYear:function(b,c){var a=this._validate(b,c,this.minDay,d.local.invalidMonth||d.regionalOptions[""].invalidMonth);return(a.month()+this.monthsInYear(a)-this.firstMonth)%this.monthsInYear(a)+this.minMonth},fromMonthOfYear:function(a,c){var b=(c+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,b,this.minDay,d.local.invalidMonth||d.regionalOptions[""].invalidMonth),b},daysInYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear);return this.leapYear(b)?366:365},dayOfYear:function(b,c,e){var a=this._validate(b,c,e,d.local.invalidDate||d.regionalOptions[""].invalidDate);return a.toJD()-this.newDate(a.year(),this.fromMonthOfYear(a.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,b,c){var e=this._validate(a,b,c,d.local.invalidDate||d.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(e))+2)%this.daysInWeek()},extraInfo:function(a,b,c){return this._validate(a,b,c,d.local.invalidDate||d.regionalOptions[""].invalidDate),{}},add:function(a,b,c){return this._validate(a,this.minMonth,this.minDay,d.local.invalidDate||d.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,b,c),b,c)},_add:function(c,f,d){if(this._validateLevel++,"d"===d||"w"===d){var g=c.toJD()+f*("w"===d?this.daysInWeek():1),a=c.calendar().fromJD(g);return this._validateLevel--,[a.year(),a.month(),a.day()]}try{var b=c.year()+("y"===d?f:0),e=c.monthOfYear()+("m"===d?f:0),a=c.day(),h=function(a){for(;e<a.minMonth;)b--,e+=a.monthsInYear(b);for(var c=a.monthsInYear(b);e>c-1+a.minMonth;)b++,e-=c,c=a.monthsInYear(b)};"y"===d?(c.month()!==this.fromMonthOfYear(b,e)&&(e=this.newDate(b,c.month(),this.minDay).monthOfYear()),e=Math.min(e,this.monthsInYear(b)),a=Math.min(a,this.daysInMonth(b,this.fromMonthOfYear(b,e)))):"m"===d&&(h(this),a=Math.min(a,this.daysInMonth(b,this.fromMonthOfYear(b,e))));var i=[b,this.fromMonthOfYear(b,e),a];return this._validateLevel--,i}catch(j){throw this._validateLevel--,j}},_correctAdd:function(b,a,e,c){if(!this.hasYearZero&&("y"===c||"m"===c)&&(0===a[0]||b.year()>0!=a[0]>0)){var d={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[c],f=e<0?-1:1;a=this._add(b,e*d[0]+f*d[1],d[2])}return b.date(a[0],a[1],a[2])},set:function(a,c,b){this._validate(a,this.minMonth,this.minDay,d.local.invalidDate||d.regionalOptions[""].invalidDate);var f="y"===b?c:a.year(),g="m"===b?c:a.month(),e="d"===b?c:a.day();return("y"===b||"m"===b)&&(e=Math.min(e,this.daysInMonth(f,g))),a.date(f,g,e)},isValid:function(c,a,d){this._validateLevel++;var b=this.hasYearZero||0!==c;if(b){var e=this.newDate(c,a,this.minDay);b=a>=this.minMonth&&a-this.minMonth<this.monthsInYear(e)&&d>=this.minDay&&d-this.minDay<this.daysInMonth(e)}return this._validateLevel--,b},toJSDate:function(a,b,c){var e=this._validate(a,b,c,d.local.invalidDate||d.regionalOptions[""].invalidDate);return d.instance().fromJD(this.toJD(e)).toJSDate()},fromJSDate:function(a){return this.fromJD(d.instance().fromJSDate(a).toJD())},_validate:function(a,b,c,e){if(a.year){if(0===this._validateLevel&&this.name!==a.calendar().name)throw(d.local.differentCalendars||d.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(a,b,c))throw e.replace(/\{0\}/,this.local.name);var f=this.newDate(a,b,c);return this._validateLevel--,f}catch(g){throw this._validateLevel--,g}}}),c.prototype=new b,a(c.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var b=this._validate(a,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear),a=b.year()+(0>b.year()?1:0);return a%4==0&&(a%100!=0||a%400==0)},weekOfYear:function(b,c,d){var a=this.newDate(b,c,d);return a.add(4-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(b,c){var a=this._validate(b,c,this.minDay,d.local.invalidMonth||d.regionalOptions[""].invalidMonth);return this.daysPerMonth[a.month()-1]+(2===a.month()&&this.leapYear(a.year())?1:0)},weekDay:function(a,b,c){return 6>(this.dayOfWeek(a,b,c)||7)},toJD:function(a,b,c){var e=this._validate(a,b,c,d.local.invalidDate||d.regionalOptions[""].invalidDate);a=e.year(),b=e.month(),c=e.day(),a<0&&a++,b<3&&(b+=12,a--);var f=Math.floor(a/100);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(b+1))+c+(2-f+Math.floor(f/4))-1524.5},fromJD:function(i){var e=Math.floor(i+.5),a=Math.floor((e-1867216.25)/36524.25),b=(a=e+1+a-Math.floor(a/4))+1524,f=Math.floor((b-122.1)/365.25),g=Math.floor(365.25*f),c=Math.floor((b-g)/30.6001),h=c-(c>13.5?13:1),d=f-(h>2.5?4716:4715);return d<=0&&d--,this.newDate(d,h,b-g-Math.floor(30.6001*c))},toJSDate:function(c,e,f){var b=this._validate(c,e,f,d.local.invalidDate||d.regionalOptions[""].invalidDate),a=new Date(b.year(),b.month()-1,b.day());return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(a.getHours()>12?a.getHours()+2:0),a},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var d=h.exports=new e;d.cdate=f,d.baseCalendar=b,d.calendars.gregorian=c},{"object-assign":247}],348:[function(c,d,e){var b=c("object-assign"),a=c("./main");b(a.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),a.local=a.regionalOptions[""],b(a.cdate.prototype,{formatDate:function(a,b){return"string"!=typeof a&&(b=a,a=""),this._calendar.formatDate(a||"",this,b)}}),b(a.baseCalendar.prototype,{UNIX_EPOCH:a.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:a.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(d,b,e){if("string"!=typeof d&&(e=b,b=d,d=""),!b)return"";if(b.calendar()!==this)throw a.local.invalidFormat||a.regionalOptions[""].invalidFormat;d=d||this.local.dateFormat;var j=(e=e||{}).dayNamesShort||this.local.dayNamesShort,k=e.dayNames||this.local.dayNames,p=e.monthNumbers||this.local.monthNumbers,q=e.monthNamesShort||this.local.monthNamesShort,r=e.monthNames||this.local.monthNames;e.calculateWeek||this.local.calculateWeek;for(var g=function(b,c){for(var a=1;f+a<d.length&&d.charAt(f+a)===b;)a++;return f+=a-1,Math.floor(a/(c||1))>1},h=function(b,c,d,e){var a=""+c;if(g(b,e))for(;a.length<d;)a="0"+a;return a},l=function(b,a,c,d){return g(b)?d[a]:c[a]},s=this,m=function(a){return"function"==typeof p?p.call(s,a,g("m")):o(h("m",a.month(),2))},n=function(a,b){return b?"function"==typeof r?r.call(s,a):r[a.month()-s.minMonth]:"function"==typeof q?q.call(s,a):q[a.month()-s.minMonth]},t=this.local.digits,o=function(a){return e.localNumbers&&t?t(a):a},c="",i=!1,f=0;f<d.length;f++)if(i)"'"!==d.charAt(f)||g("'")?c+=d.charAt(f):i=!1;else switch(d.charAt(f)){case"d":c+=o(h("d",b.day(),2));break;case"D":c+=l("D",b.dayOfWeek(),j,k);break;case"o":c+=h("o",b.dayOfYear(),3);break;case"w":c+=h("w",b.weekOfYear(),2);break;case"m":c+=m(b);break;case"M":c+=n(b,g("M"));break;case"y":c+=g("y",2)?b.year():(b.year()%100<10?"0":"")+b.year()%100;break;case"Y":g("Y",2),c+=b.formatYear();break;case"J":c+=b.toJD();break;case"@":c+=(b.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":c+=(b.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":g("'")?c+="'":i=!0;break;default:c+=d.charAt(f)}return c},parseDate:function(i,e,f){if(null==e)throw a.local.invalidArguments||a.regionalOptions[""].invalidArguments;if(""===(e="object"==typeof e?e.toString():e+""))return null;i=i||this.local.dateFormat;var g=(f=f||{}).shortYearCutoff||this.shortYearCutoff;g="string"!=typeof g?g:this.today().year()%100+parseInt(g,10);for(var s=f.dayNamesShort||this.local.dayNamesShort,t=f.dayNames||this.local.dayNames,u=f.parseMonth||this.local.parseMonth,z=f.monthNumbers||this.local.monthNumbers,A=f.monthNamesShort||this.local.monthNamesShort,B=f.monthNames||this.local.monthNames,j=-1,b=-1,c=-1,k=-1,m=-1,r=!1,n=!1,o=function(b,c){for(var a=1;h+a<i.length&&i.charAt(h+a)===b;)a++;return h+=a-1,Math.floor(a/(c||1))>1},d=function(c,f){var d=o(c,f),g=[2,3,d?4:2,d?4:2,10,11,20]["oyYJ@!".indexOf(c)+1],h=new RegExp("^-?\\d{1,"+g+"}"),b=e.substring(l).match(h);if(!b)throw(a.local.missingNumberAt||a.regionalOptions[""].missingNumberAt).replace(/\{0\}/,l);return l+=b[0].length,parseInt(b[0],10)},C=this,v=function(){if("function"==typeof z){o("m");var a=z.call(C,e.substring(l));return l+=a.length,a}return d("m")},w=function(d,f,g,h){for(var c=o(d,h)?g:f,b=0;b<c.length;b++)if(e.substr(l,c[b].length).toLowerCase()===c[b].toLowerCase())return l+=c[b].length,b+C.minMonth;throw(a.local.unknownNameAt||a.regionalOptions[""].unknownNameAt).replace(/\{0\}/,l)},x=function(){if("function"==typeof B){var a=o("M")?B.call(C,e.substring(l)):A.call(C,e.substring(l));return l+=a.length,a}return w("M",A,B)},p=function(){if(e.charAt(l)!==i.charAt(h))throw(a.local.unexpectedLiteralAt||a.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,l);l++},l=0,h=0;h<i.length;h++)if(n)"'"!==i.charAt(h)||o("'")?p():n=!1;else switch(i.charAt(h)){case"d":k=d("d");break;case"D":w("D",s,t);break;case"o":m=d("o");break;case"w":d("w");break;case"m":c=v();break;case"M":c=x();break;case"y":var y=h;r=!o("y",2),h=y,b=d("y",2);break;case"Y":b=d("Y",2);break;case"J":j=d("J")+.5,"."===e.charAt(l)&&(l++,d("J"));break;case"@":j=d("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":j=d("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":l=e.length;break;case"'":o("'")?p():n=!0;break;default:p()}if(l<e.length)throw a.local.unexpectedText||a.regionalOptions[""].unexpectedText;if(-1===b?b=this.today().year():b<100&&r&&(b+=-1===g?1900:this.today().year()-this.today().year()%100-(b<=g?0:100)),"string"==typeof c&&(c=u.call(this,b,c)),m> -1){c=1,k=m;for(var q=this.daysInMonth(b,c);k>q;q=this.daysInMonth(b,c))c++,k-=q}return j> -1?this.fromJD(j):this.newDate(b,c,k)},determineDate:function(a,b,d,c,e){d&&"object"!=typeof d&&(e=c,c=d,d=null),"string"!=typeof c&&(e=c,c="");var f=this;return b=b?b.newDate():null,a=null==a?b:"string"==typeof a?function(a){try{return f.parseDate(c,a,e)}catch(i){}for(var g=((a=a.toLowerCase()).match(/^c/)&&d?d.newDate():null)||f.today(),h=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,b=h.exec(a);b;)g.add(parseInt(b[1],10),b[2]||"d"),b=h.exec(a);return g}(a):"number"==typeof a?isNaN(a)||a===1/0||a=== -1/0?b:f.today().add(a,"d"):f.newDate(a)}})},{"./main":347,"object-assign":247}],349:[function(b,a,c){"use strict";a.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(a,e,g){"use strict";var c=a("./arrow_paths"),d=a("../../plots/font_attributes"),b=a("../../plots/cartesian/constants"),f=a("../../plot_api/plot_template").templatedArray;a("../../constants/axis_placeable_objects"),e.exports=f("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:d({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:c.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:c.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",b.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",b.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",b.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",b.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:d({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("./draw").draw;function g(a){var b=a._fullLayout;d.filterVisible(b.annotations).forEach(function(b){var c=e.getFromId(a,b.xref),d=e.getFromId(a,b.yref),f=e.getRefType(b.xref),g=e.getRefType(b.yref);b._extremes={},"range"===f&&h(b,c),"range"===g&&h(b,d)})}function h(a,c){var i,j=c._id,b=j.charAt(0),k=a[b],d=a["a"+b],t=a[b+"ref"],u=a["a"+b+"ref"],l=a["_"+b+"padplus"],m=a["_"+b+"padminus"],h={x:1,y:-1}[b]*a[b+"shift"],n=3*a.arrowsize*a.arrowwidth||0,o=n+h,p=n-h,q=3*a.startarrowsize*a.arrowwidth||0,f=q+h,g=q-h;if(u===t){var r=e.findExtremes(c,[c.r2c(k)],{ppadplus:o,ppadminus:p}),s=e.findExtremes(c,[c.r2c(d)],{ppadplus:Math.max(l,f),ppadminus:Math.max(m,g)});i={min:[r.min[0],s.min[0]],max:[r.max[0],s.max[0]]}}else f=d?f+d:f,g=d?g-d:g,i=e.findExtremes(c,[c.r2c(k)],{ppadplus:Math.max(l,o,f),ppadminus:Math.max(m,p,g)});a._extremes[j]=i}b.exports=function(a){var b=a._fullLayout;if(d.filterVisible(b.annotations).length&&a._fullData.length)return d.syncOrAsync([f,g],a)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=a("../../plot_api/plot_template").arrayEditor;function g(o,j){var b,c,a,g,d,e,f,k=o._fullLayout.annotations,l=[],i=[],m=[],n=(j||[]).length;for(b=0;b<k.length;b++)if(g=(a=k[b]).clicktoshow){for(c=0;c<n;c++)if(e=(d=j[c]).xaxis,f=d.yaxis,e._id===a.xref&&f._id===a.yref&&e.d2r(d.x)===h(a._xclick,e)&&f.d2r(d.y)===h(a._yclick,f)){(a.visible?"onout"===g?i:m:l).push(b);break}c===n&&a.visible&&"onout"===g&&i.push(b)}return{on:l,off:i,explicitOff:m}}function h(b,a){return"log"===a.type?a.l2r(b):a.d2r(b)}b.exports={hasClickToShow:function(b,c){var a=g(b,c);return a.on.length>0||a.explicitOff.length>0},onClick:function(b,m){var a,c,h=g(b,m),i=h.on,j=h.off.concat(h.explicitOff),k={},l=b._fullLayout.annotations;if(i.length||j.length){for(a=0;a<i.length;a++)(c=f(b.layout,"annotations",l[i[a]])).modifyItem("visible",!0),d.extendFlat(k,c.getUpdateObj());for(a=0;a<j.length;a++)(c=f(b.layout,"annotations",l[j[a]])).modifyItem("visible",!1),d.extendFlat(k,c.getUpdateObj());return e.call("update",b,{},k)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../color");b.exports=function(s,m,c,a){a("opacity");var f=a("bgcolor"),n=a("bordercolor"),g=e.opacity(n);a("borderpad");var o=a("borderwidth"),h=a("showarrow");a("text",h?" ":c._dfltTitle.annotation),a("textangle"),d.coerceFont(a,"font",c.font),a("width"),a("align");var p=a("height");if(p&&a("valign"),h){var i,j,k=a("arrowside");-1!==k.indexOf("end")&&(i=a("arrowhead"),j=a("arrowsize")),-1!==k.indexOf("start")&&(a("startarrowhead",i),a("startarrowsize",j)),a("arrowcolor",g?m.bordercolor:e.defaultLine),a("arrowwidth",2*(g&&o||1)),a("standoff"),a("startstandoff")}var l=a("hovertext"),b=c.hoverlabel||{};if(l){var q=a("hoverlabel.bgcolor",b.bgcolor||(e.opacity(f)?e.rgb(f):e.defaultLine)),r=a("hoverlabel.bordercolor",b.bordercolor||e.contrast(q));d.coerceFont(a,"hoverlabel.font",{family:b.font.family,size:b.font.size,color:b.font.color||r})}a("captureevents",!!l)}},{"../../lib":515,"../color":367}],354:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib/to_log_range");b.exports=function(i,a,g,m){a=a||{};var f,j,k="log"===g&&"linear"===a.type,l="linear"===g&&"log"===a.type;if(k||l)for(var h=i._fullLayout.annotations,b=a._id.charAt(0),c=0;c<h.length;c++)f=h[c],j="annotations["+c+"].",f[b+"ref"]===a._id&&n(b),f["a"+b+"ref"]===a._id&&n("a"+b);function n(c){var g=f[c],b=null;d(b=k?e(g,a.range):Math.pow(10,g))||(b=null),m(j+c,b)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../../plots/array_container_defaults"),g=a("./common_defaults"),h=a("./attributes");function i(f,a,n){function b(b,c){return d.coerce(f,a,h,b,c)}var s=b("visible"),o=b("clicktoshow");if(s||o){g(f,a,n,b);for(var p=a.showarrow,t=["x","y"],u=[-10,-30],c={_fullLayout:n},k=0;k<2;k++){var i=t[k],l=e.coerceRef(f,a,c,i,"","paper");if("paper"!==l&&e.getFromId(c,l)._annIndices.push(a._index),e.coercePosition(a,c,b,l,i,.5),p){var m="a"+i,j=e.coerceRef(f,a,c,m,"pixel",["pixel","paper"]);"pixel"!==j&&j!==l&&(j=a[m]="pixel");var v="pixel"===j?u[k]:.4;e.coercePosition(a,c,b,j,m,v)}b(i+"anchor"),b(i+"shift")}if(d.noneOrAll(f,a,["x","y"]),p&&d.noneOrAll(f,a,["ax","ay"]),o){var q=b("xclick"),r=b("yclick");a._xclick=void 0===q?a.x:e.cleanPosition(q,c,a.xref),a._yclick=void 0===r?a.y:e.cleanPosition(r,c,a.yref)}}}b.exports=function(a,b){f(a,b,{name:"annotations",handleItemDefaults:i})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(a,b,f){"use strict";var g=a("@plotly/d3"),h=a("../../registry"),i=a("../../plots/plots"),c=a("../../lib"),j=c.strTranslate,k=a("../../plots/cartesian/axes"),l=a("../color"),m=a("../drawing"),n=a("../fx"),o=a("../../lib/svg_text_utils"),p=a("../../lib/setcursor"),q=a("../dragelement"),r=a("../../plot_api/plot_template").arrayEditor,s=a("./draw_arrow_head");function d(a,f){var b=a._fullLayout.annotations[f]||{},c=k.getFromId(a,b.xref),d=k.getFromId(a,b.yref);c&&c.setScale(),d&&d.setScale(),e(a,b,f,!1,c,d)}function t(b,a,c,f,g){var d=g[c],h=g[c+"ref"],e=-1!==c.indexOf("y"),i="domain"===k.getRefType(h),j=e?f.h:f.w;return b?i?d+(e?-a:a)/b._length:b.p2r(b.r2p(d)+a):d+(e?-a:a)/j}function e(d,a,i,u,J,K){var e,v,b=d._fullLayout,L=d._fullLayout._size,w=d._context.edits;u?(e="annotation-"+u,v=u+".annotations"):(e="annotation",v="annotations");var x=r(d.layout,v,a),M=x.modifyBase,N=x.modifyItem,O=x.getUpdateObj;b._infolayer.selectAll("."+e+'[data-index="'+i+'"]').remove();var y="clip"+b._uid+"_ann"+i;if(!a._input|| !1===a.visible){g.selectAll("#"+y).remove();return}var P={x:{},y:{}},Q=+a.textangle||0,D=b._infolayer.append("g").classed(e,!0).attr("data-index",String(i)).style("opacity",a.opacity),E=D.append("g").classed("annotation-text-g",!0),F=w[a.showarrow?"annotationTail":"annotationPosition"],G=a.captureevents||w.annotationText||F;function R(c){var b={index:i,annotation:a._input,fullAnnotation:a,event:c};return u&&(b.subplotId=u),b}var f=E.append("g").style("pointer-events",G?"all":null).call(p,"pointer").on("click",function(){d._dragging=!1,d.emit("plotly_clickannotation",R(g.event))});a.hovertext&&f.on("mouseover",function(){var e=a.hoverlabel,f=e.font,c=this.getBoundingClientRect(),g=d.getBoundingClientRect();n.loneHover({x0:c.left-g.left,x1:c.right-g.left,y:(c.top+c.bottom)/2-g.top,text:a.hovertext,color:e.bgcolor,borderColor:e.bordercolor,fontFamily:f.family,fontSize:f.size,fontColor:f.color},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:d})}).on("mouseout",function(){n.loneUnhover(b._hoverlayer.node())});var z=a.borderwidth,S=z+a.borderpad,T=f.append("rect").attr("class","bg").style("stroke-width",z+"px").call(l.stroke,a.bordercolor).call(l.fill,a.bgcolor),H=a.width||a.height,A=b._topclips.selectAll("#"+y).data(H?[0]:[]);A.enter().append("clipPath").classed("annclip",!0).attr("id",y).append("rect"),A.exit().remove();var U=a.font,I=b._meta?c.templateString(a.text,b._meta):a.text,B=f.append("text").classed("annotation-text",!0).text(I);function C(b){return b.call(m.font,U).attr({"text-anchor":{left:"start",right:"end"}[a.align]||"middle"}),o.convertToTspans(b,d,V),b}function V(){var az,I=B.selectAll("a");1===I.size()&&I.text()===B.text()&&f.insert("a",":first-child").attr({"xlink:xlink:href":I.attr("xlink:href"),"xlink:xlink:show":I.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(T.node());var Z=f.select(".annotation-text-math-group"),ak=!Z.empty(),U=m.bBox((ak?Z:B).node()),al=U.width,am=U.height,$=a.width||al,_=a.height||am,aa=Math.round($+2*S),ab=Math.round(_+2*S);function ac(b,a){return"auto"===a&&(a=b<1/3?"left":b>2/3?"right":"center"),({center:0,middle:0,left:.5,bottom:-0.5,right:-0.5,top:.5})[a]}for(var ad=!1,an=["x","y"],ae=0;ae<an.length;ae++){var r,C,x,af,v,e=an[ae],V=a[e+"ref"]||e,W=a["a"+e+"ref"],i={x:J,y:K}[e],ao=(Q+("x"===e?0:-90))*Math.PI/180,ap=aa*Math.cos(ao),aq=ab*Math.sin(ao),X=Math.abs(ap)+Math.abs(aq),av=a[e+"anchor"],G=a[e+"shift"]*("x"===e?1:-1),g=P[e],ar=k.getRefType(V);if(i&&"domain"!==ar){var Y=i.r2fraction(a[e]);(Y<0||Y>1)&&(W===V?((Y=i.r2fraction(a["a"+e]))<0||Y>1)&&(ad=!0):ad=!0),r=i._offset+i.r2p(a[e]),af=.5}else{var as="domain"===ar;"x"===e?(x=a[e],r=as?i._offset+i._length*x:r=L.l+L.w*x):(x=1-a[e],r=as?i._offset+i._length*x:r=L.t+L.h*x),af=a.showarrow?.5:x}if(a.showarrow){g.head=r;var n=a["a"+e];if(v=ap*ac(.5,a.xanchor)-aq*ac(.5,a.yanchor),W===V){var at=k.getRefType(W);"domain"===at?("y"===e&&(n=1-n),g.tail=i._offset+i._length*n):"paper"===at?"y"===e?(n=1-n,g.tail=L.t+L.h*n):g.tail=L.l+L.w*n:g.tail=i._offset+i.r2p(n),C=v}else g.tail=r+n,C=v+n;g.text=g.tail+v;var au=b["x"===e?"width":"height"];if("paper"===V&&(g.head=c.constrain(g.head,1,au-1)),"pixel"===W){var ag=-Math.max(g.tail-3,g.text),ah=Math.min(g.tail+3,g.text)-au;ag>0?(g.tail+=ag,g.text+=ag):ah>0&&(g.tail-=ah,g.text-=ah)}g.tail+=G,g.head+=G}else C=v=X*ac(af,av),g.text=r+v;g.text+=G,v+=G,C+=G,a["_"+e+"padplus"]=X/2+C,a["_"+e+"padminus"]=X/2-C,a["_"+e+"size"]=X,a["_"+e+"shift"]=v}if(ad){f.remove();return}var ai=0,aj=0;if("left"!==a.align&&(ai=($-al)*("center"===a.align?.5:1)),"top"!==a.valign&&(aj=(_-am)*("middle"===a.valign?.5:1)),ak)Z.select("svg").attr({x:S+ai-1,y:S+aj}).call(m.setClipUrl,H?y:null,d);else{var aw=S+aj-U.top,ax=S+ai-U.left;B.call(o.positionText,ax,aw).call(m.setClipUrl,H?y:null,d)}A.select("rect").call(m.setRect,S,S,$,_),T.call(m.setRect,z/2,z/2,aa-z,ab-z),f.call(m.setTranslate,Math.round(P.x.text-aa/2),Math.round(P.y.text-ab/2)),E.attr({transform:"rotate("+Q+","+P.x.text+","+P.y.text+")"});var ay=function(x,y){D.selectAll(".annotation-arrow-g").remove();var g=P.x.head,i=P.y.head,k=P.x.tail+x,n=P.y.tail+y,z=P.x.text+x,A=P.y.text+y,B=c.rotationXYMatrix(Q,z,A),Y=c.apply2DTransform(B),V=c.apply2DTransform2(B),C=+T.attr("width"),F=+T.attr("height"),b=z-.5*C,o=b+C,e=A-.5*F,p=e+F,G=[[b,e,b,p],[b,p,o,p],[o,p,o,e],[o,e,b,e]].map(V);if(!G.reduce(function(b,a){return!!c.segmentsIntersect(g,i,g+1e6,i+1e6,a[0],a[1],a[2],a[3])^b},!1)){G.forEach(function(a){var b=c.segmentsIntersect(k,n,g,i,a[0],a[1],a[2],a[3]);b&&(k=b.x,n=b.y)});var H=a.arrowwidth,I=a.arrowcolor,W=a.arrowside,R=D.append("g").style({opacity:l.opacity(I)}).classed("annotation-arrow-g",!0),S=R.append("path").attr("d","M"+k+","+n+"L"+g+","+i).style("stroke-width",H+"px").call(l.stroke,l.rgb(I));if(s(S,W,a),w.annotationPosition&&S.node().parentNode&&!u){var Z,$,r=g,v=i;if(a.standoff){var U=Math.sqrt(Math.pow(g-k,2)+Math.pow(i-n,2));r+=a.standoff*(k-g)/U,v+=a.standoff*(n-i)/U}var X=R.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(k-r)+","+(n-v),transform:j(r,v)}).style("stroke-width",H+6+"px").call(l.stroke,"rgba(0,0,0,0)").call(l.fill,"rgba(0,0,0,0)");q.init({element:X.node(),gd:d,prepFn:function(){var a=m.getTranslate(f);Z=a.x,$=a.y,J&&J.autorange&&M(J._name+".autorange",!0),K&&K.autorange&&M(K._name+".autorange",!0)},moveFn:function(b,c){var d=Y(Z,$),e=d[0]+b,g=d[1]+c;f.call(m.setTranslate,e,g),N("x",t(J,b,"x",L,a)),N("y",t(K,c,"y",L,a)),a.axref===a.xref&&N("ax",t(J,b,"ax",L,a)),a.ayref===a.yref&&N("ay",t(K,c,"ay",L,a)),R.attr("transform",j(b,c)),E.attr({transform:"rotate("+Q+","+e+","+g+")"})},doneFn:function(){h.call("_guiRelayout",d,O());var a=document.querySelector(".js-notes-box-panel");a&&a.redraw(a.selectedObj)}})}}};a.showarrow&&ay(0,0),F&&q.init({element:f.node(),gd:d,prepFn:function(){az=E.attr("transform")},moveFn:function(b,c){var d,e,g="pointer";if(a.showarrow)a.axref===a.xref?N("ax",t(J,b,"ax",L,a)):N("ax",a.ax+b),a.ayref===a.yref?N("ay",t(K,c,"ay",L.w,a)):N("ay",a.ay+c),ay(b,c);else{if(u)return;if(J)d=t(J,b,"x",L,a);else{var h=a._xsize/L.w,k=a.x+(a._xshift-a.xshift)/L.w-h/2;d=q.align(k+b/L.w,h,0,1,a.xanchor)}if(K)e=t(K,c,"y",L,a);else{var i=a._ysize/L.h,l=a.y-(a._yshift+a.yshift)/L.h-i/2;e=q.align(l-c/L.h,i,0,1,a.yanchor)}N("x",d),N("y",e),J&&K||(g=q.getCursor(J?.5:d,K?.5:e,a.xanchor,a.yanchor))}E.attr({transform:j(b,c)+az}),p(f,g)},clickFn:function(c,b){a.captureevents&&d.emit("plotly_clickannotation",R(b))},doneFn:function(){p(f),h.call("_guiRelayout",d,O());var a=document.querySelector(".js-notes-box-panel");a&&a.redraw(a.selectedObj)}})}w.annotationText?B.call(o.makeEditable,{delegate:f,gd:d}).call(C).on("edit",function(b){a.text=b,this.call(C),N("text",b),J&&J.autorange&&M(J._name+".autorange",!0),K&&K.autorange&&M(K._name+".autorange",!0),h.call("_guiRelayout",d,O())}):B.call(C)}b.exports={draw:function(b){var c=b._fullLayout;c._infolayer.selectAll(".annotation").remove();for(var a=0;a<c.annotations.length;a++)c.annotations[a].visible&&d(b,a);return i.previousPromises(b)},drawOne:d,drawRaw:e}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(a,c,d){"use strict";var e=a("@plotly/d3"),f=a("../color"),g=a("./arrow_paths"),b=a("../../lib"),h=b.strScale,i=b.strRotate,j=b.strTranslate;c.exports=function(l,t,m){var c,d,n,s,k=l.node(),u=g[m.arrowhead||0],v=g[m.startarrowhead||0],w=(m.arrowwidth||1)*(m.arrowsize||1),x=(m.arrowwidth||1)*(m.startarrowsize||1),D=t.indexOf("start")>=0,E=t.indexOf("end")>=0,a=u.backoff*w+m.standoff,b=v.backoff*x+m.startstandoff;if("line"===k.nodeName){c={x:+l.attr("x1"),y:+l.attr("y1")},d={x:+l.attr("x2"),y:+l.attr("y2")};var o=c.x-d.x,p=c.y-d.y;if(s=(n=Math.atan2(p,o))+Math.PI,a&&b&&a+b>Math.sqrt(o*o+p*p)){K();return}if(a){if(a*a>o*o+p*p){K();return}var F=a*Math.cos(n),G=a*Math.sin(n);d.x+=F,d.y+=G,l.attr({x2:d.x,y2:d.y})}if(b){if(b*b>o*o+p*p){K();return}var H=b*Math.cos(n),I=b*Math.sin(n);c.x-=H,c.y-=I,l.attr({x1:c.x,y1:c.y})}}else if("path"===k.nodeName){var q=k.getTotalLength(),r="";if(q<a+b){K();return}var y=k.getPointAtLength(0),z=k.getPointAtLength(.1);n=Math.atan2(y.y-z.y,y.x-z.x),c=k.getPointAtLength(Math.min(b,q)),r="0px,"+b+"px,";var A=k.getPointAtLength(q),B=k.getPointAtLength(q-.1);s=Math.atan2(A.y-B.y,A.x-B.x),d=k.getPointAtLength(Math.max(0,q-a));var J=r?b+a:a;r+=q-J+"px,"+q+"px",l.style("stroke-dasharray",r)}function K(){l.style("stroke-dasharray","0px,100px")}function C(a,b,c,d){a.path&&(a.noRotate&&(c=0),e.select(k.parentNode).append("path").attr({"class":l.attr("class"),d:a.path,transform:j(b.x,b.y)+i(180*c/Math.PI)+h(d)}).style({fill:f.rgb(m.arrowcolor),"stroke-width":0}))}D&&C(v,c,n,x),E&&C(u,d,s,w)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(a,d,e){"use strict";var b=a("./draw"),c=a("./click");d.exports={moduleType:"component",name:"annotations",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("annotations"),calcAutorange:a("./calc_autorange"),draw:b.draw,drawOne:b.drawOne,drawRaw:b.drawRaw,hasClickToShow:c.hasClickToShow,onClick:c.onClick,convertCoords:a("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(b,c,f){"use strict";var a=b("../annotations/attributes"),d=b("../../plot_api/edit_types").overrideAll,e=b("../../plot_api/plot_template").templatedArray;c.exports=d(e("annotation",{visible:a.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:a.xanchor,xshift:a.xshift,yanchor:a.yanchor,yshift:a.yshift,text:a.text,textangle:a.textangle,font:a.font,width:a.width,height:a.height,opacity:a.opacity,align:a.align,valign:a.valign,bgcolor:a.bgcolor,bordercolor:a.bordercolor,borderpad:a.borderpad,borderwidth:a.borderwidth,showarrow:a.showarrow,arrowcolor:a.arrowcolor,arrowhead:a.arrowhead,startarrowhead:a.startarrowhead,arrowside:a.arrowside,arrowsize:a.arrowsize,startarrowsize:a.startarrowsize,arrowwidth:a.arrowwidth,standoff:a.standoff,startstandoff:a.startstandoff,hovertext:a.hovertext,hoverlabel:a.hoverlabel,captureevents:a.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes");function f(a,c){var f=c.fullSceneLayout.domain,b=c.fullLayout._size,g={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};a._xa={},d.extendFlat(a._xa,g),e.setConvert(a._xa),a._xa._offset=b.l+f.x[0]*b.w,a._xa.l2p=function(){return .5*(1+a._pdata[0]/a._pdata[3])*b.w*(f.x[1]-f.x[0])},a._ya={},d.extendFlat(a._ya,g),e.setConvert(a._ya),a._ya._offset=b.t+(1-f.y[1])*b.h,a._ya.l2p=function(){return .5*(1-a._pdata[1]/a._pdata[3])*b.h*(f.y[1]-f.y[0])}}b.exports=function(a){for(var c=a.fullSceneLayout.annotations,b=0;b<c.length;b++)f(c[b],a);a.fullLayout._infolayer.selectAll(".annotation-"+a.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../../plots/array_container_defaults"),g=a("../annotations/common_defaults"),h=a("./attributes");function i(c,a,j,i){function b(b,e){return d.coerce(c,a,h,b,e)}function f(c){var d=c+"axis",f={_fullLayout:{}};return f._fullLayout[d]=j[d],e.coercePosition(a,f,b,c,c,.5)}b("visible")&&(g(c,a,i.fullLayout,b),f("x"),f("y"),f("z"),d.noneOrAll(c,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",b("xanchor"),b("yanchor"),b("xshift"),b("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",b("ax",-10),b("ay",-30),d.noneOrAll(c,a,["ax","ay"])))}b.exports=function(a,b,c){f(a,b,{name:"annotations",handleItemDefaults:i,fullLayout:c.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(a,b,c){"use strict";var d=a("../annotations/draw").drawRaw,e=a("../../plots/gl3d/project"),f=["x","y","z"];b.exports=function(b){for(var c=b.fullSceneLayout,h=b.dataScale,j=c.annotations,g=0;g<j.length;g++){for(var a=j[g],k=!1,i=0;i<3;i++){var l=f[i],n=a[l],o=c[l+"axis"],m=o.r2fraction(n);if(m<0||m>1){k=!0;break}}k?b.fullLayout._infolayer.select(".annotation-"+b.id+'[data-index="'+g+'"]').remove():(a._pdata=e(b.glplot.cameraParams,[c.xaxis.r2l(a.x)*h[0],c.yaxis.r2l(a.y)*h[1],c.zaxis.r2l(a.z)*h[2]]),d(b.graphDiv,a,g,b.id,a._xa,a._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:a("./attributes")}}},layoutAttributes:a("./attributes"),handleDefaults:a("./defaults"),includeBasePlot:function(f,g){var a=d.subplotsRegistry.gl3d;if(a)for(var i=a.attrRegex,h=Object.keys(f),b=0;b<h.length;b++){var c=h[b];i.test(c)&&(f[c].annotations||[]).length&&(e.pushUnique(g._basePlotModules,a),e.pushUnique(g._subplots.gl3d,c))}},convert:a("./convert"),draw:a("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(a,b,c){"use strict";b.exports=a("world-calendars/dist/main"),a("world-calendars/dist/plus"),a("world-calendars/dist/calendars/chinese"),a("world-calendars/dist/calendars/coptic"),a("world-calendars/dist/calendars/discworld"),a("world-calendars/dist/calendars/ethiopian"),a("world-calendars/dist/calendars/hebrew"),a("world-calendars/dist/calendars/islamic"),a("world-calendars/dist/calendars/julian"),a("world-calendars/dist/calendars/mayan"),a("world-calendars/dist/calendars/nanakshahi"),a("world-calendars/dist/calendars/nepali"),a("world-calendars/dist/calendars/persian"),a("world-calendars/dist/calendars/taiwan"),a("world-calendars/dist/calendars/thai"),a("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(d,j,o){"use strict";var k=d("./calendars"),e=d("../../lib"),i=d("../../constants/numerical"),p=i.EPOCHJD,q=i.ONEDAY,l={valType:"enumerated",values:e.sortObjectKeys(k.calendars),editType:"calc",dflt:"gregorian"},m=function(c,d,a,f){var b={};return b[a]=l,e.coerce(c,d,b,a,f)},r={d:{"0":"dd","-":"d"},e:{"0":"d","-":"d"},a:{"0":"D","-":"D"},A:{"0":"DD","-":"DD"},j:{"0":"oo","-":"o"},W:{"0":"ww","-":"w"},m:{"0":"mm","-":"m"},b:{"0":"M","-":"M"},B:{"0":"MM","-":"MM"},y:{"0":"yy","-":"yy"},Y:{"0":"yyyy","-":"yyyy"},U:"##",w:"##",c:{"0":"D M d %X yyyy","-":"D M d %X yyyy"},x:{"0":"mm/dd/yyyy","-":"mm/dd/yyyy"}},s={};function n(a){var b=s[a];return b||(b=s[a]=k.instance(a))}function b(a){return e.extendFlat({},l,{description:a})}function f(a){return"Sets the calendar system to use with `"+a+"` date data."}var g={xcalendar:b(f("x"))},a=e.extendFlat({},g,{ycalendar:b(f("y"))}),h=e.extendFlat({},a,{zcalendar:b(f("z"))}),c=b("Sets the calendar system to use for `range` and `tick0` if this is a date axis. This does not set the calendar for interpreting data on this axis, that's specified in the trace or via the global `layout.calendar`");j.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:a,bar:a,box:a,heatmap:a,contour:a,histogram:a,histogram2d:a,histogram2dcontour:a,scatter3d:h,surface:h,mesh3d:h,scattergl:a,ohlc:g,candlestick:g},layout:{calendar:b("Sets the default calendar system to use for interpreting and displaying dates throughout the plot.")},subplots:{xaxis:{calendar:c},yaxis:{calendar:c},scene:{xaxis:{calendar:c},yaxis:{calendar:c},zaxis:{calendar:c}},polar:{radialaxis:{calendar:c}}},transforms:{filter:{valuecalendar:b("WARNING: All transforms are deprecated and may be removed from the API in next major version. Sets the calendar system to use for `value`, if it is a date."),targetcalendar:b("WARNING: All transforms are deprecated and may be removed from the API in next major version. Sets the calendar system to use for `target`, if it is an array of dates. If `target` is a string (eg *x*) we use the corresponding trace attribute (eg `xcalendar`) if it exists, even if `targetcalendar` is provided.")}}},layoutAttributes:l,handleDefaults:m,handleTraceDefaults:function(c,d,b,e){for(var a=0;a<b.length;a++)m(c,d,b[a]+"calendar",e.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:n,worldCalFmt:function(c,h,i){for(var a,e,d,f,g,j=n(i).fromJD(Math.floor((h+.05)/q)+p),b=0;-1!==(b=c.indexOf("%",b));)"0"===(a=c.charAt(b+1))||"-"===a||"_"===a?(d=3,e=c.charAt(b+2),"_"===a&&(a="-")):(e=a,a="0",d=2),(f=r[e])?(g="##"===f?"##":j.formatDate(f[a]),c=c.substr(0,b)+g+c.substr(b+d),b+=g.length):b+=d;return c}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(b,c,a){"use strict";a.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a.defaultLine="#444",a.lightLine="#eee",a.background="#fff",a.borderLine="#BEC8D9",a.lightFraction=90.9090909090909},{}],367:[function(b,d,e){"use strict";var f=b("tinycolor2"),g=b("fast-isnumeric"),h=b("../../lib/array").isTypedArray,a=d.exports={},c=b("./attributes");a.defaults=c.defaults;var i=a.defaultLine=c.defaultLine;a.lightLine=c.lightLine;var j=a.background=c.background;function k(b){if(g(b)||"string"!=typeof b)return b;var d=b.trim();if("rgb"!==d.substr(0,3))return b;var e=d.match(/^rgba?\s*\(([^()]*)\)$/);if(!e)return b;var a=e[1].trim().split(/\s*[\s,]\s*/),f="a"===d.charAt(3)&&4===a.length;if(!f&&3!==a.length)return b;for(var c=0;c<a.length;c++){if(!a[c].length)return b;if(a[c]=Number(a[c]),!(a[c]>=0))return b;if(3===c)a[c]>1&&(a[c]=1);else if(a[c]>=1)return b}var h=Math.round(255*a[0])+", "+Math.round(255*a[1])+", "+Math.round(255*a[2]);return f?"rgba("+h+", "+a[3]+")":"rgb("+h+")"}a.tinyRGB=function(b){var a=b.toRgb();return"rgb("+Math.round(a.r)+", "+Math.round(a.g)+", "+Math.round(a.b)+")"},a.rgb=function(b){return a.tinyRGB(f(b))},a.opacity=function(a){return a?f(a).getAlpha():0},a.addOpacity=function(b,c){var a=f(b).toRgb();return"rgba("+Math.round(a.r)+", "+Math.round(a.g)+", "+Math.round(a.b)+", "+c+")"},a.combine=function(d,e){var b=f(d).toRgb();if(1===b.a)return f(d).toRgbString();var a=f(e||j).toRgb(),c=1===a.a?a:{r:255*(1-a.a)+a.r*a.a,g:255*(1-a.a)+a.g*a.a,b:255*(1-a.a)+a.b*a.a};return f({r:c.r*(1-b.a)+b.r*b.a,g:c.g*(1-b.a)+b.g*b.a,b:c.b*(1-b.a)+b.b*b.a}).toRgbString()},a.contrast=function(c,d,e){var b=f(c);return 1!==b.getAlpha()&&(b=f(a.combine(c,j))),(b.isDark()?d?b.lighten(d):j:e?b.darken(e):i).toString()},a.stroke=function(c,d){var b=f(d);c.style({stroke:a.tinyRGB(b),"stroke-opacity":b.getAlpha()})},a.fill=function(c,d){var b=f(d);c.style({fill:a.tinyRGB(b),"fill-opacity":b.getAlpha()})},a.clean=function(e){if(e&&"object"==typeof e){var f,c,d,b,i=Object.keys(e);for(f=0;f<i.length;f++)if(b=e[d=i[f]],"color"===d.substr(d.length-5))if(Array.isArray(b))for(c=0;c<b.length;c++)b[c]=k(b[c]);else e[d]=k(b);else if("colorscale"===d.substr(d.length-10)&&Array.isArray(b))for(c=0;c<b.length;c++)Array.isArray(b[c])&&(b[c][1]=k(b[c][1]));else if(Array.isArray(b)){var g=b[0];if(!Array.isArray(g)&&g&&"object"==typeof g)for(c=0;c<b.length;c++)a.clean(b[c])}else b&&"object"==typeof b&&!h(b)&&a.clean(b)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(b,e,g){"use strict";var a=b("../../plots/cartesian/layout_attributes"),c=b("../../plots/font_attributes"),d=b("../../lib/extend").extendFlat,f=b("../../plot_api/edit_types").overrideAll;e.exports=f({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:a.linecolor,outlinewidth:a.linewidth,bordercolor:a.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:d({},a.ticks,{dflt:""}),ticklabeloverflow:d({},a.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,ticklabelstep:a.ticklabelstep,showticklabels:a.showticklabels,tickfont:c({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,minexponent:a.minexponent,showexponent:a.showexponent,title:{text:{valType:"string"},font:c({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:c({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(b,a,c){"use strict";a.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/plot_template"),f=a("../../plots/cartesian/tick_value_defaults"),g=a("../../plots/cartesian/tick_mark_defaults"),h=a("../../plots/cartesian/tick_label_defaults"),i=a("../../plots/cartesian/prefix_suffix_defaults"),j=a("./attributes");b.exports=function(t,u,l){var c=e.newContainer(u,"colorbar"),k=t.colorbar||{};function a(a,b){return d.coerce(k,c,j,a,b)}var m=l.margin||{t:0,b:0,l:0,r:0},o=l.width-m.l-m.r,p=l.height-m.t-m.b,b="v"===a("orientation"),v=a("thicknessmode");a("thickness","fraction"===v?30/(b?o:p):30);var w=a("lenmode");a("len","fraction"===w?1:b?p:o),a("x",b?1.02:.5),a("xanchor",b?"left":"center"),a("xpad"),a("y",b?.5:1.02),a("yanchor",b?"middle":"bottom"),a("ypad"),d.noneOrAll(k,c,["x","y"]),a("outlinecolor"),a("outlinewidth"),a("bordercolor"),a("borderwidth"),a("bgcolor");var q=d.coerce(k,c,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:b?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");a("ticklabeloverflow",-1!==q.indexOf("inside")?"hide past domain":"hide past div"),f(k,c,a,"linear");var r=l.font,n={outerTicks:!1,font:r};-1!==q.indexOf("inside")&&(n.bgColor="black"),i(k,c,a,"linear",n),h(k,c,a,"linear",n),g(k,c,a,"linear",n),a("title.text",l._dfltTitle.colorbar);var s=c.tickfont,x=d.extendFlat({},s,{color:r.color,size:d.bigFont(s.size)});d.coerceFont(a,"title.font",x),a("title.side",b?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(a,c,e){"use strict";var f=a("@plotly/d3"),g=a("tinycolor2"),h=a("../../plots/plots"),i=a("../../registry"),j=a("../../plots/cartesian/axes"),k=a("../dragelement"),d=a("../../lib"),l=d.strTranslate,m=a("../../lib/extend").extendFlat,n=a("../../lib/setcursor"),o=a("../drawing"),p=a("../color"),q=a("../titles"),r=a("../../lib/svg_text_utils"),s=a("../colorscale/helpers").flipScale,t=a("../../plots/cartesian/axis_defaults"),u=a("../../plots/cartesian/position_defaults"),v=a("../../plots/cartesian/layout_attributes"),b=a("../../constants/alignment"),w=b.LINE_SPACING,x=b.FROM_TL,y=b.FROM_BR,z=a("./constants").cn;c.exports={draw:function(b){var a=b._fullLayout._infolayer.selectAll("g."+z.colorbar).data(function(l){var a,d,b,h,e=l._fullLayout,n=l.calcdata,i=[];function o(a){return m(a,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function p(){"function"==typeof h.calc?h.calc(l,b,a):(a._fillgradient=d.reversescale?s(d.colorscale):d.colorscale,a._zrange=[d[h.min],d[h.max]])}for(var j=0;j<n.length;j++){var f=(b=n[j][0].trace)._module.colorbar;if(!0===b.visible&&f)for(var q=Array.isArray(f),r=q?f:[f],k=0;k<r.length;k++){var c=(h=r[k]).container;(d=c?b[c]:b)&&d.showscale&&((a=o(d.colorbar))._id="cb"+b.uid+(q&&c?"-"+c:""),a._traceIndex=b.index,a._propPrefix=(c?c+".":"")+"colorbar.",a._meta=b._meta,p(),i.push(a))}}for(var g in e._colorAxes)if((d=e[g]).showscale){var t=e._colorAxes[g];(a=o(d.colorbar))._id="cb"+g,a._propPrefix=g+".colorbar.",a._meta=e._meta,h={min:"cmin",max:"cmax"},"heatmap"!==t[0]&&(b=t[1],h.calc=b._module.colorbar.calc),p(),i.push(a)}return i}(b),function(a){return a._id});a.enter().append("g").attr("class",function(a){return a._id}).classed(z.colorbar,!0),a.each(function(s){var a=f.select(this);d.ensureSingle(a,"rect",z.cbbg),d.ensureSingle(a,"g",z.cbfills),d.ensureSingle(a,"g",z.cblines),d.ensureSingle(a,"g",z.cbaxis,function(a){a.classed(z.crisp,!0)}),d.ensureSingle(a,"g",z.cbtitleunshift,function(a){a.append("g").classed(z.cbtitle,!0)}),d.ensureSingle(a,"rect",z.cboutline);var A,B,c,E,F,G,C,D,e=function(I,a,C){var aa,e="v"===a.orientation,T=a.len,U=a.lenmode,V=a.thickness,W=a.thicknessmode,ab=a.outlinewidth,ac=a.borderwidth,ad=a.bgcolor,X=a.xanchor,Y=a.yanchor,n=a.xpad,k=a.ypad,A=a.x,B=e?a.y:1-a.y,Z=C._fullLayout,b=Z._size,D=a._fillcolor,E=a._line,M=a.title,J=M.side,F=a._zrange||f.extent(("function"==typeof D?D:E.color).domain()),ae="function"==typeof E.color?E.color:function(){return E.color},af="function"==typeof D?D:function(){return D},G=a._levels,N=function(m,d,e){var a,b,f=d._levels,j=[],c=[],g=f.end+f.size/100,h=f.size,k=1.001*e[0]-.001*e[1],l=1.001*e[1]-.001*e[0];for(b=0;b<1e5&&(a=f.start+b*h,h>0?!(a>=g):!(a<=g));b++)a>k&&a<l&&j.push(a);if(d._fillgradient)c=[0];else if("function"==typeof d._fillcolor){var i=d._filllevels;if(i)for(b=0,g=i.end+i.size/100,h=i.size;b<1e5&&(a=i.start+b*h,h>0?!(a>=g):!(a<=g));b++)a>e[0]&&a<e[1]&&c.push(a);else(c=j.map(function(a){return a-f.size/2})).push(c[c.length-1]+f.size)}else d._fillcolor&&"string"==typeof d._fillcolor&&(c=[0]);return f.size<0&&(j.reverse(),c.reverse()),{line:j,fill:c}}(C,a,F),ag=N.fill,ah=N.line,$=Math.round(V*("fraction"===W?e?b.w:b.h:1)),H=$/(e?b.w:b.h),O=Math.round(T*("fraction"===U?e?b.h:b.w:1)),s=O/(e?b.h:b.w),ai=Math.round(e?A*b.w+n:B*b.h+k),P={center:.5,right:1}[X]||0,Q={top:1,middle:.5}[Y]||0,i=e?B-Q*s:A-P*s,aj=Math.round(e?b.h*(1-i):b.w*i);a._lenFrac=s,a._thickFrac=H,a._uFrac=e?A-P*H:B-Q*H,a._vFrac=i;var c=a._axis=function(j,a,k){var b=j._fullLayout,e="v"===a.orientation,f={type:"linear",range:k,tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,ticklabelposition:a.ticklabelposition,ticklabeloverflow:a.ticklabeloverflow,ticklabelstep:a.ticklabelstep,tickfont:a.tickfont,tickangle:a.tickangle,tickformat:a.tickformat,exponentformat:a.exponentformat,minexponent:a.minexponent,separatethousands:a.separatethousands,showexponent:a.showexponent,showtickprefix:a.showtickprefix,tickprefix:a.tickprefix,showticksuffix:a.showticksuffix,ticksuffix:a.ticksuffix,title:a.title,showline:!0,anchor:"free",side:e?"right":"bottom",position:1},g=e?"y":"x",c={type:"linear",_id:g+a._id},h={letter:g,font:b.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:b.calendar};function i(a,b){return d.coerce(f,c,v,a,b)}return t(f,c,i,h,b),u(f,c,i,h),c}(C,a,F);c.position=H+(e?A+n/b.w:B+k/b.h);var R=-1!==["top","bottom"].indexOf(J);if(e&&R&&(c.title.side=J,c.titlex=A+n/b.w,c.titley=i+("top"===M.side?s-k/b.h:k/b.h)),e||R||(c.title.side=J,c.titley=B+k/b.h,c.titlex=i+n/b.w),E.color&&"auto"===a.tickmode){c.tickmode="linear",c.tick0=G.start;var K=G.size,_=d.constrain(O/50,4,15)+1,L=(F[1]-F[0])/((a.nticks||_)*K);if(L>1){var S=Math.pow(10,Math.floor(Math.log(L)/Math.LN10));K*=S*d.roundUp(L/S,[2,5,10]),(Math.abs(G.start)/G.size+1e-6)%1<2e-6&&(c.tick0=0)}c.dtick=K}c.domain=e?[i+k/b.h,i+s-k/b.h]:[i+n/b.w,i+s-n/b.w],c.setScale(),I.attr("transform",l(Math.round(b.l),Math.round(b.t)));var ak=I.select("."+z.cbtitleunshift).attr("transform",l(-Math.round(b.l),-Math.round(b.t))),al=c.ticklabelposition,am=c.title.font.size,an=I.select("."+z.cbaxis),ao=0,ap=0;function aq(b,e){var f={propContainer:c,propName:a._propPrefix+"title",traceIndex:a._traceIndex,_meta:a._meta,placeholder:Z._dfltTitle.colorbar,containerGroup:I.select("."+z.cbtitle)},d="h"===b.charAt(0)?b.substr(1):"h"+b;I.selectAll("."+d+",."+d+"-math-group").remove(),q.draw(C,b,m(f,e||{}))}return d.syncOrAsync([h.previousPromises,function(){if(e&&R|| !e&&!R){var a,d;"top"===J&&(a=n+b.l+b.w*A,d=k+b.t+b.h*(1-i-s)+3+.75*am),"bottom"===J&&(a=n+b.l+b.w*A,d=k+b.t+b.h*(1-i)-3-.25*am),"right"===J&&(d=k+b.t+b.h*B+3+.75*am,a=n+b.l+b.w*i),aq(c._id+"title",{attributes:{x:a,y:d,"text-anchor":e?"start":"middle"}})}},function(){if(!e&&!R||e&&R){var k,m=I.select("."+z.cbtitle),i=m.select("text"),h=[-ab/2,ab/2],t=m.select(".h"+c._id+"title-math-group").node(),n=15.6;if(i.node()&&(n=parseInt(i.node().style.fontSize,10)*w),t?(ap=(k=o.bBox(t)).width,ao=k.height,ao>n&&(h[1]-=(ao-n)/2)):i.node()&&!i.classed(z.jsPlaceholder)&&(ap=(k=o.bBox(i.node())).width,ao=k.height),e){if(ao){if(ao+=5,"top"===J)c.domain[1]-=ao/b.h,h[1]*=-1;else{c.domain[0]+=ao/b.h;var v=r.lineCount(i);h[1]+=(1-v)*n}m.attr("transform",l(h[0],h[1])),c.setScale()}}else ap&&("right"===J&&(c.domain[0]+=(ap+am/2)/b.w),m.attr("transform",l(h[0],h[1])),c.setScale())}I.selectAll("."+z.cbfills+",."+z.cblines).attr("transform",e?l(0,Math.round(b.h*(1-c.domain[1]))):l(Math.round(b.w*c.domain[0]),0)),an.attr("transform",e?l(0,Math.round(-b.t)):l(Math.round(-b.l),0));var p=I.select("."+z.cbfills).selectAll("rect."+z.cbfill).attr("style","").data(ag);p.enter().append("rect").classed(z.cbfill,!0).style("stroke","none"),p.exit().remove();var y=F.map(c.c2p).map(Math.round).sort(function(a,b){return a-b});p.each(function(j,h){var b=[0===h?F[0]:(ag[h]+ag[h-1])/2,h===ag.length-1?F[1]:(ag[h]+ag[h+1])/2].map(c.c2p).map(Math.round);e&&(b[1]=d.constrain(b[1]+(b[1]>b[0])?1:-1,y[0],y[1]));var i=f.select(this).attr(e?"x":"y",ai).attr(e?"y":"x",f.min(b)).attr(e?"width":"height",Math.max($,2)).attr(e?"height":"width",Math.max(f.max(b)-f.min(b),2));if(a._fillgradient)o.gradient(i,C,a._id,e?"vertical":"horizontalreversed",a._fillgradient,"fill");else{var k=af(j).replace("e-","");i.attr("fill",g(k).toHexString())}});var q=I.select("."+z.cblines).selectAll("path."+z.cbline).data(E.color&&E.width?ah:[]);q.enter().append("path").classed(z.cbline,!0),q.exit().remove(),q.each(function(a){var b=ai,d=Math.round(c.c2p(a))+E.width/2%1;f.select(this).attr("d","M"+(e?b+","+d:d+","+b)+(e?"h":"v")+$).call(o.lineGroupStyle,E.width,ae(a),E.dash)}),an.selectAll("g."+c._id+"tick,path").remove();var u=ai+$+(ab||0)/2-("outside"===a.ticks?1:0),s=j.calcTicks(c),x=j.getTickSigns(c)[2];return j.drawTicks(C,c,{vals:"inside"===c.ticks?j.clipEnds(c,s):s,layer:an,path:j.makeTickPath(c,u,x),transFn:j.makeTransTickFn(c)}),j.drawLabels(C,c,{vals:s,layer:an,transFn:j.makeTransTickLabelFn(c),labelFns:j.makeLabelFns(c,u)})},function(){if(e&&!R|| !e&&R){var g,d,h=c.position||0,i=c._offset+c._length/2;if("right"===J)d=i,g=b.l+b.w*h+10+am*(c.showticklabels?1:.5);else if(g=i,"bottom"===J&&(d=b.t+b.h*h+10+(-1===al.indexOf("inside")?c.tickfont.size:0)+("intside"!==c.ticks?a.ticklen||0:0)),"top"===J){var j=M.text.split("<br>").length;d=b.t+b.h*h+10-$-w*am*j}aq((e?"h":"v")+c._id+"title",{avoid:{selection:f.select(C).selectAll("g."+c._id+"tick"),side:J,offsetTop:e?0:b.t,offsetLeft:e?b.l:0,maxShift:e?Z.width:Z.height},attributes:{x:g,y:d,"text-anchor":"middle"},transform:{rotate:e?-90:0,offset:0}})}},h.previousPromises,function(){var m=$+ab/2;-1===al.indexOf("inside")&&(j=o.bBox(an.node()),m+=e?j.width:j.height);var i=0,E=!e&&"right"===J,q=0;if((aa=ak.select("text")).node()&&!aa.classed(z.jsPlaceholder)){var j,D,F=ak.select(".h"+c._id+"title-math-group").node();F&&(e&&R|| !e&&!R)?(i=(j=o.bBox(F)).width,D=j.height):(i=(j=o.bBox(ak.node())).right-b.l-(e?ai:aj),D=j.bottom-b.t-(e?aj:ai),e||"top"!==J||(m+=j.height,q=j.height)),E&&(aa.attr("transform",l(i/2+am/2,0)),i*=2),m=Math.max(m,e?i:D)}var f=(e?n:k)*2+m+ac+ab/2,r=0;!e&&M.text&&"bottom"===Y&&B<=0&&(f+=r=f/2,q+=r),Z._hColorbarMoveTitle=r,Z._hColorbarMoveCBTitle=q;var G=ac+ab;I.select("."+z.cbbg).attr("x",(e?ai:aj)-G/2-(e?n:0)).attr("y",(e?aj:ai)-(e?O:k+q-r)).attr(e?"width":"height",Math.max(f-r,2)).attr(e?"height":"width",Math.max(O+G,2)).call(p.fill,ad).call(p.stroke,a.bordercolor).style("stroke-width",ac);var H=E?Math.max(i-10,0):0;if(I.selectAll("."+z.cboutline).attr("x",(e?ai:aj+n)+H).attr("y",(e?aj+k-O:ai)+(e&&"top"===J?ao:0)).attr(e?"width":"height",Math.max($,2)).attr(e?"height":"width",Math.max(O-(e?2*k+ao:2*n+H),2)).call(p.stroke,a.outlinecolor).style({fill:"none","stroke-width":ab}),I.attr("transform",l(b.l-(e?P*f:0),b.t-(e?0:(1-Q)*f-q))),!e&&(ac||g(ad).getAlpha()&&!g.equals(Z.paper_bgcolor,ad))){var K=an.selectAll("text"),N=K[0].length,L=I.select("."+z.cbbg).node(),S=o.bBox(L),_=o.getTranslate(I),ae=2;K.each(function(i,b){var c=0,d=N-1;if(b===c||b===d){var a,e=o.bBox(this),f=o.getTranslate(this);if(b===d){var g=e.right+f.x;(a=S.right+_.x+aj-ac-ae+A-g)>0&&(a=0)}else if(b===c){var h=e.left+f.x;(a=S.left+_.x+aj+ac+ae-h)<0&&(a=0)}a&&(N<3?this.setAttribute("transform","translate("+a+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var d={},s=x[X],t=y[X],u=x[Y],v=y[Y],w=f-$;e?("pixels"===U?(d.y=B,d.t=O*u,d.b=O*v):(d.t=d.b=0,d.yt=B+T*u,d.yb=B-T*v),"pixels"===W?(d.x=A,d.l=f*s,d.r=f*t):(d.l=w*s,d.r=w*t,d.xl=A-V*s,d.xr=A+V*t)):("pixels"===U?(d.x=A,d.l=O*s,d.r=O*t):(d.l=d.r=0,d.xl=A+T*s,d.xr=A-T*t),"pixels"===W?(d.y=1-B,d.t=f*u,d.b=f*v):(d.t=w*u,d.b=w*v,d.yt=B-V*u,d.yb=B+V*v)),h.autoMargin(C,a._id,d)}],C)}(a,s,b);e&&e.then&&(b._promises||[]).push(e),b._context.edits.colorbarPosition&&(A=a,B=s,c=b,C="v"===B.orientation,D=c._fullLayout._size,k.init({element:A.node(),gd:c,prepFn:function(){E=A.attr("transform"),n(A)},moveFn:function(a,b){A.attr("transform",E+l(a,b)),F=k.align((C?B._uFrac:B._vFrac)+a/D.w,C?B._thickFrac:B._lenFrac,0,1,B.xanchor),G=k.align((C?B._vFrac:1-B._uFrac)-b/D.h,C?B._lenFrac:B._thickFrac,0,1,B.yanchor);var c=k.getCursor(F,G,B.xanchor,B.yanchor);n(A,c)},doneFn:function(){if(n(A),void 0!==F&& void 0!==G){var a={};a[B._propPrefix+"x"]=F,a[B._propPrefix+"y"]=G,void 0!==B._traceIndex?i.call("_guiRestyle",c,a,B._traceIndex):i.call("_guiRelayout",c,a)}}}))}),a.exit().each(function(a){h.autoMargin(b,a._id)}).remove(),a.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a){return d.isPlainObject(a.colorbar)}},{"../../lib":515}],373:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"colorbar",attributes:a("./attributes"),supplyDefaults:a("./defaults"),draw:a("./draw").draw,hasColorbar:a("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(a,b,e){"use strict";var f=a("../colorbar/attributes"),g=a("../../lib/regex").counter,c=a("../../lib/sort_object_keys"),d=a("./scales.js").scales;function h(a){return"`"+a+"`"}c(d),b.exports=function(c,a){c=c||"";var k,e=(a=a||{}).cLetter||"c",q=("onlyIfNumerical"in a?a.onlyIfNumerical:Boolean(c),"noScale"in a?a.noScale:"marker.line"===c),r="showScaleDflt"in a?a.showScaleDflt:"z"===e,s="string"==typeof a.colorscaleDflt?d[a.colorscaleDflt]:null,l=a.editTypeOverride||"",i=c?c+".":"";"colorAttr"in a?(k=a.colorAttr,a.colorAttr):"in "+h(i+(k=({z:"z",c:"color"})[e]));var m=e+"auto",n=e+"min",o=e+"max",t=e+"mid";h(i+m),h(i+n),h(i+o);var j={};j[n]=j[o]=void 0;var p={};p[m]=!1;var b={};return"color"===k&&(b.color={valType:"color",arrayOk:!0,editType:l||"style"},a.anim&&(b.color.anim=!0)),b[m]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:j},b[n]={valType:"number",dflt:null,editType:l||"plot",impliedEdits:p},b[o]={valType:"number",dflt:null,editType:l||"plot",impliedEdits:p},b[t]={valType:"number",dflt:null,editType:"calc",impliedEdits:j},b.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},b.autocolorscale={valType:"boolean",dflt:!1!==a.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},b.reversescale={valType:"boolean",dflt:!1,editType:"plot"},q||(b.showscale={valType:"boolean",dflt:r,editType:"calc"},b.colorbar=f),a.noColorAxis||(b.coloraxis={valType:"subplotid",regex:g("coloraxis"),dflt:null,editType:"calc"}),b}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("./helpers").extractOpts;b.exports=function(q,m,n){var o,h=q._fullLayout,r=n.vals,p=n.containerStr,i=p?e.nestedProperty(m,p).get():m,g=f(i),j=!1!==g.auto,a=g.min,b=g.max,c=g.mid,k=function(){return e.aggNums(Math.min,null,r)},l=function(){return e.aggNums(Math.max,null,r)};void 0===a?a=k():j&&(a=i._colorAx&&d(a)?Math.min(a,k()):k()),void 0===b?b=l():j&&(b=i._colorAx&&d(b)?Math.max(b,l()):l()),j&& void 0!==c&&(b-c>c-a?a=c-(b-c):b-c<c-a&&(b=c+(c-a))),a===b&&(a-=.5,b+=.5),g._sync("min",a),g._sync("max",b),g.autocolorscale&&(o=a*b<0?h.colorscale.diverging:a>=0?h.colorscale.sequential:h.colorscale.sequentialminus,g._sync("colorscale",o))}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./helpers").hasColorscale,f=a("./helpers").extractOpts;b.exports=function(i,j){function l(a,b){var c=a["_"+b];void 0!==c&&(a[b]=c)}function c(e,b){var a=b.container?d.nestedProperty(e,b.container).get():e;if(a)if(a.coloraxis)a._colorAx=j[a.coloraxis];else{var c=f(a),g=c.auto;(g|| void 0===c.min)&&l(a,b.min),(g|| void 0===c.max)&&l(a,b.max),c.autocolorscale&&l(a,"colorscale")}}for(var g=0;g<i.length;g++){var a=i[g],b=a._module.colorbar;if(b)if(Array.isArray(b))for(var h=0;h<b.length;h++)c(a,b[h]);else c(a,b);e(a,"marker.line")&&c(a,{container:"marker.line",min:"cmin",max:"cmax"})}for(var k in j._colorAxes)c(j[k],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../colorbar/has_colorbar"),g=a("../colorbar/defaults"),h=a("./scales").isValid,i=a("../../registry").traceIs;function j(b,a){var c=a.slice(0,a.length-1);return a?e.nestedProperty(b,c).get()||{}:b}b.exports=function D(C,c,q,b,r){var o,s,a=r.prefix,k=r.cLetter,t="_module"in c,l=j(C,a),u=j(c,a),p=j(c._template||{},a)||{},v=function(){return delete C.coloraxis,delete c.coloraxis,D(C,c,q,b,r)};if(t){var w=q._colorAxes||{},m=b(a+"coloraxis");if(m){var x=i(c,"contour")&&e.nestedProperty(c,"contours.coloring").get()||"heatmap",n=w[m];n?(n[2].push(v),n[0]!==x&&(n[0]=!1,e.warn(["Ignoring coloraxis:",m,"setting","as it is linked to incompatible colorscales."].join(" ")))):w[m]=[x,c,[v]];return}}var y=l[k+"min"],z=l[k+"max"];b(a+k+"auto",!(d(y)&&d(z)&&y<z))?b(a+k+"mid"):(b(a+k+"min"),b(a+k+"max"));var A=l.colorscale,B=p.colorscale;void 0!==A&&(o=!h(A)),void 0!==B&&(o=!h(B)),b(a+"autocolorscale",o),b(a+"colorscale"),b(a+"reversescale"),"marker.line."!==a&&(a&&t&&(s=f(l)),b(a+"showscale",s)&&(a&&p&&(u._template=p),g(l,u,q)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(a,b,g){"use strict";var h=a("@plotly/d3"),i=a("tinycolor2"),j=a("fast-isnumeric"),k=a("../../lib"),l=a("../color"),m=a("./scales").isValid,n=["showscale","autocolorscale","colorscale","reversescale","colorbar"],o=["min","max","mid","auto"];function c(f){var g,a,b,e,h=f._colorAx,c=h||f,d={};for(a=0;a<n.length;a++)d[b=n[a]]=c[b];if(h)for(a=0,g="c";a<o.length;a++)d[b=o[a]]=c["c"+b];else{for(a=0;a<o.length;a++){if((e="c"+(b=o[a]))in c){d[b]=c[e];continue}(e="z"+b)in c&&(d[b]=c[e])}g=e.charAt(0)}return d._sync=function(a,d){var b=-1!==o.indexOf(a)?g+a:a;c[b]=c["_"+b]=d},d}function d(k){for(var a=c(k),f=a.min,l=a.max,g=a.reversescale?e(a.colorscale):a.colorscale,d=g.length,h=new Array(d),i=new Array(d),b=0;b<d;b++){var j=g[b];h[b]=f+j[0]*(l-f),i[b]=j[1]}return{domain:h,range:i}}function e(b){for(var c=b.length,d=new Array(c),a=c-1,e=0;a>=0;a--,e++){var f=b[a];d[e]=[1-f[0],f[1]]}return d}function f(e,a){a=a||{};for(var d,q=e.domain,f=e.range,g=f.length,k=new Array(g),b=0;b<g;b++){var c=i(f[b]).toRgb();k[b]=[c.r,c.g,c.b,c.a]}var m=h.scale.linear().domain(q).range(k).clamp(!0),n=a.noNumericCheck,o=a.returnArray;return(d=n&&o?m:n?function(a){return p(m(a))}:o?function(a){return j(a)?m(a):i(a).isValid()?a:l.defaultLine}:function(a){return j(a)?p(m(a)):i(a).isValid()?a:l.defaultLine}).domain=m.domain,d.range=function(){return f},d}function p(a){return i({r:a[0],g:a[1],b:a[2],a:a[3]}).toRgbString()}b.exports={hasColorscale:function(d,e,g){var a=e?k.nestedProperty(d,e).get()||{}:d,b=a[g||"color"],f=!1;if(k.isArrayOrTypedArray(b)){for(var c=0;c<b.length;c++)if(j(b[c])){f=!0;break}}return k.isPlainObject(a)&&(f|| !0===a.showscale||j(a.cmin)&&j(a.cmax)||m(a.colorscale)||k.isPlainObject(a.colorbar))},extractOpts:c,extractScale:d,flipScale:e,makeColorScaleFunc:f,makeColorScaleFuncFromTrace:function(a,b){return f(d(a),b)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(a,d,e){"use strict";var c=a("./scales"),b=a("./helpers");d.exports={moduleType:"component",name:"colorscale",attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),handleDefaults:a("./defaults"),crossTraceDefaults:a("./cross_trace_defaults"),calc:a("./calc"),scales:c.scales,defaultScale:c.defaultScale,getScale:c.get,isValidScale:c.isValid,hasColorscale:b.hasColorscale,extractOpts:b.extractOpts,extractScale:b.extractScale,flipScale:b.flipScale,makeColorScaleFunc:b.makeColorScaleFunc,makeColorScaleFuncFromTrace:b.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(a,c,f){"use strict";var d=a("../../lib/extend").extendFlat,e=a("./attributes"),b=a("./scales").scales;c.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:b.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:b.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:b.RdBu,editType:"calc"}},coloraxis:d({_isSubplotObj:!0,editType:"calc"},e("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/plot_template"),f=a("./layout_attributes"),g=a("./defaults");b.exports=function(m,b){function c(a,c){return d.coerce(m,b,f,a,c)}c("colorscale.sequential"),c("colorscale.sequentialminus"),c("colorscale.diverging");var j,k,l=b._colorAxes;function n(a,b){return d.coerce(j,k,f.coloraxis,a,b)}for(var a in l){var h=l[a];if(h[0])j=m[a]||{},(k=e.newContainer(b,a,"coloraxis"))._name=a,g(j,k,b,n,{prefix:"",cLetter:"c"});else{for(var i=0;i<h[2].length;i++)h[2][i]();delete b._colorAxes[a]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(b,c,e){"use strict";var f=b("tinycolor2"),a={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},d=a.RdBu;function g(a){var d=0;if(!Array.isArray(a)||a.length<2)return!1;if(!a[0]||!a[a.length-1])return!1;if(0!= +a[0][0]||1!= +a[a.length-1][0])return!1;for(var c=0;c<a.length;c++){var b=a[c];if(2!==b.length|| +b[0]<d||!f(b[1]).isValid())return!1;d=+b[0]}return!0}c.exports={scales:a,defaultScale:d,get:function(b,c){if(c||(c=d),!b)return c;function e(){try{b=a[b]||JSON.parse(b)}catch(d){b=c}}return("string"==typeof b&&(e(),"string"==typeof b&&e()),g(b))?b:c},isValid:function(b){return void 0!==a[b]||g(b)}}},{tinycolor2:313}],383:[function(b,a,c){"use strict";a.exports=function(g,h,e,f,a){var b=(g-e)/(f-e),c=b+h/(f-e),d=(b+c)/2;return"left"===a||"bottom"===a?b:"center"===a||"middle"===a?d:"right"===a||"top"===a?c:b<2/3-d?b:c>4/3-d?c:d}},{}],384:[function(a,b,c){"use strict";var d=a("../../lib"),e=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];b.exports=function(a,f,b,c){return a="left"===b?0:"center"===b?1:"right"===b?2:d.constrain(Math.floor(3*a),0,2),e[f="bottom"===c?0:"middle"===c?1:"top"===c?2:d.constrain(Math.floor(3*f),0,2)][a]}},{"../../lib":515}],385:[function(b,c,a){"use strict";a.selectMode=function(a){return"lasso"===a||"select"===a},a.drawMode=function(a){return"drawclosedpath"===a||"drawopenpath"===a||"drawline"===a||"drawrect"===a||"drawcircle"===a},a.openMode=function(a){return"drawline"===a||"drawopenpath"===a},a.rectMode=function(a){return"select"===a||"drawline"===a||"drawrect"===a||"drawcircle"===a},a.freeMode=function(a){return"lasso"===a||"drawclosedpath"===a||"drawopenpath"===a},a.selectingOrDrawing=function(b){return a.freeMode(b)||a.rectMode(b)}},{}],386:[function(a,d,f){"use strict";var g=a("mouse-event-offset"),h=a("has-hover"),i=a("has-passive-events"),j=a("../../lib").removeElement,k=a("../../plots/cartesian/constants"),b=d.exports={};b.align=a("./align"),b.getCursor=a("./cursor");var c=a("./unhover");function e(){var b=document.createElement("div");b.className="dragcover";var a=b.style;return a.position="fixed",a.left=0,a.right=0,a.top=0,a.bottom=0,a.zIndex=999999999,a.background="none",document.body.appendChild(b),b}function l(a){return g(a.changedTouches?a.changedTouches[0]:a,document.body)}b.unhover=c.wrapped,b.unhoverRaw=c.raw,b.init=function(c){var f,g,m,n,o,p,q,r,d=c.gd,s=1,t=d._context.doubleClickDelay,a=c.element;d._mouseDownTime||(d._mouseDownTime=0),a.style.pointerEvents="all",a.onmousedown=v,i?(a._ontouchstart&&a.removeEventListener("touchstart",a._ontouchstart),a._ontouchstart=v,a.addEventListener("touchstart",v,{passive:!1})):a.ontouchstart=v;var u=c.clampFn||function(a,b,c){return Math.abs(a)<c&&(a=0),Math.abs(b)<c&&(b=0),[a,b]};function v(b){d._dragged=!1,d._dragging=!0;var i=l(b);f=i[0],g=i[1],q=b.target,p=b,r=2===b.buttons||b.ctrlKey,void 0===b.clientX&& void 0===b.clientY&&(b.clientX=f,b.clientY=g),m=new Date().getTime(),m-d._mouseDownTime<t?s+=1:(s=1,d._mouseDownTime=m),c.prepFn&&c.prepFn(b,f,g),h&&!r?(o=e()).style.cursor=window.getComputedStyle(a).cursor:h||(o=document,n=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(a).cursor),document.addEventListener("mouseup",x),document.addEventListener("touchend",x),!1!==c.dragmode&&(b.preventDefault(),document.addEventListener("mousemove",w),document.addEventListener("touchmove",w,{passive:!1}))}function w(e){e.preventDefault();var j=l(e),n=c.minDrag||k.MINDRAG,m=u(j[0]-f,j[1]-g,n),h=m[0],i=m[1];(h||i)&&(d._dragged=!0,b.unhover(d,e)),d._dragged&&c.moveFn&&!r&&(d._dragdata={element:a,dx:h,dy:i},c.moveFn(h,i))}function x(a){if(delete d._dragdata,!1!==c.dragmode&&(a.preventDefault(),document.removeEventListener("mousemove",w),document.removeEventListener("touchmove",w)),document.removeEventListener("mouseup",x),document.removeEventListener("touchend",x),h?j(o):n&&(o.documentElement.style.cursor=n,n=null),!d._dragging){d._dragged=!1;return}if(d._dragging=!1,new Date().getTime()-d._mouseDownTime>t&&(s=Math.max(s-1,1)),d._dragged)c.doneFn&&c.doneFn();else if(c.clickFn&&c.clickFn(s,p),!r){var b;try{b=new MouseEvent("click",a)}catch(f){var e=l(a);(b=document.createEvent("MouseEvents")).initMouseEvent("click",a.bubbles,a.cancelable,a.view,a.detail,a.screenX,a.screenY,e[0],e[1],a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget)}q.dispatchEvent(b)}d._dragging=!1,d._dragged=!1}},b.coverSlip=e},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(a,c,d){"use strict";var e=a("../../lib/events"),f=a("../../lib/throttle"),g=a("../../lib/dom").getGraphDiv,h=a("../fx/constants"),b=c.exports={};b.wrapped=function(a,c,d){(a=g(a))._fullLayout&&f.clear(a._fullLayout._uid+h.HOVERID),b.raw(a,c,d)},b.raw=function(a,b){var c=a._fullLayout,d=a._hoverdata;b||(b={}),(!b.target||a._dragged|| !1!==e.triggerHandler(a,"plotly_beforehover",b))&&(c._hoverlayer.selectAll("g").remove(),c._hoverlayer.selectAll("line").remove(),c._hoverlayer.selectAll("circle").remove(),a._hoverdata=void 0,b.target&&d&&a.emit("plotly_unhover",{event:b,points:d}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(b,c,a){"use strict";a.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},a.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(b,f,l){"use strict";var m,n,o,p,q,r,s,t,u=b("@plotly/d3"),c=b("../../lib"),g=c.numberFormat,v=b("fast-isnumeric"),w=b("tinycolor2"),x=b("../../registry"),y=b("../color"),z=b("../colorscale"),A=c.strTranslate,B=b("../../lib/svg_text_utils"),C=b("../../constants/xmlns_namespaces"),D=b("../../constants/alignment").LINE_SPACING,E=b("../../constants/interactions").DESELECTDIM,F=b("../../traces/scatter/subtypes"),G=b("../../traces/scatter/make_bubble_size_func"),H=b("../../components/fx/helpers").appendArrayPointValue,a=f.exports={};function I(d,c,f){var b=c.fillpattern,e=b&&a.getPatternAttr(b.shape,0,"");if(e){var g=a.getPatternAttr(b.bgcolor,0,null),h=a.getPatternAttr(b.fgcolor,0,null),i=b.fgopacity,j=a.getPatternAttr(b.size,0,8),k=a.getPatternAttr(b.solidity,0,.3),l=c.uid;a.pattern(d,"point",f,l,e,j,k,void 0,b.fillmode,g,h,i)}else c.fillcolor&&d.call(y.fill,c.fillcolor)}a.font=function(b,a,d,e){c.isPlainObject(a)&&(e=a.color,d=a.size,a=a.family),a&&b.style("font-family",a),d+1&&b.style("font-size",d+"px"),e&&b.call(y.fill,e)},a.setPosition=function(a,b,c){a.attr("x",b).attr("y",c)},a.setSize=function(a,b,c){a.attr("width",b).attr("height",c)},a.setRect=function(b,c,d,e,f){b.call(a.setPosition,c,d).call(a.setSize,e,f)},a.translatePoint=function(d,a,e,f){var b=e.c2p(d.x),c=f.c2p(d.y);return!!(v(b)&&v(c)&&a.node())&&("text"===a.node().nodeName?a.attr("x",b).attr("y",c):a.attr("transform",A(b,c)),!0)},a.translatePoints=function(b,c,d){b.each(function(b){var e=u.select(this);a.translatePoint(b,e,c,d)})},a.hideOutsideRangePoint=function(a,b,c,d,e,f){b.attr("display",c.isPtWithinRange(a,e)&&d.isPtWithinRange(a,f)?null:"none")},a.hideOutsideRangePoints=function(c,b){if(b._hasClipOnAxisFalse){var d=b.xaxis,e=b.yaxis;c.each(function(f){var b=f[0].trace,h=b.xcalendar,i=b.ycalendar,g=x.traceIs(b,"bar-like")?".bartext":".point,.textpoint";c.selectAll(g).each(function(b){a.hideOutsideRangePoint(b,u.select(this),d,e,h,i)})})}},a.crispRound=function(b,a,c){return a&&v(a)?b._context.staticPlot?a:a<1?1:Math.round(a):c||0},a.singleLineStyle=function(d,b,e,f,g){b.style("fill","none");var c=(((d||[])[0]||{}).trace||{}).line||{},h=e||c.width||0,i=g||c.dash||"";y.stroke(b,f||c.color),a.dashLine(b,i,h)},a.lineGroupStyle=function(b,c,d,e){b.style("fill","none").each(function(f){var b=(((f||[])[0]||{}).trace||{}).line||{},g=c||b.width||0,h=e||b.dash||"";u.select(this).call(y.stroke,d||b.color).call(a.dashLine,h,g)})},a.dashLine=function(d,c,b){b=+b||0,c=a.dashStyle(c,b),d.style({"stroke-dasharray":c,"stroke-width":b+"px"})},a.dashStyle=function(b,c){var a=Math.max(c=+c||1,3);return"solid"===b?b="":"dot"===b?b=a+"px,"+a+"px":"dash"===b?b=3*a+"px,"+3*a+"px":"longdash"===b?b=5*a+"px,"+5*a+"px":"dashdot"===b?b=3*a+"px,"+a+"px,"+a+"px,"+a+"px":"longdashdot"===b&&(b=5*a+"px,"+2*a+"px,"+a+"px,"+2*a+"px"),b},a.singleFillStyle=function(a,b){var c=((u.select(a.node()).data()[0]||[])[0]||{}).trace||{};I(a,c,b)},a.fillGroupStyle=function(a,b){a.style("stroke-width",0).each(function(a){var c=u.select(this);a[0].trace&&I(c,a[0].trace,b)})};var h=b("./symbol_defs");a.symbolNames=[],a.symbolFuncs=[],a.symbolBackOffs=[],a.symbolNeedLines={},a.symbolNoDot={},a.symbolNoFill={},a.symbolList=[],Object.keys(h).forEach(function(c){var d=h[c],b=d.n;a.symbolList.push(b,String(b),c,b+100,String(b+100),c+"-open"),a.symbolNames[b]=c,a.symbolFuncs[b]=d.f,a.symbolBackOffs[b]=d.backoff||0,d.needLine&&(a.symbolNeedLines[b]=!0),d.noDot?a.symbolNoDot[b]=!0:a.symbolList.push(b+200,String(b+200),c+"-dot",b+300,String(b+300),c+"-open-dot"),d.noFill&&(a.symbolNoFill[b]=!0)});var J=a.symbolNames.length;function K(b,c,d,e){return a.symbolFuncs[b%100](c,d,e)+(b>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}a.symbolNumber=function(b){if(v(b))b=+b;else if("string"==typeof b){var c=0;b.indexOf("-open")>0&&(c=100,b=b.replace("-open","")),b.indexOf("-dot")>0&&(c+=200,b=b.replace("-dot","")),(b=a.symbolNames.indexOf(b))>=0&&(b+=c)}return b%100>=J||b>=400?0:Math.floor(Math.max(b,0))};var d={x1:1,x2:0,y1:0,y2:0},e={x1:0,x2:0,y1:1,y2:0},L=g("~f"),M={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:d},horizontalreversed:{node:"linearGradient",attrs:d,reversed:!0},vertical:{node:"linearGradient",attrs:e},verticalreversed:{node:"linearGradient",attrs:e,reversed:!0}};a.gradient=function(f,g,n,h,b,i){for(var d=b.length,j=M[h],e=new Array(d),a=0;a<d;a++)j.reversed?e[d-1-a]=[L((1-b[a][0])*100),b[a][1]]:e[a]=[L(100*b[a][0]),b[a][1]];var k=g._fullLayout,l="g"+k._uid+"-"+n,m=k._defs.select(".gradients").selectAll("#"+l).data([h+e.join(";")],c.identity);m.exit().remove(),m.enter().append(j.node).each(function(){var a=u.select(this);j.attrs&&a.attr(j.attrs),a.attr("id",l);var b=a.selectAll("stop").data(e);b.exit().remove(),b.enter().append("stop"),b.each(function(a){var b=w(a[1]);u.select(this).attr({offset:a[0]+"%","stop-color":y.tinyRGB(b),"stop-opacity":b.getAlpha()})})}),f.style(i,X(l,g)).style(i+"-opacity",null),f.classed("gradient_filled",!0)},a.pattern=function(q,D,r,E,s,d,g,n,F,l,m,G){var t,o,p,v,a,b,e,f,x,h,I="legend"===D;n&&("overlay"===F?(l=n,m=y.contrast(l)):(l=void 0,m=n));var z=r._fullLayout,A="p"+z._uid+"-"+E,i={},B=w(m),j=y.tinyRGB(B),k=G*B.getAlpha();switch(s){case"/":a=d*Math.sqrt(2),b=d*Math.sqrt(2),e="M-"+a/4+","+b/4+"l"+a/2+",-"+b/2+"M0,"+b+"L"+a+",0M"+a/4*3+","+b/4*5+"l"+a/2+",-"+b/2,f=g*d,h="path",i={d:e,opacity:k,stroke:j,"stroke-width":f+"px"};break;case"\\":a=d*Math.sqrt(2),b=d*Math.sqrt(2),e="M"+a/4*3+",-"+b/4+"l"+a/2+","+b/2+"M0,0L"+a+","+b+"M-"+a/4+","+b/4*3+"l"+a/2+","+b/2,f=g*d,h="path",i={d:e,opacity:k,stroke:j,"stroke-width":f+"px"};break;case"x":a=d*Math.sqrt(2),b=d*Math.sqrt(2),e="M-"+a/4+","+b/4+"l"+a/2+",-"+b/2+"M0,"+b+"L"+a+",0M"+a/4*3+","+b/4*5+"l"+a/2+",-"+b/2+"M"+a/4*3+",-"+b/4+"l"+a/2+","+b/2+"M0,0L"+a+","+b+"M-"+a/4+","+b/4*3+"l"+a/2+","+b/2,f=d-d*Math.sqrt(1-g),h="path",i={d:e,opacity:k,stroke:j,"stroke-width":f+"px"};break;case"|":a=d,b=d,h="path",e="M"+a/2+",0L"+a/2+","+b,f=g*d,h="path",i={d:e,opacity:k,stroke:j,"stroke-width":f+"px"};break;case"-":a=d,b=d,h="path",e="M0,"+b/2+"L"+a+","+b/2,f=g*d,h="path",i={d:e,opacity:k,stroke:j,"stroke-width":f+"px"};break;case"+":a=d,b=d,h="path",e="M"+a/2+",0L"+a/2+","+b+"M0,"+b/2+"L"+a+","+b/2,f=d-d*Math.sqrt(1-g),h="path",i={d:e,opacity:k,stroke:j,"stroke-width":f+"px"};break;case".":a=d,b=d,x=g<Math.PI/4?Math.sqrt(g*d*d/Math.PI):(t=g,o=Math.PI/4,p=d/2,v=d/Math.sqrt(2),p+(v-p)*(t-o)/(1-o)),h="circle",i={cx:a/2,cy:b/2,r:x,opacity:k,fill:j};break}var H=[s||"noSh",l||"noBg",m||"noFg",d,g].join(";"),C=z._defs.select(".patterns").selectAll("#"+A).data([H],c.identity);C.exit().remove(),C.enter().append("pattern").each(function(){var c=u.select(this);if(c.attr({id:A,width:a+"px",height:b+"px",patternUnits:"userSpaceOnUse",patternTransform:I?"scale(0.8)":""}),l){var d=w(l),g=y.tinyRGB(d),j=d.getAlpha(),e=c.selectAll("rect").data([0]);e.exit().remove(),e.enter().append("rect").attr({width:a+"px",height:b+"px",fill:g,"fill-opacity":j})}var f=c.selectAll(h).data([0]);f.exit().remove(),f.enter().append(h).attr(i)}),q.style("fill",X(A,r)).style("fill-opacity",null),q.classed("pattern_filled",!0)},a.initGradients=function(a){var b=a._fullLayout;c.ensureSingle(b._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),u.select(a).selectAll(".gradient_filled").classed("gradient_filled",!1)},a.initPatterns=function(a){var b=a._fullLayout;c.ensureSingle(b._defs,"g","patterns").selectAll("pattern").remove(),u.select(a).selectAll(".pattern_filled").classed("pattern_filled",!1)},a.getPatternAttr=function(a,b,d){return a&&c.isArrayOrTypedArray(a)?b<a.length?a[b]:d:a},a.pointStyle=function(b,c,d){if(b.size()){var e=a.makePointStyleFns(c);b.each(function(b){a.singlePointStyle(b,u.select(this),c,e,d)})}},a.singlePointStyle=function(b,h,l,e,s){var i,p,m,f=l.marker,n=f.line;if(h.style("opacity",e.selectedOpacityFn?e.selectedOpacityFn(b):void 0===b.mo?f.opacity:b.mo),e.ms2mrc){x="various"===b.ms||"various"===f.size?3:e.ms2mrc(b.ms),b.mrc=x,e.selectedSizeFn&&(x=b.mrc=e.selectedSizeFn(b));var x,t=a.symbolNumber(b.mx||f.symbol)||0;b.om=t%200>=100;var z=k(b,l),A=j(b,l);h.attr("d",K(t,x,z,A))}var o=!1;if(b.so)m=n.outlierwidth,p=n.outliercolor,i=f.outliercolor;else{var B=(n||{}).width;m=(b.mlw+1||B+1||(b.trace?(b.trace.marker.line||{}).width:0)+1)-1||0,p="mlc"in b?b.mlcc=e.lineScale(b.mlc):c.isArrayOrTypedArray(n.color)?y.defaultLine:n.color,c.isArrayOrTypedArray(f.color)&&(i=y.defaultLine,o=!0),i="mc"in b?b.mcc=e.markerScale(b.mc):f.color||"rgba(0,0,0,0)",e.selectedColorFn&&(i=e.selectedColorFn(b))}if(b.om)h.call(y.stroke,i).style({"stroke-width":(m||1)+"px",fill:"none"});else{h.style("stroke-width",(b.isBlank?0:m)+"px");var q=f.gradient,g=b.mgt;g?o=!0:g=q&&q.type,c.isArrayOrTypedArray(g)&&(M[g=g[0]]||(g=0));var d=f.pattern,u=d&&a.getPatternAttr(d.shape,b.i,"");if(g&&"none"!==g){var r=b.mgc;r?o=!0:r=q.color;var v=l.uid;o&&(v+="-"+b.i),a.gradient(h,s,v,g,[[0,r],[1,i]],"fill")}else if(u){var C=a.getPatternAttr(d.bgcolor,b.i,null),D=a.getPatternAttr(d.fgcolor,b.i,null),E=d.fgopacity,F=a.getPatternAttr(d.size,b.i,8),G=a.getPatternAttr(d.solidity,b.i,.3),H=b.mcc||c.isArrayOrTypedArray(d.shape)||c.isArrayOrTypedArray(d.bgcolor)||c.isArrayOrTypedArray(d.size)||c.isArrayOrTypedArray(d.solidity),w=l.uid;H&&(w+="-"+b.i),a.pattern(h,"point",s,w,u,F,G,b.mcc,d.fillmode,C,D,E)}else y.fill(h,i);m&&y.stroke(h,p)}},a.makePointStyleFns=function(b){var d={},e=b.marker;return d.markerScale=a.tryColorscale(e,""),d.lineScale=a.tryColorscale(e,"line"),x.traceIs(b,"symbols")&&(d.ms2mrc=F.isBubble(b)?G(b):function(){return(e.size||6)/2}),b.selectedpoints&&c.extendFlat(d,a.makeSelectedPointStyleFns(b)),d},a.makeSelectedPointStyleFns=function(a){var b={},g=a.selected||{},h=a.unselected||{},d=a.marker||{},e=g.marker||{},f=h.marker||{},i=d.opacity,j=e.opacity,k=f.opacity,l=void 0!==j,m=void 0!==k;(c.isArrayOrTypedArray(i)||l||m)&&(b.selectedOpacityFn=function(a){var b=void 0===a.mo?d.opacity:a.mo;return a.selected?l?j:b:m?k:E*b});var t=d.color,n=e.color,o=f.color;(n||o)&&(b.selectedColorFn=function(a){var b=a.mcc||t;return a.selected?n||b:o||b});var u=d.size,p=e.size,q=f.size,r=void 0!==p,s=void 0!==q;return x.traceIs(a,"symbols")&&(r||s)&&(b.selectedSizeFn=function(a){var b=a.mrc||u/2;return a.selected?r?p/2:b:s?q/2:b}),b},a.makeSelectedTextStyleFns=function(a){var b={},c=a.selected||{},d=a.unselected||{},e=a.textfont||{},f=c.textfont||{},g=d.textfont||{},h=e.color,i=f.color,j=g.color;return b.selectedTextColorFn=function(b){var a=b.tc||h;return b.selected?i||a:j||(i?a:y.addOpacity(a,E))},b},a.selectedPointStyle=function(e,c){if(e.size()&&c.selectedpoints){var d=a.makeSelectedPointStyleFns(c),f=c.marker||{},b=[];d.selectedOpacityFn&&b.push(function(a,b){a.style("opacity",d.selectedOpacityFn(b))}),d.selectedColorFn&&b.push(function(a,b){y.fill(a,d.selectedColorFn(b))}),d.selectedSizeFn&&b.push(function(g,b){var h=b.mx||f.symbol||0,e=d.selectedSizeFn(b);g.attr("d",K(a.symbolNumber(h),e,k(b,c),j(b,c))),b.mrc2=e}),b.length&&e.each(function(c){for(var d=u.select(this),a=0;a<b.length;a++)b[a](d,c)})}},a.tryColorscale=function(b,d){var a=d?c.nestedProperty(b,d).get():b;if(a){var e=a.color;if((a.colorscale||a._colorAx)&&c.isArrayOrTypedArray(e))return z.makeColorScaleFuncFromTrace(a)}return c.identity};var N={start:1,end:-1,middle:0,bottom:1,top:-1};function O(b,a,c,d,h){var i=u.select(b.node().parentNode),e=-1!==a.indexOf("top")?"top":-1!==a.indexOf("bottom")?"bottom":"middle",f=-1!==a.indexOf("left")?"end":-1!==a.indexOf("right")?"start":"middle",g=d?d/.8+1:0,j=(B.lineCount(b)-1)*D+1,k=N[f]*g,l=.75*c+N[e]*g+(N[e]-1)*j*c/2;b.attr("text-anchor",f),h||i.attr("transform",A(k,l))}function P(b,c){var a=b.ts||c.textfont.size;return v(a)&&a>0?a:0}function Q(a,b,c){return c&&(a=i(a)),b?S(a[1]):R(a[0])}function R(b){var a=u.round(b,2);return m=a,a}function S(b){var a=u.round(b,2);return n=a,a}function T(j,a,k,l){var f=j[0]-a[0],g=j[1]-a[1],h=k[0]-a[0],i=k[1]-a[1],b=Math.pow(f*f+g*g,.25),c=Math.pow(h*h+i*i,.25),m=(c*c*f-b*b*h)*l,n=(c*c*g-b*b*i)*l,d=3*c*(b+c),e=3*b*(b+c);return[[R(a[0]+(d&&m/d)),S(a[1]+(d&&n/d))],[R(a[0]-(e&&m/e)),S(a[1]-(e&&n/e))]]}a.textPointStyle=function(d,b,e){if(d.size()){if(b.selectedpoints){var f;f=a.makeSelectedTextStyleFns(b).selectedTextColorFn}var g=b.texttemplate,h=e._fullLayout;d.each(function(d){var j=u.select(this),i=g?c.extractOption(d,b,"txt","texttemplate"):c.extractOption(d,b,"tx","text");if(!i&&0!==i){j.remove();return}if(g){var k=b._module.formatLabels,n=k?k(d,b,h):{},l={};H(l,b,d.i);var o=b._meta||{};i=c.texttemplateString(i,n,h._d3locale,l,d,o)}var p=d.tp||b.textposition,m=P(d,b),q=f?f(d):d.tc||b.textfont.color;j.call(a.font,d.tf||b.textfont.family,m,q).text(i).call(B.convertToTspans,e).call(O,p,m,d.mrc)})}},a.selectedTextStyle=function(b,c){if(b.size()&&c.selectedpoints){var d=a.makeSelectedTextStyleFns(c);b.each(function(a){var b=u.select(this),e=d.selectedTextColorFn(a),f=a.tp||c.textposition,g=P(a,c);y.fill(b,e);var h=x.traceIs(c,"bar-like");O(b,f,g,a.mrc2||a.mrc,h)})}},a.smoothopen=function(a,e){if(a.length<3)return"M"+a.join("L");var b,d="M"+a[0],c=[];for(b=1;b<a.length-1;b++)c.push(T(a[b-1],a[b],a[b+1],e));for(d+="Q"+c[0][0]+" "+a[1],b=2;b<a.length-1;b++)d+="C"+c[b-2][1]+" "+c[b-1][0]+" "+a[b];return d+="Q"+c[a.length-3][1]+" "+a[a.length-1]},a.smoothclosed=function(a,e){if(a.length<3)return"M"+a.join("L")+"Z";var b,f="M"+a[0],c=a.length-1,d=[T(a[c],a[0],a[1],e)];for(b=1;b<c;b++)d.push(T(a[b-1],a[b],a[b+1],e));for(d.push(T(a[c-1],a[c],a[0],e)),b=1;b<=c;b++)f+="C"+d[b-1][1]+" "+d[b][0]+" "+a[b];return f+="C"+d[c][1]+" "+d[0][0]+" "+a[0]+"Z"};var U={hv:function(c,a,b){return"H"+R(a[0])+"V"+Q(a,1,b)},vh:function(c,a,b){return"V"+S(a[1])+"H"+Q(a,0,b)},hvh:function(b,a,c){return"H"+R((b[0]+a[0])/2)+"V"+S(a[1])+"H"+Q(a,0,c)},vhv:function(b,a,c){return"V"+S((b[1]+a[1])/2)+"H"+R(a[0])+"V"+Q(a,1,c)}};function i(b,h){var i=b.backoff,d=b.trace,t=b.d,u=b.i;if(i&&d&&d.marker&&d.marker.angle%360==0&&d.line&&"spline"!==d.line.shape){var v=c.isArrayOrTypedArray(i),j=b,o=h?h[0]:m||0,p=h?h[1]:n||0,k=j[0],l=j[1],r=Math.atan2(l-p,k-o),e=v?i[u]:i;if("auto"===e){var s=j.i;"scatter"===d.type&&s--;var q=j.marker;e=q?a.symbolBackOffs[a.symbolNumber(q.symbol)]*q.size:0,e+=a.getMarkerStandoff(t[s],d)||0}var f=k-e*Math.cos(r),g=l-e*Math.sin(r);(f<=k&&f>=o||f>=k&&f<=o)&&(g<=l&&g>=p||g>=l&&g<=p)&&(b=[f,g])}return b}a.steps=function(a){var b=U[a]||function(c,a,b){return"L"+Q(a,0,b)+","+Q(a,1,b)};return function(a){for(var d="M"+R(a[0][0])+","+S(a[0][1]),e=a.length,c=1;c<e;c++)d+=b(a[c-1],a[c],c===e-1);return d}},a.applyBackoff=i,a.makeTester=function(){var b=c.ensureSingleById(u.select("body"),"svg","js-plotly-tester",function(a){a.attr(C.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),d=c.ensureSingle(b,"path","js-reference-point",function(a){a.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});a.tester=b,a.testref=d},a.savedBBoxes={};var V=0;function W(a){var b=a.getAttribute("data-unformatted");if(null!==b)return b+a.getAttribute("data-math")+a.getAttribute("text-anchor")+a.getAttribute("style")}function X(a,d){if(!a)return null;var b=d._context,c=b._exportedPlot?"":b._baseUrl||"";return c?"url('"+c+"#"+a+"')":"url(#"+a+")"}a.bBox=function(f,m,b){if(b||(b=W(f)),b){if(n=a.savedBBoxes[b])return c.extendFlat({},n)}else if(1===f.childNodes.length){var n,d,l,g=f.childNodes[0];if(b=W(g)){var i=+g.getAttribute("x")||0,j=+g.getAttribute("y")||0,o=g.getAttribute("transform");if(!o){var h=a.bBox(g,!1,b);return i&&(h.left+=i,h.right+=i),j&&(h.top+=j,h.bottom+=j),h}if(b+="~"+i+"~"+j+"~"+o,n=a.savedBBoxes[b])return c.extendFlat({},n)}}m?d=f:(l=a.tester.node(),d=f.cloneNode(!0),l.appendChild(d)),u.select(d).attr("transform",null).call(B.positionText,0,0);var e=d.getBoundingClientRect(),k=a.testref.node().getBoundingClientRect();m||l.removeChild(d);var p={height:e.height,width:e.width,left:e.left-k.left,top:e.top-k.top,right:e.right-k.left,bottom:e.bottom-k.top};return V>=1e4&&(a.savedBBoxes={},V=0),b&&(a.savedBBoxes[b]=p),V++,c.extendFlat({},p)},a.setClipUrl=function(a,b,c){a.attr("clip-path",X(b,c))},a.getTranslate=function(a){var c=a.attr?"attr":"getAttribute",d=a[c]("transform")||"",b=d.replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(c,a,b){return[a,b].join(" ")}).split(" ");return{x:+b[0]||0,y:+b[1]||0}},a.setTranslate=function(b,c,d){var e=b.attr?"attr":"getAttribute",f=b.attr?"attr":"setAttribute",a=b[e]("transform")||"";return c=c||0,d=d||0,a=a.replace(/(\btranslate\(.*?\);?)/,"").trim(),a+=A(c,d),a=a.trim(),b[f]("transform",a),a},a.getScale=function(a){var c=a.attr?"attr":"getAttribute",d=a[c]("transform")||"",b=d.replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(c,a,b){return[a,b].join(" ")}).split(" ");return{x:+b[0]||1,y:+b[1]||1}},a.setScale=function(b,c,d){var e=b.attr?"attr":"getAttribute",f=b.attr?"attr":"setAttribute",a=b[e]("transform")||"";return c=c||1,d=d||1,a=a.replace(/(\bscale\(.*?\);?)/,"").trim(),a+="scale("+c+","+d+")",a=a.trim(),b[f]("transform",a),a};var Y=/\s*sc.*/;a.setPointGroupScale=function(c,a,b){if(a=a||1,b=b||1,c){var d=1===a&&1===b?"":"scale("+a+","+b+")";c.each(function(){var a=(this.getAttribute("transform")||"").replace(Y,"");a+=d,a=a.trim(),this.setAttribute("transform",a)})}};var Z=/translate\([^)]*\)\s*$/;function j(c,b){var a;return(c&&(a=c.mf),void 0===a&&(a=b.marker?b.marker.standoff||0:0),b._geo||b._xA)?a:-a}a.setTextPointsScale=function(a,b,c){a&&a.each(function(){var a,d=u.select(this),e=d.select("text");if(e.node()){var f=parseFloat(e.attr("x")||0),g=parseFloat(e.attr("y")||0),h=(d.attr("transform")||"").match(Z);a=1===b&&1===c?[]:[A(f,g),"scale("+b+","+c+")",A(-f,-g),],h&&a.push(h),d.attr("transform",a.join(""))}})},a.getMarkerStandoff=j;var $=Math.atan2,_=Math.cos,aa=Math.sin;function ab(a,b){var c=b[0],d=b[1];return[c*_(a)-d*aa(a),c*aa(a)+d*_(a)]}function k(b,a){var c=b.ma;void 0===c&&(c=a.marker.angle||0);var d=a.marker.angleref;if("previous"===d||"north"===d){if(a._geo){var k=a._geo.project(b.lonlat);e=k[0],f=k[1]}else{var l=a._xA,m=a._yA;if(!l||!m)return 90;e=l.c2p(b.x),f=m.c2p(b.y)}if(a._geo){var e,f,g,h=b.lonlat[0],i=b.lonlat[1],n=a._geo.project([h,i+1e-5]),u=a._geo.project([h+1e-5,i]),E=$(u[1]-f,u[0]-e),F=$(n[1]-f,n[0]-e);if("north"===d)g=c/180*Math.PI;else if("previous"===d){var G=h/180*Math.PI,w=i/180*Math.PI,H=o/180*Math.PI,j=p/180*Math.PI,x=H-G,I=_(j)*aa(x),J=aa(j)*_(w)-_(j)*aa(w)*_(x);g=-$(I,J)-Math.PI,o=h,p=i}var y=ab(E,[_(g),0]),z=ab(F,[aa(g),0]);c=$(y[1]+z[1],y[0]+z[0])/Math.PI*180,"previous"!==d||t===a.uid&&b.i===s+1||(c=null)}if("previous"===d&&!a._geo)if(t===a.uid&&b.i===s+1&&v(e)&&v(f)){var A=e-q,B=f-r,C=a.line?a.line.shape||"":"",D=C.slice(C.length-1);"h"===D&&(B=0),"v"===D&&(A=0),c+=$(B,A)/Math.PI*180+90}else c=null}return q=e,r=f,s=b.i,t=a.uid,c}a.getMarkerAngle=k},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(a,b,c){"use strict";var d,e,f,g,h=a("parse-svg-path"),i=a("@plotly/d3").round,j="M0,0Z",k=Math.sqrt(2),l=Math.sqrt(3),m=Math.PI,n=Math.cos,o=Math.sin;function p(a){return null===a}function q(j,l,k){if((!j||j%360==0)&&!l)return k;if(f===j&&g===l&&d===k)return e;function r(a,b){var c=n(a),d=o(a),e=b[0],f=b[1]+(l||0);return[e*c-f*d,e*d+f*c]}f=j,g=l,d=k;for(var s=j/180*m,c=0,i=0,t=h(k),p="",q=0;q<t.length;q++){var b=t[q],a=b[0],w=c,x=i;if("M"===a||"L"===a)c=+b[1],i=+b[2];else if("m"===a||"l"===a)c+=+b[1],i+=+b[2];else if("H"===a)c=+b[1];else if("h"===a)c+=+b[1];else if("V"===a)i=+b[1];else if("v"===a)i+=+b[1];else if("A"===a){c=+b[1],i=+b[2];var u=r(s,[+b[6],+b[7]]);b[6]=u[0],b[7]=u[1],b[3]=+b[3]+j}("H"===a||"V"===a)&&(a="L"),("h"===a||"v"===a)&&(a="l"),("m"===a||"l"===a)&&(c-=w,i-=x);var v=r(s,[c,i]);("H"===a||"V"===a)&&(a="L"),("M"===a||"L"===a||"m"===a||"l"===a)&&(b[1]=v[0],b[2]=v[1]),b[0]=a,p+=b[0]+b.slice(1).join(",")}return e=p,p}b.exports={circle:{n:0,f:function(e,b,c){if(p(b))return j;var a=i(e,2),d="M"+a+",0A"+a+","+a+" 0 1,1 0,-"+a+"A"+a+","+a+" 0 0,1 "+a+",0Z";return c?q(b,c,d):d}},square:{n:1,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+","+a+"H-"+a+"V-"+a+"H"+a+"Z")}},diamond:{n:2,f:function(c,b,d){if(p(b))return j;var a=i(1.3*c,2);return q(b,d,"M"+a+",0L0,"+a+"L-"+a+",0L0,-"+a+"Z")}},cross:{n:3,f:function(c,d,e){if(p(d))return j;var a=i(.4*c,2),b=i(1.2*c,2);return q(d,e,"M"+b+","+a+"H"+a+"V"+b+"H-"+a+"V"+a+"H-"+b+"V-"+a+"H-"+a+"V-"+b+"H"+a+"V-"+a+"H"+b+"Z")}},x:{n:4,f:function(g,e,h){if(p(e))return j;var a=i(.8*g/k,2),b="l"+a+","+a,f="l"+a+",-"+a,c="l-"+a+",-"+a,d="l-"+a+","+a;return q(e,h,"M0,"+a+b+f+c+f+c+d+c+d+b+d+b+"Z")}},"triangle-up":{n:5,f:function(a,b,d){if(p(b))return j;var c=i(2*a/l,2),e=i(a/2,2),f=i(a,2);return q(b,d,"M-"+c+","+e+"H"+c+"L0,-"+f+"Z")}},"triangle-down":{n:6,f:function(a,b,d){if(p(b))return j;var c=i(2*a/l,2),e=i(a/2,2),f=i(a,2);return q(b,d,"M-"+c+",-"+e+"H"+c+"L0,"+f+"Z")}},"triangle-left":{n:7,f:function(a,b,d){if(p(b))return j;var c=i(2*a/l,2),e=i(a/2,2),f=i(a,2);return q(b,d,"M"+e+",-"+c+"V"+c+"L-"+f+",0Z")}},"triangle-right":{n:8,f:function(a,b,d){if(p(b))return j;var c=i(2*a/l,2),e=i(a/2,2),f=i(a,2);return q(b,d,"M-"+e+",-"+c+"V"+c+"L"+f+",0Z")}},"triangle-ne":{n:9,f:function(a,b,e){if(p(b))return j;var c=i(.6*a,2),d=i(1.2*a,2);return q(b,e,"M-"+d+",-"+c+"H"+c+"V"+d+"Z")}},"triangle-se":{n:10,f:function(a,b,e){if(p(b))return j;var c=i(.6*a,2),d=i(1.2*a,2);return q(b,e,"M"+c+",-"+d+"V"+c+"H-"+d+"Z")}},"triangle-sw":{n:11,f:function(a,b,e){if(p(b))return j;var c=i(.6*a,2),d=i(1.2*a,2);return q(b,e,"M"+d+","+c+"H-"+c+"V-"+d+"Z")}},"triangle-nw":{n:12,f:function(a,b,e){if(p(b))return j;var c=i(.6*a,2),d=i(1.2*a,2);return q(b,e,"M-"+c+","+d+"V-"+c+"H"+d+"Z")}},pentagon:{n:13,f:function(a,b,f){if(p(b))return j;var c=i(.951*a,2),d=i(.588*a,2),g=i(-a,2),e=i(-0.309*a,2),h=i(.809*a,2);return q(b,f,"M"+c+","+e+"L"+d+","+h+"H-"+d+"L-"+c+","+e+"L0,"+g+"Z")}},hexagon:{n:14,f:function(b,c,f){if(p(c))return j;var d=i(b,2),a=i(b/2,2),e=i(b*l/2,2);return q(c,f,"M"+e+",-"+a+"V"+a+"L0,"+d+"L-"+e+","+a+"V-"+a+"L0,-"+d+"Z")}},hexagon2:{n:15,f:function(b,c,f){if(p(c))return j;var d=i(b,2),a=i(b/2,2),e=i(b*l/2,2);return q(c,f,"M-"+a+","+e+"H"+a+"L"+d+",0L"+a+",-"+e+"H-"+a+"L-"+d+",0Z")}},octagon:{n:16,f:function(c,d,e){if(p(d))return j;var b=i(.924*c,2),a=i(.383*c,2);return q(d,e,"M-"+a+",-"+b+"H"+a+"L"+b+",-"+a+"V"+a+"L"+a+","+b+"H-"+a+"L-"+b+","+a+"V-"+a+"Z")}},star:{n:17,f:function(l,b,m){if(p(b))return j;var a=1.4*l,c=i(.225*a,2),d=i(.951*a,2),e=i(.363*a,2),f=i(.588*a,2),n=i(-a,2),g=i(-0.309*a,2),h=i(.118*a,2),k=i(.809*a,2),o=i(.382*a,2);return q(b,m,"M"+c+","+g+"H"+d+"L"+e+","+h+"L"+f+","+k+"L0,"+o+"L-"+f+","+k+"L-"+e+","+h+"L-"+d+","+g+"H-"+c+"L0,"+n+"Z")}},hexagram:{n:18,f:function(d,e,f){if(p(e))return j;var a=i(.66*d,2),b=i(.38*d,2),c=i(.76*d,2);return q(e,f,"M-"+c+",0l-"+b+",-"+a+"h"+c+"l"+b+",-"+a+"l"+b+","+a+"h"+c+"l-"+b+","+a+"l"+b+","+a+"h-"+c+"l-"+b+","+a+"l-"+b+",-"+a+"h-"+c+"Z")}},"star-triangle-up":{n:19,f:function(a,e,g){if(p(e))return j;var b=i(a*l*.8,2),c=i(.8*a,2),h=i(1.6*a,2),f=i(4*a,2),d="A "+f+","+f+" 0 0 1 ";return q(e,g,"M-"+b+","+c+d+b+","+c+d+"0,-"+h+d+"-"+b+","+c+"Z")}},"star-triangle-down":{n:20,f:function(a,e,g){if(p(e))return j;var b=i(a*l*.8,2),c=i(.8*a,2),h=i(1.6*a,2),f=i(4*a,2),d="A "+f+","+f+" 0 0 1 ";return q(e,g,"M"+b+",-"+c+d+"-"+b+",-"+c+d+"0,"+h+d+b+",-"+c+"Z")}},"star-square":{n:21,f:function(c,d,f){if(p(d))return j;var a=i(1.1*c,2),e=i(2*c,2),b="A "+e+","+e+" 0 0 1 ";return q(d,f,"M-"+a+",-"+a+b+"-"+a+","+a+b+a+","+a+b+a+",-"+a+b+"-"+a+",-"+a+"Z")}},"star-diamond":{n:22,f:function(c,d,f){if(p(d))return j;var a=i(1.4*c,2),e=i(1.9*c,2),b="A "+e+","+e+" 0 0 1 ";return q(d,f,"M-"+a+",0"+b+"0,"+a+b+a+",0"+b+"0,-"+a+b+"-"+a+",0Z")}},"diamond-tall":{n:23,f:function(a,b,e){if(p(b))return j;var c=i(.7*a,2),d=i(1.4*a,2);return q(b,e,"M0,"+d+"L"+c+",0L0,-"+d+"L-"+c+",0Z")}},"diamond-wide":{n:24,f:function(a,b,e){if(p(b))return j;var c=i(1.4*a,2),d=i(.7*a,2);return q(b,e,"M0,"+d+"L"+c+",0L0,-"+d+"L-"+c+",0Z")}},hourglass:{n:25,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+","+a+"H-"+a+"L"+a+",-"+a+"H-"+a+"Z")},noDot:!0},bowtie:{n:26,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+","+a+"V-"+a+"L-"+a+","+a+"V-"+a+"Z")},noDot:!0},"circle-cross":{n:27,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M0,"+a+"V-"+a+"M"+a+",0H-"+a+"M"+a+",0A"+a+","+a+" 0 1,1 0,-"+a+"A"+a+","+a+" 0 0,1 "+a+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(c,d,e){if(p(d))return j;var b=i(c,2),a=i(c/k,2);return q(d,e,"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a+"M"+b+",0A"+b+","+b+" 0 1,1 0,-"+b+"A"+b+","+b+" 0 0,1 "+b+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M0,"+a+"V-"+a+"M"+a+",0H-"+a+"M"+a+","+a+"H-"+a+"V-"+a+"H"+a+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a+"M"+a+","+a+"H-"+a+"V-"+a+"H"+a+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(c,b,d){if(p(b))return j;var a=i(1.3*c,2);return q(b,d,"M"+a+",0L0,"+a+"L-"+a+",0L0,-"+a+"ZM0,-"+a+"V"+a+"M-"+a+",0H"+a)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(c,d,e){if(p(d))return j;var b=i(1.3*c,2),a=i(.65*c,2);return q(d,e,"M"+b+",0L0,"+b+"L-"+b+",0L0,-"+b+"ZM-"+a+",-"+a+"L"+a+","+a+"M-"+a+","+a+"L"+a+",-"+a)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(c,b,d){if(p(b))return j;var a=i(1.4*c,2);return q(b,d,"M0,"+a+"V-"+a+"M"+a+",0H-"+a)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(c,d,e){if(p(d))return j;var b=i(1.2*c,2),a=i(.85*c,2);return q(d,e,"M0,"+b+"V-"+b+"M"+b+",0H-"+b+"M"+a+","+a+"L-"+a+",-"+a+"M"+a+",-"+a+"L-"+a+","+a)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(c,d,e){if(p(d))return j;var b=i(c/2,2),a=i(c,2);return q(d,e,"M"+b+","+a+"V-"+a+"M"+(b-a)+",-"+a+"V"+a+"M"+a+","+b+"H-"+a+"M-"+a+","+(b-a)+"H"+a)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(a,b,e){if(p(b))return j;var c=i(1.2*a,2),f=i(1.6*a,2),d=i(.8*a,2);return q(b,e,"M-"+c+","+d+"L0,0M"+c+","+d+"L0,0M0,-"+f+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(a,b,e){if(p(b))return j;var c=i(1.2*a,2),f=i(1.6*a,2),d=i(.8*a,2);return q(b,e,"M-"+c+",-"+d+"L0,0M"+c+",-"+d+"L0,0M0,"+f+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(a,b,e){if(p(b))return j;var c=i(1.2*a,2),f=i(1.6*a,2),d=i(.8*a,2);return q(b,e,"M"+d+","+c+"L0,0M"+d+",-"+c+"L0,0M-"+f+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(a,b,e){if(p(b))return j;var c=i(1.2*a,2),f=i(1.6*a,2),d=i(.8*a,2);return q(b,e,"M-"+d+","+c+"L0,0M-"+d+",-"+c+"L0,0M"+f+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(c,a,d){if(p(a))return j;var b=i(1.4*c,2);return q(a,d,"M"+b+",0H-"+b)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(c,a,d){if(p(a))return j;var b=i(1.4*c,2);return q(a,d,"M0,"+b+"V-"+b)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+",-"+a+"L-"+a+","+a)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(c,b,d){if(p(b))return j;var a=i(c,2);return q(b,d,"M"+a+","+a+"L-"+a+",-"+a)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(a,b,d){if(p(b))return j;var c=i(a,2);return q(b,d,"M0,0L-"+c+","+i(2*a,2)+"H"+c+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(a,b,d){if(p(b))return j;var c=i(a,2);return q(b,d,"M0,0L-"+c+",-"+i(2*a,2)+"H"+c+"Z")},noDot:!0},"arrow-left":{n:47,f:function(a,b,d){if(p(b))return j;var e=i(2*a,2),c=i(a,2);return q(b,d,"M0,0L"+e+",-"+c+"V"+c+"Z")},noDot:!0},"arrow-right":{n:48,f:function(a,b,d){if(p(b))return j;var e=i(2*a,2),c=i(a,2);return q(b,d,"M0,0L-"+e+",-"+c+"V"+c+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(b,c,d){if(p(c))return j;var a=i(b,2);return q(c,d,"M-"+a+",0H"+a+"M0,0L-"+a+","+i(2*b,2)+"H"+a+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(b,c,d){if(p(c))return j;var a=i(b,2);return q(c,d,"M-"+a+",0H"+a+"M0,0L-"+a+",-"+i(2*b,2)+"H"+a+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(b,c,d){if(p(c))return j;var e=i(2*b,2),a=i(b,2);return q(c,d,"M0,-"+a+"V"+a+"M0,0L"+e+",-"+a+"V"+a+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(b,c,d){if(p(c))return j;var e=i(2*b,2),a=i(b,2);return q(c,d,"M0,-"+a+"V"+a+"M0,0L-"+e+",-"+a+"V"+a+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(a,b,f){if(p(b))return j;var c=m/2.5,d=2*a*n(c),e=2*a*o(c);return q(b,f,"M0,0L"+ -d+","+e+"L"+d+","+e+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(a,b,f){if(p(b))return j;var c=m/4,d=2*a*n(c),e=2*a*o(c);return q(b,f,"M0,0L"+ -d+","+e+"A "+2*a+","+2*a+" 0 0 1 "+d+","+e+"Z")},backoff:.4,noDot:!0}}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(b,a,c){"use strict";a.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../registry"),f=a("../../plots/cartesian/axes"),g=a("../../lib"),h=a("./compute_error");function i(m,n,b,c){var o=n["error_"+c]||{},r=o.visible&& -1!==["linear","log"].indexOf(b.type),p=[];if(r){for(var s=h(o),e=0;e<m.length;e++){var i=m[e],j=i.i;if(void 0===j)j=e;else if(null===j)continue;var k=i[c];if(d(b.c2l(k))){var l=s(k,j);if(d(l[0])&&d(l[1])){var t=i[c+"s"]=k-l[0],u=i[c+"h"]=k+l[1];p.push(t,u)}}}var v=b._id,a=n._extremes[v],q=f.findExtremes(b,p,g.extendFlat({tozero:a.opts.tozero},{padded:!0}));a.min=a.min.concat(q.min),a.max=a.max.concat(q.max)}}b.exports=function(b){for(var g=b.calcdata,c=0;c<g.length;c++){var d=g[c],a=d[0].trace;if(!0===a.visible&&e.traceIs(a,"errorBarsOK")){var h=f.getFromId(b,a.xaxis),j=f.getFromId(b,a.yaxis);i(d,a,h,"x"),i(d,a,j,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(b,a,c){"use strict";function d(a,b){return"percent"===a?function(a){return Math.abs(a*b/100)}:"constant"===a?function(){return Math.abs(b)}:"sqrt"===a?function(a){return Math.sqrt(Math.abs(a))}:void 0}a.exports=function(a){var b=a.type,c=a.symmetric;if("data"===b){var e=a.array||[];if(c)return function(c,b){var a=+e[b];return[a,a]};var f=a.arrayminus||[];return function(d,a){var b=+e[a],c=+f[a];return isNaN(b)&&isNaN(c)?[NaN,NaN]:[c||0,b||0]}}var g=d(b,a.value),h=d(b,a.valueminus);return c|| void 0===a.valueminus?function(b){var a=g(b);return[a,a]}:function(a){return[h(a),g(a)]}}},{}],394:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../registry"),f=a("../../lib"),g=a("../../plot_api/plot_template"),h=a("./attributes");b.exports=function(n,j,o,c){var l="error_"+c.axis,p=g.newContainer(j,l),b=n[l]||{};function a(a,c){return f.coerce(b,p,h,a,c)}if(!1!==a("visible",void 0!==b.array|| void 0!==b.value||"sqrt"===b.type)){var i=a("type","array"in b?"data":"percent"),k=!0;"sqrt"!==i&&(k=a("symmetric",!(("data"===i?"arrayminus":"valueminus")in b))),"data"===i?(a("array"),a("traceref"),k||(a("arrayminus"),a("tracerefminus"))):"percent"!==i&&"constant"!==i||(a("value"),k||a("valueminus"));var m="copy_"+c.inherit+"style";c.inherit&&(j["error_"+c.inherit]||{}).visible&&a(m,!(b.color||d(b.thickness)||d(b.width))),c.inherit&&p[m]||(a("color",o),a("thickness"),a("width",e.traceIs(j,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(a,g,h){"use strict";var c=a("../../lib"),f=a("../../plot_api/edit_types").overrideAll,d=a("./attributes"),b={error_x:c.extendFlat({},d),error_y:c.extendFlat({},d)};delete b.error_x.copy_zstyle,delete b.error_y.copy_zstyle,delete b.error_y.copy_ystyle;var e={error_x:c.extendFlat({},d),error_y:c.extendFlat({},d),error_z:c.extendFlat({},d)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,g.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:b,bar:b,histogram:b,scatter3d:f(e,"calc","nested"),scattergl:f(b,"calc","nested")}},supplyDefaults:a("./defaults"),calc:a("./calc"),makeComputeError:a("./compute_error"),plot:a("./plot"),style:a("./style"),hoverInfo:function(a,b,c){(b.error_y||{}).visible&&(c.yerr=a.yh-a.y,b.error_y.symmetric||(c.yerrneg=a.y-a.ys)),(b.error_x||{}).visible&&(c.xerr=a.xh-a.x,b.error_x.symmetric||(c.xerrneg=a.x-a.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("fast-isnumeric"),f=a("../drawing"),g=a("../../traces/scatter/subtypes");b.exports=function(h,c,a,b){var i,j=a.xaxis,k=a.yaxis,l=b&&b.duration>0;c.each(function(n){var o,m=n[0].trace,p=m.error_x||{},q=m.error_y||{};m.ids&&(o=function(a){return a.id});var s=g.hasMarkers(m)&&m.marker.maxdisplayed>0;q.visible||p.visible||(n=[]);var c=d.select(this).selectAll("g.errorbar").data(n,o);if(c.exit().remove(),n.length){p.visible||c.selectAll("path.xerror").remove(),q.visible||c.selectAll("path.yerror").remove(),c.style("opacity",1);var r=c.enter().append("g").classed("errorbar",!0);l&&r.style("opacity",0).transition().duration(b.duration).style("opacity",1),f.setClipUrl(c,a.layerClipId,h),c.each(function(v){var f,n,o,c,g,u=d.select(this),a=(f=v,n=j,o=k,c={x:n.c2p(f.x),y:o.c2p(f.y)},void 0===f.yh||(c.yh=o.c2p(f.yh),c.ys=o.c2p(f.ys),e(c.ys)||(c.noYS=!0,c.ys=o.c2p(f.ys,!0))),void 0===f.xh||(c.xh=n.c2p(f.xh),c.xs=n.c2p(f.xs),e(c.xs)||(c.noXS=!0,c.xs=n.c2p(f.xs,!0))),c);if(!s||v.vis){var h=u.select("path.yerror");if(q.visible&&e(a.x)&&e(a.yh)&&e(a.ys)){var r=q.width;g="M"+(a.x-r)+","+a.yh+"h"+2*r+"m-"+r+",0V"+a.ys,a.noYS||(g+="m-"+r+",0h"+2*r),i=!h.size(),i?h=u.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):l&&(h=h.transition().duration(b.duration).ease(b.easing)),h.attr("d",g)}else h.remove();var m=u.select("path.xerror");if(p.visible&&e(a.y)&&e(a.xh)&&e(a.xs)){var t=(p.copy_ystyle?q:p).width;g="M"+a.xh+","+(a.y-t)+"v"+2*t+"m0,-"+t+"H"+a.xs,a.noXS||(g+="m0,-"+t+"v"+2*t),i=!m.size(),i?m=u.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):l&&(m=m.transition().duration(b.duration).ease(b.easing)),m.attr("d",g)}else m.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../color");b.exports=function(a){a.each(function(g){var c=g[0].trace,b=c.error_y||{},a=c.error_x||{},f=d.select(this);f.selectAll("path.yerror").style("stroke-width",b.thickness+"px").call(e.stroke,b.color),a.copy_ystyle&&(a=b),f.selectAll("path.xerror").style("stroke-width",a.thickness+"px").call(e.stroke,a.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(c,d,f){"use strict";var e=c("../../plots/font_attributes"),a=c("./layout_attributes").hoverlabel,b=c("../../lib/extend").extendFlat;d.exports={hoverlabel:{bgcolor:b({},a.bgcolor,{arrayOk:!0}),bordercolor:b({},a.bordercolor,{arrayOk:!0}),font:e({arrayOk:!0,editType:"none"}),align:b({},a.align,{arrayOk:!0}),namelength:b({},a.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry");function f(b,c,e,a){a=a||d.identity,Array.isArray(b)&&(c[0][e]=a(b))}b.exports=function(h){var i=h.calcdata,k=h._fullLayout;function j(a){return function(b){return d.coerceHoverinfo({hoverinfo:b},{_module:a._module},k)}}for(var g=0;g<i.length;g++){var b=i[g],a=b[0].trace;if(!e.traceIs(a,"pie-like")){var c=e.traceIs(a,"2dMap")?f:d.fillArray;c(a.hoverinfo,b,"hi",j(a)),a.hovertemplate&&c(a.hovertemplate,b,"ht"),a.hoverlabel&&(c(a.hoverlabel.bgcolor,b,"hbg"),c(a.hoverlabel.bordercolor,b,"hbc"),c(a.hoverlabel.font.size,b,"hts"),c(a.hoverlabel.font.color,b,"htc"),c(a.hoverlabel.font.family,b,"htf"),c(a.hoverlabel.namelength,b,"hnl"),c(a.hoverlabel.align,b,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("./hover").hover;b.exports=function(b,a,f){var c=d.getComponentMethod("annotations","onClick")(b,b._hoverdata);function g(){b.emit("plotly_click",{points:b._hoverdata,event:a})}void 0!==f&&e(b,a,f,!0),b._hoverdata&&a&&a.target&&(c&&c.then?c.then(g):g(),a.stopImmediatePropagation&&a.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(b,a,c){"use strict";a.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("./hoverlabel_defaults");b.exports=function(c,a,h,g){var b=d.extendFlat({},g.hoverlabel);a.hovertemplate&&(b.namelength=-1),f(c,a,function(b,f){return d.coerce(c,a,e,b,f)},b)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(b,c,a){"use strict";var d=b("../../lib");a.getSubplot=function(a){return a.subplot||a.xaxis+a.yaxis||a.geo},a.isTraceInSubplots=function(b,e){if("splom"===b.type){for(var f=b.xaxes||[],g=b.yaxes||[],c=0;c<f.length;c++)for(var d=0;d<g.length;d++)if(-1!==e.indexOf(f[c]+g[d]))return!0;return!1}return -1!==e.indexOf(a.getSubplot(b))},a.flat=function(b,d){for(var c=new Array(b.length),a=0;a<b.length;a++)c[a]=d;return c},a.p2c=function(b,d){for(var c=new Array(b.length),a=0;a<b.length;a++)c[a]=b[a].p2c(d);return c},a.getDistanceFunction=function(b,c,d,e){return"closest"===b?e||a.quadrature(c,d):"x"===b.charAt(0)?c:d},a.getClosest=function(c,e,a){if(!1!==a.index)a.index>=0&&a.index<c.length?a.distance=0:a.index=!1;else for(var b=0;b<c.length;b++){var d=e(c[b]);d<=a.distance&&(a.index=b,a.distance=d)}return a},a.inbox=function(a,b,c){return a*b<0||0===a?c:1/0},a.quadrature=function(a,b){return function(c){var d=a(c),e=b(c);return Math.sqrt(d*d+e*e)}},a.makeEventData=function(b,d,g){var e="index"in b?b.index:b.pointNumber,c={data:d._input,fullData:d,curveNumber:d.index,pointNumber:e};if(d._indexToPoints){var f=d._indexToPoints[e];1===f.length?c.pointIndex=f[0]:c.pointIndices=f}else c.pointIndex=e;return d._module.eventData?c=d._module.eventData(c,b,d,g,e):("xVal"in b?c.x=b.xVal:"x"in b&&(c.x=b.x),"yVal"in b?c.y=b.yVal:"y"in b&&(c.y=b.y),b.xa&&(c.xaxis=b.xa),b.ya&&(c.yaxis=b.ya),void 0!==b.zLabelVal&&(c.z=b.zLabelVal)),a.appendArrayPointValue(c,d,e),c},a.appendArrayPointValue=function(c,e,k){var a=e._arrayAttrs;if(a)for(var b=0;b<a.length;b++){var h=a[b],i=f(h);if(void 0===c[i]){var j=g(d.nestedProperty(e,h).get(),k);void 0!==j&&(c[i]=j)}}},a.appendArrayMultiPointValues=function(h,i,b){var c=i._arrayAttrs;if(c)for(var e=0;e<c.length;e++){var j=c[e],k=f(j);if(void 0===h[k]){for(var m=d.nestedProperty(i,j).get(),l=new Array(b.length),a=0;a<b.length;a++)l[a]=g(m,b[a]);h[k]=l}}};var e={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function f(a){return e[a]||a}function g(b,a){return Array.isArray(a)?Array.isArray(b)&&Array.isArray(b[a[0]])?b[a[0]][a[1]]:void 0:b[a]}var h={x:!0,y:!0},i={"x unified":!0,"y unified":!0};a.isUnifiedHover=function(a){return"string"==typeof a&&!!i[a]},a.isXYhover=function(a){return"string"==typeof a&&!!h[a]}},{"../../lib":515}],404:[function(a,g,d){"use strict";var h=a("@plotly/d3"),i=a("fast-isnumeric"),j=a("tinycolor2"),e=a("../../lib"),k=e.strTranslate,l=e.strRotate,m=a("../../lib/events"),n=a("../../lib/svg_text_utils"),o=a("../../lib/override_cursor"),p=a("../drawing"),q=a("../color"),r=a("../dragelement"),s=a("../../plots/cartesian/axes"),t=a("../../registry"),u=a("./helpers"),b=a("./constants"),v=a("../legend/defaults"),w=a("../legend/draw"),f=b.YANGLE,c=Math.PI*f/180,x=1/Math.sin(c),y=Math.cos(c),z=Math.sin(c),A=b.HOVERARROWSIZE,B=b.HOVERTEXTPAD,C={box:!0,ohlc:!0,violin:!0,candlestick:!0},D={scatter:!0,scattergl:!0,splom:!0};function E(a){return[a.trace.index,a.index,a.x0,a.y0,a.name,a.attr,a.xa?a.xa._id:"",a.ya?a.ya._id:""].join(",")}d.hover=function(a,c,d,f){a=e.getGraphDiv(a);var g=c.target;e.throttle(a._fullLayout._uid+b.HOVERID,b.HOVERMINTIME,function(){(function(a,b,y,ay,z){y||(y="xy");var p=Array.isArray(y)?y:[y],c=a._fullLayout,B=c._plots||[],aa=B[y],O=c._has("cartesian");if(aa){var az=aa.overlays.map(function(a){return a.id});p=p.concat(az)}for(var T=p.length,s=new Array(T),v=new Array(T),ab=!1,w=0;w<T;w++){var x=p[w];if(B[x])ab=!0,s[w]=B[x].xaxis,v[w]=B[x].yaxis;else if(c[x]&&c[x]._subplot){var ac=c[x]._subplot;s[w]=ac.xaxis,v[w]=ac.yaxis}else{e.warn("Unrecognized subplot: "+x);return}}var g=b.hovermode||c.hovermode;if(g&&!ab&&(g="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(g)||!a.calcdata||a.querySelector(".zoombox")||a._dragging)return r.unhoverRaw(a,b);var ad=c.hoverdistance;-1===ad&&(ad=1/0);var A=c.spikedistance;-1===A&&(A=1/0);var f=[],U=[],j={hLinePoint:null,vLinePoint:null},V=!1;if(Array.isArray(b))for(F=0,g="array";F<b.length;F++)(aO=a.calcdata[b[F].curveNumber||0])&&(aP=aO[0].trace,"skip"!==aO[0].trace.hoverinfo&&(U.push(aO),"h"===aP.orientation&&(V=!0)));else{for(aN=0;aN<a.calcdata.length;aN++)"skip"!==(aP=(aO=a.calcdata[aN])[0].trace).hoverinfo&&u.isTraceInSubplots(aP,p)&&(U.push(aO),"h"===aP.orientation&&(V=!0));if(z){if(!1===m.triggerHandler(a,"plotly_beforehover",b))return;var W,X,F,aN,aO,aP,aQ,aR,aA,aS,aT,aU,aV,k,l,ae=z.getBoundingClientRect();k=b.clientX-ae.left,l=b.clientY-ae.top,c._calcInverseTransform(a);var af=e.apply3DTransform(c._invTransform)(k,l);if(k=af[0],l=af[1],k<0||k>s[0]._length||l<0||l>v[0]._length)return r.unhoverRaw(a,b)}else k="xpx"in b?b.xpx:s[0]._length/2,l="ypx"in b?b.ypx:v[0]._length/2;if(b.pointerX=k+s[0]._offset,b.pointerY=l+v[0]._offset,W="xval"in b?u.flat(p,b.xval):u.p2c(s,k),X="yval"in b?u.flat(p,b.yval):u.p2c(v,l),!i(W[0])||!i(X[0]))return e.warn("Fx.hover failed",b,a),r.unhoverRaw(a,b)}var aW=1/0;function ag(r,t){for(aN=0;aN<U.length;aN++)if((aO=U[aN])&&aO[0]&&aO[0].trace&& !0===(aP=aO[0].trace).visible&&0!==aP._length&& -1===["carpet","contourcarpet"].indexOf(aP._module.name)){if("splom"===aP.type?aQ=p[aR=0]:(aQ=u.getSubplot(aP),aR=p.indexOf(aQ)),aA=g,u.isUnifiedHover(aA)&&(aA=aA.charAt(0)),aU={cd:aO,trace:aP,xa:s[aR],ya:v[aR],maxHoverDistance:ad,maxSpikeDistance:A,index:!1,distance:Math.min(aW,ad),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:q.defaultLine,name:aP.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},c[aQ]&&(aU.subplot=c[aQ]._subplot),c._splomScenes&&c._splomScenes[aP.uid]&&(aU.scene=c._splomScenes[aP.uid]),aV=f.length,"array"===aA){var d=b[aN];"pointNumber"in d?(aU.index=d.pointNumber,aA="closest"):(aA="","xval"in d&&(aS=d.xval,aA="x"),"yval"in d&&(aT=d.yval,aA=aA?"closest":"y"))}else void 0!==r&& void 0!==t?(aS=r,aT=t):(aS=W[aR],aT=X[aR]);if(0!==ad)if(aP._module&&aP._module.hoverPoints){var k,l=aP._module.hoverPoints(aU,aS,aT,aA,{finiteRange:!0,hoverLayer:c._hoverlayer});if(l)for(var m=0;m<l.length;m++)i((k=l[m]).x0)&&i(k.y0)&&f.push(K(k,g))}else e.log("Unrecognized trace type in hover:",aP);if("closest"===g&&f.length>aV&&(f.splice(0,aV),aW=f[0].distance),O&&0!==A&&0===f.length){aU.distance=A,aU.index=!1;var a=aP._module.hoverPoints(aU,aS,aT,"closest",{hoverLayer:c._hoverlayer});if(a&&(a=a.filter(function(a){return a.spikeDistance<=A})),a&&a.length){var h,w=a.filter(function(a){return a.xa.showspikes&&"hovered data"!==a.xa.spikesnap});if(w.length){var n=w[0];i(n.x0)&&i(n.y0)&&(h=ai(n),(!j.vLinePoint||j.vLinePoint.spikeDistance>h.spikeDistance)&&(j.vLinePoint=h))}var x=a.filter(function(a){return a.ya.showspikes&&"hovered data"!==a.ya.spikesnap});if(x.length){var o=x[0];i(o.x0)&&i(o.y0)&&(h=ai(o),(!j.hLinePoint||j.hLinePoint.spikeDistance>h.spikeDistance)&&(j.hLinePoint=h))}}}}}function ah(c,f,g){for(var a,d=null,e=1/0,b=0;b<c.length;b++)a=c[b].spikeDistance,g&&0===b&&(a=-1/0),a<=e&&a<=f&&(d=c[b],e=a);return d}function ai(a){return a?{xa:a.xa,ya:a.ya,x:void 0!==a.xSpike?a.xSpike:(a.x0+a.x1)/2,y:void 0!==a.ySpike?a.ySpike:(a.y0+a.y1)/2,distance:a.distance,spikeDistance:a.spikeDistance,curveNumber:a.trace.index,color:a.color,pointNumber:a.index}:null}ag();var aj={fullLayout:c,container:c._hoverlayer,event:b},ak=a._spikepoints,aB={vLinePoint:j.vLinePoint,hLinePoint:j.hLinePoint};a._spikepoints=aB;var al=function(){f.sort(function(a,b){return a.distance-b.distance}),f=P(f,g)};al();var am=g.charAt(0),an=("x"===am||"y"===am)&&f[0]&&D[f[0].trace.type];if(O&&0!==A&&0!==f.length){var aC=ah(f.filter(function(a){return a.ya.showspikes}),A,an);j.hLinePoint=ai(aC);var aD=ah(f.filter(function(a){return a.xa.showspikes}),A,an);j.vLinePoint=ai(aD)}if(0===f.length){var aE=r.unhoverRaw(a,b);return O&&(null!==j.hLinePoint||null!==j.vLinePoint)&&N(ak)&&L(a,j,aj),aE}if(O&&N(ak)&&L(a,j,aj),u.isXYhover(aA)&&0!==f[0].length&&"splom"!==f[0].trace.type){var n,H=f[0],ao=(f=C[H.trace.type]?f.filter(function(a){return a.trace.index===H.trace.index}):[H]).length,aF=Q("x",H,c),aG=Q("y",H,c);ag(aF,aG);var aH=[],aX={},aY=0,ap=function(a){var b=C[a.trace.type]?E(a):a.trace.index;if(aX[b]){var c=aX[b]-1,d=aH[c];c>0&&Math.abs(a.distance)<Math.abs(d.distance)&&(aH[c]=a)}else aY++,aX[b]=aY,aH.push(a)};for(n=0;n<ao;n++)ap(f[n]);for(n=f.length-1;n>ao-1;n--)ap(f[n]);f=aH,al()}var Y=a._hoverdata,Z=[],aq=R(a),ar=S(a);for(F=0;F<f.length;F++){var d=f[F],$=u.makeEventData(d,d.trace,d.cd);if(!1!==d.hovertemplate){var as=!1;d.cd[d.index]&&d.cd[d.index].ht&&(as=d.cd[d.index].ht),d.hovertemplate=as||d.trace.hovertemplate||!1}if(d.xa&&d.ya){var at=d.x0+d.xa._offset,au=d.x1+d.xa._offset,av=d.y0+d.ya._offset,aw=d.y1+d.ya._offset,aI=Math.min(at,au),aJ=Math.max(at,au),aK=Math.min(av,aw),aL=Math.max(av,aw);$.bbox={x0:aI+ar,x1:aJ+ar,y0:aK+aq,y1:aL+aq}}d.eventData=[$],Z.push($)}a._hoverdata=Z;var _="y"===g&&(U.length>1||f.length>1)||"closest"===g&&V&&f.length>1,ax=G(f,{gd:a,hovermode:g,rotateLabels:_,bgColor:q.combine(c.plot_bgcolor||q.background,c.paper_bgcolor),container:c._hoverlayer,outerContainer:c._paper.node(),commonLabelOpts:c.hoverlabel,hoverdistance:c.hoverdistance});if(u.isUnifiedHover(g)||(I(ax,_?"xa":"ya",c),J(ax,_,c._invScaleX,c._invScaleY)),z&&z.tagName){var aM=t.getComponentMethod("annotations","hasClickToShow")(a,Z);o(h.select(z),aM?"pointer":"")}z&&!ay&&M(a,b,Y)&&(Y&&a.emit("plotly_unhover",{event:b,points:Y}),a.emit("plotly_hover",{event:b,points:a._hoverdata,xaxes:s,yaxes:v,xvals:W,yvals:X}))})(a,c,d,f,g)})},d.loneHover=function(c,a){var e=!0;Array.isArray(c)||(e=!1,c=[c]);var b=a.gd,i=R(b),j=S(b),d=G(c.map(function(c){var e=c._x0||c.x0||c.x||0,f=c._x1||c.x1||c.x||0,g=c._y0||c.y0||c.y||0,h=c._y1||c.y1||c.y||0,d=c.eventData;if(d){var k=Math.min(e,f),l=Math.max(e,f),m=Math.min(g,h),n=Math.max(g,h),o=c.trace;if(t.traceIs(o,"gl3d")){var p=b._fullLayout[o.scene]._scene.container,r=p.offsetLeft,s=p.offsetTop;k+=r,l+=r,m+=s,n+=s}d.bbox={x0:k+j,x1:l+j,y0:m+i,y1:n+i},a.inOut_bbox&&a.inOut_bbox.push(d.bbox)}else d=!1;return{color:c.color||q.defaultLine,x0:c.x0||c.x||0,x1:c.x1||c.x||0,y0:c.y0||c.y||0,y1:c.y1||c.y||0,xLabel:c.xLabel,yLabel:c.yLabel,zLabel:c.zLabel,text:c.text,name:c.name,idealAlign:c.idealAlign,borderColor:c.borderColor,fontFamily:c.fontFamily,fontSize:c.fontSize,fontColor:c.fontColor,nameLength:c.nameLength,textAlign:c.textAlign,trace:c.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:c.hovertemplate||!1,hovertemplateLabels:c.hovertemplateLabels||!1,eventData:d}}),{gd:b,hovermode:"closest",rotateLabels:!1,bgColor:a.bgColor||q.background,container:h.select(a.container),outerContainer:a.outerContainer||a.container}),k=0,l=0;d.sort(function(a,b){return a.y0-b.y0}).each(function(b,d){var c=b.y0-b.by/2;c-5<k?b.offset=k-c+5:b.offset=0,k=c+b.by+b.offset,d===a.anchorIndex&&(l=b.offset)}).each(function(a){a.offset-=l});var f=b._fullLayout._invScaleX,g=b._fullLayout._invScaleY;return J(d,!1,f,g),e?d:d.node()};var F=/<extra>([\s\S]*)<\/extra>/;function G(d,g){var F=g.gd,J=F._fullLayout,z=g.hovermode,aq=g.rotateLabels,ar=g.bgColor,G=g.container,an=g.outerContainer,as=g.commonLabelOpts||{};if(0===d.length)return[[]];var at=g.fontFamily||b.HOVERFONT,au=g.fontSize||b.HOVERFONTSIZE,K=d[0],af=K.xa,ao=K.ya,W=z.charAt(0),ag=W+"Label",I=K[ag];if(void 0===I&&"multicategory"===af.type)for(var X=0;X<d.length&& void 0===(I=d[X][ag]);X++);var Y=T(F,an),av=Y.top,L=Y.width,M=Y.height,N=void 0!==I&&K.distance<=g.hoverdistance&&("x"===z||"y"===z);if(N){var C,O,Z=!0;for(C=0;C<d.length;C++)if(Z&& void 0===d[C].zLabel&&(Z=!1),O=d[C].hoverinfo||d[C].trace.hoverinfo){var ah=Array.isArray(O)?O:O.split("+");if(-1===ah.indexOf("all")&& -1===ah.indexOf(z)){N=!1;break}}Z&&(N=!1)}var $=G.selectAll("g.axistext").data(N?[0]:[]);if($.enter().append("g").classed("axistext",!0),$.exit().remove(),$.each(function(){var i=h.select(this),f=e.ensureSingle(i,"path","",function(a){a.style({"stroke-width":"1px"})}),d=e.ensureSingle(i,"text","",function(a){a.attr("data-notex",1)}),j=as.bgcolor||q.defaultLine,t=as.bordercolor||q.contrast(j),u=q.contrast(j),v={family:as.font.family||at,size:as.font.size||au,color:as.font.color||u};f.style({fill:j,stroke:t}),d.text(I).call(p.font,v).call(n.positionText,0,0).call(n.convertToTspans,F),i.attr("transform","");var a=T(F,d.node());if("x"===z){var c="top"===af.side?"-":"";d.attr("text-anchor","middle").call(n.positionText,0,"top"===af.side?av-a.bottom-A-B:av-a.top+A+B),l=af._offset+(K.x0+K.x1)/2,w=ao._offset+("top"===af.side?0:ao._length);var b=a.width/2+B;l<b?(l=b,f.attr("d","M-"+(b-A)+",0L-"+(b-2*A)+","+c+A+"H"+(B+a.width/2)+"v"+c+(2*B+a.height)+"H-"+b+"V"+c+A+"Z")):l>J.width-b?(l=J.width-b,f.attr("d","M"+(b-A)+",0L"+b+","+c+A+"v"+c+(2*B+a.height)+"H-"+b+"V"+c+A+"H"+(b-2*A)+"Z")):f.attr("d","M0,0L"+A+","+c+A+"H"+(B+a.width/2)+"v"+c+(2*B+a.height)+"H-"+(B+a.width/2)+"V"+c+A+"H-"+A+"Z")}else{"right"===ao.side?(x="start",y=1,D="",l=af._offset+af._length):(x="end",y=-1,D="-",l=af._offset),w=ao._offset+(K.y0+K.y1)/2,d.attr("text-anchor",x),f.attr("d","M0,0L"+D+A+","+A+"V"+(B+a.height/2)+"h"+D+(2*B+a.width)+"V-"+(B+a.height/2)+"H"+D+A+"V-"+A+"Z");var l,w,x,y,D,g,m=a.height/2,s=av-a.top-m,o="clip"+J._uid+"commonlabel"+ao._id;if(l<a.width+2*B+A){g="M-"+(A+B)+"-"+m+"h-"+(a.width-B)+"V"+m+"h"+(a.width-B)+"Z";var C=a.width-l+B;n.positionText(d,C,s),"end"===x&&d.selectAll("tspan").each(function(){var b=h.select(this),c=p.tester.append("text").text(b.text()).call(p.font,v),d=T(F,c.node());Math.round(d.width)<Math.round(a.width)&&b.attr("x",C-d.width),c.remove()})}else n.positionText(d,y*(B+A),s),g=null;var r=J._topclips.selectAll("#"+o).data(g?[0]:[]);r.enter().append("clipPath").attr("id",o).append("path"),r.exit().remove(),r.select("path").attr("d",g),p.setClipUrl(d,g?o:null,F)}i.attr("transform",k(l,w))}),u.isUnifiedHover(z)){G.selectAll("g.hovertext").remove();var j,m,o,r,_,aa,i=d.filter(function(a){return"none"!==a.hoverinfo});if(0===i.length)return;var P=J.hoverlabel,ab=P.font,ap={showlegend:!0,legend:{title:{text:I,font:ab},font:ab,bgcolor:P.bgcolor,bordercolor:P.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:J.legend?J.legend.traceorder:void 0,orientation:"v"}},ai={font:ab};v(ap,ai,F._fullData);var s=ai.legend;s.entries=[];for(var ac=0;ac<i.length;ac++){var a=i[ac];if("none"!==a.hoverinfo){var aj=H(a,!0,z,J,I),ak=aj[0],ad=aj[1];a.name=ad,""!==ad?a.text=ad+" : "+ak:a.text=ak;var c=a.cd[a.index];c&&(c.mc&&(a.mc=c.mc),c.mcc&&(a.mc=c.mcc),c.mlc&&(a.mlc=c.mlc),c.mlcc&&(a.mlc=c.mlcc),c.mlw&&(a.mlw=c.mlw),c.mrc&&(a.mrc=c.mrc),c.dir&&(a.dir=c.dir)),a._distinct=!0,s.entries.push([a])}}s.entries.sort(function(a,b){return a[0].trace.index-b[0].trace.index}),s.layer=G,s._inHover=!0,s._groupTitleFont=P.grouptitlefont,w(F,s);var ae=G.select("g.legend"),al=T(F,ae.node()),x=al.width+2*B,y=al.height+2*B,D=i[0],Q=(D.x0+D.x1)/2,R=(D.y0+D.y1)/2,am=!(t.traceIs(D.trace,"bar-like")||t.traceIs(D.trace,"box-violin"));"y"===W?am?(m=R-B,j=R+B):(m=Math.min.apply(null,i.map(function(a){return Math.min(a.y0,a.y1)})),j=Math.max.apply(null,i.map(function(a){return Math.max(a.y0,a.y1)}))):m=j=e.mean(i.map(function(a){return(a.y0+a.y1)/2}))-y/2,"x"===W?am?(o=Q+B,r=Q-B):(o=Math.max.apply(null,i.map(function(a){return Math.max(a.x0,a.x1)})),r=Math.min.apply(null,i.map(function(a){return Math.min(a.x0,a.x1)}))):o=r=e.mean(i.map(function(a){return(a.x0+a.x1)/2}))-x/2;var S=af._offset,U=ao._offset;return j+=U,o+=S,r+=S-x,m+=U-y,_=o+x<L&&o>=0?o:r+x<L&&r>=0?r:S+x<L?S:o-Q<Q-r+x?L-x:0,_+=B,aa=j+y<M&&j>=0?j:m+y<M&&m>=0?m:U+y<M?U:j-R<R-m+y?M-y:0,aa+=B,ae.attr("transform",k(_-1,aa-1)),ae}var V=G.selectAll("g.hovertext").data(d,function(a){return E(a)});return V.enter().append("g").classed("hovertext",!0).each(function(){var a=h.select(this);a.append("rect").call(q.fill,q.addOpacity(ar,.8)),a.append("text").classed("name",!0),a.append("path").style("stroke-width","1px"),a.append("text").classed("nums",!0).call(p.font,at,au)}),V.exit().remove(),V.each(function(a){var c,j,d=h.select(this).attr("transform",""),e=a.color;Array.isArray(e)&&(e=e[a.eventData[0].pointNumber]);var w=a.bgcolor||e,x=q.combine(q.opacity(w)?w:q.defaultLine,ar),R=q.combine(q.opacity(e)?e:q.defaultLine,ar),y=a.borderColor||q.contrast(x),C=H(a,N,z,J,I,d),D=C[0],t=C[1],E=d.select("text.nums").call(p.font,a.fontFamily||at,a.fontSize||au,a.fontColor||y).text(D).attr("data-notex",1).call(n.positionText,0,0).call(n.convertToTspans,F),m=d.select("text.name"),o=0,G=0;if(t&&t!==D){m.call(p.font,a.fontFamily||at,a.fontSize||au,R).text(t).attr("data-notex",1).call(n.positionText,0,0).call(n.convertToTspans,F);var K=T(F,m.node());o=K.width+2*B,G=K.height+2*B}else m.remove(),d.select("rect").remove();d.select("path").style({fill:x,stroke:y});var b=a.xa._offset+(a.x0+a.x1)/2,g=a.ya._offset+(a.y0+a.y1)/2,r=Math.abs(a.x1-a.x0),s=Math.abs(a.y1-a.y0),u=T(F,E.node()),v=u.width/J._invScaleX,S=u.height/J._invScaleY;a.ty0=(av-u.top)/J._invScaleY,a.bx=v+2*B,a.by=Math.max(S+2*B,G),a.anchor="start",a.txwidth=v,a.tx2width=o,a.offset=0;var i=(v+A+B+o)*J._invScaleX;if(aq)a.pos=b,c=g+s/2+i<=M,j=g-s/2-i>=0,("top"===a.idealAlign||!c)&&j?(g-=s/2,a.anchor="end"):c?(g+=s/2,a.anchor="start"):a.anchor="middle";else if(a.pos=g,c=b+r/2+i<=L,j=b-r/2-i>=0,("left"===a.idealAlign||!c)&&j)b-=r/2,a.anchor="end";else if(c)b+=r/2,a.anchor="start";else{a.anchor="middle";var O=i/2,P=b+O-L,Q=b-O;P>0&&(b-=P),Q<0&&(b+=-Q)}E.attr("text-anchor",a.anchor),o&&m.attr("text-anchor",a.anchor),d.attr("transform",k(b,g)+(aq?l(f):""))}),V}function H(a,j,k,l,g,h){var f="",b="";void 0!==a.nameOverride&&(a.name=a.nameOverride),a.name&&(a.trace._meta&&(a.name=e.templateString(a.name,a.trace._meta)),f=O(a.name,a.nameLength));var c=k.charAt(0);void 0!==a.zLabel?(void 0!==a.xLabel&&(b+="x: "+a.xLabel+"<br>"),void 0!==a.yLabel&&(b+="y: "+a.yLabel+"<br>"),"choropleth"!==a.trace.type&&"choroplethmapbox"!==a.trace.type&&(b+=(b?"z: ":"")+a.zLabel)):j&&a[c+"Label"]===g?b=a[("x"===c?"y":"x")+"Label"]||"":void 0===a.xLabel?void 0!==a.yLabel&&"scattercarpet"!==a.trace.type&&(b=a.yLabel):b=void 0===a.yLabel?a.xLabel:"("+a.xLabel+", "+a.yLabel+")",(a.text||0===a.text)&&!Array.isArray(a.text)&&(b+=(b?"<br>":"")+a.text),void 0!==a.extraText&&(b+=(b?"<br>":"")+a.extraText),h&&""===b&&!a.hovertemplate&&(""===f&&h.remove(),b=f);var i=a.hovertemplate||!1;if(i){var d=a.hovertemplateLabels||a;a[c+"Label"]!==g&&(d[c+"other"]=d[c+"Val"],d[c+"otherLabel"]=d[c+"Label"]),b=(b=e.hovertemplateString(i,d,l._d3locale,a.eventData[0]||{},a.trace._meta)).replace(F,function(c,b){return f=O(b,a.nameLength),""})}return[b,f]}function I(k,s,t){var h,l,m,b,a,u,i,n=0,v=1,o=k.size(),d=new Array(o),w=0;function r(c){var d=c[0],f=c[c.length-1];if(l=d.pmin-d.pos-d.dp+d.size,m=f.pos+f.dp+f.size-d.pmax,l>.01){for(a=c.length-1;a>=0;a--)c[a].dp+=l;h=!1}if(!(m<.01)){if(l< -0.01){for(a=c.length-1;a>=0;a--)c[a].dp-=m;h=!1}if(h){var e=0;for(b=0;b<c.length;b++)(u=c[b]).pos+u.dp+u.size>d.pmax&&e++;for(b=c.length-1;b>=0&&!(e<=0);b--)(u=c[b]).pos>d.pmax-1&&(u.del=!0,e--);for(b=0;b<c.length&&!(e<=0);b++)if((u=c[b]).pos<d.pmin+1)for(u.del=!0,e--,m=2*u.size,a=c.length-1;a>=0;a--)c[a].dp-=m;for(b=c.length-1;b>=0&&!(e<=0);b--)(u=c[b]).pos+u.dp+u.size>d.pmax&&(u.del=!0,e--)}}}for(k.each(function(a){var e=a[s],b="x"===e._id.charAt(0),c=e.range;0===w&&c&&c[0]>c[1]!==b&&(v=-1),d[w++]=[{datum:a,traceIndex:a.trace.index,dp:0,pos:a.pos,posref:a.posref,size:a.by*(b?x:1)/2,pmin:0,pmax:b?t.width:t.height}]}),d.sort(function(a,b){return a[0].posref-b[0].posref||v*(b[0].traceIndex-a[0].traceIndex)});!h&&n<=o;){for(n++,h=!0,b=0;b<d.length-1;){var c=d[b],g=d[b+1],e=c[c.length-1],f=g[0];if((l=e.pos+e.dp+e.size-f.pos-f.dp+f.size)>.01&&e.pmin===f.pmin&&e.pmax===f.pmax){for(a=g.length-1;a>=0;a--)g[a].dp+=l;for(c.push.apply(c,g),d.splice(b+1,1),i=0,a=c.length-1;a>=0;a--)i+=c[a].dp;for(m=i/c.length,a=c.length-1;a>=0;a--)c[a].dp-=m;h=!1}else b++}d.forEach(r)}for(b=d.length-1;b>=0;b--){var p=d[b];for(a=p.length-1;a>=0;a--){var j=p[a],q=j.datum;q.offset=j.dp,q.del=j.del}}}function J(a,b,c,d){var e=function(a){return a*c},f=function(a){return a*d};a.each(function(a){var g=h.select(this);if(a.del)return g.remove();var l=g.select("text.nums"),i=a.anchor,m="end"===i?-1:1,j={start:1,end:-1,middle:0}[i],o=j*(A+B),q=o+j*(a.txwidth+B),d=0,c=a.offset,k="middle"===i;k&&(o-=a.tx2width/2,q+=a.txwidth/2+B),b&&(c*=-z,d=a.offset*y),g.select("path").attr("d",k?"M-"+e(a.bx/2+a.tx2width/2)+","+f(c-a.by/2)+"h"+e(a.bx)+"v"+f(a.by)+"h-"+e(a.bx)+"Z":"M0,0L"+e(m*A+d)+","+f(A+c)+"v"+f(a.by/2-A)+"h"+e(m*a.bx)+"v-"+f(a.by)+"H"+e(m*A+d)+"V"+f(c-A)+"Z");var r=d+o,t=c+a.ty0-a.by/2+B,s=a.textAlign||"auto";"auto"!==s&&("left"===s&&"start"!==i?(l.attr("text-anchor","start"),r=k?-a.bx/2-a.tx2width/2+B:-a.bx-B):"right"===s&&"end"!==i&&(l.attr("text-anchor","end"),r=k?a.bx/2-a.tx2width/2-B:a.bx+B)),l.call(n.positionText,e(r),f(t)),a.tx2width&&(g.select("text.name").call(n.positionText,e(q+j*B+d),f(c+a.ty0-a.by/2+B)),g.select("rect").call(p.setRect,e(q+(j-1)*a.tx2width/2+d),f(c-a.by/2-1),e(a.tx2width),f(a.by+2)))})}function K(a,d){var g=a.index,f=a.trace||{},k=a.cd[0],l=a.cd[g]||{};function m(a){return a||i(a)&&0===a}var n=Array.isArray(g)?function(b,c){var a=e.castOption(k,g,b);return m(a)?a:e.extractOption({},f,"",c)}:function(a,b){return e.extractOption(l,f,a,b)};function c(c,d,e){var b=n(d,e);m(b)&&(a[c]=b)}if(c("hoverinfo","hi","hoverinfo"),c("bgcolor","hbg","hoverlabel.bgcolor"),c("borderColor","hbc","hoverlabel.bordercolor"),c("fontFamily","htf","hoverlabel.font.family"),c("fontSize","hts","hoverlabel.font.size"),c("fontColor","htc","hoverlabel.font.color"),c("nameLength","hnl","hoverlabel.namelength"),c("textAlign","hta","hoverlabel.align"),a.posref="y"===d||"closest"===d&&"h"===f.orientation?a.xa._offset+(a.x0+a.x1)/2:a.ya._offset+(a.y0+a.y1)/2,a.x0=e.constrain(a.x0,0,a.xa._length),a.x1=e.constrain(a.x1,0,a.xa._length),a.y0=e.constrain(a.y0,0,a.ya._length),a.y1=e.constrain(a.y1,0,a.ya._length),void 0!==a.xLabelVal&&(a.xLabel="xLabel"in a?a.xLabel:s.hoverLabelText(a.xa,a.xLabelVal,f.xhoverformat),a.xVal=a.xa.c2d(a.xLabelVal)),void 0!==a.yLabelVal&&(a.yLabel="yLabel"in a?a.yLabel:s.hoverLabelText(a.ya,a.yLabelVal,f.yhoverformat),a.yVal=a.ya.c2d(a.yLabelVal)),void 0!==a.zLabelVal&& void 0===a.zLabel&&(a.zLabel=String(a.zLabelVal)),!isNaN(a.xerr)&&!("log"===a.xa.type&&a.xerr<=0)){var h=s.tickText(a.xa,a.xa.c2l(a.xerr),"hover").text;void 0!==a.xerrneg?a.xLabel+=" +"+h+" / -"+s.tickText(a.xa,a.xa.c2l(a.xerrneg),"hover").text:a.xLabel+=" \xb1 "+h,"x"===d&&(a.distance+=1)}if(!isNaN(a.yerr)&&!("log"===a.ya.type&&a.yerr<=0)){var j=s.tickText(a.ya,a.ya.c2l(a.yerr),"hover").text;void 0!==a.yerrneg?a.yLabel+=" +"+j+" / -"+s.tickText(a.ya,a.ya.c2l(a.yerrneg),"hover").text:a.yLabel+=" \xb1 "+j,"y"===d&&(a.distance+=1)}var b=a.hoverinfo||a.trace.hoverinfo;return b&&"all"!==b&&(-1===(b=Array.isArray(b)?b:b.split("+")).indexOf("x")&&(a.xLabel=void 0),-1===b.indexOf("y")&&(a.yLabel=void 0),-1===b.indexOf("z")&&(a.zLabel=void 0),-1===b.indexOf("text")&&(a.text=void 0),-1===b.indexOf("name")&&(a.name=void 0)),a}function L(F,o,x){var f=x.container,y=x.fullLayout,c=y._size,r=x.event,G=!!o.hLinePoint,H=!!o.vLinePoint;if(f.selectAll(".spikeline").remove(),H||G){var i=q.combine(y.plot_bgcolor,y.paper_bgcolor);if(G){var a,b,z,g,t,u,d=o.hLinePoint;a=d&&d.xa,"cursor"===(b=d&&d.ya).spikesnap?(z=r.pointerX,g=r.pointerY):(z=a._offset+d.x,g=b._offset+d.y);var M=1.5>j.readability(d.color,i)?q.contrast(i):d.color,m=b.spikemode,k=b.spikethickness,I=b.spikecolor||M,J=s.getPxPosition(F,b);if(-1!==m.indexOf("toaxis")|| -1!==m.indexOf("across")){if(-1!==m.indexOf("toaxis")&&(t=J,u=z),-1!==m.indexOf("across")){var A=b._counterDomainMin,B=b._counterDomainMax;"free"===b.anchor&&(A=Math.min(A,b.position),B=Math.max(B,b.position)),t=c.l+A*c.w,u=c.l+B*c.w}f.insert("line",":first-child").attr({x1:t,x2:u,y1:g,y2:g,"stroke-width":k,stroke:I,"stroke-dasharray":p.dashStyle(b.spikedash,k)}).classed("spikeline",!0).classed("crisp",!0),f.insert("line",":first-child").attr({x1:t,x2:u,y1:g,y2:g,"stroke-width":k+2,stroke:i}).classed("spikeline",!0).classed("crisp",!0)}-1!==m.indexOf("marker")&&f.insert("circle",":first-child").attr({cx:J+("right"!==b.side?k:-k),cy:g,r:k,fill:I}).classed("spikeline",!0)}if(H){var h,C,v,w,e=o.vLinePoint;a=e&&e.xa,b=e&&e.ya,"cursor"===a.spikesnap?(h=r.pointerX,C=r.pointerY):(h=a._offset+e.x,C=b._offset+e.y);var N=1.5>j.readability(e.color,i)?q.contrast(i):e.color,n=a.spikemode,l=a.spikethickness,K=a.spikecolor||N,L=s.getPxPosition(F,a);if(-1!==n.indexOf("toaxis")|| -1!==n.indexOf("across")){if(-1!==n.indexOf("toaxis")&&(v=L,w=C),-1!==n.indexOf("across")){var D=a._counterDomainMin,E=a._counterDomainMax;"free"===a.anchor&&(D=Math.min(D,a.position),E=Math.max(E,a.position)),v=c.t+(1-E)*c.h,w=c.t+(1-D)*c.h}f.insert("line",":first-child").attr({x1:h,x2:h,y1:v,y2:w,"stroke-width":l,stroke:K,"stroke-dasharray":p.dashStyle(a.spikedash,l)}).classed("spikeline",!0).classed("crisp",!0),f.insert("line",":first-child").attr({x1:h,x2:h,y1:v,y2:w,"stroke-width":l+2,stroke:i}).classed("spikeline",!0).classed("crisp",!0)}-1!==n.indexOf("marker")&&f.insert("circle",":first-child").attr({cx:h,cy:L-("top"!==a.side?l:-l),r:l,fill:K}).classed("spikeline",!0)}}}function M(e,f,a){if(!a||a.length!==e._hoverdata.length)return!0;for(var b=a.length-1;b>=0;b--){var c=a[b],d=e._hoverdata[b];if(c.curveNumber!==d.curveNumber||String(c.pointNumber)!==String(d.pointNumber)||String(c.pointNumbers)!==String(d.pointNumbers))return!0}return!1}function N(b,a){return!a||a.vLinePoint!==b._spikepoints.vLinePoint||a.hLinePoint!==b._spikepoints.hLinePoint}function O(a,b){return n.plainText(a||"",{len:b,allowedTags:["br","sub","sup","b","i","em"]})}function P(c,g){for(var h=g.charAt(0),d=[],e=[],f=[],b=0;b<c.length;b++){var a=c[b];t.traceIs(a.trace,"bar-like")||t.traceIs(a.trace,"box-violin")?f.push(a):a.trace[h+"period"]?e.push(a):d.push(a)}return d.concat(e).concat(f)}function Q(b,c,j){var d=c[b+"a"],a=c[b+"Val"],e=c.cd[0];if("category"===d.type||"multicategory"===d.type)a=d._categoriesMap[a];else if("date"===d.type){var g=c.trace[b+"periodalignment"];if(g){var f=c.cd[c.index],h=f[b+"Start"];void 0===h&&(h=f[b]);var i=f[b+"End"];void 0===i&&(i=f[b]);var k=i-h;"end"===g?a+=k:"middle"===g&&(a+=k/2)}a=d.d2c(a)}return e&&e.t&&e.t.posLetter===d._id&&("group"===j.boxmode||"group"===j.violinmode)&&(a+=e.t.dPos),a}function R(a){return a.offsetTop+a.clientTop}function S(a){return a.offsetLeft+a.clientLeft}function T(l,m){var g=l._fullLayout,a=m.getBoundingClientRect(),h=a.x,i=a.y,n=h+a.width,o=i+a.height,j=e.apply3DTransform(g._invTransform)(h,i),k=e.apply3DTransform(g._invTransform)(n,o),b=j[0],c=j[1],d=k[0],f=k[1];return{x:b,y:c,width:d-b,height:f-c,top:Math.min(c,f),left:Math.min(b,d),right:Math.max(b,d),bottom:Math.max(c,f)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../color"),f=a("./helpers").isUnifiedHover;b.exports=function(i,b,c,a){a=a||{};var h=b.legend;function g(c){a.font[c]||(a.font[c]=h?b.legend.font[c]:b.font[c])}b&&f(b.hovermode)&&(a.font||(a.font={}),g("size"),g("family"),g("color"),h?(a.bgcolor||(a.bgcolor=e.combine(b.legend.bgcolor,b.paper_bgcolor)),a.bordercolor||(a.bordercolor=b.legend.bordercolor)):a.bgcolor||(a.bgcolor=b.paper_bgcolor)),c("hoverlabel.bgcolor",a.bgcolor),c("hoverlabel.bordercolor",a.bordercolor),c("hoverlabel.namelength",a.namelength),d.coerceFont(c,"hoverlabel.font",a.font),c("hoverlabel.align",a.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(b,c){function a(a,f){return void 0!==c[a]?c[a]:d.coerce(b,c,e,a,f)}return a("clickmode"),a("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(a,e,g){"use strict";var h=a("@plotly/d3"),i=a("../../lib"),f=a("../dragelement"),b=a("./helpers"),c=a("./layout_attributes"),d=a("./hover");e.exports={moduleType:"component",name:"fx",constants:a("./constants"),schema:{layout:c},attributes:a("./attributes"),layoutAttributes:c,supplyLayoutGlobalDefaults:a("./layout_global_defaults"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),getDistanceFunction:b.getDistanceFunction,getClosest:b.getClosest,inbox:b.inbox,quadrature:b.quadrature,appendArrayPointValue:b.appendArrayPointValue,castHoverOption:function(a,b,c){return i.castOption(a,b,"hoverlabel."+c)},castHoverinfo:function(a,c,b){return i.castOption(a,b,"hoverinfo",function(b){return i.coerceHoverinfo({hoverinfo:b},{_module:a._module},c)})},hover:d.hover,unhover:f.unhover,loneHover:d.loneHover,loneUnhover:function(a){var b=i.isD3Selection(a)?a:h.select(a);b.selectAll("g.hovertext").remove(),b.selectAll(".spikeline").remove()},click:a("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(b,e,f){"use strict";var c=b("./constants"),d=b("../../plots/font_attributes"),a=d({editType:"none"});a.family.dflt=c.HOVERFONT,a.size.dflt=c.HOVERFONTSIZE,e.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:a,grouptitlefont:d({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes"),f=a("./hovermode_defaults"),g=a("./hoverlabel_defaults");b.exports=function(c,a){function b(b,f){return d.coerce(c,a,e,b,f)}f(c,a)&&(b("hoverdistance"),b("spikedistance")),"select"===b("dragmode")&&b("selectdirection");var h=a._has("mapbox"),i=a._has("geo"),j=a._basePlotModules.length;"zoom"===a.dragmode&&((h||i)&&1===j||h&&i&&2===j)&&(a.dragmode="pan"),g(c,a,b),d.coerceFont(b,"hoverlabel.grouptitlefont",a.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./hoverlabel_defaults"),f=a("./layout_attributes");b.exports=function(a,b){e(a,b,function(c,e){return d.coerce(a,b,f,c,e)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(a,d,g){"use strict";var h=a("../../lib"),e=a("../../lib/regex").counter,f=a("../../plots/domain").attributes,b=a("../../plots/cartesian/constants").idRegex,i=a("../../plot_api/plot_template"),c={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[e("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[b.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[b.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:f({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function j(d,e,a){var b=e[a+"axes"],c=Object.keys((d._splomAxes||{})[a]||{});return Array.isArray(b)?b:c.length?c:void 0}function k(c,d,k,l,b,m){var e=d(c+"gap",k),f=d("domain."+c);d(c+"side",l);for(var g=new Array(b),h=f[0],i=(f[1]-h)/(b-e),n=i*(1-e),a=0;a<b;a++){var j=h+i*a;g[m?b-1-a:a]=[j,j+n]}return g}function l(d,g,b,h,e){var a,f=new Array(b);function c(b,a){-1!==g.indexOf(a)&& void 0===h[a]?(f[b]=a,h[a]=b):f[b]=""}if(Array.isArray(d))for(a=0;a<b;a++)c(a,d[a]);else for(c(0,e),a=1;a<b;a++)c(a,e+(a+1));return f}d.exports={moduleType:"component",name:"grid",schema:{layout:{grid:c}},layoutAttributes:c,sizeDefaults:function(o,b){var g,l,p,q,a=o.grid||{},e=j(b,a,"x"),f=j(b,a,"y");if(o.grid||e||f){var d=Array.isArray(a.subplots)&&Array.isArray(a.subplots[0]),m=Array.isArray(e),n=Array.isArray(f),u=m&&e!==a.xaxes&&n&&f!==a.yaxes;d?(g=a.subplots.length,l=a.subplots[0].length):(n&&(g=f.length),m&&(l=e.length));var r=i.newContainer(b,"grid"),s=y("rows",g),t=y("columns",l);if(!(s*t>1)){delete b.grid;return}d||m||n||"independent"!==y("pattern")||(d=!0),r._hasSubplotGrid=d;var v="top to bottom"===y("roworder"),w=d?.2:.1,x=d?.3:.1;u&&b._splomGridDflt&&(p=b._splomGridDflt.xside,q=b._splomGridDflt.yside),r._domains={x:k("x",y,w,p,t),y:k("y",y,x,q,s,v)}}function y(b,d){return h.coerce(a,r,c,b,d)}},contentDefaults:function(z,p){var b=p.grid;if(b&&b._domains){var r=z.grid||{},k=p._subplots,s=b._hasSubplotGrid,m=b.rows,n=b.columns,A="independent"===b.pattern,d=b._axisMap={};if(s){var B=r.subplots||[];x=b.subplots=new Array(m);var q=1;for(a=0;a<m;a++){var w=x[a]=new Array(n),C=B[a]||[];for(I=0;I<n;I++)if(A?(e=1===q?"xy":"x"+q+"y"+q,q++):e=C[I],w[I]="",-1!==k.cartesian.indexOf(e)){if(i=e.indexOf("y"),t=e.slice(0,i),u=e.slice(i),void 0!==d[t]&&d[t]!==I|| void 0!==d[u]&&d[u]!==a)continue;w[I]=e,d[t]=I,d[u]=a}}}else{var D=j(p,r,"x"),E=j(p,r,"y");b.xaxes=l(D,k.xaxis,n,d,"x"),b.yaxes=l(E,k.yaxis,m,d,"y")}var o=b._anchors={},F="top to bottom"===b.roworder;for(var c in d){var a,I,t,u,e,x,i,f,g,h,y=c.charAt(0),v=b[y+"side"];if(v.length<8)o[c]="free";else if("x"===y){if("t"===v.charAt(0)===F?(f=0,g=1,h=m):(f=m-1,g=-1,h=-1),s){var G=d[c];for(a=f;a!==h;a+=g)if((e=x[a][G])&&(i=e.indexOf("y"),e.slice(0,i)===c)){o[c]=e.slice(i);break}}else for(a=f;a!==h;a+=g)if(u=b.yaxes[a],-1!==k.cartesian.indexOf(c+u)){o[c]=u;break}}else if("l"===v.charAt(0)?(f=0,g=1,h=n):(f=n-1,g=-1,h=-1),s){var H=d[c];for(a=f;a!==h;a+=g)if((e=x[H][a])&&(i=e.indexOf("y"),e.slice(i)===c)){o[c]=e.slice(0,i);break}}else for(a=f;a!==h;a+=g)if(t=b.xaxes[a],-1!==k.cartesian.indexOf(t+c)){o[c]=t;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(a,c,e){"use strict";var b=a("../../plots/cartesian/constants"),d=a("../../plot_api/plot_template").templatedArray;a("../../constants/axis_placeable_objects"),c.exports=d("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",b.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",b.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib/to_log_range");b.exports=function(q,a,l,m){a=a||{};var g,i,n="log"===l&&"linear"===a.type,r="linear"===l&&"log"===a.type;if(n||r){for(var o=q._fullLayout.images,c=a._id.charAt(0),h=0;h<o.length;h++)if(g=o[h],i="images["+h+"].",g[c+"ref"]===a._id){var p=g[c],j=g["size"+c],f=null,b=null;if(n){var k=j/Math.pow(10,f=e(p,a.range))/2;b=2*Math.log(k+Math.sqrt(1+k*k))/Math.LN10}else b=(f=Math.pow(10,p))*(Math.pow(10,j/2)-Math.pow(10,-j/2));d(f)?d(b)||(b=null):(f=null,b=null),m(i+c,f),m(i+"size"+c,b)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../../plots/array_container_defaults"),g=a("./attributes");function h(j,b,k){function a(a,c){return d.coerce(j,b,g,a,c)}var l=a("source"),m=a("visible",!!l);if(!m)return b;a("layer"),a("xanchor"),a("yanchor"),a("sizex"),a("sizey"),a("sizing"),a("opacity");for(var c={_fullLayout:k},n=["x","y"],f=0;f<2;f++){var i=n[f],h=e.coerceRef(j,b,c,i,"paper",void 0);"paper"!==h&&e.getFromId(c,h)._imgIndices.push(b._index),e.coercePosition(b,c,a,h,i,0)}return b}b.exports=function(a,b){f(a,b,{name:"images",handleItemDefaults:h})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../drawing"),f=a("../../plots/cartesian/axes"),g=a("../../plots/cartesian/axis_ids"),h=a("../../constants/xmlns_namespaces");b.exports=function(s){var b,c,i=s._fullLayout,p=[],j={},k=[];for(c=0;c<i.images.length;c++){var a=i.images[c];if(a.visible)if("below"===a.layer&&"paper"!==a.xref&&"paper"!==a.yref){b=g.ref2id(a.xref)+g.ref2id(a.yref);var l=i._plots[b];if(!l){k.push(a);continue}l.mainplot&&(b=l.mainplot.id),j[b]||(j[b]=[]),j[b].push(a)}else"above"===a.layer?p.push(a):k.push(a)}var t={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-0.5},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-0.5},bottom:{sizing:"YMax",offset:-1}}};function u(a){var b=d.select(this);if(this._imgSrc!==a.source)if(b.attr("xmlns",h.svg),a.source&&"data:"===a.source.slice(0,5))b.attr("xlink:href",a.source),this._imgSrc=a.source;else{var c=new Promise((function(e){var c=new Image;function d(){b.remove(),e()}this.img=c,c.setAttribute("crossOrigin","anonymous"),c.onerror=d,c.onload=function(){var a=document.createElement("canvas");a.width=this.width,a.height=this.height,a.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var c=a.toDataURL("image/png");b.attr("xlink:href",c),e()},b.on("error",d),c.src=a.source,this._imgSrc=a.source}).bind(this));s._promises.push(c)}}function v(a){var h,j,k,l,n=d.select(this),b=f.getFromId(s,a.xref),c=f.getFromId(s,a.yref),o="domain"===f.getRefType(a.xref),p="domain"===f.getRefType(a.yref),g=i._size;h=void 0!==b?"string"==typeof a.xref&&o?b._length*a.sizex:Math.abs(b.l2p(a.sizex)-b.l2p(0)):a.sizex*g.w,j=void 0!==c?"string"==typeof a.yref&&p?c._length*a.sizey:Math.abs(c.l2p(a.sizey)-c.l2p(0)):a.sizey*g.h;var r=h*t.x[a.xanchor].offset,u=j*t.y[a.yanchor].offset,m=t.x[a.xanchor].sizing+t.y[a.yanchor].sizing;switch(k=void 0!==b?"string"==typeof a.xref&&o?b._length*a.x+b._offset:b.r2p(a.x)+b._offset:a.x*g.w+g.l,k+=r,l=void 0!==c?"string"==typeof a.yref&&p?c._length*(1-a.y)+c._offset:c.r2p(a.y)+c._offset:g.h-a.y*g.h+g.t,l+=u,a.sizing){case"fill":m+=" slice";break;case"stretch":m="none";break}n.attr({x:k,y:l,width:h,height:j,preserveAspectRatio:m,opacity:a.opacity});var q=(b&&"domain"!==f.getRefType(a.xref)?b._id:"")+(c&&"domain"!==f.getRefType(a.yref)?c._id:"");e.setClipUrl(n,q?"clip"+i._uid+q:null,s)}var m=i._imageLowerLayer.selectAll("image").data(k),n=i._imageUpperLayer.selectAll("image").data(p);m.enter().append("image"),n.enter().append("image"),m.exit().remove(),n.exit().remove(),m.each(function(a){u.bind(this)(a),v.bind(this)(a)}),n.each(function(a){u.bind(this)(a),v.bind(this)(a)});var q=Object.keys(i._plots);for(c=0;c<q.length;c++){b=q[c];var r=i._plots[b];if(r.imagelayer){var o=r.imagelayer.selectAll("image").data(j[b]||[]);o.enter().append("image"),o.exit().remove(),o.each(function(a){u.bind(this)(a),v.bind(this)(a)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"images",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("images"),draw:a("./draw"),convertCoords:a("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(b,c,e){"use strict";var a=b("../../plots/font_attributes"),d=b("../color/attributes");c.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:a({editType:"legend"}),grouptitlefont:a({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:a({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(b,a,c){"use strict";a.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../plot_api/plot_template"),g=a("../../plots/attributes"),h=a("./attributes"),i=a("../../plots/layout_attributes"),j=a("./helpers");b.exports=function(n,c,s){var b,o,l,m,t=n.legend||{},y=f.newContainer(c,"legend");function a(a,b){return e.coerce(t,y,h,a,b)}for(var u=c.font||{},z=e.coerceFont(a,"grouptitlefont",e.extendFlat({},u,{size:Math.round(1.1*u.size)})),p=0,v=!1,k="normal",q=0;q<s.length;q++)(b=s[q]).visible&&((b.showlegend||b._dfltShowLegend&&!(b._module&&b._module.attributes&&b._module.attributes.showlegend&& !1===b._module.attributes.showlegend.dflt))&&(p++,b.showlegend&&(v=!0,(d.traceIs(b,"pie-like")|| !0===b._input.showlegend)&&p++),e.coerceFont(function(a,c){var d=b._input,f=b;return e.coerce(d,f,g,a,c)},"legendgrouptitle.font",z)),(d.traceIs(b,"bar")&&"stack"===c.barmode|| -1!==["tonextx","tonexty"].indexOf(b.fill))&&(k=j.isGrouped({traceorder:k})?"grouped+reversed":"reversed"),void 0!==b.legendgroup&&""!==b.legendgroup&&(k=j.isReversed({traceorder:k})?"reversed+grouped":"grouped"));var r=e.coerce(n,c,i,"showlegend",v&&p>1);if(!1===r&&(c.legend=void 0),(!1!==r||t.uirevision)&&(a("uirevision",c.uirevision),!1!==r)){a("bgcolor",c.paper_bgcolor),a("bordercolor"),a("borderwidth");var w=e.coerceFont(a,"font",c.font),x="h"===a("orientation");if(x?(o=0,d.getComponentMethod("rangeslider","isVisible")(n.xaxis)?(l=1.1,m="bottom"):(l=-0.1,m="top")):(o=1.02,l=1,m="auto"),a("traceorder",k),j.isGrouped(c.legend)&&a("tracegroupgap"),a("entrywidth"),a("entrywidthmode"),a("itemsizing"),a("itemwidth"),a("itemclick"),a("itemdoubleclick"),a("groupclick"),a("x",o),a("xanchor"),a("y",l),a("yanchor",m),a("valign"),e.noneOrAll(t,y,["x","y"]),a("title.text")){a("title.side",x?"left":"top");var A=e.extendFlat({},w,{size:e.bigFont(w.size)});e.coerceFont(a,"title.font",A)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(a,c,d){"use strict";var e=a("@plotly/d3"),f=a("../../lib"),g=a("../../plots/plots"),h=a("../../registry"),i=a("../../lib/events"),j=a("../dragelement"),k=a("../drawing"),l=a("../color"),m=a("../../lib/svg_text_utils"),n=a("./handle_click"),o=a("./constants"),b=a("../../constants/alignment"),p=b.LINE_SPACING,q=b.FROM_TL,r=b.FROM_BR,s=a("./get_legend_data"),t=a("./style"),u=a("./helpers");function v(d,a,e){var b=d[0],f=b.width,g=a.entrywidthmode,c=b.trace.legendwidth||a.entrywidth;return"fraction"===g?a._maxWidth*c:e+(c||f)}function w(a,e,c,f,g){var b=c.data()[0][0].trace,d={event:g,node:c.node(),curveNumber:b.index,expandedIndex:b._expandedIndex,data:a.data,layout:a.layout,frames:a._transitionData._frames,config:a._context,fullData:a._fullData,fullLayout:a._fullLayout};b._group&&(d.group=b._group),h.traceIs(b,"pie-like")&&(d.label=c.datum()[0].label),!1!==i.triggerHandler(a,"plotly_legendclick",d)&&(1===f?e._clickTimeout=setTimeout(function(){a._fullLayout&&n(c,a,f)},a._context.doubleClickDelay):2===f&&(e._clickTimeout&&clearTimeout(e._clickTimeout),a._legendMouseDownTime=0,!1!==i.triggerHandler(a,"plotly_legenddoubleclick",d)&&n(c,a,f)))}function x(d,e,b){var a,j,c=d.data()[0][0],g=c.trace,l=h.traceIs(g,"pie-like"),n=!b._inHover&&e._context.edits.legendText&&!l,p=b._maxNameLength;c.groupTitle?(a=c.groupTitle.text,j=c.groupTitle.font):(j=b.font,b.entries?a=c.text:(a=l?c.label:g.name,g._meta&&(a=f.templateString(a,g._meta))));var i=f.ensureSingle(d,"text","legendtext");i.attr("text-anchor","start").call(k.font,j).text(n?y(a,p):a);var q=b.itemwidth+2*o.itemGap;m.positionText(i,q,0),n?i.call(m.makeEditable,{gd:e,text:a}).call(A,d,e,b).on("edit",function(a){this.text(y(a,p)).call(A,d,e,b);var i=c.trace._fullInput||{},j={};if(h.hasTransform(i,"groupby")){var k=h.getTransformIndices(i,"groupby"),m=k[k.length-1],l=f.keyedContainer(i,"transforms["+m+"].styles","target","value.name");l.set(c.trace._group,a),j=l.constructUpdate()}else j.name=a;return h.call("_guiRestyle",e,j,g.index)}):A(i,d,e,b)}function y(a,d){var b=Math.max(4,d);if(a&&a.trim().length>=b/2)return a;a=a||"";for(var c=b-a.length;c>0;c--)a+=" ";return a}function z(c,a){var d,g=a._context.doubleClickDelay,h=1,b=f.ensureSingle(c,"rect","legendtoggle",function(b){a._context.staticPlot||b.style("cursor","pointer").attr("pointer-events","all"),b.call(l.fill,"rgba(0,0,0,0)")});a._context.staticPlot||(b.on("mousedown",function(){(d=new Date().getTime())-a._legendMouseDownTime<g?h+=1:(h=1,a._legendMouseDownTime=d)}),b.on("mouseup",function(){if(!a._dragged&&!a._editing){var b=a._fullLayout.legend;new Date().getTime()-a._legendMouseDownTime>g&&(h=Math.max(h-1,1)),w(a,b,c,h,e.event)}}))}function A(a,d,b,c,e){c._inHover&&a.attr("data-notex",!0),m.convertToTspans(a,b,function(){B(d,b,c,e)})}function B(f,t,a,e){var c,d,b=f.data()[0][0];if(!a._inHover&&b&&!b.trace.showlegend){f.remove();return}var j=f.select("g[class*=math-group]"),l=j.node();a||(a=t._fullLayout.legend);var g=a.borderwidth,h=(1===e?a.title.font:b.groupTitle?b.groupTitle.font:a.font).size*p;if(l){var n=k.bBox(l);c=n.height,d=n.width,1===e?k.setTranslate(j,g,g+.75*c):k.setTranslate(j,0,.25*c)}else{var i=f.select(1===e?".legendtitletext":".legendtext"),q=m.lineCount(i),r=i.node();if(c=h*q,d=r?k.bBox(r).width:0,1===e)"left"===a.title.side&&(d+=2*o.itemGap),m.positionText(i,g+o.titlePad,g+h);else{var s=2*o.itemGap+a.itemwidth;b.groupTitle&&(s=o.itemGap,d-=a.itemwidth),m.positionText(i,s,-h*((q-1)/2-.3))}}1===e?(a._titleWidth=d,a._titleHeight=c):(b.lineHeight=h,b.height=Math.max(c,16)+3,b.width=d)}function C(a){return f.isRightAnchor(a)?"right":f.isCenterAnchor(a)?"center":"left"}function D(a){return f.isBottomAnchor(a)?"bottom":f.isMiddleAnchor(a)?"middle":"top"}c.exports=function(b,a){return a||(a=b._fullLayout.legend||{}),function(b,a){var d,i,c=b._fullLayout,n="legend"+c._uid,p=a._inHover;if(p?(d=a.layer,n+="-hover"):d=c._infolayer,d){if(b._legendMouseDownTime||(b._legendMouseDownTime=0),p){if(!a.entries)return;i=s(a.entries,a)}else{if(!b.calcdata)return;i=c.showlegend&&s(b.calcdata,a)}var I=c.hiddenlabels||[];if(!p&&(!c.showlegend||!i.length))return d.selectAll(".legend").remove(),c._topdefs.select("#"+n).remove(),g.autoMargin(b,"legend");var y=f.ensureSingle(d,"g","legend",function(a){p||a.attr("pointer-events","all")}),J=f.ensureSingleById(c._topdefs,"clipPath",n,function(a){a.append("rect")}),H=f.ensureSingle(y,"rect","bg",function(a){a.attr("shape-rendering","crispEdges")});H.call(l.stroke,a.bordercolor).call(l.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px");var m=f.ensureSingle(y,"g","scrollbox"),B=a.title;if(a._titleWidth=0,a._titleHeight=0,B.text){var G=f.ensureSingle(m,"text","legendtitletext");G.attr("text-anchor","start").call(k.font,B.font).text(B.text),A(G,m,b,a,1)}else m.selectAll(".legendtitletext").remove();var K=f.ensureSingle(y,"rect","scrollbar",function(a){a.attr(o.scrollBarEnterAttrs).call(l.fill,o.scrollBarColor)}),E=m.selectAll("g.groups").data(i);E.enter().append("g").attr("class","groups"),E.exit().remove();var F=E.selectAll("g.traces").data(f.identity);F.enter().append("g").attr("class","traces"),F.exit().remove(),F.style("opacity",function(a){var b=a[0].trace;return h.traceIs(b,"pie-like")?-1!==I.indexOf(a[0].label)?.5:1:"legendonly"===b.visible?.5:1}).each(function(){e.select(this).call(x,b,a)}).call(t,b,a).each(function(){p||e.select(this).call(z,b)}),f.syncOrAsync([g.previousPromises,function(){return function(r,s,c,a){var f=r._fullLayout;a||(a=f.legend);var b=f._size,I=u.isVertical(a),t=u.isGrouped(a),S="fraction"===a.entrywidthmode,d=a.borderwidth,g=2*d,h=o.itemGap,l=a.itemwidth+2*h,i=2*(d+h),w=D(a),x=a.y<0||0===a.y&&"top"===w,y=a.y>1||1===a.y&&"bottom"===w,T=a.tracegroupgap,U={};a._maxHeight=Math.max(x||y?f.height/2:b.h,30);var m,n,p,q,z=0;a._width=0,a._height=0;var A=(n=0,p=0,(q=(m=a).title.side)&&(-1!==q.indexOf("left")&&(n=m._titleWidth),-1!==q.indexOf("top")&&(p=m._titleHeight)),[n,p]);if(I)c.each(function(b){var c=b[0].height;k.setTranslate(this,d+A[0],d+A[1]+a._height+c/2+h),a._height+=c,a._width=Math.max(a._width,b[0].width)}),z=l+a._width,a._width+=h+l+g,a._height+=i,t&&(s.each(function(c,b){k.setTranslate(this,0,b*a.tracegroupgap)}),a._height+=(a._lgroupsLength-1)*a.tracegroupgap);else{var j=C(a),J=a.x<0||0===a.x&&"right"===j,K=a.x>1||1===a.x&&"left"===j,B=y||x,E=f.width/2;a._maxWidth=Math.max(J?B&&"left"===j?b.l+b.w:E:K?B&&"right"===j?b.r+b.w:E:b.w,2*l);var V=0,L=0;c.each(function(c){var b=v(c,a,l);V=Math.max(V,b),L+=b}),z=null;var F=0;if(t){var M=0,N=0,O=0;s.each(function(){var f=0,b=0;e.select(this).selectAll("g.traces").each(function(c){var g=v(c,a,l),e=c[0].height;k.setTranslate(this,A[0],A[1]+d+h+e/2+b),b+=e,f=Math.max(f,g),U[c[0].trace.legendgroup]=f});var c=f+h;N>0&&c+d+N>a._maxWidth?(F=Math.max(F,N),N=0,O+=M+T,M=b):M=Math.max(M,b),k.setTranslate(this,N,O),N+=c}),a._width=Math.max(F,N)+d,a._height=O+M+i}else{var P=L+g+(c.size()-1)*h<a._maxWidth,G=0,Q=0,W=0,R=0;c.each(function(c){var e=c[0].height,f=v(c,a,l,t),b=P?f:V;S||(b+=h),b+d+Q-h>=a._maxWidth&&(F=Math.max(F,R),Q=0,W+=G,a._height+=G,G=0),k.setTranslate(this,A[0]+d+Q,A[1]+d+W+e/2+h),R=Q+f+h,Q+=b,G=Math.max(G,e)}),P?(a._width=Q+g,a._height=G+i):(a._width=Math.max(F,R)+g,a._height+=G+i)}}a._width=Math.ceil(Math.max(a._width+A[0],a._titleWidth+2*(d+o.titlePad))),a._height=Math.ceil(Math.max(a._height+A[1],a._titleHeight+2*(d+o.itemGap))),a._effHeight=Math.min(a._height,a._maxHeight);var H=r._context.edits,X=H.legendText||H.legendPosition;c.each(function(b){var i=e.select(this).select(".legendtoggle"),c=b[0].height,d=b[0].trace.legendgroup,f=v(b,a,l);t&&""!==d&&(f=U[d]);var g=X?l:z||f;I||S||(g+=h/2),k.setRect(i,0,-c/2,g,c)})}(b,E,F,a)},function(){var L,M,N,O,t=c._size,i=a.borderwidth;if(!p){if(R=C(Q=(P=b)._fullLayout.legend),S=D(Q),g.autoMargin(P,"legend",{x:Q.x,y:Q.y,l:Q._width*q[R],r:Q._width*r[R],b:Q._effHeight*r[S],t:Q._effHeight*q[S]}))return;var P,Q,R,S,l=t.l+t.w*a.x-q[C(a)]*a._width,s=t.t+t.h*(1-a.y)-q[D(a)]*a._effHeight;if(c.margin.autoexpand){var A=l,B=s;l=f.constrain(l,0,c.width-a._width),s=f.constrain(s,0,c.height-a._effHeight),l!==A&&f.log("Constrain legend.x to make legend fit inside graph"),s!==B&&f.log("Constrain legend.y to make legend fit inside graph")}k.setTranslate(y,l,s)}if(K.on(".drag",null),y.on("wheel",null),p||a._height<=a._maxHeight||b._context.staticPlot){var u=a._effHeight;p&&(u=a._height),H.attr({width:a._width-i,height:u-i,x:i/2,y:i/2}),k.setTranslate(m,0,0),J.select("rect").attr({width:a._width-2*i,height:u-2*i,x:i,y:i}),k.setClipUrl(m,n,b),k.setRect(K,0,0,0,0),delete a._scrollY}else{var T,U,V,v=Math.max(o.scrollBarMinHeight,a._effHeight*a._effHeight/a._height),E=a._effHeight-v-2*o.scrollBarMargin,x=a._height-a._effHeight,F=E/x,z=Math.min(a._scrollY||0,x);H.attr({width:a._width-2*i+o.scrollBarWidth+o.scrollBarMargin,height:a._effHeight-i,x:i/2,y:i/2}),J.select("rect").attr({width:a._width-2*i+o.scrollBarWidth+o.scrollBarMargin,height:a._effHeight-2*i,x:i,y:i+z}),k.setClipUrl(m,n,b),Y(z,v,F),y.on("wheel",function(){Y(z=f.constrain(a._scrollY+e.event.deltaY/E*x,0,x),v,F),0!==z&&z!==x&&e.event.preventDefault()});var W=function(a,b,c){var d=(c-b)/F+a;return f.constrain(d,0,x)},X=function(a,b,c){var d=(b-c)/F+a;return f.constrain(d,0,x)},G=e.behavior.drag().on("dragstart",function(){var a=e.event.sourceEvent;T="touchstart"===a.type?a.changedTouches[0].clientY:a.clientY,V=z}).on("drag",function(){var a=e.event.sourceEvent;2===a.buttons||a.ctrlKey||Y(z=W(V,T,U="touchmove"===a.type?a.changedTouches[0].clientY:a.clientY),v,F)});K.call(G);var I=e.behavior.drag().on("dragstart",function(){var a=e.event.sourceEvent;"touchstart"===a.type&&(T=a.changedTouches[0].clientY,V=z)}).on("drag",function(){var a=e.event.sourceEvent;"touchmove"===a.type&&Y(z=X(V,T,U=a.changedTouches[0].clientY),v,F)});m.call(I)}function Y(c,d,e){a._scrollY=b._fullLayout.legend._scrollY=c,k.setTranslate(m,0,-c),k.setRect(K,a._width,o.scrollBarMargin+c*e,o.scrollBarWidth,d),J.select("rect").attr("y",i+c)}b._context.edits.legendPosition&&(y.classed("cursor-move",!0),j.init({element:y.node(),gd:b,prepFn:function(){var a=k.getTranslate(y);N=a.x,O=a.y},moveFn:function(d,e){var b=N+d,c=O+e;k.setTranslate(y,b,c),L=j.align(b,0,t.l,t.l+t.w,a.xanchor),M=j.align(c,0,t.t+t.h,t.t,a.yanchor)},doneFn:function(){void 0!==L&& void 0!==M&&h.call("_guiRelayout",b,{"legend.x":L,"legend.y":M})},clickFn:function(c,e){var a=d.selectAll("g.traces").filter(function(){var a=this.getBoundingClientRect();return e.clientX>=a.left&&e.clientX<=a.right&&e.clientY>=a.top&&e.clientY<=a.bottom});a.size()>0&&w(b,y,a,c,e)}}))}],b)}}(b,a)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("./helpers");b.exports=function(r,f){var a,c,s=f._inHover,z=e.isGrouped(f),A=e.isReversed(f),B={},n=[],C=!1,k={},F=0,j=0;function t(a,b){if(""!==a&&e.isGrouped(f))-1===n.indexOf(a)?(n.push(a),C=!0,B[a]=[b]):B[a].push(b);else{var c="~~i"+F;n.push(c),B[c]=[b],F++}}for(a=0;a<r.length;a++){var g=r[a],u=g[0],h=u.trace,i=h.legendgroup;if(s||h.visible&&h.showlegend)if(d.traceIs(h,"pie-like"))for(k[i]||(k[i]={}),c=0;c<g.length;c++){var l=g[c].label;k[i][l]||(t(i,{label:l,color:g[c].color,i:g[c].i,trace:h,pts:g[c].pts}),k[i][l]=!0,j=Math.max(j,(l||"").length))}else t(i,u),j=Math.max(j,(h.name||"").length)}if(!n.length)return[];var v=!C||!z,b=[];for(a=0;a<n.length;a++){var w=B[n[a]];v?b.push(w[0]):b.push(w)}for(v&&(b=[b]),a=0;a<b.length;a++){var o=1/0;for(c=0;c<b[a].length;c++){var x=b[a][c].trace.legendrank;o>x&&(o=x)}b[a][0]._groupMinRank=o,b[a][0]._preGroupSort=a}var D=function(a,b){return a[0]._groupMinRank-b[0]._groupMinRank||a[0]._preGroupSort-b[0]._preGroupSort},E=function(a,b){return a.trace.legendrank-b.trace.legendrank||a._preSort-b._preSort};for(b.forEach(function(a,b){a[0]._preGroupSort=b}),b.sort(D),a=0;a<b.length;a++){b[a].forEach(function(a,b){a._preSort=b}),b[a].sort(E);var p=b[a][0].trace,q=null;for(c=0;c<b[a].length;c++){var m=b[a][c].trace.legendgrouptitle;if(m&&m.text){q=m,s&&(m.font=f._groupTitleFont);break}}if(A&&b[a].reverse(),q){var y=!1;for(c=0;c<b[a].length;c++)if(d.traceIs(b[a][c].trace,"pie-like")){y=!0;break}b[a].unshift({i:-1,groupTitle:q,noClick:y,trace:{showlegend:p.showlegend,legendgroup:p.legendgroup,visible:"toggleitem"===f.groupclick||p.visible}})}for(c=0;c<b[a].length;c++)b[a][c]=[b[a][c]]}return f._lgroupsLength=b.length,f._maxNameLength=j,b}},{"../../registry":647,"./helpers":423}],422:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=!0;b.exports=function(F,c,r){var m=c._fullLayout;if(!c._dragged&&!c._editing){var v=m.legend.itemclick,w=m.legend.itemdoubleclick,G=m.legend.groupclick;if(1===r&&"toggle"===v&&"toggleothers"===w&&f&&c.data&&c._context.showTips&&d.notifier(d._(c,"Double-click on legend to isolate one trace"),"long"),f=!1,1===r?K=v:2===r&&(K=w),K){var H="togglegroup"===G,i=m.hiddenlabels?m.hiddenlabels.slice():[],n=F.data()[0][0];if(!n.groupTitle||!n.noClick){var b=c._fullData,h=n.trace,j=h.legendgroup,k={},x=[],y=[],I=[];if(e.traceIs(h,"pie-like")){var z=n.label,s=i.indexOf(z);"toggle"===K?-1===s?i.push(z):i.splice(s,1):"toggleothers"===K&&(i=[],c.calcdata[0].forEach(function(a){z!==a.label&&i.push(a.label)}),c._fullLayout.hiddenlabels&&c._fullLayout.hiddenlabels.length===i.length&& -1===s&&(i=[])),e.call("_guiRelayout",c,"hiddenlabels",i)}else{var o=j&&j.length,J=[];if(o)for(a=0;a<b.length;a++)(L=b[a]).visible&&L.legendgroup===j&&J.push(a);if("toggle"===K){switch(h.visible){case!0:M="legendonly";break;case!1:M=!1;break;case"legendonly":M=!0;break}if(o)if(H)for(a=0;a<b.length;a++)!1!==b[a].visible&&b[a].legendgroup===j&&O(b[a],M);else O(h,M);else O(h,M)}else if("toggleothers"===K){var K,a,g,A,l,t,L,M,p,u,q,B,C=!0;for(a=0;a<b.length;a++)if(p=b[a]===h,q=!0!==b[a].showlegend,!p&&!q&& !(u=o&&b[a].legendgroup===j)&& !0===b[a].visible&&!e.traceIs(b[a],"notLegendIsolatable")){C=!1;break}for(a=0;a<b.length;a++)if(!1!==b[a].visible){if(e.traceIs(b[a],"notLegendIsolatable"))continue;switch(h.visible){case"legendonly":O(b[a],!0);break;case!0:B=!!C||"legendonly",p=b[a]===h,q=!0!==b[a].showlegend&&!b[a].legendgroup,u=p||o&&b[a].legendgroup===j,O(b[a],!!u||!!q||B);break}}}for(a=0;a<y.length;a++)if(A=y[a]){var D=A.constructUpdate(),E=Object.keys(D);for(g=0;g<E.length;g++)(k[l=E[g]]=k[l]||[])[I[a]]=D[l]}for(a=0,t=Object.keys(k);a<t.length;a++)for(g=0,l=t[a];g<x.length;g++)k[l].hasOwnProperty(g)||(k[l][g]=void 0);e.call("_guiRestyle",c,k,x)}}}}function N(a,d,e){var b=x.indexOf(a),c=k[d];return c||(c=k[d]=[]),-1===x.indexOf(a)&&(x.push(a),b=x.length-1),c[b]=e,b}function O(c,g){if(!n.groupTitle||H){var a=c._fullInput;if(e.hasTransform(a,"groupby")){var b=y[a.index];if(!b){var h=e.getTransformIndices(a,"groupby"),i=h[h.length-1];b=d.keyedContainer(a,"transforms["+i+"].styles","target","value.visible"),y[a.index]=b}var f=b.get(c._group);void 0===f&&(f=!0),!1!==f&&b.set(c._group,g),I[a.index]=N(a.index,"visible",!1!==a.visible)}else{var j=!1!==a.visible&&g;N(a.index,"visible",j)}}}}},{"../../lib":515,"../../registry":647}],423:[function(b,c,a){"use strict";a.isGrouped=function(a){return -1!==(a.traceorder||"").indexOf("grouped")},a.isVertical=function(a){return"h"!==a.orientation},a.isReversed=function(a){return -1!==(a.traceorder||"").indexOf("reversed")}},{}],424:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"legend",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),draw:a("./draw"),style:a("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../registry"),c=a("../../lib"),g=c.strTranslate,h=a("../drawing"),i=a("../color"),j=a("../colorscale/helpers").extractOpts,k=a("../../traces/scatter/subtypes"),l=a("../../traces/pie/style_one"),m=a("../../traces/pie/helpers").castOption,n=a("./constants");function o(a,b){return(b?"radial":"horizontal")+(a?"":"reversed")}function p(h){var a=h[0].trace,b=a.contours,d=k.hasLines(a),i=k.hasMarkers(a),e=a.visible&&a.fill&&"none"!==a.fill,f=!1,g=!1;if(b){var c=b.coloring;"lines"===c?f=!0:d="none"===c||"heatmap"===c||b.showlines,"constraint"===b.type?e="="!==b._operation:("fill"===c||"heatmap"===c)&&(g=!0)}return{showMarker:i,showLine:d,showFill:e,showGradientLine:f,showGradientFill:g,anyLine:d||f,anyFill:e||g}}function q(a,d,b){return a&&c.isArrayOrTypedArray(a)?d:a>b?b:a}b.exports=function(b,d,a){var r=d._fullLayout;a||(a=r.legend);var t="constant"===a.itemsizing,s=a.itemwidth,u=g((s+2*n.itemGap)/2,0),v=function(c,a,d,e){var b;if(c+1)b=c;else{if(!a||!(a.width>0))return 0;b=a.width}return t?e:Math.min(b,d)};function w(k,l,b){var c=k[0].trace,m=c.marker||{},o=m.line||{},n=b?c.visible&&c.type===b:f.traceIs(c,"bar"),g=e.select(l).select("g.legendpoints").selectAll("path.legend"+b).data(n?[k]:[]);g.enter().append("path").classed("legend"+b,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",u),g.exit().remove(),g.each(function(s){var g=e.select(this),f=s[0],p=v(f.mlw,m.line,5,2);g.style("stroke-width",p+"px");var k=f.mcc;if(!a._inHover&&"mc"in f){var l=j(m),n=l.mid;void 0===n&&(n=(l.max+l.min)/2),k=h.tryColorscale(m,"")(n)}var t=k||f.mc||m.color,b=m.pattern,r=b&&h.getPatternAttr(b.shape,0,"");if(r){var u=h.getPatternAttr(b.bgcolor,0,null),w=h.getPatternAttr(b.fgcolor,0,null),x=b.fgopacity,y=q(b.size,8,10),z=q(b.solidity,.5,1),A="legend-"+c.uid;g.call(h.pattern,"legend",d,A,r,y,z,k,b.fillmode,u,w,x)}else g.call(i.fill,t);p&&i.stroke(g,f.mlc||o.color)})}function x(j,k,a){var g=j[0],b=g.trace,n=a?b.visible&&b.type===a:f.traceIs(b,a),d=e.select(k).select("g.legendpoints").selectAll("path.legend"+a).data(n?[j]:[]);if(d.enter().append("path").classed("legend"+a,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",u),d.exit().remove(),d.size()){var h=(b.marker||{}).line,o=v(m(h.width,g.pts),h,5,2),i=c.minExtend(b,{marker:{line:{width:o}}});i.marker.line.color=h.color,l(d,c.minExtend(g,{trace:i}),i)}}b.each(function(b){var k=e.select(this),d=c.ensureSingle(k,"g","layers");d.style("opacity",b[0].trace.opacity);var f=a.valign,h=b[0].lineHeight,i=b[0].height;if("middle"!==f&&h&&i){var l={top:1,bottom:-1}[f]*(.5*(h-i+3));d.attr("transform",g(0,l))}else d.attr("transform",null);d.selectAll("g.legendfill").data([b]).enter().append("g").classed("legendfill",!0),d.selectAll("g.legendlines").data([b]).enter().append("g").classed("legendlines",!0);var j=d.selectAll("g.legendsymbols").data([b]);j.enter().append("g").classed("legendsymbols",!0),j.selectAll("g.legendpoints").data([b]).enter().append("g").classed("legendpoints",!0)}).each(function(k){var b,g=k[0].trace,a=[];if(g.visible)switch(g.type){case"histogram2d":case"heatmap":a=[["M-15,-2V4H15V-2Z"]],b=!0;break;case"choropleth":case"choroplethmapbox":a=[["M-6,-6V6H6V-6Z"]],b=!0;break;case"densitymapbox":a=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],b="radial";break;case"cone":a=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],b=!1;break;case"streamtube":a=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],b=!1;break;case"surface":a=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],b=!0;break;case"mesh3d":a=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],b=!1;break;case"volume":a=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],b=!0;break;case"isosurface":a=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],b=!1;break}var f=e.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(a);f.enter().append("path").classed("legend3dandfriends",!0).attr("transform",u).style("stroke-miterlimit",1),f.exit().remove(),f.each(function(r,l){var f,m=e.select(this),p=j(g),a=p.colorscale,q=p.reversescale;if(a){if(!b){var n=a.length;f=0===l?a[q?n-1:0][1]:1===l?a[q?0:n-1][1]:a[Math.floor((n-1)/2)][1]}}else{var k=g.vertexcolor||g.facecolor||g.color;f=c.isArrayOrTypedArray(k)?k[l]||k[0]:k}m.attr("d",r[0]),f?m.call(i.fill,f):m.call(function(c){if(c.size()){var e="legendfill-"+g.uid;h.gradient(c,d,e,o(q,"radial"===b),a,"fill")}})})}).each(function(a){var d=a[0].trace,f="waterfall"===d.type;if(a[0]._distinct&&f){var b=a[0].trace[a[0].dir].marker;return a[0].mc=b.color,a[0].mlw=b.line.width,a[0].mlc=b.line.color,w(a,this,"waterfall")}var g=[];d.visible&&f&&(g=a[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var c=e.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(g);c.enter().append("path").classed("legendwaterfall",!0).attr("transform",u).style("stroke-miterlimit",1),c.exit().remove(),c.each(function(b){var c=e.select(this),a=d[b[0]].marker,f=v(void 0,a.line,5,2);c.attr("d",b[1]).style("stroke-width",f+"px").call(i.fill,a.color),f&&c.call(i.stroke,a.line.color)})}).each(function(a){w(a,this,"funnel")}).each(function(a){w(a,this)}).each(function(b){var g=b[0].trace,a=e.select(this).select("g.legendpoints").selectAll("path.legendbox").data(g.visible&&f.traceIs(g,"box-violin")?[b]:[]);a.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",u),a.exit().remove(),a.each(function(){var b=e.select(this);if(("all"===g.boxpoints||"all"===g.points)&&0===i.opacity(g.fillcolor)&&0===i.opacity((g.line||{}).color)){var j=c.minExtend(g,{marker:{size:t?12:c.constrain(g.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});a.call(h.pointStyle,j,d)}else{var f=v(void 0,g.line,5,2);b.style("stroke-width",f+"px").call(i.fill,g.fillcolor),f&&i.stroke(b,g.line.color)}})}).each(function(a){x(a,this,"funnelarea")}).each(function(a){x(a,this,"pie")}).each(function(f){var n,q,a=p(f),x=a.showFill,g=a.showLine,i=a.showGradientLine,y=a.showGradientFill,z=a.anyFill,A=a.anyLine,r=f[0],b=r.trace,t=j(b),C=t.colorscale,D=t.reversescale,u=k.hasMarkers(b)||!z?"M5,0":A?"M5,-2":"M5,-3",w=e.select(this),l=w.select(".legendfill").selectAll("path").data(x||y?[f]:[]);if(l.enter().append("path").classed("js-fill",!0),l.exit().remove(),l.attr("d",u+"h"+s+"v6h-"+s+"z").call(function(a){if(a.size())if(x)h.fillGroupStyle(a,d);else{var c="legendfill-"+b.uid;h.gradient(a,d,c,o(D),C,"fill")}}),g||i){var B=v(void 0,b.line,10,5);q=c.minExtend(b,{line:{width:B}}),n=[c.minExtend(r,{trace:q})]}var m=w.select(".legendlines").selectAll("path").data(g||i?[n]:[]);m.enter().append("path").classed("js-line",!0),m.exit().remove(),m.attr("d",u+(i?"l"+s+",0.0001":"h"+s)).call(g?h.lineGroupStyle:function(a){if(a.size()){var c="legendline-"+b.uid;h.lineGroupStyle(a),h.gradient(a,d,c,o(D),C,"stroke")}})}).each(function(r){var j,g,l=p(r),z=l.anyFill,A=l.anyLine,s=l.showLine,i=l.showMarker,v=r[0],w=v.trace,n=!i&&!A&&!z&&k.hasText(w);function b(g,e,a,f){var d=c.nestedProperty(w,g).get(),b=c.isArrayOrTypedArray(d)&&e?e(d):d;if(t&&b&& void 0!==f&&(b=f),a){if(b<a[0])return a[0];if(b>a[1])return a[1]}return b}function f(a){return v._distinct&&v.index&&a[v.index]?a[v.index]:a[0]}if(i||n||s){var a={},m={};if(i){a.mc=b("marker.color",f),a.mx=b("marker.symbol",f),a.mo=b("marker.opacity",c.mean,[.2,1]),a.mlc=b("marker.line.color",f),a.mlw=b("marker.line.width",c.mean,[0,5],2),m.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var x=b("marker.size",c.mean,[2,16],12);a.ms=x,m.marker.size=x}s&&(m.line={width:b("line.width",f,[0,10],5)}),n&&(a.tx="Aa",a.tp=b("textposition",f),a.ts=10,a.tc=b("textfont.color",f),a.tf=b("textfont.family",f)),j=[c.minExtend(v,a)],g=c.minExtend(w,m),g.selectedpoints=null,g.texttemplate=null}var y=e.select(this).select("g.legendpoints"),o=y.selectAll("path.scatterpts").data(i?j:[]);o.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",u),o.exit().remove(),o.call(h.pointStyle,g,d),i&&(j[0].mrc=3);var q=y.selectAll("g.pointtext").data(n?j:[]);q.enter().append("g").classed("pointtext",!0).append("text").attr("transform",u),q.exit().remove(),q.selectAll("text").call(h.textPointStyle,g,d)}).each(function(a){var c=a[0].trace,b=e.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(c.visible&&"candlestick"===c.type?[a,a]:[]);b.enter().append("path").classed("legendcandle",!0).attr("d",function(b,a){return a?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",u).style("stroke-miterlimit",1),b.exit().remove(),b.each(function(g,f){var b=e.select(this),a=c[f?"increasing":"decreasing"],d=v(void 0,a.line,5,2);b.style("stroke-width",d+"px").call(i.fill,a.fillcolor),d&&i.stroke(b,a.line.color)})}).each(function(a){var c=a[0].trace,b=e.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(c.visible&&"ohlc"===c.type?[a,a]:[]);b.enter().append("path").classed("legendohlc",!0).attr("d",function(b,a){return a?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",u).style("stroke-miterlimit",1),b.exit().remove(),b.each(function(g,f){var b=e.select(this),a=c[f?"increasing":"decreasing"],d=v(void 0,a.line,5,2);b.style("fill","none").call(h.dashLine,a.line.dash,d),d&&i.stroke(b,a.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(a,b,c){"use strict";a("./constants"),b.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(d,j,m){"use strict";var n=d("../../registry"),o=d("../../plots/plots"),p=d("../../plots/cartesian/axis_ids"),a=d("../../fonts/ploticon"),k=d("../shapes/draw").eraseActiveShape,l=d("../../lib"),q=l._,b=j.exports={};function c(g,t){var h=t.currentTarget,i=h.getAttribute("data-attr"),c=h.getAttribute("data-val")||!0,j=g._fullLayout,b={},l=p.list(g,null,!0),k=j._cartesianSpikesEnabled;if("zoom"===i){var a,e,d,m="in"===c?.5:2,o=(1+m)/2,q=(1-m)/2;for(e=0;e<l.length;e++)if(!(a=l[e]).fixedrange)if(d=a._name,"auto"===c)b[d+".autorange"]=!0;else if("reset"===c){if(void 0===a._rangeInitial)b[d+".autorange"]=!0;else{var r=a._rangeInitial.slice();b[d+".range[0]"]=r[0],b[d+".range[1]"]=r[1]}void 0===a._showSpikeInitial||(b[d+".showspikes"]=a._showSpikeInitial,"on"!==k||a._showSpikeInitial||(k="off"))}else{var f=[a.r2l(a.range[0]),a.r2l(a.range[1]),],s=[o*f[0]+q*f[1],o*f[1]+q*f[0]];b[d+".range[0]"]=a.l2r(s[0]),b[d+".range[1]"]=a.l2r(s[1])}}else"hovermode"===i&&("x"===c||"y"===c)&&(c=j._isHoriz?"y":"x",h.setAttribute("data-val",c)),b[i]=c;j._cartesianSpikesEnabled=k,n.call("_guiRelayout",g,b)}function e(d,g){for(var e=g.currentTarget,h=e.getAttribute("data-attr"),a=e.getAttribute("data-val")||!0,f=d._fullLayout._subplots.gl3d||[],b={},i=h.split("."),c=0;c<f.length;c++)b[f[c]+"."+i[1]]=a;b.dragmode="pan"===a?a:"zoom",n.call("_guiRelayout",d,b)}function h(h,l){for(var i=l.currentTarget.getAttribute("data-attr"),m="resetLastSave"===i,o="resetDefault"===i,j=h._fullLayout,k=j._subplots.gl3d||[],a={},e=0;e<k.length;e++){var f,d=k[e],c=d+".camera",g=d+".aspectratio",p=d+".aspectmode",b=j[d]._scene;m?(a[c+".up"]=b.viewInitial.up,a[c+".eye"]=b.viewInitial.eye,a[c+".center"]=b.viewInitial.center,f=!0):o&&(a[c+".up"]=null,a[c+".eye"]=null,a[c+".center"]=null,f=!0),f&&(a[g+".x"]=b.viewInitial.aspectratio.x,a[g+".y"]=b.viewInitial.aspectratio.y,a[g+".z"]=b.viewInitial.aspectratio.z,a[p]=b.viewInitial.aspectmode)}n.call("_guiRelayout",h,a)}function r(n,o){var b=o.currentTarget,g=b._previousVal,h=n._fullLayout,i=h._subplots.gl3d||[],p=["xaxis","yaxis","zaxis"],c={},a={};if(g)a=g,b._previousVal=null;else{for(var d=0;d<i.length;d++){var e=i[d],j=h[e],k=e+".hovermode";c[k]=j.hovermode,a[k]=!1;for(var f=0;f<3;f++){var l=p[f],m=e+"."+l+".showspikes";a[m]=!1,c[m]=j[l].showspikes}}b._previousVal=c}return a}function f(a,i){for(var c=i.currentTarget,d=c.getAttribute("data-attr"),j=c.getAttribute("data-val")||!0,e=a._fullLayout,f=e._subplots.geo||[],b=0;b<f.length;b++){var g=f[b],k=e[g];if("zoom"===d){var h=k.projection.scale,l="in"===j?2*h:.5*h;n.call("_guiRelayout",a,g+".projection.scale",l)}}"reset"===d&&t(a,"geo")}function s(b){var a=b._fullLayout;return!a.hovermode&&(a._has("cartesian")?a._isHoriz?"y":"x":"closest")}function g(a){var b=s(a);n.call("_guiRelayout",a,"hovermode",b)}function i(b,h){for(var i=h.currentTarget.getAttribute("data-val"),c=b._fullLayout,d=c._subplots.mapbox||[],e={},a=0;a<d.length;a++){var f=d[a],g=c[f].zoom,j="in"===i?1.05*g:g/1.05;e[f+".zoom"]=j}n.call("_guiRelayout",b,e)}function t(c,k){for(var d=c._fullLayout,e=d._subplots[k]||[],f={},a=0;a<e.length;a++)for(var g=e[a],h=d[g]._subplot.viewInitial,i=Object.keys(h),b=0;b<i.length;b++){var j=i[b];f[g+"."+j]=h[j]}n.call("_guiRelayout",c,f)}b.toImage={name:"toImage",title:function(a){return"png"===((a._context.toImageButtonOptions||{}).format||"png")?q(a,"Download plot as a png"):q(a,"Download plot")},icon:a.camera,click:function(a){var c=a._context.toImageButtonOptions,b={format:c.format||"png"};l.notifier(q(a,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==b.format&&l.isIE()&&(l.notifier(q(a,"IE only supports svg.  Changing format to svg."),"long"),b.format="svg"),["filename","width","height","scale"].forEach(function(a){a in c&&(b[a]=c[a])}),n.call("downloadImage",a,b).then(function(b){l.notifier(q(a,"Snapshot succeeded")+" - "+b,"long")}).catch(function(){l.notifier(q(a,"Sorry, there was a problem downloading your snapshot!"),"long")})}},b.sendDataToCloud={name:"sendDataToCloud",title:function(a){return q(a,"Edit in Chart Studio")},icon:a.disk,click:function(a){o.sendDataToCloud(a)}},b.editInChartStudio={name:"editInChartStudio",title:function(a){return q(a,"Edit in Chart Studio")},icon:a.pencil,click:function(a){o.sendDataToCloud(a)}},b.zoom2d={name:"zoom2d",_cat:"zoom",title:function(a){return q(a,"Zoom")},attr:"dragmode",val:"zoom",icon:a.zoombox,click:c},b.pan2d={name:"pan2d",_cat:"pan",title:function(a){return q(a,"Pan")},attr:"dragmode",val:"pan",icon:a.pan,click:c},b.select2d={name:"select2d",_cat:"select",title:function(a){return q(a,"Box Select")},attr:"dragmode",val:"select",icon:a.selectbox,click:c},b.lasso2d={name:"lasso2d",_cat:"lasso",title:function(a){return q(a,"Lasso Select")},attr:"dragmode",val:"lasso",icon:a.lasso,click:c},b.drawclosedpath={name:"drawclosedpath",title:function(a){return q(a,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:a.drawclosedpath,click:c},b.drawopenpath={name:"drawopenpath",title:function(a){return q(a,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:a.drawopenpath,click:c},b.drawline={name:"drawline",title:function(a){return q(a,"Draw line")},attr:"dragmode",val:"drawline",icon:a.drawline,click:c},b.drawrect={name:"drawrect",title:function(a){return q(a,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:a.drawrect,click:c},b.drawcircle={name:"drawcircle",title:function(a){return q(a,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:a.drawcircle,click:c},b.eraseshape={name:"eraseshape",title:function(a){return q(a,"Erase active shape")},icon:a.eraseshape,click:k},b.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(a){return q(a,"Zoom in")},attr:"zoom",val:"in",icon:a.zoom_plus,click:c},b.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(a){return q(a,"Zoom out")},attr:"zoom",val:"out",icon:a.zoom_minus,click:c},b.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(a){return q(a,"Autoscale")},attr:"zoom",val:"auto",icon:a.autoscale,click:c},b.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(a){return q(a,"Reset axes")},attr:"zoom",val:"reset",icon:a.home,click:c},b.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(a){return q(a,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:a.tooltip_basic,gravity:"ne",click:c},b.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(a){return q(a,"Compare data on hover")},attr:"hovermode",val:function(a){return a._fullLayout._isHoriz?"y":"x"},icon:a.tooltip_compare,gravity:"ne",click:c},b.zoom3d={name:"zoom3d",_cat:"zoom",title:function(a){return q(a,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:a.zoombox,click:e},b.pan3d={name:"pan3d",_cat:"pan",title:function(a){return q(a,"Pan")},attr:"scene.dragmode",val:"pan",icon:a.pan,click:e},b.orbitRotation={name:"orbitRotation",title:function(a){return q(a,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:a["3d_rotate"],click:e},b.tableRotation={name:"tableRotation",title:function(a){return q(a,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:a["z-axis"],click:e},b.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(a){return q(a,"Reset camera to default")},attr:"resetDefault",icon:a.home,click:h},b.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(a){return q(a,"Reset camera to last save")},attr:"resetLastSave",icon:a.movie,click:h},b.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:a.tooltip_basic,gravity:"ne",click:function(a,b){var c=r(a,b);n.call("_guiRelayout",a,c)}},b.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(a){return q(a,"Zoom in")},attr:"zoom",val:"in",icon:a.zoom_plus,click:f},b.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(a){return q(a,"Zoom out")},attr:"zoom",val:"out",icon:a.zoom_minus,click:f},b.resetGeo={name:"resetGeo",_cat:"reset",title:function(a){return q(a,"Reset")},attr:"reset",val:null,icon:a.autoscale,click:f},b.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:a.tooltip_basic,gravity:"ne",click:g},b.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:a.tooltip_basic,gravity:"ne",click:g},b.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:a.tooltip_basic,gravity:"ne",click:g},b.resetViewSankey={name:"resetSankeyGroup",title:function(a){return q(a,"Reset view")},icon:a.home,click:function(b){for(var a={"node.groups":[],"node.x":[],"node.y":[]},c=0;c<b._fullData.length;c++){var d=b._fullData[c]._viewInitial;a["node.groups"].push(d.node.groups.slice()),a["node.x"].push(d.node.x.slice()),a["node.y"].push(d.node.y.slice())}n.call("restyle",b,a)}},b.toggleHover={name:"toggleHover",title:function(a){return q(a,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:a.tooltip_basic,gravity:"ne",click:function(a,c){var b=r(a,c);b.hovermode=s(a),n.call("_guiRelayout",a,b)}},b.resetViews={name:"resetViews",title:function(a){return q(a,"Reset views")},icon:a.home,click:function(a,b){var d=b.currentTarget;d.setAttribute("data-attr","zoom"),d.setAttribute("data-val","reset"),c(a,b),d.setAttribute("data-attr","resetLastSave"),h(a,b),t(a,"geo"),t(a,"mapbox")}},b.toggleSpikelines={name:"toggleSpikelines",title:function(a){return q(a,"Toggle Spike Lines")},icon:a.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(a){var b=a._fullLayout,c=b._cartesianSpikesEnabled;b._cartesianSpikesEnabled="on"===c?"off":"on",n.call("_guiRelayout",a,function(b){for(var f="on"===b._fullLayout._cartesianSpikesEnabled,c=p.list(b,null,!0),d={},a=0;a<c.length;a++){var e=c[a];d[e._name+".showspikes"]=!!f||e._showSpikeInitial}return d}(a))}},b.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(a){return q(a,"Reset view")},attr:"reset",icon:a.home,click:function(a){t(a,"mapbox")}},b.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(a){return q(a,"Zoom in")},attr:"zoom",val:"in",icon:a.zoom_plus,click:i},b.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(a){return q(a,"Zoom out")},attr:"zoom",val:"out",icon:a.zoom_minus,click:i}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(c,d,h){"use strict";var e=c("./buttons"),f=Object.keys(e),a=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],g=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(a),b=[],i=function(a){if(-1===g.indexOf(a._cat||a.name)){var c=a.name,d=(a._cat||a.name).toLowerCase();-1===b.indexOf(c)&&b.push(c),-1===b.indexOf(d)&&b.push(d)}};f.forEach(function(a){i(e[a])}),b.sort(),d.exports={DRAW_MODES:a,backButtons:g,foreButtons:b}},{"./buttons":427}],429:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../color"),f=a("../../plot_api/plot_template"),g=a("./attributes");b.exports=function(h,b){var i=h.modebar||{},j=f.newContainer(b,"modebar");function a(a,b){return d.coerce(i,j,g,a,b)}a("orientation"),a("bgcolor",e.addOpacity(b.paper_bgcolor,.5));var c=e.contrast(e.rgb(b.modebar.bgcolor));a("color",e.addOpacity(c,.3)),a("activecolor",e.addOpacity(c,.7)),a("uirevision",b.uirevision),a("add"),a("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"modebar",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),manage:a("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axis_ids"),e=a("../../traces/scatter/subtypes"),f=a("../../registry"),g=a("../fx/helpers").isUnifiedHover,h=a("./modebar"),i=a("./buttons"),j=a("./constants").DRAW_MODES,k=a("../../lib").extendDeep;b.exports=function(b){var l,m=b._fullLayout,a=b._context,c=m._modeBar;if(!a.displayModeBar&&!a.watermark){c&&(c.destroy(),delete m._modeBar);return}if(!Array.isArray(a.modeBarButtonsToRemove))throw new Error("*modeBarButtonsToRemove* configuration options must be an array.");if(!Array.isArray(a.modeBarButtonsToAdd))throw new Error("*modeBarButtonsToAdd* configuration options must be an array.");var n=a.modeBarButtons;l=Array.isArray(n)&&n.length?function(f){for(var a=k([],f),b=0;b<a.length;b++)for(var e=a[b],c=0;c<e.length;c++){var d=e[c];if("string"==typeof d)if(void 0!==i[d])a[b][c]=i[d];else throw new Error("*modeBarButtons* configuration options invalid button name")}return a}(n):!a.displayModeBar&&a.watermark?[]:function(u){var a=u._fullLayout,A=u._fullData,n=u._context;function M(b,a){if("string"==typeof a){if(a.toLowerCase()===b.toLowerCase())return!0}else{var c=a.name,d=a._cat||a.name;if(c===b||d===b.toLowerCase())return!0}return!1}var o=a.modebar.add;"string"==typeof o&&(o=[o]);var p=a.modebar.remove;"string"==typeof p&&(p=[p]);var m=n.modeBarButtonsToAdd.concat(o.filter(function(b){for(var a=0;a<n.modeBarButtonsToRemove.length;a++)if(M(b,n.modeBarButtonsToRemove[a]))return!1;return!0})),N=n.modeBarButtonsToRemove.concat(p.filter(function(b){for(var a=0;a<n.modeBarButtonsToAdd.length;a++)if(M(b,n.modeBarButtonsToAdd[a]))return!1;return!0})),q=a._has("cartesian"),v=a._has("gl3d"),w=a._has("geo"),B=a._has("pie"),G=a._has("funnelarea"),r=a._has("gl2d"),C=a._has("ternary"),x=a._has("mapbox"),D=a._has("polar"),H=a._has("smith"),I=a._has("sankey"),E=function(c){for(var b=d.list({_fullLayout:c},null,!0),a=0;a<b.length;a++)if(!b[a].fixedrange)return!1;return!0}(a),J=g(a.hovermode),K=[];function s(a){if(a.length){for(var e=[],b=0;b<a.length;b++){for(var f=a[b],c=i[f],j=c.name.toLowerCase(),k=(c._cat||c.name).toLowerCase(),g=!1,d=0;d<N.length;d++){var h=N[d].toLowerCase();if(h===j||h===k){g=!0;break}}g||e.push(i[f])}K.push(e)}}var y=["toImage"];n.showEditInChartStudio?y.push("editInChartStudio"):n.showSendToCloud&&y.push("sendDataToCloud"),s(y);var t=[],h=[],k=[],l=[];(q||r||B||G||C)+w+v+x+D+H>1?(h=["toggleHover"],k=["resetViews"]):w?(t=["zoomInGeo","zoomOutGeo"],h=["hoverClosestGeo"],k=["resetGeo"]):v?(h=["hoverClosest3d"],k=["resetCameraDefault3d","resetCameraLastSave3d"]):x?(t=["zoomInMapbox","zoomOutMapbox"],h=["toggleHover"],k=["resetViewMapbox"]):r?h=["hoverClosestGl2d"]:B?h=["hoverClosestPie"]:I?(h=["hoverClosestCartesian","hoverCompareCartesian"],k=["resetViewSankey"]):h=["toggleHover"],q&&(h=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(b){for(var a=0;a<b.length;a++)if(!f.traceIs(b[a],"noHover"))return!1;return!0}(A)||J)&&(h=[]),(q||r)&&!E&&(t=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==k[0]&&(k=["resetScale2d"])),v?l=["zoom3d","pan3d","orbitRotation","tableRotation"]:(q||r)&&!E||C?l=["zoom2d","pan2d"]:x||w?l=["pan2d"]:D&&(l=["zoom2d"]),function(d){for(var b=!1,c=0;c<d.length&&!b;c++){var a=d[c];a._module&&a._module.selectPoints&&(f.traceIs(a,"scatter-like")?(e.hasMarkers(a)||e.hasText(a))&&(b=!0):f.traceIs(a,"box-violin")?("all"===a.boxpoints||"all"===a.points)&&(b=!0):b=!0)}return b}(A)&&l.push("select2d","lasso2d");var L=[],b=function(a){-1===L.indexOf(a)&& -1!==h.indexOf(a)&&L.push(a)};if(Array.isArray(m)){for(var F=[],z=0;z<m.length;z++){var c=m[z];"string"==typeof c?(c=c.toLowerCase(),-1!==j.indexOf(c)?(a._has("mapbox")||a._has("cartesian"))&&l.push(c):"togglespikelines"===c?b("toggleSpikelines"):"togglehover"===c?b("toggleHover"):"hovercompare"===c?b("hoverCompareCartesian"):"hoverclosest"===c?(b("hoverClosestCartesian"),b("hoverClosestGeo"),b("hoverClosest3d"),b("hoverClosestGl2d"),b("hoverClosestPie")):"v1hovermode"===c&&(b("toggleHover"),b("hoverClosestCartesian"),b("hoverCompareCartesian"),b("hoverClosestGeo"),b("hoverClosest3d"),b("hoverClosestGl2d"),b("hoverClosestPie"))):F.push(c)}m=F}return s(l),s(t.concat(k)),s(L),function(b,a){if(a.length)if(Array.isArray(a[0]))for(var c=0;c<a.length;c++)b.push(a[c]);else b.push(a);return b}(K,m)}(b),c?c.update(b,l):m._modeBar=h(b,l)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(b,c,e){"use strict";var f=b("@plotly/d3"),g=b("fast-isnumeric"),h=b("../../lib"),i=b("../../fonts/ploticon"),j=b("../../version").version,k=new DOMParser;function d(a){this.container=a.container,this.element=document.createElement("div"),this.update(a.graphInfo,a.buttons),this.container.appendChild(this.element)}var a=d.prototype;a.update=function(g,c){this.graphInfo=g;var b=this.graphInfo._context,d=this.graphInfo._fullLayout,a="modebar-"+d._uid;this.element.setAttribute("id",a),this._uid=a,this.element.className="modebar","hover"===b.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===d.modebar.orientation&&(this.element.className+=" vertical",c=c.reverse());var e=d.modebar,i="hover"===b.displayModeBar?".js-plotly-plot .plotly:hover ":"";h.deleteRelatedStyleRule(a),h.addRelatedStyleRule(a,i+"#"+a+" .modebar-group","background-color: "+e.bgcolor),h.addRelatedStyleRule(a,"#"+a+" .modebar-btn .icon path","fill: "+e.color),h.addRelatedStyleRule(a,"#"+a+" .modebar-btn:hover .icon path","fill: "+e.activecolor),h.addRelatedStyleRule(a,"#"+a+" .modebar-btn.active .icon path","fill: "+e.activecolor);var j=!this.hasButtons(c),k=this.hasLogo!==b.displaylogo,l=this.locale!==b.locale;if(this.locale=b.locale,(j||k||l)&&(this.removeAllButtons(),this.updateButtons(c),b.watermark||b.displaylogo)){var f=this.getLogo();b.watermark&&(f.className=f.className+" watermark"),"v"===d.modebar.orientation?this.element.insertBefore(f,this.element.childNodes[0]):this.element.appendChild(f),this.hasLogo=!0}this.updateActiveButton()},a.updateButtons=function(a){var b=this;this.buttons=a,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(a){var c=b.createGroup();a.forEach(function(d){var a=d.name;if(!a)throw new Error("must provide button 'name' in button config");if(-1!==b.buttonsNames.indexOf(a))throw new Error("button name '"+a+"' is taken");b.buttonsNames.push(a);var e=b.createButton(d);b.buttonElements.push(e),c.appendChild(e)}),b.element.appendChild(c)})},a.createGroup=function(){var a=document.createElement("div");return a.className="modebar-group",a},a.createButton=function(b){var g=this,a=document.createElement("a");a.setAttribute("rel","tooltip"),a.className="modebar-btn";var c=b.title;void 0===c?c=b.name:"function"==typeof c&&(c=c(this.graphInfo)),(c||0===c)&&a.setAttribute("data-title",c),void 0!==b.attr&&a.setAttribute("data-attr",b.attr);var d=b.val;if(void 0!==d&&("function"==typeof d&&(d=d(this.graphInfo)),a.setAttribute("data-val",d)),"function"!=typeof b.click)throw new Error("must provide button 'click' function in button config");a.addEventListener("click",function(a){b.click(g.graphInfo,a),g.updateActiveButton(a.currentTarget)}),a.setAttribute("data-toggle",b.toggle||!1),b.toggle&&f.select(a).classed("active",!0);var e=b.icon;return"function"==typeof e?a.appendChild(e()):a.appendChild(this.createIcon(e||i.question)),a.setAttribute("data-gravity",b.gravity||"n"),a},a.createIcon=function(a){var b,e=g(a.height)?Number(a.height):a.ascent-a.descent,d="http://www.w3.org/2000/svg";if(a.path){(b=document.createElementNS(d,"svg")).setAttribute("viewBox",[0,0,a.width,e].join(" ")),b.setAttribute("class","icon");var c=document.createElementNS(d,"path");c.setAttribute("d",a.path),a.transform?c.setAttribute("transform",a.transform):void 0!==a.ascent&&c.setAttribute("transform","matrix(1 0 0 -1 0 "+a.ascent+")"),b.appendChild(c)}return a.svg&&(b=k.parseFromString(a.svg,"application/xml").childNodes[0]),b.setAttribute("height","1em"),b.setAttribute("width","1em"),b},a.updateActiveButton=function(a){var b=this.graphInfo._fullLayout,c=void 0!==a?a.getAttribute("data-attr"):null;this.buttonElements.forEach(function(a){var g=a.getAttribute("data-val")||!0,d=a.getAttribute("data-attr"),i="true"===a.getAttribute("data-toggle"),e=f.select(a);if(i)d===c&&e.classed("active",!e.classed("active"));else{var j=null===d?d:h.nestedProperty(b,d).get();e.classed("active",j===g)}})},a.hasButtons=function(b){var c=this.buttons;if(!c)return!1;if(b.length!==c.length)return!1;for(var a=0;a<b.length;++a){if(b[a].length!==c[a].length)return!1;for(var d=0;d<b[a].length;d++)if(b[a][d].name!==c[a][d].name)return!1}return!0},a.getLogo=function(){var b=this.createGroup(),a=document.createElement("a");return a.href="https://plotly.com/",a.target="_blank",a.setAttribute("data-title",h._(this.graphInfo,"Produced with Plotly.js")+" (v"+j+")"),a.className="modebar-btn plotlyjsicon modebar-btn--logo",a.appendChild(this.createIcon(i.newplotlylogo)),b.appendChild(a),b},a.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},a.destroy=function(){h.removeElement(this.container.querySelector(".modebar")),h.deleteRelatedStyleRule(this._uid)},c.exports=function(a,e){var b=a._fullLayout,c=new d({graphInfo:a,container:b._modebardiv.node(),buttons:e});return b._privateplot&&f.select(c.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),c}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(a,c,g){"use strict";var d=a("../../plots/font_attributes"),b=a("../color/attributes"),e=a("../../plot_api/plot_template").templatedArray,f=e("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});c.exports={visible:{valType:"boolean",editType:"plot"},buttons:f,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:d({editType:"plot"}),bgcolor:{valType:"color",dflt:b.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:b.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(b,a,c){"use strict";a.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../color"),f=a("../../plot_api/plot_template"),g=a("../../plots/array_container_defaults"),h=a("./attributes"),i=a("./constants");function j(g,e,i,f){var c=f.calendar;function a(a,b){return d.coerce(g,e,h.buttons,a,b)}if(a("visible")){var b=a("step");"all"!==b&&(c&&"gregorian"!==c&&("month"===b||"year"===b)?e.stepmode="backward":a("stepmode"),a("count")),a("label")}}b.exports=function(c,b,k,m,n){var o=c.rangeselector||{},p=f.newContainer(b,"rangeselector");function a(a,b){return d.coerce(o,p,h,a,b)}if(a("visible",g(o,p,{name:"buttons",handleItemDefaults:j,calendar:n}).length>0)){var l=function(e,f,g){for(var c=g.filter(function(a){return f[a].anchor===e._id}),a=0,b=0;b<c.length;b++){var d=f[c[b]].domain;d&&(a=Math.max(d[1],a))}return[e.domain[0],a+i.yPad]}(b,k,m);a("x",l[0]),a("y",l[1]),d.noneOrAll(c,b,["x","y"]),a("xanchor"),a("yanchor"),d.coerceFont(a,"font",k.font);var q=a("bgcolor");a("activecolor",e.contrast(q,i.lightAmount,i.darkAmount)),a("bordercolor"),a("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(a,c,e){"use strict";var f=a("@plotly/d3"),g=a("../../registry"),h=a("../../plots/plots"),i=a("../color"),j=a("../drawing"),d=a("../../lib"),k=d.strTranslate,l=a("../../lib/svg_text_utils"),m=a("../../plots/cartesian/axis_ids"),b=a("../../constants/alignment"),n=b.LINE_SPACING,o=b.FROM_TL,p=b.FROM_BR,q=a("./constants"),r=a("./get_update_object");function s(a){return a._id}function t(c,a,e){var b=d.ensureSingle(c,"rect","selector-rect",function(a){a.attr("shape-rendering","crispEdges")});b.attr({rx:q.rx,ry:q.ry}),b.call(i.stroke,a.bordercolor).call(i.fill,u(a,e)).style("stroke-width",a.borderwidth+"px")}function u(a,b){return b._isActive||b._isHovered?a.activecolor:a.bgcolor}function v(a,b,c,e){d.ensureSingle(a,"text","selector-text",function(a){a.attr("text-anchor","middle")}).call(j.font,b.font).text(w(c,e._fullLayout._meta)).call(function(a){l.convertToTspans(a,e)})}function w(a,b){return a.label?b?d.templateString(a.label,b):a.label:"all"===a.step?"all":a.count+a.step.charAt(0)}c.exports=function(b){var a=b._fullLayout._infolayer.selectAll(".rangeselector").data(function(e){for(var c=m.list(e,"x",!0),d=[],a=0;a<c.length;a++){var b=c[a];b.rangeselector&&b.rangeselector.visible&&d.push(b)}return d}(b),s);a.enter().append("g").classed("rangeselector",!0),a.exit().remove(),a.style({cursor:"pointer","pointer-events":"all"}),a.each(function(F){var y,z,a,A,B,c,e,G,w,i,m,s,u,C=f.select(this),D=F,E=D.rangeselector,x=C.selectAll("g.button").data(d.filterVisible(E.buttons));x.enter().append("g").classed("button",!0),x.exit().remove(),x.each(function(a){var c=f.select(this),d=r(D,a);a._isActive=function(a,d,b){if("all"===d.step)return!0===a.autorange;var c=Object.keys(b);return a.range[0]===b[c[0]]&&a.range[1]===b[c[1]]}(D,a,d),c.call(t,E,a),c.call(v,E,a,b),c.on("click",function(){b._dragged||g.call("_guiRelayout",b,d)}),c.on("mouseover",function(){a._isHovered=!0,c.call(t,E,a)}),c.on("mouseout",function(){a._isHovered=!1,c.call(t,E,a)})}),y=b,z=x,a=E,A=D._name,B=C,c=0,e=0,G=a.borderwidth,z.each(function(){var b=f.select(this).select(".selector-text"),c=Math.max(a.font.size*n*l.lineCount(b),16)+3;e=Math.max(e,c)}),z.each(function(){var d=f.select(this),h=d.select(".selector-rect"),b=d.select(".selector-text"),i=b.node()&&j.bBox(b.node()).width,m=a.font.size*n,o=l.lineCount(b),g=Math.max(i+10,q.minButtonWidth);d.attr("transform",k(G+c,G)),h.attr({x:0,y:0,width:g,height:e}),l.positionText(b,g/2,e/2-(o-1)*m/2+3),c+=g+5}),i=(w=y._fullLayout._size).l+w.w*a.x,m=w.t+w.h*(1-a.y),s="left",d.isRightAnchor(a)&&(i-=c,s="right"),d.isCenterAnchor(a)&&(i-=c/2,s="center"),u="top",d.isBottomAnchor(a)&&(m-=e,u="bottom"),d.isMiddleAnchor(a)&&(m-=e/2,u="middle"),c=Math.ceil(c),e=Math.ceil(e),i=Math.round(i),m=Math.round(m),h.autoMargin(y,A+"-range-selector",{x:a.x,y:a.y,l:c*o[s],r:c*p[s],b:e*p[u],t:e*o[u]}),B.attr("transform",k(i,m))})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(a,b,c){"use strict";var d=a("d3-time"),e=a("../../lib").titleCase;b.exports=function(c,f){var b=c._name,a={};if("all"===f.step)a[b+".autorange"]=!0;else{var g=function(a,b){var c,g=a.range,h=new Date(a.r2l(g[1])),f=d["utc"+e(b.step)],i=b.count;switch(b.stepmode){case"backward":c=a.l2r(+f.offset(h,-i));break;case"todate":var j=f.offset(h,-i);c=a.l2r(+f.ceil(j));break}return[c,g[1]]}(c,f);a[b+".range[0]"]=g[0],a[b+".range[1]"]=g[1]}return a}},{"../../lib":515,"d3-time":122}],438:[function(a,b,c){"use strict";b.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:a("./attributes")}}},layoutAttributes:a("./attributes"),handleDefaults:a("./defaults"),draw:a("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(b,c,d){"use strict";var a=b("../color/attributes");c.exports={bgcolor:{valType:"color",dflt:a.background,editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axis_ids").list,e=a("../../plots/cartesian/autorange").getAutoRange,f=a("./constants");b.exports=function(c){for(var g=d(c,"x",!0),b=0;b<g.length;b++){var h=g[b],a=h[f.name];a&&a.visible&&a.autorange&&(a._input.autorange=!0,a._input.range=a.range=e(c,h))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(b,a,c){"use strict";a.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plot_api/plot_template"),f=a("../../plots/cartesian/axis_ids"),g=a("./attributes"),h=a("./oppaxis_attributes");b.exports=function(s,a,m){var b=s[m],c=a[m];if(b.rangeslider||a._requestRangeslider[c._id]){d.isPlainObject(b.rangeslider)||(b.rangeslider={});var i=b.rangeslider,n=e.newContainer(c,"rangeslider");if(w("visible")){w("bgcolor",a.plot_bgcolor),w("bordercolor"),w("borderwidth"),w("thickness"),w("autorange",!c.isValidRange(i.range)),w("range");var o=a._subplots;if(o)for(var t=o.cartesian.filter(function(a){return a.substr(0,a.indexOf("y"))===f.name2id(m)}).map(function(a){return a.substr(a.indexOf("y"),a.length)}),p=d.simpleMap(t,f.id2name),j=0;j<p.length;j++){var k,u,q,l=p[j];k=i[l]||{},u=e.newContainer(n,l,"yaxis");var r=a[l];k.range&&r.isValidRange(k.range)&&(q="fixed");var v=x("rangemode",q);"match"!==v&&x("range",r.range.slice())}n._input=i}}function w(a,b){return d.coerce(i,n,g,a,b)}function x(a,b){return d.coerce(k,u,h,a,b)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../registry"),g=a("../../plots/plots"),c=a("../../lib"),h=c.strTranslate,i=a("../drawing"),j=a("../color"),k=a("../titles"),l=a("../../plots/cartesian"),m=a("../../plots/cartesian/axis_ids"),n=a("../dragelement"),o=a("../../lib/setcursor"),p=a("./constants");function q(e,f,l,a){var g=c.ensureSingle(e,"rect",p.bgClassName,function(a){a.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),b=a.borderwidth%2==0?a.borderwidth:a.borderwidth-1,d=-a._offsetShift,k=i.crispRound(f,a.borderwidth);g.attr({width:a._width+b,height:a._height+b,transform:h(d,d),"stroke-width":k}).call(j.stroke,a.bordercolor).call(j.fill,a.bgcolor)}function r(e,b,f,a){var d=b._fullLayout;c.ensureSingleById(d._topdefs,"clipPath",a._clipId,function(a){a.append("rect").attr({x:0,y:0})}).select("rect").attr({width:a._width,height:a._height})}function s(d,b,f,h){var j,k=b.calcdata,a=d.selectAll("g."+p.rangePlotClassName).data(f._subplotsWith,c.identity);a.enter().append("g").attr("class",function(a){return p.rangePlotClassName+" "+a}).call(i.setClipUrl,h._clipId,b),a.order(),a.exit().remove(),a.each(function(n,r){var s=e.select(this),a=m.getFromId(b,n,"y"),d=a._name,q=h[d],c={data:[],layout:{xaxis:{type:f.type,domain:[0,1],range:h.range.slice(),calendar:f.calendar},width:h._width,height:h._height,margin:{t:0,b:0,l:0,r:0}},_context:b._context};f.rangebreaks&&(c.layout.xaxis.rangebreaks=f.rangebreaks),c.layout[d]={type:a.type,domain:[0,1],range:"match"!==q.rangemode?q.range.slice():a.range.slice(),calendar:a.calendar},a.rangebreaks&&(c.layout[d].rangebreaks=a.rangebreaks),g.supplyDefaults(c);var o=c._fullLayout.xaxis,p=c._fullLayout[d];o.clearCalc(),o.setScale(),p.clearCalc(),p.setScale();var i={id:n,plotgroup:s,xaxis:o,yaxis:p,isRangePlot:!0};0===r?j=i:(i.mainplot="xy",i.mainplotinfo=j),l.rangePlot(b,i,t(k,n))})}function t(b,f){for(var c=[],a=0;a<b.length;a++){var d=b[a],e=d[0].trace;e.xaxis+e.yaxis===f&&c.push(d)}return c}function u(a,e,f,b,d){c.ensureSingle(a,"rect",p.maskMinClassName,function(a){a.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",b._height).call(j.fill,p.maskColor),c.ensureSingle(a,"rect",p.maskMaxClassName,function(a){a.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",b._height).call(j.fill,p.maskColor),"match"!==d.rangemode&&(c.ensureSingle(a,"rect",p.maskMinOppAxisClassName,function(a){a.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",b._width).call(j.fill,p.maskOppAxisColor),c.ensureSingle(a,"rect",p.maskMaxOppAxisClassName,function(a){a.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",b._width).style("border-top",p.maskOppBorder).call(j.fill,p.maskOppAxisColor))}function v(a,b,e,d){b._context.staticPlot||c.ensureSingle(a,"rect",p.slideBoxClassName,function(a){a.attr({y:0,cursor:p.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:d._height,fill:p.slideBoxFill})}function w(b,g,h,a){var d=c.ensureSingle(b,"g",p.grabberMinClassName),e=c.ensureSingle(b,"g",p.grabberMaxClassName),i={x:0,width:p.handleWidth,rx:p.handleRadius,fill:j.background,stroke:j.defaultLine,"stroke-width":p.handleStrokeWidth,"shape-rendering":"crispEdges"},f={y:Math.round(a._height/4),height:Math.round(a._height/2)};c.ensureSingle(d,"rect",p.handleMinClassName,function(a){a.attr(i)}).attr(f),c.ensureSingle(e,"rect",p.handleMaxClassName,function(a){a.attr(i)}).attr(f);var k={width:p.grabAreaWidth,x:0,y:0,fill:p.grabAreaFill,cursor:g._context.staticPlot?void 0:p.grabAreaCursor};c.ensureSingle(d,"rect",p.grabAreaMinClassName,function(a){a.attr(k)}).attr("height",a._height),c.ensureSingle(e,"rect",p.grabAreaMaxClassName,function(a){a.attr(k)}).attr("height",a._height)}b.exports=function(j){for(var b=j._fullLayout,a=b._rangeSliderData,d=0;d<a.length;d++){var i=a[d][p.name];i._clipId=i._id+"-"+b._uid}var g=b._infolayer.selectAll("g."+p.containerClassName).data(a,function(a){return a._name});g.exit().each(function(a){var c=a[p.name];b._topdefs.select("#"+c._clipId).remove()}).remove(),0!==a.length&&(g.enter().append("g").classed(p.containerClassName,!0).attr("pointer-events","all"),g.each(function(a){var z=e.select(this),d=a[p.name],C=b[m.id2name(a.anchor)],x=d[m.id2name(a.anchor)];if(d.range){var G,A=c.simpleMap(d.range,a.r2l),t=c.simpleMap(a.range,a.r2l);G=t[0]<t[1]?[Math.min(A[0],t[0]),Math.max(A[1],t[1])]:[Math.max(A[0],t[0]),Math.min(A[1],t[1])],d.range=d._input.range=c.simpleMap(G,a.l2r)}a.cleanRange("rangeslider.range");var y=b._size,D=a.domain;d._width=y.w*(D[1]-D[0]);var K=Math.round(y.l+y.w*D[0]),H=Math.round(y.t+y.h*(1-a._counterDomainMin)+("bottom"===a.side?a._depth:0)+d._offsetShift+p.extraPad);z.attr("transform",h(K,H)),d._rl=c.simpleMap(d.range,a.r2l);var B=d._rl[0],E=d._rl[1],M=E-B;if(d.p2d=function(a){return a/d._width*M+B},d.d2p=function(a){return(a-B)/M*d._width},a.rangebreaks){var l=a.locateBreaks(B,E);if(l.length){var g,i,I=0;for(g=0;g<l.length;g++)I+=(i=l[g]).max-i.min;var J=d._width/(E-B-I),F=[-J*B];for(g=0;g<l.length;g++)i=l[g],F.push(F[F.length-1]-J*(i.max-i.min));for(g=0,d.d2p=function(b){for(var c=F[0],a=0;a<l.length;a++){var d=l[a];if(b>=d.max)c=F[a+1];else if(b<d.min)break}return c+J*b};g<l.length;g++)(i=l[g]).pmin=d.d2p(i.min),i.pmax=d.d2p(i.max);d.p2d=function(b){for(var c=F[0],a=0;a<l.length;a++){var d=l[a];if(b>=d.pmax)c=F[a+1];else if(b<d.pmin)break}return(b-c)/J}}}if("match"!==x.rangemode){var L=C.r2l(x.range[0]),N=C.r2l(x.range[1])-L;d.d2pOppAxis=function(a){return(a-L)/N*d._height}}z.call(q,j,a,d).call(r,j,a,d).call(s,j,a,d).call(u,j,a,d,x).call(v,j,a,d).call(w,j,a,d),function(a,b,d,g){if(!b._context.staticPlot){var h=a.select("rect."+p.slideBoxClassName).node(),i=a.select("rect."+p.grabAreaMinClassName).node(),j=a.select("rect."+p.grabAreaMaxClassName).node();a.on("mousedown",k),a.on("touchstart",k)}function k(){var k=e.event,r=k.target,q=k.clientX||k.touches[0].clientX,s=q-a.node().getBoundingClientRect().left,t=g.d2p(d._rl[0]),u=g.d2p(d._rl[1]),l=n.coverSlip();function m(v){var k,m,n,p=+(v.clientX||v.touches[0].clientX)-q;switch(r){case h:n="ew-resize",k=t+p,m=u+p;break;case i:n="col-resize",k=t+p,m=u;break;case j:n="col-resize",k=t,m=u+p;break;default:n="ew-resize",k=s,m=s+p;break}if(m<k){var w=m;m=k,k=w}g._pixelMin=k,g._pixelMax=m,o(e.select(l),n),function(d,e,g,a){function b(b){return g.l2r(c.constrain(b,a._rl[0],a._rl[1]))}var h=b(a.p2d(a._pixelMin)),i=b(a.p2d(a._pixelMax));window.requestAnimationFrame(function(){f.call("_guiRelayout",e,g._name+".range",[h,i])})}(a,b,d,g)}function p(){l.removeEventListener("mousemove",m),l.removeEventListener("mouseup",p),this.removeEventListener("touchmove",m),this.removeEventListener("touchend",p),c.removeElement(l)}this.addEventListener("touchmove",m),this.addEventListener("touchend",p),l.addEventListener("mousemove",m),l.addEventListener("mouseup",p)}}(z,j,a,d),function(a,s,i,b,j,o){var k=p.handleWidth/2;function l(a){return c.constrain(a,0,b._width)}function m(a){return c.constrain(a,0,b._height)}function n(a){return c.constrain(a,-k,b._width+k)}var d=l(b.d2p(i._rl[0])),e=l(b.d2p(i._rl[1]));if(a.select("rect."+p.slideBoxClassName).attr("x",d).attr("width",e-d),a.select("rect."+p.maskMinClassName).attr("width",d),a.select("rect."+p.maskMaxClassName).attr("x",e).attr("width",b._width-e),"match"!==o.rangemode){var f=b._height-m(b.d2pOppAxis(j._rl[1])),g=b._height-m(b.d2pOppAxis(j._rl[0]));a.select("rect."+p.maskMinOppAxisClassName).attr("x",d).attr("height",f).attr("width",e-d),a.select("rect."+p.maskMaxOppAxisClassName).attr("x",d).attr("y",g).attr("height",b._height-g).attr("width",e-d),a.select("rect."+p.slideBoxClassName).attr("y",f).attr("height",g-f)}var q=Math.round(n(d-k))-.5,r=Math.round(n(e-k))+.5;a.select("g."+p.grabberMinClassName).attr("transform",h(q,.5)),a.select("g."+p.grabberMaxClassName).attr("transform",h(r,.5))}(z,j,a,d,C,x),"bottom"===a.side&&k.draw(j,a._id+"title",{propContainer:a,propName:a._name+".title",placeholder:b._dfltTitle.x,attributes:{x:a._offset+a._length/2,y:H+d._height+d._offsetShift+10+1.5*a.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(a,e,b){"use strict";var f=a("../../plots/cartesian/axis_ids"),g=a("../../lib/svg_text_utils"),c=a("./constants"),h=a("../../constants/alignment").LINE_SPACING,i=c.name;function d(a){var b=a&&a[i];return b&&b.visible}b.isVisible=d,b.makeData=function(a){var g=f.list({_fullLayout:a},"x",!0),h=a.margin,j=[];if(!a._has("gl2d"))for(var e=0;e<g.length;e++){var c=g[e];if(d(c)){j.push(c);var b=c[i];b._id=i+c._id,b._height=(a.height-h.b-h.t)*b.thickness,b._offsetShift=Math.floor(b.borderwidth/2)}}a._rangeSliderData=j},b.autoMarginOpts=function(j,a){var e=j._fullLayout,b=a[i],k=a._id.charAt(0),f=0,d=0;if("bottom"===a.side&&(f=a._depth,a.title.text!==e._dfltTitle[k])){d=1.5*a.title.font.size+10+b._offsetShift;var l=(a.title.text.match(g.BR_TAG_ALL)||[]).length;d+=l*a.title.font.size*h}return{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:b._height+f+Math.max(e.margin.b,d),pad:c.extraPad+2*b._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(a,c,g){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("./oppaxis_attributes"),b=a("./helpers");c.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:d.extendFlat({},e,{yaxis:f})}}},layoutAttributes:a("./attributes"),handleDefaults:a("./defaults"),calcAutorange:a("./calc_autorange"),draw:a("./draw"),isVisible:b.isVisible,makeData:b.makeData,autoMarginOpts:b.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(b,a,c){"use strict";a.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(a,e,i){"use strict";var c=a("../annotations/attributes"),d=a("../../traces/scatter/attributes").line,f=a("../drawing/attributes").dash,b=a("../../lib/extend").extendFlat,g=a("../../plot_api/edit_types").overrideAll,h=a("../../plot_api/plot_template").templatedArray;a("../../constants/axis_placeable_objects"),e.exports=g(h("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:b({},c.xref,{}),yref:b({},c.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:d.color,width:b({},d.width,{min:1,dflt:1}),dash:b({},f,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(b,a,c){"use strict";a.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../../plots/array_container_defaults"),g=a("./attributes"),h=a("../shapes/helpers");function i(a,b,t){function c(c,e){return d.coerce(a,b,g,c,e)}var u=c("path"),k="path"!==c("type",u?"path":"rect");k&&delete b.path,c("opacity"),c("line.color"),c("line.width"),c("line.dash");for(var v=["x","y"],l=0;l<2;l++){var m,n,o,p=v[l],j={_fullLayout:t},q=e.coerceRef(a,b,j,p);if((m=e.getFromId(j,q))._selectionIndices.push(b._index),o=h.rangeToShapePosition(m),n=h.shapePositionToRange(m),k){var f=p+"0",i=p+"1",w=a[f],x=a[i];a[f]=n(a[f],!0),a[i]=n(a[i],!0),e.coercePosition(b,j,c,q,f),e.coercePosition(b,j,c,q,i);var r=b[f],s=b[i];void 0!==r&& void 0!==s&&(b[f]=o(r),b[i]=o(s),a[f]=w,a[i]=x)}}k&&d.noneOrAll(a,b,["x0","x1","y0","y1"])}b.exports=function(e,c){f(e,c,{name:"selections",handleItemDefaults:i});for(var d=c.selections,b=0;b<d.length;b++){var a=d[b];a&& void 0===a.path&&(void 0===a.x0|| void 0===a.x1|| void 0===a.y0|| void 0===a.y1)&&(c.selections[b]=null)}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(a,b,f){"use strict";var g=a("../shapes/draw_newshape/helpers").readPaths,h=a("../shapes/display_outlines"),i=a("../shapes/handle_outline").clearOutlineControllers,j=a("../color"),k=a("../drawing"),l=a("../../plot_api/plot_template").arrayEditor,c=a("../shapes/helpers"),m=c.getPathString;function d(b){var a=b._fullLayout;for(var f in i(b),a._selectionLayer.selectAll("path").remove(),a._plots){var d=a._plots[f].selectionLayer;d&&d.selectAll("path").remove()}for(var c=0;c<a.selections.length;c++)e(b,c)}function n(a){return a._context.editSelection}function e(a,b){a._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+b+'"]').remove();var d=c.makeSelectionsOptionsAndPlotinfo(a,b),e=d.options,f=d.plotinfo;e._input&&function(w){var r=m(a,e),x={"data-index":b,"fill-rule":"evenodd",d:r},s=e.opacity,t="rgba(0,0,0,0)",y=e.line.color||j.contrast(a._fullLayout.plot_bgcolor),i=e.line.width,u=e.line.dash;i||(i=5,u="solid");var v=n(a)&&a._fullLayout._activeSelectionIndex===b;v&&(t=a._fullLayout.activeselection.fillcolor,s=a._fullLayout.activeselection.opacity);for(var q=[],c=1;c>=0;c--){var d=w.append("path").attr(x).style("opacity",c?.1:s).call(j.stroke,y).call(j.fill,t).call(k.dashLine,c?"solid":u,c?4+i:i);if(o(d,a,e),v){var z=l(a.layout,"selections",e);d.style({cursor:"move"});var A={element:d.node(),plotinfo:f,gd:a,editHelpers:z,isActiveSelection:!0},B=g(r,a);h(B,d,A)}else d.style("pointer-events",c?"all":"none");q[c]=d}var C=q[0];q[1].node().addEventListener("click",function(){return p(a,C)})}(a._fullLayout._selectionLayer)}function o(c,a,b){var d=b.xref+b.yref;k.setClipUrl(c,"clip"+a._fullLayout._uid+d,a)}function p(a,c){if(n(a)){var b=+c.node().getAttribute("data-index");if(b>=0){if(b===a._fullLayout._activeSelectionIndex){q(a);return}a._fullLayout._activeSelectionIndex=b,a._fullLayout._deactivateSelection=q,d(a)}}}function q(a){n(a)&&a._fullLayout._activeSelectionIndex>=0&&(i(a),delete a._fullLayout._activeSelectionIndex,d(a))}b.exports={draw:d,drawOne:e,activateLastSelection:function(a){if(n(a)){var b=a._fullLayout.selections.length-1;a._fullLayout._activeSelectionIndex=b,a._fullLayout._deactivateSelection=q,d(a)}}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(a,b,e){"use strict";var c=a("../../drawing/attributes").dash,d=a("../../../lib/extend").extendFlat;b.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:d({},c,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(b,a,c){"use strict";a.exports=function(b,c,a){a("newselection.mode"),a("newselection.line.width")&&(a("newselection.line.color"),a("newselection.line.dash")),a("activeselection.fillcolor"),a("activeselection.opacity")}},{}],453:[function(a,c,d){"use strict";var e=a("../../dragelement/helpers").selectMode,f=a("../../shapes/handle_outline").clearOutline,b=a("../../shapes/draw_newshape/helpers"),g=b.readPaths,h=b.writePaths,i=b.fixDatesForPaths;c.exports=function(w,j){if(w.length){var b,x=w[0][0];if(x){var A=x.getAttribute("d"),c=j.gd,m=c._fullLayout.newselection,s=j.plotinfo,t=s.xaxis,u=s.yaxis,n=j.isActiveSelection,o=j.dragmode,y=(c.layout||{}).selections||[];if(!e(o)&& void 0!==n){var z=c._fullLayout._activeSelectionIndex;if(z<y.length)switch(c._fullLayout.selections[z].type){case"rect":o="select";break;case"path":o="lasso";break}}var p=g(A,c,s,n),a={xref:t._id,yref:u._id,opacity:m.opacity,line:{color:m.line.color,width:m.line.width,dash:m.line.dash}};1===p.length&&(b=p[0]),b&&5===b.length&&"select"===o?(a.type="rect",a.x0=b[0][1],a.y0=b[0][2],a.x1=b[2][1],a.y1=b[2][2]):(a.type="path",t&&u&&i(p,t,u),a.path=h(p),b=null),f(c);for(var v=j.editHelpers,k=(v||{}).modifyItem,q=[],d=0;d<y.length;d++){var r=c._fullLayout.selections[d];if(!r){q[d]=r;continue}if(q[d]=r._input,void 0!==n&&d===c._fullLayout._activeSelectionIndex){var l=a;switch(r.type){case"rect":k("x0",l.x0),k("x1",l.x1),k("y0",l.y0),k("y1",l.y1);break;case"path":k("path",l.path);break}}}return void 0===n?(q.push(a),q):v?v.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(a,b,d){"use strict";var e=a("../../lib").strTranslate;function c(a,b){switch(a.type){case"log":return a.p2d(b);case"date":return a.p2r(b,0,a.calendar);default:return a.p2r(b)}}b.exports={p2r:c,r2p:function(a,b){switch(a.type){case"log":return a.d2p(b);case"date":return a.r2p(b,0,a.calendar);default:return a.r2p(b)}},axValue:function(a){var b="y"===a._id.charAt(0)?1:0;return function(d){return c(a,d[b])}},getTransform:function(a){return e(a.xaxis._offset,a.yaxis._offset)}}},{"../../lib":515}],455:[function(a,d,e){"use strict";var c=a("./draw"),b=a("./select");d.exports={moduleType:"component",name:"selections",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),supplyDrawNewSelectionDefaults:a("./draw_newselection/defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("selections"),draw:c.draw,drawOne:c.drawOne,reselect:b.reselect,prepSelect:b.prepSelect,clearOutline:b.clearOutline,clearSelectionsCache:b.clearSelectionsCache,selectOnClick:b.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(a,f,m){"use strict";var n=a("polybooljs"),o=a("point-in-polygon/nested"),p=a("../../registry"),q=a("../drawing").dashStyle,r=a("../color"),s=a("../fx"),t=a("../fx/helpers").makeEventData,b=a("../dragelement/helpers"),u=b.freeMode,v=b.rectMode,w=b.drawMode,x=b.openMode,y=b.selectMode,z=a("../shapes/helpers"),A=a("../shapes/constants"),B=a("../shapes/display_outlines"),g=a("../shapes/handle_outline").clearOutline,d=a("../shapes/draw_newshape/helpers"),C=d.handleEllipse,D=d.readPaths,E=a("../shapes/draw_newshape/newshapes"),F=a("./draw_newselection/newselections"),G=a("./draw").activateLastSelection,h=a("../../lib"),H=h.sorterAsc,e=a("../../lib/polygon"),I=a("../../lib/throttle"),J=a("../../plots/cartesian/axis_ids").getFromId,K=a("../../lib/clear_gl_canvases"),L=a("../../plot_api/subroutines").redrawReglTraces,i=a("./constants"),M=i.MINSELECT,N=e.filter,O=e.tester,c=a("./helpers"),P=c.p2r,Q=c.axValue,R=c.getTransform;function S(a){return void 0!==a.subplot}function j(n,c,t,u,v,d,f){var a,o,g,j,h,l,p,q,b,r=c._hoverdata,s=c._fullLayout.clickmode.indexOf("event")> -1,i=[];if(_(r)){X(n,c,d);var e=aa(r,a=Z(c,t,u,v));if(e.pointNumbers.length>0?ac(a,e):ad(a)&&(l=ab(e))){for(f&&f.remove(),b=0;b<a.length;b++)(o=a[b])._module.selectPoints(o,!1);ae(c,a),k(d),s&&av(c)}else{p=n.shiftKey&&(void 0!==l?l:ab(e)),g=T(e.pointNumber,e.searchInfo,p);var w=d.selectionDefs.concat([g]);for(b=0,j=W(w,j);b<a.length;b++)if(h=ah(a[b]._module.selectPoints(a[b],j),a[b]),i.length)for(var m=0;m<h.length;m++)i.push(h[m]);else i=h;if(ae(c,a,q={points:i}),g&&d&&d.selectionDefs.push(g),f){var y=d.mergedPolygons,z=x(d.dragmode);B(ai(y,z),f,d)}s&&au(c,q)}}}function T(a,b,c){return{pointNumber:a,searchInfo:b,subtract:!!c}}function U(a){return"pointNumber"in a&&"searchInfo"in a}function V(a){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(e,f,b,c){var d=a.searchInfo.cd[0].trace._expandedIndex;return c.cd[0].trace._expandedIndex===d&&b===a.pointNumber},isRect:!1,degenerate:!1,subtract:!!a.subtract}}function W(a){if(a.length){for(var h=[],d=U(a[0])?0:a[0][0][0],f=d,e=U(a[0])?0:a[0][0][1],g=e,b=0;b<a.length;b++)if(U(a[b]))h.push(V(a[b]));else{var c=O(a[b]);c.subtract=!!a[b].subtract,h.push(c),d=Math.min(d,c.xmin),f=Math.max(f,c.xmax),e=Math.min(e,c.ymin),g=Math.max(g,c.ymax)}return{xmin:d,xmax:f,ymin:e,ymax:g,pts:[],contains:function(c,d,e,f){for(var b=!1,a=0;a<h.length;a++)h[a].contains(c,d,e,f)&&(b=!h[a].subtract);return b},isRect:!1,degenerate:!1}}}function X(d,e,b){var c=e._fullLayout,a=b.plotinfo,f=b.dragmode,h=c._lastSelectedSubplot&&c._lastSelectedSubplot===a.id,i=(d.shiftKey||d.altKey)&&!(w(f)&&x(f));h&&i&&a.selection&&a.selection.selectionDefs&&!b.selectionDefs?(b.selectionDefs=a.selection.selectionDefs,b.mergedPolygons=a.selection.mergedPolygons):i&&a.selection||k(b),h||(g(e),c._lastSelectedSubplot=a.id)}function k(b,k){var g=b.dragmode,c=b.plotinfo,a=b.gd;a._fullLayout._activeShapeIndex>=0&&a._fullLayout._deactivateShape(a),a._fullLayout._activeSelectionIndex>=0&&a._fullLayout._deactivateSelection(a);var j=a._fullLayout._zoomlayer,h=w(g),i=y(g);if(h||i){var d,e,f=j.selectAll(".select-outline-"+c.id);f&&a._fullLayout._outlining&&(h&&(d=E(f,b)),d&&p.call("_guiRelayout",a,{shapes:d}),i&&!S(b)&&(e=F(f,b)),e&&(a._fullLayout._noEmitSelectedAtStart=!0,p.call("_guiRelayout",a,{selections:e}).then(function(){k&&G(a)})),a._fullLayout._outlining=!1)}c.selection={},c.selection.selectionDefs=b.selectionDefs=[],c.selection.mergedPolygons=b.mergedPolygons=[]}function Y(a){return a._id}function Z(b,e,f,h){if(!b.calcdata)return[];var c,a,g,d=[],i=e.map(Y),j=f.map(Y);for(g=0;g<b.calcdata.length;g++)if(!0===(a=(c=b.calcdata[g])[0].trace).visible&&a._module&&a._module.selectPoints)if(S({subplot:h})&&(a.subplot===h||a.geo===h))d.push($(a._module,c,e[0],f[0]));else if("splom"===a.type){if(a._xaxes[i[0]]&&a._yaxes[j[0]]){var k=$(a._module,c,e[0],f[0]);k.scene=b._fullLayout._splomScenes[a.uid],d.push(k)}}else if("sankey"===a.type){var l=$(a._module,c,e[0],f[0]);d.push(l)}else{if(-1===i.indexOf(a.xaxis))continue;if(-1===j.indexOf(a.yaxis))continue;d.push($(a._module,c,J(b,a.xaxis),J(b,a.yaxis)))}return d}function $(a,b,c,d){return{_module:a,cd:b,xaxis:c,yaxis:d}}function _(a){return a&&Array.isArray(a)&& !0!==a[0].hoverOnBox}function aa(g,e){var c,b,a=g[0],d=-1,f=[];for(b=0;b<e.length;b++)if(c=e[b],a.fullData._expandedIndex===c.cd[0].trace._expandedIndex){if(!0===a.hoverOnBox)break;void 0!==a.pointNumber?d=a.pointNumber:void 0!==a.binNumber&&(d=a.binNumber,f=a.pointNumbers);break}return{pointNumber:d,pointNumbers:f,searchInfo:c}}function ab(a){var b=a.searchInfo.cd[0].trace,d=a.pointNumber,c=a.pointNumbers,e=c.length>0,f=e?c[0]:d;return!!b.selectedpoints&&b.selectedpoints.indexOf(f)> -1}function ac(e,b){var c,f,a,d=[];for(a=0;a<e.length;a++)(c=e[a]).cd[0].trace.selectedpoints&&c.cd[0].trace.selectedpoints.length>0&&d.push(c);if(1===d.length&&d[0]===b.searchInfo&&(f=b.searchInfo.cd[0].trace).selectedpoints.length===b.pointNumbers.length){for(a=0;a<b.pointNumbers.length;a++)if(0>f.selectedpoints.indexOf(b.pointNumbers[a]))return!1;return!0}return!1}function ad(c){var b,a,d=0;for(a=0;a<c.length;a++)if((b=c[a].cd[0].trace).selectedpoints){if(b.selectedpoints.length>1)return!1;if((d+=b.selectedpoints.length)>1)return!1}return 1===d}function ae(g,c,h){for(b=0;b<c.length;b++){var b,a,i=c[b].cd[0].trace._fullInput,j=g._fullLayout._tracePreGUI[i.uid]||{};void 0===j.selectedpoints&&(j.selectedpoints=i._input.selectedpoints||null)}if(h){var k=h.points||[];for(b=0;b<c.length;b++)(a=c[b].cd[0].trace)._input.selectedpoints=a._fullInput.selectedpoints=[],a._fullInput!==a&&(a.selectedpoints=[]);for(var e=0;e<k.length;e++){var d=k[e],l=d.data,m=d.fullData,n=d.pointIndex,f=d.pointIndices;f?([].push.apply(l.selectedpoints,f),a._fullInput!==a&&[].push.apply(m.selectedpoints,f)):(l.selectedpoints.push(n),a._fullInput!==a&&m.selectedpoints.push(n))}}else for(b=0;b<c.length;b++)delete(a=c[b].cd[0].trace).selectedpoints,delete a._input.selectedpoints,a._fullInput!==a&&delete a._fullInput.selectedpoints;af(g,c)}function af(b,e){for(var f=!1,c=0;c<e.length;c++){var g=e[c],a=g.cd;p.traceIs(a[0].trace,"regl")&&(f=!0);var h=g._module,d=h.styleOnSelect||h.style;d&&(d(b,a,a[0].node3),a[0].nodeRangePlot3&&d(b,a,a[0].nodeRangePlot3))}f&&(K(b),L(b))}function ag(d,e,f){for(var a=(f?n.difference:n.union)({regions:d},{regions:[e]}).regions.reverse(),b=0;b<a.length;b++){var c=a[b];c.subtract=ap(c,a.slice(0,b))}return a}function ah(a,c){if(Array.isArray(a))for(var d=c.cd,e=c.cd[0].trace,b=0;b<a.length;b++)a[b]=t(a[b],e,d);return a}function ai(d,f){for(var b=[],a=0;a<d.length;a++){b[a]=[];for(var c=0;c<d[a].length;c++){b[a][c]=[],b[a][c][0]=c?"L":"M";for(var e=0;e<d[a][c].length;e++)b[a][c].push(d[a][c][e])}f||b[a].push(["Z",b[a][0][1],b[a][0][2]])}return b}function aj(g,e){for(var f,a,b=[],h=[],c=0;c<e.length;c++){var d=e[c];a=d._module.selectPoints(d,g),h.push(a),f=ah(a,d),b=b.concat(f)}return b}function l(a,E,F,q,l){var e,b,c,W=!!q;l&&(e=l.plotinfo,b=l.xaxes[0]._id,c=l.yaxes[0]._id);var r=[],m=[],s=ao(a),d=a._fullLayout;if(e){var X=d._zoomlayer,G=d.dragmode,Y=w(G),$=y(G);if(Y||$){var H=J(a,b,"x"),I=J(a,c,"y");if(H&&I){var t=X.selectAll(".select-outline-"+e.id);if(t&&a._fullLayout._outlining&&t.length){for(var K=D(t[0][0].getAttribute("d"),a,e),u=[],v=0;v<K.length;v++){for(var x=K[v],f=[],n=0;n<x.length;n++)f.push([aq(H,x[n][1]),aq(I,x[n][2])]);f.xref=b,f.yref=c,f.subtract=ap(f,u),u.push(f)}s=s.concat(u)}}}}var L=b&&c?[b+c]:d._subplots.cartesian;ak(a);for(var M={},z=0;z<L.length;z++){var o=L[z],N=o.indexOf("y"),O=o.slice(0,N),P=o.slice(N),A=b&&c?F:void 0;if(A=an(s,O,P,A)){var j=q;if(!W){var Q=J(a,O,"x"),R=J(a,P,"y");j=Z(a,[Q],[R],o);for(var B=0;B<j.length;B++){var C=j[B],g=C.cd[0],k=g.trace;if("scattergl"===C._module.name&&!g.t.xpx){var _=k.x,aa=k.y,ab=k._length;g.t.xpx=[],g.t.ypx=[];for(var h=0;h<ab;h++)g.t.xpx[h]=Q.c2p(_[h]),g.t.ypx[h]=R.c2p(aa[h])}"splom"!==C._module.name||M[k.uid]||(M[k.uid]=!0)}}var ac=aj(A,j);r=r.concat(ac),m=m.concat(j)}}var i={points:r};ae(a,m,i);var S=d.clickmode.indexOf("event")> -1&&E;if(!e&&E){var p=ao(a,!0);if(p.length){var T=p[0].xref,U=p[0].yref;if(T&&U){var ad=ar(p);at([J(a,T,"x"),J(a,U,"y")])(i,ad)}}a._fullLayout._noEmitSelectedAtStart?a._fullLayout._noEmitSelectedAtStart=!1:S&&au(a,i),d._reselect=!1}if(!e&&d._deselect){var V=d._deselect;b=V.xref,c=V.yref,al(b,c,m)||am(a,b,c,q),S&&(i.points.length?au(a,i):av(a)),d._deselect=!1}return{eventData:i,selectionTesters:F}}function ak(c){var a=c.calcdata;if(a)for(var b=0;b<a.length;b++){var f=a[b][0].trace,d=c._fullLayout._splomScenes;if(d){var e=d[f.uid];e&&(e.selectBatch=[])}}}function al(d,e,c){for(var b=0;b<c.length;b++){var a=c[b];if(a.xaxis&&a.xaxis._id===d&&a.yaxis&&a.yaxis._id===e)return!0}return!1}function am(a,d,e,b){b=Z(a,[J(a,d,"x")],[J(a,e,"y")],d+e);for(var c=0;c<b.length;c++){var f=b[c];f._module.selectPoints(f,!1)}ae(a,b)}function an(e,f,g,c){for(var b,d=0;d<e.length;d++){var a=e[d];if(f===a.xref&&g===a.yref)if(b){var h=!!a.subtract;c=W(b=ag(b,a,h))}else b=[a],c=O(a)}return c}function ao(n,D){for(var o=[],w=n._fullLayout,x=w.selections,E=x.length,g=0;g<E;g++)if(!D||g===w._activeSelectionIndex){var c,d,e,f,a,b=x[g];if(b){var p=b.xref,q=b.yref,r=J(n,p,"x"),s=J(n,q,"y");if("rect"===b.type){a=[];var h=aq(r,b.x0),i=aq(r,b.x1),j=aq(s,b.y0),k=aq(s,b.y1);a=[[h,j],[h,k],[i,k],[i,j]],c=Math.min(h,i),d=Math.max(h,i),e=Math.min(j,k),f=Math.max(j,k),a.xmin=c,a.xmax=d,a.ymin=e,a.ymax=f,a.xref=p,a.yref=q,a.subtract=!1,a.isRect=!0,o.push(a)}else if("path"===b.type)for(var y=b.path.split("Z"),B=[],t=0;t<y.length;t++){var l=y[t];if(l){l+="Z";var C=z.extractPathCoords(l,A.paramIsX,"raw"),F=z.extractPathCoords(l,A.paramIsY,"raw");c=1/0,d=-1/0,e=1/0,f=-1/0,a=[];for(var m=0;m<C.length;m++){var u=aq(r,C[m]),v=aq(s,F[m]);a.push([u,v]),c=Math.min(u,c),d=Math.max(u,d),e=Math.min(v,e),f=Math.max(v,f)}a.xmin=c,a.xmax=d,a.ymin=e,a.ymax=f,a.xref=p,a.yref=q,a.subtract=ap(a,B),B.push(a),o.push(a)}}}}return o}function ap(d,e){for(var a=!1,b=0;b<e.length;b++)for(var f=e[b],c=0;c<d.length;c++)if(o(d[c],f)){a=!a;break}return a}function aq(a,b){return"date"===a.type&&(b=b.replace("_"," ")),"log"===a.type?a.c2p(b):a.r2p(b,null,a.calendar)}function ar(c){for(var e=c.length,a=[],b=0;b<e;b++){var d=c[b];a=(a=a.concat(d)).concat([d[0]])}return as(a)}function as(a){return a.isRect=5===a.length&&a[0][0]===a[4][0]&&a[0][1]===a[4][1]&&a[0][0]===a[1][0]&&a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[1][1]===a[2][1]||a[0][1]===a[1][1]&&a[2][1]===a[3][1]&&a[0][0]===a[3][0]&&a[1][0]===a[2][0],a.isRect&&(a.xmin=Math.min(a[0][0],a[2][0]),a.xmax=Math.max(a[0][0],a[2][0]),a.ymin=Math.min(a[0][1],a[2][1]),a.ymax=Math.max(a[0][1],a[2][1])),a}function at(a){return function(h,d){for(var b,c,f=0;f<a.length;f++){var e=a[f],g=e._id,i=g.charAt(0);if(d.isRect){b||(b={});var j=d[i+"min"],k=d[i+"max"];void 0!==j&& void 0!==k&&(b[g]=[P(e,j),P(e,k)].sort(H))}else c||(c={}),c[g]=d.map(Q(e))}b&&(h.range=b),c&&(h.lassoPoints=c)}}function au(b,a){a&&(a.selections=(b.layout||{}).selections||[]),b.emit("plotly_selected",a)}function av(a){a.emit("plotly_deselect",null)}f.exports={reselect:l,prepSelect:function(n,H,J,a,c){var K,ab,ac,ad,af,ah,ak,z=!S(a),L=u(c),al=v(c),A=x(c),m=w(c),P=y(c),Q="drawline"===c,T="drawcircle"===c,an=Q||T,e=a.gd,b=e._fullLayout,U=P&&"immediate"===b.newselection.mode&&z,D=b._zoomlayer,E=a.element.getBoundingClientRect(),o=a.plotinfo,F=R(o),f=H-E.left,g=J-E.top;b._calcInverseTransform(e);var G=h.apply3DTransform(b._invTransform)(f,g);f=G[0],g=G[1];var ao=b._invScaleX,ap=b._invScaleY,aq=f,as=g,V=a.xaxes[0],Y=a.yaxes[0],aw=V._length,ax=Y._length,ay=n.altKey&&!(w(c)&&A);X(n,e,a),L&&(K=N([[f,g]],i.BENDPX));var $=D.selectAll("path.select-outline-"+o.id).data([1]),d=m?b.newshape:b.newselection,_=m&&!A?d.fillcolor:"rgba(0,0,0,0)",aa=d.line.color||(z?r.contrast(e._fullLayout.plot_bgcolor):"#7f7f7f");$.enter().append("path").attr("class","select-outline select-outline-"+o.id).style({opacity:m?d.opacity/2:1,"stroke-dasharray":q(d.line.dash,d.line.width),"stroke-width":d.line.width+"px","shape-rendering":"crispEdges"}).call(r.stroke,aa).call(r.fill,_).attr("fill-rule","evenodd").classed("cursor-move",!!m).attr("transform",F).attr("d","M"+f+","+g+"Z");var t,az=D.append("path").attr("class","zoombox-corners").style({fill:r.background,stroke:r.defaultLine,"stroke-width":1}).attr("transform",F).attr("d","M0,0Z"),aA=b._uid+i.SELECTID,aB=[],aC=Z(e,a.xaxes,a.yaxes,a.subplot);U&&!n.shiftKey&&(a._clearSubplotSelections=function(){if(z){var c=V._id,d=Y._id;am(e,c,d,aC);for(var f=(e.layout||{}).selections||[],g=[],h=!1,a=0;a<f.length;a++){var i=b.selections[a];i.xref!==c||i.yref!==d?g.push(f[a]):h=!0}h&&(e._fullLayout._noEmitSelectedAtStart=!0,p.call("_guiRelayout",e,{selections:g}))}});var aD=(t=a).plotinfo.fillRangeItems||at(t.xaxes.concat(t.yaxes));a.moveFn=function(p,q){a._clearSubplotSelections&&(a._clearSubplotSelections(),a._clearSubplotSelections=void 0),aq=Math.max(0,Math.min(aw,ao*p+f)),as=Math.max(0,Math.min(ax,ap*q+g));var k=Math.abs(aq-f),n=Math.abs(as-g);if(al){if(P){var h,c,d,o=b.selectdirection;switch(h="any"===o?n<Math.min(.6*k,M)?"h":k<Math.min(.6*n,M)?"v":"d":o){case"h":c=T?ax/2:0,d=ax;break;case"v":c=T?aw/2:0,d=aw;break}}if(m)switch(b.newshape.drawdirection){case"vertical":h="h",c=T?ax/2:0,d=ax;break;case"horizontal":h="v",c=T?aw/2:0,d=aw;break;case"ortho":k<n?(h="h",c=g,d=as):(h="v",c=f,d=aq);break;default:h="d"}"h"===h?((ad=an?C(T,[aq,c],[aq,d]):[[f,c],[f,d],[aq,d],[aq,c]]).xmin=an?aq:Math.min(f,aq),ad.xmax=an?aq:Math.max(f,aq),ad.ymin=Math.min(c,d),ad.ymax=Math.max(c,d),az.attr("d","M"+ad.xmin+","+(g-M)+"h-4v"+2*M+"h4ZM"+(ad.xmax-1)+","+(g-M)+"h4v"+2*M+"h-4Z")):"v"===h?((ad=an?C(T,[c,as],[d,as]):[[c,g],[c,as],[d,as],[d,g]]).xmin=Math.min(c,d),ad.xmax=Math.max(c,d),ad.ymin=an?as:Math.min(g,as),ad.ymax=an?as:Math.max(g,as),az.attr("d","M"+(f-M)+","+ad.ymin+"v-4h"+2*M+"v4ZM"+(f-M)+","+(ad.ymax-1)+"v4h"+2*M+"v-4Z")):"d"===h&&((ad=an?C(T,[f,g],[aq,as]):[[f,g],[f,as],[aq,as],[aq,g]]).xmin=Math.min(f,aq),ad.xmax=Math.max(f,aq),ad.ymin=Math.min(g,as),ad.ymax=Math.max(g,as),az.attr("d","M0,0Z"))}else L&&(K.addPt([aq,as]),ad=K.filtered);if(a.selectionDefs&&a.selectionDefs.length?(ac=ag(a.mergedPolygons,ad,ay),ad.subtract=ay,ab=W(a.selectionDefs.concat([ad]))):(ac=[ad],ab=O(ad)),B(ai(ac,A),$,a),P){var r,j=l(e,!1),s=j.eventData?j.eventData.points.slice():[];ab=(j=l(e,!1,ab,aC,a)).selectionTesters,ak=j.eventData,r=K?K.filtered:ar(ac),I.throttle(aA,i.SELECTDELAY,function(){for(var a=(aB=aj(ab,aC)).slice(),c=0;c<s.length;c++){for(var d=s[c],f=!1,b=0;b<a.length;b++)if(a[b].curveNumber===d.curveNumber&&a[b].pointNumber===d.pointNumber){f=!0;break}f||a.push(d)}a.length&&(ak||(ak={}),ak.points=a),aD(ak,r),function(a,b){a.emit("plotly_selecting",b)}(e,ak)})}},a.clickFn=function(c,d){if(az.remove(),e._fullLayout._activeShapeIndex>=0){e._fullLayout._deactivateShape(e);return}if(!m){var f=b.clickmode;I.done(aA).then(function(){if(I.clear(aA),2===c){for($.remove(),af=0;af<aC.length;af++)(ah=aC[af])._module.selectPoints(ah,!1);if(ae(e,aC),k(a),av(e),aC.length){var l=aC[0].xaxis,m=aC[0].yaxis;if(l&&m){for(var g=[],h=e._fullLayout.selections,i=0;i<h.length;i++){var b=h[i];b&&(b.xref!==l._id||b.yref!==m._id)&&g.push(b)}g.length<h.length&&(e._fullLayout._noEmitSelectedAtStart=!0,p.call("_guiRelayout",e,{selections:g}))}}}else f.indexOf("select")> -1&&j(d,e,a.xaxes,a.yaxes,a.subplot,a,$),"event"===f&&au(e,void 0);s.click(e,d)}).catch(h.error)}},a.doneFn=function(){az.remove(),I.done(aA).then(function(){I.clear(aA),!U&&ad&&a.selectionDefs&&(ad.subtract=ay,a.selectionDefs.push(ad),a.mergedPolygons.length=0,[].push.apply(a.mergedPolygons,ac)),(U||m)&&k(a,U),a.doneFnCompleted&&a.doneFnCompleted(aB),P&&au(e,ak)}).catch(h.error)}},clearOutline:g,clearSelectionsCache:k,selectOnClick:j}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(a,e,h){"use strict";var c=a("../annotations/attributes"),d=a("../../traces/scatter/attributes").line,f=a("../drawing/attributes").dash,b=a("../../lib/extend").extendFlat,g=a("../../plot_api/plot_template").templatedArray;a("../../constants/axis_placeable_objects"),e.exports=g("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:b({},c.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:b({},c.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:b({},d.color,{editType:"arraydraw"}),width:b({},d.width,{editType:"calc+arraydraw"}),dash:b({},f,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("./constants"),g=a("./helpers");function h(a){return j(a.line.width,a.xsizemode,a.x0,a.x1,a.path,!1)}function i(a){return j(a.line.width,a.ysizemode,a.y0,a.y1,a.path,!0)}function j(m,n,o,p,b,c){var a=m/2,e=c;if("pixel"!==n)return{ppad:a};var h=b?g.extractPathCoords(b,c?f.paramIsY:f.paramIsX):[o,p],i=d.aggNums(Math.max,null,h),j=d.aggNums(Math.min,null,h),k=j<0?Math.abs(j)+a:a,l=i>0?i+a:a;return{ppad:a,ppadplus:e?k:l,ppadminus:e?l:k}}function k(a,l,n,m,o){var b,i,j,d,c="category"===a.type||"multicategory"===a.type?a.r2c:a.d2c;if(void 0!==l)return[c(l),c(n)];if(m){var e=1/0,h=-1/0,k=m.match(f.segmentRE);for("date"===a.type&&(c=g.decodeDate(c)),b=0;b<k.length;b++)void 0!==(i=o[k[b].charAt(0)].drawn)&&(j=k[b].substr(1).match(f.paramRE))&&!(j.length<i)&&((d=c(j[i]))<e&&(e=d),d>h&&(h=d));if(h>=e)return[e,h]}}b.exports=function(c){var m=c._fullLayout,j=d.filterVisible(m.shapes);if(j.length&&c._fullData.length)for(var l=0;l<j.length;l++){var b,g,a=j[l];a._extremes={};var n=e.getRefType(a.xref),o=e.getRefType(a.yref);if("paper"!==a.xref&&"domain"!==n){var p="pixel"===a.xsizemode?a.xanchor:a.x0,q="pixel"===a.xsizemode?a.xanchor:a.x1;(g=k(b=e.getFromId(c,a.xref),p,q,a.path,f.paramIsX))&&(a._extremes[b._id]=e.findExtremes(b,g,h(a)))}if("paper"!==a.yref&&"domain"!==o){var r="pixel"===a.ysizemode?a.yanchor:a.y0,s="pixel"===a.ysizemode?a.yanchor:a.y1;(g=k(b=e.getFromId(c,a.yref),r,s,a.path,f.paramIsY))&&(a._extremes[b._id]=e.findExtremes(b,g,i(a)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(b,a,c){"use strict";a.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../../plots/array_container_defaults"),g=a("./attributes"),h=a("./helpers");function i(b,c,t){function a(a,e){return d.coerce(b,c,g,a,e)}if(a("visible")){var u=a("path")?"path":"rect",v=a("type",u),p="path"!==v;p&&delete c.path,a("editable"),a("layer"),a("opacity"),a("fillcolor"),a("fillrule");var w=a("line.width");w&&(a("line.color"),a("line.dash"));for(var x=a("xsizemode"),y=a("ysizemode"),z=["x","y"],q=0;q<2;q++){var r,k,l,m=z[q],j=m+"anchor",s="x"===m?x:y,n={_fullLayout:t},o=e.coerceRef(b,c,n,m,void 0,"paper");if("range"===e.getRefType(o)?((r=e.getFromId(n,o))._shapeIndices.push(c._index),l=h.rangeToShapePosition(r),k=h.shapePositionToRange(r)):k=l=d.identity,p){var A=.25,B=.75,f=m+"0",i=m+"1",C=b[f],D=b[i];b[f]=k(b[f],!0),b[i]=k(b[i],!0),"pixel"===s?(a(f,0),a(i,10)):(e.coercePosition(c,n,a,o,f,A),e.coercePosition(c,n,a,o,i,B)),c[f]=l(c[f]),c[i]=l(c[i]),b[f]=C,b[i]=D}if("pixel"===s){var E=b[j];b[j]=k(b[j],!0),e.coercePosition(c,n,a,o,j,.25),c[j]=l(c[j]),b[j]=E}}p&&d.noneOrAll(b,c,["x0","x1","y0","y1"])}}b.exports=function(a,b){f(a,b,{name:"shapes",handleItemDefaults:i})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(a,e,f){"use strict";var g=a("../../lib").strTranslate,h=a("../dragelement"),d=a("../dragelement/helpers"),i=d.drawMode,j=d.selectMode,k=a("../../registry"),l=a("../color"),b=a("./draw_newshape/constants"),m=b.i000,n=b.i090,o=b.i180,p=b.i270,q=a("./handle_outline").clearOutlineControllers,c=a("./draw_newshape/helpers"),r=c.pointsOnRectangle,s=c.pointsOnEllipse,t=c.writePaths,u=a("./draw_newshape/newshapes"),v=a("../selections/draw_newselection/newselections");function w(a,c){var b,d,e,g=a[c][1],h=a[c][2],f=a.length;return d=a[b=(c+1)%f][1],e=a[b][2],d===g&&e===h&&(d=a[b=(c+2)%f][1],e=a[b][2]),[b,d,e]}e.exports=function B(d,f,a,b){b||(b=0);var C,D,E,F,x,c=a.gd;function G(){B(d,f,a,b++),s(d[0])&&H({redrawing:!0})}function H(d){var b={};void 0!==a.isActiveShape&&(a.isActiveShape=!1,b=u(f,a)),void 0!==a.isActiveSelection&&(a.isActiveSelection=!1,b=v(f,a),c._fullLayout._reselect=!0),Object.keys(b).length&&k.call((d||{}).redrawing?"relayout":"_guiRelayout",c,b)}var y=c._fullLayout._zoomlayer,e=a.dragmode,z=i(e),A=j(e);function I(a){E=+a.srcElement.getAttribute("data-i"),F=+a.srcElement.getAttribute("data-j"),C[E][F].moveFn=J}function J(l,m){if(d.length){var h=x[E][F][1],i=x[E][F][2],b=d[E],n=b.length;if(r(b)){var j=l,k=m;a.isActiveSelection&&(w(b,F)[1]===b[F][1]?k=0:j=0);for(var e=0;e<n;e++)if(e!==F){var f=b[e];f[1]===b[F][1]&&(f[1]=h+j),f[2]===b[F][2]&&(f[2]=i+k)}if(b[F][1]=h+j,b[F][2]=i+k,!r(b))for(var c=0;c<n;c++)for(var g=0;g<b[c].length;g++)b[c][g]=x[E][c][g]}else b[F][1]=h+l,b[F][2]=i+m;G()}}function K(){H()}function L(c,a){if(2===c){E=+a.srcElement.getAttribute("data-i"),F=+a.srcElement.getAttribute("data-j");var b=d[E];r(b)||s(b)||function(){if(d.length&&d[E]&&d[E].length){for(var a=[],b=0;b<d[E].length;b++)b!==F&&a.push(d[E][b]);a.length>1&&!(2===a.length&&"Z"===a[1][0])&&(0===F&&(a[0][0]="M"),d[E]=a,G(),H())}}()}}function M(a,b){!function(e,f){if(d.length)for(var a=0;a<d.length;a++)for(var b=0;b<d[a].length;b++)for(var c=0;c+2<d[a][b].length;c+=2)d[a][b][c+1]=x[a][b][c+1]+e,d[a][b][c+2]=x[a][b][c+2]+f}(a,b),G()}function N(a){(E=+a.srcElement.getAttribute("data-i"))||(E=0),D[E].moveFn=M}function O(){H()}function P(a){2===a&&function(a){if(j(a._fullLayout.dragmode)){q(a);var c=a._fullLayout._activeSelectionIndex,d=(a.layout||{}).selections||[];if(c<d.length){for(var e=[],b=0;b<d.length;b++)b!==c&&e.push(d[b]);delete a._fullLayout._activeSelectionIndex;var f=a._fullLayout.selections[c];a._fullLayout._deselect={xref:f.xref,yref:f.yref},k.call("_guiRelayout",a,{selections:e})}}}(c)}(z||A)&&(c._fullLayout._outlining=!0),q(c),f.attr("d",t(d)),!b&&(a.isActiveShape||a.isActiveSelection)&&(x=function(c,f){for(var a=0;a<f.length;a++){var e=f[a];c[a]=[];for(var b=0;b<e.length;b++){c[a][b]=[];for(var d=0;d<e[b].length;d++)c[a][b][d]=e[b][d]}}return c}([],d),function(A){C=[];for(var e=0;e<d.length;e++){var f=d[e],x=r(f),B=!x&&s(f);C[e]=[];for(var D=f.length,b=0;b<D;b++)if("Z"!==f[b][0]){if(B&&b!==m&&b!==n&&b!==o&&b!==p)continue;var j,k=x&&a.isActiveSelection;k&&(j=w(f,b));var q=f[b][1],t=f[b][2],u=A.append(k?"rect":"circle").attr("data-i",e).attr("data-j",b).style({fill:l.background,stroke:l.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(k){var v=j[1]-q,i=j[2]-t,y=i?5:Math.max(Math.min(25,Math.abs(v)-5),5),z=v?5:Math.max(Math.min(25,Math.abs(i)-5),5);u.classed(i?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",y).attr("height",z).attr("x",q-y/2).attr("y",t-z/2).attr("transform",g(v/2,i/2))}else u.classed("cursor-grab",!0).attr("r",5).attr("cx",q).attr("cy",t);C[e][b]={element:u.node(),gd:c,prepFn:I,doneFn:K,clickFn:L},h.init(C[e][b])}}}(y.append("g").attr("class","outline-controllers")),function(){if(D=[],d.length){var a=0;D[a]={element:f[0][0],gd:c,prepFn:N,doneFn:O,clickFn:P},h.init(D[a])}}())}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(a,b,f){"use strict";var g=a("../../registry"),h=a("../../lib"),i=a("../../plots/cartesian/axes"),j=a("./draw_newshape/helpers").readPaths,k=a("./display_outlines"),l=a("./handle_outline").clearOutlineControllers,m=a("../color"),n=a("../drawing"),o=a("../../plot_api/plot_template").arrayEditor,p=a("../dragelement"),q=a("../../lib/setcursor"),r=a("./constants"),c=a("./helpers"),s=c.getPathString;function d(c){var a=c._fullLayout;for(var f in a._shapeUpperLayer.selectAll("path").remove(),a._shapeLowerLayer.selectAll("path").remove(),a._plots){var d=a._plots[f].shapelayer;d&&d.selectAll("path").remove()}for(var b=0;b<a.shapes.length;b++)a.shapes[b].visible&&e(c,b)}function t(a){return!!a._fullLayout._outlining}function u(a){return!a._context.edits.shapePosition}function e(a,e){a._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+e+'"]').remove();var f=c.makeShapesOptionsAndPlotinfo(a,e),b=f.options,d=f.plotinfo;b._input&& !1!==b.visible&&function(q){var g,f=s(a,b),x={"data-index":e,"fill-rule":b.fillrule,d:f},h=b.opacity,i=b.fillcolor,z=b.line.width?b.line.color:"rgba(0,0,0,0)",l=b.line.width,r=b.line.dash;l|| !0!==b.editable||(l=5,r="solid");var t="Z"!==f[f.length-1],p=u(a)&&b.editable&&a._fullLayout._activeShapeIndex===e;p&&(i=t?"rgba(0,0,0,0)":a._fullLayout.activeshape.fillcolor,h=a._fullLayout.activeshape.opacity);var c=q.append("path").attr(x).style("opacity",h).call(m.stroke,z).call(m.fill,i).call(n.dashLine,r,l);if(v(c,a,b),(p||a._context.edits.shapePosition)&&(g=o(a.layout,"shapes",b)),p){c.style({cursor:"move"});var A={element:c.node(),plotinfo:d,gd:a,editHelpers:g,isActiveShape:!0},B=j(f,a);k(B,c,A)}else a._context.edits.shapePosition?w(a,c,b,e,q,g):!0===b.editable&&c.style("pointer-events",t||m.opacity(i)*h<=.5?"stroke":"all");c.node().addEventListener("click",function(){return y(a,c)})}("below"!==b.layer?a._fullLayout._shapeUpperLayer:"paper"===b.xref||"paper"===b.yref?a._fullLayout._shapeLowerLayer:d._hadPlotinfo?(d.mainplotinfo||d).shapelayer:a._fullLayout._shapeLowerLayer)}function v(d,a,b){var c=(b.xref+b.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");n.setClipUrl(d,c?"clip"+a._fullLayout._uid+c:null,a)}function w(b,m,a,C,D,E){var j,d,k,l,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,o="pixel"===a.xsizemode,u="pixel"===a.ysizemode,F="line"===a.type,Y="path"===a.type,Z=E.modifyItem,w=i.getFromId(b,a.xref),y=i.getRefType(a.xref),z=i.getFromId(b,a.yref),A=i.getRefType(a.yref),e=c.getDataToPixel(b,w,!1,y),f=c.getDataToPixel(b,z,!0,A),$=c.getPixelToData(b,w,!1,y),_=c.getPixelToData(b,z,!0,A),B=F?(j=Math.max(a.line.width,10),(d=D.append("g").attr("data-index",C)).append("path").attr("d",m.attr("d")).style({cursor:"move","stroke-width":j,"stroke-opacity":"0"}),k={"fill-opacity":"0"},l=Math.max(j/2,10),d.append("circle").attr({"data-line-point":"start-point",cx:o?e(a.xanchor)+a.x0:e(a.x0),cy:u?f(a.yanchor)-a.y0:f(a.y0),r:l}).style(k).classed("cursor-grab",!0),d.append("circle").attr({"data-line-point":"end-point",cx:o?e(a.xanchor)+a.x1:e(a.x1),cy:u?f(a.yanchor)-a.y1:f(a.y1),r:l}).style(k).classed("cursor-grab",!0),d):m,G={element:B.node(),gd:b,prepFn:function(c){t(b)||(o&&(M=e(a.xanchor)),u&&(N=f(a.yanchor)),"path"===a.type?W=a.path:(I=o?a.x0:e(a.x0),J=u?a.y0:f(a.y0),K=o?a.x1:e(a.x1),L=u?a.y1:f(a.y1)),I<K?(Q=I,U="x0",R=K,V="x1"):(Q=K,U="x1",R=I,V="x0"),!u&&J<L||u&&J>L?(O=J,S="y0",P=L,T="y1"):(O=L,S="y1",P=J,T="y0"),H(c),ac(D,a),ae(m,a,b),G.moveFn="move"===X?aa:ab,G.altKey=c.altKey)},doneFn:function(){t(b)||(q(m),ad(D),v(m,b,a),g.call("_guiRelayout",b,E.getUpdateObj()))},clickFn:function(){t(b)||ad(D)}};function H(c){if(t(b)){X=null;return}if(F)X="path"===c.target.tagName?"move":"start-point"===c.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var a=G.element.getBoundingClientRect(),d=a.right-a.left,e=a.bottom-a.top,g=c.clientX-a.left,h=c.clientY-a.top,f=!Y&&d>10&&e>10&&!c.shiftKey?p.getCursor(g/d,1-h/e):"move";q(m,f),X=f.split("-")[0]}}function aa(d,g){if("path"===a.type){var j=function(a){return a},h=j,i=j;o?Z("xanchor",a.xanchor=$(M+d)):(h=function(a){return $(e(a)+d)},w&&"date"===w.type&&(h=c.encodeDate(h))),u?Z("yanchor",a.yanchor=_(N+g)):(i=function(a){return _(f(a)+g)},z&&"date"===z.type&&(i=c.encodeDate(i))),Z("path",a.path=x(W,h,i))}else o?Z("xanchor",a.xanchor=$(M+d)):(Z("x0",a.x0=$(I+d)),Z("x1",a.x1=$(K+d))),u?Z("yanchor",a.yanchor=_(N+g)):(Z("y0",a.y0=_(J+g)),Z("y1",a.y1=_(L+g)));m.attr("d",s(b,a)),ac(D,a)}function ab(g,d){if(Y){var q=function(a){return a},j=q,k=q;o?Z("xanchor",a.xanchor=$(M+g)):(j=function(a){return $(e(a)+g)},w&&"date"===w.type&&(j=c.encodeDate(j))),u?Z("yanchor",a.yanchor=_(N+d)):(k=function(a){return _(f(a)+d)},z&&"date"===z.type&&(k=c.encodeDate(k))),Z("path",a.path=x(W,j,k))}else if(F){if("resize-over-start-point"===X){var r=I+g,t=u?J-d:J+d;Z("x0",a.x0=o?r:$(r)),Z("y0",a.y0=u?t:_(t))}else if("resize-over-end-point"===X){var v=K+g,y=u?L-d:L+d;Z("x1",a.x1=o?v:$(v)),Z("y1",a.y1=u?y:_(y))}}else{var l=function(a){return -1!==X.indexOf(a)},A=l("n"),B=l("s"),C=l("w"),E=l("e"),h=A?O+d:O,i=B?P+d:P,n=C?Q+g:Q,p=E?R+g:R;u&&(A&&(h=O-d),B&&(i=P-d)),(!u&&i-h>10||u&&h-i>10)&&(Z(S,a[S]=u?h:_(h)),Z(T,a[T]=u?i:_(i))),p-n>10&&(Z(U,a[U]=o?n:$(n)),Z(V,a[V]=o?p:$(p)))}m.attr("d",s(b,a)),ac(D,a)}function ac(a,b){(o||u)&&function(){var j="path"!==b.type,i=a.selectAll(".visual-cue").data([0]);i.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var d=e(o?b.xanchor:h.midRange(j?[b.x0,b.x1]:c.extractPathCoords(b.path,r.paramIsX))),g=f(u?b.yanchor:h.midRange(j?[b.y0,b.y1]:c.extractPathCoords(b.path,r.paramIsY)));if(d=c.roundPositionForSharpStrokeRendering(d,1),g=c.roundPositionForSharpStrokeRendering(g,1),o&&u){var k="M"+(d-1-1)+","+(g-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";i.attr("d",k)}else if(o){var l="M"+(d-1-1)+","+(g-9-1)+"v18 h2 v-18 Z";i.attr("d",l)}else{var m="M"+(d-9-1)+","+(g-1-1)+"h18 v2 h-18 Z";i.attr("d",m)}}()}function ad(a){a.selectAll(".visual-cue").remove()}function ae(f,e,a){var c=e.xref,d=e.yref,g=i.getFromId(a,c),h=i.getFromId(a,d),b="";"paper"===c||g.autorange||(b+=c),"paper"===d||h.autorange||(b+=d),n.setClipUrl(f,b?"clip"+a._fullLayout._uid+b:null,a)}p.init(G),B.node().onmousemove=H}function x(a,b,c){return a.replace(r.segmentRE,function(d){var e=0,a=d.charAt(0),f=r.paramIsX[a],g=r.paramIsY[a],h=r.numParams[a];return a+d.substr(1).replace(r.paramRE,function(a){return e>=h||(f[e]?a=b(a):g[e]&&(a=c(a)),e++),a})})}function y(a,c){if(u(a)){var b=+c.node().getAttribute("data-index");if(b>=0){if(b===a._fullLayout._activeShapeIndex){z(a);return}a._fullLayout._activeShapeIndex=b,a._fullLayout._deactivateShape=z,d(a)}}}function z(a){u(a)&&a._fullLayout._activeShapeIndex>=0&&(l(a),delete a._fullLayout._activeShapeIndex,d(a))}b.exports={draw:d,drawOne:e,eraseActiveShape:function(a){if(u(a)){l(a);var d=a._fullLayout._activeShapeIndex,c=(a.layout||{}).shapes||[];if(d<c.length){for(var e=[],b=0;b<c.length;b++)b!==d&&e.push(c[b]);delete a._fullLayout._activeShapeIndex,g.call("_guiRelayout",a,{shapes:e})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(a,b,e){"use strict";var c=a("../../drawing/attributes").dash,d=a("../../../lib/extend").extendFlat;b.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:d({},c,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(b,a,c){"use strict";a.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(a,b,c){"use strict";var d=a("../../color");b.exports=function(b,e,a){if(a("newshape.drawdirection"),a("newshape.layer"),a("newshape.fillcolor"),a("newshape.fillrule"),a("newshape.opacity"),a("newshape.line.width")){var c=(b||{}).plot_bgcolor||"#FFF";a("newshape.line.color",d.contrast(c)),a("newshape.line.dash")}a("activeshape.fillcolor"),a("activeshape.opacity")}},{"../../color":367}],466:[function(b,e,a){"use strict";var f=b("parse-svg-path"),c=b("./constants"),g=c.CIRCLE_SIDES,h=c.SQRT2,d=b("../../selections/helpers"),i=d.p2r,j=d.r2p,k=[0,3,4,5,6,1,2],l=[0,3,4,1,2];function m(a,b){return 1e-6>=Math.abs(a-b)}function n(a,b){var c=b[1]-a[1],d=b[2]-a[2];return Math.sqrt(c*c+d*d)}a.writePaths=function(c){var h=c.length;if(!h)return"M0,0Z";for(var e="",b=0;b<h;b++)for(var j=c[b].length,d=0;d<j;d++){var f=c[b][d][0];if("Z"===f)e+="Z";else for(var i=c[b][d].length,a=0;a<i;a++){var g=a;"Q"===f||"S"===f?g=l[a]:"C"===f&&(g=k[a]),e+=c[b][d][g],a>0&&a<i-1&&(e+=",")}}return e},a.readPaths=function(F,G,c,H){var b=f(F),v=[],w=-1,d=0,e=0,y=function(){z=d,A=e};y();for(var a=0;a<b.length;a++){var k,z,A,q,B,r,C,h=[],D=b[a][0],l=D;switch(D){case"M":w++,v[w]=[],d=+b[a][1],e=+b[a][2],h.push([l,d,e]),y();break;case"Q":case"S":q=+b[a][1],r=+b[a][2],d=+b[a][3],e=+b[a][4],h.push([l,d,e,q,r]);break;case"C":q=+b[a][1],r=+b[a][2],B=+b[a][3],C=+b[a][4],d=+b[a][5],e=+b[a][6],h.push([l,d,e,q,r,B,C]);break;case"T":case"L":d=+b[a][1],e=+b[a][2],h.push([l,d,e]);break;case"H":l="L",d=+b[a][1],h.push([l,d,e]);break;case"V":l="L",e=+b[a][1],h.push([l,d,e]);break;case"A":l="L";var s=+b[a][1],x=+b[a][2];+b[a][4]||(s=-s,x=-x);var I=d-s,J=e;for(k=1;k<=g/2;k++){var E=2*Math.PI*k/g;h.push([l,I+s*Math.cos(E),J+x*Math.sin(E)])}break;case"Z":(d!==z||e!==A)&&(d=z,e=A,h.push([l,d,e]));break}for(var t=(c||{}).domain,p=G._fullLayout._size,K=c&&"pixel"===c.xsizemode,L=c&&"pixel"===c.ysizemode,u=!1===H,o=0;o<h.length;o++){for(k=0;k+2<7;k+=2){var m=h[o][k+1],n=h[o][k+2];void 0!==m&& void 0!==n&&(d=m,e=n,c&&(c.xaxis&&c.xaxis.p2r?(u&&(m-=c.xaxis._offset),m=K?j(c.xaxis,c.xanchor)+m:i(c.xaxis,m)):(u&&(m-=p.l),t?m=t.x[0]+m/p.w:m/=p.w),c.yaxis&&c.yaxis.p2r?(u&&(n-=c.yaxis._offset),n=L?j(c.yaxis,c.yanchor)-n:i(c.yaxis,n)):(u&&(n-=p.t),n=t?t.y[1]-n/p.h:1-n/p.h)),h[o][k+1]=m,h[o][k+2]=n)}v[w].push(h[o].slice())}}return v},a.pointsOnRectangle=function(a){if(5!==a.length)return!1;for(var b=1;b<3;b++){var c=a[0][b]-a[1][b],d=a[3][b]-a[2][b];if(!m(c,d))return!1;var e=a[0][b]-a[3][b],f=a[1][b]-a[2][b];if(!m(e,f))return!1}return!!(m(a[0][1],a[1][1])||m(a[0][1],a[3][1]))&&!!(n(a[0],a[1])*n(a[0],a[3]))},a.pointsOnEllipse=function(b){var a=b.length;if(a!==g+1)return!1;a=g;for(var c=0;c<a;c++){var d=(2*a-c)%a,e=(a/2+d)%a,f=(a/2+c)%a;if(!m(n(b[c],b[f]),n(b[d],b[e])))return!1}return!0},a.handleEllipse=function(l,e,f){if(!l)return[e,f];var b=a.ellipseOver({x0:e[0],y0:e[1],x1:f[0],y1:f[1]}),m=(b.x1+b.x0)/2,n=(b.y1+b.y0)/2,c=(b.x1-b.x0)/2,d=(b.y1-b.y0)/2;c||(c=d/=h),d||(d=c/=h);for(var j=[],i=0;i<g;i++){var k=2*i*Math.PI/g;j.push([m+c*Math.cos(k),n+d*Math.sin(k),])}return j},a.ellipseOver=function(a){var d=a.x0,e=a.y0,f=a.x1,g=a.y1,b=f-d,c=g-e,i=((d-=b)+f)/2,j=((e-=c)+g)/2,k=h;return b*=k,c*=k,{x0:i-b,y0:j-c,x1:i+b,y1:j+c}},a.fixDatesForPaths=function(a,g,h){var e="date"===g.type,f="date"===h.type;if(!e&&!f)return a;for(var b=0;b<a.length;b++)for(var c=0;c<a[b].length;c++)for(var d=0;d+2<a[b][c].length;d+=2)e&&(a[b][c][d+1]=a[b][c][d+1].replace(" ","_")),f&&(a[b][c][d+2]=a[b][c][d+2].replace(" ","_"));return a}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(b,f,g){"use strict";var d=b("../../dragelement/helpers"),h=d.drawMode,i=d.openMode,a=b("./constants"),j=a.i000,k=a.i090,l=a.i180,m=a.i270,n=a.cos45,o=a.sin45,e=b("../../selections/helpers"),p=e.p2r,q=e.r2p,r=b(".././handle_outline").clearOutline,c=b("./helpers"),s=c.readPaths,t=c.writePaths,u=c.ellipseOver,v=c.fixDatesForPaths;f.exports=function(Q,w){if(Q.length){var b,R=Q[0][0];if(R){var Y=R.getAttribute("d"),f=w.gd,g=f._fullLayout.newshape,a=w.plotinfo,G=a.xaxis,H=a.yaxis,Z=!!a.domain||!a.xaxis,$=!!a.domain||!a.yaxis,A=w.isActiveShape,e=w.dragmode,I=(f.layout||{}).shapes||[];if(!h(e)&& void 0!==A){var J=f._fullLayout._activeShapeIndex;if(J<I.length)switch(f._fullLayout.shapes[J].type){case"rect":e="drawrect";break;case"circle":e="drawcircle";break;case"line":e="drawline";break;case"path":var S=I[J].path||"";e="Z"===S[S.length-1]?"drawclosedpath":"drawopenpath";break}}var _=i(e),B=s(Y,f,a,A),c={editable:!0,xref:Z?"paper":G._id,yref:$?"paper":H._id,layer:g.layer,opacity:g.opacity,line:{color:g.line.color,width:g.line.width,dash:g.line.dash}};if(_||(c.fillcolor=g.fillcolor,c.fillrule=g.fillrule),1===B.length&&(b=B[0]),b&&5===b.length&&"drawrect"===e)c.type="rect",c.x0=b[0][1],c.y0=b[0][2],c.x1=b[2][1],c.y1=b[2][2];else if(b&&"drawline"===e)c.type="line",c.x0=b[0][1],c.y0=b[0][2],c.x1=b[1][1],c.y1=b[1][2];else if(b&&"drawcircle"===e){c.type="circle";var K=b[j][1],C=b[k][1],L=b[l][1],D=b[m][1],E=b[j][2],M=b[k][2],F=b[l][2],N=b[m][2],T=a.xaxis&&("date"===a.xaxis.type||"log"===a.xaxis.type),U=a.yaxis&&("date"===a.yaxis.type||"log"===a.yaxis.type);T&&(K=q(a.xaxis,K),C=q(a.xaxis,C),L=q(a.xaxis,L),D=q(a.xaxis,D)),U&&(E=q(a.yaxis,E),M=q(a.yaxis,M),F=q(a.yaxis,F),N=q(a.yaxis,N));var V=(C+D)/2,W=(E+F)/2,d=u({x0:V,y0:W,x1:V+(D-C+L-K)/2*n,y1:W+(N-M+F-E)/2*o});T&&(d.x0=p(a.xaxis,d.x0),d.x1=p(a.xaxis,d.x1)),U&&(d.y0=p(a.yaxis,d.y0),d.y1=p(a.yaxis,d.y1)),c.x0=d.x0,c.y0=d.y0,c.x1=d.x1,c.y1=d.y1}else c.type="path",G&&H&&v(B,G,H),c.path=t(B),b=null;r(f);for(var O=w.editHelpers,x=(O||{}).modifyItem,P=[],y=0;y<I.length;y++){var X=f._fullLayout.shapes[y];if(P[y]=X._input,void 0!==A&&y===f._fullLayout._activeShapeIndex){var z=c;switch(X.type){case"line":case"rect":case"circle":x("x0",z.x0),x("x1",z.x1),x("y0",z.y0),x("y1",z.y1);break;case"path":x("path",z.path);break}}}return void 0===A?(P.push(c),P):O?O.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(b,a,c){"use strict";a.exports={clearOutlineControllers:function(b){var a=b._fullLayout._zoomlayer;a&&a.selectAll(".outline-controllers").remove()},clearOutline:function(a){var b=a._fullLayout._zoomlayer;b&&b.selectAll(".select-outline").remove(),a._fullLayout._outlining=!1}}},{}],469:[function(b,c,a){"use strict";var d=b("./constants"),e=b("../../lib"),f=b("../../plots/cartesian/axes");a.rangeToShapePosition=function(a){return"log"===a.type?a.r2d:function(a){return a}},a.shapePositionToRange=function(a){return"log"===a.type?a.d2r:function(a){return a}},a.decodeDate=function(a){return function(b){return b.replace&&(b=b.replace("_"," ")),a(b)}},a.encodeDate=function(a){return function(b){return a(b).replace(" ","_")}},a.extractPathCoords=function(a,c,f){var b=[];return a.match(d.segmentRE).forEach(function(h){var a=c[h.charAt(0)].drawn;if(void 0!==a){var g=h.substr(1).match(d.paramRE);if(g&&!(g.length<a)){var i=g[a],j=f?i:e.cleanNumber(i);b.push(j)}}}),b},a.getDataToPixel=function(d,c,e,f){var b,g=d._fullLayout._size;if(c)if("domain"===f)b=function(a){return c._length*(e?1-a:a)+c._offset};else{var h=a.shapePositionToRange(c);b=function(a){return c._offset+c.r2p(h(a,!0))},"date"===c.type&&(b=a.decodeDate(b))}else b=e?function(a){return g.t+g.h*(1-a)}:function(a){return g.l+g.w*a};return b},a.getPixelToData=function(d,c,e,f){var b,g=d._fullLayout._size;if(c)if("domain"===f)b=function(b){var a=(b-c._offset)/c._length;return e?1-a:a};else{var h=a.rangeToShapePosition(c);b=function(a){return h(c.p2r(a-c._offset))}}else b=e?function(a){return 1-(a-g.t)/g.h}:function(a){return(a-g.l)/g.w};return b},a.roundPositionForSharpStrokeRendering=function(b,c){var a=Math.round(b);return 1===Math.round(c%2)?a+.5:a},a.makeShapesOptionsAndPlotinfo=function(c,d){var a=c._fullLayout.shapes[d]||{},b=c._fullLayout._plots[a.xref+a.yref];return b?b._hadPlotinfo=!0:(b={},a.xref&&"paper"!==a.xref&&(b.xaxis=c._fullLayout[a.xref+"axis"]),a.yref&&"paper"!==a.yref&&(b.yaxis=c._fullLayout[a.yref+"axis"])),b.xsizemode=a.xsizemode,b.ysizemode=a.ysizemode,b.xanchor=a.xanchor,b.yanchor=a.yanchor,{options:a,plotinfo:b}},a.makeSelectionsOptionsAndPlotinfo=function(c,d){var a=c._fullLayout.selections[d]||{},b=c._fullLayout._plots[a.xref+a.yref];return b?b._hadPlotinfo=!0:(b={},a.xref&&(b.xaxis=c._fullLayout[a.xref+"axis"]),a.yref&&(b.yaxis=c._fullLayout[a.yref+"axis"])),{options:a,plotinfo:b}},a.getPathString=function(o,b){var i,z,A,s,B,C,D,E,F,c,G,g,h,k,j,l,p=b.type,H=f.getRefType(b.xref),I=f.getRefType(b.yref),m=f.getFromId(o,b.xref),n=f.getFromId(o,b.yref),J=o._fullLayout._size;if(m?"domain"===H?c=function(a){return m._offset+m._length*a}:(F=a.shapePositionToRange(m),c=function(a){return m._offset+m.r2p(F(a,!0))}):c=function(a){return J.l+J.w*a},n?"domain"===I?g=function(a){return n._offset+n._length*(1-a)}:(G=a.shapePositionToRange(n),g=function(a){return n._offset+n.r2p(G(a,!0))}):g=function(a){return J.t+J.h*(1-a)},"path"===p)return m&&"date"===m.type&&(c=a.decodeDate(c)),n&&"date"===n.type&&(g=a.decodeDate(g)),i=b,z=c,A=g,s=i.path,B=i.xsizemode,C=i.ysizemode,D=i.xanchor,E=i.yanchor,s.replace(d.segmentRE,function(b){var f=0,a=b.charAt(0),h=d.paramIsX[a],i=d.paramIsY[a],g=d.numParams[a],c=b.substr(1).replace(d.paramRE,function(a){return h[f]?a="pixel"===B?z(D)+Number(a):z(a):i[f]&&(a="pixel"===C?A(E)-Number(a):A(a)),f++,f>g&&(a="X"),a});return f>g&&(c=c.replace(/[\s,]*X.*/,""),e.log("Ignoring extra params in segment "+b)),a+c});if("pixel"===b.xsizemode){var t=c(b.xanchor);h=t+b.x0,k=t+b.x1}else h=c(b.x0),k=c(b.x1);if("pixel"===b.ysizemode){var u=g(b.yanchor);j=u-b.y0,l=u-b.y1}else j=g(b.y0),l=g(b.y1);if("line"===p)return"M"+h+","+j+"L"+k+","+l;if("rect"===p)return"M"+h+","+j+"H"+k+"V"+l+"H"+h+"Z";var q=(h+k)/2,r=(j+l)/2,v=Math.abs(q-h),w=Math.abs(r-j),x="A"+v+","+w,y=q+v+","+r;return"M"+y+x+" 0 1,1 "+(q+","+(r-w))+x+" 0 0,1 "+y+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(a,c,d){"use strict";var b=a("./draw");c.exports={moduleType:"component",name:"shapes",layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),supplyDrawNewShapeDefaults:a("./draw_newshape/defaults"),includeBasePlot:a("../../plots/cartesian/include_components")("shapes"),calcAutorange:a("./calc_autorange"),draw:b.draw,drawOne:b.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(a,e,k){"use strict";var c=a("../../plots/font_attributes"),f=a("../../plots/pad_attributes"),g=a("../../lib/extend").extendDeepAll,h=a("../../plot_api/edit_types").overrideAll,i=a("../../plots/animation_attributes"),d=a("../../plot_api/plot_template").templatedArray,b=a("./constants"),j=d("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});e.exports=h(d("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:j,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:g(f({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:i.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:c({})},font:c({}),activebgcolor:{valType:"color",dflt:b.gripBgActiveColor},bgcolor:{valType:"color",dflt:b.railBgColor},bordercolor:{valType:"color",dflt:b.railBorderColor},borderwidth:{valType:"number",min:0,dflt:b.railBorderWidth},ticklen:{valType:"number",min:0,dflt:b.tickLength},tickcolor:{valType:"color",dflt:b.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:b.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(b,a,c){"use strict";a.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../../plots/array_container_defaults"),c=a("./attributes"),g=a("./constants").name,h=c.steps;function i(i,b,k){function a(a,d){return e.coerce(i,b,c,a,d)}for(var d=f(i,b,{name:"steps",handleItemDefaults:j}),g=0,h=0;h<d.length;h++)d[h].visible&&g++;if(g<2?b.visible=!1:a("visible")){b._stepCount=g;var l=b._visibleSteps=e.filterVisible(d);(d[a("active")]||{}).visible||(b.active=l[0]._index),a("x"),a("y"),e.noneOrAll(i,b,["x","y"]),a("xanchor"),a("yanchor"),a("len"),a("lenmode"),a("pad.t"),a("pad.r"),a("pad.b"),a("pad.l"),e.coerceFont(a,"font",k.font),a("currentvalue.visible")&&(a("currentvalue.xanchor"),a("currentvalue.prefix"),a("currentvalue.suffix"),a("currentvalue.offset"),e.coerceFont(a,"currentvalue.font",b.font)),a("transition.duration"),a("transition.easing"),a("bgcolor"),a("activebgcolor"),a("bordercolor"),a("borderwidth"),a("ticklen"),a("tickwidth"),a("tickcolor"),a("minorticklen")}}function j(b,c){function a(a,d){return e.coerce(b,c,h,a,d)}if("skip"===b.method||Array.isArray(b.args)?a("visible"):c.visible=!1){a("method"),a("args");var d=a("label","step-"+c._index);a("value",d),a("execute")}}b.exports=function(a,b){f(a,b,{name:g,handleItemDefaults:i})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(a,c,e){"use strict";var f=a("@plotly/d3"),g=a("../../plots/plots"),h=a("../color"),i=a("../drawing"),d=a("../../lib"),j=d.strTranslate,k=a("../../lib/svg_text_utils"),l=a("../../plot_api/plot_template").arrayEditor,m=a("./constants"),b=a("../../constants/alignment"),n=b.LINE_SPACING,o=b.FROM_TL,p=b.FROM_BR;function q(a){return m.autoMarginIdRoot+a._index}function r(a){return a._index}function s(n,b){var j=i.tester.selectAll("g."+m.labelGroupClass).data(b._visibleSteps);j.enter().append("g").classed(m.labelGroupClass,!0);var r=0,s=0;j.each(function(d){var a=v(f.select(this),{step:d},b).node();if(a){var c=i.bBox(a);s=Math.max(s,c.height),r=Math.max(r,c.width)}}),j.remove();var a=b._dims={};a.inputAreaWidth=Math.max(m.railWidth,m.gripHeight);var h=n._fullLayout._size;a.lx=h.l+h.w*b.x,a.ly=h.t+h.h*(1-b.y),"fraction"===b.lenmode?a.outerLength=Math.round(h.w*b.len):a.outerLength=b.len,a.inputAreaStart=0,a.inputAreaLength=Math.round(a.outerLength-b.pad.l-b.pad.r);var u=(a.inputAreaLength-2*m.stepInset)/(b._stepCount-1),w=r+m.labelPadding;if(a.labelStride=Math.max(1,Math.ceil(w/u)),a.labelHeight=s,a.currentValueMaxWidth=0,a.currentValueHeight=0,a.currentValueTotalHeight=0,a.currentValueMaxLines=1,b.currentvalue.visible){var x=i.tester.append("g");j.each(function(e){var c=t(x,b,e.label),d=c.node()&&i.bBox(c.node())||{width:0,height:0},f=k.lineCount(c);a.currentValueMaxWidth=Math.max(a.currentValueMaxWidth,Math.ceil(d.width)),a.currentValueHeight=Math.max(a.currentValueHeight,Math.ceil(d.height)),a.currentValueMaxLines=Math.max(a.currentValueMaxLines,f)}),a.currentValueTotalHeight=a.currentValueHeight+b.currentvalue.offset,x.remove()}a.height=a.currentValueTotalHeight+m.tickOffset+b.ticklen+m.labelOffset+a.labelHeight+b.pad.t+b.pad.b;var e="left";d.isRightAnchor(b)&&(a.lx-=a.outerLength,e="right"),d.isCenterAnchor(b)&&(a.lx-=a.outerLength/2,e="center");var l="top";d.isBottomAnchor(b)&&(a.ly-=a.height,l="bottom"),d.isMiddleAnchor(b)&&(a.ly-=a.height/2,l="middle"),a.outerLength=Math.ceil(a.outerLength),a.height=Math.ceil(a.height),a.lx=Math.round(a.lx),a.ly=Math.round(a.ly);var c={y:b.y,b:a.height*p[l],t:a.height*o[l]};"fraction"===b.lenmode?(c.l=0,c.xl=b.x-b.len*o[e],c.r=0,c.xr=b.x+b.len*p[e]):(c.x=b.x,c.l=a.outerLength*o[e],c.r=a.outerLength*p[e]),g.autoMargin(n,q(b),c)}function t(o,a,j){if(a.currentvalue.visible){var b,g,c=a._dims;switch(a.currentvalue.xanchor){case"right":b=c.inputAreaLength-m.currentValueInset-c.currentValueMaxWidth,g="left";break;case"center":b=.5*c.inputAreaLength,g="middle";break;default:b=m.currentValueInset,g="left"}var e=d.ensureSingle(o,"text",m.labelClass,function(a){a.attr({"text-anchor":g,"data-notex":1})}),f=a.currentvalue.prefix?a.currentvalue.prefix:"";if("string"==typeof j)f+=j;else{var h=a.steps[a.active].label,l=a._gd._fullLayout._meta;l&&(h=d.templateString(h,l)),f+=h}a.currentvalue.suffix&&(f+=a.currentvalue.suffix),e.call(i.font,a.currentvalue.font).text(f).call(k.convertToTspans,a._gd);var p=k.lineCount(e),q=(c.currentValueMaxLines+1-p)*a.currentvalue.font.size*n;return k.positionText(e,b,q),e}}function u(b,c,a){d.ensureSingle(b,"rect",m.gripRectClass,function(d){d.call(z,c,b,a).style("pointer-events","all")}).attr({width:m.gripWidth,height:m.gripHeight,rx:m.gripRadius,ry:m.gripRadius}).call(h.stroke,a.bordercolor).call(h.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px")}function v(f,g,a){var c=d.ensureSingle(f,"text",m.labelClass,function(a){a.attr({"text-anchor":"middle","data-notex":1})}),b=g.step.label,e=a._gd._fullLayout._meta;return e&&(b=d.templateString(b,e)),c.call(i.font,a.font).text(b).call(k.convertToTspans,a._gd),c}function w(b,c){var e=d.ensureSingle(b,"g",m.labelsClass),g=c._dims,a=e.selectAll("g."+m.labelGroupClass).data(g.labelSteps);a.enter().append("g").classed(m.labelGroupClass,!0),a.exit().remove(),a.each(function(a){var b=f.select(this);b.call(v,a,c),i.setTranslate(b,C(c,a.fraction),m.tickOffset+c.ticklen+c.font.size*n+m.labelOffset+g.currentValueTotalHeight)})}function x(c,d,a,e,f){var g=Math.round(e*(a._stepCount-1)),b=a._visibleSteps[g]._index;b!==a.active&&y(c,d,a,b,!0,f)}function y(f,b,a,h,c,e){var i=a.active;a.active=h,l(f.layout,m.name,a).applyUpdate("active",h);var d=a.steps[a.active];b.call(B,a,e),b.call(t,a),f.emit("plotly_sliderchange",{slider:a,step:a.steps[a.active],interaction:c,previousActive:i}),d&&d.method&&c&&(b._nextMethod?(b._nextMethod.step=d,b._nextMethod.doCallback=c,b._nextMethod.doTransition=e):(b._nextMethod={step:d,doCallback:c,doTransition:e},b._nextMethodRaf=window.requestAnimationFrame(function(){var a=b._nextMethod.step;a.method&&(a.execute&&g.executeAPICommand(f,a.method,a.args),b._nextMethod=null,b._nextMethodRaf=null)})))}function z(a,c,d){var e=d.node(),g=f.select(c);function i(){return d.data()[0]}function b(){var a=i();c.emit("plotly_sliderstart",{slider:a});var k=d.select("."+m.gripRectClass);f.event.stopPropagation(),f.event.preventDefault(),k.call(h.fill,a.activebgcolor);var l=D(a,f.mouse(e)[0]);function b(){var a=i(),b=D(a,f.mouse(e)[0]);x(c,d,a,b,!1)}function j(){var a=i();a._dragging=!1,k.call(h.fill,a.bgcolor),g.on("mouseup",null),g.on("mousemove",null),g.on("touchend",null),g.on("touchmove",null),c.emit("plotly_sliderend",{slider:a,step:a.steps[a.active]})}x(c,d,a,l,!0),a._dragging=!0,g.on("mousemove",b),g.on("touchmove",b),g.on("mouseup",j),g.on("touchend",j)}a.on("mousedown",b),a.on("touchstart",b)}function A(c,b){var a=c.selectAll("rect."+m.tickRectClass).data(b._visibleSteps),d=b._dims;a.enter().append("rect").classed(m.tickRectClass,!0),a.exit().remove(),a.attr({width:b.tickwidth+"px","shape-rendering":"crispEdges"}),a.each(function(g,a){var c=a%d.labelStride==0,e=f.select(this);e.attr({height:c?b.ticklen:b.minorticklen}).call(h.fill,b.tickcolor),i.setTranslate(e,C(b,a/(b._stepCount-1))-.5*b.tickwidth,(c?m.tickOffset:m.minorTickOffset)+d.currentValueTotalHeight)})}function B(e,a,f){for(var g=e.select("rect."+m.gripRectClass),d=0,b=0;b<a._stepCount;b++)if(a._visibleSteps[b]._index===a.active){d=b;break}var h=C(a,d/(a._stepCount-1));if(!a._invokingCommand){var c=g;f&&a.transition.duration>0&&(c=c.transition().duration(a.transition.duration).ease(a.transition.easing)),c.attr("transform",j(h-.5*m.gripWidth,a._dims.currentValueTotalHeight))}}function C(b,c){var a=b._dims;return a.inputAreaStart+m.stepInset+(a.inputAreaLength-2*m.stepInset)*Math.min(1,Math.max(0,c))}function D(b,c){var a=b._dims;return Math.min(1,Math.max(0,(c-m.stepInset-a.inputAreaStart)/(a.inputAreaLength-2*m.stepInset-2*a.inputAreaStart)))}function E(e,f,b){var a=b._dims,c=d.ensureSingle(e,"rect",m.railTouchRectClass,function(a){a.call(z,f,e,b).style("pointer-events","all")});c.attr({width:a.inputAreaLength,height:Math.max(a.inputAreaWidth,m.tickOffset+b.ticklen+a.labelHeight)}).call(h.fill,b.bgcolor).attr("opacity",0),i.setTranslate(c,0,a.currentValueTotalHeight)}function F(e,a){var b=a._dims,f=b.inputAreaLength-2*m.railInset,c=d.ensureSingle(e,"rect",m.railRectClass);c.attr({width:f,height:m.railWidth,rx:m.railRadius,ry:m.railRadius,"shape-rendering":"crispEdges"}).call(h.stroke,a.bordercolor).call(h.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px"),i.setTranslate(c,m.railInset,(b.inputAreaWidth-m.railWidth)*.5+b.currentValueTotalHeight)}c.exports=function(b){var h=b._fullLayout,a=function(e,f){for(var c=e[m.name],d=[],a=0;a<c.length;a++){var b=c[a];b.visible&&(b._gd=f,d.push(b))}return d}(h,b),c=h._infolayer.selectAll("g."+m.containerClassName).data(a.length>0?[0]:[]);function j(a){a._commandObserver&&(a._commandObserver.remove(),delete a._commandObserver),g.autoMargin(b,q(a))}if(c.enter().append("g").classed(m.containerClassName,!0).style("cursor","ew-resize"),c.exit().each(function(){f.select(this).selectAll("g."+m.groupClassName).each(j)}).remove(),0!==a.length){var d=c.selectAll("g."+m.groupClassName).data(a,r);d.enter().append("g").classed(m.groupClassName,!0),d.exit().each(j).remove();for(var e=0;e<a.length;e++)s(b,a[e]);d.each(function(d){var e,c,a,h,j=f.select(this);(function(b){var c=b._dims;c.labelSteps=[];for(var d=b._stepCount,a=0;a<d;a+=c.labelStride)c.labelSteps.push({fraction:a/(d-1),step:b._visibleSteps[a]})})(d),g.manageCommandObserver(b,d,d._visibleSteps,function(c){var a=j.data()[0];a.active!==c.index&&(a._dragging||y(b,j,a,c.index,!1,!0))}),e=b,c=f.select(this),((a=d).steps[a.active]||{}).visible||(a.active=a._visibleSteps[0]._index),c.call(t,a).call(F,a).call(w,a).call(A,a).call(E,e,a).call(u,e,a),h=a._dims,i.setTranslate(c,h.lx+a.pad.l,h.ly+a.pad.t),c.call(B,a,!1),c.call(t,a)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(a,b,d){"use strict";var c=a("./constants");b.exports={moduleType:"component",name:c.name,layoutAttributes:a("./attributes"),supplyLayoutDefaults:a("./defaults"),draw:a("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("fast-isnumeric"),g=a("../../plots/plots"),h=a("../../registry"),c=a("../../lib"),i=c.strTranslate,j=a("../drawing"),k=a("../color"),l=a("../../lib/svg_text_utils"),m=a("../../constants/interactions"),n=a("../../constants/alignment").OPPOSITE_SIDE,o=/ [XY][0-9]* /;b.exports={draw:function(t,z,a){var r,C,D=a.propContainer,u=a.propName,A=a.placeholder,F=a.traceIndex,G=a.avoid||{},H=a.attributes,I=a.transform,q=a.containerGroup,s=t._fullLayout,v=1,w=!1,p=D.title,b=(p&&p.text?p.text:"").trim(),x=p&&p.font?p.font:{},J=x.family,K=x.size,L=x.color;"title.text"===u?r="titleText":-1!==u.indexOf("axis")?r="axisTitleText":u.indexOf(!0)&&(r="colorbarTitleText");var y=t._context.edits[r];""===b?v=0:b.replace(o," % ")!==A.replace(o," % ")||(v=.2,w=!0,y||(b="")),a._meta?b=c.templateString(b,a._meta):s._meta&&(b=c.templateString(b,s._meta));var B=b||y;q||(q=c.ensureSingle(s._infolayer,"g","g-"+z),C=s._hColorbarMoveTitle);var d=q.selectAll("text").data(B?[0]:[]);if(d.enter().append("text"),d.text(b).attr("class",z),d.exit().remove(),!B)return q;function E(a){c.syncOrAsync([M,N],a)}function M(b){var a;return!I&&C&&(I={}),I?(a="",I.rotate&&(a+="rotate("+[I.rotate,H.x,H.y]+")"),(I.offset||C)&&(a+=i(0,(I.offset||0)-(C||0)))):a=null,b.attr("transform",a),b.style({"font-family":J,"font-size":e.round(K,2)+"px",fill:k.rgb(L),opacity:v*k.opacity(L),"font-weight":g.fontWeight}).attr(H).call(l.convertToTspans,t),g.previousPromises(t)}function N(o){var h=e.select(o.node().parentNode);if(G&&G.selection&&G.side&&b){h.attr("transform",null);var r=n[G.side],p="left"===G.side||"top"===G.side?-1:1,t=f(G.pad)?G.pad:2,d=j.bBox(h.node()),q={left:0,top:0,right:s.width,bottom:s.height},g=G.maxShift||p*(q[G.side]-d[G.side]),a=0;if(g<0)a=g;else{var k=G.offsetLeft||0,l=G.offsetTop||0;d.left-=k,d.right-=k,d.top-=l,d.bottom-=l,G.selection.each(function(){var b=j.bBox(this);c.bBoxIntersect(d,b,t)&&(a=Math.max(a,p*(b[G.side]-d[r])+t))}),a=Math.min(g,a)}if(a>0||g<0){var m={left:[-a,0],right:[a,0],top:[0,-a],bottom:[0,a]}[G.side];h.attr("transform",i(m[0],m[1]))}}}return d.call(E),y&&(b?d.on(".opacity",null):(v=0,w=!0,d.text(A).on("mouseover.opacity",function(){e.select(this).transition().duration(m.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){e.select(this).transition().duration(m.HIDE_PLACEHOLDER).style("opacity",0)})),d.call(l.makeEditable,{gd:t}).on("edit",function(a){void 0!==F?h.call("_guiRestyle",t,u,a,F):h.call("_guiRelayout",t,u,a)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(E)}).on("input",function(a){this.text(a||" ").call(l.positionText,H.x,H.y)})),d.classed("js-placeholder",w),q}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(a,c,j){"use strict";var d=a("../../plots/font_attributes"),e=a("../color/attributes"),f=a("../../lib/extend").extendFlat,g=a("../../plot_api/edit_types").overrideAll,h=a("../../plots/pad_attributes"),b=a("../../plot_api/plot_template").templatedArray,i=b("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});c.exports=g(b("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:i,x:{valType:"number",min:-2,max:3,dflt:-0.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:f(h({editType:"arraydraw"}),{}),font:d({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:e.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(b,a,c){"use strict";a.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../../plots/array_container_defaults"),c=a("./attributes"),g=a("./constants").name,h=c.buttons;function i(b,d,g){function a(a,f){return e.coerce(b,d,c,a,f)}a("visible",f(b,d,{name:"buttons",handleItemDefaults:j}).length>0)&&(a("active"),a("direction"),a("type"),a("showactive"),a("x"),a("y"),e.noneOrAll(b,d,["x","y"]),a("xanchor"),a("yanchor"),a("pad.t"),a("pad.r"),a("pad.b"),a("pad.l"),e.coerceFont(a,"font",g.font),a("bgcolor",g.paper_bgcolor),a("bordercolor"),a("borderwidth"))}function j(b,c){function a(a,d){return e.coerce(b,c,h,a,d)}a("visible","skip"===b.method||Array.isArray(b.args))&&(a("method"),a("args"),a("args2"),a("label"),a("execute"))}b.exports=function(a,b){f(a,b,{name:g,handleItemDefaults:i})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../plots/plots"),f=a("../color"),g=a("../drawing"),h=a("../../lib"),i=a("../../lib/svg_text_utils"),j=a("../../plot_api/plot_template").arrayEditor,k=a("../../constants/alignment").LINE_SPACING,l=a("./constants"),m=a("./scrollbox");function n(a){return a._index}function o(a,b){return+a.attr(l.menuIndexAttrName)===b._index}function p(b,a,h,c,d,e,f,g){a.active=f,j(b.layout,l.name,a).applyUpdate("active",f),"buttons"===a.type?r(b,c,null,null,a):"dropdown"!==a.type||(d.attr(l.menuIndexAttrName,"-1"),q(b,c,d,e,a),g||r(b,c,d,e,a))}function q(e,d,n,p,a){var c=h.ensureSingle(d,"g",l.headerClassName,function(a){a.style("pointer-events","all")}),b=a._dims,f=a.active,i=a.buttons[f]||l.blankHeaderOpts,j={y:a.pad.t,yPad:0,x:a.pad.l,xPad:0,index:0},k={width:b.headerWidth,height:b.headerHeight};c.call(u,a,i,e).call(C,a,j,k);var m=h.ensureSingle(d,"text",l.headerArrowClassName,function(b){b.attr("text-anchor","end").call(g.font,a.font).text(l.arrowSymbol[a.direction])});m.attr({x:b.headerWidth-l.arrowOffsetX+a.pad.l,y:b.headerHeight/2+l.textOffsetY+a.pad.t}),c.on("click",function(){n.call(D,String(o(n,a)?-1:a._index)),r(e,d,n,p,a)}),c.on("mouseover",function(){c.call(y)}),c.on("mouseout",function(){c.call(z,a)}),g.setTranslate(d,b.lx,b.ly)}function r(v,n,f,j,a){f||(f=n).attr("pointer-events","all");var w=-1== +f.attr(l.menuIndexAttrName)&&"buttons"!==a.type?[]:a.buttons,o="dropdown"===a.type?l.dropdownButtonClassName:l.buttonClassName,g=f.selectAll("g."+o).data(h.filterVisible(w)),A=g.enter().append("g").classed(o,!0),q=g.exit();"dropdown"===a.type?(A.attr("opacity","0").transition().attr("opacity","1"),q.transition().attr("opacity","0").remove()):q.remove();var k=0,m=0,b=a._dims,r=-1!==["up","down"].indexOf(a.direction);"dropdown"===a.type&&(r?m=b.headerHeight+l.gapButtonHeader:k=b.headerWidth+l.gapButtonHeader),"dropdown"===a.type&&"up"===a.direction&&(m=-l.gapButtonHeader+l.gapButton-b.openHeight),"dropdown"===a.type&&"left"===a.direction&&(k=-l.gapButtonHeader+l.gapButton-b.openWidth);var i={x:b.lx+k+a.pad.l,y:b.ly+m+a.pad.t,yPad:l.gapButton,xPad:l.gapButton,index:0},c={l:i.x+a.borderwidth,t:i.y+a.borderwidth};g.each(function(c,h){var b=d.select(this);b.call(u,a,c,v).call(C,a,i),b.on("click",function(){d.event.defaultPrevented||(c.execute&&(c.args2&&a.active===h?(p(v,a,c,n,f,j,-1),e.executeAPICommand(v,c.method,c.args2)):(p(v,a,c,n,f,j,h),e.executeAPICommand(v,c.method,c.args))),v.emit("plotly_buttonclicked",{menu:a,button:c,active:a.active}))}),b.on("mouseover",function(){b.call(y)}),b.on("mouseout",function(){b.call(z,a),g.call(x,a)})}),g.call(x,a),r?(c.w=Math.max(b.openWidth,b.headerWidth),c.h=i.y-c.t):(c.w=i.x-c.l,c.h=Math.max(b.openHeight,b.headerHeight)),c.direction=a.direction,j&&(g.size()?s(v,n,f,j,a,c):t(j))}function s(j,k,m,b,c,i){var d,e,a,f=c.direction,g=c._dims,h=c.active;if("up"===f||"down"===f)for(a=0,e=0;a<h;a++)e+=g.heights[a]+l.gapButton;else for(a=0,d=0;a<h;a++)d+=g.widths[a]+l.gapButton;b.enable(i,d,e),b.hbar&&b.hbar.attr("opacity","0").transition().attr("opacity","1"),b.vbar&&b.vbar.attr("opacity","0").transition().attr("opacity","1")}function t(a){var b=!!a.hbar,c=!!a.vbar;b&&a.hbar.transition().attr("opacity","0").each("end",function(){b=!1,c||a.disable()}),c&&a.vbar.transition().attr("opacity","0").each("end",function(){c=!1,b||a.disable()})}function u(b,a,c,d){b.call(v,a).call(w,a,c,d)}function v(b,a){h.ensureSingle(b,"rect",l.itemRectClassName,function(a){a.attr({rx:l.rx,ry:l.ry,"shape-rendering":"crispEdges"})}).call(f.stroke,a.bordercolor).call(f.fill,a.bgcolor).style("stroke-width",a.borderwidth+"px")}function w(d,e,f,b){var j=h.ensureSingle(d,"text",l.itemTextClassName,function(a){a.attr({"text-anchor":"start","data-notex":1})}),a=f.label,c=b._fullLayout._meta;c&&(a=h.templateString(a,c)),j.call(g.font,e.font).text(a).call(i.convertToTspans,b)}function x(a,b){var c=b.active;a.each(function(g,a){var e=d.select(this);a===c&&b.showactive&&e.select("rect."+l.itemRectClassName).call(f.fill,l.activeColor)})}function y(a){a.select("rect."+l.itemRectClassName).call(f.fill,l.hoverColor)}function z(a,b){a.select("rect."+l.itemRectClassName).call(f.fill,b.bgcolor)}function A(p,b){var a=b._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},o=g.tester.selectAll("g."+l.dropdownButtonClassName).data(h.filterVisible(b.buttons));o.enter().append("g").classed(l.dropdownButtonClassName,!0);var q=-1!==["up","down"].indexOf(b.direction);o.each(function(m,h){var j=d.select(this);j.call(u,b,m,p);var f=j.select("."+l.itemTextClassName),c=Math.max((f.node()&&g.bBox(f.node()).width)+l.textPadX,l.minWidth),e=Math.max(b.font.size*k*i.lineCount(f),l.minHeight)+l.textOffsetY;e=Math.ceil(e),c=Math.ceil(c),a.widths[h]=c,a.heights[h]=e,a.height1=Math.max(a.height1,e),a.width1=Math.max(a.width1,c),q?(a.totalWidth=Math.max(a.totalWidth,c),a.openWidth=a.totalWidth,a.totalHeight+=e+l.gapButton,a.openHeight+=e+l.gapButton):(a.totalWidth+=c+l.gapButton,a.openWidth+=c+l.gapButton,a.totalHeight=Math.max(a.totalHeight,e),a.openHeight=a.totalHeight)}),q?a.totalHeight-=l.gapButton:a.totalWidth-=l.gapButton,a.headerWidth=a.width1+l.arrowPadX,a.headerHeight=a.height1,"dropdown"===b.type&&(q?(a.width1+=l.arrowPadX,a.totalHeight=a.height1):a.totalWidth=a.width1,a.totalWidth+=l.arrowPadX),o.remove();var c=a.totalWidth+b.pad.l+b.pad.r,f=a.totalHeight+b.pad.t+b.pad.b,j=p._fullLayout._size;a.lx=j.l+j.w*b.x,a.ly=j.t+j.h*(1-b.y);var m="left";h.isRightAnchor(b)&&(a.lx-=c,m="right"),h.isCenterAnchor(b)&&(a.lx-=c/2,m="center");var n="top";h.isBottomAnchor(b)&&(a.ly-=f,n="bottom"),h.isMiddleAnchor(b)&&(a.ly-=f/2,n="middle"),a.totalWidth=Math.ceil(a.totalWidth),a.totalHeight=Math.ceil(a.totalHeight),a.lx=Math.round(a.lx),a.ly=Math.round(a.ly),e.autoMargin(p,B(b),{x:b.x,y:b.y,l:c*(({right:1,center:.5})[m]||0),r:c*(({left:1,center:.5})[m]||0),b:f*(({top:1,middle:.5})[n]||0),t:f*(({bottom:1,middle:.5})[n]||0)})}function B(a){return l.autoMarginIdRoot+a._index}function C(f,c,a,d){d=d||{};var o=f.select("."+l.itemRectClassName),j=f.select("."+l.itemTextClassName),m=c.borderwidth,e=a.index,b=c._dims;g.setTranslate(f,m+a.x,m+a.y);var h=-1!==["up","down"].indexOf(c.direction),n=d.height||(h?b.heights[e]:b.height1);o.attr({x:0,y:0,width:d.width||(h?b.width1:b.widths[e]),height:n});var p=c.font.size*k,q=i.lineCount(j);i.positionText(j,l.textOffsetX,n/2-(q-1)*p/2+l.textOffsetY),h?a.y+=b.heights[e]+a.yPad:a.x+=b.widths[e]+a.xPad,a.index++}function D(a,b){a.attr(l.menuIndexAttrName,b||"-1").selectAll("g."+l.dropdownButtonClassName).remove()}b.exports=function(g){var i=g._fullLayout,a=h.filterVisible(i[l.name]);function s(a){e.autoMargin(g,B(a))}var b=i._menulayer.selectAll("g."+l.containerClassName).data(a.length>0?[0]:[]);if(b.enter().append("g").classed(l.containerClassName,!0).style("cursor","pointer"),b.exit().each(function(){d.select(this).selectAll("g."+l.headerGroupClassName).each(s)}).remove(),0!==a.length){var c=b.selectAll("g."+l.headerGroupClassName).data(a,n);c.enter().append("g").classed(l.headerGroupClassName,!0);for(var f=h.ensureSingle(b,"g",l.dropdownButtonGroupClassName,function(a){a.style("pointer-events","all")}),j=0;j<a.length;j++)A(g,a[j]);var k="updatemenus"+i._uid,t=new m(g,f,k);c.enter().size()&&(f.node().parentNode.appendChild(f.node()),f.call(D)),c.exit().each(function(a){f.call(D),s(a)}).remove(),c.each(function(a){var b=d.select(this),c="dropdown"===a.type?f:null;e.manageCommandObserver(g,a,a.buttons,function(d){p(g,a,a.buttons[d.index],b,c,t,d.index,!0)}),"dropdown"===a.type?(q(g,b,f,t,a),o(f,a)&&r(g,b,f,t,a)):r(g,b,null,null,a)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(b,c,a){arguments[4][475][0].apply(a,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(b,c,d){"use strict";c.exports=a;var e=b("@plotly/d3"),f=b("../color"),g=b("../drawing"),h=b("../../lib");function a(a,b,c){this.gd=a,this.container=b,this.id=c,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}a.barWidth=2,a.barLength=20,a.barRadius=2,a.barPad=1,a.barColor="#808BA4",a.prototype.enable=function(M,N,O){var d,k,h,l,u=this.gd._fullLayout,v=u.width,w=u.height;this.position=M;var m=this.position.l,o=this.position.w,n=this.position.t,p=this.position.h,q=this.position.direction,r="down"===q,F="left"===q,G="up"===q,b=o,c=p;r||F||"right"===q||G||(this.position.direction="down",r=!0),r||G?(k=(d=m)+b,r?c=(l=Math.min((h=n)+c,w))-h:(h=Math.max((l=n+c)-c,0),c=l-h)):(l=(h=n)+c,F?(d=Math.max((k=m+b)-b,0),b=k-d):b=(k=Math.min((d=m)+b,v))-d),this._box={l:d,t:h,w:b,h:c};var i=o>b,x=a.barLength+2*a.barPad,s=a.barWidth+2*a.barPad,H=m,y=n+p;y+s>w&&(y=w-s);var z=this.container.selectAll("rect.scrollbar-horizontal").data(i?[0]:[]);z.exit().on(".drag",null).remove(),z.enter().append("rect").classed("scrollbar-horizontal",!0).call(f.fill,a.barColor),i?(this.hbar=z.attr({rx:a.barRadius,ry:a.barRadius,x:H,y:y,width:x,height:s}),this._hbarXMin=H+x/2,this._hbarTranslateMax=b-x):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var j=p>c,t=a.barWidth+2*a.barPad,A=a.barLength+2*a.barPad,B=m+o,I=n;B+t>v&&(B=v-t);var C=this.container.selectAll("rect.scrollbar-vertical").data(j?[0]:[]);C.exit().on(".drag",null).remove(),C.enter().append("rect").classed("scrollbar-vertical",!0).call(f.fill,a.barColor),j?(this.vbar=C.attr({rx:a.barRadius,ry:a.barRadius,x:B,y:I,width:t,height:A}),this._vbarYMin=I+A/2,this._vbarTranslateMax=c-A):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var D=this.id,J=d-.5,K=h-.5,E=u._topdefs.selectAll("#"+D).data(i||j?[0]:[]);if(E.exit().remove(),E.enter().append("clipPath").attr("id",D).append("rect"),i||j?(this._clipRect=E.select("rect").attr({x:Math.floor(J),y:Math.floor(K),width:Math.ceil(j?k+t+.5:k+.5)-Math.floor(J),height:Math.ceil(i?l+s+.5:l+.5)-Math.floor(K)}),this.container.call(g.setClipUrl,D,this.gd),this.bg.attr({x:m,y:n,width:o,height:p})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(g.setClipUrl,null),delete this._clipRect),i||j){var P=e.behavior.drag().on("dragstart",function(){e.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(P);var L=e.behavior.drag().on("dragstart",function(){e.event.sourceEvent.preventDefault(),e.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));i&&this.hbar.on(".drag",null).call(L),j&&this.vbar.on(".drag",null).call(L)}this.setTranslate(N,O)},a.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(g.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},a.prototype._onBoxDrag=function(){var a=this.translateX,b=this.translateY;this.hbar&&(a-=e.event.dx),this.vbar&&(b-=e.event.dy),this.setTranslate(a,b)},a.prototype._onBoxWheel=function(){var a=this.translateX,b=this.translateY;this.hbar&&(a+=e.event.deltaY),this.vbar&&(b+=e.event.deltaY),this.setTranslate(a,b)},a.prototype._onBarDrag=function(){var c=this.translateX,d=this.translateY;if(this.hbar){var a=c+this._hbarXMin,f=a+this._hbarTranslateMax;c=(h.constrain(e.event.x,a,f)-a)/(f-a)*(this.position.w-this._box.w)}if(this.vbar){var b=d+this._vbarYMin,g=b+this._vbarTranslateMax;d=(h.constrain(e.event.y,b,g)-b)/(g-b)*(this.position.h-this._box.h)}this.setTranslate(c,d)},a.prototype.setTranslate=function(a,b){var c=this.position.w-this._box.w,d=this.position.h-this._box.h;if(a=h.constrain(a||0,0,c),b=h.constrain(b||0,0,d),this.translateX=a,this.translateY=b,this.container.call(g.setTranslate,this._box.l-this.position.l-a,this._box.t-this.position.t-b),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+a-.5),y:Math.floor(this.position.t+b-.5)}),this.hbar){var e=a/c;this.hbar.call(g.setTranslate,a+e*this._hbarTranslateMax,b)}if(this.vbar){var f=b/d;this.vbar.call(g.setTranslate,a,b+f*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(b,a,c){"use strict";a.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(b,a,c){"use strict";a.exports={axisRefDescription:function(a,b,c){return["If set to a",a,"axis id (e.g. *"+a+"* or","*"+a+"2*), the `"+a+"` position refers to a",a,"coordinate. If set to *paper*, the `"+a+"`","position refers to the distance from the",b,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",b,"("+c+"). If set to a",a,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",b,"of the domain of that axis: e.g.,","*"+a+"2 domain* refers to the domain of the second",a," axis and a",a,"position of 0.5 refers to the","point between the",b,"and the",c,"of the domain of the","second",a,"axis.",].join(" ")}}},{}],485:[function(b,a,c){"use strict";a.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(b,a,c){"use strict";a.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(b,a,c){"use strict";a.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(b,a,c){"use strict";a.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(b,a,c){"use strict";a.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(b,a,c){"use strict";a.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(b,a,c){"use strict";a.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(b,c,a){"use strict";a.xmlns="http://www.w3.org/2000/xmlns/",a.svg="http://www.w3.org/2000/svg",a.xlink="http://www.w3.org/1999/xlink",a.svgAttrs={xmlns:a.svg,"xmlns:xlink":a.xlink}},{}],493:[function(a,k,b){"use strict";b.version=a("./version").version,a("native-promise-only"),a("../build/plotcss");for(var j=a("./registry"),c=b.register=j.register,f=a("./plot_api"),i=Object.keys(f),g=0;g<i.length;g++){var d=i[g];"_"!==d.charAt(0)&&(b[d]=f[d]),c({moduleType:"apiMethod",name:d,fn:f[d]})}c(a("./traces/scatter")),c([a("./components/legend"),a("./components/fx"),a("./components/annotations"),a("./components/annotations3d"),a("./components/selections"),a("./components/shapes"),a("./components/images"),a("./components/updatemenus"),a("./components/sliders"),a("./components/rangeslider"),a("./components/rangeselector"),a("./components/grid"),a("./components/errorbars"),a("./components/colorscale"),a("./components/colorbar"),a("./components/modebar")]),c([a("./locale-en"),a("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(c(window.PlotlyLocales),delete window.PlotlyLocales),b.Icons=a("./fonts/ploticon");var e=a("./components/fx"),h=a("./plots/plots");b.Plots={resize:h.resize,graphJson:h.graphJson,sendDataToCloud:h.sendDataToCloud},b.Fx={hover:e.hover,unhover:e.unhover,loneHover:e.loneHover,loneUnhover:e.loneUnhover},b.Snapshot=a("./snapshot"),b.PlotSchema=a("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(b,a,c){"use strict";a.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs> <style>  .cls-0{fill:#000;}  .cls-1{fill:#FFF;}  .cls-2{fill:#F26;}  .cls-3{fill:#D69;}  .cls-4{fill:#BAC;}  .cls-5{fill:#9EF;} </style></defs> <title>plotly-logomark</title> <g id='symbol'>  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>  <circle class='cls-5' cx='102' cy='30' r='6'/>  <circle class='cls-4' cx='78' cy='30' r='6'/>  <circle class='cls-4' cx='78' cy='54' r='6'/>  <circle class='cls-3' cx='54' cy='30' r='6'/>  <circle class='cls-2' cx='30' cy='30' r='6'/>  <circle class='cls-2' cx='30' cy='54' r='6'/>  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/> </g></svg>"}}},{}],495:[function(b,c,a){"use strict";a.isLeftAnchor=function(a){return"left"===a.xanchor||"auto"===a.xanchor&&a.x<=1/3},a.isCenterAnchor=function(a){return"center"===a.xanchor||"auto"===a.xanchor&&a.x>1/3&&a.x<2/3},a.isRightAnchor=function(a){return"right"===a.xanchor||"auto"===a.xanchor&&a.x>=2/3},a.isTopAnchor=function(a){return"top"===a.yanchor||"auto"===a.yanchor&&a.y>=2/3},a.isMiddleAnchor=function(a){return"middle"===a.yanchor||"auto"===a.yanchor&&a.y>1/3&&a.y<2/3},a.isBottomAnchor=function(a){return"bottom"===a.yanchor||"auto"===a.yanchor&&a.y<=1/3}},{}],496:[function(b,c,h){"use strict";var a=b("./mod"),i=a.mod,j=a.modHalf,d=Math.PI,k=2*d;function e(a){return Math.abs(a[1]-a[0])>k-1e-14}function f(a,b){return j(b-a,k)}function g(g,a){if(e(a))return!0;a[0]<a[1]?(c=a[0],d=a[1]):(c=a[1],d=a[0]),c=i(c,k),d=i(d,k),c>d&&(d+=k);var c,d,b=i(g,k),f=b+k;return b>=c&&b<=d||f>=c&&f<=d}function l(n,o,j,l,p,q,s){p=p||0,q=q||0;var b,m,c,f,a,i,r=e([j,l]);function h(a,b){return[a*Math.cos(b)+p,q-a*Math.sin(b)]}r?(b=0,m=d,c=k):j<l?(b=j,c=l):(b=l,c=j),n<o?(f=n,a=o):(f=o,a=n);var t=Math.abs(c-b)<=d?0:1;function g(a,b,c){return"A"+[a,a]+" "+[0,t,c]+" "+h(a,b)}return r?i=null===f?"M"+h(a,b)+g(a,m,0)+g(a,c,0)+"Z":"M"+h(f,b)+g(f,m,0)+g(f,c,0)+"ZM"+h(a,b)+g(a,m,1)+g(a,c,1)+"Z":null===f?(i="M"+h(a,b)+g(a,c,0),s&&(i+="L0,0Z")):i="M"+h(f,b)+"L"+h(a,b)+g(a,c,0)+"L"+h(f,c)+g(f,b,1)+"Z",i}c.exports={deg2rad:function(a){return a/180*d},rad2deg:function(a){return a/d*180},angleDelta:f,angleDist:function(a,b){return Math.abs(f(a,b))},isFullCircle:e,isAngleInsideSector:g,isPtInsideSector:function(d,e,a,f){var b,c;return!!g(e,f)&&(a[0]<a[1]?(b=a[0],c=a[1]):(b=a[1],c=a[0]),d>=b&&d<=c)},pathArc:function(a,b,c,d,e){return l(null,a,b,c,d,e,0)},pathSector:function(a,b,c,d,e){return l(null,a,b,c,d,e,1)},pathAnnulus:function(a,b,c,d,e,f){return l(a,b,c,d,e,f,1)}}},{"./mod":522}],497:[function(d,e,a){"use strict";var f=Array.isArray,g=ArrayBuffer,h=DataView;function b(a){return g.isView(a)&&!(a instanceof h)}function c(a){return f(a)||b(a)}function i(a,e,f){if(c(a)){if(!c(a[0]))return a.length;for(var b=f,d=0;d<a.length;d++)b=e(b,a[d].length);return b}return 0}a.isTypedArray=b,a.isArrayOrTypedArray=c,a.isArray1D=function(a){return!c(a[0])},a.ensureArray=function(a,b){return f(a)||(a=[]),a.length=b,a},a.concat=function(){var h,d,b,a,i,k,e,c,g=[],l=!0,j=0;for(b=0;b<arguments.length;b++)a=arguments[b],(k=a.length)&&(d?g.push(a):(d=a,i=k),f(a)?h=!1:(l=!1,j?h!==a.constructor&&(h=!1):h=a.constructor),j+=k);if(!j)return[];if(!g.length)return d;if(l)return d.concat.apply(d,g);if(h){for((e=new h(j)).set(d),b=0;b<g.length;b++)a=g[b],e.set(a,i),i+=a.length;return e}for(c=0,e=new Array(j);c<d.length;c++)e[c]=d[c];for(b=0;b<g.length;b++){for(c=0,a=g[b];c<a.length;c++)e[i+c]=a[c];i+=c}return e},a.maxRowLength=function(a){return i(a,Math.max,0)},a.minRowLength=function(a){return i(a,Math.min,1/0)}},{}],498:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../constants/numerical").BADNUM,f=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;b.exports=function(a){return("string"==typeof a&&(a=a.replace(f,"")),d(a))?Number(a):e}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(b,a,c){"use strict";a.exports=function(b){var a=b._fullLayout;a._glcanvas&&a._glcanvas.size()&&a._glcanvas.each(function(a){a.regl&&a.regl.clear({color:!0,depth:!0})})}},{}],500:[function(b,a,c){"use strict";a.exports=function(a){a._responsiveChartHandler&&(window.removeEventListener("resize",a._responsiveChartHandler),delete a._responsiveChartHandler)}},{}],501:[function(a,d,b){"use strict";var e=a("fast-isnumeric"),f=a("tinycolor2"),g=a("../plots/attributes"),h=a("../components/colorscale/scales"),i=a("../components/color"),j=a("../constants/interactions").DESELECTDIM,k=a("./nested_property"),l=a("./regex").counter,m=a("./mod").modHalf,n=a("./array").isArrayOrTypedArray;function c(c,a){var d=b.valObjectMeta[a.valType];if(a.arrayOk&&n(c))return!0;if(d.validateFunction)return d.validateFunction(c,a);var e={},f=e,g={set:function(a){f=a}};return d.coerceFunction(c,g,e,a),f!==e}b.valObjectMeta={data_array:{coerceFunction:function(a,b,c){n(a)?b.set(a):void 0!==c&&b.set(c)}},enumerated:{coerceFunction:function(a,b,d,c){c.coerceNumber&&(a=+a),-1===c.values.indexOf(a)?b.set(d):b.set(a)},validateFunction:function(b,e){e.coerceNumber&&(b=+b);for(var d=e.values,c=0;c<d.length;c++){var a=String(d[c]);if("/"===a.charAt(0)&&"/"===a.charAt(a.length-1)){if(new RegExp(a.substr(1,a.length-2)).test(b))return!0}else if(b===d[c])return!0}return!1}},"boolean":{coerceFunction:function(a,b,c){!0===a|| !1===a?b.set(a):b.set(c)}},number:{coerceFunction:function(a,c,d,b){!e(a)|| void 0!==b.min&&a<b.min|| void 0!==b.max&&a>b.max?c.set(d):c.set(+a)}},integer:{coerceFunction:function(a,c,d,b){a%1||!e(a)|| void 0!==b.min&&a<b.min|| void 0!==b.max&&a>b.max?c.set(d):c.set(+a)}},string:{coerceFunction:function(a,b,c,d){if("string"!=typeof a){var e="number"==typeof a;!0!==d.strict&&e?b.set(String(a)):b.set(c)}else d.noBlank&&!a?b.set(c):b.set(a)}},color:{coerceFunction:function(a,b,c){f(a).isValid()?b.set(a):b.set(c)}},colorlist:{coerceFunction:function(a,b,c){Array.isArray(a)&&a.length&&a.every(function(a){return f(a).isValid()})?b.set(a):b.set(c)}},colorscale:{coerceFunction:function(a,b,c){b.set(h.get(a,c))}},angle:{coerceFunction:function(a,b,c){"auto"===a?b.set("auto"):e(a)?b.set(m(+a,360)):b.set(c)}},subplotid:{coerceFunction:function(a,b,c,d){var e=d.regex||l(c);if("string"==typeof a&&e.test(a)){b.set(a);return}b.set(c)},validateFunction:function(a,c){var b=c.dflt;return a===b||"string"==typeof a&&!!l(b).test(a)}},flaglist:{coerceFunction:function(c,d,e,f){if(-1!==(f.extras||[]).indexOf(c)){d.set(c);return}if("string"!=typeof c){d.set(e);return}for(var a=c.split("+"),b=0;b<a.length;){var g=a[b];-1===f.flags.indexOf(g)||a.indexOf(g)<b?a.splice(b,1):b++}a.length?d.set(a.join("+")):d.set(e)}},any:{coerceFunction:function(a,b,c){void 0===a?b.set(c):b.set(a)}},info_array:{coerceFunction:function(e,n,f,j){function o(d,a,c){var e;return void 0===c&&(c=a.dflt),b.valObjectMeta[a.valType].coerceFunction(d,{set:function(a){e=a}},c,a),e}var a,d,k,p,q,h,l=2===j.dimensions||"1-2"===j.dimensions&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e)){n.set(f);return}var c=j.items,i=[],g=Array.isArray(c),s=g&&l&&Array.isArray(c[0]),m=l&&g&&!s,r=g&&!m?c.length:e.length;if(f=Array.isArray(f)?f:[],l)for(a=0;a<r;a++)for(d=0,i[a]=[],k=Array.isArray(e[a])?e[a]:[],q=m?c.length:g?c[a].length:k.length;d<q;d++)p=m?c[d]:g?c[a][d]:c,h=o(k[d],p,(f[a]||[])[d]),void 0!==h&&(i[a][d]=h);else for(a=0;a<r;a++)void 0!==(h=o(e[a],g?c[a]:c,f[a]))&&(i[a]=h);n.set(i)},validateFunction:function(b,e){if(!Array.isArray(b))return!1;var d=e.items,g=Array.isArray(d),h=2===e.dimensions;if(!e.freeLength&&b.length!==d.length)return!1;for(var a=0;a<b.length;a++)if(h){if(!Array.isArray(b[a])|| !e.freeLength&&b[a].length!==d[a].length)return!1;for(var f=0;f<b[a].length;f++)if(!c(b[a][f],g?d[a][f]:d))return!1}else if(!c(b[a],g?d[a]:d))return!1;return!0}}},b.coerce=function(m,j,o,e,f){var d=k(o,e).get(),p=k(m,e),g=k(j,e),a=p.get(),h=j._template;if(void 0===a&&h&&(a=k(h,e).get(),h=0),void 0===f&&(f=d.dflt),d.arrayOk&&n(a))return g.set(a),a;var l=b.valObjectMeta[d.valType].coerceFunction;l(a,g,f,d);var i=g.get();return h&&i===f&&!c(a,d)&&(l(a=k(h,e).get(),g,f,d),i=g.get()),i},b.coerce2=function(a,d,e,c,f){var g=k(a,c),h=b.coerce(a,d,e,c,f);return null!=g.get()&&h},b.coerceFont=function(c,d,a){var b={};return a=a||{},b.family=c(d+".family",a.family),b.size=c(d+".size",a.size),b.color=c(d+".color",a.color),b},b.coercePattern=function(a,b,d,e){if(a(b+".shape")){a(b+".solidity"),a(b+".size");var c="overlay"===a(b+".fillmode");if(!e){var f=a(b+".bgcolor",c?d:void 0);a(b+".fgcolor",c?i.contrast(f):d)}a(b+".fgopacity",c?.5:1)}},b.coerceHoverinfo=function(i,d,j){var e,f=d._module.attributes,h=f.hoverinfo?f:g,a=h.hoverinfo;if(1===j._dataLength){var c="all"===a.dflt?a.flags.slice():a.dflt.split("+");c.splice(c.indexOf("name"),1),e=c.join("+")}return b.coerce(i,d,h,"hoverinfo",e)},b.coerceSelectionMarkerOpacity=function(a,c){if(a.marker){var d,e,b=a.marker.opacity;void 0!==b&&(n(b)||a.selected||a.unselected||(d=b,e=j*b),c("selected.marker.opacity",d),c("unselected.marker.opacity",e))}},b.validate=c},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(b,i,a){"use strict";var e,f,j=b("d3-time-format").timeFormat,k=b("fast-isnumeric"),l=b("./loggers"),m=b("./mod").mod,c=b("../constants/numerical"),n=c.BADNUM,d=c.ONEDAY,g=c.ONEHOUR,h=c.ONEMIN,o=c.ONESEC,p=c.EPOCHJD,q=b("../registry"),r=b("d3-time-format").utcFormat,s=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,t=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,u=new Date().getFullYear()-70;function v(a){return a&&q.componentsRegistry.calendars&&"string"==typeof a&&"gregorian"!==a}function w(a,b){return String(a+Math.pow(10,b)).substr(1)}a.dateTick0=function(c,e){var b,f,g=(b=c,f=!!e,v(b)?f?q.getComponentMethod("calendars","CANONICAL_SUNDAY")[b]:q.getComponentMethod("calendars","CANONICAL_TICK")[b]:f?"2000-01-02":"2000-01-01");if(e<2)return g;var h=a.dateTime2ms(g,c);return h+=d*(e-1),a.ms2DateTime(h,0,c)},a.dfltRange=function(a){return v(a)?q.getComponentMethod("calendars","DFLTRANGE")[a]:["2000-01-01","2001-01-01"]},a.isJSDate=function(a){return"object"==typeof a&&null!==a&&"function"==typeof a.getTime},a.dateTime2ms=function(b,k){if(a.isJSDate(b)){var l=b.getTimezoneOffset()*h,B=(b.getUTCMinutes()-b.getMinutes())*h+(b.getUTCSeconds()-b.getSeconds())*o+(b.getUTCMilliseconds()-b.getMilliseconds());if(B){var y=3*h;l=l-y/2+m(B-l+y/2,y)}return(b=Number(b)-l)>=e&&b<=f?b:n}if("string"!=typeof b&&"number"!=typeof b)return n;b=String(b);var z=v(k),C=b.charAt(0);z&&("G"===C||"g"===C)&&(b=b.substr(1),k="");var D=z&&"chinese"===k.substr(0,7),j=b.match(D?t:s);if(!j)return n;var c=j[1],i=j[3]||"1",r=Number(j[5]||1),E=Number(j[7]||0),F=Number(j[9]||0),G=Number(j[11]||0);if(z){if(2===c.length)return n;c=Number(c);try{var w,A=q.getComponentMethod("calendars","getCal")(k);if(D){var H="i"===i.charAt(i.length-1);i=parseInt(i,10),w=A.newDate(c,A.toMonthIndex(c,i,H),r)}else w=A.newDate(c,Number(i),r)}catch(I){return n}return w?(w.toJD()-p)*d+E*g+F*h+G*o:n}c=2===c.length?(Number(c)+2e3-u)%100+u:Number(c),i-=1;var x=new Date(Date.UTC(2e3,i,r,E,F));return(x.setUTCFullYear(c),x.getUTCMonth()!==i)?n:x.getUTCDate()!==r?n:x.getTime()+G*o},e=a.MIN_MS=a.dateTime2ms("-9999"),f=a.MAX_MS=a.dateTime2ms("9999-12-31 23:59:59.9999"),a.isDateTime=function(b,c){return a.dateTime2ms(b,c)!==n};var x=90*d,y=3*g,z=5*h;function A(b,d,e,c,a){if((d||e||c||a)&&(b+=" "+w(d,2)+":"+w(e,2),(c||a)&&(b+=":"+w(c,2),a))){for(var f=4;a%10==0;)f-=1,a/=10;b+="."+w(a,f)}return b}a.ms2DateTime=function(c,b,B){if("number"!=typeof c||!(c>=e&&c<=f))return n;b||(b=0);var a,k,l,s,t,i,u=Math.floor(10*m(c+.05,1)),w=Math.round(c-u/10);if(v(B)){var C=Math.floor(w/d)+p,j=Math.floor(m(c,d));try{a=q.getComponentMethod("calendars","getCal")(B).fromJD(C).formatDate("yyyy-mm-dd")}catch(D){a=r("G%Y-%m-%d")(new Date(w))}if("-"===a.charAt(0))for(;a.length<11;)a="-0"+a.substr(1);else for(;a.length<10;)a="0"+a;k=b<x?Math.floor(j/g):0,l=b<x?Math.floor(j%g/h):0,s=b<y?Math.floor(j%h/o):0,t=b<z?j%o*10+u:0}else i=new Date(w),a=r("%Y-%m-%d")(i),k=b<x?i.getUTCHours():0,l=b<x?i.getUTCMinutes():0,s=b<y?i.getUTCSeconds():0,t=b<z?10*i.getUTCMilliseconds()+u:0;return A(a,k,l,s,t)},a.ms2DateTimeLocal=function(b){if(!(b>=e+d&&b<=f-d))return n;var c=Math.floor(10*m(b+.05,1)),a=new Date(Math.round(b-c/10)),g=j("%Y-%m-%d")(a),h=a.getHours(),i=a.getMinutes(),k=a.getSeconds(),l=10*a.getUTCMilliseconds()+c;return A(g,h,i,k,l)},a.cleanDate=function(b,c,d){if(b===n)return c;if(a.isJSDate(b)||"number"==typeof b&&isFinite(b)){if(v(d))return l.error("JS Dates and milliseconds are incompatible with world calendars",b),c;if(!(b=a.ms2DateTimeLocal(+b))&& void 0!==c)return c}else if(!a.isDateTime(b,d))return l.error("unrecognized date",b),c;return b};var B=/%\d?f/g,C=/%h/g,D={"1":"1","2":"1","3":"2","4":"2"};function E(a,b,d,c){a=a.replace(B,function(a){var c=Math.min(+a.charAt(1)||6,6);return(b/1e3%1+2).toFixed(c).substr(2).replace(/0+$/,"")||"0"});var e=new Date(Math.floor(b+.05));if(a=a.replace(C,function(){return D[d("%q")(e)]}),v(c))try{a=q.getComponentMethod("calendars","worldCalFmt")(a,b,c)}catch(f){return"Invalid"}return d(a)(e)}var F=[59,59.9,59.99,59.999,59.9999];a.formatDate=function(f,a,e,i,b,c){if(b=v(b)&&b,!a)if("y"===e)a=c.year;else if("m"===e)a=c.month;else{if("d"!==e)return function(c,a){var e=m(c+.05,d),f=w(Math.floor(e/g),2)+":"+w(m(Math.floor(e/h),60),2);if("M"!==a){k(a)||(a=0);var b=(100+Math.min(m(c/o,60),F[a])).toFixed(a).substr(1);a>0&&(b=b.replace(/0+$/,"").replace(/[\.]$/,"")),f+=":"+b}return f}(f,e)+"\n"+E(c.dayMonthYear,f,i,b);a=c.dayMonth+"\n"+c.year}return E(a,f,i,b)};var G=3*d;a.incrementMonth=function(a,c,b){b=v(b)&&b;var e=m(a,d);if(a=Math.round(a-e),b)try{var i=Math.round(a/d)+p,f=q.getComponentMethod("calendars","getCal")(b),g=f.fromJD(i);return c%12?f.add(g,c,"m"):f.add(g,c/12,"y"),(g.toJD()-p)*d+e}catch(j){l.error("invalid ms "+a+" in calendar "+b)}var h=new Date(a+G);return h.setUTCMonth(h.getUTCMonth()+c)+e-G},a.findExactDates=function(g,j){for(var a,c,e=0,b=0,f=0,l=0,m=v(j)&&q.getComponentMethod("calendars","getCal")(j),h=0;h<g.length;h++){if(!k(c=g[h])){l++;continue}if(!(c%d))if(m)try{a=m.fromJD(c/d+p),1===a.day()?1===a.month()?e++:b++:f++}catch(n){}else 1===(a=new Date(c)).getUTCDate()?0===a.getUTCMonth()?e++:b++:f++}b+=e,f+=b;var i=g.length-l;return{exactYears:e/i,exactMonths:b/i,exactDays:f/i}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(a,b,g){"use strict";var h=a("@plotly/d3"),i=a("./loggers"),j=a("./matrix"),k=a("gl-mat4");function c(a){var b=a&&a.parentNode;b&&b.removeChild(a)}function d(f,c,d){var e="plotly.js-style-"+f,a=document.getElementById(e);a||((a=document.createElement("style")).setAttribute("id",e),a.appendChild(document.createTextNode("")),document.head.appendChild(a));var b=a.sheet;b.insertRule?b.insertRule(c+"{"+d+"}",0):b.addRule?b.addRule(c,d,0):i.warn("addStyleRule failed")}function e(c){var a=window.getComputedStyle(c,null),b=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform");return"none"===b?null:b.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(a){return+a})}function f(a){for(var b=[];l(a);)b.push(a),a=a.parentNode;return b}function l(a){return a&&(a instanceof Element||a instanceof HTMLElement)}b.exports={getGraphDiv:function(a){var b;if("string"==typeof a){if(null===(b=document.getElementById(a)))throw new Error("No DOM element with id '"+a+"' exists on the page.");return b}if(null==a)throw new Error("DOM element provided is null or undefined");return a},isPlotDiv:function(b){var a=h.select(b);return a.node() instanceof HTMLElement&&a.size()&&a.classed("js-plotly-plot")},removeElement:c,addStyleRule:function(a,b){d("global",a,b)},addRelatedStyleRule:d,deleteRelatedStyleRule:function(b){var a=document.getElementById("plotly.js-style-"+b);a&&c(a)},getFullTransformMatrix:function(a){var b=f(a),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return b.forEach(function(b){var a=e(b);if(a){var d=j.convertCssMatrix(a);c=k.multiply(c,c,d)}}),c},getElementTransformMatrix:e,getElementAndAncestors:f,equalDomRects:function(a,b){return a&&b&&a.x===b.x&&a.y===b.y&&a.top===b.top&&a.left===b.left&&a.right===b.right&&a.bottom===b.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(a,b,c){"use strict";var d=a("events").EventEmitter;b.exports={init:function(a){if(a._ev instanceof d)return a;var b=new d,c=new d;return a._ev=b,a._internalEv=c,a.on=b.on.bind(b),a.once=b.once.bind(b),a.removeListener=b.removeListener.bind(b),a.removeAllListeners=b.removeAllListeners.bind(b),a._internalOn=c.on.bind(c),a._internalOnce=c.once.bind(c),a._removeInternalListener=c.removeListener.bind(c),a._removeAllInternalListeners=c.removeAllListeners.bind(c),a.emit=function(d,e){"undefined"!=typeof jQuery&&jQuery(a).trigger(d,e),b.emit(d,e),c.emit(d,e)},a},triggerHandler:function(d,e,i){"undefined"!=typeof jQuery&&(c=jQuery(d).triggerHandler(e,i));var c,f,b,g=d._ev;if(!g)return c;var a=g._events[e];if(!a)return c;function h(a){return a.listener?(g.removeListener(e,a.listener),a.fired)?void 0:(a.fired=!0,a.listener.apply(g,[i])):a.apply(g,[i])}for(b=0,a=Array.isArray(a)?a:[a];b<a.length-1;b++)h(a[b]);return f=h(a[b]),void 0!==c?c:f},purge:function(a){return delete a._ev,delete a.on,delete a.once,delete a.removeListener,delete a.removeAllListeners,delete a.emit,delete a._ev,delete a._internalEv,delete a._internalOn,delete a._internalOnce,delete a._removeInternalListener,delete a._removeAllInternalListeners,a}}},{events:84}],505:[function(b,c,a){"use strict";var d=b("./is_plain_object.js"),e=Array.isArray;function f(h,l,m,n){var o,g,c,b,i,j,a=h[0],p=h.length;if(2===p&&e(a)&&e(h[1])&&0===a.length){if(function(c,d){var a,b;for(a=0;a<c.length;a++){if(null!==(b=c[a])&&"object"==typeof b)return!1;void 0!==b&&(d[a]=b)}return!0}(h[1],a))return a;a.splice(0,a.length)}for(var k=1;k<p;k++)for(g in o=h[k])c=a[g],b=o[g],n&&e(b)?a[g]=b:l&&b&&(d(b)||(i=e(b)))?(i?(i=!1,j=c&&e(c)?c:[]):j=c&&d(c)?c:{},a[g]=f([j,b],l,m,n)):(void 0!==b||m)&&(a[g]=b);return a}a.extendFlat=function(){return f(arguments,!1,!1,!1)},a.extendDeep=function(){return f(arguments,!0,!1,!1)},a.extendDeepAll=function(){return f(arguments,!0,!0,!1)},a.extendDeepNoArrays=function(){return f(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(b,a,c){"use strict";a.exports=function(c){for(var d={},e=[],f=0,a=0;a<c.length;a++){var b=c[a];1!==d[b]&&(d[b]=1,e[f++]=b)}return e}},{}],507:[function(b,a,c){"use strict";function d(a){return!0===a.visible}function e(b){var a=b[0].trace;return!0===a.visible&&0!==a._length}a.exports=function(b){for(var a,h=(a=b,Array.isArray(a)&&Array.isArray(a[0])&&a[0][0]&&a[0][0].trace)?e:d,f=[],c=0;c<b.length;c++){var g=b[c];h(g)&&f.push(g)}return f}},{}],508:[function(a,c,f){"use strict";var g=a("@plotly/d3"),d=a("country-regex"),h=a("@turf/area"),i=a("@turf/centroid"),j=a("@turf/bbox"),b=a("./identity"),k=a("./loggers"),l=a("./is_plain_object"),m=a("./nested_property"),n=a("./polygon"),o=Object.keys(d),p={"ISO-3":b,"USA-states":b,"country names":function(b){for(var a=0;a<o.length;a++){var c=o[a];if(new RegExp(d[c]).test(b.trim().toLowerCase()))return c}return k.log("Unrecognized country name: "+b+"."),!1}};function e(c){var a=c.geojson,d=window.PlotlyGeoAssets||{},b="string"==typeof a?d[a]:a;return l(b)?b:(k.error("Oops ... something went wrong when fetching "+a),!1)}c.exports={locationToFeature:function(g,d,e){if(!d||"string"!=typeof d)return!1;var c,b,a,f=p[g](d);if(f){if("USA-states"===g)for(a=0,c=[];a<e.length;a++)(b=e[a]).properties&&b.properties.gu&&"USA"===b.properties.gu&&c.push(b);else c=e;for(a=0;a<c.length;a++)if((b=c[a]).id===f)return b;k.log(["Location with id",f,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(f){var d,a,c,i,g=f.geometry,b=g.coordinates,e=f.id,h=[];function j(b){for(var a=0;a<b.length-1;a++)if(b[a][0]>0&&b[a+1][0]<0)return a;return null}switch(d="RUS"===e||"FJI"===e?function(a){var b;if(null===j(a))b=a;else for(i=0,b=new Array(a.length);i<a.length;i++)b[i]=[a[i][0]<0?a[i][0]+360:a[i][0],a[i][1]];h.push(n.tester(b))}:"ATA"===e?function(a){var d=j(a);if(null===d)return h.push(n.tester(a));var b=new Array(a.length+1),c=0;for(i=0;i<a.length;i++)i>d?b[c++]=[a[i][0]+360,a[i][1]]:i===d?(b[c++]=a[i],b[c++]=[a[i][0],-90]):b[c++]=a[i];var e=n.tester(b);e.pts.pop(),h.push(e)}:function(a){h.push(n.tester(a))},g.type){case"MultiPolygon":for(a=0;a<b.length;a++)for(c=0;c<b[a].length;c++)d(b[a][c]);break;case"Polygon":for(a=0;a<b.length;a++)d(b[a]);break}return h},getTraceGeojson:e,extractTraceFeature:function(f){var a,d=f[0].trace,b=e(d);if(!b)return!1;var g={},n=[];for(a=0;a<d._length;a++){var c=f[a];(c.loc||0===c.loc)&&(g[c.loc]=c)}function j(c){var e=m(c,d.featureidkey||"id").get(),a=g[e];if(a){var f=c.geometry;if("Polygon"===f.type||"MultiPolygon"===f.type){var b={type:"Feature",id:e,geometry:f,properties:{}};b.properties.ct=function(j){var a,b=j.geometry;if("MultiPolygon"===b.type)for(var d=b.coordinates,e=0,c=0;c<d.length;c++){var f={type:"Polygon",coordinates:d[c]},g=h.default(f);g>e&&(e=g,a=f)}else a=b;return i.default(a).geometry.coordinates}(b),a.fIn=c,a.fOut=b,n.push(b)}else k.log(["Location",a.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete g[e]}switch(b.type){case"FeatureCollection":var l=b.features;for(a=0;a<l.length;a++)j(l[a]);break;case"Feature":j(b);break;default:return k.warn(["Invalid GeoJSON type",(b.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var o in g)k.log(["Location *"+o+"*","does not have a matching feature with id-key","*"+d.featureidkey+"*."].join(" "));return n},fetchTraceGeoData:function(e){var b=window.PlotlyGeoAssets||{},c=[];function f(a){return new Promise(function(c,d){g.json(a,function(e,f){if(e){delete b[a];var g=404===e.status?'GeoJSON at URL "'+a+'" does not exist.':"Unexpected error while fetching from "+a;return d(new Error(g))}return b[a]=f,c(f)})})}function h(a){return new Promise(function(c,d){var e=0,f=setInterval(function(){return b[a]&&"pending"!==b[a]?(clearInterval(f),c(b[a])):e>100?(clearInterval(f),d("Unexpected error while fetching from "+a)):void e++},50)})}for(var d=0;d<e.length;d++){var a=e[d][0].trace.geojson;"string"==typeof a&&(b[a]?"pending"===b[a]&&c.push(h(a)):(b[a]="pending",c.push(f(a))))}return c},computeBbox:function(a){return j.default(a)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(b,c,a){"use strict";var d=b("../constants/numerical").BADNUM;a.calcTraceToLineCoords=function(b){for(var g=b[0].trace.connectgaps,c=[],a=[],e=0;e<b.length;e++){var f=b[e].lonlat;f[0]!==d?a.push(f):!g&&a.length>0&&(c.push(a),a=[])}return a.length>0&&c.push(a),c},a.makeLine=function(a){return 1===a.length?{type:"LineString",coordinates:a[0]}:{type:"MultiLineString",coordinates:a}},a.makePolygon=function(a){if(1===a.length)return{type:"Polygon",coordinates:a};for(var c=new Array(a.length),b=0;b<a.length;b++)c[b]=[a[b]];return{type:"MultiPolygon",coordinates:c}},a.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(b,d,a){"use strict";var e,f,g,h=b("./mod").mod;function c(b,c,n,o,g,h,p,q){var d=n-b,i=g-b,j=p-g,e=o-c,k=h-c,l=q-h,f=d*l-j*e;if(0===f)return null;var a=(i*l-j*k)/f,m=(i*e-d*k)/f;return m<0||m>1||a<0||a>1?null:{x:b+d*a,y:c+e*a}}function i(c,d,e,a,b){var f=a*c+b*d;if(f<0)return a*a+b*b;if(f>e){var g=a-c,h=b-d;return g*g+h*h}var i=a*d-b*c;return i*i/e}a.segmentsIntersect=c,a.segmentDistance=function(a,b,k,l,d,e,m,n){if(c(a,b,k,l,d,e,m,n))return 0;var f=k-a,g=l-b,h=m-d,j=n-e,o=f*f+g*g,p=h*h+j*j,q=Math.min(i(f,g,o,d-a,e-b),i(f,g,o,m-a,n-b),i(h,j,p,a-d,b-e),i(h,j,p,k-d,l-e));return Math.sqrt(q)},a.getTextLocation=function(b,j,a,c){if((b!==f||c!==g)&&(e={},f=b,g=c),e[a])return e[a];var d=b.getPointAtLength(h(a-c/2,j)),i=b.getPointAtLength(h(a+c/2,j)),m=Math.atan((i.y-d.y)/(i.x-d.x)),k=b.getPointAtLength(h(a,j)),n=(4*k.x+d.x+i.x)/6,o=(4*k.y+d.y+i.y)/6,l={x:n,y:o,theta:m};return e[a]=l,l},a.clearLocationCache=function(){f=null},a.getVisibleSegment=function(j,d,g){var h,i,k=d.left,l=d.right,m=d.top,n=d.bottom,a=0,f=j.getTotalLength(),b=f;function e(b){var a=j.getPointAtLength(b);0===b?h=a:b===f&&(i=a);var c=a.x<k?k-a.x:a.x>l?a.x-l:0,d=a.y<m?m-a.y:a.y>n?a.y-n:0;return Math.sqrt(c*c+d*d)}for(var c=e(a);c;){if((a+=c+g)>b)return;c=e(a)}for(c=e(b);c;){if(a>(b-=c+g))return;c=e(b)}return{min:a,max:b,len:b-a,total:f,isClosed:0===a&&b===f&&.1>Math.abs(h.x-i.x)&&.1>Math.abs(h.y-i.y)}},a.findPointOnPath=function(a,k,d,b){for(var c,e,f,g=(b=b||{}).pathLength||a.getTotalLength(),l=b.tolerance||.001,m=b.iterationLimit||30,n=a.getPointAtLength(0)[d]>a.getPointAtLength(g)[d]?-1:1,h=0,i=0,j=g;h<m;){if(c=(i+j)/2,Math.abs(f=(e=a.getPointAtLength(c))[d]-k)<l)return e;n*f>0?j=c:i=c,h++}return e}},{"./mod":522}],511:[function(a,b,e){"use strict";var f=a("fast-isnumeric"),g=a("tinycolor2"),c=a("color-normalize"),h=a("../components/colorscale"),d=a("../components/color/attributes").defaultLine,i=a("./array").isArrayOrTypedArray,j=c(d);function k(b,c){var a=b;return a[3]*=c,a}function l(a){if(f(a))return j;var b=c(a);return b.length?b:j}function m(a){return f(a)?a:1}b.exports={formatColor:function(b,d,s){var t,g,n,o,p,e=b.color,q=i(e),r=i(d),u=h.extractOpts(b),f=[];if(t=void 0!==u.colorscale?h.makeColorScaleFuncFromTrace(b):l,g=q?function(a,b){return void 0===a[b]?j:c(t(a[b]))}:l,n=r?function(a,b){return void 0===a[b]?1:m(a[b])}:m,q||r)for(var a=0;a<s;a++)o=g(e,a),p=n(d,a),f[a]=k(o,p);else f=k(c(e),d);return f},parseColorScale:function(c){var a=h.extractOpts(c),b=a.colorscale;return a.reversescale&&(b=h.flipScale(a.colorscale)),b.map(function(b){var c=b[0],d=g(b[1]),a=d.toRgb();return{index:c,rgb:[a.r,a.g,a.b,a.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(b,c,e){"use strict";var d=b("./identity");function a(a){return[a]}c.exports={keyFun:function(a){return a.key},repeat:a,descend:d,wrap:a,unwrap:function(a){return a[0]}}},{"./identity":513}],513:[function(b,a,c){"use strict";a.exports=function(a){return a}},{}],514:[function(b,a,c){"use strict";a.exports=function(b,a){if(!a)return b;var c=1/Math.abs(a),d=c>1?(c*b+c*a)/c:b+a,e=String(d).length;if(e>16){var g=String(a).length,h=String(b).length;if(e>=h+g){var f=parseFloat(d).toPrecision(12);-1===f.indexOf("e+")&&(d=+f)}}return d}},{}],515:[function(b,s,v){"use strict";var w=b("@plotly/d3"),x=b("d3-time-format").utcFormat,y=b("d3-format").format,z=b("fast-isnumeric"),p=b("../constants/numerical"),t=p.FP_SAFE,A=-t,B=p.BADNUM,a=s.exports={};a.adjustFormat=function(a){return!a||/^\d[.]\df/.test(a)||/[.]\d%/.test(a)?a:"0.f"===a?"~f":/^\d%/.test(a)?"~%":/^\ds/.test(a)?"~s":!/^[~,.0$]/.test(a)&&/[&fps]/.test(a)?"~"+a:a};var C={};a.warnBadFormat=function(c){var b=String(c);C[b]||(C[b]=1,a.warn('encountered bad format: "'+b+'"'))},a.noFormat=function(a){return String(a)},a.numberFormat=function(b){var c;try{c=y(a.adjustFormat(b))}catch(d){return a.warnBadFormat(b),a.noFormat}return c},a.nestedProperty=b("./nested_property"),a.keyedContainer=b("./keyed_container"),a.relativeAttr=b("./relative_attr"),a.isPlainObject=b("./is_plain_object"),a.toLogRange=b("./to_log_range"),a.relinkPrivateKeys=b("./relink_private");var i=b("./array");a.isTypedArray=i.isTypedArray,a.isArrayOrTypedArray=i.isArrayOrTypedArray,a.isArray1D=i.isArray1D,a.ensureArray=i.ensureArray,a.concat=i.concat,a.maxRowLength=i.maxRowLength,a.minRowLength=i.minRowLength;var q=b("./mod");a.mod=q.mod,a.modHalf=q.modHalf;var g=b("./coerce");a.valObjectMeta=g.valObjectMeta,a.coerce=g.coerce,a.coerce2=g.coerce2,a.coerceFont=g.coerceFont,a.coercePattern=g.coercePattern,a.coerceHoverinfo=g.coerceHoverinfo,a.coerceSelectionMarkerOpacity=g.coerceSelectionMarkerOpacity,a.validate=g.validate;var c=b("./dates");a.dateTime2ms=c.dateTime2ms,a.isDateTime=c.isDateTime,a.ms2DateTime=c.ms2DateTime,a.ms2DateTimeLocal=c.ms2DateTimeLocal,a.cleanDate=c.cleanDate,a.isJSDate=c.isJSDate,a.formatDate=c.formatDate,a.incrementMonth=c.incrementMonth,a.dateTick0=c.dateTick0,a.dfltRange=c.dfltRange,a.findExactDates=c.findExactDates,a.MIN_MS=c.MIN_MS,a.MAX_MS=c.MAX_MS;var j=b("./search");a.findBin=j.findBin,a.sorterAsc=j.sorterAsc,a.sorterDes=j.sorterDes,a.distinctVals=j.distinctVals,a.roundUp=j.roundUp,a.sort=j.sort,a.findIndexOfMin=j.findIndexOfMin,a.sortObjectKeys=b("./sort_object_keys");var h=b("./stats");a.aggNums=h.aggNums,a.len=h.len,a.mean=h.mean,a.median=h.median,a.midRange=h.midRange,a.variance=h.variance,a.stdev=h.stdev,a.interp=h.interp;var d=b("./matrix");a.init2dArray=d.init2dArray,a.transposeRagged=d.transposeRagged,a.dot=d.dot,a.translationMatrix=d.translationMatrix,a.rotationMatrix=d.rotationMatrix,a.rotationXYMatrix=d.rotationXYMatrix,a.apply3DTransform=d.apply3DTransform,a.apply2DTransform=d.apply2DTransform,a.apply2DTransform2=d.apply2DTransform2,a.convertCssMatrix=d.convertCssMatrix,a.inverseTransformMatrix=d.inverseTransformMatrix;var e=b("./angles");a.deg2rad=e.deg2rad,a.rad2deg=e.rad2deg,a.angleDelta=e.angleDelta,a.angleDist=e.angleDist,a.isFullCircle=e.isFullCircle,a.isAngleInsideSector=e.isAngleInsideSector,a.isPtInsideSector=e.isPtInsideSector,a.pathArc=e.pathArc,a.pathSector=e.pathSector,a.pathAnnulus=e.pathAnnulus;var k=b("./anchor_utils");a.isLeftAnchor=k.isLeftAnchor,a.isCenterAnchor=k.isCenterAnchor,a.isRightAnchor=k.isRightAnchor,a.isTopAnchor=k.isTopAnchor,a.isMiddleAnchor=k.isMiddleAnchor,a.isBottomAnchor=k.isBottomAnchor;var l=b("./geometry2d");a.segmentsIntersect=l.segmentsIntersect,a.segmentDistance=l.segmentDistance,a.getTextLocation=l.getTextLocation,a.clearLocationCache=l.clearLocationCache,a.getVisibleSegment=l.getVisibleSegment,a.findPointOnPath=l.findPointOnPath;var m=b("./extend");a.extendFlat=m.extendFlat,a.extendDeep=m.extendDeep,a.extendDeepAll=m.extendDeepAll,a.extendDeepNoArrays=m.extendDeepNoArrays;var n=b("./loggers");a.log=n.log,a.warn=n.warn,a.error=n.error;var u=b("./regex");a.counterRegex=u.counter;var o=b("./throttle");a.throttle=o.throttle,a.throttleDone=o.done,a.clearThrottle=o.clear;var f=b("./dom");function D(b){var c={};for(var d in b)for(var e=b[d],a=0;a<e.length;a++)c[e[a]]=+d;return c}a.getGraphDiv=f.getGraphDiv,a.isPlotDiv=f.isPlotDiv,a.removeElement=f.removeElement,a.addStyleRule=f.addStyleRule,a.addRelatedStyleRule=f.addRelatedStyleRule,a.deleteRelatedStyleRule=f.deleteRelatedStyleRule,a.getFullTransformMatrix=f.getFullTransformMatrix,a.getElementTransformMatrix=f.getElementTransformMatrix,a.getElementAndAncestors=f.getElementAndAncestors,a.equalDomRects=f.equalDomRects,a.clearResponsive=b("./clear_responsive"),a.preserveDrawingBuffer=b("./preserve_drawing_buffer"),a.makeTraceGroups=b("./make_trace_groups"),a._=b("./localize"),a.notifier=b("./notifier"),a.filterUnique=b("./filter_unique"),a.filterVisible=b("./filter_visible"),a.pushUnique=b("./push_unique"),a.increment=b("./increment"),a.cleanNumber=b("./clean_number"),a.ensureNumber=function(a){return z(a)?(a=Number(a))>t||a<A?B:a:B},a.isIndex=function(a,b){return(void 0===b||!(a>=b))&&z(a)&&a>=0&&a%1==0},a.noop=b("./noop"),a.identity=b("./identity"),a.repeat=function(d,b){for(var c=new Array(b),a=0;a<b;a++)c[a]=d;return c},a.swapAttrs=function(e,f,b,c){b||(b="x"),c||(c="y");for(var d=0;d<f.length;d++){var g=f[d],h=a.nestedProperty(e,g.replace("?",b)),i=a.nestedProperty(e,g.replace("?",c)),j=h.get();h.set(i.get()),i.set(j)}},a.raiseToTop=function(a){a.parentNode.appendChild(a)},a.cancelTransition=function(a){return a.transition().duration(0)},a.constrain=function(c,a,b){return a>b?Math.max(b,Math.min(a,c)):Math.max(a,Math.min(b,c))},a.bBoxIntersect=function(b,c,a){return a=a||0,b.left<=c.right+a&&c.left<=b.right+a&&b.top<=c.bottom+a&&c.top<=b.bottom+a},a.simpleMap=function(b,e,f,g,h){for(var c=b.length,d=new Array(c),a=0;a<c;a++)d[a]=e(b[a],f,g,h);return d},a.randstr=function m(g,d,b,i){if(b||(b=16),void 0===d&&(d=24),d<=0)return"0";var e,j,h,f=Math.log(Math.pow(2,d))/Math.log(b),c="";for(e=2;f===1/0;e*=2)f=Math.log(Math.pow(2,d/e))/Math.log(b)*e;var k=f-Math.floor(f);for(e=0;e<Math.floor(f);e++)c=(h=Math.floor(Math.random()*b).toString(b))+c;k&&(j=Math.pow(b,k),h=Math.floor(Math.random()*j).toString(b),c=h+c);var l=parseInt(c,b);return g&&g[c]||l!==1/0&&l>=Math.pow(2,d)?i>10?(a.warn("randstr failed uniqueness"),c):m(g,d,b,(i||0)+1):c},a.OptionControl=function(b,c){b||(b={}),c||(c="opt");var a={};return a.optionList=[],a._newoption=function(d){d[c]=b,a[d.name]=d,a.optionList.push(d)},a["_"+c]=b,a},a.smooth=function(g,c){if((c=Math.round(c)||0)<2)return g;var b,e,a,h,f=g.length,d=2*f,i=2*c-1,j=new Array(i),k=new Array(f);for(b=0;b<i;b++)j[b]=(1-Math.cos(Math.PI*(b+1)/c))/(2*c);for(b=0;b<f;b++){for(e=0,h=0;e<i;e++)(a=b+e+1-c)< -f?a-=d*Math.round(a/d):a>=d&&(a-=d*Math.floor(a/d)),a<0?a=-1-a:a>=f&&(a=d-1-a),h+=g[a]*j[e];k[b]=h}return k},a.syncOrAsync=function(c,d,e){var b;function f(){return a.syncOrAsync(c,d,e)}for(;c.length;)if((b=c.splice(0,1)[0](d))&&b.then)return b.then(f);return e&&e(d)},a.stripTrailingSlash=function(a){return"/"===a.substr(-1)?a.substr(0,a.length-1):a},a.noneOrAll=function(c,g,b){if(c){var a,d,e=!1,f=!0;for(a=0;a<b.length;a++)void 0!==(d=c[b[a]])&&null!==d?e=!0:f=!1;if(e&&!f)for(a=0;a<b.length;a++)c[b[a]]=g[b[a]]}},a.mergeArray=function(c,d,g,e){var h="function"==typeof e;if(a.isArrayOrTypedArray(c))for(var i=Math.min(c.length,d.length),b=0;b<i;b++){var f=c[b];d[b][g]=h?e(f):f}},a.mergeArrayCastPositive=function(b,c,d){return a.mergeArray(b,c,d,function(b){var a=+b;return isFinite(a)&&a>0?a:0})},a.fillArray=function(d,e,f,c){if(c=c||a.identity,a.isArrayOrTypedArray(d))for(var b=0;b<e.length;b++)e[b][f]=c(d[b])},a.castOption=function(e,b,f,d){d=d||a.identity;var c=a.nestedProperty(e,f).get();return a.isArrayOrTypedArray(c)?d(Array.isArray(b)&&a.isArrayOrTypedArray(c[b[0]])?c[b[0]][b[1]]:c[b]):c},a.extractOption=function(b,e,c,f){if(c in b)return b[c];var d=a.nestedProperty(e,f).get();if(!Array.isArray(d))return d},a.tagSelected=function(k,e,f){var c,g=e.selectedpoints,h=e._indexToPoints;function l(a){return void 0!==a&&a<k.length}h&&(c=D(h));for(var d=0;d<g.length;d++){var b=g[d];if(a.isIndex(b)||a.isArrayOrTypedArray(b)&&a.isIndex(b[0])&&a.isIndex(b[1])){var i=c?c[b]:b,j=f?f[i]:i;l(j)&&(k[j].selected=1)}}},a.selIndices2selPoints=function(d){var b=d.selectedpoints,e=d._indexToPoints;if(!e)return b;for(var i=D(e),f=[],c=0;c<b.length;c++){var g=b[c];if(a.isIndex(g)){var h=i[g];a.isIndex(h)&&f.push(h)}}return f},a.getTargetArray=function(d,e){var b=e.target;if("string"==typeof b&&b){var c=a.nestedProperty(d,b).get();return!!Array.isArray(c)&&c}return!!Array.isArray(b)&&b},a.minExtend=function(h,f){var e,b,c,d={};"object"!=typeof f&&(f={});var g=Object.keys(h);for(e=0;e<g.length;e++)c=h[b=g[e]],"_"!==b.charAt(0)&&"function"!=typeof c&&("module"===b?d[b]=c:Array.isArray(c)?"colorscale"===b?d[b]=c.slice():d[b]=c.slice(0,3):a.isTypedArray(c)?d[b]=c.subarray(0,3):c&&"object"==typeof c?d[b]=a.minExtend(h[b],f[b]):d[b]=c);for(e=0,g=Object.keys(f);e<g.length;e++)"object"==typeof(c=f[b=g[e]])&&b in d&&"object"==typeof d[b]||(d[b]=c);return d},a.titleCase=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},a.containsAny=function(c,b){for(var a=0;a<b.length;a++)if(-1!==c.indexOf(b[a]))return!0;return!1},a.isIE=function(){return void 0!==window.navigator.msSaveBlob};var E=/Version\/[\d\.]+.*Safari/;a.isSafari=function(){return E.test(window.navigator.userAgent)};var F=/iPad|iPhone|iPod/;a.isIOS=function(){return F.test(window.navigator.userAgent)};var G=/Firefox\/(\d+)\.\d+/;a.getFirefoxVersion=function(){var a=G.exec(window.navigator.userAgent);if(a&&2===a.length){var b=parseInt(a[1]);if(!isNaN(b))return b}return null},a.isD3Selection=function(a){return a instanceof w.selection},a.ensureSingle=function(c,d,a,e){var f=c.select(d+(a?"."+a:""));if(f.size())return f;var b=c.append(d);return a&&b.classed(a,!0),e&&b.call(e),b},a.ensureSingleById=function(a,b,c,d){var e=a.select(b+"#"+c);if(e.size())return e;var f=a.append(b).attr("id",c);return d&&f.call(d),f},a.objectFromPath=function(h,g){for(var a,c=h.split("."),i=a={},b=0;b<c.length;b++){var d=c[b],e=null,f=c[b].match(/(.*)\[([0-9]+)\]/);f?(d=f[1],e=f[2],a=a[d]=[],b===c.length-1?a[e]=g:a[e]={},a=a[e]):(b===c.length-1?a[d]=g:a[d]={},a=a[d])}return i};var H=/^([^\[\.]+)\.(.+)?/,I=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;a.expandObjectPaths=function(b){var e,c,d,f,g,h,i;if("object"==typeof b&&!Array.isArray(b))for(c in b)b.hasOwnProperty(c)&&((e=c.match(H))?(f=b[c],d=e[1],delete b[c],b[d]=a.extendDeepNoArrays(b[d]||{},a.objectFromPath(c,a.expandObjectPaths(f))[d])):(e=c.match(I))?(f=b[c],d=e[1],g=parseInt(e[2]),delete b[c],b[d]=b[d]||[],"."===e[3]?(i=e[4],h=b[d][g]=b[d][g]||{},a.extendDeepNoArrays(h,a.objectFromPath(i,a.expandObjectPaths(f)))):b[d][g]=a.expandObjectPaths(f)):b[c]=a.expandObjectPaths(b[c]));return b},a.numSeparate=function(b,c,e){if(e||(e=!1),"string"!=typeof c||0===c.length)throw new Error("Separator string required for formatting!");"number"==typeof b&&(b=String(b));var f=/(\d+)(\d{3})/,h=c.charAt(0),g=c.charAt(1),d=b.split("."),a=d[0],i=d.length>1?h+d[1]:"";if(g&&(d.length>1||a.length>4||e))for(;f.test(a);)a=a.replace(f,"$1"+g+"$2");return a+i},a.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var J=/^\w*$/;a.templateString=function(b,c){var d={};return b.replace(a.TEMPLATE_STRING_REGEX,function(f,b){var e;return J.test(b)?e=c[b]:(d[b]=d[b]||a.nestedProperty(c,b).get,e=d[b]()),a.isValidTextValue(e)?e:""})};var K={max:10,count:0,name:"hovertemplate"};a.hovertemplateString=function(){return N.apply(K,arguments)};var L={max:10,count:0,name:"texttemplate"};a.texttemplateString=function(){return N.apply(L,arguments)};var M=/^[:|\|]/;function N(c,b,d){var e=this,f=arguments;b||(b={});var g={};return c.replace(a.TEMPLATE_STRING_REGEX,function(q,i,j){var c,k,m,n,t="xother"===i||"yother"===i,o="_xother"===i||"_yother"===i,l="_xother_"===i||"_yother_"===i,p="xother_"===i||"yother_"===i,r=t||o||p||l,h=i;if((o||l)&&(h=h.substring(1)),(p||l)&&(h=h.substring(0,h.length-1)),r){if(void 0===(c=b[h]))return""}else for(m=3;m<f.length;m++)if(k=f[m]){if(k.hasOwnProperty(h)){c=k[h];break}if(!J.test(h)&&(c=a.nestedProperty(k,h).get(),c=g[h]||a.nestedProperty(k,h).get(),c&&(g[h]=c)),void 0!==c)break}if(void 0===c&&e)return e.count<e.max&&(a.warn("Variable '"+h+"' in "+e.name+" could not be found!"),c=q),e.count===e.max&&a.warn("Too many "+e.name+" warnings - additional warnings will be suppressed"),e.count++,q;if(j){if(":"===j[0]&&(c=(n=d?d.numberFormat:a.numberFormat)(j.replace(M,""))(c)),"|"===j[0]){n=d?d.timeFormat:x;var u=a.dateTime2ms(c);c=a.formatDate(u,j.replace(M,""),!1,n)}}else{var s=h+"Label";b.hasOwnProperty(s)&&(c=b[s])}return r&&(c="("+c+")",(o||l)&&(c=" "+c),(p||l)&&(c+=" ")),c})}a.subplotSort=function(f,g){for(var j=Math.min(f.length,g.length)+1,a=0,b=0,e=0;e<j;e++){var c=f.charCodeAt(e)||0,d=g.charCodeAt(e)||0,h=c>=48&&c<=57,i=d>=48&&d<=57;if(h&&(a=10*a+c-48),i&&(b=10*b+d-48),!h||!i){if(a!==b)return a-b;if(c!==d)return c-d}}return b-a};var O=2e9;a.seedPseudoRandom=function(){O=2e9},a.pseudoRandom=function(){var b=O;return 429496729>Math.abs((O=(69069*O+1)%4294967296)-b)?a.pseudoRandom():O/4294967296},a.fillText=function(b,c,g){var d=Array.isArray(g)?function(a){g.push(a)}:function(a){g.text=a},e=a.extractOption(b,c,"htx","hovertext");if(a.isValidTextValue(e))return d(e);var f=a.extractOption(b,c,"tx","text");if(a.isValidTextValue(f))return d(f)},a.isValidTextValue=function(a){return a||0===a},a.formatPercent=function(d,a){for(var b=(Math.round(100*d*Math.pow(10,a=a||0))*Math.pow(.1,a)).toFixed(a)+"%",c=0;c<a;c++)-1!==b.indexOf(".")&&(b=(b=b.replace("0%","%")).replace(".%","%"));return b},a.isHidden=function(b){var a=window.getComputedStyle(b).display;return!a||"none"===a},a.strTranslate=function(a,b){return a||b?"translate("+a+","+b+")":""},a.strRotate=function(a){return a?"rotate("+a+")":""},a.strScale=function(a){return 1!==a?"scale("+a+")":""},a.getTextTransform=function(b){var g=b.noCenter,d=b.textX,e=b.textY,h=b.targetX,i=b.targetY,j=b.anchorX||0,k=b.anchorY||0,f=b.rotate,c=b.scale;return c?c>1&&(c=1):c=0,a.strTranslate(h-c*(d+j),i-c*(e+k))+a.strScale(c)+(f?"rotate("+f+(g?"":" "+d+" "+e)+")":"")},a.setTransormAndDisplay=function(b,c){b.attr("transform",a.getTextTransform(c)),b.style("display",c.scale?null:"none")},a.ensureUniformFontSize=function(d,b){var c=a.extendFlat({},b);return c.size=Math.max(b.size,d._fullLayout.uniformtext.minsize||0),c},a.join2=function(a,b,d){var c=a.length;return c>1?a.slice(0,-1).join(b)+d+a[c-1]:a.join(b)},a.bigFont=function(a){return Math.round(1.2*a)};var r=a.getFirefoxVersion(),P=null!==r&&r<86;a.getPositionFromD3Event=function(){return P?[w.event.layerX,w.event.layerY]:[w.event.offsetX,w.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(b,a,c){"use strict";a.exports=function(a){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(a):"[object Object]"===Object.prototype.toString.call(a)&&Object.getPrototypeOf(a).hasOwnProperty("hasOwnProperty")}},{}],517:[function(a,b,c){"use strict";var d=a("./nested_property"),e=/^\w*$/;b.exports=function(h,b,c,f){c=c||"name",f=f||"value";var a,g,i,l={},j={};if(g=(b=b||"")&&b.length?(i=d(h,b)).get():h)for(a=0;a<g.length;a++)j[g[a][c]]=a;var m=e.test(f),k={set:function(h,e){var b=null===e?4:0;if(!g){if(!i||4===b)return;g=[],i.set(g)}var a=j[h];if(void 0===a){if(4===b)return;b|=3,a=g.length,j[h]=a}else e!==(m?g[a][f]:d(g[a],f).get())&&(b|=2);var n=g[a]=g[a]||{};return n[c]=h,m?n[f]=e:d(n,f).set(e),null!==e&&(b&=-5),l[a]=l[a]|b,k},get:function(b){if(g){var a=j[b];return void 0===a?void 0:m?g[a][f]:d(g[a],f).get()}},rename:function(b,d){var a=j[b];return void 0===a||(l[a]=1|l[a],j[d]=a,delete j[b],g[a][c]=d),k},remove:function(e){var b=j[e];if(void 0===b)return k;var h=g[b];if(Object.keys(h).length>2)return l[b]=2|l[b],k.set(e,null);if(m){for(a=b;a<g.length;a++)l[a]=3|l[a];for(a=b;a<g.length;a++)j[g[a][c]]--;g.splice(b,1),delete j[e]}else d(h,f).set(null),l[b]=6|l[b];return k},constructUpdate:function(){for(var e,a,h={},j=Object.keys(l),i=0;i<j.length;i++)e=b+"["+(a=j[i])+"]",g[a]?(1&l[a]&&(h[e+"."+c]=g[a][c]),2&l[a]&&(m?h[e+"."+f]=4&l[a]?null:g[a][f]:h[e+"."+f]=4&l[a]?null:d(g[a],f).get())):h[e]=null;return h}};return k}},{"./nested_property":523}],518:[function(a,b,c){"use strict";var d=a("../registry");b.exports=function(b,c){for(var a=b._context.locale,e=0;e<2;e++){for(var f=b._context.locales,g=0;g<2;g++){var h=(f[a]||{}).dictionary;if(h){var i=h[c];if(i)return i}f=d.localeRegistry}var j=a.split("-")[0];if(j===a)break;a=j}return c}},{"../registry":647}],519:[function(b,c,d){"use strict";var e=b("../plot_api/plot_config").dfltConfig,f=b("./notifier"),a=c.exports={};a.log=function(){var a;if(e.logging>1){var b=["LOG:"];for(a=0;a<arguments.length;a++)b.push(arguments[a]);console.trace.apply(console,b)}if(e.notifyOnLogging>1){var c=[];for(a=0;a<arguments.length;a++)c.push(arguments[a]);f(c.join("<br>"),"long")}},a.warn=function(){var a;if(e.logging>0){var b=["WARN:"];for(a=0;a<arguments.length;a++)b.push(arguments[a]);console.trace.apply(console,b)}if(e.notifyOnLogging>0){var c=[];for(a=0;a<arguments.length;a++)c.push(arguments[a]);f(c.join("<br>"),"stick")}},a.error=function(){var a;if(e.logging>0){var b=["ERROR:"];for(a=0;a<arguments.length;a++)b.push(arguments[a]);console.error.apply(console,b)}if(e.notifyOnLogging>0){var c=[];for(a=0;a<arguments.length;a++)c.push(arguments[a]);f(c.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(a,b,c){"use strict";var d=a("@plotly/d3");b.exports=function(b,e,c){var a=b.selectAll("g."+c.replace(/\s/g,".")).data(e,function(a){return a[0].trace.uid});a.exit().remove(),a.enter().append("g").attr("class",c),a.order();var f=b.classed("rangeplot")?"nodeRangePlot3":"node3";return a.each(function(a){a[0][f]=d.select(this)}),a}},{"@plotly/d3":58}],521:[function(b,c,a){"use strict";var d=b("gl-mat4");a.init2dArray=function(b,d){for(var c=new Array(b),a=0;a<b;a++)c[a]=new Array(d);return c},a.transposeRagged=function(d){var a,b,c=0,e=d.length;for(a=0;a<e;a++)c=Math.max(c,d[a].length);var f=new Array(c);for(a=0;a<c;a++)for(b=0,f[a]=new Array(e);b<e;b++)f[a][b]=d[b][a];return f},a.dot=function(c,e){if(!(c.length&&e.length)||c.length!==e.length)return null;var d,b,f=c.length;if(c[0].length)for(b=0,d=new Array(f);b<f;b++)d[b]=a.dot(c[b],e);else if(e[0].length){var g=a.transposeRagged(e);for(b=0,d=new Array(g.length);b<g.length;b++)d[b]=a.dot(c,g[b])}else for(b=0,d=0;b<f;b++)d+=c[b]*e[b];return d},a.translationMatrix=function(a,b){return[[1,0,a],[0,1,b],[0,0,1]]},a.rotationMatrix=function(b){var a=b*Math.PI/180;return[[Math.cos(a),-Math.sin(a),0],[Math.sin(a),Math.cos(a),0],[0,0,1]]},a.rotationXYMatrix=function(d,b,c){return a.dot(a.dot(a.translationMatrix(b,c),a.rotationMatrix(d)),a.translationMatrix(-b,-c))},a.apply3DTransform=function(b){return function(){var c=arguments,d=1===arguments.length?c[0]:[c[0],c[1],c[2]||0];return a.dot(b,[d[0],d[1],d[2],1]).slice(0,3)}},a.apply2DTransform=function(b){return function(){var c=arguments;3===c.length&&(c=c[0]);var d=1===arguments.length?c[0]:[c[0],c[1]];return a.dot(b,[d[0],d[1],1]).slice(0,2)}},a.apply2DTransform2=function(b){var c=a.apply2DTransform(b);return function(a){return c(a.slice(0,2)).concat(c(a.slice(2,4)))}},a.convertCssMatrix=function(a){if(a){var b=a.length;if(16===b)return a;if(6===b)return[a[0],a[1],0,0,a[2],a[3],0,0,0,0,1,0,a[4],a[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},a.inverseTransformMatrix=function(b){var a=[];return d.invert(a,b),[[a[0],a[1],a[2],a[3]],[a[4],a[5],a[6],a[7]],[a[8],a[9],a[10],a[11]],[a[12],a[13],a[14],a[15]]]}},{"gl-mat4":210}],522:[function(b,a,c){"use strict";a.exports={mod:function(c,b){var a=c%b;return a<0?a+b:a},modHalf:function(a,b){return Math.abs(a)>b/2?a-Math.round(a/b)*b:a}}},{}],523:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("./array").isArrayOrTypedArray;function f(a,b){return function(){var i,j,d,g,h,c=a;for(g=0;g<b.length-1;g++){if(-1===(i=b[g])){for(h=0,j=!0,d=[];h<c.length;h++)d[h]=f(c[h],b.slice(g+1))(),d[h]!==d[0]&&(j=!1);return j?d[0]:d}if("number"==typeof i&&!e(c))return;if("object"!=typeof(c=c[i])||null===c)return}if("object"==typeof c&&null!==c&&null!==(d=c[b[g]]))return d}}b.exports=function(e,a){if(d(a))a=String(a);else if("string"!=typeof a||"[-1]"===a.substr(a.length-4))throw"bad property string";for(var g,j,h,c=0,b=a.split(".");c<b.length;){if(g=String(b[c]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(g[1])b[c]=g[1];else if(0===c)b.splice(0,1);else throw"bad property string";for(h=0,j=g[2].substr(1,g[2].length-2).split("][");h<j.length;h++)c++,b.splice(c,0,Number(j[h]))}c++}return"object"!=typeof e?m(e,a,b):{set:i(e,b,a),get:f(e,b),astr:a,parts:b,obj:e}};var g=/(^|\.)args\[/;function h(a,b){return void 0===a||null===a&&!b.match(g)}function i(a,b,c){return function(m){var g,f,d=a,i="",o=[[a,i]],n=h(m,c);for(f=0;f<b.length-1;f++){if("number"==typeof(g=b[f])&&!e(d))throw"array index but container is not an array";if(-1===g){if(!(n=!k(d,b.slice(f+1),m,c)))return;break}if(!l(d,g,b[f+1],n))break;if("object"!=typeof(d=d[g])||null===d)throw"container is not an object";i=j(i,g),o.push([d,i])}if(n){if(f===b.length-1&&(delete d[b[f]],Array.isArray(d)&& +b[f]==d.length-1))for(;d.length&& void 0===d[d.length-1];)d.pop()}else d[b[f]]=m}}function j(c,a){var b=a;return d(a)?b="["+a+"]":c&&(b="."+a),c+b}function k(c,j,b,d){var a,k=e(b),m=!0,n=b,f=d.replace("-1",0),g=!k&&h(b,f),o=j[0];for(a=0;a<c.length;a++)f=d.replace("-1",a),k&&(g=h(n=b[a%b.length],f)),g&&(m=!1),l(c,a,o,g)&&i(c[a],j,d.replace("-1",a))(n);return m}function l(a,b,c,d){if(void 0===a[b]){if(d)return!1;"number"==typeof c?a[b]=[]:a[b]={}}return!0}function m(a,b,c){return{set:function(){throw"bad container"},get:function(){},astr:b,parts:c,obj:a}}},{"./array":497,"fast-isnumeric":190}],524:[function(b,a,c){"use strict";a.exports=function(){}},{}],525:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("fast-isnumeric"),f=[];b.exports=function(b,a){if(-1===f.indexOf(b)){f.push(b);var c=1e3;e(a)?c=a:"long"===a&&(c=3e3);var g=d.select("body").selectAll(".plotly-notifier").data([0]);g.enter().append("div").classed("plotly-notifier",!0),g.selectAll(".notifier-note").data(f).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(i){var b=d.select(this);b.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){b.transition().call(h)});for(var f=b.append("p"),g=i.split(/<br\s*\/?>/g),e=0;e<g.length;e++)e&&f.append("br"),f.append("span").text(g[e]);"stick"===a?b.transition().duration(350).style("opacity",1):b.transition().duration(700).style("opacity",1).transition().delay(c).call(h)})}function h(a){a.duration(700).style("opacity",0).each("end",function(b){var a=f.indexOf(b);-1!==a&&f.splice(a,1),d.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(a,b,c){"use strict";var d=a("./setcursor"),e="data-savedcursor";b.exports=function(a,g){var b=a.attr(e);if(g){if(!b){for(var h=(a.attr("class")||"").split(" "),c=0;c<h.length;c++){var f=h[c];0===f.indexOf("cursor-")&&a.attr(e,f.substr(7)).classed(f,!1)}a.attr(e)||a.attr(e,"!!")}d(a,g)}else b&&(a.attr(e,null),"!!"===b?d(a):d(a,b))}},{"./setcursor":536}],527:[function(b,c,d){"use strict";var e=b("./matrix").dot,f=b("../constants/numerical").BADNUM,a=c.exports={};a.tester=function(l){var b,i,a=l.slice(),c=a[0][0],g=c,d=a[0][1],h=d;for((a[a.length-1][0]!==a[0][0]||a[a.length-1][1]!==a[0][1])&&a.push(a[0]),b=1;b<a.length;b++)c=Math.min(c,a[b][0]),g=Math.max(g,a[b][0]),d=Math.min(d,a[b][1]),h=Math.max(h,a[b][1]);var e=!1;5===a.length&&(a[0][0]===a[1][0]?a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[1][1]===a[2][1]&&(e=!0,i=function(b){return b[0]===a[0][0]}):a[0][1]===a[1][1]&&a[2][1]===a[3][1]&&a[0][0]===a[3][0]&&a[1][0]===a[2][0]&&(e=!0,i=function(b){return b[1]===a[0][1]}));var j=!0,k=a[0];for(b=1;b<a.length;b++)if(k[0]!==a[b][0]||k[1]!==a[b][1]){j=!1;break}return{xmin:c,xmax:g,ymin:d,ymax:h,pts:a,contains:e?function(a,j){var b=a[0],e=a[1];return b!==f&&!(b<c)&&!(b>g)&&e!==f&&!(e<d)&&!(e>h)&&!(j&&i(a))}:function(q,r){var i,j,l,n,o,b=q[0],e=q[1];if(b===f||b<c||b>g||e===f||e<d||e>h)return!1;var s=a.length,k=a[0][0],m=a[0][1],p=0;for(i=1;i<s;i++)if(j=k,l=m,k=a[i][0],m=a[i][1],n=Math.min(j,k),!(b<n||b>Math.max(j,k)||e>Math.max(l,m)))if(e<Math.min(l,m))b!==n&&p++;else{if(o=k===j?e:l+(b-j)*(m-l)/(k-j),e===o){if(1===i&&r)return!1;return!0}e<=o&&b!==n&&p++}return p%2==1},isRect:e,degenerate:j}},a.isSegmentBent=function(a,g,f,l){var b,h,i,d=a[g],c=[a[f][0]-d[0],a[f][1]-d[1]],j=e(c,c),k=Math.sqrt(j),m=[-c[1]/k,c[0]/k];for(b=g+1;b<f;b++)if((i=e(h=[a[b][0]-d[0],a[b][1]-d[1]],c))<0||i>j||Math.abs(e(h,m))>l)return!0;return!1},a.filter=function(b,e){var d=[b[0]],f=0,g=0;function c(i){b.push(i);var j=d.length,h=f;d.splice(g+1);for(var c=h+1;c<b.length;c++)(c===b.length-1||a.isSegmentBent(b,h,c+1,e))&&(d.push(b[c]),d.length<j-2&&(f=c,g=d.length-1),h=c)}return b.length>1&&c(b.pop()),{addPt:c,raw:b,filtered:d}}},{"../constants/numerical":491,"./matrix":521}],528:[function(a,b,d){(function(c){(function(){"use strict";var d=a("./show_no_webgl_msg"),e=a("regl");b.exports=function(f,g,h){var a=f._fullLayout,b=!0;return a._glcanvas.each(function(d){if(d.regl){d.regl.preloadCachedCode(h);return}if(!d.pick||a._has("parcoords")){try{d.regl=e({canvas:this,attributes:{antialias:!d.pick,preserveDrawingBuffer:!0},pixelRatio:f._context.plotGlPixelRatio||c.devicePixelRatio,extensions:g||[],cachedCode:h||{}})}catch(i){b=!1}d.regl||(b=!1),b&&this.addEventListener("webglcontextlost",function(a){f&&f.emit&&f.emit("plotly_webglcontextlost",{event:a,layer:d.key})},!1)}}),b||d({container:a._glcontainer.node()}),b}}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("is-mobile");b.exports=function(c){if("string"!=typeof(h=c&&c.hasOwnProperty("userAgent")?c.userAgent:("undefined"!=typeof navigator&&(k=navigator.userAgent),k&&k.headers&&"string"==typeof k.headers["user-agent"]&&(k=k.headers["user-agent"]),k)))return!0;var k,h,i=e({ua:{headers:{"user-agent":h}},tablet:!0,featureDetect:!1});if(!i){for(var f=h.split(" "),a=1;a<f.length;a++)if(-1!==f[a].indexOf("Safari"))for(var g=a-1;g> -1;g--){var j=f[g];if("Version/"===j.substr(0,8)){var b=j.substr(8).split(".")[0];if(d(b)&&(b=+b),b>=13)return!0}}}return i}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(b,a,c){"use strict";a.exports=function(a,b){if(b instanceof RegExp){for(var d=b.toString(),c=0;c<a.length;c++)if(a[c]instanceof RegExp&&a[c].toString()===d)return a;a.push(b)}else(b||0===b)&& -1===a.indexOf(b)&&a.push(b);return a}},{}],531:[function(b,c,d){"use strict";var e=b("../lib"),f=b("../plot_api/plot_config").dfltConfig,a={};a.add=function(a,d,e,g,h){var b,c;if(a.undoQueue=a.undoQueue||{index:0,queue:[],sequence:!1},c=a.undoQueue.index,a.autoplay){a.undoQueue.inSequence||(a.autoplay=!1);return}!a.undoQueue.sequence||a.undoQueue.beginSequence?(b={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},a.undoQueue.queue.splice(c,a.undoQueue.queue.length-c,b),a.undoQueue.index+=1):b=a.undoQueue.queue[c-1],a.undoQueue.beginSequence=!1,b&&(b.undo.calls.unshift(d),b.undo.args.unshift(e),b.redo.calls.push(g),b.redo.args.push(h)),a.undoQueue.queue.length>f.queueLength&&(a.undoQueue.queue.shift(),a.undoQueue.index--)},a.startSequence=function(a){a.undoQueue=a.undoQueue||{index:0,queue:[],sequence:!1},a.undoQueue.sequence=!0,a.undoQueue.beginSequence=!0},a.stopSequence=function(a){a.undoQueue=a.undoQueue||{index:0,queue:[],sequence:!1},a.undoQueue.sequence=!1,a.undoQueue.beginSequence=!1},a.undo=function(b){var d,c;if(!(void 0===b.undoQueue||isNaN(b.undoQueue.index))&&!(b.undoQueue.index<=0)){for(b.undoQueue.index--,d=b.undoQueue.queue[b.undoQueue.index],b.undoQueue.inSequence=!0,c=0;c<d.undo.calls.length;c++)a.plotDo(b,d.undo.calls[c],d.undo.args[c]);b.undoQueue.inSequence=!1,b.autoplay=!1}},a.redo=function(b){var d,c;if(!(void 0===b.undoQueue||isNaN(b.undoQueue.index))&&!(b.undoQueue.index>=b.undoQueue.queue.length)){for(c=0,d=b.undoQueue.queue[b.undoQueue.index],b.undoQueue.inSequence=!0;c<d.redo.calls.length;c++)a.plotDo(b,d.redo.calls[c],d.redo.args[c]);b.undoQueue.inSequence=!1,b.autoplay=!1,b.undoQueue.index++}},a.plotDo=function(b,c,a){b.autoplay=!0,a=function(f,d){for(var a,c=[],b=0;b<d.length;b++)(a=d[b])===f?c[b]=a:"object"==typeof a?c[b]=Array.isArray(a)?e.extendDeep([],a):e.extendDeepAll({},a):c[b]=a;return c}(b,a),c.apply(null,a)},c.exports=a},{"../lib":515,"../plot_api/plot_config":553}],532:[function(b,c,a){"use strict";a.counter=function(a,d,e,f){var b=(d||"")+(e?"":"$"),c=!1===f?"":"^";return new RegExp("xy"===a?c+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+b:c+a+"([2-9]|[1-9][0-9]+)?"+b)}},{}],533:[function(b,a,c){"use strict";var d=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,e=/^[^\.\[\]]+$/;a.exports=function(a,b){for(;b;){var c=a.match(d);if(c)a=c[1];else if(a.match(e))a="";else throw new Error("bad relativeAttr call:"+[a,b]);if("^"===b.charAt(0))b=b.slice(1);else break}return a&&"["!==b.charAt(0)?a+"."+b:a+b}},{}],534:[function(a,b,c){"use strict";var d=a("./array").isArrayOrTypedArray,e=a("./is_plain_object");b.exports=function h(g,i){for(var c in i){var a=i[c],b=g[c];if(b!==a)if("_"===c.charAt(0)||"function"==typeof a){if(c in g)continue;g[c]=a}else if(d(a)&&d(b)&&e(a[0])){if("customdata"===c||"ids"===c)continue;for(var j=Math.min(a.length,b.length),f=0;f<j;f++)b[f]!==a[f]&&e(a[f])&&e(b[f])&&h(b[f],a[f])}else e(a)&&e(b)&&(h(b,a),Object.keys(b).length||delete g[c])}}},{"./array":497,"./is_plain_object":516}],535:[function(b,c,a){"use strict";var d=b("fast-isnumeric"),e=b("./loggers"),f=b("./identity"),g=b("../constants/numerical").BADNUM;function h(a,b){return a<b}function i(a,b){return a<=b}function j(a,b){return a>b}function k(a,b){return a>=b}a.findBin=function(c,a,f){if(d(a.start))return f?Math.ceil((c-a.start)/a.size-1e-9)-1:Math.floor((c-a.start)/a.size+1e-9);var l,n,g=0,b=a.length,o=0,m=b>1?(a[b-1]-a[0])/(b-1):1;for(n=m>=0?f?h:i:f?k:j,c+=1e-9*m*(f?-1:1)*(m>=0?1:-1);g<b&&o++ <100;)n(a[l=Math.floor((g+b)/2)],c)?g=l+1:b=l;return o>90&&e.log("Long binary search..."),g-1},a.sorterAsc=function(a,b){return a-b},a.sorterDes=function(a,b){return b-a},a.distinctVals=function(k){var b,e,c=k.slice();for(c.sort(a.sorterAsc),b=c.length-1;b> -1&&c[b]===g;b--);for(var f=c[b]-c[0]||1,l=f/(b||1)/1e4,h=[],i=0;i<=b;i++){var d=c[i],j=d-e;void 0===e?(h.push(d),e=d):j>l&&(f=Math.min(f,j),h.push(d),e=d)}return{vals:h,minDiff:f}},a.roundUp=function(f,b,c){for(var d,a=0,e=b.length-1,g=0,h=c?0:1,i=c?1:0,j=c?Math.ceil:Math.floor;a<e&&g++ <100;)b[d=j((a+e)/2)]<=f?a=d+h:e=d-i;return b[a]},a.sort=function(a,d){for(var e=0,c=0,b=1;b<a.length;b++){var f=d(a[b],a[b-1]);if(f<0?e=1:f>0&&(c=1),e&&c)return a.sort(d)}return c?a:a.reverse()},a.findIndexOfMin=function(c,b){b=b||f;for(var d,e=1/0,a=0;a<c.length;a++){var g=b(c[a]);g<e&&(e=g,d=a)}return d}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(b,a,c){"use strict";a.exports=function(a,b){(a.attr("class")||"").split(" ").forEach(function(b){0===b.indexOf("cursor-")&&a.classed(b,!1)}),b&&a.classed("cursor-"+b,!0)}},{}],537:[function(a,b,c){"use strict";var d=a("../components/color"),e=function(){};b.exports=function(c){for(var f in c)"function"==typeof c[f]&&(c[f]=e);c.destroy=function(){c.container.parentNode.removeChild(c.container)};var a=document.createElement("div");a.className="no-webgl",a.style.cursor="pointer",a.style.fontSize="24px",a.style.color=d.defaults[0],a.style.position="absolute",a.style.left=a.style.top="0px",a.style.width=a.style.height="100%",a.style["background-color"]=d.lightLine,a.style["z-index"]=30;var b=document.createElement("p");return b.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",b.style.position="relative",b.style.top="50%",b.style.left="50%",b.style.height="30%",b.style.width="50%",b.style.margin="-15% 0 0 -25%",a.appendChild(b),c.container.appendChild(a),c.container.style.background="#FFFFFF",c.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(b,a,c){"use strict";a.exports=function(a){return Object.keys(a).sort()}},{}],539:[function(b,c,a){"use strict";var d=b("fast-isnumeric"),e=b("./array").isArrayOrTypedArray;a.aggNums=function(i,c,f,g){var b,h;if((!g||g>f.length)&&(g=f.length),d(c)||(c=!1),e(f[0])){for(b=0,h=new Array(g);b<g;b++)h[b]=a.aggNums(i,c,f[b]);f=h}for(b=0;b<g;b++)d(c)?d(f[b])&&(c=i(+c,+f[b])):c=f[b];return c},a.len=function(b){return a.aggNums(function(a){return a+1},0,b)},a.mean=function(c,b){return b||(b=a.len(c)),a.aggNums(function(a,b){return a+b},0,c)/b},a.midRange=function(b){if(void 0!==b&&0!==b.length)return(a.aggNums(Math.max,null,b)+a.aggNums(Math.min,null,b))/2},a.variance=function(c,b,e){return b||(b=a.len(c)),d(e)||(e=a.mean(c,b)),a.aggNums(function(a,b){return a+Math.pow(b-e,2)},0,c)/b},a.stdev=function(b,c,d){return Math.sqrt(a.variance(b,c,d))},a.median=function(b){var c=b.slice().sort();return a.interp(c,.5)},a.interp=function(a,b){if(!d(b))throw"n should be a finite number";if((b=b*a.length-.5)<0)return a[0];if(b>a.length-1)return a[a.length-1];var c=b%1;return c*a[Math.ceil(b)]+(1-c)*a[Math.floor(b)]}},{"./array":497,"fast-isnumeric":190}],540:[function(a,b,c){"use strict";var d=a("color-normalize");b.exports=function(a){return a?d(a):[0,0,0,1]}},{"color-normalize":89}],541:[function(b,e,a){"use strict";var f=b("@plotly/d3"),c=b("../lib"),g=c.strTranslate,h=b("../constants/xmlns_namespaces"),i=b("../constants/alignment").LINE_SPACING,j=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;a.convertToTspans=function(b,c,k){var h=b.text(),i=!b.attr("data-notex")&&c&&c._context.typesetMath&&"undefined"!=typeof MathJax&&h.match(j),d=f.select(b.node().parentNode);if(!d.empty()){var e=b.attr("class")?b.attr("class").split(" ")[0]:"text";return e+="-math",d.selectAll("svg."+e).remove(),d.selectAll("g."+e+"-group").remove(),b.style("display",null).attr({"data-unformatted":h,"data-math":"N"}),i?(c&&c._promises||[]).push(new Promise(function(f){b.style("display","none");var a=parseInt(b.node().style.fontSize,10),c={fontSize:a};n(i[2],c,function(s,r,t){d.selectAll("svg."+e).remove(),d.selectAll("g."+e+"-group").remove();var c=s&&s.select("svg");if(!c||!c.node()){l(),f();return}var m=d.append("g").classed(e+"-group",!0).attr({"pointer-events":"none","data-unformatted":h,"data-math":"Y"});m.node().appendChild(c.node()),r&&r.node()&&c.node().insertBefore(r.node().cloneNode(!0),c.node().firstChild);var y=t.width,u=t.height;c.attr({"class":e,height:u,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var v=b.node().style.fill||"black",w=c.select("g");w.attr({fill:v,stroke:v});var n=w.node().getBoundingClientRect(),o=n.width,j=n.height;(o>y||j>u)&&(c.style("overflow","hidden"),o=(n=c.node().getBoundingClientRect()).width,j=n.height);var p=+b.attr("x"),i=+b.attr("y"),z=a||b.node().getBoundingClientRect().height,q=-z/4;if("y"===e[0])m.attr({transform:"rotate("+[-90,p,i]+")"+g(-o/2,q-j/2)});else if("l"===e[0])i=q-j/2;else if("a"===e[0]&&0!==e.indexOf("atitle"))p=0,i=q;else{var x=b.attr("text-anchor");p-=o*("middle"===x?.5:"end"===x?1:0),i=i+q-j/2}c.attr({x:p,y:i}),k&&k.call(b,m),f(m)})})):l(),b}function l(){d.empty()||(e=b.attr("class")+"-math",d.select("svg."+e).remove()),b.text("").style("white-space","pre"),F(b.node(),h)&&b.style("pointer-events","all"),a.positionText(b),k&&k.call(b)}};var k=/(<|&lt;|&#60;)/g,l=/(>|&gt;|&#62;)/g,m=[["$","$"],["\\(","\\)"]];function n(h,i,j){var b,d,n,o,a=parseInt((MathJax.version||"").split(".")[0]);if(2!==a&&3!==a){c.warn("No MathJax version:",MathJax.version);return}var e=function(){var d="math-output-"+c.randstr({},64),b=(o=f.select("body").append("div").attr({id:d}).style({visibility:"hidden",position:"absolute","font-size":i.fontSize+"px"}).text(h.replace(k,"\\lt ").replace(l,"\\gt "))).node();return 2===a?MathJax.Hub.Typeset(b):MathJax.typeset([b])},g=function(){var b=o.select(2===a?".MathJax_SVG":".MathJax"),d=!b.empty()&&o.select("svg").node();if(d){var e,g=d.getBoundingClientRect();e=2===a?f.select("body").select("#MathJax_SVG_glyphs"):b.select("defs"),j(b,e,g)}else c.log("There was an error in the tex syntax.",h),j();o.remove()},p=function(){"svg"!==b&&(MathJax.config.startup.output=b)},q=function(){MathJax.config=d};2===a?MathJax.Hub.Queue(function(){return d=c.extendDeepAll({},MathJax.Hub.config),n=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:m},displayAlign:"left"})},function(){if("SVG"!==(b=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")},e,g,function(){if("SVG"!==b)return MathJax.Hub.setRenderer(b)},function(){return void 0!==n&&(MathJax.Hub.processSectionDelay=n),MathJax.Hub.Config(d)}):3===a&&(d=c.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=m,"svg"!==(b=MathJax.config.startup.output)&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){e(),g(),p(),q()}))}var o={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},p={sub:"0.3em",sup:"-0.6em"},q={sub:"-0.21em",sup:"0.42em"},r=["http:","https:","mailto:","",void 0,":"],s=a.NEWLINES=/(\r\n?|\n)/g,t=/(<[^<>]*>)/,u=/<(\/?)([^ >]*)(\s+(.*))?>/i,v=/<br(\s+.*)?>/i;a.BR_TAG_ALL=/<br(\s+.*)?>/gi;var w=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,x=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,y=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,z=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function A(b,e){if(!b)return null;var a=b.match(e),c=a&&(a[3]||a[4]);return c&&d(c)}var B=/(^|;)\s*color:/;a.plainText=function(m,a){for(var d=void 0!==(a=a||{}).len&& -1!==a.len?a.len:1/0,n=void 0!==a.allowedTags?a.allowedTags:["br"],k=m.split(t),b=[],e="",f=0,g=0;g<k.length;g++){var c=k[g],l=c.match(u),h=l&&l[2].toLowerCase();if(h)-1!==n.indexOf(h)&&(b.push(c),e=h);else{var i=c.length;if(f+i<d)b.push(c),f+=i;else if(f<d){var j=d-f;e&&("br"!==e||j<=3||i<=3)&&b.pop(),d>3?b.push(c.substr(0,j-3)+"..."):b.push(c.substr(0,j));break}e=""}}return b.join("")};var C={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xa0",times:"\xd7",plusmn:"\xb1",deg:"\xb0"},D=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function d(a){return a.replace(D,function(b,a){return("#"===a.charAt(0)?E("x"===a.charAt(1)?parseInt(a.substr(2),16):parseInt(a.substr(1),10)):C[a])||b})}function E(a){if(!(a>1114111)){var b=String.fromCodePoint;if(b)return b(a);var c=String.fromCharCode;return a<=65535?c(a):c((a>>10)+55232,a%1024+56320)}}function F(n,j){j=j.replace(s," ");var r,C=!1,J=[],N=-1;function D(){N++;var a=document.createElementNS(h.svg,"tspan");f.select(a).attr({class:"line",dy:N*i+"em"}),n.appendChild(a),r=a;var b=J;if(J=[{node:a}],b.length>1)for(var c=1;c<b.length;c++)K(b[c])}function K(a){var e,b=a.type,c={};if("a"===b){e="a";var g=a.target,j=a.href,k=a.popup;j&&(c={"xlink:xlink:show":"_blank"===g||"_"!==g.charAt(0)?"new":"replace",target:g,"xlink:xlink:href":j},k&&(c.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+k+'");return false;'))}else e="tspan";a.style&&(c.style=a.style);var d=document.createElementNS(h.svg,e);if("sup"===b||"sub"===b){L(r,"\u200B"),r.appendChild(d);var i=document.createElementNS(h.svg,"tspan");L(i,"\u200B"),f.select(i).attr("dy",q[b]),c.dy=p[b],r.appendChild(d),r.appendChild(i)}else r.appendChild(d);f.select(d).attr(c),r=a.node=d,J.push(a)}function L(a,b){a.appendChild(document.createTextNode(b))}function M(a){if(1===J.length){c.log("Ignoring unexpected end tag </"+a+">.",j);return}var b=J.pop();a!==b.type&&c.log("Start tag <"+b.type+"> doesnt match end tag <"+a+">. Pretending it did match.",j),r=J[J.length-1].node}v.test(j)?D():(r=n,J=[{node:n}]);for(var E=j.split(t),m=0;m<E.length;m++){var F=E[m],k=F.match(u),b=k&&k[2].toLowerCase(),e=o[b];if("br"===b)D();else if(void 0===e)L(r,d(F));else if(k[1])M(b);else{var l=k[4],g={type:b},a=A(l,w);if(a?(a=a.replace(B,"$1 fill:"),e&&(a+=";"+e)):e&&(a=e),a&&(g.style=a),"a"===b){C=!0;var H=A(l,x);if(H){var I=G(H);I&&(g.href=I,g.target=A(l,y)||"_blank",g.popup=A(l,z))}}K(g)}}return C}function G(a){var b=encodeURI(decodeURI(a)),c=document.createElement("a"),d=document.createElement("a");c.href=a,d.href=b;var e=c.protocol,f=d.protocol;return -1!==r.indexOf(e)&& -1!==r.indexOf(f)?b:""}function H(e,f,a){var i,g,h,b=a.horizontalAlign,d=a.verticalAlign||"top",j=e.node().getBoundingClientRect(),k=f.node().getBoundingClientRect();return g="bottom"===d?function(){return j.bottom-i.height}:"middle"===d?function(){return j.top+(j.height-i.height)/2}:function(){return j.top},h="right"===b?function(){return j.right-i.width}:"center"===b?function(){return j.left+(j.width-i.width)/2}:function(){return j.left},function(){i=this.node().getBoundingClientRect();var b=h()-k.left,d=g()-k.top,e=a.gd||{};if(a.gd){e._fullLayout._calcInverseTransform(e);var f=c.apply3DTransform(e._fullLayout._invTransform)(b,d);b=f[0],d=f[1]}return this.style({top:d+"px",left:b+"px","z-index":1e3}),this}}a.convertEntities=d,a.sanitizeHTML=function(e){e=e.replace(s," ");for(var l=document.createElement("p"),a=l,g=[],m=e.split(t),h=0;h<m.length;h++){var n=m[h],b=n.match(u),i=b&&b[2].toLowerCase();if(i in o)if(b[1])g.length&&(a=g.pop());else{var j=b[4],p=A(j,w),k=p?{style:p}:{};if("a"===i){var q=A(j,x);if(q){var r=G(q);if(r){k.href=r;var v=A(j,y);v&&(k.target=v)}}}var c=document.createElement(i);a.appendChild(c),f.select(c).attr(k),a=c,g.push(c)}else a.appendChild(document.createTextNode(d(n)))}return l.innerHTML},a.lineCount=function(a){return a.selectAll("tspan.line").size()||1},a.positionText=function(a,b,c){return a.each(function(){var d=f.select(this);function a(b,a){return void 0===a?null===(a=d.attr(b))&&(d.attr(b,0),a=0):d.attr(b,a),a}var e=a("x",b),g=a("y",c);"text"===this.nodeName&&d.selectAll("tspan.line").attr({x:e,y:g})})};var I="1px ";a.makeTextShadow=function(a){var b=I,c=I,d=I;return b+c+d+a+", -"+b+"-"+c+d+a+", "+b+"-"+c+d+a+", -"+b+c+d+a},a.makeEditable=function(a,b){var h=b.gd,c=b.delegate,e=f.dispatch("edit","input","cancel"),g=c||a;if(a.style({"pointer-events":c?"none":"all"}),1!==a.size())throw new Error("boo");function d(){j(),a.style({opacity:0});var b,c=g.attr("class");(b=c?"."+c.split(" ")[0]+"-math-group":"[class*=-math-group]")&&f.select(a.node().parentNode).select(b).style({opacity:0})}function i(d){var a=d.node(),b=document.createRange();b.selectNodeContents(a);var c=window.getSelection();c.removeAllRanges(),c.addRange(b),a.focus()}function j(){var g=f.select(h).select(".svg-container"),k=g.append("div"),c=a.node().style,j=parseFloat(c.fontSize||12),d=b.text;void 0===d&&(d=a.attr("data-unformatted")),k.classed("plugin-editable editable",!0).style({position:"absolute","font-family":c.fontFamily||"Arial","font-size":j,color:b.fill||c.fill||"black",opacity:1,"background-color":b.background||"transparent",outline:"#ffffff33 1px solid",margin:[-j/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(d).call(H(a,g,b)).on("blur",function(){h._editing=!1,a.text(this.textContent).style({opacity:1});var b,c=f.select(this).attr("class");(b=c?"."+c.split(" ")[0]+"-math-group":"[class*=-math-group]")&&f.select(a.node().parentNode).select(b).style({opacity:0});var d=this.textContent;f.select(this).transition().duration(0).remove(),f.select(document).on("mouseup",null),e.edit.call(a,d)}).on("focus",function(){var a=this;h._editing=!0,f.select(document).on("mouseup",function(){if(f.event.target===a)return!1;document.activeElement===k.node()&&k.node().blur()})}).on("keyup",function(){27===f.event.which?(h._editing=!1,a.style({opacity:1}),f.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),e.cancel.call(a,this.textContent)):(e.input.call(a,this.textContent),f.select(this).call(H(a,g,b)))}).on("keydown",function(){13===f.event.which&&this.blur()}).call(i)}return b.immediate?d():g.on("click",d),f.rebind(a,e,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(b,c,a){"use strict";var d={};function e(a){a&&null!==a.timer&&(clearTimeout(a.timer),a.timer=null)}a.throttle=function(b,c,i){var a=d[b],f=Date.now();if(!a){for(var g in d)d[g].ts<f-6e4&&delete d[g];a=d[b]={ts:0,timer:null}}function h(){i(),a.ts=Date.now(),a.onDone&&(a.onDone(),a.onDone=null)}if(e(a),f>a.ts+c){h();return}a.timer=setTimeout(function(){h(),a.timer=null},c)},a.done=function(b){var a=d[b];return a&&a.timer?new Promise(function(b){var c=a.onDone;a.onDone=function(){c&&c(),b(),a.onDone=null}}):Promise.resolve()},a.clear=function(b){if(b)e(d[b]),delete d[b];else for(var c in d)a.clear(c)}},{}],543:[function(a,b,c){"use strict";var d=a("fast-isnumeric");b.exports=function(c,a){if(c>0)return Math.log(c)/Math.LN10;var b=Math.log(Math.min(a[0],a[1]))/Math.LN10;return d(b)||(b=Math.log(Math.max(a[0],a[1]))/Math.LN10-6),b}},{"fast-isnumeric":190}],544:[function(b,c,d){"use strict";var a=c.exports={},e=b("../plots/geo/constants").locationmodeToLayer,f=b("topojson-client").feature;a.getTopojsonName=function(a){return[a.scope.replace(/ /g,"-"),"_",a.resolution.toString(),"m"].join("")},a.getTopojsonPath=function(a,b){return a+b+".json"},a.getTopojsonFeatures=function(b,a){var c=e[b.locationmode],d=a.objects[c];return f(a,d).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(b,a,c){"use strict";a.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(b,a,c){"use strict";a.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(a,b,c){"use strict";var d=a("../registry");b.exports=function(c){for(var a,b,f=d.layoutArrayContainers,g=d.layoutArrayRegexes,i=c.split("[")[0],e=0;e<g.length;e++)if((b=c.match(g[e]))&&0===b.index){a=b[0];break}if(a||(a=f[f.indexOf(i)]),!a)return!1;var h=c.substr(a.length);return h?!!(b=h.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:a,index:Number(b[1]),property:b[3]||""}:{array:a,index:"",property:""}}},{"../registry":647}],548:[function(d,e,g){"use strict";var a=d("../lib"),h=a.extendFlat,i=a.isPlainObject,b={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},c={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},j=b.flags.slice().concat(["fullReplot"]),k=c.flags.slice().concat("layoutReplot");function l(b){for(var c={},a=0;a<b.length;a++)c[b[a]]=!1;return c}function f(f,c,d){var a=h({},f);for(var b in a){var e=a[b];i(e)&&(a[b]=m(e,c,d,b))}return"from-root"===d&&(a.editType=c),a}function m(a,d,g,e){if(!a.valType)return f(a,d,"_"===e.charAt(0)?"nested":"from-root");var b=h({},a);if(b.editType=d,Array.isArray(a.items)){b.items=new Array(a.items.length);for(var c=0;c<a.items.length;c++)b.items[c]=m(a.items[c],d,"from-root")}return b}e.exports={traces:b,layout:c,traceFlags:function(){return l(j)},layoutFlags:function(){return l(k)},update:function(d,e){var a=e.editType;if(a&&"none"!==a)for(var c=a.split("+"),b=0;b<c.length;b++)d[c[b]]=!0},overrideAll:f}},{"../lib":515}],549:[function(b,e,a){"use strict";var f=b("fast-isnumeric"),g=b("gl-mat4/fromQuat"),d=b("../registry"),h=b("../lib"),i=b("../plots/plots"),c=b("../plots/cartesian/axis_ids"),j=b("../components/color"),k=c.cleanId,l=c.getFromTrace,m=d.traceIs;function n(c,a){var b=c[a],d=a.charAt(0);b&&"paper"!==b&&(c[a]=k(b,d,!0))}function o(a){a&&(("string"==typeof a.title||"number"==typeof a.title)&&(a.title={text:a.title}),b("titlefont","font"),b("titleposition","position"),b("titleside","side"),b("titleoffset","offset"));function b(b,c){var d=a[b],e=a.title&&a.title[c];d&&!e&&(a.title||(a.title={}),a.title[c]=a[b],delete a[b])}}function p(a){if(!h.isPlainObject(a))return!1;var b=a.name;return delete a.name,delete a.showlegend,("string"==typeof b||"number"==typeof b)&&String(b)}function q(a,c,d,e){if(d&&!e)return a;if(e&&!d)return c;if(!a.trim())return c;if(!c.trim())return a;var b,f=Math.min(a.length,c.length);for(b=0;b<f&&a.charAt(b)===c.charAt(b);b++);return a.substr(0,b).trim()}function r(a){var b="middle",c="center";return"string"==typeof a&&(-1!==a.indexOf("top")?b="top":-1!==a.indexOf("bottom")&&(b="bottom"),-1!==a.indexOf("left")?c="left":-1!==a.indexOf("right")&&(c="right")),b+" "+c}function s(a,b){return b in a&&"object"==typeof a[b]&&0===Object.keys(a[b]).length}a.clearPromiseQueue=function(a){Array.isArray(a._promises)&&a._promises.length>0&&h.log("Clearing previous rejected promises from queue."),a._promises=[]},a.cleanLayout=function(b){b||(b={}),b.xaxis1&&(b.xaxis||(b.xaxis=b.xaxis1),delete b.xaxis1),b.yaxis1&&(b.yaxis||(b.yaxis=b.yaxis1),delete b.yaxis1),b.scene1&&(b.scene||(b.scene=b.scene1),delete b.scene1);var d,m,x=(i.subplotsRegistry.cartesian||{}).attrRegex,y=(i.subplotsRegistry.polar||{}).attrRegex,z=(i.subplotsRegistry.ternary||{}).attrRegex,A=(i.subplotsRegistry.gl3d||{}).attrRegex,B=Object.keys(b);for(d=0;d<B.length;d++){var l=B[d];if(x&&x.test(l)){var c=b[l];c.anchor&&"free"!==c.anchor&&(c.anchor=k(c.anchor)),c.overlaying&&(c.overlaying=k(c.overlaying)),c.type||(c.isdate?c.type="date":c.islog?c.type="log":!1!==c.isdate|| !1!==c.islog||(c.type="linear")),("withzero"===c.autorange||"tozero"===c.autorange)&&(c.autorange=!0,c.rangemode="tozero"),delete c.islog,delete c.isdate,delete c.categories,s(c,"domain")&&delete c.domain,void 0!==c.autotick&&(void 0===c.tickmode&&(c.tickmode=c.autotick?"auto":"linear"),delete c.autotick),o(c)}else if(y&&y.test(l))o(b[l].radialaxis);else if(z&&z.test(l)){var u=b[l];o(u.aaxis),o(u.baxis),o(u.caxis)}else if(A&&A.test(l)){var p=b[l],q=p.cameraposition;if(Array.isArray(q)&&4===q[0].length){var C=q[0],r=q[1],D=q[2],E=g([],C),t=[];for(m=0;m<3;++m)t[m]=r[m]+D*E[2+4*m];p.camera={eye:{x:t[0],y:t[1],z:t[2]},center:{x:r[0],y:r[1],z:r[2]},up:{x:0,y:0,z:1}},delete p.cameraposition}o(p.xaxis),o(p.yaxis),o(p.zaxis)}}var F=Array.isArray(b.annotations)?b.annotations.length:0;for(d=0;d<F;d++){var f=b.annotations[d];h.isPlainObject(f)&&(f.ref&&("paper"===f.ref?(f.xref="paper",f.yref="paper"):"data"===f.ref&&(f.xref="x",f.yref="y"),delete f.ref),n(f,"xref"),n(f,"yref"))}var G=Array.isArray(b.shapes)?b.shapes.length:0;for(d=0;d<G;d++){var v=b.shapes[d];h.isPlainObject(v)&&(n(v,"xref"),n(v,"yref"))}var H=Array.isArray(b.images)?b.images.length:0;for(d=0;d<H;d++){var w=b.images[d];h.isPlainObject(w)&&(n(w,"xref"),n(w,"yref"))}var e=b.legend;return e&&(e.x>3?(e.x=1.02,e.xanchor="left"):e.x< -2&&(e.x=-0.02,e.xanchor="right"),e.y>3?(e.y=1.02,e.yanchor="bottom"):e.y< -2&&(e.y=-0.02,e.yanchor="top")),o(b),"rotate"===b.dragmode&&(b.dragmode="orbit"),j.clean(b),b.template&&b.template.layout&&a.cleanLayout(b.template.layout),b},a.cleanData=function(x){for(var l=0;l<x.length;l++){var e,b=x[l];if("histogramy"===b.type&&"xbins"in b&&!("ybins"in b)&&(b.ybins=b.xbins,delete b.xbins),b.error_y&&"opacity"in b.error_y){var y=j.defaults,z=b.error_y.color||(m(b,"bar")?j.defaultLine:y[l%y.length]);b.error_y.color=j.addOpacity(j.rgb(z),j.opacity(z)*b.error_y.opacity),delete b.error_y.opacity}if("bardir"in b&&("h"===b.bardir&&(m(b,"bar")||"histogram"===b.type.substr(0,9))&&(b.orientation="h",a.swapXYData(b)),delete b.bardir),"histogramy"===b.type&&a.swapXYData(b),("histogramx"===b.type||"histogramy"===b.type)&&(b.type="histogram"),"scl"in b&&!("colorscale"in b)&&(b.colorscale=b.scl,delete b.scl),"reversescl"in b&&!("reversescale"in b)&&(b.reversescale=b.reversescl,delete b.reversescl),b.xaxis&&(b.xaxis=k(b.xaxis,"x")),b.yaxis&&(b.yaxis=k(b.yaxis,"y")),m(b,"gl3d")&&b.scene&&(b.scene=i.subplotsRegistry.gl3d.cleanId(b.scene)),!m(b,"pie-like")&&!m(b,"bar-like"))if(Array.isArray(b.textposition))for(e=0;e<b.textposition.length;e++)b.textposition[e]=r(b.textposition[e]);else b.textposition&&(b.textposition=r(b.textposition));var v=d.getModule(b);if(v&&v.colorbar){var A=v.colorbar.container,g=A?b[A]:b;g&&g.colorscale&&("YIGnBu"===g.colorscale&&(g.colorscale="YlGnBu"),"YIOrRd"===g.colorscale&&(g.colorscale="YlOrRd"))}if("surface"===b.type&&h.isPlainObject(b.contours)){var B=["x","y","z"];for(e=0;e<B.length;e++){var f=b.contours[B[e]];h.isPlainObject(f)&&(f.highlightColor&&(f.highlightcolor=f.highlightColor,delete f.highlightColor),f.highlightWidth&&(f.highlightwidth=f.highlightWidth,delete f.highlightWidth))}}if("candlestick"===b.type||"ohlc"===b.type){var F=!1!==(b.increasing||{}).showlegend,G=!1!==(b.decreasing||{}).showlegend,n=p(b.increasing),t=p(b.decreasing);if(!1!==n&& !1!==t){var C=q(n,t,F,G);C&&(b.name=C)}else(n||t)&&!b.name&&(b.name=n||t)}if(Array.isArray(b.transforms)){var D=b.transforms;for(e=0;e<D.length;e++){var c=D[e];if(h.isPlainObject(c))switch(c.type){case"filter":c.filtersrc&&(c.target=c.filtersrc,delete c.filtersrc),c.calendar&&(c.valuecalendar||(c.valuecalendar=c.calendar),delete c.calendar);break;case"groupby":if(c.styles=c.styles||c.style,c.styles&&!Array.isArray(c.styles)){var E=c.styles,w=Object.keys(E);c.styles=[];for(var u=0;u<w.length;u++)c.styles.push({target:w[u],value:E[w[u]]})}break}}}s(b,"line")&&delete b.line,"marker"in b&&(s(b.marker,"line")&&delete b.marker.line,s(b,"marker")&&delete b.marker),j.clean(b),b.autobinx&&(delete b.autobinx,delete b.xbins),b.autobiny&&(delete b.autobiny,delete b.ybins),o(b),b.colorbar&&o(b.colorbar),b.marker&&b.marker.colorbar&&o(b.marker.colorbar),b.line&&b.line.colorbar&&o(b.line.colorbar),b.aaxis&&o(b.aaxis),b.baxis&&o(b.baxis)}},a.swapXYData=function(a){var b;if(h.swapAttrs(a,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(a.z)&&Array.isArray(a.z[0])&&(a.transpose?delete a.transpose:a.transpose=!0),a.error_x&&a.error_y){var d=a.error_y,e="copy_ystyle"in d?d.copy_ystyle:!(d.color||d.thickness||d.width);h.swapAttrs(a,["error_?.copy_ystyle"]),e&&h.swapAttrs(a,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof a.hoverinfo){var c=a.hoverinfo.split("+");for(b=0;b<c.length;b++)"x"===c[b]?c[b]="y":"y"===c[b]&&(c[b]="x");a.hoverinfo=c.join("+")}},a.coerceTraceIndices=function(c,a){if(f(a))return[a];if(!Array.isArray(a)||!a.length)return c.data.map(function(b,a){return a});if(Array.isArray(a)){for(var d=[],b=0;b<a.length;b++)h.isIndex(a[b],c.data.length)?d.push(a[b]):h.warn("trace index (",a[b],") is not a number or is out of bounds");return d}return a},a.manageArrayContainers=function(a,c,i){var j=a.obj,b=a.parts,d=b.length,e=b[d-1],g=f(e);if(g&&null===c){var k=b.slice(0,d-1).join(".");h.nestedProperty(j,k).get().splice(e,1)}else g&& void 0===a.get()&& void 0===a.get()&&(i[a.astr]=null),a.set(c)};var t=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function u(a){var b=a.search(t);if(b>0)return a.substr(0,b)}a.hasParent=function(b,c){for(var a=u(c);a;){if(a in b)return!0;a=u(a)}return!1};var v=["x","y","z"];a.clearAxisTypes=function(c,j,d){for(var e=0;e<j.length;e++)for(var k=c._fullData[e],f=0;f<3;f++){var a=l(c,k,v[f]);if(a&&"log"!==a.type){var b=a._name,g=a._id.substr(1);if("scene"===g.substr(0,5)){if(void 0!==d[g])continue;b=g+"."+b}var i=b+".type";void 0===d[b]&& void 0===d[i]&&h.nestedProperty(c.layout,i).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(c,e,a){"use strict";var b=c("./plot_api");a._doPlot=b._doPlot,a.newPlot=b.newPlot,a.restyle=b.restyle,a.relayout=b.relayout,a.redraw=b.redraw,a.update=b.update,a._guiRestyle=b._guiRestyle,a._guiRelayout=b._guiRelayout,a._guiUpdate=b._guiUpdate,a._storeDirectGUIEdit=b._storeDirectGUIEdit,a.react=b.react,a.extendTraces=b.extendTraces,a.prependTraces=b.prependTraces,a.addTraces=b.addTraces,a.deleteTraces=b.deleteTraces,a.moveTraces=b.moveTraces,a.purge=b.purge,a.addFrames=b.addFrames,a.deleteFrames=b.deleteFrames,a.animate=b.animate,a.setPlotConfig=b.setPlotConfig,a.toImage=c("./to_image"),a.validate=c("./validate"),a.downloadImage=c("../snapshot/download");var d=c("./template_api");a.makeTemplate=d.makeTemplate,a.validateTemplate=d.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(a,c,b){"use strict";var d=a("../lib/is_plain_object"),e=a("../lib/noop"),f=a("../lib/loggers"),g=a("../lib/search").sorterAsc,h=a("../registry");b.containerArrayMatch=a("./container_array_match");var i=b.isAddVal=function(a){return"add"===a||d(a)},j=b.isRemoveVal=function(a){return null===a||"remove"===a};b.applyContainerArrayChanges=function(n,l,o,C,D){var a,p,b,t,q,k,x,E,m,c=l.astr,y=h.getComponentMethod(c,"supplyLayoutDefaults"),z=h.getComponentMethod(c,"draw"),F=h.getComponentMethod(c,"drawOne"),G=C.replot||C.recalc||y===e||z===e,H=n.layout,A=n._fullLayout;if(o[""]){Object.keys(o).length>1&&f.warn("Full array edits are incompatible with other edits",c);var u=o[""][""];if(j(u))l.set(null);else{if(!Array.isArray(u))return f.warn("Unrecognized full array edit value",c,u),!0;l.set(u)}return!G&&(y(H,A),z(n),!0)}var r=Object.keys(o).map(Number).sort(g),I=l.get(),d=I||[],v=D(A,c).get(),w=[],s=-1,B=d.length;for(a=0;a<r.length;a++){if(t=o[b=r[a]],q=Object.keys(t),x=i(k=t[""]),b<0||b>d.length-(x?0:1)){f.warn("index out of range",c,b);continue}if(void 0!==k)q.length>1&&f.warn("Insertion & removal are incompatible with edits to the same index.",c,b),j(k)?w.push(b):x?("add"===k&&(k={}),d.splice(b,0,k),v&&v.splice(b,0,{})):f.warn("Unrecognized full object edit value",c,b,k),-1===s&&(s=b);else for(p=0;p<q.length;p++)E=c+"["+b+"].",D(d[b],q[p],E).set(t[q[p]])}for(a=w.length-1;a>=0;a--)d.splice(w[a],1),v&&v.splice(w[a],1);if(d.length?I||l.set(d):l.set(null),G)return!1;if(y(H,A),F!==e){if(-1===s)m=r;else{for(a=0,B=Math.max(d.length,B),m=[];a<r.length&&!((b=r[a])>=s);a++)m.push(b);for(a=s;a<B;a++)m.push(a)}for(a=0;a<m.length;a++)F(n,m[a])}else z(n);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(a,m,b){"use strict";var n=a("@plotly/d3"),o=a("fast-isnumeric"),p=a("has-hover"),g=a("../lib"),q=g.nestedProperty,r=a("../lib/events"),s=a("../lib/queue"),t=a("../registry"),u=a("./plot_schema"),v=a("../plots/plots"),w=a("../plots/cartesian/axes"),x=a("../components/drawing"),y=a("../components/color"),z=a("../plots/cartesian/graph_interact").initInteractions,A=a("../constants/xmlns_namespaces"),B=a("../components/selections").clearOutline,C=a("./plot_config").dfltConfig,D=a("./manage_arrays"),E=a("./helpers"),F=a("./subroutines"),G=a("./edit_types"),H=a("../plots/cartesian/constants").AX_NAME_PATTERN,I=0;function J(a){var b=a._fullLayout;b._redrawFromAutoMarginCount?b._redrawFromAutoMarginCount--:a.emit("plotly_afterplot")}function K(a,b){try{a._fullLayout._paper.style("background",b)}catch(c){g.error(c)}}function L(a,b){K(a,y.combine(b,"white"))}function M(h,d){if(!h._context){h._context=g.extendDeep({},C);var b,e,c,k=n.select("base");h._context._baseUrl=k.size()&&k.attr("href")?window.location.href.split("#")[0]:""}var a=h._context;if(d){for(b=0,e=Object.keys(d);b<e.length;b++)"editable"!==(c=e[b])&&"edits"!==c&&c in a&&("setBackground"===c&&"opaque"===d[c]?a[c]=L:a[c]=d[c]);d.plot3dPixelRatio&&!a.plotGlPixelRatio&&(a.plotGlPixelRatio=a.plot3dPixelRatio);var j=d.editable;if(void 0!==j)for(b=0,a.editable=j,e=Object.keys(a.edits);b<e.length;b++)a.edits[e[b]]=j;if(d.edits)for(b=0,e=Object.keys(d.edits);b<e.length;b++)(c=e[b])in a.edits&&(a.edits[c]=d.edits[c]);a._exportedPlot=d._exportedPlot}a.staticPlot&&(a.editable=!1,a.edits={},a.autosizable=!1,a.scrollZoom=!1,a.doubleClick=!1,a.showTips=!1,a.showLink=!1,a.displayModeBar=!1),"hover"!==a.displayModeBar||p||(a.displayModeBar=!0),("transparent"===a.setBackground||"function"!=typeof a.setBackground)&&(a.setBackground=K),a._hasZeroHeight=a._hasZeroHeight||0===h.clientHeight,a._hasZeroWidth=a._hasZeroWidth||0===h.clientWidth;var i=a.scrollZoom,f=a._scrollZoom={};if(!0===i)f.cartesian=1,f.gl3d=1,f.geo=1,f.mapbox=1;else if("string"==typeof i){var l=i.split("+");for(b=0;b<l.length;b++)f[l[b]]=1}else!1!==i&&(f.gl3d=1,f.geo=1,f.mapbox=1)}function N(d,e){var a,b,f=e+1,c=[];for(a=0;a<d.length;a++)(b=d[a])<0?c.push(f+b):c.push(b);return c}function O(d,b,e){var c,a;for(c=0;c<b.length;c++){if((a=b[c])!==parseInt(a,10))throw new Error("all values in "+e+" must be integers");if(a>=d.data.length||a< -d.data.length)throw new Error(e+" must be valid indices for gd.data.");if(b.indexOf(a,c+1)> -1||a>=0&&b.indexOf(-d.data.length+a)> -1||a<0&&b.indexOf(d.data.length+a)> -1)throw new Error("each index in "+e+" must be unique.")}}function P(c,b,a){if(!Array.isArray(c.data))throw new Error("gd.data must be an array.");if(void 0===b)throw new Error("currentIndices is a required argument.");if(Array.isArray(b)||(b=[b]),O(c,b,"currentIndices"),void 0===a||Array.isArray(a)||(a=[a]),void 0!==a&&O(c,a,"newIndices"),void 0!==a&&b.length!==a.length)throw new Error("current and new indices must be of equal length.")}function Q(f,h,i,j,l){!function(e,b,d,c){var f=g.isPlainObject(c);if(!Array.isArray(e.data))throw new Error("gd.data must be an array");if(!g.isPlainObject(b))throw new Error("update must be a key:value object");if(void 0===d)throw new Error("indices must be an integer or array of integers");for(var a in O(e,d,"indices"),b){if(!Array.isArray(b[a])||b[a].length!==d.length)throw new Error("attribute "+a+" must be an array of length equal to indices array length");if(f&&(!(a in c)||!Array.isArray(c[a])||c[a].length!==b[a].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(f,h,i,j);for(var c=function(i,j,a,f){var d,k,e,h,m=g.isPlainObject(f),l=[];for(var b in Array.isArray(a)||(a=[a]),a=N(a,i.data.length-1),j)for(var c=0;c<a.length;c++){if(d=(k=q(i.data[a[c]],b)).get(),e=j[b][c],!g.isArrayOrTypedArray(e))throw new Error("attribute: "+b+" index: "+c+" must be an array");if(!g.isArrayOrTypedArray(d))throw new Error("cannot extend missing or non-array attribute: "+b);if(d.constructor!==e.constructor)throw new Error("cannot extend array with an array of a different type: "+b);o(h=m?f[b][c]:f)||(h=-1),l.push({prop:k,target:d,insert:e,maxp:Math.floor(h)})}return l}(f,h,i,j),d={},e={},a=0;a<c.length;a++){var b=c[a].prop,m=c[a].maxp,k=l(c[a].target,c[a].insert,m);b.set(k[0]),Array.isArray(d[b.astr])||(d[b.astr]=[]),d[b.astr].push(k[1]),Array.isArray(e[b.astr])||(e[b.astr]=[]),e[b.astr].push(c[a].target.length)}return{update:d,maxPoints:e}}function R(a,c){var b=new a.constructor(a.length+c.length);return b.set(a),b.set(c,a.length),b}function h(a,e,c,f){var d=Q(a=g.getGraphDiv(a),e,c,f,function(a,c,d){var b,e;if(g.isTypedArray(a))if(d<0){var f=new a.constructor(0),h=R(a,c);d<0?(b=h,e=f):(b=f,e=h)}else if(b=new a.constructor(d),e=new a.constructor(a.length+c.length-d),d===c.length)b.set(c),e.set(a);else if(d<c.length){var i=c.length-d;b.set(c.subarray(i)),e.set(a),e.set(c.subarray(0,i),a.length)}else{var j=d-c.length,k=a.length-j;b.set(a.subarray(k)),b.set(c,j),e.set(a.subarray(0,k))}else b=a.concat(c),e=d>=0&&d<b.length?b.splice(0,b.length-d):[];return[b,e]}),i=b.redraw(a),j=[a,d.update,c,d.maxPoints];return s.add(a,b.prependTraces,j,h,arguments),i}function i(a,e,c,f){var d=Q(a=g.getGraphDiv(a),e,c,f,function(c,a,d){var b,e;if(g.isTypedArray(c))if(d<=0){var h=new c.constructor(0),i=R(a,c);d<0?(b=i,e=h):(b=h,e=i)}else if(b=new c.constructor(d),e=new c.constructor(c.length+a.length-d),d===a.length)b.set(a),e.set(c);else if(d<a.length){var f=a.length-d;b.set(a.subarray(0,f)),e.set(a.subarray(f)),e.set(c,f)}else{var j=d-a.length;b.set(a),b.set(c.subarray(0,j),a.length),e.set(c.subarray(j))}else b=a.concat(c),e=d>=0&&d<b.length?b.splice(d,b.length):[];return[b,e]}),h=b.redraw(a),j=[a,d.update,c,d.maxPoints];return s.add(a,b.extendTraces,j,i,arguments),h}function j(a,c,e){a=g.getGraphDiv(a);var d,f,h=[],i=b.deleteTraces,k=j,l=[a,h],m=[a,c];for(!function(e,a,b){var c,d;if(!Array.isArray(e.data))throw new Error("gd.data must be an array.");if(void 0===a)throw new Error("traces must be defined.");for(Array.isArray(a)||(a=[a]),c=0;c<a.length;c++)if("object"!=typeof(d=a[c])||Array.isArray(d)||null===d)throw new Error("all values in traces array must be non-array objects");if(void 0===b||Array.isArray(b)||(b=[b]),void 0!==b&&b.length!==a.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(a,c,e),Array.isArray(c)||(c=[c]),c=c.map(function(a){return g.extendFlat({},a)}),E.cleanData(c),d=0;d<c.length;d++)a.data.push(c[d]);for(d=0;d<c.length;d++)h.push(-c.length+d);if(void 0===e)return f=b.redraw(a),s.add(a,i,l,k,m),f;Array.isArray(e)||(e=[e]);try{P(a,h,e)}catch(n){throw a.data.splice(a.data.length-c.length,c.length),n}return s.startSequence(a),s.add(a,i,l,k,m),f=b.moveTraces(a,h,e),s.stopSequence(a),f}function k(c,a){c=g.getGraphDiv(c);var d,e,f=[],h=b.addTraces,i=[c,f,a],j=[c,a];if(void 0===a)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(a)||(a=[a]),O(c,a,"indices"),(a=N(a,c.data.length-1)).sort(g.sorterDes),d=0;d<a.length;d+=1)e=c.data.splice(a[d],1)[0],f.push(e);var l=b.redraw(c);return s.add(c,h,i,k,j),l}function l(d,c,e){d=g.getGraphDiv(d);var a,h=[],f=[],i=[d,e,c],j=[d,c,e];if(P(d,c,e),c=Array.isArray(c)?c:[c],void 0===e)for(a=0,e=[];a<c.length;a++)e.push(-c.length+a);for(a=0,e=Array.isArray(e)?e:[e],c=N(c,d.data.length-1),e=N(e,d.data.length-1);a<d.data.length;a++)-1===c.indexOf(a)&&h.push(d.data[a]);for(a=0;a<c.length;a++)f.push({newIndex:e[a],trace:d.data[c[a]]});for(f.sort(function(a,b){return a.newIndex-b.newIndex}),a=0;a<f.length;a+=1)h.splice(f[a].newIndex,0,f[a].trace);d.data=h;var k=b.redraw(d);return s.add(d,l,i,l,j),k}function d(a,f,l,i){a=g.getGraphDiv(a),E.clearPromiseQueue(a);var j={};if("string"==typeof f)j[f]=l;else{if(!g.isPlainObject(f))return g.warn("Restyle fail.",f,l,i),Promise.reject();j=g.extendFlat({},f),void 0===i&&(i=l)}Object.keys(j).length&&(a.changed=!0);var m=E.coerceTraceIndices(a,i),h=V(a,j,m),e=h.flags;e.calc&&(a.calcdata=void 0),e.clearAxisTypes&&E.clearAxisTypes(a,m,{});var c=[];e.fullReplot?c.push(b._doPlot):(c.push(v.previousPromises),v.supplyDefaults(a),e.markerSize&&(v.doCalcdata(a),Y(c)),e.style&&c.push(F.doTraceStyle),e.colorbars&&c.push(F.doColorBars),c.push(J)),c.push(v.rehover,v.redrag,v.reselect),s.add(a,d,[a,h.undoit,h.traces],d,[a,h.redoit,h.traces]);var k=g.syncOrAsync(c,a);return k&&k.then||(k=Promise.resolve()),k.then(function(){return a.emit("plotly_restyle",h.eventData),a})}function S(a){return void 0===a?null:a}function T(b,a){return a?function(c,d,e){var a=q(c,d),f=a.set;return a.set=function(c){U((e||"")+d,a.get(),c,b),f(c)},a}:q}function U(d,a,b,e){if(Array.isArray(a)||Array.isArray(b))for(var h=Array.isArray(a)?a:[],i=Array.isArray(b)?b:[],l=Math.max(h.length,i.length),c=0;c<l;c++)U(d+"["+c+"]",h[c],i[c],e);else if(g.isPlainObject(a)||g.isPlainObject(b)){var j=g.isPlainObject(a)?a:{},k=g.isPlainObject(b)?b:{},m=g.extendFlat({},j,k);for(var f in m)U(d+"."+f,j[f],k[f],e)}else void 0===e[d]&&(e[d]=S(a))}function V(m,n,i){var o=m._fullLayout,ac=m._fullData,H=m.data,I=o._guiEditing,U=T(o._preGUI,I),V=g.extendDeepAll({},n);W(n);var h=G.traceFlags(),J={},p={};function X(){return i.map(function(){})}function K(b){var a=w.id2name(b);-1===C.indexOf(a)&&C.push(a)}function Y(a){return"LAYOUT"+a+".autorange"}function Z(a){return"LAYOUT"+a+".range"}function $(b){for(var a=b;a<ac.length;a++)if(ac[a]._input===H[b])return ac[a]}function r(a,d,b){if(Array.isArray(a)){a.forEach(function(a){r(a,d,b)});return}if(!(a in n||E.hasParent(n,a))){if("LAYOUT"===a.substr(0,6))c=U(m.layout,a.replace("LAYOUT",""));else{var c,e=i[b];c=T(o._tracePreGUI[$(e)._fullInput.uid],I)(H[e],a)}a in p||(p[a]=X()),void 0===p[a][b]&&(p[a][b]=S(c.get())),void 0!==d&&c.set(d)}}function _(a){return function(b){return ac[b][a]}}function aa(a){return function(b,c){return!1===b?ac[i[c]][a]:null}}for(var a in n){if(E.hasParent(n,a))throw new Error("cannot set "+a+" and a parent attribute simultaneously");var c,C,b,k,e,j,d,l,f=n[a];if(("autobinx"===a||"autobiny"===a)&&(a=a.charAt(a.length-1)+"bins",f=Array.isArray(f)?f.map(aa(a)):!1===f?i.map(_(a)):null),J[a]=f,"LAYOUT"===a.substr(0,6)){e=U(m.layout,a.replace("LAYOUT","")),p[a]=[S(e.get())],e.set(Array.isArray(f)?f[0]:f),h.calc=!0;continue}for(c=0,p[a]=X();c<i.length;c++)if(b=H[i[c]],k=$(i[c]),j=(e=T(o._tracePreGUI[k._fullInput.uid],I)(b,a)).get(),void 0!==(d=Array.isArray(f)?f[c%f.length]:f)){var x=e.parts[e.parts.length-1],y=a.substr(0,a.length-x.length-1),L=y?y+".":"",z=y?q(k,y).get():k;if((l=u.getTraceValObject(k,e.parts))&&l.impliedEdits&&null!==d)for(var M in l.impliedEdits)r(g.relativeAttr(a,M),l.impliedEdits[M],c);else if(("thicknessmode"===x||"lenmode"===x)&&j!==d&&("fraction"===d||"pixels"===d)&&z){var A=o._size,N=z.orient,O="top"===N||"bottom"===N;if("thicknessmode"===x){var P=O?A.h:A.w;r(L+"thickness",z.thickness*("fraction"===d?1/P:P),c)}else{var Q=O?A.w:A.h;r(L+"len",z.len*("fraction"===d?1/Q:Q),c)}}else if("type"===a&&("pie"===d!=("pie"===j)||"funnelarea"===d!=("funnelarea"===j))){var D="x",R="y";("bar"===d||"bar"===j)&&"h"===b.orientation&&(D="y",R="x"),g.swapAttrs(b,["?","?src"],"labels",D),g.swapAttrs(b,["d?","?0"],"label",D),g.swapAttrs(b,["?","?src"],"values",R),"pie"===j||"funnelarea"===j?(q(b,"marker.color").set(q(b,"marker.colors").get()),o._pielayer.selectAll("g.trace").remove()):t.traceIs(b,"cartesian")&&q(b,"marker.colors").set(q(b,"marker.color").get())}if(p[a][c]=S(j),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(a)){if("orientation"===a){e.set(d);var ab=b.x&&!b.y?"h":"v";if((e.get()||ab)===k.orientation)continue}else"orientationaxes"===a&&(b.orientation=({v:"h",h:"v"})[k.orientation]);E.swapXYData(b),h.calc=h.clearAxisTypes=!0}else -1!==v.dataArrayContainers.indexOf(e.parts[0])?(E.manageArrayContainers(e,d,p),h.calc=!0):(l?l.arrayOk&&!t.traceIs(k,"regl")&&(g.isArrayOrTypedArray(d)||g.isArrayOrTypedArray(j))?h.calc=!0:G.update(h,l):h.calc=!0,e.set(d))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(a)&&w.swap(m,i),"orientationaxes"===a){var s=q(m.layout,"hovermode"),B=s.get();"x"===B?s.set("y"):"y"===B?s.set("x"):"x unified"===B?s.set("y unified"):"y unified"===B&&s.set("x unified")}if(-1!==["orientation","type"].indexOf(a)){for(c=0,C=[];c<i.length;c++){var F=H[i[c]];t.traceIs(F,"cartesian")&&(K(F.xaxis||"x"),K(F.yaxis||"y"))}r(C.map(Y),!0,0),r(C.map(Z),[0,1],0)}}return(h.calc||h.plot)&&(h.fullReplot=!0),{flags:h,undoit:p,redoit:J,traces:i,eventData:g.extendDeepNoArrays([],[V,i])}}function W(d){var b,a,c,f=g.counterRegex("axis",".title",!1,!1),h=/colorbar\.title$/,e=Object.keys(d);for(b=0;b<e.length;b++)c=d[a=e[b]],("title"===a||f.test(a)||h.test(a))&&("string"==typeof c||"number"==typeof c)?i(a,a.replace("title","title.text")):a.indexOf("titlefont")> -1&& -1===a.indexOf("grouptitlefont")?i(a,a.replace("titlefont","title.font")):a.indexOf("titleposition")> -1?i(a,a.replace("titleposition","title.position")):a.indexOf("titleside")> -1?i(a,a.replace("titleside","title.side")):a.indexOf("titleoffset")> -1&&i(a,a.replace("titleoffset","title.offset"));function i(a,b){d[b]=d[a],delete d[a]}}function e(a,d,j){a=g.getGraphDiv(a),E.clearPromiseQueue(a);var f={};if("string"==typeof d)f[d]=j;else{if(!g.isPlainObject(d))return g.warn("Relayout fail.",d,j),Promise.reject();f=g.extendFlat({},d)}Object.keys(f).length&&(a.changed=!0);var h=aa(a,f),c=h.flags;c.calc&&(a.calcdata=void 0);var b=[v.previousPromises];c.layoutReplot?b.push(F.layoutReplot):Object.keys(f).length&&(X(a,c,h)||v.supplyDefaults(a),c.legend&&b.push(F.doLegend),c.layoutstyle&&b.push(F.layoutStyles),c.axrange&&Y(b,h.rangesAltered),c.ticks&&b.push(F.doTicksRelayout),c.modebar&&b.push(F.doModeBar),c.camera&&b.push(F.doCamera),c.colorbars&&b.push(F.doColorBars),b.push(J)),b.push(v.rehover,v.redrag,v.reselect),s.add(a,e,[a,h.undoit],e,[a,h.redoit]);var i=g.syncOrAsync(b,a);return i&&i.then||(i=Promise.resolve(a)),i.then(function(){return a.emit("plotly_relayout",h.eventData),a})}function X(e,b,k){var f=e._fullLayout;if(!b.axrange)return!1;for(var g in b)if("axrange"!==g&&b[g])return!1;for(var h in k.rangesAltered){var i=w.id2name(h),c=e.layout[i],a=f[i];if(a.autorange=c.autorange,c.range&&(a.range=c.range.slice()),a.cleanRange(),a._matchGroup){for(var j in a._matchGroup)if(j!==h){var d=f[w.id2name(j)];d.autorange=a.autorange,d.range=a.range.slice(),d._input.range=a.range.slice()}}}return!0}function Y(a,b){a.push(B,F.doAutoRangeAndConstraints,b?function(d){var c=[],g=!0;for(var e in b){var a=w.getFromId(d,e);if(c.push(e),-1!==(a.ticklabelposition||"").indexOf("inside")&&a._anchorAxis&&c.push(a._anchorAxis._id),a._matchGroup)for(var f in a._matchGroup)b[f]||c.push(f)}return w.draw(d,c,{skipTitle:g})}:function(a){return w.draw(a,"redraw")},F.drawData,F.finalDraw)}var Z=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,$=/^[xyz]axis[0-9]*\.autorange$/,_=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function aa(i,h){var m,j,y,l,K=i.layout,a=i._fullLayout,ag=a._guiEditing,L=T(a._preGUI,ag),o=Object.keys(h),M=w.list(i),ah=g.extendDeepAll({},h),p={};for(W(h),o=Object.keys(h),j=0;j<o.length;j++)if(0===o[j].indexOf("allaxes")){for(y=0;y<M.length;y++){var R=M[y]._id.substr(1),ai=-1!==R.indexOf("scene")?R+".":"",U=o[j].replace("allaxes",ai+M[y]._name);h[U]||(h[U]=h[o[j]])}delete h[o[j]]}var e=G.layoutFlags(),V={},F={};function d(a,b){if(Array.isArray(a)){a.forEach(function(a){d(a,b)});return}if(!(a in h||E.hasParent(h,a))){var c=L(K,a);a in F||(F[a]=S(c.get())),void 0!==b&&c.set(b)}}var N={};function X(b){var a=w.name2id(b.split(".")[0]);return N[a]=1,a}for(var c in h){if(E.hasParent(h,c))throw new Error("cannot set "+c+" and a parent attribute simultaneously");for(var k=L(K,c),b=h[c],r=k.parts.length-1;r>0&&"string"!=typeof k.parts[r];)r--;var z=k.parts[r],A=k.parts[r-1]+"."+z,f=k.parts.slice(0,r).join("."),I=q(i.layout,f).get(),s=q(a,f).get(),B=k.get();if(void 0!==b){V[c]=b,F[c]="reverse"===z?b:S(B);var n=u.getLayoutValObject(a,k.parts);if(n&&n.impliedEdits&&null!==b)for(var Y in n.impliedEdits)d(g.relativeAttr(c,Y),n.impliedEdits[Y]);if(-1!==["width","height"].indexOf(c))if(b){d("autosize",null);var aa="height"===c?"width":"height";d(aa,a[aa])}else a[c]=i._initialAutoSize[c];else if("autosize"===c)d("width",b?null:a.width),d("height",b?null:a.height);else if(A.match(Z))X(A),q(a,f+"._inputRange").set(null);else if(A.match($)){X(A),q(a,f+"._inputRange").set(null);var O=q(a,f).get();O._inputDomain&&(O._input.domain=O._inputDomain.slice())}else A.match(_)&&q(a,f+"._inputDomain").set(null);if("type"===z){l=I;var P="linear"===s.type&&"log"===b,aj="log"===s.type&&"linear"===b;if(P||aj){if(l&&l.range)if(s.autorange)P&&(l.range=l.range[1]>l.range[0]?[1,2]:[2,1]);else{var v=l.range[0],x=l.range[1];P?(v<=0&&x<=0&&d(f+".autorange",!0),v<=0?v=x/1e6:x<=0&&(x=v/1e6),d(f+".range[0]",Math.log(v)/Math.LN10),d(f+".range[1]",Math.log(x)/Math.LN10)):(d(f+".range[0]",Math.pow(10,v)),d(f+".range[1]",Math.pow(10,x)))}else d(f+".autorange",!0);Array.isArray(a._subplots.polar)&&a._subplots.polar.length&&a[k.parts[0]]&&"radialaxis"===k.parts[1]&&delete a[k.parts[0]]._subplot.viewInitial["radialaxis.range"],t.getComponentMethod("annotations","convertCoords")(i,s,b,d),t.getComponentMethod("images","convertCoords")(i,s,b,d)}else d(f+".autorange",!0),d(f+".range",null);q(a,f+"._inputRange").set(null)}else if(z.match(H)){var ac=q(a,c).get(),C=(b||{}).type;C&&"-"!==C||(C="linear"),t.getComponentMethod("annotations","convertCoords")(i,ac,C,d),t.getComponentMethod("images","convertCoords")(i,ac,C,d)}var J=D.containerArrayMatch(c);if(J){m=J.array,j=J.index;var ad=J.property,ak=n||{editType:"calc"};""!==j&&""===ad&&(D.isAddVal(b)?F[c]=null:D.isRemoveVal(b)?F[c]=(q(K,m).get()||[])[j]:g.warn("unrecognized full object value",h)),G.update(e,ak),p[m]||(p[m]={});var Q=p[m][j];Q||(Q=p[m][j]={}),Q[ad]=b,delete h[c]}else"reverse"===z?(I.range?I.range.reverse():(d(f+".autorange",!0),I.range=[1,0]),s.autorange?e.calc=!0:e.plot=!0):("dragmode"===c&&(!1===b&& !1!==B|| !1!==b&& !1===B)?e.plot=!0:a._has("scatter-like")&&a._has("regl")&&"dragmode"===c&&("lasso"===b||"select"===b)&&!("lasso"===B||"select"===B)?e.plot=!0:a._has("gl2d")?e.plot=!0:n?G.update(e,n):e.calc=!0,k.set(b))}}for(m in p)D.applyContainerArrayChanges(i,L(K,m),p[m],e,L)||(e.plot=!0);for(var al in N){var ae=(l=w.getFromId(i,al))&&l._constraintGroup;if(ae)for(var af in e.calc=!0,ae)N[af]||(w.getFromId(i,af)._constraintShrinkable=!0)}return(ab(i)||h.height||h.width)&&(e.plot=!0),(e.plot||e.calc)&&(e.layoutReplot=!0),{flags:e,rangesAltered:N,undoit:F,redoit:V,eventData:ah}}function ab(b){var a=b._fullLayout,c=a.width,d=a.height;return b.layout.autosize&&v.plotAutoSize(b,b.layout,a),a.width!==c||a.height!==d}function f(a,k,e,n){a=g.getGraphDiv(a),E.clearPromiseQueue(a),g.isPlainObject(k)||(k={}),g.isPlainObject(e)||(e={}),Object.keys(k).length&&(a.changed=!0),Object.keys(e).length&&(a.changed=!0);var m=E.coerceTraceIndices(a,n),h=V(a,g.extendFlat({},k),m),i=h.flags,j=aa(a,g.extendFlat({},e)),d=j.flags;(i.calc||d.calc)&&(a.calcdata=void 0),i.clearAxisTypes&&E.clearAxisTypes(a,m,e);var c=[];d.layoutReplot?c.push(F.layoutReplot):i.fullReplot?c.push(b._doPlot):(c.push(v.previousPromises),X(a,d,j)||v.supplyDefaults(a),i.style&&c.push(F.doTraceStyle),(i.colorbars||d.colorbars)&&c.push(F.doColorBars),d.legend&&c.push(F.doLegend),d.layoutstyle&&c.push(F.layoutStyles),d.axrange&&Y(c,j.rangesAltered),d.ticks&&c.push(F.doTicksRelayout),d.modebar&&c.push(F.doModeBar),d.camera&&c.push(F.doCamera),c.push(J)),c.push(v.rehover,v.redrag,v.reselect),s.add(a,f,[a,h.undoit,j.undoit,h.traces],f,[a,h.redoit,j.redoit,h.traces]);var l=g.syncOrAsync(c,a);return l&&l.then||(l=Promise.resolve(a)),l.then(function(){return a.emit("plotly_update",{data:h.eventData,layout:j.eventData}),a})}function c(a){return function(b){b._fullLayout._guiEditing=!0;var c=a.apply(null,arguments);return b._fullLayout._guiEditing=!1,c}}var ac=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],ad=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function ae(b,c){for(var a=0;a<c.length;a++){var d=c[a],e=b.match(d.pattern);if(e){var f=e[1]||"";return{head:f,tail:b.substr(f.length+1),attr:d.attr}}}}function af(d,c){var a=q(c,d).get();if(void 0!==a)return a;var b=d.split(".");for(b.pop();b.length>1;)if(b.pop(),void 0!==(a=q(c,b.join(".")+".uirevision").get()))return a;return c.uirevision}function ag(c,b){for(var a=0;a<b.length;a++)if(b[a]._fullInput.uid===c)return a;return -1}function ah(d,a,c){for(var b=0;b<a.length;b++)if(a[b].uid===d)return b;return!a[c]||a[c].uid?-1:c}function ai(a,b){var c=g.isPlainObject(a),d=Array.isArray(a);return c||d?(c&&g.isPlainObject(b)||d&&Array.isArray(b))&&JSON.stringify(a)===JSON.stringify(b):a===b}function aj(l,f,o,e){var s=e.getValObject,j=e.flags,t=e.immutable,B=e.inArray,F=e.arrayIndex;function h(){var b=i.editType;if(B&& -1!==b.indexOf("arraydraw")){g.pushUnique(j.arrays[B],F);return}G.update(j,i),"none"!==b&&j.nChanges++,e.transition&&i.anim&&j.nChangesAnim++,(Z.test(C)||$.test(C))&&(j.rangesAltered[o[0]]=1),_.test(C)&&q(f,"_inputDomain").set(null),"datarevision"===a&&(j.newDataRevision=1)}function u(a){return"data_array"===a.valType||a.arrayOk}for(a in l){if(j.calc&&!e.transition)return;var i,a,C,b,c=l[a],d=f[a],m=o.concat(a);if(C=m.join("."),"_"!==a.charAt(0)&&"function"!=typeof c&&c!==d){if(("tick0"===a||"dtick"===a)&&"geo"!==o[0]){var p=f.tickmode;if("auto"===p||"array"===p||!p)continue}if(("range"!==a||!f.autorange)&&("zmin"!==a&&"zmax"!==a||"contourcarpet"!==f.type)&&(i=s(m))&&(!i._compareAsJSON||JSON.stringify(c)!==JSON.stringify(d))){var D=i.valType,v=u(i),k=Array.isArray(c),n=Array.isArray(d);if(k&&n){var w="_input_"+a,x=l[w],E=f[w];if(Array.isArray(x)&&x===E)continue}if(void 0===d)v&&k?j.calc=!0:h();else if(i._isLinkedToArray){var y=[],z=!1;B||(j.arrays[a]=y);var r=Math.min(c.length,d.length),A=Math.max(c.length,d.length);if(r!==A)if("arraydraw"===i.editType)z=!0;else{h();continue}for(b=0;b<r;b++)aj(c[b],d[b],m.concat(b),g.extendFlat({inArray:a,arrayIndex:b},e));if(z)for(b=r;b<A;b++)y.push(b)}else!D&&g.isPlainObject(c)?aj(c,d,m,e):v?k&&n?(t&&(j.calc=!0),(t||e.newDataRevision)&&h()):k!==n?j.calc=!0:h():k&&n?(c.length!==d.length||String(c)!==String(d))&&h():h()}}}for(a in f)if(!(a in l||"_"===a.charAt(0)||"function"==typeof f[a])){if(u(i=s(o.concat(a)))&&Array.isArray(f[a])){j.calc=!0;return}h()}}function ak(e,f){var d;for(d in e)if("_"!==d.charAt(0)){var a=e[d],b=f[d];if(a!==b)if(g.isPlainObject(a)&&g.isPlainObject(b)){if(ak(a,b))return!0}else{if(!(Array.isArray(a)&&Array.isArray(b)))return!0;if(a.length!==b.length)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c]){if(!(g.isPlainObject(a[c])&&g.isPlainObject(b[c])))return!0;if(ak(a[c],b[c]))return!0}}}}function al(c){var b=c._fullLayout,d=c.getBoundingClientRect();if(!g.equalDomRects(d,b._lastBBox)){var a=b._invTransform=g.inverseTransformMatrix(g.getFullTransformMatrix(c));b._invScaleX=Math.sqrt(a[0][0]*a[0][0]+a[0][1]*a[0][1]+a[0][2]*a[0][2]),b._invScaleY=Math.sqrt(a[1][0]*a[1][0]+a[1][1]*a[1][1]+a[1][2]*a[1][2]),b._lastBBox=d}}b.animate=function(a,d,c){if(a=g.getGraphDiv(a),!g.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var b=a._transitionData;b._frameQueue||(b._frameQueue=[]);var e=(c=v.supplyAnimationDefaults(c)).transition,f=c.frame;function h(a){return Array.isArray(e)?a>=e.length?e[0]:e[a]:e}function i(a){return Array.isArray(f)?a>=f.length?f[0]:f[a]:f}function j(a,b){var c=0;return function(){if(a&& ++c===b)return a()}}return void 0===b._frameWaitingCnt&&(b._frameWaitingCnt=0),new Promise(function(t,u){var f,l,w=0;function n(a){return Array.isArray(e)?w>=e.length?a.transitionOpts=e[w]:a.transitionOpts=e[0]:a.transitionOpts=e,w++,a}var k=[],p=null==d,q=Array.isArray(d);if(!p&&!q&&g.isPlainObject(d))k.push({type:"object",data:n(g.extendFlat({},d))});else if(p|| -1!==["string","number"].indexOf(typeof d))for(f=0;f<b._frames.length;f++)(l=b._frames[f])&&(p||String(l.group)===String(d))&&k.push({type:"byname",name:String(l.name),data:n({name:l.name})});else if(q)for(f=0;f<d.length;f++){var m=d[f];-1!==["number","string"].indexOf(typeof m)?(m=String(m),k.push({type:"byname",name:m,data:n({name:m})})):g.isPlainObject(m)&&k.push({type:"object",data:n(g.extendFlat({},m))})}for(f=0;f<k.length;f++)if("byname"===(l=k[f]).type&&!b._frameHash[l.data.name]){g.warn('animate failure: frame not found: "'+l.data.name+'"'),u();return}-1!==["next","immediate"].indexOf(c.mode)&&function(){if(0!==b._frameQueue.length){for(;b._frameQueue.length;){var c=b._frameQueue.pop();c.onInterrupt&&c.onInterrupt()}a.emit("plotly_animationinterrupted",[])}}(),"reverse"===c.direction&&k.reverse();var r=a._fullLayout._currentFrame;if(r&&c.fromcurrent){var o=-1;for(f=0;f<k.length;f++)if("byname"===(l=k[f]).type&&l.name===r){o=f;break}if(o>0&&o<k.length-1){var s=[];for(f=0;f<k.length;f++)l=k[f],("byname"!==k[f].type||f>o)&&s.push(l);k=s}}k.length>0?function(e){if(0!==e.length){for(var l,d=0;d<e.length;d++){m="byname"===e[d].type?v.computeFrame(a,e[d].name):e[d].data;var m,k=i(d),f=h(d);f.duration=Math.min(f.duration,k.duration);var g={frame:m,name:e[d].name,frameOpts:k,transitionOpts:f};d===e.length-1&&(g.onComplete=j(t,2),g.onInterrupt=u),b._frameQueue.push(g)}"immediate"===c.mode&&(b._lastFrameAt=-1/0),b._animationRaf||(a.emit("plotly_animating"),b._lastFrameAt=-1/0,b._timeToNext=0,b._runningTransitions=0,b._currentFrame=null,(l=function(){b._animationRaf=window.requestAnimationFrame(l),Date.now()-b._lastFrameAt>b._timeToNext&&function(){b._currentFrame&&b._currentFrame.onComplete&&b._currentFrame.onComplete();var c=b._currentFrame=b._frameQueue.shift();if(c){var d=c.name?c.name.toString():null;a._fullLayout._currentFrame=d,b._lastFrameAt=Date.now(),b._timeToNext=c.frameOpts.duration,v.transition(a,c.frame.data,c.frame.layout,E.coerceTraceIndices(a,c.frame.traces),c.frameOpts,c.transitionOpts).then(function(){c.onComplete&&c.onComplete()}),a.emit("plotly_animatingframe",{name:d,frame:c.frame,animation:{frame:c.frameOpts,transition:c.transitionOpts}})}else a.emit("plotly_animated"),window.cancelAnimationFrame(b._animationRaf),b._animationRaf=null}()})())}}(k):(a.emit("plotly_animated"),t())})},b.addFrames=function(b,c,k){if(b=g.getGraphDiv(b),null==c)return Promise.resolve();if(!g.isPlotDiv(b))throw new Error("This element is not a Plotly plot: "+b+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var a,d,e,o,h=b._transitionData._frames,i=b._transitionData._frameHash;if(!Array.isArray(c))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+c);var t=h.length+2*c.length,j=[],l={};for(a=c.length-1;a>=0;a--)if(g.isPlainObject(c[a])){var m=c[a].name,f=(i[m]||l[m]||{}).name,q=c[a].name,u=i[f]||l[f];f&&q&&"number"==typeof q&&u&&I<5&&(I++,g.warn('addFrames: overwriting frame "'+(i[f]||l[f]).name+'" with a frame whose name of type "number" also equates to "'+f+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===I&&g.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),l[m]={name:m},j.push({frame:v.supplyFrameDefaults(c[a]),index:k&& void 0!==k[a]&&null!==k[a]?k[a]:t+a})}j.sort(function(a,b){return a.index>b.index?-1:a.index<b.index?1:0});var n=[],p=[],r=h.length;for(a=j.length-1;a>=0;a--){if("number"==typeof(d=j[a].frame).name&&g.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!d.name)for(;i[d.name="frame "+b._transitionData._counter++];);if(i[d.name]){for(e=0;e<h.length&&(h[e]||{}).name!==d.name;e++);n.push({type:"replace",index:e,value:d}),p.unshift({type:"replace",index:e,value:h[e]})}else o=Math.max(0,Math.min(j[a].index,r)),n.push({type:"insert",index:o,value:d}),p.unshift({type:"delete",index:o}),r++}var w=v.modifyFrames,x=v.modifyFrames;return s&&s.add(b,w,[b,p],x,[b,n]),v.modifyFrames(b,n)},b.deleteFrames=function(a,c){if(a=g.getGraphDiv(a),!g.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a);var b,d,f=a._transitionData._frames,e=[],h=[];if(!c)for(b=0,c=[];b<f.length;b++)c.push(b);for((c=c.slice()).sort(),b=c.length-1;b>=0;b--)d=c[b],e.push({type:"delete",index:d}),h.unshift({type:"insert",index:d,value:f[d]});var i=v.modifyFrames,j=v.modifyFrames;return s&&s.add(a,i,[a,h],j,[a,e]),v.modifyFrames(a,e)},b.addTraces=j,b.deleteTraces=k,b.extendTraces=h,b.moveTraces=l,b.prependTraces=i,b.newPlot=function(a,c,d,e){return a=g.getGraphDiv(a),v.cleanPlot([],{},a._fullData||[],a._fullLayout||{}),v.purge(a),b._doPlot(a,c,d,e)},b._doPlot=function(a,c,d,m){if(a=g.getGraphDiv(a),r.init(a),g.isPlainObject(c)){var p,i=c;c=i.data,d=i.layout,m=i.config,p=i.frames}if(!1===r.triggerHandler(a,"plotly_beforeplot",[c,d,m]))return Promise.reject();c||d||g.isPlotDiv(a)||g.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",a),M(a,m),d||(d={}),n.select(a).classed("js-plotly-plot",!0),x.makeTester(),Array.isArray(a._promises)||(a._promises=[]);var j=0===(a.data||[]).length&&Array.isArray(c);Array.isArray(c)&&(E.cleanData(c),j?a.data=c:a.data.push.apply(a.data,c),a.empty=!1),(!a.layout||j)&&(a.layout=E.cleanLayout(d)),v.supplyDefaults(a);var f=a._fullLayout,o=f._has("cartesian");f._replotting=!0,(j||f._shouldCreateBgLayer)&&(function(b){var e=n.select(b),a=b._fullLayout;if(a._calcInverseTransform=al,a._calcInverseTransform(b),a._container=e.selectAll(".plot-container").data([0]),a._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),a._paperdiv=a._container.selectAll(".svg-container").data([0]),a._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),a._glcontainer=a._paperdiv.selectAll(".gl-container").data([{}]),a._glcontainer.enter().append("div").classed("gl-container",!0),a._paperdiv.selectAll(".main-svg").remove(),a._paperdiv.select(".modebar-container").remove(),a._paper=a._paperdiv.insert("svg",":first-child").classed("main-svg",!0),a._toppaper=a._paperdiv.append("svg").classed("main-svg",!0),a._modebardiv=a._paperdiv.append("div"),delete a._modeBar,a._hoverpaper=a._paperdiv.append("svg").classed("main-svg",!0),!a._uid){var f={};n.selectAll("defs").each(function(){this.id&&(f[this.id.split("-")[1]]=1)}),a._uid=g.randstr(f)}a._paperdiv.selectAll(".main-svg").attr(A.svgAttrs),a._defs=a._paper.append("defs").attr("id","defs-"+a._uid),a._clips=a._defs.append("g").classed("clips",!0),a._topdefs=a._toppaper.append("defs").attr("id","topdefs-"+a._uid),a._topclips=a._topdefs.append("g").classed("clips",!0),a._bgLayer=a._paper.append("g").classed("bglayer",!0),a._draggers=a._paper.append("g").classed("draglayer",!0);var c=a._paper.append("g").classed("layer-below",!0);a._imageLowerLayer=c.append("g").classed("imagelayer",!0),a._shapeLowerLayer=c.append("g").classed("shapelayer",!0),a._cartesianlayer=a._paper.append("g").classed("cartesianlayer",!0),a._polarlayer=a._paper.append("g").classed("polarlayer",!0),a._smithlayer=a._paper.append("g").classed("smithlayer",!0),a._ternarylayer=a._paper.append("g").classed("ternarylayer",!0),a._geolayer=a._paper.append("g").classed("geolayer",!0),a._funnelarealayer=a._paper.append("g").classed("funnelarealayer",!0),a._pielayer=a._paper.append("g").classed("pielayer",!0),a._iciclelayer=a._paper.append("g").classed("iciclelayer",!0),a._treemaplayer=a._paper.append("g").classed("treemaplayer",!0),a._sunburstlayer=a._paper.append("g").classed("sunburstlayer",!0),a._indicatorlayer=a._toppaper.append("g").classed("indicatorlayer",!0),a._glimages=a._paper.append("g").classed("glimages",!0);var d=a._toppaper.append("g").classed("layer-above",!0);a._imageUpperLayer=d.append("g").classed("imagelayer",!0),a._shapeUpperLayer=d.append("g").classed("shapelayer",!0),a._selectionLayer=a._toppaper.append("g").classed("selectionlayer",!0),a._infolayer=a._toppaper.append("g").classed("infolayer",!0),a._menulayer=a._toppaper.append("g").classed("menulayer",!0),a._zoomlayer=a._toppaper.append("g").classed("zoomlayer",!0),a._hoverlayer=a._hoverpaper.append("g").classed("hoverlayer",!0),a._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),b.emit("plotly_framework")}(a),f._shouldCreateBgLayer&&delete f._shouldCreateBgLayer),x.initGradients(a),x.initPatterns(a),j&&w.saveShowSpikeInitial(a);var q=!a.calcdata||a.calcdata.length!==(a._fullData||[]).length;q&&v.doCalcdata(a);for(var k=0;k<a.calcdata.length;k++)a.calcdata[k][0].trace=a._fullData[k];a._context.responsive?a._responsiveChartHandler||(a._responsiveChartHandler=function(){g.isHidden(a)||v.resize(a)},window.addEventListener("resize",a._responsiveChartHandler)):g.clearResponsive(a);var y=g.extendFlat({},f._size),B=0;function s(){for(var d=f._basePlotModules,b=0;b<d.length;b++)d[b].drawFramework&&d[b].drawFramework(a);!f._glcanvas&&f._has("gl")&&(f._glcanvas=f._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(a){return a.key}),f._glcanvas.enter().append("canvas").attr("class",function(a){return"gl-canvas gl-canvas-"+a.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var c=a._context.plotGlPixelRatio;if(f._glcanvas){f._glcanvas.attr("width",f.width*c).attr("height",f.height*c).style("width",f.width+"px").style("height",f.height+"px");var e=f._glcanvas.data()[0].regl;if(e&&(Math.floor(f.width*c)!==e._gl.drawingBufferWidth||Math.floor(f.height*c)!==e._gl.drawingBufferHeight)){var h="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!B)return g.log(h+" Clearing graph and plotting again."),v.cleanPlot([],{},a._fullData,f),v.supplyDefaults(a),f=a._fullLayout,v.doCalcdata(a),B++,s();g.error(h)}}return"h"===f.modebar.orientation?f._modebardiv.style("height",null).style("width","100%"):f._modebardiv.style("width",null).style("height",f.height+"px"),v.previousPromises(a)}function u(){if(v.clearAutoMarginIds(a),F.drawMarginPushers(a),w.allowAutoMargin(a),f._has("pie"))for(var d=a._fullData,b=0;b<d.length;b++){var c=d[b];"pie"===c.type&&c.automargin&&v.allowAutoMargin(a,"pie."+c.uid+".automargin")}return v.doAutoMargin(a),v.previousPromises(a)}function C(){a._transitioning||(F.doAutoRangeAndConstraints(a),j&&w.saveRangeInitial(a),t.getComponentMethod("rangeslider","calcAutorange")(a))}var h=[v.previousPromises,function(){if(p)return b.addFrames(a,p)},s,u,function(){if(v.didMarginChange(y,f._size))return g.syncOrAsync([u,F.layoutStyles],a)}];o&&h.push(function(){if(!q){C();return}return g.syncOrAsync([t.getComponentMethod("shapes","calcAutorange"),t.getComponentMethod("annotations","calcAutorange"),C],a)}),h.push(F.layoutStyles),o&&h.push(function(){return w.draw(a,j?"":"redraw")},function(a){a._fullLayout._insideTickLabelsAutorange&&e(a,a._fullLayout._insideTickLabelsAutorange).then(function(){a._fullLayout._insideTickLabelsAutorange=void 0})}),h.push(F.drawData,F.finalDraw,z,v.addLinks,v.rehover,v.redrag,v.reselect,v.doAutoMargin,function(a){a._fullLayout._insideTickLabelsAutorange&&j&&w.saveRangeInitial(a,!0)},v.previousPromises);var l=g.syncOrAsync(h,a);return l&&l.then||(l=Promise.resolve()),l.then(function(){return J(a),a})},b.purge=function(a){var b=(a=g.getGraphDiv(a))._fullLayout||{},c=a._fullData||[];return v.cleanPlot([],{},c,b),v.purge(a),r.purge(a),b._container&&b._container.remove(),delete a._context,a},b.react=function(a,h,n,k){a=g.getGraphDiv(a),E.clearPromiseQueue(a);var z,i,o=a._fullData,p=a._fullLayout;if(g.isPlotDiv(a)&&o&&p){if(g.isPlainObject(h)){var A,B,C,D,r,e,l=h;h=l.data,n=l.layout,k=l.config,z=l.frames}var s=!1;if(k){var T=g.extendDeep({},a._context);a._context=void 0,M(a,k),s=ak(T,a._context)}a.data=h||[],E.cleanData(a.data),a.layout=n||{},E.cleanLayout(a.layout),function(t,b,u,c){var d=c._preGUI,l=[],m={},v={};for(a in d){if(j=ae(a,ac)){if(G=j.head,H=j.tail,F=j.attr||G+".uirevision",o=q(c,F).get(),h=o&&af(F,b),h&&h===o){if(null===(p=d[a])&&(p=void 0),ai(E=(z=q(b,a)).get(),p)){void 0===E&&"autorange"===H&&l.push(G),z.set(S(q(c,a).get()));continue}if("autorange"===H||"range["===H.substr(0,6)){var C=d[G+".range[0]"],D=d[G+".range[1]"],w=d[G+".autorange"];if(w||null===w&&null===C&&null===D){if(!(G in m)){var f=q(b,G).get();m[G]=f&&(f.autorange|| !1!==f.autorange&&(!f.range||2!==f.range.length))}if(m[G]){z.set(S(q(c,a).get()));continue}}}}}else g.warn("unrecognized GUI edit: "+a);delete d[a],j&&"range["===j.tail.substr(0,6)&&(v[j.head]=1)}for(var n=0;n<l.length;n++){var x=l[n];if(v[x]){var y=q(b,x).get();y&&delete y.autorange}}var i=c._tracePreGUI;for(var e in i){var a,F,o,h,j,p,z,E,G,H,r,s=i[e],k=null;for(a in s){if(!k){var A=ag(e,u);if(A<0){delete i[e];break}var B=ah(e,t,(r=u[A]._fullInput).index);if(B<0){delete i[e];break}k=t[B]}if(j=ae(a,ad)){if(j.attr?h=(o=q(c,j.attr).get())&&af(j.attr,b):(o=r.uirevision,void 0===(h=k.uirevision)&&(h=b.uirevision)),h&&h===o&&(null===(p=s[a])&&(p=void 0),ai(E=(z=q(k,a)).get(),p))){z.set(S(q(r,a).get()));continue}}else g.warn("unrecognized GUI edit: "+a+" in trace uid "+e);delete s[a]}}}(a.data,a.layout,o,p),v.supplyDefaults(a,{skipUpdateCalc:!0});var H=a._fullData,f=a._fullLayout,I=void 0===f.datarevision,K=f.transition,d=(A=a,B=p,C=f,D=I,r=K,(e=G.layoutFlags()).arrays={},e.rangesAltered={},e.nChanges=0,e.nChangesAnim=0,aj(B,C,[],{getValObject:function(a){return u.getLayoutValObject(C,a)},flags:e,immutable:D,transition:r,gd:A}),(e.plot||e.calc)&&(e.layoutReplot=!0),r&&e.nChanges&&e.nChangesAnim&&(e.anim=e.nChanges===e.nChangesAnim?"all":"some"),e),j=function(i,e,d,j,f,k){var b,c,g=e.length===d.length;if(!f&&!g)return{fullReplot:!0,calc:!0};var a=G.traceFlags();a.arrays={},a.nChanges=0,a.nChangesAnim=0;var l={getValObject:function(b){var a=u.getTraceValObject(c,b);return!c._module.animatable&&a.anim&&(a.anim=!1),a},flags:a,immutable:j,transition:f,newDataRevision:k,gd:i},h={};for(b=0;b<e.length;b++)if(d[b]){if(c=d[b]._fullInput,v.hasMakesDataTransform(c)&&(c=d[b]),h[c.uid])continue;h[c.uid]=1,aj(e[b]._fullInput,c,[],l)}return(a.calc||a.plot)&&(a.fullReplot=!0),f&&a.nChanges&&a.nChangesAnim&&(a.anim=a.nChanges===a.nChangesAnim&&g?"all":"some"),a}(a,o,H,I,K,d.newDataRevision);if(ab(a)&&(d.layoutReplot=!0),j.calc||d.calc){a.calcdata=void 0;for(var L=Object.getOwnPropertyNames(f),w=0;w<L.length;w++){var N=L[w],O=N.substring(0,5);if("xaxis"===O||"yaxis"===O){var P=f[N]._emptyCategories;P&&P()}}}else v.supplyDefaultsUpdateCalc(a.calcdata,H);var c=[];if(z&&(a._transitionData={},v.createTransitionData(a),c.push(function(){return b.addFrames(a,z)})),f.transition&&!s&&(j.anim||d.anim))d.ticks&&c.push(F.doTicksRelayout),v.doCalcdata(a),F.doAutoRangeAndConstraints(a),c.push(function(){return v.transitionFromReact(a,j,d,p)});else if(j.fullReplot||d.layoutReplot||s)a._fullLayout._skipDefaults=!0,c.push(b._doPlot);else{for(var m in d.arrays){var x=d.arrays[m];if(x.length){var Q=t.getComponentMethod(m,"drawOne");if(Q!==g.noop)for(var y=0;y<x.length;y++)Q(a,x[y]);else{var R=t.getComponentMethod(m,"draw");if(R===g.noop)throw new Error("cannot draw components: "+m);R(a)}}}c.push(v.previousPromises),j.style&&c.push(F.doTraceStyle),(j.colorbars||d.colorbars)&&c.push(F.doColorBars),d.legend&&c.push(F.doLegend),d.layoutstyle&&c.push(F.layoutStyles),d.axrange&&Y(c),d.ticks&&c.push(F.doTicksRelayout),d.modebar&&c.push(F.doModeBar),d.camera&&c.push(F.doCamera),c.push(J)}c.push(v.rehover,v.redrag,v.reselect),(i=g.syncOrAsync(c,a))&&i.then||(i=Promise.resolve(a))}else i=b.newPlot(a,h,n,k);return i.then(function(){return a.emit("plotly_react",{data:h,layout:n}),a})},b.redraw=function(a){if(a=g.getGraphDiv(a),!g.isPlotDiv(a))throw new Error("This element is not a Plotly plot: "+a);return E.cleanData(a.data),E.cleanLayout(a.layout),a.calcdata=void 0,b._doPlot(a).then(function(){return a.emit("plotly_redraw"),a})},b.relayout=e,b.restyle=d,b.setPlotConfig=function(a){return g.extendFlat(C,a)},b.update=f,b._guiRelayout=c(e),b._guiRestyle=c(d),b._guiUpdate=c(f),b._storeDirectGUIEdit=function(c,d,b){for(var a in b){var e=q(c,a);U(a,e.get(),b[a],d)}}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(e,c,f){"use strict";var a={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},b={};function d(e,b){for(var a in e){var c=e[a];c.valType?b[a]=c.dflt:(b[a]||(b[a]={}),d(c,b[a]))}}d(a,b),c.exports={configAttributes:a,dfltConfig:b}},{}],554:[function(b,h,a){"use strict";var i=b("../registry"),c=b("../lib"),j=b("../plots/attributes"),k=b("../plots/layout_attributes"),l=b("../plots/frame_attributes"),m=b("../plots/animation_attributes"),n=b("./plot_config").configAttributes,o=b("./edit_types"),p=c.extendDeepAll,q=c.isPlainObject,r=c.isArrayOrTypedArray,s=c.nestedProperty,t=c.valObjectMeta,d="_isSubplotObj",e="_isLinkedToArray",f="_deprecated",g=[d,e,"_arrayAttrRegexps",f];function u(b,c,a){if(!b)return!1;if(b._isLinkedToArray){if(v(c[a]))a++;else if(a<c.length)return!1}for(;a<c.length;a++){var f=b[c[a]];if(q(f))b=f;else break;if(a===c.length-1)break;if(b._isLinkedToArray){if(a++,!v(c[a]))return!1}else if("info_array"===b.valType){a++;var e=c[a];if(!v(e))return!1;var d=b.items;if(Array.isArray(d)){if(e>=d.length)return!1;if(2===b.dimensions){if(a++,c.length===a)return b;var g=c[a];if(!v(g))return!1;b=d[e][g]}else b=d[e]}else b=d}}return b}function v(a){return a===Math.round(a)&&a>=0}function w(a){return x(a),y(a),z(a),a}function x(b){a.crawl(b,function(b,c,d){a.isValObject(b)?(!0===b.arrayOk||"data_array"===b.valType)&&(d[c+"src"]={valType:"string",editType:"none"}):q(b)&&(b.role="object")})}function y(b){a.crawl(b,function(a,b,c){if(a){var d=a[e];d&&(delete a[e],c[b]={items:{}},c[b].items[d]=a,c[b].role="object")}})}function z(a){function b(a){for(var c in a)if(q(a[c]))b(a[c]);else if(Array.isArray(a[c]))for(var d=0;d<a[c].length;d++)b(a[c][d]);else a[c]instanceof RegExp&&(a[c]=a[c].toString())}b(a)}function A(b,c,e){var f=s(b,e),a=p({},c.layoutAttributes);a[d]=!0,f.set(a)}function B(b,c,d){var a=s(b,d);a.set(p(a.get()||{},c))}a.IS_SUBPLOT_OBJ=d,a.IS_LINKED_TO_ARRAY=e,a.DEPRECATED=f,a.UNDERSCORE_ATTRS=g,a.get=function(){var c={};i.allTypes.forEach(function(b){c[b]=function(d){f=(c=i.modules[d]._module).basePlotModule;var c,f,b={};b.type=null;var k=p({},j),g=p({},c.attributes);a.crawl(g,function(b,c,d,e,a){s(k,a).set(void 0),void 0===b&&s(g,a).set(void 0)}),p(b,k),i.traceIs(d,"noOpacity")&&delete b.opacity,i.traceIs(d,"showLegend")||(delete b.showlegend,delete b.legendgroup),i.traceIs(d,"noHover")&&(delete b.hoverinfo,delete b.hoverlabel),c.selectPoints||delete b.selectedpoints,p(b,g),f.attributes&&p(b,f.attributes),b.type=d;var e={meta:c.meta||{},categories:c.categories||{},animatable:Boolean(c.animatable),type:d,attributes:w(b)};if(c.layoutAttributes){var h={};p(h,c.layoutAttributes),e.layoutAttributes=w(h)}return c.animatable||a.crawl(e,function(b){a.isValObject(b)&&"anim"in b&&delete b.anim}),e}(b)});var b,d={};return Object.keys(i.transformsRegistry).forEach(function(a){var b,c;d[a]=(b=a,c=p({},i.transformsRegistry[b].attributes),Object.keys(i.componentsRegistry).forEach(function(d){var a=i.componentsRegistry[d];a.schema&&a.schema.transforms&&a.schema.transforms[b]&&Object.keys(a.schema.transforms[b]).forEach(function(d){B(c,a.schema.transforms[b][d],d)})}),{attributes:w(c)})}),{defs:{valObjects:t,metaKeys:g.concat(["description","role","editType","impliedEdits"]),editType:{traces:o.traces,layout:o.layout},impliedEdits:{}},traces:c,layout:function(){var c,a,b={};for(c in p(b,k),i.subplotsRegistry)if((a=i.subplotsRegistry[c]).layoutAttributes)if(Array.isArray(a.attr))for(var f=0;f<a.attr.length;f++)A(b,a,a.attr[f]);else{var g="subplot"===a.attr?a.name:a.attr;A(b,a,g)}for(c in i.componentsRegistry){var d=(a=i.componentsRegistry[c]).schema;if(d&&(d.subplots||d.layout)){var e=d.subplots;if(e&&e.xaxis&&!e.yaxis)for(var h in e.xaxis)delete b.yaxis[h]}else"colorscale"===a.name?p(b,a.layoutAttributes):a.layoutAttributes&&B(b,a.layoutAttributes,a.name)}return{layoutAttributes:w(b)}}(),transforms:d,frames:(w(b={frames:p({},l)}),b.frames),animation:w(m),config:w(n)}},a.crawl=function(c,e,d,b){var f=d||0;b=b||"",Object.keys(c).forEach(function(d){var h=c[d];if(-1===g.indexOf(d)){var i=(b?b+".":"")+d;e(h,d,c,f,i),!a.isValObject(h)&&q(h)&&"impliedEdits"!==d&&a.crawl(h,e,f+1,i)}})},a.isValObject=function(a){return a&& void 0!==a.valType},a.findArrayAttributes=function(b){var f,g,k=[],l=[],m=[];function d(a,b,e,c){l=l.slice(0,c).concat([b]),m=m.slice(0,c).concat([a&&a._isLinkedToArray]);var d=a&&("data_array"===a.valType|| !0===a.arrayOk)&&!("colorbar"===l[c-1]&&("ticktext"===b||"tickvals"===b));d&&n(f,0,"")}function n(e,b,f){var a=e[l[b]],d=f+l[b];if(b===l.length-1)r(a)&&k.push(g+d);else if(m[b]){if(Array.isArray(a))for(var c=0;c<a.length;c++)q(a[c])&&n(a[c],b+1,d+"["+c+"].")}else q(a)&&n(a,b+1,d+".")}f=b,g="",a.crawl(j,d),b._module&&b._module.attributes&&a.crawl(b._module.attributes,d);var e=b.transforms;if(e)for(var c=0;c<e.length;c++){var h=e[c],i=h._module;i&&(g="transforms["+c+"].",f=h,a.crawl(i.attributes,d))}return k},a.getTraceValObject=function(g,b){var d,a,e=b[0],l=1;if("transforms"===e){if(1===b.length)return j.transforms;var f=g.transforms;if(!Array.isArray(f)||!f.length)return!1;var h=b[1];if(!v(h)||h>=f.length)return!1;a=(d=(i.transformsRegistry[f[h].type]||{}).attributes)&&d[b[2]],l=3}else{var c=g._module;if(c||(c=(i.modules[g.type||j.type.dflt]||{})._module),!c)return!1;if(!(a=(d=c.attributes)&&d[e])){var k=c.basePlotModule;k&&k.attributes&&(a=k.attributes[e])}a||(a=j[e])}return u(a,b,l)},a.getLayoutValObject=function(b,a){return u(function(j,b){var c,l,a,e,d,f=j._basePlotModules;if(f){for(c=0;c<f.length;c++){if((a=f[c]).attrRegex&&a.attrRegex.test(b)){if(a.layoutAttrOverrides)return a.layoutAttrOverrides;!d&&a.layoutAttributes&&(d=a.layoutAttributes)}var g=a.baseLayoutAttrOverrides;if(g&&b in g)return g[b]}if(d)return d}var h=j._modules;if(h){for(c=0;c<h.length;c++)if((e=h[c].layoutAttributes)&&b in e)return e[b]}for(l in i.componentsRegistry){if("colorscale"===(a=i.componentsRegistry[l]).name&&0===b.indexOf("coloraxis"))return a.layoutAttributes[b];if(!a.schema&&b===a.name)return a.layoutAttributes}return b in k&&k[b]}(b,a[0]),a,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(b,f,a){"use strict";var g=b("../lib"),h=b("../plots/attributes"),c="templateitemname",d={name:{valType:"string",editType:"none"}};function i(a){return a&&"string"==typeof a}function e(a){var b=a.length-1;return"s"!==a.charAt(b)&&g.warn("bad argument to arrayDefaultKey: "+a),a.substr(0,a.length-1)+"defaults"}d[c]={valType:"string",editType:"calc"},a.templatedArray=function(b,a){return a._isLinkedToArray=b,a.name=d.name,a[c]=d[c],a},a.traceTemplater=function(c){var a,b,d={};for(a in c)b=c[a],Array.isArray(b)&&b.length&&(d[a]=0);return{newTrace:function(f){var e={type:a=g.coerce(f,{},h,"type"),_template:null};if(a in d){b=c[a];var i=d[a]%b.length;d[a]++,e._template=b[i]}return e}}},a.newContainer=function(c,d,e){var a=c._template,b=a&&(a[d]||e&&a[e]);return g.isPlainObject(b)||(b=null),c[d]={_template:b}},a.arrayTemplater=function(f,d,g){var a=f._template,h=a&&a[e(d)],b=a&&a[d];Array.isArray(b)&&b.length||(b=[]);var j={};return{newItem:function(d){var a={name:d.name,_input:d},e=a[c]=d[c];if(!i(e))return a._template=h,a;for(var f=0;f<b.length;f++){var k=b[f];if(k.name===e)return j[e]=1,a._template=k,a}return a[g]=d[g]||!1,a._template=!1,a},defaultItems:function(){for(var f=[],d=0;d<b.length;d++){var e=b[d],a=e.name;if(i(a)&&!j[a]){var g={_template:e,name:a,_input:{_templateitemname:a}};g[c]=e[c],f.push(g),j[a]=1}}return f}}},a.arrayDefaultKey=e,a.arrayEditor=function(f,b,d){var l,e=(g.nestedProperty(f,b).get()||[]).length,a=d._index,h=a>=e&&(d._input||{})._templateitemname;h&&(a=e);var m=b+"["+a+"]";function i(){l={},h&&(l[m]={},l[m][c]=h)}function j(a,b){h?g.nestedProperty(l[m],a).set(b):l[m+"."+a]=b}function k(){var a=l;return i(),a}return i(),{modifyBase:function(a,b){l[a]=b},modifyItem:j,getUpdateObj:k,applyUpdate:function(a,d){a&&j(a,d);var b=k();for(var c in b)g.nestedProperty(f,c).set(b[c])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(b,d,a){"use strict";var e=b("@plotly/d3"),f=b("../registry"),g=b("../plots/plots"),h=b("../lib"),i=b("../lib/clear_gl_canvases"),j=b("../components/color"),k=b("../components/drawing"),l=b("../components/titles"),m=b("../components/modebar"),n=b("../plots/cartesian/axes"),o=b("../constants/alignment"),c=b("../plots/cartesian/constraints"),p=c.enforce,q=c.clean,r=b("../plots/cartesian/autorange").doAutoRange,s="start";function t(c,d,b){for(var a=0;a<b.length;a++){var e=b[a][0],f=b[a][1];if(!(e[0]>=c[1])&&!(e[1]<=c[0])&&f[0]<d[1]&&f[1]>d[0])return!0}return!1}function u(f){var V,W,w,y,z,A,X,Y,B,C,N,O,q,d=f._fullLayout,Z=d._size,p=Z.p,r=n.list(f,"",!0);if(d._paperdiv.style({width:f._context.responsive&&d.autosize&&!f._context._hasZeroWidth&&!f.layout.width?"100%":d.width+"px",height:f._context.responsive&&d.autosize&&!f._context._hasZeroHeight&&!f.layout.height?"100%":d.height+"px"}).selectAll(".main-svg").call(k.setSize,d.width,d.height),f._context.setBackground(f,d.paper_bgcolor),a.drawMainTitle(f),m.manage(f),!d._has("cartesian"))return g.previousPromises(f);function s(c,a,d){var b=c._lw/2;return"x"===c._id.charAt(0)?a?"top"===d?a._offset-p-b:a._offset+a._length+p+b:Z.t+Z.h*(1-(c.position||0))+b%1:a?"right"===d?a._offset+a._length+p+b:a._offset-p-b:Z.l+Z.w*(c.position||0)+b%1}for(ad=0;ad<r.length;ad++){var D=(ae=r[ad])._anchorAxis;ae._linepositions={},ae._lw=k.crispRound(f,ae.linewidth,1),ae._mainLinePosition=s(ae,D,ae.side),ae._mainMirrorPosition=ae.mirror&&D?s(ae,D,o.OPPOSITE_SIDE[ae.side]):null}var P=[],u=[],Q=[],$=1===j.opacity(d.paper_bgcolor)&&1===j.opacity(d.plot_bgcolor)&&d.paper_bgcolor===d.plot_bgcolor;for(l in d._plots)if((i=d._plots[l]).mainplot)i.bg&&i.bg.remove(),i.bg=void 0;else{var R=i.xaxis.domain,S=i.yaxis.domain,E=i.plotgroup;if(t(R,S,Q)){var T=E.node(),_=i.bg=h.ensureSingle(E,"rect","bg");T.insertBefore(_.node(),T.childNodes[0]),u.push(l)}else E.select("rect.bg").remove(),Q.push([R,S]),$||(P.push(l),u.push(l))}var F=d._bgLayer.selectAll(".bg").data(P);for(F.enter().append("rect").classed("bg",!0),F.exit().remove(),F.each(function(a){d._plots[a].bg=e.select(this)}),ad=0;ad<u.length;ad++)b=(i=d._plots[u[ad]]).xaxis,c=i.yaxis,i.bg&& void 0!==b._offset&& void 0!==c._offset&&i.bg.call(k.setRect,b._offset-p,c._offset-p,b._length+2*p,c._length+2*p).call(j.fill,d.plot_bgcolor).style("stroke-width",0);if(!d._hasOnlyLargeSploms)for(l in d._plots){b=(i=d._plots[l]).xaxis,c=i.yaxis;var ad,l,i,ae,b,c,G,H,I=i.clipId="clip"+d._uid+l+"plot",aa=h.ensureSingleById(d._clips,"clipPath",I,function(a){a.classed("plotclip",!0).append("rect")});i.clipRect=aa.select("rect").attr({width:b._length,height:c._length}),k.setTranslate(i.plot,b._offset,c._offset),i._hasClipOnAxisFalse?(G=null,H=I):(G=I,H=null),k.setClipUrl(i.plot,G,f),i.layerClipId=H}function J(a){return"M"+V+","+a+"H"+W}function ab(a){return"M"+b._offset+","+a+"h"+b._length}function K(a){return"M"+a+","+Y+"V"+X}function ac(a){return"M"+a+","+c._offset+"v"+c._length}function U(a,b,d){if(!a.showline||l!==a._mainSubplot)return"";if(!a._anchorAxis)return d(a._mainLinePosition);var c=b(a._mainLinePosition);return a.mirror&&(c+=b(a._mainMirrorPosition)),c}for(l in d._plots){b=(i=d._plots[l]).xaxis,c=i.yaxis;var L="M0,0";v(b,l)&&(z=x(b,"left",c,r),V=b._offset-(z?p+z:0),A=x(b,"right",c,r),W=b._offset+b._length+(A?p+A:0),w=s(b,c,"bottom"),y=s(b,c,"top"),q=!b._anchorAxis||l!==b._mainSubplot,q&&("allticks"===b.mirror||"all"===b.mirror)&&(b._linepositions[l]=[w,y]),L=U(b,J,ab),q&&b.showline&&("all"===b.mirror||"allticks"===b.mirror)&&(L+=J(w)+J(y)),i.xlines.style("stroke-width",b._lw+"px").call(j.stroke,b.showline?b.linecolor:"rgba(0,0,0,0)")),i.xlines.attr("d",L);var M="M0,0";v(c,l)&&(N=x(c,"bottom",b,r),X=c._offset+c._length+(N?p:0),O=x(c,"top",b,r),Y=c._offset-(O?p:0),B=s(c,b,"left"),C=s(c,b,"right"),q=!c._anchorAxis||l!==c._mainSubplot,q&&("allticks"===c.mirror||"all"===c.mirror)&&(c._linepositions[l]=[B,C]),M=U(c,K,ac),q&&c.showline&&("all"===c.mirror||"allticks"===c.mirror)&&(M+=K(B)+K(C)),i.ylines.style("stroke-width",c._lw+"px").call(j.stroke,c.showline?c.linecolor:"rgba(0,0,0,0)")),i.ylines.attr("d",M)}return n.makeClipPaths(f),g.previousPromises(f)}function v(a,b){return(a.ticks||a.showline)&&(b===a._mainSubplot||"all"===a.mirror||"allticks"===a.mirror)}function w(d,e,a){if(!a.showline||!a._lw)return!1;if("all"===a.mirror||"allticks"===a.mirror)return!0;var c=a._anchorAxis;if(!c)return!1;var b=o.FROM_BL[e];return a.side===e?c.domain[b]===d.domain[b]:a.mirror&&c.domain[1-b]===d.domain[1-b]}function x(d,e,a,f){if(w(d,e,a))return a._lw;for(var b=0;b<f.length;b++){var c=f[b];if(c._mainAxis===a._mainAxis&&w(d,e,c))return c._lw}return 0}a.layoutStyles=function(a){return h.syncOrAsync([g.doAutoMargin,u],a)},a.drawMainTitle=function(f){var d,b,e,c,a=f._fullLayout,g=(d=a.title,b="middle",h.isRightAnchor(d)?b="end":h.isLeftAnchor(d)&&(b=s),b),i=(e=a.title,c="0em",h.isTopAnchor(e)?c=o.CAP_SHIFT+"em":h.isMiddleAnchor(e)&&(c=o.MID_SHIFT+"em"),c);l.draw(f,"gtitle",{propContainer:a,propName:"title.text",placeholder:a._dfltTitle.plot,attributes:{x:function(c,d){var a=c.title,e=c._size,b=0;switch(d===s?b=a.pad.l:"end"===d&&(b=-a.pad.r),a.xref){case"paper":return e.l+e.w*a.x+b;case"container":default:return c.width*a.x+b}}(a,g),y:function(b,e){var a=b.title,c=b._size,d=0;if("0em"!==e&&e?e===o.CAP_SHIFT+"em"&&(d=a.pad.t):d=-a.pad.b,"auto"===a.y)return c.t/2;switch(a.yref){case"paper":return c.t+c.h-c.h*a.y+d;case"container":default:return b.height-b.height*a.y+d}}(a,i),"text-anchor":g,dy:i}})},a.doTraceStyle=function(c){var b,e=c.calcdata,d=[];for(b=0;b<e.length;b++){var h=e[b],j=h[0]||{},k=j.trace||{},l=k._module||{},m=l.arraysToCalcdata;m&&m(h,k);var n=l.editStyle;n&&d.push({fn:n,cd0:j})}if(d.length){for(b=0;b<d.length;b++){var o=d[b];o.fn(c,o.cd0)}i(c),a.redrawReglTraces(c)}return g.style(c),f.getComponentMethod("legend","draw")(c),g.previousPromises(c)},a.doColorBars=function(a){return f.getComponentMethod("colorbar","draw")(a),g.previousPromises(a)},a.layoutReplot=function(a){var b=a.layout;return a.layout=void 0,f.call("_doPlot",a,"",b)},a.doLegend=function(a){return f.getComponentMethod("legend","draw")(a),g.previousPromises(a)},a.doTicksRelayout=function(b){return n.draw(b,"redraw"),b._fullLayout._hasOnlyLargeSploms&&(f.subplotsRegistry.splom.updateGrid(b),i(b),a.redrawReglTraces(b)),a.drawMainTitle(b),g.previousPromises(b)},a.doModeBar=function(a){var c=a._fullLayout;m.manage(a);for(var b=0;b<c._basePlotModules.length;b++){var d=c._basePlotModules[b].updateFx;d&&d(a)}return g.previousPromises(a)},a.doCamera=function(e){for(var b=e._fullLayout,c=b._subplots.gl3d,a=0;a<c.length;a++){var d=b[c[a]];d._scene.setViewport(d)}},a.drawData=function(b){var d=b._fullLayout;i(b);for(var e=d._basePlotModules,c=0;c<e.length;c++)e[c].plot(b);return a.redrawReglTraces(b),g.style(b),f.getComponentMethod("selections","draw")(b),f.getComponentMethod("shapes","draw")(b),f.getComponentMethod("annotations","draw")(b),f.getComponentMethod("images","draw")(b),d._replotting=!1,g.previousPromises(b)},a.redrawReglTraces=function(g){var c=g._fullLayout;if(c._has("regl")){var a,d,i=g._fullData,e=[],f=[];for(c._hasOnlyLargeSploms&&c._splomGrid.draw(),a=0;a<i.length;a++){var b=i[a];!0===b.visible&&0!==b._length&&("splom"===b.type?c._splomScenes[b.uid].draw():"scattergl"===b.type?h.pushUnique(e,b.xaxis+b.yaxis):"scatterpolargl"===b.type&&h.pushUnique(f,b.subplot))}for(a=0;a<e.length;a++)(d=c._plots[e[a]])._scene&&d._scene.draw();for(a=0;a<f.length;a++)(d=c[f[a]]._subplot)._scene&&d._scene.draw()}},a.doAutoRangeAndConstraints=function(a){for(var b,e=n.list(a,"",!0),c={},d=0;d<e.length;d++)if(!c[(b=e[d])._id]){c[b._id]=1,q(a,b),r(a,b);var f=b._matchGroup;if(f)for(var g in f){var h=n.getFromId(a,g);r(a,h,b.range),c[g]=1}}p(a)},a.finalDraw=function(a){f.getComponentMethod("rangeslider","draw")(a),f.getComponentMethod("rangeselector","draw")(a)},a.drawMarginPushers=function(a){f.getComponentMethod("legend","draw")(a),f.getComponentMethod("rangeselector","draw")(a),f.getComponentMethod("sliders","draw")(a),f.getComponentMethod("updatemenus","draw")(a),f.getComponentMethod("colorbar","draw")(a)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(a,d,b){"use strict";var c=a("../lib"),e=c.isPlainObject,f=a("./plot_schema"),g=a("../plots/plots"),h=a("../plots/attributes"),i=a("./plot_template"),j=a("./plot_config").dfltConfig;function k(b,d){b=c.extendDeep({},b);var f,o,j=Object.keys(b).sort();function m(c,a,j){if(e(a)&&e(c))k(c,a);else if(Array.isArray(a)&&Array.isArray(c)){var d=i.arrayTemplater({_template:b},j);for(o=0;o<a.length;o++){var f=a[o],g=d.newItem(f)._template;g&&k(g,f)}var h=d.defaultItems();for(o=0;o<h.length;o++)a.push(h[o]._template);for(o=0;o<a.length;o++)delete a[o].templateitemname}}for(f=0;f<j.length;f++){var a=j[f],h=b[a];if(a in d?m(h,d[a],a):d[a]=h,l(a)===a)for(var g in d){var n=l(g);g===n||n!==a||g in b||m(h,d[g],a)}}}function l(a){return a.replace(/[0-9]+$/,"")}function m(d,f,g,t,n){var u=n&&g(n);for(var h in d){var a=d[h],o=p(d,h,t),j=p(d,h,n),b=g(j);if(!b){var v=l(h);v!==h&&(b=g(j=p(d,v,n)))}if(!u||u!==b){if(!b||b._noTemplating||"data_array"===b.valType||b.arrayOk&&Array.isArray(a))continue;if(!b.valType&&e(a))m(a,f,g,o,j);else if(b._isLinkedToArray&&Array.isArray(a))for(var w=!1,k=0,x={},r=0;r<a.length;r++){var q=a[r];if(e(q)){var s=q.name;if(s)x[s]||(m(q,f,g,p(a,k,o),p(a,k,j)),k++,x[s]=1);else if(!w){var A=p(d,i.arrayDefaultKey(h),t),y=p(a,k,o);m(q,f,g,y,p(a,k,j));var z=c.nestedProperty(f,y),B=c.nestedProperty(f,A);B.set(z.get()),z.set(null),w=!0}}}else c.nestedProperty(f,o).set(a)}}}function n(a,b){return f.getLayoutValObject(a,c.nestedProperty({},b).parts)}function o(a,b){return f.getTraceValObject(a,c.nestedProperty({},b).parts)}function p(c,a,b){return b?Array.isArray(c)?b+"["+a+"]":b+"."+a:a}function q(b){for(var a=0;a<b.length;a++)if(e(b[a]))return!0}function r(a){var b;switch(a.code){case"data":b="The template has no key data.";break;case"layout":b="The template has no key layout.";break;case"missing":b=a.path?"There are no templates for item "+a.path+" with name "+a.templateitemname:"There are no templates for trace "+a.index+", of type "+a.traceType+".";break;case"unused":b=a.path?"The template item at "+a.path+" was not used in constructing the plot.":a.dataCount?"Some of the templates of type "+a.traceType+" were not used. The template has "+a.templateCount+" traces, the data only has "+a.dataCount+" of this type.":"The template has "+a.templateCount+" traces of type "+a.traceType+" but there are none in the data.";break;case"reused":b="Some of the templates of type "+a.traceType+" were used more than once. The template has "+a.templateCount+" traces, the data has "+a.dataCount+" of this type.";break}return a.msg=b,a}b.makeTemplate=function(a){a=c.isPlainObject(a)?a:c.getGraphDiv(a),a=c.extendDeep({_context:j},{data:a.data,layout:a.layout}),g.supplyDefaults(a);var v=a.data||[],i=a.layout||{};i._basePlotModules=a._fullLayout._basePlotModules,i._modules=a._fullLayout._modules;var d={data:{},layout:{}};v.forEach(function(a){var e={};m(a,e,o.bind(null,a));var f=c.coerce(a,{},h,"type"),b=d.data[f];b||(b=d.data[f]=[]),b.push(e)}),m(i,d.layout,n.bind(null,i)),delete d.layout.template;var q=i.template;if(e(q)){var b,f,l,r,s,t,u=q.layout;e(u)&&k(u,d.layout);var p=q.data;if(e(p)){for(f in d.data)if(l=p[f],Array.isArray(l)){for(b=0,t=(s=d.data[f]).length,r=l.length;b<t;b++)k(l[b%r],s[b]);for(b=t;b<r;b++)s.push(c.extendDeep({},l[b]))}for(f in p)f in d.data||(d.data[f]=c.extendDeep([],p[f]))}}return d},b.validateTemplate=function(t,f){var d=c.extendDeep({},{_context:j,data:t.data,layout:t.layout}),u=d.layout||{};e(f)||(f=u.template||{});var v=f.layout,k=f.data,b=[];d.layout=u,d.layout.template=f,g.supplyDefaults(d);var w=d._fullLayout,m=d._fullData,A={};function x(c,f){for(var b in c)if("_"!==b.charAt(0)&&e(c[b])){var a,g=l(b),d=[];for(a=0;a<f.length;a++)d.push(p(c,b,f[a])),g!==b&&d.push(p(c,g,f[a]));for(a=0;a<d.length;a++)A[d[a]]=1;x(c[b],d)}}function y(a,f){for(var c in a)if(-1===c.indexOf("defaults")&&e(a[c])){var d=p(a,c,f);A[d]?y(a[c],d):b.push({code:"unused",path:d})}}if(e(v)?(x(w,["layout"]),y(v,"layout")):b.push({code:"layout"}),e(k)){for(var a,n={},o=0;o<m.length;o++){var s=m[o];n[a=s.type]=(n[a]||0)+1,s._fullInput._template||b.push({code:"missing",index:s._fullInput.index,traceType:a})}for(a in k){var h=k[a].length,i=n[a]||0;h>i?b.push({code:"unused",traceType:a,templateCount:h,dataCount:i}):i>h&&b.push({code:"reused",traceType:a,templateCount:h,dataCount:i})}}else b.push({code:"data"});function z(c,g){for(var d in c)if("_"!==d.charAt(0)){var a=c[d],f=p(c,d,g);e(a)?(Array.isArray(c)&& !1===a._template&&a.templateitemname&&b.push({code:"missing",path:f,templateitemname:a.templateitemname}),z(a,f)):Array.isArray(a)&&q(a)&&z(a,f)}}if(z({data:m,layout:w},""),b.length)return b.map(r)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("./plot_api"),f=a("../plots/plots"),g=a("../lib"),h=a("../snapshot/helpers"),i=a("../snapshot/tosvg"),j=a("../snapshot/svgtoimg"),k=a("../version").version,l={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};b.exports=function(a,b){function p(a){return!(a in b)||g.validate(b[a],l[a])}if(b=b||{},g.isPlainObject(a)?(v=a.data||[],s=a.layout||{},t=a.config||{},m={}):(a=g.getGraphDiv(a),v=g.extendDeep([],a.data),s=g.extendDeep({},a.layout),t=a._context,m=a._fullLayout||{}),!p("width")&&null!==b.width|| !p("height")&&null!==b.height)throw new Error("Height and width should be pixel values.");if(!p("format"))throw new Error("Export format is not "+g.join2(l.format.values,", "," or ")+".");var v,s,t,m,w={};function c(a,c){return g.coerce(b,w,l,a,c)}var x=c("format"),q=c("width"),r=c("height"),y=c("scale"),u=c("setBackground"),z=c("imageDataOnly"),n=document.createElement("div");n.style.position="absolute",n.style.left="-5000px",document.body.appendChild(n);var o=g.extendFlat({},s);q?o.width=q:null===b.width&&d(m.width)&&(o.width=m.width),r?o.height=r:null===b.height&&d(m.height)&&(o.height=m.height);var A=g.extendFlat({},t,{_exportedPlot:!0,staticPlot:!0,setBackground:u}),B=h.getRedrawFunc(n);function C(){return new Promise(function(a){setTimeout(a,h.getDelay(n._fullLayout))})}function D(){return new Promise(function(b,m){var c=i(n,x,y),o=n._fullLayout.width,p=n._fullLayout.height;function d(){e.purge(n),document.body.removeChild(n)}if("full-json"===x){var a=f.graphJson(n,!1,"keepdata","object",!0,!0);return b((a.version=k,a=JSON.stringify(a),d(),z)?a:h.encodeJSON(a))}if(d(),"svg"===x)return b(z?c:h.encodeSVG(c));var l=document.createElement("canvas");l.id=g.randstr(),j({format:x,width:o,height:p,scale:y,canvas:l,svg:c,promise:!0}).then(b).catch(m)})}return new Promise(function(a,b){e.newPlot(n,v,o,A).then(B).then(C).then(D).then(function(c){var b;a((b=c,z?b.replace(h.IMAGE_URL_PREFIX,""):b))}).catch(function(a){b(a)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(a,c,d){"use strict";var b=a("../lib"),e=a("../plots/plots"),f=a("./plot_schema"),g=a("./plot_config").dfltConfig,h=b.isPlainObject,i=Array.isArray,j=b.isArrayOrTypedArray;function k(F,G,H,d,f,A){A=A||[];for(var I=Object.keys(F),B=0;B<I.length;B++){var u=I[B];if("transforms"!==u){var g=A.slice();g.push(u);var a=F[u],e=G[u],r=p(H,u),C=(r||{}).valType,D="info_array"===C,M="colorscale"===C,q=(r||{}).items;if(o(H,u))if(h(a)&&h(e)&&"any"!==C)k(a,e,r,d,f,g);else if(D&&i(a)){a.length>e.length&&d.push(n("unused",f,g.concat(e.length)));var s,c,w,m,t,x=e.length,y=Array.isArray(q);if(y&&(x=Math.min(x,q.length)),2===r.dimensions)for(c=0;c<x;c++)if(i(a[c])){a[c].length>e[c].length&&d.push(n("unused",f,g.concat(c,e[c].length)));var J=e[c].length;for(s=0;s<(y?Math.min(J,q[c].length):J);s++)w=y?q[c][s]:q,m=a[c][s],t=e[c][s],b.validate(m,w)?t!==m&&t!== +m&&d.push(n("dynamic",f,g.concat(c,s),m,t)):d.push(n("value",f,g.concat(c,s),m))}else d.push(n("array",f,g.concat(c),a[c]));else for(c=0;c<x;c++)w=y?q[c]:q,m=a[c],t=e[c],b.validate(m,w)?t!==m&&t!== +m&&d.push(n("dynamic",f,g.concat(c),m,t)):d.push(n("value",f,g.concat(c),m))}else if(r.items&&!D&&i(a)){var l,v,N=q[Object.keys(q)[0]],K=[];for(l=0;l<e.length;l++){var z=e[l]._index||l;if((v=g.slice()).push(z),h(a[z])&&h(e[l])){K.push(z);var E=a[z],L=e[l];h(E)&& !1!==E.visible&& !1===L.visible?d.push(n("invisible",f,v)):k(E,L,N,d,f,v)}}for(l=0;l<a.length;l++)(v=g.slice()).push(l),h(a[l])?-1===K.indexOf(l)&&d.push(n("unused",f,v)):d.push(n("object",f,v,a[l]))}else!h(a)&&h(e)?d.push(n("object",f,g,a)):!j(a)&&j(e)&&!D&&!M?d.push(n("array",f,g,a)):u in G?b.validate(a,r)?"enumerated"===r.valType&&(r.coerceNumber&&a!== +e||a!==e)&&d.push(n("dynamic",f,g,a,e)):d.push(n("value",f,g,a)):d.push(n("unused",f,g,a));else d.push(n("schema",f,g))}}return d}c.exports=function(m,o){void 0===m&&(m=[]),void 0===o&&(o={});var r,u,p=f.get(),a=[],c={_context:b.extendFlat({},g)};i(m)?(c.data=b.extendDeep([],m),r=m):(c.data=[],r=[],a.push(n("array","data"))),h(o)?(c.layout=b.extendDeep({},o),u=o):(c.layout={},u={},arguments.length>1&&a.push(n("object","layout"))),e.supplyDefaults(c);for(var v=c._fullData,B=r.length,q=0;q<B;q++){var s=r[q],d=["data",q];if(!h(s)){a.push(n("object",d));continue}var t=v[q],w=t.type,x=p.traces[w].attributes;x.type={valType:"enumerated",values:[w]},!1===t.visible&& !1!==s.visible&&a.push(n("invisible",d)),k(s,t,x,a,d);var l=s.transforms,C=t.transforms;if(l){i(l)||a.push(n("array",d,["transforms"])),d.push("transforms");for(var j=0;j<l.length;j++){var y=["transforms",j],z=l[j].type;if(!h(l[j])){a.push(n("object",d,y));continue}var A=p.transforms[z]?p.transforms[z].attributes:{};A.type={valType:"enumerated",values:Object.keys(p.transforms)},k(l[j],C[j],A,a,d,y)}}}return k(u,c._fullLayout,function(e,f){for(var a=e.layout.layoutAttributes,c=0;c<f.length;c++){var g=f[c],h=e.traces[g.type],d=h.layoutAttributes;d&&(g.subplot?b.extendFlat(a[h.attributes.subplot.dflt],d):b.extendFlat(a,d))}return a}(p,v),a,"layout"),0===a.length?void 0:a};var l={object:function(a,b){return("layout"===a&&""===b?"The layout argument":"data"===a[0]&&""===b?"Trace "+a[1]+" in the data argument":m(a)+"key "+b)+" must be linked to an object container"},array:function(a,b){return("data"===a?"The data argument":m(a)+"key "+b)+" must be linked to an array container"},schema:function(a,b){return m(a)+"key "+b+" is not part of the schema"},unused:function(a,b,c){var d=h(c)?"container":"key";return m(a)+d+" "+b+" did not get coerced"},dynamic:function(a,b,c,d){return[m(a)+"key",b,"(set to '"+c+"')","got reset to","'"+d+"'","during defaults."].join(" ")},invisible:function(a,b){return(b?m(a)+"item "+b:"Trace "+a[1])+" got defaulted to be not visible"},value:function(a,b,c){return[m(a)+"key "+b,"is set to an invalid value ("+c+")"].join(" ")}};function m(a){return i(a)?"In data trace "+a[1]+", ":"In "+a+", "}function n(d,a,c,g,h){c=c||"",i(a)?(j=a[0],k=a[1]):(j=a,k=null);var j,k,e=s(c),f=l[d](a,e,g,h);return b.log(f),{code:d,container:j,trace:k,path:c,astr:e,msg:f}}function o(a,b){var c=r(b),d=c.keyMinusId,e=c.id;return d in a&&!!a[d]._isSubplotObj&&!!e||b in a}function p(a,b){return b in a?a[b]:a[r(b).keyMinusId]}var q=b.counterRegex("([a-z]+)");function r(b){var a=b.match(q);return{keyMinusId:a&&a[1],id:a&&a[2]}}function s(b){if(!i(b))return String(b);for(var a="",c=0;c<b.length;c++){var d=b[c];"number"==typeof d?a=a.substr(0,a.length-1)+"["+d+"]":a+=d,c<b.length-1&&(a+=".")}return a}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(b,a,c){"use strict";a.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/plot_template");b.exports=function(m,g,c){var a,b,h=c.name,i=c.inclusionAttr||"visible",j=g[h],n=d.isArrayOrTypedArray(m[h])?m[h]:[],f=g[h]=[],k=e.arrayTemplater(g,h,i);for(a=0;a<n.length;a++){var l=n[a];d.isPlainObject(l)?b=k.newItem(l):(b=k.newItem({}))[i]=!1,b._index=a,!1!==b[i]&&c.handleItemDefaults(l,b,g,c),f.push(b)}var o=k.defaultItems();for(a=0;a<o.length;a++)(b=o[a])._index=f.length,c.handleItemDefaults({},b,g,c,{}),f.push(b);if(d.isArrayOrTypedArray(j)){var p=Math.min(j.length,f.length);for(a=0;a<p;a++)d.relinkPrivateKeys(f[a],j[a])}return f}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(a,b,e){"use strict";var c=a("./font_attributes"),d=a("../components/fx/attributes");b.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:c({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:d.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(a,c,d){"use strict";var e=a("fast-isnumeric"),b=a("../../lib"),f=b.dateTime2ms,g=b.incrementMonth,h=a("../../constants/numerical").ONEAVGMONTH;c.exports=function(p,s,q,c){if("date"!==s.type)return{vals:c};var r=p[q+"periodalignment"];if(!r)return{vals:c};var b=p[q+"period"];if(e(b)){if((b=+b)<=0)return{vals:c}}else if("string"==typeof b&&"M"===b.charAt(0)){var m=+b.substring(1);if(!(m>0)||Math.round(m)!==m)return{vals:c};i=m}for(var k=s.calendar,w="start"===r,x="end"===r,y=p[q+"period0"],n=f(y,k)||0,t=[],u=[],v=[],z=c.length,d=0;d<z;d++){var i,o,l,a,j=c[d];if(i){for(o=Math.round((j-n)/(i*h)),a=g(n,i*o,k);a>j;)a=g(a,-i,k);for(;a<=j;)a=g(a,i,k);l=g(a,-i,k)}else{for(o=Math.round((j-n)/b),a=n+o*b;a>j;)a-=b;for(;a<=j;)a+=b;l=a-b}t[d]=w?l:x?a:(l+a)/2,u[d]=l,v[d]=a}return{vals:t,starts:u,ends:v}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(b,a,c){"use strict";a.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(a,c,g){"use strict";var h=a("@plotly/d3"),i=a("fast-isnumeric"),j=a("../../lib"),k=a("../../constants/numerical").FP_SAFE,l=a("../../registry"),m=a("../../components/drawing"),b=a("./axis_ids"),n=b.getFromId,o=b.isLinked;function d(x,a){var b,s,i,m,c,g,u,q,n=[],y=x._fullLayout,t=e(y,a,0),v=e(y,a,1),z=f(x,a),k=z.min,l=z.max;if(0===k.length||0===l.length)return j.simpleMap(a.range,a.r2l);var d=k[0].val,r=l[0].val;for(b=1;b<k.length&&d===r;b++)d=Math.min(d,k[b].val);for(b=1;b<l.length&&d===r;b++)r=Math.max(r,l[b].val);var w=!1;if(a.range){var A=j.simpleMap(a.range,a.r2l);w=A[1]<A[0]}"reversed"===a.autorange&&(w=!0,a.autorange=!0);var B=a.rangemode,C="tozero"===B,D="nonnegative"===B,o=a._length,H=o/10,h=0;for(b=0;b<k.length;b++)for(s=0,i=k[b];s<l.length;s++)(q=(m=l[s]).val-i.val-p(a,i.val,m.val))>0&&((u=o-t(i)-v(m))>H?q/u>h&&(c=i,g=m,h=q/u):q/o>h&&(c={val:i.val,nopad:1},g={val:m.val,nopad:1},h=q/o));if(d===r){var E=d-1,F=d+1;if(C)if(0===d)n=[0,1];else{var I=(d>0?l:k).reduce(function(a,b){return Math.max(a,v(b))},0),G=d/(1-Math.min(.5,I/o));n=d>0?[0,G]:[G,0]}else n=D?[Math.max(0,E),Math.max(1,F)]:[E,F]}else C?(c.val>=0&&(c={val:0,nopad:1}),g.val<=0&&(g={val:0,nopad:1})):D&&(c.val-h*t(c)<0&&(c={val:0,nopad:1}),g.val<=0&&(g={val:1,nopad:1})),h=(g.val-c.val-p(a,i.val,m.val))/(o-t(c)-v(g)),n=[c.val-h*t(c),g.val+h*v(g)];return w&&n.reverse(),j.simpleMap(n,a.l2r||Number)}function p(b,f,g){var c=0;if(b.rangebreaks)for(var d=b.locateBreaks(f,g),a=0;a<d.length;a++){var e=d[a];c+=e.max-e.min}return c}function e(e,a,b){var c=.05*a._length,h=a._anchorAxis||{};if(-1!==(a.ticklabelposition||"").indexOf("inside")|| -1!==(h.ticklabelposition||"").indexOf("inside")){var d="reversed"===a.autorange;if(!d){var f=j.simpleMap(a.range,a.r2l);d=f[1]<f[0]}d&&(b=!b)}var g=0;return o(e,a._id)||(g=q(e,a,b)),c=Math.max(g,c),"domain"===a.constrain&&a._inputDomain&&(c*=(a._inputDomain[1]-a._inputDomain[0])/(a.domain[1]-a.domain[0])),function(a){return a.nopad?0:a.pad+(a.extrapad?c:g)}}function q(g,d,i){var b=0,k="x"===d._id.charAt(0);for(var r in g._plots){var c=g._plots[r];if(d._id===c.xaxis._id||d._id===c.yaxis._id){var a=(k?c.yaxis:c.xaxis)||{};if(-1!==(a.ticklabelposition||"").indexOf("inside")&&(!i&&("left"===a.side||"bottom"===a.side)||i&&("top"===a.side||"right"===a.side))){if(a._vals){var l=j.deg2rad(a._tickAngles[a._id+"tick"]||0),n=Math.abs(Math.cos(l)),o=Math.abs(Math.sin(l));if(!a._vals[0].bb){var s=a._id+"tick",t=a._selections[s];t.each(function(b){var a=h.select(this);a.select(".text-math-group").empty()&&(b.bb=m.bBox(a.node()))})}for(var e=0;e<a._vals.length;e++){var f=a._vals[e].bb;if(f){var p=6+f.width,q=6+f.height;b=Math.max(b,k?Math.max(p*n,q*o):Math.max(q*n,p*o))}}}"inside"===a.ticks&&"inside"===a.ticklabelposition&&(b+=a.ticklen||0)}}}return b}function f(d,a,o){var q,b,c,t=a._id,p=d._fullData,h=d._fullLayout,i=[],j=[];function g(f,d){for(q=0;q<d.length;q++){var e=f[d[q]],a=(e._extremes||{})[t];if(!0===e.visible&&a){for(b=0;b<a.min.length;b++)r(i,(c=a.min[b]).val,c.pad,{extrapad:c.extrapad});for(b=0;b<a.max.length;b++)s(j,(c=a.max[b]).val,c.pad,{extrapad:c.extrapad})}}}if(g(p,a._traceIndices),g(h.annotations||[],a._annIndices||[]),g(h.shapes||[],a._shapeIndices||[]),a._matchGroup&&!o){for(var k in a._matchGroup)if(k!==a._id){var l=n(d,k),e=f(d,l,!0),m=a._length/l._length;for(b=0;b<e.min.length;b++)r(i,(c=e.min[b]).val,c.pad*m,{extrapad:c.extrapad});for(b=0;b<e.max.length;b++)s(j,(c=e.max[b]).val,c.pad*m,{extrapad:c.extrapad})}}return{min:i,max:j}}function r(a,b,c,d){t(a,b,c,d,v)}function s(a,b,c,d){t(a,b,c,d,w)}function t(c,d,e,h,i){for(var k=h.tozero,f=h.extrapad,g=!0,b=0;b<c.length&&g;b++){var a=c[b];if(i(a.val,d)&&a.pad>=e&&(a.extrapad||!f)){g=!1;break}i(d,a.val)&&a.pad<=e&&(f||!a.extrapad)&&(c.splice(b,1),b--)}if(g){var j=k&&0===d;c.push({val:d,pad:j?0:e,extrapad:!j&&f})}}function u(a){return i(a)&&Math.abs(a)<k}function v(a,b){return a<=b}function w(a,b){return a>=b}c.exports={getAutoRange:d,makePadFn:e,doAutoRange:function(b,a,g){if(a.setScale(),a.autorange){a.range=g?g.slice():d(b,a),a._r=a.range.slice(),a._rl=j.simpleMap(a._r,a.r2l);var h=a._input,f={};f[a._attr+".range"]=a.range,f[a._attr+".autorange"]=a.autorange,l.call("_storeDirectGUIEdit",b.layout,b._fullLayout._preGUI,f),h.range=a.range.slice(),h.autorange=a.autorange}var c=a._anchorAxis;if(c&&c.rangeslider){var e=c.rangeslider[a._name];e&&"auto"===e.rangemode&&(e.range=d(b,a)),c._input.rangeslider[a._name]=j.extendFlat({},e)}},findExtremes:function(d,h,a){a||(a={}),d._m||d.setScale();var b,c,w,x,y,z,A,e,f,n=[],o=[],g=h.length,p=a.padded||!1,q=a.tozero&&("linear"===d.type||"-"===d.type),t="log"===d.type,v=!1,B=a.vpadLinearized||!1;function j(a){if(Array.isArray(a))return v=!0,function(b){return Math.max(Number(a[b]||0),0)};var b=Math.max(Number(a||0),0);return function(){return b}}var C=j((d._m>0?a.ppadplus:a.ppadminus)||a.ppad||0),D=j((d._m>0?a.ppadminus:a.ppadplus)||a.ppad||0),E=j(a.vpadplus||a.vpad),F=j(a.vpadminus||a.vpad);if(!v){if(e=1/0,f=-1/0,t)for(b=0;b<g;b++)(c=h[b])<e&&c>0&&(e=c),c>f&&c<k&&(f=c);else for(b=0;b<g;b++)(c=h[b])<e&&c> -k&&(e=c),c>f&&c<k&&(f=c);h=[e,f],g=2}var G={tozero:q,extrapad:p};function l(a){i(w=h[a])&&(z=C(a),A=D(a),B?(x=d.c2l(w)-F(a),y=d.c2l(w)+E(a)):(e=w-F(a),f=w+E(a),t&&e<f/10&&(e=f/10),x=d.c2l(e),y=d.c2l(f)),q&&(x=Math.min(0,x),y=Math.max(0,y)),u(x)&&r(n,x,A,G),u(y)&&s(o,y,z,G))}var m=Math.min(6,g);for(b=0;b<m;b++)l(b);for(b=g-1;b>=m;b--)l(b);return{min:n,max:o,opts:a}},concatExtremes:f}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(b,g,j){"use strict";var k=b("@plotly/d3"),l=b("fast-isnumeric"),m=b("../../plots/plots"),n=b("../../registry"),h=b("../../lib"),o=h.strTranslate,p=b("../../lib/svg_text_utils"),q=b("../../components/titles"),r=b("../../components/color"),s=b("../../components/drawing"),t=b("./layout_attributes"),u=b("./clean_ticks"),c=b("../../constants/numerical"),v=c.ONEMAXYEAR,w=c.ONEAVGYEAR,x=c.ONEMINYEAR,y=c.ONEMAXQUARTER,z=c.ONEAVGQUARTER,A=c.ONEMINQUARTER,B=c.ONEMAXMONTH,C=c.ONEAVGMONTH,D=c.ONEMINMONTH,E=c.ONEWEEK,i=c.ONEDAY,F=i/2,G=c.ONEHOUR,H=c.ONEMIN,I=c.ONESEC,J=c.MINUS_SIGN,K=c.BADNUM,L={K:"zeroline"},M={K:"gridline",L:"path"},N={K:"minor-gridline",L:"path"},O={K:"tick",L:"path"},P={K:"tick",L:"text"},Q={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},e=b("../../constants/alignment"),R=e.MID_SHIFT,S=e.CAP_SHIFT,T=e.LINE_SPACING,U=e.OPPOSITE_SIDE,V=3,a=g.exports={};a.setConvert=b("./set_convert");var W=b("./axis_autotype"),d=b("./axis_ids"),X=d.idSort,Y=d.isLinked;a.id2name=d.id2name,a.name2id=d.name2id,a.cleanId=d.cleanId,a.list=d.list,a.listIds=d.listIds,a.getFromId=d.getFromId,a.getFromTrace=d.getFromTrace;var f=b("./autorange");function Z(a){var b=(a[1]-a[0])*1e-4;return[a[0]-b,a[1]+b]}a.getAutoRange=f.getAutoRange,a.findExtremes=f.findExtremes,a.coerceRef=function(g,i,j,d,c,a){var k=d.charAt(d.length-1),b=j._fullLayout._subplots[k+"axis"],e=d+"ref",f={};return c||(c=b[0]||("string"==typeof a?a:a[0])),a||(a=c),b=b.concat(b.map(function(a){return a+" domain"})),f[e]={valType:"enumerated",values:b.concat(a?"string"==typeof a?[a]:a:[]),dflt:c},h.coerce(g,i,f,e)},a.getRefType=function(a){return void 0===a?a:"paper"===a?"paper":"pixel"===a?"pixel":/( domain)$/.test(a)?"domain":"range"},a.coercePosition=function(j,k,f,g,b,c){var d,e;if("range"!==a.getRefType(g))d=h.ensureNumber,e=f(b,c);else{var i=a.getFromId(k,g);e=f(b,c=i.fraction2r(c)),d=i.cleanPos}j[b]=d(e)},a.cleanPosition=function(c,d,b){return("paper"===b||"pixel"===b?h.ensureNumber:a.getFromId(d,b).cleanPos)(c)},a.redrawComponents=function(c,d){d=d||a.listIds(c);var e=c._fullLayout;function b(j,k,l,m){for(var o=n.getComponentMethod(j,k),h={},b=0;b<d.length;b++)for(var i=e[a.id2name(d[b])][l],f=0;f<i.length;f++){var g=i[f];if(!h[g]&&(o(c,g),h[g]=1,m))return}}b("annotations","drawOne","_annIndices"),b("shapes","drawOne","_shapeIndices"),b("images","draw","_imgIndices",!0),b("selections","drawOne","_selectionIndices")};var $=a.getDataConversions=function(g,h,c,d){var b,e="x"===c||"y"===c||"z"===c?c:d;if(Array.isArray(e)){if(b={type:W(d,void 0,{autotypenumbers:g._fullLayout.autotypenumbers}),_categories:[]},a.setConvert(b),"category"===b.type)for(var f=0;f<d.length;f++)b.d2c(d[f])}else b=a.getFromTrace(g,h,e);return b?{d2c:b.d2c,c2d:b.c2d}:"ids"===e?{d2c:aa,c2d:aa}:{d2c:_,c2d:_}};function _(a){return+a}function aa(a){return String(a)}function ab(a,b){return .001>Math.abs((a/b+.5)%1-.5)}function ac(a,b){return .001>Math.abs(a/b-1)}function ad(a){return+a.substring(1)}function ae(b){var e=Z(h.simpleMap(b.range,b.r2l)),l=Math.min(e[0],e[1]),m=Math.max(e[0],e[1]),n="category"===b.type?b.d2l_noadd:b.d2l;"log"===b.type&&"L"!==String(b.dtick).charAt(0)&&(b.dtick="L"+Math.pow(10,Math.floor(Math.min(b.range[0],b.range[1]))-1));for(var f=[],c=0;c<=1;c++)if(!c||b.minor){var j=c?b.minor.tickvals:b.tickvals,g=c?[]:b.ticktext;if(j){Array.isArray(g)||(g=[]);for(var d=0;d<j.length;d++){var i=n(j[d]);if(i>l&&i<m){var k=void 0===g[d]?a.tickText(b,i):ao(b,i,String(g[d]));c&&(k.minor=!0,k.text=""),f.push(k)}}}}return b.rangebreaks&&(f=f.filter(function(a){return b.maskBreaks(a.x)!==K})),f}a.getDataToCoordFunc=function(a,b,c,d){return $(a,b,c,d).d2c},a.counterLetter=function(b){var a=b.charAt(0);return"x"===a?"y":"y"===a?"x":void 0},a.minDtick=function(a,b,c,d){-1===["log","category","multicategory"].indexOf(a.type)&&d?void 0===a._minDtick?(a._minDtick=b,a._forceTick0=c):a._minDtick&&((a._minDtick/b+1e-6)%1<2e-6&&((c-a._forceTick0)/b%1+1.000001)%1<2e-6?(a._minDtick=b,a._forceTick0=c):((b/a._minDtick+1e-6)%1>2e-6||((c-a._forceTick0)/a._minDtick%1+1.000001)%1>2e-6)&&(a._minDtick=0)):a._minDtick=0},a.saveRangeInitial=function(g,h){for(var d=a.list(g,"",!0),e=!1,c=0;c<d.length;c++){var b=d[c],f=void 0===b._rangeInitial,i=f||!(b.range[0]===b._rangeInitial[0]&&b.range[1]===b._rangeInitial[1]);(f&& !1===b.autorange||h&&i)&&(b._rangeInitial=b.range.slice(),e=!0)}return e},a.saveShowSpikeInitial=function(e,i){for(var f=a.list(e,"",!0),g=!1,c="on",d=0;d<f.length;d++){var b=f[d],h=void 0===b._showSpikeInitial,j=h||b.showspikes!==b._showspikes;(h||i&&j)&&(b._showSpikeInitial=b.showspikes,g=!0),"on"!==c||b.showspikes||(c="off")}return e._fullLayout._cartesianSpikesEnabled=c,g},a.autoBin=function(j,e,q,t,c,n){var b,o,m,p,f=h.aggNums(Math.min,null,j),d=h.aggNums(Math.max,null,j);if("category"===e.type||"multicategory"===e.type)return{start:f-.5,end:d+.5,size:Math.max(1,Math.round(n)||1),_dataSpan:d-f};if(c||(c=e.calendar),b="log"===e.type?{type:"linear",range:[f,d]}:{type:e.type,range:h.simpleMap([f,d],e.c2r,0,c),calendar:c},a.setConvert(b),n=n&&u.dtick(n,b.type))b.dtick=n,b.tick0=u.tick0(void 0,b.type,c);else{if(q)o=(d-f)/q;else{var r=h.distinctVals(j),s=Math.pow(10,Math.floor(Math.log(r.minDiff)/Math.LN10));l(o=Math.max(s*h.roundUp(r.minDiff/s,[.9,1.9,4.9,9.9],!0),2*h.stdev(j)/Math.pow(j.length,t?.25:.4)))||(o=1)}a.autoTicks(b,o)}var k=b.dtick,g=a.tickIncrement(a.tickFirst(b),k,"reverse",c);if("number"==typeof k)g=function(b,c,a,e,n){var i=0,j=0,k=0,m=0;function f(c){return(1+(c-b)*100/a.dtick)%100<2}for(var d=0;d<c.length;d++)c[d]%1==0?k++:!l(c[d])&&m++,f(c[d])&&i++,f(c[d]+a.dtick/2)&&j++;var g=c.length-m;if(k===g&&"date"!==a.type)a.dtick<1?b=e-.5*a.dtick:(b-=.5)+a.dtick<e&&(b+=a.dtick);else if(j<.1*g&&(i>.3*g||f(e)||f(n))){var h=a.dtick/2;b+=b+h<e?h:-h}return b}(g,j,b,f,d),p=1+Math.floor((d-g)/k),m=g+p*k;else for("M"===b.dtick.charAt(0)&&(g=function(b,f,d,g,j){var c=h.findExactDates(f,j);if(c.exactDays>.8){var k=Number(d.substr(1));c.exactYears>.8&&k%12==0?b=a.tickIncrement(b,"M6","reverse")+1.5*i:c.exactMonths>.8?b=a.tickIncrement(b,"M1","reverse")+15.5*i:b-=F;var e=a.tickIncrement(b,d);if(e<=g)return e}return b}(g,j,k,f,c)),m=g,p=0;m<=d;)m=a.tickIncrement(m,k,!1,c),p++;return{start:e.c2r(g,0,c),end:e.c2r(m,0,c),size:k,_dataSpan:d-f}},a.prepMinorTicks=function(c,b,n){if(!b.minor.dtick){delete c.dtick;var f,k=b.dtick&&l(b._tmin);if(k){var o=a.tickIncrement(b._tmin,b.dtick,!0);f=[b._tmin,.99*o+.01*b._tmin]}else{var g=h.simpleMap(b.range,b.r2l);f=[g[0],.8*g[0]+.2*g[1]]}if(c.range=h.simpleMap(f,b.l2r),c._isMinor=!0,a.prepTicks(c,n),k){var m=l(b.dtick),j=l(c.dtick),d=m?b.dtick:+b.dtick.substring(1),e=j?c.dtick:+c.dtick.substring(1);m&&j?ab(d,e)?d===2*E&&e===2*i&&(c.dtick=E):d===2*E&&e===3*i?c.dtick=E:d!==E||(b._input.minor||{}).nticks?ac(d/e,2.5)?c.dtick=d/2:c.dtick=d:c.dtick=i:"M"===String(b.dtick).charAt(0)?j?c.dtick="M1":ab(d,e)?d>=12&&2===e&&(c.dtick="M3"):c.dtick=b.dtick:"L"===String(c.dtick).charAt(0)?"L"===String(b.dtick).charAt(0)?ab(d,e)||(c.dtick=ac(d/e,2.5)?b.dtick/2:b.dtick):c.dtick="D1":"D2"===c.dtick&& +b.dtick>1&&(c.dtick=1)}c.range=b.range}void 0===b.minor._tick0Init&&(c.tick0=b.tick0)},a.prepTicks=function(b,f){var e=h.simpleMap(b.range,b.r2l,void 0,void 0,f);if("auto"===b.tickmode||!b.dtick){var d,c=b.nticks;c||("category"===b.type||"multicategory"===b.type?(d=b.tickfont?h.bigFont(b.tickfont.size||12):15,c=b._length/d):(d="y"===b._id.charAt(0)?40:80,c=h.constrain(b._length/d,4,9)+1),"radialaxis"!==b._name||(c*=2)),b.minor&&"array"!==b.minor.tickmode||"array"!==b.tickmode||(c*=100),b._roughDTick=Math.abs(e[1]-e[0])/c,a.autoTicks(b,b._roughDTick),b._minDtick>0&&b.dtick<2*b._minDtick&&(b.dtick=b._minDtick,b.tick0=b.l2r(b._forceTick0))}"period"===b.ticklabelmode&&function(b){function g(){return!(l(b.dtick)||"M"!==b.dtick.charAt(0))}var d,e=g(),c=a.getTickFormat(b);if(c){var f=b._dtickInit!==b.dtick;!/%[fLQsSMX]/.test(c)&&(/%[HI]/.test(c)?(d=G,f&&!e&&b.dtick<G&&(b.dtick=G)):/%p/.test(c)?(d=F,f&&!e&&b.dtick<F&&(b.dtick=F)):/%[Aadejuwx]/.test(c)?(d=i,f&&!e&&b.dtick<i&&(b.dtick=i)):/%[UVW]/.test(c)?(d=E,f&&!e&&b.dtick<E&&(b.dtick=E)):/%[Bbm]/.test(c)?(d=C,f&&(e?1>ad(b.dtick):b.dtick<D)&&(b.dtick="M1")):/%[q]/.test(c)?(d=z,f&&(e?3>ad(b.dtick):b.dtick<A)&&(b.dtick="M3")):/%[Yy]/.test(c)&&(d=w,f&&(e?12>ad(b.dtick):b.dtick<x)&&(b.dtick="M12")))}(e=g())&&b.tick0===b._dowTick0&&(b.tick0=b._rawTick0),b._definedDelta=d}(b),b.tick0||(b.tick0="date"===b.type?"2000-01-01":0),"date"===b.type&&b.dtick<.1&&(b.dtick=.1),an(b)},a.calcTicks=function(b,s){for(var e,ah,m,n,t=b.type,J=b.calendar,W=b.ticklabelstep,L="period"===b.ticklabelmode,j=h.simpleMap(b.range,b.r2l,void 0,void 0,s),k=j[1]<j[0],M=Math.min(j[0],j[1]),u=Math.max(j[0],j[1]),ai=Math.max(1e3,b._length||0),o=[],N=[],c=[],p=[],X=b.minor&&(b.minor.ticks||b.minor.showgrid),g=1;g>=(X?0:1);g--){var H,I,aj=!g;g?(b._dtickInit=b.dtick,b._tick0Init=b.tick0):(b.minor._dtickInit=b.minor.dtick,b.minor._tick0Init=b.minor.tick0);var f=g?b:h.extendFlat({},b,b.minor);if(aj?a.prepMinorTicks(f,b,s):a.prepTicks(f,s),"array"===f.tickmode){g?(c=[],o=ae(b)):(p=[],N=ae(b));continue}var Y=Z(j),$=Y[0],q=Y[1],_=l(f.dtick),ak="log"===t&&!(_||"L"===f.dtick.charAt(0)),O=a.tickFirst(f,s);if(g){if(b._tmin=O,O<$!==k)break;("category"===t||"multicategory"===t)&&(q=k?Math.max(-0.5,q):Math.min(b._categories.length-.5,q))}var aa=null,d=O;g&&(_?I=b.dtick:"date"===t?"string"==typeof b.dtick&&"M"===b.dtick.charAt(0)&&(I=C*b.dtick.substring(1)):I=b._roughDTick,H=Math.round((b.r2l(d)-b.r2l(b.tick0))/I)-1);var P=f.dtick;for(f.rangebreaks&&f._tick0Init!==f.tick0&&(d=aG(d,b),k||(d=a.tickIncrement(d,P,!k,J))),g&&L&&(d=a.tickIncrement(d,P,!k,J),H--);k?d>=q:d<=q;d=a.tickIncrement(d,P,k,J)){if(g&&H++,f.rangebreaks&&!k){if(d<$)continue;if(f.maskBreaks(d)===K&&aG(d,f)>=u)break}if(c.length>ai||d===aa)break;aa=d;var r={value:d};g?(ak&&d!==(0|d)&&(r.simpleLabel=!0),W>1&&H%W&&(r.skipLabel=!0),c.push(r)):(r.minor=!0,p.push(r))}}if(X&&!("inside"===b.minor.ticks&&"outside"===b.ticks||"outside"===b.minor.ticks&&"inside"===b.ticks)){for(var al=c.map(function(a){return a.value}),ab=[],Q=0;Q<p.length;Q++){var ac=p[Q],ad=ac.value;if(-1===al.indexOf(ad)){for(var R=!1,S=0;!R&&S<c.length;S++)1e7+c[S].value===1e7+ad&&(R=!0);R||ab.push(ac)}}p=ab}if(L&&function(d,m,f){for(var a=0;a<d.length;a++){var n,j=d[a].value,g=a,h=a+1;a<d.length-1?(g=a,h=a+1):a>0?(g=a-1,h=a):(g=a,h=a);var q=d[g].value,r=d[h].value,c=Math.abs(r-q),e=f||c,b=0;e>=x?b=c>=x&&c<=v?c:w:f===z&&e>=A?b=c>=A&&c<=y?c:z:e>=D?b=c>=D&&c<=B?c:C:f===E&&e>=E?b=E:e>=i?b=i:f===F&&e>=F?b=F:f===G&&e>=G&&(b=G),b>=c&&(b=c,n=!0);var s=j+b;if(m.rangebreaks&&b>0){for(var k=84,o=0,l=0;l<k;l++){var p=(l+.5)/k;m.maskBreaks(j*(1-p)+p*s)!==K&&o++}(b*=o/k)||(d[a].drop=!0),n&&c>E&&(b=c)}(b>0||0===a)&&(d[a].periodX=j+b/2)}}(c,b,b._definedDelta),b.rangebreaks){var am="y"===b._id.charAt(0),T=1;"auto"===b.tickmode&&(T=b.tickfont?b.tickfont.size:12);var U=NaN;for(e=c.length-1;e> -1;e--){if(c[e].drop){c.splice(e,1);continue}c[e].value=aG(c[e].value,b);var V=b.c2p(c[e].value);(am?U>V-T:U<V+T)?c.splice(k?e+1:e,1):U=V}}aF(b)&&360===Math.abs(j[1]-j[0])&&c.pop(),b._tmax=(c[c.length-1]||{}).value,b._prevDateHead="",b._inCalcTicks=!0;var af=function(a){a.text="",b._prevDateHead=ah};for(e=0,c=c.concat(p);e<c.length;e++){var an=c[e].minor,ag=c[e].value;an?N.push({x:ag,minor:!0}):(ah=b._prevDateHead,m=a.tickText(b,ag,!1,c[e].simpleLabel),n=c[e].periodX,void 0!==n&&(m.periodX=n,(n>u||n<M)&&(n>u&&(m.periodX=u),n<M&&(m.periodX=M),af(m))),c[e].skipLabel&&af(m),o.push(m))}return o=o.concat(N),b._inCalcTicks=!1,L&&o.length&&(o[0].noTick=!0),o};var af=[2,5,10],ag=[1,2,3,6,12],ah=[1,2,5,10,15,30],ai=[1,2,3,7,14],aj=[-0.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],ak=[-0.301,0,.301,.699,1],al=[15,30,45,90,180];function am(b,a,c){return a*h.roundUp(b/a,c)}function an(a){var b=a.dtick;if(a._tickexponent=0,l(b)||"string"==typeof b||(b=1),("category"===a.type||"multicategory"===a.type)&&(a._tickround=null),"date"===a.type){var e=a.r2l(a.tick0),f=a.l2r(e).replace(/(^-|i)/g,""),c=f.length;if("M"===String(b).charAt(0))c>10||"01-01"!==f.substr(5)?a._tickround="d":a._tickround=+b.substr(1)%12==0?"y":"m";else if(b>=i&&c<=10||b>=15*i)a._tickround="d";else if(b>=H&&c<=16||b>=G)a._tickround="M";else if(b>=I&&c<=19||b>=H)a._tickround="S";else{var h=a.l2r(e+b).replace(/^-/,"").length;a._tickround=Math.max(c,h)-20,a._tickround<0&&(a._tickround=4)}}else if(l(b)||"L"===b.charAt(0)){var g=a.range.map(a.r2d||Number);l(b)||(b=Number(b.substr(1))),a._tickround=2-Math.floor(Math.log(b)/Math.LN10+.01);var j=Math.max(Math.abs(g[0]),Math.abs(g[1])),d=Math.floor(Math.log(j)/Math.LN10+.01),k=void 0===a.minexponent?3:a.minexponent;Math.abs(d)>k&&(aq(a.exponentformat)&&!ar(d)?a._tickexponent=3*Math.round((d-1)/3):a._tickexponent=d)}else a._tickround=null}function ao(b,c,d){var a=b.tickfont||{};return{x:c,dx:0,dy:0,text:d||"",fontSize:a.size,font:a.family,fontColor:a.color}}a.autoTicks=function(b,c,k){var d;function g(a){return Math.pow(a,Math.floor(Math.log(c)/Math.LN10))}if("date"===b.type){b.tick0=h.dateTick0(b.calendar,0);var e=2*c;if(e>w)c/=w,d=g(10),b.dtick="M"+12*am(c,d,af);else if(e>C)c/=C,b.dtick="M"+am(c,1,ag);else if(e>i){if(b.dtick=am(c,i,b._hasDayOfWeekBreaks?[1,2,7,14]:ai),!k){var m=a.getTickFormat(b),j="period"===b.ticklabelmode;j&&(b._rawTick0=b.tick0),/%[uVW]/.test(m)?b.tick0=h.dateTick0(b.calendar,2):b.tick0=h.dateTick0(b.calendar,1),j&&(b._dowTick0=b.tick0)}}else e>G?b.dtick=am(c,G,ag):e>H?b.dtick=am(c,H,ah):e>I?b.dtick=am(c,I,ah):(d=g(10),b.dtick=am(c,d,af))}else if("log"===b.type){b.tick0=0;var f=h.simpleMap(b.range,b.r2l);if(b._isMinor&&(c*=1.5),c>.7)b.dtick=Math.ceil(c);else if(1>Math.abs(f[1]-f[0])){var n=1.5*Math.abs((f[1]-f[0])/c);c=Math.abs(Math.pow(10,f[1])-Math.pow(10,f[0]))/n,d=g(10),b.dtick="L"+am(c,d,af)}else b.dtick=c>.3?"D2":"D1"}else"category"===b.type||"multicategory"===b.type?(b.tick0=0,b.dtick=Math.ceil(Math.max(c,1))):aF(b)?(b.tick0=0,d=1,b.dtick=am(c,d,al)):(b.tick0=0,d=g(10),b.dtick=am(c,d,af));if(0===b.dtick&&(b.dtick=1),!l(b.dtick)&&"string"!=typeof b.dtick){var o=b.dtick;throw b.dtick=1,"ax.dtick error: "+String(o)}},a.tickIncrement=function(b,a,e,i){var c=e?-1:1;if(l(a))return h.increment(b,c*a);var d=a.charAt(0),f=c*Number(a.substr(1));if("M"===d)return h.incrementMonth(b,f,i);if("L"===d)return Math.log(Math.pow(10,b)+f)/Math.LN10;if("D"===d){var j="D2"===a?ak:aj,g=b+.01*c,m=h.roundUp(h.mod(g,1),j,e);return Math.floor(g)+Math.log(k.round(Math.pow(10,m),1))/Math.LN10}throw"unrecognized dtick "+String(a)},a.tickFirst=function(b,u){var p=b.r2l||Number,m=h.simpleMap(b.range,p,void 0,void 0,u),f=m[1]<m[0],q=f?Math.floor:Math.ceil,e=Z(m)[0],d=b.dtick,g=p(b.tick0);if(l(d)){var n=q((e-g)/d)*d+g;return("category"===b.type||"multicategory"===b.type)&&(n=h.constrain(n,0,b._categories.length-1)),n}var j=d.charAt(0),o=Number(d.substr(1));if("M"===j){for(var i,r,s,t=0,c=g;t<10;){if(((i=a.tickIncrement(c,d,f,b.calendar))-e)*(c-e)<=0){if(f)return Math.min(c,i);return Math.max(c,i)}s=j+(Math.abs(Math.round(r=(e-(c+i)/2)/(i-c)))||1)*o,c=a.tickIncrement(c,s,r<0?!f:f,b.calendar),t++}return h.error("tickFirst did not converge",b),c}if("L"===j)return Math.log(q((Math.pow(10,e)-g)/o)*o+g)/Math.LN10;if("D"===j){var v="D2"===d?ak:aj,w=h.roundUp(h.mod(e,1),v,f);return Math.floor(e)+Math.log(k.round(Math.pow(10,w),1))/Math.LN10}throw"unrecognized dtick "+String(d)},a.tickText=function(b,u,d,D){var e,c=ao(b,u),v="array"===b.tickmode,i=d||v,f=b.type,E="category"===f?b.d2l_noadd:b.d2l;if(v&&Array.isArray(b.ticktext)){var w=h.simpleMap(b.range,b.r2l),F=(Math.abs(w[1]-w[0])-(b._lBreaks||0))/1e4;for(e=0;e<b.ticktext.length&&!(Math.abs(u-E(b.tickvals[e]))<F);e++);if(e<b.ticktext.length)return c.text=String(b.ticktext[e]),c}function o(a){if(void 0===a)return!0;if(d)return"none"===a;var c={first:b._tmin,last:b._tmax}[a];return"all"!==a&&u!==c}var x,p,q,y,g,z,A,j,r,s,k,m,B,n,t=d?"never":"none"!==b.exponentformat&&o(b.showexponent)?"hide":"";if("date"===f?function(c,g,i,j){var d,e=c._tickround,n=i&&c.hoverformat||a.getTickFormat(c);j&&(e=l(e)?4:({y:"m",m:"d",d:"M",M:"S",S:4})[e]);var b=h.formatDate(g.x,n,e,c._dateFormat,c.calendar,c._extraFormat),f=b.indexOf("\n");if(-1!==f&&(d=b.substr(f+1),b=b.substr(0,f)),j&&("00:00:00"===b||"00:00"===b?(b=d,d=""):8===b.length&&(b=b.replace(/:00$/,""))),d)if(i)"d"===e?b+=", "+d:b=d+(b?", "+b:"");else if(c._inCalcTicks&&c._prevDateHead===d){var k=aH(c),m=c._trueSide||c.side;(!k&&"top"===m||k&&"bottom"===m)&&(b+="<br> ")}else c._prevDateHead=d,b+="<br>"+d;g.text=b}(b,c,d,i):"log"===f?function(b,a,o,k,i){var c=b.dtick,d=a.x,n=b.tickformat,f="string"==typeof c&&c.charAt(0);if("never"===i&&(i=""),k&&"L"!==f&&(c="L3",f="L"),n||"L"===f)a.text=as(Math.pow(10,d),b,i,k);else if(l(c)||"D"===f&&.1>h.mod(d+.01,1)){var e=Math.round(d),j=Math.abs(e),g=b.exponentformat;"power"===g||aq(g)&&ar(e)?(0===e?a.text=1:1===e?a.text="10":a.text="10<sup>"+(e>1?"":J)+j+"</sup>",a.fontSize*=1.25):("e"===g||"E"===g)&&j>2?a.text="1"+g+(e>0?"+":J)+j:(a.text=as(Math.pow(10,d),b,"","fakehover"),"D1"===c&&"y"===b._id.charAt(0)&&(a.dy-=a.fontSize/6))}else if("D"===f)a.text=String(Math.round(Math.pow(10,h.mod(d,1)))),a.fontSize*=.75;else throw"unrecognized dtick "+String(c);if("D1"===b.dtick){var m=String(a.text).charAt(0);("0"===m||"1"===m)&&("y"===b._id.charAt(0)?a.dx-=a.fontSize/4:(a.dy+=a.fontSize/2,a.dx+=(b.range[1]>b.range[0]?1:-1)*a.fontSize*(d<0?.5:.25)))}}(b,c,d,i,t):"category"===f?(x=b,p=c,void 0===(q=x._categories[Math.round(p.x)])&&(q=""),p.text=String(q)):"multicategory"===f?(y=b,g=c,z=d,A=Math.round(g.x),r=void 0===(j=y._categories[A]||[])[1]?"":String(j[1]),s=void 0===j[0]?"":String(j[0]),z?g.text=s+" - "+r:(g.text=r,g.text2=s)):aF(b)?function(c,a,g,d,e){if("radians"!==c.thetaunit||g)a.text=as(a.x,c,e,d);else{var f=a.x/180;if(0===f)a.text="0";else{var b=function(b){function f(a,b){return 1e-6>=Math.abs(a-b)}function e(b,a){return f(a,0)?b:e(a,b%a)}var a=function(b){for(var a=1;!f(Math.round(b*a)/a,b);)a*=10;return a}(b),c=b*a,d=Math.abs(e(c,a));return[Math.round(c/d),Math.round(a/d)]}(f);if(b[1]>=100)a.text=as(h.deg2rad(a.x),c,e,d);else{var i=a.x<0;1===b[1]?1===b[0]?a.text="\u03C0":a.text=b[0]+"\u03C0":a.text=["<sup>",b[0],"</sup>","\u2044","<sub>",b[1],"</sub>","\u03C0"].join(""),i&&(a.text=J+a.text)}}}}(b,c,d,i,t):(k=b,m=c,B=i,"never"===(n=t)?n="":"all"===k.showexponent&&1e-6>Math.abs(m.x/k.dtick)&&(n="hide"),m.text=as(m.x,k,n,B)),D||(b.tickprefix&&!o(b.showtickprefix)&&(c.text=b.tickprefix+c.text),!b.ticksuffix||o(b.showticksuffix)||(c.text+=b.ticksuffix)),"boundaries"===b.tickson||b.showdividers){var C=function(a){var c=b.l2p(a);return c>=0&&c<=b._length?a:null};c.xbnd=[C(c.x-.5),C(c.x+b.dtick-.5)]}return c},a.hoverLabelText=function(b,d,e){e&&(b=h.extendFlat({},b,{hoverformat:e}));var c=Array.isArray(d)?d[0]:d,f=Array.isArray(d)?d[1]:void 0;if(void 0!==f&&f!==c)return a.hoverLabelText(b,c,e)+" - "+a.hoverLabelText(b,f,e);var g="log"===b.type&&c<=0,i=a.tickText(b,b.c2l(g?-c:c),"hover").text;return g?0===c?"0":J+i:i};var ap=["f","p","n","\u03BC","m","","k","M","G","T"];function aq(a){return"SI"===a||"B"===a}function ar(a){return a>14||a< -15}function as(b,c,p,q){var g,k=b<0,f=c._tickround,e=p||c.exponentformat||"B",d=c._tickexponent,i=a.getTickFormat(c),r=c.separatethousands;if(q){var j={exponentformat:e,minexponent:c.minexponent,dtick:"none"===c.showexponent?c.dtick:l(b)?Math.abs(b)||1:1,range:"none"===c.showexponent?c.range.map(c.r2d):[0,b||1]};an(j),f=(Number(j._tickround)||0)+4,d=j._tickexponent,c.hoverformat&&(i=c.hoverformat)}if(i)return c._numFormat(i)(b).replace(/-/g,J);var m=Math.pow(10,-f)/2;if("none"===e&&(d=0),(b=Math.abs(b))<m)b="0",k=!1;else{if(b+=m,d&&(b*=Math.pow(10,-d),f+=d),0===f)b=String(Math.floor(b));else if(f<0){b=(b=String(Math.round(b))).substr(0,b.length+f);for(var n=f;n<0;n++)b+="0"}else{var o=(b=String(b)).indexOf(".")+1;o&&(b=b.substr(0,o+f).replace(/\.?0+$/,""))}b=h.numSeparate(b,c._separators,r)}return(d&&"hide"!==e&&(aq(e)&&ar(d)&&(e="power"),g=d<0?J+ -d:"power"!==e?"+"+d:String(d),"e"===e||"E"===e?b+=e+g:"power"===e?b+="\xd710<sup>"+g+"</sup>":"B"===e&&9===d?b+="B":aq(e)&&(b+=ap[d/3+5])),k)?J+b:b}function at(a,b){if(a){var c=Object.keys(Q).reduce(function(c,a){return -1!==b.indexOf(a)&&Q[a].forEach(function(a){c[a]=1}),c},{});Object.keys(a).forEach(function(b){c[b]||(1===b.length?a[b]=0:delete a[b])})}}function au(a){return void 0!==a.periodX?a.periodX:a.x}function av(a){return[a.text,a.x,a.axInfo,a.font,a.fontSize,a.fontColor].join("_")}function aw(c){var a=c.title.font.size,b=(c.title.text.match(p.BR_TAG_ALL)||[]).length;return c.title.hasOwnProperty("standoff")?b?a*(S+b*T):a*S:b?a*(b+1)*T:a}function ax(a,c){var b=a.l2p(c);return b>1&&b<a._length-1}function ay(c){var a=k.select(c),b=a.select(".text-math-group");return b.empty()?a.select("text"):b}function az(a){return a._id+".automargin"}function aA(a){return az(a)+".mirror"}function aB(a){return a._id+".rangeslider"}function aC(c,b){for(var a=0;a<b.length;a++)-1===c.indexOf(b[a])&&c.push(b[a])}function aD(f,m,n){var b,d,g=[],e=[],j=f.layout;for(b=0;b<m.length;b++)g.push(a.getFromId(f,m[b]));for(b=0;b<n.length;b++)e.push(a.getFromId(f,n[b]));var q=Object.keys(t),w=["anchor","domain","overlaying","position","side","tickangle","editType"],k=["linear","log"];for(b=0;b<q.length;b++){var c=q[b],l=g[0][c],o=e[0][c],i=!0,r=!1,s=!1;if("_"!==c.charAt(0)&&"function"!=typeof l&& -1===w.indexOf(c)){for(d=1;d<g.length&&i;d++){var p=g[d][c];"type"===c&& -1!==k.indexOf(l)&& -1!==k.indexOf(p)&&l!==p?r=!0:p!==l&&(i=!1)}for(d=1;d<e.length&&i;d++){var u=e[d][c];"type"===c&& -1!==k.indexOf(o)&& -1!==k.indexOf(u)&&o!==u?s=!0:e[d][c]!==o&&(i=!1)}i&&(r&&(j[g[0]._name].type="linear"),s&&(j[e[0]._name].type="linear"),aE(j,c,g,e,f._fullLayout._dfltTitle))}}for(b=0;b<f._fullLayout.annotations.length;b++){var v=f._fullLayout.annotations[b];-1!==m.indexOf(v.xref)&& -1!==n.indexOf(v.yref)&&h.swapAttrs(j.annotations[b],["?"])}}function aE(c,b,i,j,d){var a,e=h.nestedProperty,f=e(c[i[0]._name],b).get(),g=e(c[j[0]._name],b).get();for("title"===b&&(f&&f.text===d.x&&(f.text=d.y),g&&g.text===d.y&&(g.text=d.x)),a=0;a<i.length;a++)e(c,i[a]._name+"."+b).set(g);for(a=0;a<j.length;a++)e(c,j[a]._name+"."+b).set(f)}function aF(a){return"angularaxis"===a._id}function aG(a,d){for(var e=d._rangebreaks.length,b=0;b<e;b++){var c=d._rangebreaks[b];if(a>=c.min&&a<c.max)return c.max}return a}function aH(a){return -1!==(a.ticklabelposition||"").indexOf("inside")}function aI(a,b){aH(a._anchorAxis||{})&&a._hideCounterAxisInsideTickLabels&&a._hideCounterAxisInsideTickLabels(b)}a.getTickFormat=function(a){var b,d,c;function e(a){return"string"!=typeof a?a:Number(a.replace("M",""))*C}function h(a,b){var c=["L","D"];if(typeof a!=typeof b)return"number"==typeof a?1:-1;if("number"==typeof a)return a-b;var d=c.indexOf(a.charAt(0)),e=c.indexOf(b.charAt(0));return d===e?Number(a.replace(/(L|D)/g,""))-Number(b.replace(/(L|D)/g,"")):d-e}function f(d,e,f){var a=f||function(a){return a},b=e[0],c=e[1];return(!b&&"number"!=typeof b||a(b)<=a(d))&&(!c&&"number"!=typeof c||a(c)>=a(d))}function g(b,a){var c=null===a[0],d=null===a[1],e=h(b,a[0])>=0,f=0>=h(b,a[1]);return(c||e)&&(d||f)}if(a.tickformatstops&&a.tickformatstops.length>0)switch(a.type){case"date":case"linear":for(b=0;b<a.tickformatstops.length;b++)if((c=a.tickformatstops[b]).enabled&&f(a.dtick,c.dtickrange,e)){d=c;break}break;case"log":for(b=0;b<a.tickformatstops.length;b++)if((c=a.tickformatstops[b]).enabled&&g(a.dtick,c.dtickrange)){d=c;break}break;default:}return d?d.value:a.tickformat},a.getSubplots=function(f,b){var c=f._fullLayout._subplots,d=c.cartesian.concat(c.gl2d||[]),e=b?a.findSubplotsWithAxis(d,b):d;return e.sort(function(c,d){var a=c.substr(1).split("y"),b=d.substr(1).split("y");return a[0]===b[0]?+a[1]- +b[1]:+a[0]- +b[0]}),e},a.findSubplotsWithAxis=function(c,a){for(var f=new RegExp("x"===a._id.charAt(0)?"^"+a._id+"y":a._id+"$"),d=[],b=0;b<c.length;b++){var e=c[b];f.test(e)&&d.push(e)}return d},a.makeClipPaths=function(f){var b,c,d=f._fullLayout;if(!d._hasOnlyLargeSploms){var j={_offset:0,_length:d.width,_id:""},l={_offset:0,_length:d.height,_id:""},g=a.list(f,"x",!0),h=a.list(f,"y",!0),e=[];for(b=0;b<g.length;b++)for(e.push({x:g[b],y:l}),c=0;c<h.length;c++)0===b&&e.push({x:j,y:h[c]}),e.push({x:g[b],y:h[c]});var i=d._clips.selectAll(".axesclip").data(e,function(a){return a.x._id+a.y._id});i.enter().append("clipPath").classed("axesclip",!0).attr("id",function(a){return"clip"+d._uid+a.x._id+a.y._id}).append("rect"),i.exit().remove(),i.each(function(a){k.select(this).select("rect").attr({x:a.x._offset||0,y:a.y._offset||0,width:a.x._length||1,height:a.y._length||1})})}},a.draw=function(c,b,f){var d=c._fullLayout;"redraw"===b&&d._paper.selectAll("g.subplot").each(function(e){var f=e[0],a=d._plots[f];if(a){var b=a.xaxis,c=a.yaxis;a.xaxislayer.selectAll("."+b._id+"tick").remove(),a.yaxislayer.selectAll("."+c._id+"tick").remove(),a.xaxislayer.selectAll("."+b._id+"tick2").remove(),a.yaxislayer.selectAll("."+c._id+"tick2").remove(),a.xaxislayer.selectAll("."+b._id+"divider").remove(),a.yaxislayer.selectAll("."+c._id+"divider").remove(),a.minorGridlayer&&a.minorGridlayer.selectAll("path").remove(),a.gridlayer&&a.gridlayer.selectAll("path").remove(),a.zerolinelayer&&a.zerolinelayer.selectAll("path").remove(),d._infolayer.select(".g-"+b._id+"title").remove(),d._infolayer.select(".g-"+c._id+"title").remove()}});var e=b&&"redraw"!==b?b:a.listIds(c);return h.syncOrAsync(e.map(function(b){return function(){if(b){var d=a.getFromId(c,b),e=a.drawOne(c,d,f);return d._r=d.range.slice(),d._rl=h.simpleMap(d._r,d.r2l),e}}}))},a.drawOne=function(g,b,u){u=u||{},b.setScale();var i=g._fullLayout,j=b._id,k=j.charAt(0),R=a.counterLetter(j),C=i._plots[b._mainSubplot];if(C){var S=C[k+"axislayer"],v=b._mainLinePosition,w=b._mainMirrorPosition,f=b._vals=a.calcTicks(b),V=[b.mirror,v,w].join("_");for(c=0;c<f.length;c++)f[c].axInfo=V;b._selections={},b._tickAngles&&(b._prevTickAngles=b._tickAngles),b._tickAngles={},b._depth=null;var ab={};if(b.visible){var l=a.makeTransTickFn(b),ac=a.makeTransTickLabelFn(b),D="inside"===b.ticks,W="outside"===b.ticks;if("boundaries"===b.tickson){var E=function(e,b){var a,d=[],c=function(a,c){var b=a.xbnd[c];null!==b&&d.push(h.extendFlat({},a,{x:b}))};if(b.length){for(a=0;a<b.length;a++)c(b[a],0);c(b[a-1],1)}return d}(b,f);ad=a.clipEnds(b,E),L=D?ad:E}else ad=a.clipEnds(b,f),L=D&&"period"!==b.ticklabelmode?ad:f;var X=b._gridVals=ad,F=function(g,a){var b,d,i=[],e=a.length&&a[a.length-1].x<a[0].x,f=function(a,c){var b=a.xbnd[c];null!==b&&i.push(h.extendFlat({},a,{x:b}))};if(g.showdividers&&a.length){for(b=0;b<a.length;b++){var c=a[b];c.text2!==d&&f(c,e?1:0),d=c.text2}f(a[b-1],e?0:1)}return i}(b,f);if(!i._hasOnlyLargeSploms){var G=b._subplotsWith,H={};for(c=0;c<G.length;c++){x=G[c];var d=(K=i._plots[x])[R+"axis"],I=d._mainAxis._id;if(!H[I]){H[I]=1;var J="x"===k?"M0,"+d._offset+"v"+d._length:"M"+d._offset+",0h"+d._length;a.drawGrid(g,b,{vals:X,counterAxis:d,layer:K.gridlayer.select("."+j),minorLayer:K.minorGridlayer.select("."+j),path:J,transFn:l}),a.drawZeroLine(g,b,{counterAxis:d,layer:K.zerolinelayer,path:J,transFn:l})}}}var o=a.getTickSigns(b),p=a.getTickSigns(b,"minor");if(b.ticks||b.minor&&b.minor.ticks){var c,x,K,L,ad,y,z,A,M,N,O=a.makeTickPath(b,v,o[2]),P=a.makeTickPath(b,v,p[2],{minor:!0});if(b._anchorAxis&&b.mirror&& !0!==b.mirror?(z=a.makeTickPath(b,w,o[3]),A=a.makeTickPath(b,w,p[3],{minor:!0}),M=O+z,N=P+A):(z="",A="",M=O,N=P),b.showdividers&&W&&"boundaries"===b.tickson){var Y={};for(c=0;c<F.length;c++)Y[F[c].x]=1;y=function(a){return Y[a.x]?z:M}}else y=function(a){return a.minor?N:M}}if(a.drawTicks(g,b,{vals:L,layer:S,path:y,transFn:l}),"allticks"===b.mirror){var Q=Object.keys(b._linepositions||{});for(c=0;c<Q.length;c++){x=Q[c],K=i._plots[x];var B=b._linepositions[x]||[],Z=B[0],$=B[1],t=B[2],_=a.makeTickPath(b,Z,t?o[0]:p[0],{minor:t})+a.makeTickPath(b,$,t?o[1]:p[1],{minor:t});a.drawTicks(g,b,{vals:L,layer:K[k+"axislayer"],path:_,transFn:l})}}var e=[];if(e.push(function(){return a.drawLabels(g,b,{vals:f,layer:S,plotinfo:K,transFn:ac,labelFns:a.makeLabelFns(b,v)})}),"multicategory"===b.type){var ae={x:2,y:10}[k];e.push(function(){var c={x:"height",y:"width"}[k],d=af()[c]+ae+(b._tickAngles[j+"tick"]?b.tickfont.size*T:0);return a.drawLabels(g,b,{vals:function(g,d){for(var e=[],a={},c=0;c<d.length;c++){var b=d[c];a[b.text2]?a[b.text2].push(b.x):a[b.text2]=[b.x]}for(var f in a)e.push(ao(g,h.interp(a[f],.5),f));return e}(b,f),layer:S,cls:j+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:l,labelFns:a.makeLabelFns(b,v+d*o[4])})}),e.push(function(){var h,d,c,f,i,e;return b._depth=o[4]*(af("tick2")[b.side]-v),h=g,d=b,c={vals:F,layer:S,path:a.makeTickPath(b,v,o[4],{len:b._depth}),transFn:l},f=d._id+"divider",i=c.vals,e=c.layer.selectAll("path."+f).data(i,av),void(e.exit().remove(),e.enter().insert("path",":first-child").classed(f,1).classed("crisp",1).call(r.stroke,d.dividercolor).style("stroke-width",s.crispRound(h,d.dividerwidth,1)+"px"),e.attr("transform",c.transFn).attr("d",c.path))})}else b.title.hasOwnProperty("standoff")&&e.push(function(){b._depth=o[4]*(af()[b.side]-v)});var aa=n.getComponentMethod("rangeslider","isVisible")(b);return e.push(function(){var d,c,f,o,e=b.side.charAt(0),p=U[b.side].charAt(0),l=a.getPxPosition(g,b),h=W?b.ticklen:0;if((b.automargin||aa)&&("multicategory"===b.type?d=af("tick2"):(d=af(),"x"===k&&"b"===e&&(b._depth=Math.max(d.width>0?d.bottom-l:0,h)))),b.automargin){c={x:0,y:0,r:0,l:0,t:0,b:0};var j=[0,1];if("x"===k){if("b"===e?c[e]=b._depth:(c[e]=b._depth=Math.max(d.width>0?l-d.top:0,h),j.reverse()),d.width>0){var q=d.right-(b._offset+b._length);q>0&&(c.xr=1,c.r=q);var r=b._offset-d.left;r>0&&(c.xl=0,c.l=r)}}else if("l"===e?c[e]=b._depth=Math.max(d.height>0?l-d.left:0,h):(c[e]=b._depth=Math.max(d.height>0?d.right-l:0,h),j.reverse()),d.height>0){var s=d.bottom-(b._offset+b._length);s>0&&(c.yb=0,c.b=s);var t=b._offset-d.top;t>0&&(c.yt=1,c.t=t)}c[R]="free"===b.anchor?b.position:b._anchorAxis.domain[j[0]],b.title.text!==i._dfltTitle[k]&&(c[e]+=aw(b)+(b.title.standoff||0)),b.mirror&&"free"!==b.anchor&&((f={x:0,y:0,r:0,l:0,t:0,b:0})[p]=b.linewidth,b.mirror&& !0!==b.mirror&&(f[p]+=h),!0===b.mirror||"ticks"===b.mirror?f[R]=b._anchorAxis.domain[j[1]]:("all"===b.mirror||"allticks"===b.mirror)&&(f[R]=[b._counterDomainMin,b._counterDomainMax][j[1]]))}aa&&(o=n.getComponentMethod("rangeslider","autoMarginOpts")(g,b)),"string"==typeof b.automargin&&(at(c,b.automargin),at(f,b.automargin)),m.autoMargin(g,az(b),c),m.autoMargin(g,aA(b),f),m.autoMargin(g,aB(b),o)}),u.skipTitle||aa&&"bottom"===b.side||e.push(function(){return function(h,b){var c,m,i,j,e,r=h._fullLayout,n=b._id,k=n.charAt(0),d=b.title.font.size;if(b.title.hasOwnProperty("standoff"))c=b._depth+b.title.standoff+aw(b);else{var o=aH(b);if("multicategory"===b.type)c=b._depth;else{var l=1.5*d;o&&(l=.5*d,"outside"===b.ticks&&(l+=b.ticklen)),c=10+l+(b.linewidth?b.linewidth-1:0)}o||("x"===k?c+="top"===b.side?d*(b.showticklabels?1:0):d*(b.showticklabels?1.5:.5):c+="right"===b.side?d*(b.showticklabels?1:.5):d*(b.showticklabels?.5:0))}var g=a.getPxPosition(h,b);if("x"===k?(i=b._offset+b._length/2,j="top"===b.side?g-c:g+c):(j=b._offset+b._length/2,i="right"===b.side?g+c:g-c,m={rotate:"-90",offset:0}),"multicategory"!==b.type){var f=b._selections[b._id+"tick"];if(e={selection:f,side:b.side},f&&f.node()&&f.node().parentNode){var p=s.getTranslate(f.node().parentNode);e.offsetLeft=p.x,e.offsetTop=p.y}b.title.hasOwnProperty("standoff")&&(e.pad=0)}return q.draw(h,n+"title",{propContainer:b,propName:b._name+".title.text",placeholder:r._dfltTitle[k],avoid:e,transform:m,attributes:{x:i,y:j,"text-anchor":"middle"}})}(g,b)}),h.syncOrAsync(e)}}function af(i){var g,h,a,c,d,e,f=j+(i||"tick");return ab[f]||(ab[f]=(g=b,h=f,g._selections[h].size()?(a=1/0,c=-1/0,d=1/0,e=-1/0,g._selections[h].each(function(){var f=ay(this),b=s.bBox(f.node().parentNode);a=Math.min(a,b.top),c=Math.max(c,b.bottom),d=Math.min(d,b.left),e=Math.max(e,b.right)})):(a=0,c=0,d=0,e=0),{top:a,bottom:c,left:d,right:e,height:c-a,width:e-d})),ab[f]}},a.getTickSigns=function(a,e){var c=a._id.charAt(0),f={x:"top",y:"right"}[c],d=a.side===f?1:-1,b=[-1,1,d,-d];return"inside"!==(e?(a.minor||{}).ticks:a.ticks)==("x"===c)&&(b=b.map(function(a){return-a})),a.side&&b.push({l:-1,t:-1,r:1,b:1}[a.side.charAt(0)]),b},a.makeTransTickFn=function(a){return"x"===a._id.charAt(0)?function(b){return o(a._offset+a.l2p(b.x),0)}:function(b){return o(0,a._offset+a.l2p(b.x))}},a.makeTransTickLabelFn=function(a){var b=function(a){var m=a.ticklabelposition||"",c=function(a){return -1!==m.indexOf(a)},e=c("top"),f=c("left"),j=c("right"),k=c("bottom"),g=c("inside"),h=k||f||e||j;if(!h&&!g)return[0,0];var i=a.side,d=h?(a.tickwidth||0)/2:0,b=V,l=a.tickfont?a.tickfont.size:12;return(k||e)&&(d+=l*S,b+=(a.linewidth||0)/2),(f||j)&&(d+=(a.linewidth||0)/2,b+=V),g&&"top"===i&&(b-=l*(1-S)),(f||e)&&(d=-d),("bottom"===i||"right"===i)&&(b=-b),[h?d:0,g?b:0]}(a),c=b[0],d=b[1];return"x"===a._id.charAt(0)?function(b){return o(c+a._offset+a.l2p(au(b)),d)}:function(b){return o(d,c+a._offset+a.l2p(au(b)))}},a.makeTickPath=function(a,d,c,b){b||(b={});var e=b.minor;if(e&&!a.minor)return"";var f=void 0!==b.len?b.len:e?a.minor.ticklen:a.ticklen,h=a._id.charAt(0),g=(a.linewidth||1)/2;return"x"===h?"M0,"+(d+g*c)+"v"+f*c:"M"+(d+g*c)+",0h"+f*c},a.makeLabelFns=function(a,w,p){var q,r,g,e,n,x=a.ticklabelposition||"",j=function(a){return -1!==x.indexOf(a)},y=j("top"),z=j("left"),A=j("right"),B=j("bottom"),C=B||z||y||A,b=j("inside"),o="inside"===x&&"inside"===a.ticks|| !b&&"outside"===a.ticks&&"boundaries"!==a.tickson,i=0,m=0,k=o?a.ticklen:0;if(b?k*=-1:C&&(k=0),o&&(i+=k,p)){var s=h.deg2rad(p);i=k*Math.cos(s)+1,m=k*Math.sin(s)}a.showticklabels&&(o||a.showline)&&(i+=.2*a.tickfont.size);var c={labelStandoff:i+=(a.linewidth||1)/2*(b?-1:1),labelShift:m},t=0,f=a.side,u=a._id.charAt(0),d=a.tickangle;if("x"===u)e=(n=!b&&"bottom"===f||b&&"top"===f)?1:-1,b&&(e*=-1),q=m*e,r=w+i*e,g=n?1:-0.2,90===Math.abs(d)&&(b?g+=R:g=-90===d&&"bottom"===f?S:90===d&&"top"===f?R:.5,t=R/2*(d/90)),c.xFn=function(a){return a.dx+q+t*a.fontSize},c.yFn=function(a){return a.dy+r+a.fontSize*g},c.anchorFn=function(c,a){if(C){if(z)return"end";if(A)return"start"}return l(a)&&0!==a&&180!==a?a*e<0!==b?"end":"start":"middle"},c.heightFn=function(e,c,d){return c< -60||c>60?-0.5*d:"top"===a.side!==b?-d:0};else if("y"===u){if(e=(n=!b&&"left"===f||b&&"right"===f)?1:-1,b&&(e*=-1),q=i,r=m*e,g=0,b||90!==Math.abs(d)||(g=-90===d&&"left"===f||90===d&&"right"===f?S:.5),b){var v=l(d)?+d:0;0!==v&&(t=Math.abs(Math.sin(h.deg2rad(v)))*S*e,g=0)}c.xFn=function(a){return a.dx+w-(q+a.fontSize*g)*e+t*a.fontSize},c.yFn=function(a){return a.dy+r+a.fontSize*R},c.anchorFn=function(b,a){return l(a)&&90===Math.abs(a)?"middle":n?"end":"start"},c.heightFn=function(d,b,c){return"right"===a.side&&(b*=-1),b< -30?-c:b<30?-0.5*c:0}}return c},a.drawTicks=function(f,b,a){a=a||{};var d=b._id+"tick",e=[].concat(b.minor&&b.minor.ticks?a.vals.filter(function(a){return a.minor&&!a.noTick}):[]).concat(b.ticks?a.vals.filter(function(a){return!a.minor&&!a.noTick}):[]),c=a.layer.selectAll("path."+d).data(e,av);c.exit().remove(),c.enter().append("path").classed(d,1).classed("ticks",1).classed("crisp",!1!==a.crisp).each(function(a){return r.stroke(k.select(this),a.minor?b.minor.tickcolor:b.tickcolor)}).style("stroke-width",function(a){return s.crispRound(f,a.minor?b.minor.tickwidth:b.tickwidth,1)+"px"}).attr("d",a.path).style("display",null),aI(b,[O]),c.attr("transform",a.transFn)},a.drawGrid=function(h,c,b){b=b||{};var i=c._id+"grid",j=c.minor&&c.minor.showgrid,p=j?b.vals.filter(function(a){return a.minor}):[],d=c.showgrid?b.vals.filter(function(a){return!a.minor}):[],l=b.counterAxis;if(l&&a.shouldShowZeroLine(h,c,l))for(var m="array"===c.tickmode,e=0;e<d.length;e++){var n=d[e].x;if(m?!n:Math.abs(n)<c.dtick/100)if(d=d.slice(0,e).concat(d.slice(e+1)),m)e--;else break}c._gw=s.crispRound(h,c.gridwidth,1);for(var u=j?s.crispRound(h,c.minor.gridwidth,1):0,q=b.layer,t=b.minorLayer,f=1;f>=0;f--){var o=f?q:t;if(o){var g=o.selectAll("path."+i).data(f?d:p,av);g.exit().remove(),g.enter().append("path").classed(i,1).classed("crisp",!1!==b.crisp),g.attr("transform",b.transFn).attr("d",b.path).each(function(a){return r.stroke(k.select(this),a.minor?c.minor.gridcolor:c.gridcolor||"#ddd")}).style("stroke-dasharray",function(a){return s.dashStyle(a.minor?c.minor.griddash:c.griddash,a.minor?c.minor.gridwidth:c.gridwidth)}).style("stroke-width",function(a){return(a.minor?u:c._gw)+"px"}).style("display",null),"function"==typeof b.path&&g.attr("d",b.path)}}aI(c,[M,N])},a.drawZeroLine=function(e,c,b){b=b||b;var f=c._id+"zl",g=a.shouldShowZeroLine(e,c,b.counterAxis),d=b.layer.selectAll("path."+f).data(g?[{x:0,id:c._id}]:[]);d.exit().remove(),d.enter().append("path").classed(f,1).classed("zl",1).classed("crisp",!1!==b.crisp).each(function(){b.layer.selectAll("path").sort(function(a,b){return X(a.id,b.id)})}),d.attr("transform",b.transFn).attr("d",b.path).call(r.stroke,c.zerolinecolor||r.defaultLine).style("stroke-width",s.crispRound(e,c.zerolinewidth,c._gw||1)+"px").style("display",null),aI(c,[L])},a.drawLabels=function(m,a,b){b=b||{};var c=m._fullLayout,n=a._id,v=n.charAt(0),f=b.cls||n+"tick",q=b.vals.filter(function(a){return a.text}),w=b.labelFns,r=b.secondary?0:a.tickangle,j=(a._prevTickAngles||{})[f],d=b.layer.selectAll("g."+f).data(a.showticklabels?q:[],av),x=[];function t(c,d){c.each(function(c){var e=k.select(this),f=e.select(".text-math-group"),h=w.anchorFn(c,d),g=b.transFn.call(e.node(),c)+(l(d)&&0!= +d?" rotate("+d+","+w.xFn(c)+","+(w.yFn(c)-c.fontSize/2)+")":""),m=p.lineCount(e),n=T*c.fontSize,i=w.heightFn(c,l(d)?+d:0,(m-1)*n);if(i&&(g+=o(0,i)),f.empty()){var j=e.select("text");j.attr({transform:g,"text-anchor":h}),j.style("opacity",1),a._adjustTickLabelsOverflow&&a._adjustTickLabelsOverflow()}else{var q=s.bBox(f.node()).width*({end:-0.5,start:.5})[h];f.attr("transform",g+o(q,0))}})}d.enter().append("g").classed(f,1).append("text").attr("text-anchor","middle").each(function(a){var b=k.select(this),c=m._promises.length;b.call(p.positionText,w.xFn(a),w.yFn(a)).call(s.font,a.font,a.fontSize,a.fontColor).text(a.text).call(p.convertToTspans,m),m._promises[c]?x.push(m._promises.pop().then(function(){t(b,r)})):t(b,r)}),aI(a,[P]),d.exit().remove(),b.repositionOnUpdate&&d.each(function(a){k.select(this).select("text").call(p.positionText,w.xFn(a),w.yFn(a))}),a._adjustTickLabelsOverflow=function(){var b=a.ticklabeloverflow;if(b&&"allow"!==b){var q=-1!==b.indexOf("hide"),j="x"===a._id.charAt(0),f=0,g=j?m._fullLayout.width:m._fullLayout.height;if(-1!==b.indexOf("domain")){var l=h.simpleMap(a.range,a.r2l);f=a.l2p(l[0])+a._offset,g=a.l2p(l[1])+a._offset}var r=Math.min(f,g),t=Math.max(f,g),u=a.side,n=1/0,o=-1/0;for(var p in d.each(function(f){var d=k.select(this);if(d.select(".text-math-group").empty()){var b=s.bBox(d.node()),c=0;j?b.right>t?c=1:b.left<r&&(c=1):b.bottom>t?c=1:b.top+(a.tickangle?0:f.fontSize/4)<r&&(c=1);var e=d.select("text");c?q&&e.style("opacity",0):(e.style("opacity",1),n="bottom"===u||"right"===u?Math.min(n,j?b.top:b.left):-1/0,o="top"===u||"left"===u?Math.max(o,j?b.bottom:b.right):1/0)}}),c._plots){var e=c._plots[p];if(a._id===e.xaxis._id||a._id===e.yaxis._id){var i=j?e.yaxis:e.xaxis;i&&(i["_visibleLabelMin_"+a._id]=n,i["_visibleLabelMax_"+a._id]=o)}}}},a._hideCounterAxisInsideTickLabels=function(g){var e="x"===a._id.charAt(0),d=[];for(var f in c._plots){var b=c._plots[f];(a._id===b.xaxis._id||a._id===b.yaxis._id)&&d.push(e?b.yaxis:b.xaxis)}d.forEach(function(b,d){b&&aH(b)&&(g||[L,N,M,O,P]).forEach(function(e){var g="tick"===e.K&&"text"===e.L&&"period"===a.ticklabelmode,f=c._plots[a._mainSubplot];(e.K===L.K?f.zerolinelayer.selectAll("."+a._id+"zl"):e.K===N.K?f.minorGridlayer.selectAll("."+a._id):e.K===M.K?f.gridlayer.selectAll("."+a._id):f[a._id.charAt(0)+"axislayer"]).each(function(){var c=k.select(this);e.L&&(c=c.selectAll(e.L)),c.each(function(c){var f=a.l2p(g?au(c):c.x)+a._offset,h=k.select(this);f<a["_visibleLabelMax_"+b._id]&&f>a["_visibleLabelMin_"+b._id]?h.style("display","none"):"tick"!==e.K||d||h.style("display",null)})})})})},t(d,j+1?j:r);var u=null;a._selections&&(a._selections[f]=d);var e=[function(){return x.length&&Promise.all(x)}];a.automargin&&c._redrawFromAutoMarginCount&&90===j?(u=90,e.push(function(){t(d,j)})):e.push(function(){if(t(d,r),q.length&&"x"===v&&!l(r)&&("log"!==a.type||"D"!==String(a.dtick).charAt(0))){u=0;var c,m=0,e=[];if(d.each(function(c){m=Math.max(m,c.fontSize);var d=a.l2p(c.x),f=ay(this),b=s.bBox(f.node());e.push({top:0,bottom:10,height:10,left:d-b.width/2,right:d+b.width/2+2,width:b.width+2})}),("boundaries"===a.tickson||a.showdividers)&&!b.secondary){var i=2;for(a.ticks&&(i+=a.tickwidth/2),c=0;c<e.length;c++){var f=q[c].xbnd,j=e[c];if(null!==f[0]&&j.left-a.l2p(f[0])<i||null!==f[1]&&a.l2p(f[1])-j.right<i){u=90;break}}}else{var k=q.length,n=Math.abs((q[k-1].x-q[0].x)*a._m)/(k-1),B=a.ticklabelposition||"",g=function(a){return -1!==B.indexOf(a)},o=g("top"),p=g("left"),w=g("right"),x=g("bottom"),y=x||p||o||w,z=y?(a.tickwidth||0)+2*V:0,A=n<2.5*m||"multicategory"===a.type||"realaxis"===a._name;for(c=0;c<e.length-1;c++)if(h.bBoxIntersect(e[c],e[c+1],z)){u=A?90:30;break}}u&&t(d,u)}}),a._tickAngles&&e.push(function(){a._tickAngles[f]=null===u?l(r)?r:0:u});var g=a._anchorAxis;g&&g.autorange&&aH(a)&&!Y(c,a._id)&&(c._insideTickLabelsAutorange||(c._insideTickLabelsAutorange={}),c._insideTickLabelsAutorange[g._name+".autorange"]=g.autorange,e.push(function(){d.each(function(d,c){var b=ay(this);b.select(".text-math-group").empty()&&(a._vals[c].bb=s.bBox(b.node()))})}));var i=h.syncOrAsync(e);return i&&i.then&&m._promises.push(i),i},a.getPxPosition=function(f,a){var b,c=f._fullLayout._size,e=a._id.charAt(0),d=a.side;return("free"!==a.anchor?b=a._anchorAxis:"x"===e?b={_offset:c.t+(1-(a.position||0))*c.h,_length:0}:"y"===e&&(b={_offset:c.l+(a.position||0)*c.w,_length:0}),"top"===d||"left"===d)?b._offset:"bottom"===d||"right"===d?b._offset+b._length:void 0},a.shouldShowZeroLine=function(d,b,e){var c=h.simpleMap(b.range,b.r2l);return c[0]*c[1]<=0&&b.zeroline&&("linear"===b.type||"-"===b.type)&&!(b.rangebreaks&&b.maskBreaks(0)===K)&&(ax(b,0)||!function(e,b,c,f){var g=c._mainAxis;if(g){var l=e._fullLayout,m=b._id.charAt(0),n=a.counterLetter(b._id),h=b._offset+(Math.abs(f[0])<Math.abs(f[1])==("x"===m)?0:b._length),i=l._plots[c._mainSubplot];if(!(i.mainplotinfo||i).overlays.length)return o(c,h);for(var j=a.list(e,n),d=0;d<j.length;d++){var k=j[d];if(k._mainAxis===g&&o(k,h))return!0}}function o(a){if(!a.showline||!a.linewidth)return!1;var f=Math.max((a.linewidth+b.zerolinewidth)/2,1);function c(a){return"number"==typeof a&&Math.abs(a-h)<f}if(c(a._mainLinePosition)||c(a._mainMirrorPosition))return!0;var d=a._linepositions||{};for(var e in d)if(c(d[e][0])||c(d[e][1]))return!0}}(d,b,e,c)||function(f,c){for(var d=f._fullData,g=c._mainSubplot,e=c._id.charAt(0),b=0;b<d.length;b++){var a=d[b];if(!0===a.visible&&a.xaxis+a.yaxis===g){if(n.traceIs(a,"bar-like")&&a.orientation===({x:"h",y:"v"})[e])return!0;if(a.fill&&a.fill.charAt(a.fill.length-1)===e)return!0}}return!1}(d,b))},a.clipEnds=function(b,a){return a.filter(function(a){return ax(b,a.x)})},a.allowAutoMargin=function(c){for(var e=a.list(c,"",!0),d=0;d<e.length;d++){var b=e[d];b.automargin&&(m.allowAutoMargin(c,az(b)),b.mirror&&m.allowAutoMargin(c,aA(b))),n.getComponentMethod("rangeslider","isVisible")(b)&&m.allowAutoMargin(c,aB(b))}},a.swap=function(c,d){for(var b=function(i,g){var b=[];for(j=0;j<g.length;j++){var j,a,h,c=[],d=i._fullData[g[j]].xaxis,e=i._fullData[g[j]].yaxis;if(d&&e){for(a=0;a<b.length;a++)(-1!==b[a].x.indexOf(d)|| -1!==b[a].y.indexOf(e))&&c.push(a);if(!c.length){b.push({x:[d],y:[e]});continue}var f=b[c[0]];if(c.length>1)for(a=1;a<c.length;a++)h=b[c[a]],aC(f.x,h.x),aC(f.y,h.y);aC(f.x,[d]),aC(f.y,[e])}}return b}(c,d),a=0;a<b.length;a++)aD(c,b[a].x,b[a].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(a,c,d){"use strict";var e=a("fast-isnumeric"),b=a("../../lib"),f=a("../../constants/numerical").BADNUM,g=b.isArrayOrTypedArray,h=b.isDateTime,i=b.cleanNumber,j=Math.round;function k(a,b){return b?e(a):"number"==typeof a}function l(a){return Math.max(1,(a-1)/1e3)}c.exports=function(q,r,d){var m,a=q,n=d.noMultiCategory;if(g(a)&&!a.length)return"-";if(!n&&g((m=a)[0])&&g(m[1]))return"multicategory";if(n&&Array.isArray(a[0])){for(var o=[],b=0;b<a.length;b++)if(g(a[b]))for(var c=0;c<a[b].length;c++)o.push(a[b][c]);a=o}if(function(c,m){for(var d=c.length,n=l(d),f=0,g=0,i={},a=0;a<d;a+=n){var b=c[j(a)],k=String(b);!i[k]&&(i[k]=1,h(b,m)&&f++,e(b)&&g++)}return f>2*g}(a,r))return"date";var p="strict"!==d.autotypenumbers;return!function(e,n){for(var g=e.length,o=l(g),h=0,a=0,k={},b=0;b<g;b+=o){var c=e[j(b)],m=String(c);if(!k[m]){k[m]=1;var d=typeof c;"boolean"===d?a++:(n?i(c)!==f:"number"===d)?h++:"string"===d&&a++}}return a>2*h}(a,p)?!function(b,c){for(var d=b.length,a=0;a<d;a++)if(k(b[a],c))return!0;return!1}(a,p)?"-":"linear":"category"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../registry"),f=a("../../lib"),g=a("../../plot_api/plot_template"),h=a("../array_container_defaults"),i=a("./layout_attributes"),j=a("./tick_value_defaults"),k=a("./tick_mark_defaults"),l=a("./tick_label_defaults"),m=a("./prefix_suffix_defaults"),n=a("./category_order_defaults"),o=a("./line_grid_defaults"),p=a("./set_convert"),q=a("./constants").WEEKDAY_PATTERN,r=a("./constants").HOUR_PATTERN;function s(n,e,k){function h(a,b){return f.coerce(n,e,i.rangebreaks,a,b)}if(h("enabled")){var c=h("bounds");if(c&&c.length>=2){var a,b,l="";if(2===c.length){for(a=0;a<2;a++)if(b=u(c[a])){l=q;break}}var j=h("pattern",l);if(j===q)for(a=0;a<2;a++)(b=u(c[a]))&&(e.bounds[a]=c[a]=b-1);if(j)for(a=0;a<2;a++)switch(b=c[a],j){case q:if(!d(b)){e.enabled=!1;return}if((b=+b)!==Math.floor(b)||b<0||b>=7){e.enabled=!1;return}e.bounds[a]=c[a]=b;break;case r:if(!d(b)){e.enabled=!1;return}if((b=+b)<0||b>24){e.enabled=!1;return}e.bounds[a]=c[a]=b;break}if(!1===k.autorange){var g=k.range;if(g[0]<g[1]){if(c[0]<g[0]&&c[1]>g[1]){e.enabled=!1;return}}else if(c[0]>g[0]&&c[1]<g[1]){e.enabled=!1;return}}}else{var m=h("values");if(m&&m.length)h("dvalue");else{e.enabled=!1;return}}}}b.exports=function(r,a,c,b,t){var C,D,E=b.letter,w=b.font||{},G=b.splomStash||{},H=c("visible",!b.visibleDflt),I=a._template||{},d=a.type||I.type||"-";"date"===d&&(e.getComponentMethod("calendars","handleDefaults")(r,a,"calendar",b.calendar),b.noTicklabelmode||(C=c("ticklabelmode")));var F="";b.noTicklabelposition&&"multicategory"!==d||(F=f.coerce(r,a,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:"period"===C?["outside","inside"]:"x"===E?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),b.noTicklabeloverflow||c("ticklabeloverflow",-1!==F.indexOf("inside")?"hide past domain":"category"===d||"multicategory"===d?"allow":"hide past div"),p(a,t);var x=!a.isValidRange(r.range);x&&b.reverseDflt&&(x="reversed"),c("autorange",x)&&("linear"===d||"-"===d)&&c("rangemode"),c("range"),a.cleanRange(),n(r,a,c,b),"category"===d||b.noHover||c("hoverformat");var y=c("color"),J=y!==i.color.dflt?y:w.color,K=G.label||t._dfltTitle[E];if(m(r,a,c,d,b),!H)return a;c("title.text",K),f.coerceFont(c,"title.font",{family:w.family,size:f.bigFont(w.size),color:J}),j(r,a,c,d);var v=b.hasMinor;if(v&&(g.newContainer(a,"minor"),j(r,a,c,d,{isMinor:!0})),l(r,a,c,d,b),k(r,a,c,b),v){var L=b.isMinor;b.isMinor=!0,k(r,a,c,b),b.isMinor=L}o(r,a,c,{dfltColor:y,bgColor:b.bgColor,showGrid:b.showGrid,hasMinor:v,attributes:i}),!v||a.minor.ticks||a.minor.showgrid||delete a.minor,(a.showline||a.ticks)&&c("mirror"),b.automargin&&c("automargin");var z="multicategory"===d;if(!b.noTickson&&("category"===d||z)&&(a.ticks||a.showgrid)&&(z&&(D="boundaries"),"boundaries"===c("tickson",D)&&delete a.ticklabelposition),z&&c("showdividers")&&(c("dividercolor"),c("dividerwidth")),"date"===d)if(h(r,a,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:s}),a.rangebreaks.length){for(var A=0;A<a.rangebreaks.length;A++)if(a.rangebreaks[A].pattern===q){a._hasDayOfWeekBreaks=!0;break}if(p(a,t),t._has("scattergl")||t._has("splom"))for(var B=0;B<b.data.length;B++){var u=b.data[B];("scattergl"===u.type||"splom"===u.type)&&(u.visible=!1,f.warn(u.type+" traces do not work on axes with rangebreaks. Setting trace "+u.index+" to `visible: false`."))}}else delete a.rangebreaks;return a};var t={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function u(a){if("string"==typeof a)return t[a.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(b,c,f){"use strict";var a=b("../../constants/docs"),g=a.FORMAT_LINK,h=a.DATE_FORMAT_LINK;function d(b,a){return["Sets the "+b+" formatting rule"+(a?"for `"+a+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+g+"."].join(" ")}function e(a,b){return d(a,b)+[" And for dates see: "+h+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}c.exports={axisHoverFormat:function(a,b){return{valType:"string",dflt:"",editType:"none",description:(b?d:e)("hover text",a)+["By default the values are formatted using "+(b?"generic number format":"`"+a+"axis.hoverformat`")+".",].join(" ")}},descriptionOnlyNumbers:d,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(b,c,a){"use strict";var d=b("../../registry"),e=b("./constants");function f(c,a){if(a&&a.length){for(var b=0;b<a.length;b++)if(a[b][c])return!0}return!1}a.id2name=function(a){if("string"==typeof a&&a.match(e.AX_ID_PATTERN)){var b=a.split(" ")[0].substr(1);return"1"===b&&(b=""),a.charAt(0)+"axis"+b}},a.name2id=function(a){if(a.match(e.AX_NAME_PATTERN)){var b=a.substr(5);return"1"===b&&(b=""),a.charAt(0)+b}},a.cleanId=function(a,c,d){var f=/( domain)$/.test(a);if("string"==typeof a&&a.match(e.AX_ID_PATTERN)&&(!c||a.charAt(0)===c)&&(!f||d)){var b=a.split(" ")[0].substr(1).replace(/^0+/,"");return"1"===b&&(b=""),a.charAt(0)+b+(f&&d?" domain":"")}},a.list=function(h,f,k){var b,c=h._fullLayout;if(!c)return[];var g=a.listIds(h,f),d=new Array(g.length);for(b=0;b<g.length;b++){var i=g[b];d[b]=c[i.charAt(0)+"axis"+i.substr(1)]}if(!k){var j=c._subplots.gl3d||[];for(b=0;b<j.length;b++){var e=c[j[b]];f?d.push(e[f+"axis"]):d.push(e.xaxis,e.yaxis,e.zaxis)}}return d},a.listIds=function(d,b){var c=d._fullLayout;if(!c)return[];var a=c._subplots;return b?a[b+"axis"]:a.xaxis.concat(a.yaxis)},a.getFromId=function(d,b,c){var e=d._fullLayout;return b=void 0===b||"string"!=typeof b?b:b.replace(" domain",""),"x"===c?b=b.replace(/y[0-9]*/,""):"y"===c&&(b=b.replace(/x[0-9]*/,"")),e[a.id2name(b)]},a.getFromTrace=function(f,b,c){var h=f._fullLayout,e=null;if(d.traceIs(b,"gl3d")){var g=b.scene;"scene"===g.substr(0,5)&&(e=h[g][c+"axis"])}else e=a.getFromId(f,b[c+"axis"]||c);return e},a.idSort=function(a,b){var c=a.charAt(0),d=b.charAt(0);return c!==d?c>d?1:-1:+(a.substr(1)||1)- +(b.substr(1)||1)},a.ref2id=function(a){return!!/^[xyz]/.test(a)&&a.split(" ")[0]},a.isLinked=function(a,b){return f(b,a._axisMatchGroups)||f(b,a._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(b,a,c){"use strict";a.exports=function(h,a,d,i){if("category"===a.type){var e,c,f=h.categoryarray,g=Array.isArray(f)&&f.length>0;g&&(e="array");var b=d("categoryorder",e);"array"===b&&(c=d("categoryarray")),g||"array"!==b||(b=a.categoryorder="trace"),"trace"===b?a._initialCategories=[]:"array"===b?a._initialCategories=c.slice():(c=(function(e,b){var c,a,d,f=b.dataAttr||e._id.charAt(0),g={};if(b.axData)c=b.axData;else for(a=0,c=[];a<b.data.length;a++){var h=b.data[a];h[f+"axis"]===e._id&&c.push(h)}for(a=0;a<c.length;a++){var i=c[a][f];for(d=0;d<i.length;d++){var j=i[d];null!=j&&(g[j]=1)}}return Object.keys(g)})(a,i).sort(),"category ascending"===b?a._initialCategories=c:"category descending"===b&&(a._initialCategories=c.reverse()))}}},{}],572:[function(a,d,b){"use strict";var e=a("fast-isnumeric"),f=a("../../lib"),c=a("../../constants/numerical"),g=c.ONEDAY,h=c.ONEWEEK;b.dtick=function(a,f){var h="log"===f,c="date"===f,d=c?g:1;if(!a)return d;if(e(a))return(a=Number(a))<=0?d:"category"===f?Math.max(1,Math.round(a)):c?Math.max(.1,a):a;if("string"!=typeof a||!(c||h))return d;var i=a.charAt(0),b=a.substr(1);return(b=e(b)?Number(b):0)<=0||!(c&&"M"===i&&b===Math.round(b)||h&&"L"===i||h&&"D"===i&&(1===b||2===b))?d:a},b.tick0=function(a,c,d,b){return"date"===c?f.cleanDate(a,f.dateTick0(d,b%h==0?1:0)):"D1"!==b&&"D2"!==b?e(a)?Number(a):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(b,c,d){"use strict";var a=b("../../lib/regex").counter;c.exports={idRegex:{x:a("x","( domain)?"),y:a("y","( domain)?")},attrRegex:a("[xy]axis"),xAxisMatch:a("xaxis"),yAxisMatch:a("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(a,c,b){"use strict";var d=a("../../lib"),e=a("./autorange"),f=a("./axis_ids").id2name,g=a("./layout_attributes"),h=a("./scale_zoom"),i=a("./set_convert"),j=a("../../constants/numerical").ALMOST_EQUAL,k=a("../../constants/alignment").FROM_BL;function l(b,a,q){var c,k,h,r,p=q.axIds,i=q.layoutOut,w=q.hasImage,s=i._axisConstraintGroups,D=i._axisMatchGroups,x=a._id,E=x.charAt(0),t=((i._splomAxes||{})[E]||{})[x]||{},j=a._id,l="x"===j.charAt(0);function y(c,e){return d.coerce(b,a,g,c,e)}a._matchGroup=null,a._constraintGroup=null,y("constrain",w?"domain":"range"),d.coerce(b,a,{constraintoward:{valType:"enumerated",values:l?["left","center","right"]:["bottom","middle","top"],dflt:l?"center":"middle"}},"constraintoward");var F=a.type,e=[];for(c=0;c<p.length;c++)(k=p[c])!==j&&i[f(k)].type===F&&e.push(k);var z=n(s,j);if(z){var A=[];for(c=0;c<e.length;c++)z[k=e[c]]||A.push(k);e=A}var B=e.length;B&&(b.matches||t.matches)&&(h=d.coerce(b,a,{matches:{valType:"enumerated",values:e,dflt:-1!==e.indexOf(t.matches)?t.matches:void 0}},"matches"));var C=w&&!l?a.anchor:void 0;if(B&&!h&&(b.scaleanchor||C)&&(r=d.coerce(b,a,{scaleanchor:{valType:"enumerated",values:e}},"scaleanchor",C)),h){a._matchGroup=o(D,j,h,1);var G=i[f(h)],u=m(i,a)/m(i,G);l!==("x"===h.charAt(0))&&(u=(l?"x":"y")+u),o(s,j,h,u)}else b.matches&& -1!==p.indexOf(b.matches)&&d.warn("ignored "+a._name+'.matches: "'+b.matches+'" to avoid an infinite loop');if(r){var v=y("scaleratio");v||(v=a.scaleratio=1),o(s,j,r,v)}else b.scaleanchor&& -1!==p.indexOf(b.scaleanchor)&&d.warn("ignored "+a._name+'.scaleanchor: "'+b.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function m(c,b){var a=b.domain;return a||(a=c[f(b.overlaying)].domain),a[1]-a[0]}function n(b,c){for(var a=0;a<b.length;a++)if(b[a][c])return b[a];return null}function o(c,j,h,i){var d,b,e,k,f,a=n(c,j);null===a?((a={})[j]=1,f=c.length,c.push(a)):f=c.indexOf(a);var g=Object.keys(a);for(d=0;d<c.length;d++)if(e=c[d],d!==f&&e[h]){var m=e[h];for(b=0;b<g.length;b++)e[k=g[b]]=p(m,p(i,a[k]));c.splice(f,1);return}if(1!==i)for(b=0;b<g.length;b++){var l=g[b];a[l]=p(i,a[l])}a[h]=1}function p(c,d){var a,b,e="",f="";"string"==typeof c&&(a=(e=c.match(/^[xy]*/)[0]).length,c=+c.substr(a)),"string"==typeof d&&(b=(f=d.match(/^[xy]*/)[0]).length,d=+d.substr(b));var g=c*d;return a||b?a&&b&&e.charAt(0)!==f.charAt(0)?a===b?g:(a>b?e.substr(b):f.substr(a))+g:e+f+c*d:g}function q(c,l){for(var d=l._size,e=d.h/d.w,f={},g=Object.keys(c),b=0;b<g.length;b++){var h=g[b],a=c[h];if("string"==typeof a){var i=a.match(/^[xy]*/)[0],j=i.length;a=+a.substr(j);for(var m="y"===i.charAt(0)?e:1/e,k=0;k<j;k++)a*=m}f[h]=a}return f}function r(a,d){var b=a._inputDomain,e=k[a.constraintoward],c=b[0]+(b[1]-b[0])*e;a.domain=a._input.domain=[c+(b[0]-c)/d,c+(b[1]-c)/d],a.setScale()}b.handleDefaults=function(j,b,r){var k=r.axIds,y=r.axHasImage,g=b._axisConstraintGroups=[],m=b._axisMatchGroups=[];for(B=0;B<k.length;B++)o=j[x=f(k[B])],e=b[x],l(o,e,{axIds:k,layoutOut:b,hasImage:y[x]});function s(a,c){for(B=0;B<a.length;B++)for(h in w=a[B])b[f(h)][c]=w}for(s(m,"_matchGroup"),B=0;B<g.length;B++)for(h in w=g[B])if((e=b[f(h)]).fixedrange){for(var z in w){var n=f(z);!1===(j[n]||{}).fixedrange&&d.warn("fixedrange was specified as false for axis "+n+" but was overridden because another axis in its constraint group has fixedrange true"),b[n].fixedrange=!0}break}for(B=0;B<g.length;){for(h in w=g[B]){(e=b[f(h)])._matchGroup&&Object.keys(e._matchGroup).length===Object.keys(w).length&&(g.splice(B,1),B--);break}B++}s(g,"_constraintGroup");var t=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],u=!1,A=!1;function v(){c=e[a],"rangebreaks"===a&&(A=e._hasDayOfWeekBreaks)}for(B=0;B<m.length;B++){w=m[B];for(var B,w,h,x,o,e,a,c,p,q=0;q<t.length;q++){for(h in a=t[q],c=null,w)if(o=j[x=f(h)],e=b[x],a in e){if(!e.matches&&(p=e,a in o)){v();break}null===c&&a in o&&v()}if("range"===a&&c&&(u=!0),"autorange"===a&&null===c&&u&&(c=!1),null===c&&a in p&&(c=p[a]),null!==c)for(h in w)(e=b[f(h)])[a]="range"===a?c.slice():c,"rangebreaks"===a&&(e._hasDayOfWeekBreaks=A,i(e,b))}}},b.enforce=function(y){var i=y._fullLayout,z=i._axisConstraintGroups||[];for(L=0;L<z.length;L++){N=q(z[L],i);var m=Object.keys(N),o=1/0,p=0,n=1/0,A={},B={},C=!1;for(M=0;M<m.length;M++)B[O=m[M]]=a=i[f(O)],a._inputDomain?a.domain=a._inputDomain.slice():a._inputDomain=a.domain.slice(),a._inputRange||(a._inputRange=a.range.slice()),a.setScale(),A[O]=P=Math.abs(a._m)/N[O],o=Math.min(o,P),"domain"!==a.constrain&&a._constraintShrinkable||(n=Math.min(n,P)),delete a._constraintShrinkable,p=Math.max(p,P),"domain"===a.constrain&&(C=!0);if(!(o>j*p)||C){for(M=0;M<m.length;M++)if(P=A[O=m[M]],a=B[O],Q=a.constrain,P!==n||"domain"===Q)if(k=P/n,"range"===Q)h(a,k);else{var s=a._inputDomain,G=(a.domain[1]-a.domain[0])/(s[1]-s[0]),t=(a.r2l(a.range[1])-a.r2l(a.range[0]))/(a.r2l(a._inputRange[1])-a.r2l(a._inputRange[0]));if((k/=G)*t<1){a.domain=a._input.domain=s.slice(),h(a,k);continue}if(t<1&&(a.range=a._input.range=a._inputRange.slice(),k*=t),a.autorange){var L,M,N,O,a,P,Q,k,g,b,D=a.r2l(a.range[0]),u=a.r2l(a.range[1]),l=(D+u)/2,c=l,d=l,v=Math.abs(u-l),H=l-v*k*1.0001,I=l+v*k*1.0001,J=e.makePadFn(i,a,0),K=e.makePadFn(i,a,1);r(a,k);var E=Math.abs(a._m),F=e.concatExtremes(y,a),w=F.min,x=F.max;for(b=0;b<w.length;b++)(g=w[b].val-J(w[b])/E)>H&&g<c&&(c=g);for(b=0;b<x.length;b++)(g=x[b].val+K(x[b])/E)<I&&g>d&&(d=g);k/=(d-c)/(2*v),c=a.l2r(c),d=a.l2r(d),a.range=a._input.range=D<u?[c,d]:[d,c]}r(a,k)}}}},b.getAxisGroup=function(d,b){for(var c=d._axisMatchGroups,a=0;a<c.length;a++)if(c[a][b])return"g"+a;return b},b.clean=function(e,a){if(a._inputDomain){for(var c=!1,f=a._id,d=e._fullLayout._axisConstraintGroups,b=0;b<d.length;b++)if(d[b][f]){c=!0;break}c&&"domain"===a.constrain||(a._input.domain=a.domain=a._inputDomain,delete a._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(a,e,p){"use strict";var q=a("@plotly/d3"),b=a("../../lib"),r=b.numberFormat,s=a("tinycolor2"),t=a("has-passive-events"),u=a("../../registry"),v=b.strTranslate,w=a("../../lib/svg_text_utils"),x=a("../../components/color"),y=a("../../components/drawing"),z=a("../../components/fx"),A=a("./axes"),B=a("../../lib/setcursor"),C=a("../../components/dragelement"),c=a("../../components/dragelement/helpers"),D=c.selectingOrDrawing,E=c.freeMode,F=a("../../constants/alignment").FROM_TL,G=a("../../lib/clear_gl_canvases"),H=a("../../plot_api/subroutines").redrawReglTraces,I=a("../plots"),J=a("./axis_ids").getFromId,K=a("../../components/selections").prepSelect,L=a("../../components/selections").clearOutline,M=a("../../components/selections").selectOnClick,N=a("./scale_zoom"),d=a("./constants"),O=d.MINDRAG,P=d.MINZOOM,Q=!0;function f(c,d,e,f){var a=b.ensureSingle(c.draglayer,d,e,function(a){a.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",c.id)});return a.call(B,f),a.node()}function g(b,c,d,e,g,h,i){var a=f(b,"rect",c,d);return q.select(a).call(y.setRect,e,g,h,i),a}function R(b,c){for(var a=0;a<b.length;a++)if(!b[a].fixedrange)return c;return""}function S(h,c,d,b,e){for(var f=0;f<h.length;f++){var a=h[f];if(!a.fixedrange)if(a.rangebreaks){var i="y"===a._id.charAt(0),l=i?1-c:c,m=i?1-d:d;b[a._name+".range[0]"]=a.l2r(a.p2l(l*a._length)),b[a._name+".range[1]"]=a.l2r(a.p2l(m*a._length))}else{var g=a._rl[0],j=a._rl[1]-g;b[a._name+".range[0]"]=a.l2r(g+j*c),b[a._name+".range[1]"]=a.l2r(g+j*d)}}if(e&&e.length){var k=(c+(1-d))/2;S(e,k,1-k,b,[])}}function T(d,b){for(var c=0;c<d.length;c++){var a=d[c];if(!a.fixedrange)if(a.rangebreaks){var e=0,f=a._length,h=a.p2l(e+b)-a.p2l(e),i=a.p2l(f+b)-a.p2l(f),g=(h+i)/2;a.range=[a.l2r(a._rl[0]-g),a.l2r(a._rl[1]-g)]}else a.range=[a.l2r(a._rl[0]-b/a._m),a.l2r(a._rl[1]-b/a._m)]}}function U(a){return 1-(a>=0?Math.min(a,.9):1/(1/Math.max(a,-0.3)+3.222))}function h(a,b,c,d,e){return a.append("path").attr("class","zoombox").style({fill:b>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",v(c,d)).attr("d",e+"Z")}function i(a,b,c){return a.append("path").attr("class","zoombox-corners").style({fill:x.background,stroke:x.defaultLine,"stroke-width":1,opacity:0}).attr("transform",v(b,c)).attr("d","M0,0Z")}function j(b,c,a,d,e,f){b.attr("d",d+"M"+a.l+","+a.t+"v"+a.h+"h"+a.w+"v-"+a.h+"h-"+a.w+"Z"),k(b,c,e,f)}function k(a,b,c,d){c||(a.transition().style("fill",d>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),b.transition().style("opacity",1).duration(200))}function l(a){q.select(a).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function m(a){Q&&a.data&&a._context.showTips&&(b.notifier(b._(a,"Double-click to zoom back out"),"long"),Q=!1)}function n(b){var a=Math.floor(Math.min(b.b-b.t,b.r-b.l,P)/2);return"M"+(b.l-3.5)+","+(b.t-.5+a)+"h3v"+ -a+"h"+a+"v-3h-"+(a+3)+"ZM"+(b.r+3.5)+","+(b.t-.5+a)+"h-3v"+ -a+"h"+ -a+"v-3h"+(a+3)+"ZM"+(b.r+3.5)+","+(b.b+.5-a)+"h-3v"+a+"h"+ -a+"v3h"+(a+3)+"ZM"+(b.l-3.5)+","+(b.b+.5-a)+"h3v"+a+"h"+a+"v3h-"+(a+3)+"Z"}function V(r,s,j,h,e){for(var k,d,a,c,l=!1,i={},f={},m=(e||{}).xaHash,n=(e||{}).yaHash,o=0;o<s.length;o++){var g=s[o];for(k in j)if(g[k]){for(a in g)e&&(m[a]||n[a])||("x"===a.charAt(0)?j:h)[a]||(i[a]=k);for(d in h)!(e&&(m[d]||n[d]))&&g[d]&&(l=!0)}for(d in h)if(g[d])for(c in g)e&&(m[c]||n[c])||("x"===c.charAt(0)?j:h)[c]||(f[c]=d)}l&&(b.extendFlat(i,f),f={});var t={},u=[];for(a in i){var p=J(r,a);u.push(p),t[p._id]=p}var v={},w=[];for(c in f){var q=J(r,c);w.push(q),v[q._id]=q}return{xaHash:t,yaHash:v,xaxes:u,yaxes:w,xLinks:i,yLinks:f,isSubplotConstrained:l}}function o(a,b){if(t){var c=void 0!==a.onwheel?"wheel":"mousewheel";a._onwheel&&a.removeEventListener(c,a._onwheel),a._onwheel=b,a.addEventListener(c,b,{passive:!1})}else void 0!==a.onwheel?a.onwheel=b:void 0!==a.onmousewheel?a.onmousewheel=b:a.isAddedWheelEvent||(a.isAddedWheelEvent=!0,a.addEventListener("wheel",b,{passive:!1}))}function W(a){var b=[];for(var c in a)b.push(a[c]);return b}e.exports={makeDragBox:function(e,c,Q,X,Y,Z,f,k){var p,t,v,ae,af,ag,ah,ai,aj,ak,al,$,_,am,an,aa,ab,ac,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG=e._fullLayout._zoomlayer,x=f+k==="nsew",aH=1===(f+k).length;function ad(){if(ae=c.xaxis,af=c.yaxis,$=ae._length,_=af._length,ak=ae._offset,al=af._offset,ag={},ag[ae._id]=ae,ah={},ah[af._id]=af,f&&k)for(var b=c.overlays,a=0;a<b.length;a++){var g=b[a].xaxis;ag[g._id]=g;var h=b[a].yaxis;ah[h._id]=h}ai=W(ag),aj=W(ah),aa=R(ai,k),ab=R(aj,f),ac=!ab&&!aa,an=V(e,e._fullLayout._axisMatchGroups,ag,ah);var i=(am=V(e,e._fullLayout._axisConstraintGroups,ag,ah,an)).isSubplotConstrained||an.isSubplotConstrained;ao=k||i,ap=f||i;var d=e._fullLayout;aq=d._has("scattergl"),ar=d._has("splom"),as=d._has("svg")}ad();var a=g(c,f+k+"drag",(p=ab+aa,t=e._fullLayout.dragmode,v=x,p?"nsew"===p?v?"":"pan"===t?"move":"crosshair":p.toLowerCase()+"-resize":"pointer"),Q,X,Y,Z);if(ac&&!x)return a.onmousedown=null,a.style.pointerEvents="none",a;var B={element:a,gd:e,plotinfo:c};function aI(){B.plotinfo.selection=!1,L(e)}function aJ(m,n){var b=B.gd;if(b._fullLayout._activeShapeIndex>=0){b._fullLayout._deactivateShape(b);return}var o=b._fullLayout.clickmode;if(l(b),2!==m||aH||aU(),x)o.indexOf("select")> -1&&M(n,b,ai,aj,c.id,B),o.indexOf("event")> -1&&z.click(b,n,c.id);else if(1===m&&aH){var e,h,g,i,d=f?af:ae,p="s"===f||"w"===k?0:1,v=d._name+".range["+p+"]",t=(e=d,h=p,i=Math.abs((g=e.range[h])-e.range[1-h]),"date"===e.type?g:"log"===e.type?r("."+(Math.ceil(Math.max(0,-Math.log(i)/Math.LN10))+3)+"g")(Math.pow(10,g)):r("."+String(Math.floor(Math.log(Math.abs(g))/Math.LN10)-Math.floor(Math.log(i)/Math.LN10)+4)+"g")(g)),j="left",s="middle";if(d.fixedrange)return;f?(s="n"===f?"top":"bottom","right"===d.side&&(j="right")):"e"===k&&(j="right"),b._context.showAxisRangeEntryBoxes&&q.select(a).call(w.makeEditable,{gd:b,immediate:!0,background:b._fullLayout.paper_bgcolor,text:String(t),fill:d.tickfont?d.tickfont.color:"#444",horizontalAlign:j,verticalAlign:s}).on("edit",function(c){var a=d.d2r(c);void 0!==a&&u.call("_guiRelayout",b,v,a)})}}function aK(o,p){if(e._transitioningWithDuration)return!1;var f,g,h,k,c=Math.max(0,Math.min($,au*o+aw)),d=Math.max(0,Math.min(_,av*p+ax)),a=Math.abs(c-aw),b=Math.abs(d-ax);function i(){aC="",ay.r=ay.l,ay.t=ay.b,aE.attr("d","M0,0Z")}if(ay.l=Math.min(aw,c),ay.r=Math.max(aw,c),ay.t=Math.min(ax,d),ay.b=Math.max(ax,d),am.isSubplotConstrained)a>P||b>P?(aC="xy",a/$>b/_?(b=a*_/$,ax>d?ay.t=ax-b:ay.b=ax+b):(a=b*$/_,aw>c?ay.l=aw-a:ay.r=aw+a),aE.attr("d",n(ay))):i();else if(an.isSubplotConstrained)if(a>P||b>P){aC="xy";var l=Math.min(ay.l/$,(_-ay.b)/_),m=Math.max(ay.r/$,(_-ay.t)/_);ay.l=l*$,ay.r=m*$,ay.b=(1-l)*_,ay.t=(1-m)*_,aE.attr("d",n(ay))}else i();else!ab||b<Math.min(Math.max(.6*a,O),P)?a<O||!aa?i():(ay.t=0,ay.b=_,aC="x",aE.attr("d",(f=ay,g=ax,"M"+(f.l-.5)+","+(g-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(f.r+.5)+","+(g-P-.5)+"h3v"+(2*P+1)+"h-3Z"))):!aa||a<Math.min(.6*b,P)?(ay.l=0,ay.r=$,aC="y",aE.attr("d",(h=ay,"M"+((k=aw)-P-.5)+","+(h.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(k-P-.5)+","+(h.b+.5)+"v3h"+(2*P+1)+"v-3Z"))):(aC="xy",aE.attr("d",n(ay)));ay.w=ay.r-ay.l,ay.h=ay.b-ay.t,aC&&(aF=!0),e._dragged=aF,j(aD,aE,ay,aA,aB,az),aL(),e.emit("plotly_relayouting",at),aB=!0}function aL(){at={},("xy"===aC||"x"===aC)&&(S(ai,ay.l/$,ay.r/$,at,am.xaxes),aS("x",at)),("xy"===aC||"y"===aC)&&(S(aj,(_-ay.b)/_,(_-ay.t)/_,at,am.yaxes),aS("y",at))}function aM(){aL(),l(e),aV(),m(e)}B.prepFn=function(d,g,j){var k,l,m,f,n=B.dragmode,c=e._fullLayout.dragmode;c!==n&&(B.dragmode=c),ad(),au=e._fullLayout._invScaleX,av=e._fullLayout._invScaleY,ac||(x?d.shiftKey?"pan"===c?c="zoom":D(c)||(c="pan"):d.ctrlKey&&(c="pan"):c="pan"),E(c)?B.minDrag=1:B.minDrag=void 0,D(c)?(B.xaxes=ai,B.yaxes=aj,K(d,g,j,B,c)):(B.clickFn=aJ,D(n)&&aI(),ac||("zoom"===c?(B.moveFn=aK,B.doneFn=aM,B.minDrag=1,k=g,l=j,aw=k-(m=a.getBoundingClientRect()).left,ax=l-m.top,e._fullLayout._calcInverseTransform(e),f=b.apply3DTransform(e._fullLayout._invTransform)(aw,ax),aw=f[0],ax=f[1],ay={l:aw,r:aw,w:0,t:ax,b:ax,h:0},az=e._hmpixcount?e._hmlumcount/e._hmpixcount:s(e._fullLayout.plot_bgcolor).getLuminance(),aA="M0,0H"+$+"V"+_+"H0V0",aB=!1,aC="xy",aF=!1,aD=h(aG,az,ak,al,aA),aE=i(aG,ak,al)):"pan"!==c||(B.moveFn=aR,B.doneFn=aV))),e._fullLayout._redrag=function(){var b=e._dragdata;b&&b.element===a&&(D(e._fullLayout.dragmode)||(ad(),aW([0,0,$,_]),B.moveFn(b.dx,b.dy)))}},C.init(B);var aN=[0,0,$,_],aO=null,aP=d.REDRAWDELAY,aQ=c.mainplot?e._fullLayout._plots[c.mainplot]:c;function aR(a,b){if(a*=au,b*=av,!e._transitioningWithDuration){if(e._fullLayout._replotting=!0,"ew"===aa||"ns"===ab){var d,f,c,g=aa?-a:0,h=ab?-b:0;if(an.isSubplotConstrained){if(aa&&ab){var l=(a/$-b/_)/2;a=l*$,b=-l*_,g=-a,h=-b}ab?g=-h*$/_:h=-g*_/$}aa&&(T(ai,a),aS("x")),ab&&(T(aj,b),aS("y")),aW([g,h,$,_]),aT(),e.emit("plotly_relayouting",at);return}var i="w"===aa==("n"===ab)?1:-1;if(aa&&ab&&(am.isSubplotConstrained||an.isSubplotConstrained)){var m=(a/$+i*b/_)/2;a=m*$,b=i*m*_}if("w"===aa?a=n(ai,0,a):"e"===aa?a=n(ai,1,-a):aa||(a=0),"n"===ab?b=n(aj,1,b):"s"===ab?b=n(aj,0,-b):ab||(b=0),d="w"===aa?a:0,f="n"===ab?b:0,am.isSubplotConstrained&&!an.isSubplotConstrained||an.isSubplotConstrained&&aa&&ab&&i>0){if(an.isSubplotConstrained|| !aa&&1===ab.length){for(c=0;c<ai.length;c++)ai[c].range=ai[c]._r.slice(),N(ai[c],1-b/_);d=(a=b*$/_)/2}if(an.isSubplotConstrained|| !ab&&1===aa.length){for(c=0;c<aj.length;c++)aj[c].range=aj[c]._r.slice(),N(aj[c],1-a/$);f=(b=a*_/$)/2}}an.isSubplotConstrained&&ab||aS("x"),an.isSubplotConstrained&&aa||aS("y");var j=$-a,k=_-b;an.isSubplotConstrained&&!(aa&&ab)&&(aa?(f=d?0:a*_/$,k=j*_/$):(d=f?0:b*$/_,j=k*$/_)),aW([d,f,j,k]),aT(),e.emit("plotly_relayouting",at)}function n(h,b,i){for(var c,d,e=1-b,f=0;f<h.length;f++){var a=h[f];if(!a.fixedrange){c=a,d=a._rl[e]+(a._rl[b]-a._rl[e])/U(i/a._length);var g=a.l2r(d);!1!==g&& void 0!==g&&(a.range[b]=g)}}return c._length*(c._rl[b]-d)/(c._rl[b]-c._rl[e])}}function aS(d,a){for(var f=an.isSubplotConstrained?({x:aj,y:ai})[d]:an[d+"axes"],i=an.isSubplotConstrained?({x:ai,y:aj})[d]:[],e=0;e<f.length;e++){var b=f[e],g=b._id,h=an.xLinks[g]||an.yLinks[g],c=i[0]||ag[h]||ah[h];c&&(a?(a[b._name+".range[0]"]=a[c._name+".range[0]"],a[b._name+".range[1]"]=a[c._name+".range[1]"]):b.range=c.range.slice())}}function aT(){var c,d=[];function a(a){for(c=0;c<a.length;c++)a[c].fixedrange||d.push(a[c]._id)}for(ao&&(a(ai),a(am.xaxes),a(an.xaxes)),ap&&(a(aj),a(am.yaxes),a(an.yaxes)),at={},c=0;c<d.length;c++){var b=J(e,d[c]);A.drawOne(e,b,{skipTitle:!0}),at[b._name+".range[0]"]=b.range[0],at[b._name+".range[1]"]=b.range[1]}A.redrawComponents(e,d)}function aU(){if(!e._transitioningWithDuration){var b,c,g,d=e._context.doubleClick,a=[];aa&&(a=a.concat(ai)),ab&&(a=a.concat(aj)),an.xaxes&&(a=a.concat(an.xaxes)),an.yaxes&&(a=a.concat(an.yaxes));var f={};if("reset+autosize"===d){for(c=0,d="autosize";c<a.length;c++)if((b=a[c])._rangeInitial&&(b.range[0]!==b._rangeInitial[0]||b.range[1]!==b._rangeInitial[1])|| !b._rangeInitial&&!b.autorange){d="reset";break}}if("autosize"===d)for(c=0;c<a.length;c++)(b=a[c]).fixedrange||(f[b._name+".autorange"]=!0);else if("reset"===d)for((aa||am.isSubplotConstrained)&&(a=a.concat(am.xaxes)),ab&&!am.isSubplotConstrained&&(a=a.concat(am.yaxes)),am.isSubplotConstrained&&(aa?ab||(a=a.concat(aj)):a=a.concat(ai)),c=0;c<a.length;c++)(b=a[c]).fixedrange||(b._rangeInitial?(g=b._rangeInitial,f[b._name+".range[0]"]=g[0],f[b._name+".range[1]"]=g[1]):f[b._name+".autorange"]=!0);e.emit("plotly_doubleclick",null),u.call("_guiRelayout",e,f)}}function aV(){aW([0,0,$,_]),b.syncOrAsync([I.previousPromises,function(){e._fullLayout._replotting=!1,u.call("_guiRelayout",e,at)}],e)}function aW(i){var p=e._fullLayout,q=p._plots,o=p._subplots.cartesian;if(ar&&u.subplotsRegistry.splom.drag(e),aq){for(z=0;z<o.length;z++)if(d=(h=q[o[z]]).xaxis,g=h.yaxis,h._scene){var r=b.simpleMap(d.range,d.r2l),s=b.simpleMap(g.range,g.r2l);h._scene.update({range:[r[0],s[0],r[1],s[1]]})}}if((ar||aq)&&(G(e),H(e)),as){var m=i[2]/ae._length,n=i[3]/af._length;for(z=0;z<o.length;z++){d=(h=q[o[z]]).xaxis,g=h.yaxis;var z,h,d,g,a,c,j,l,t=(ao||an.isSubplotConstrained)&&!d.fixedrange&&ag[d._id],v=(ap||an.isSubplotConstrained)&&!g.fixedrange&&ah[g._id];if(t?(a=m,j=k||an.isSubplotConstrained?i[0]:aZ(d,a)):an.xaHash[d._id]?(a=m,j=i[0]*d._length/ae._length):an.yaHash[d._id]?(a=n,j="ns"===ab?-i[1]*d._length/af._length:aZ(d,a,{n:"top",s:"bottom"}[ab])):(a=aX(d,m,n),j=aY(d,a)),v?(c=n,l=f||an.isSubplotConstrained?i[1]:aZ(g,c)):an.yaHash[g._id]?(c=n,l=i[1]*g._length/af._length):an.xaHash[g._id]?(c=m,l="ew"===aa?-i[0]*g._length/ae._length:aZ(g,c,{e:"right",w:"left"}[aa])):(c=aX(g,m,n),l=aY(g,c)),a||c){a||(a=1),c||(c=1);var w=d._offset-j/a,x=g._offset-l/c;h.clipRect.call(y.setTranslate,j,l).call(y.setScale,a,c),h.plot.call(y.setTranslate,w,x).call(y.setScale,1/a,1/c),(a!==h.xScaleFactor||c!==h.yScaleFactor)&&(y.setPointGroupScale(h.zoomScalePts,a,c),y.setTextPointsScale(h.zoomScaleTxt,a,c)),y.hideOutsideRangePoints(h.clipOnAxisFalseTraces,h),h.xScaleFactor=a,h.yScaleFactor=c}}}}function aX(a,b,c){return a.fixedrange?0:ao&&am.xaHash[a._id]?b:ap&&(am.isSubplotConstrained?am.xaHash:am.yaHash)[a._id]?c:0}function aY(a,b){return b?(a.range=a._r.slice(),N(a,b),aZ(a,b)):0}function aZ(a,b,c){return a._length*(1-b)*F[c||a.constraintoward||"middle"]}return f.length*k.length!=1&&o(a,function(a){if(e._context._scrollZoom.cartesian||e._fullLayout._enablescrollzoom){if(aI(),e._transitioningWithDuration){a.preventDefault(),a.stopPropagation();return}ad(),clearTimeout(aO);var c,g=-a.deltaY;if(isFinite(g)||(g=a.wheelDelta/10),!isFinite(g)){b.log("Did not find wheel motion attributes: ",a);return}var d=Math.exp(-Math.min(Math.max(g,-20),20)/200),h=aQ.draglayer.select(".nsewdrag").node().getBoundingClientRect(),i=(a.clientX-h.left)/h.width,j=(h.bottom-a.clientY)/h.height;if(ao){for(k||(i=.5),c=0;c<ai.length;c++)l(ai[c],i,d);aS("x"),aN[2]*=d,aN[0]+=aN[2]*i*(1/d-1)}if(ap){for(f||(j=.5),c=0;c<aj.length;c++)l(aj[c],j,d);aS("y"),aN[3]*=d,aN[1]+=aN[3]*(1-j)*(1/d-1)}aW(aN),aT(),e.emit("plotly_relayouting",at),aO=setTimeout(function(){e._fullLayout&&(aN=[0,0,$,_],aV())},aP),a.preventDefault()}function l(a,d,e){if(!a.fixedrange){var c=b.simpleMap(a.range,a.r2l),f=c[0]+(c[1]-c[0])*d;a.range=c.map(function(b){return a.l2r(f+(b-f)*e)})}}}),a},makeDragger:f,makeRectDragger:g,makeZoombox:h,makeCorners:i,updateZoombox:j,xyCorners:n,transitionZoombox:k,removeZoombox:l,showDoubleClickNotifier:m,attachWheelEventHandler:o}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(a,c,b){"use strict";var d=a("@plotly/d3"),e=a("../../components/fx"),f=a("../../components/dragelement"),g=a("../../lib/setcursor"),h=a("./dragbox").makeDragBox,i=a("./constants").DRAGGERSIZE;b.initInteractions=function(a){var c=a._fullLayout;if(a._context.staticPlot){d.select(a).selectAll(".drag").remove();return}if(c._has("cartesian")||c._has("splom")){Object.keys(c._plots||{}).sort(function(a,e){if((c._plots[a].mainplot&&!0)===(c._plots[e].mainplot&&!0)){var b=a.split("y"),d=e.split("y");return b[0]===d[0]?Number(b[1]||1)-Number(d[1]||1):Number(b[0]||1)-Number(d[0]||1)}return c._plots[a].mainplot?1:-1}).forEach(function(l){var g=c._plots[l],b=g.xaxis,d=g.yaxis;if(!g.mainplot){var m=h(a,g,b._offset,d._offset,b._length,d._length,"ns","ew");m.onmousemove=function(b){a._fullLayout._rehover=function(){a._fullLayout._hoversubplot===l&&a._fullLayout._plots[l]&&e.hover(a,b,l)},e.hover(a,b,l),a._fullLayout._lasthover=m,a._fullLayout._hoversubplot=l},m.onmouseout=function(b){a._dragging||(a._fullLayout._hoversubplot=null,f.unhover(a,b))},a._context.showAxisDragHandles&&(h(a,g,b._offset-i,d._offset-i,i,i,"n","w"),h(a,g,b._offset+b._length,d._offset-i,i,i,"n","e"),h(a,g,b._offset-i,d._offset+d._length,i,i,"s","w"),h(a,g,b._offset+b._length,d._offset+d._length,i,i,"s","e"))}if(a._context.showAxisDragHandles){if(l===b._mainSubplot){var j=b._mainLinePosition;"top"===b.side&&(j-=i),h(a,g,b._offset+.1*b._length,j,.8*b._length,i,"","ew"),h(a,g,b._offset,j,.1*b._length,i,"","w"),h(a,g,b._offset+.9*b._length,j,.1*b._length,i,"","e")}if(l===d._mainSubplot){var k=d._mainLinePosition;"right"!==d.side&&(k-=i),h(a,g,k,d._offset+.1*d._length,i,.8*d._length,"ns",""),h(a,g,k,d._offset+.9*d._length,i,.1*d._length,"s",""),h(a,g,k,d._offset,i,.1*d._length,"n","")}}});var g=c._hoverlayer.node();g.onmousemove=function(b){b.target=a._fullLayout._lasthover,e.hover(a,b,c._hoversubplot)},g.onclick=function(b){b.target=a._fullLayout._lasthover,e.click(a,b)},g.onmousedown=function(b){a._fullLayout._lasthover.onmousedown(b)},b.updateFx(a)}},b.updateFx=function(b){var a=b._fullLayout,c="pan"===a.dragmode?"move":"crosshair";g(a._draggers,c)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("./axis_ids");b.exports=function(a){return function(s,b){var h=s[a];if(Array.isArray(h))for(var o=d.subplotsRegistry.cartesian,p=o.idRegex,i=b._subplots,q=i.xaxis,r=i.yaxis,t=i.cartesian,u=b._has("cartesian")||b._has("gl2d"),j=0;j<h.length;j++){var k=h[j];if(e.isPlainObject(k)){var c=f.cleanId(k.xref,"x",!1),g=f.cleanId(k.yref,"y",!1),l=p.x.test(c),m=p.y.test(g);if(l||m){u||e.pushUnique(b._basePlotModules,o);var n=!1;l&& -1===q.indexOf(c)&&(q.push(c),n=!0),m&& -1===r.indexOf(g)&&(r.push(g),n=!0),n&&l&&m&&t.push(c+g)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(b,e,a){"use strict";var f=b("@plotly/d3"),g=b("../../registry"),d=b("../../lib"),h=b("../plots"),i=b("../../components/drawing"),j=b("../get_data").getModuleCalcData,k=b("./axis_ids"),c=b("./constants"),l=b("../../constants/xmlns_namespaces"),m=d.ensureSingle;function n(a,b,c){return d.ensureSingle(a,b,c,function(a){a.datum(c)})}function o(h,a,k,x,y){for(var b,p,d,w=c.traceLayerClasses,q=h._fullLayout,r=q._modules,l=[],m=[],n=0;n<r.length;n++){var s=(b=r[n]).name,t=g.modules[s].categories;if(t.svg){var o=b.layerName||s+"layer",u=b.plot;d=(p=j(k,u))[0],k=p[1],d.length&&l.push({i:w.indexOf(o),className:o,plotMethod:u,cdModule:d}),t.zoomScale&&m.push("."+o)}}l.sort(function(a,b){return a.i-b.i});var e=a.plot.selectAll("g.mlayer").data(l,function(a){return a.className});if(e.enter().append("g").attr("class",function(a){return a.className}).classed("mlayer",!0).classed("rangeplot",a.isRangePlot),e.exit().remove(),e.order(),e.each(function(b){var d=f.select(this),e=b.className;b.plotMethod(h,a,b.cdModule,d,x,y),-1===c.clipOnAxisFalseQuery.indexOf("."+e)&&i.setClipUrl(d,a.layerClipId,h)}),q._has("scattergl")&&(d=j(k,b=g.getModule("scattergl"))[0],b.plot(h,a,d)),!h._context.staticPlot&&(a._hasClipOnAxisFalse&&(a.clipOnAxisFalseTraces=a.plot.selectAll(c.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),m.length)){var v=a.plot.selectAll(m.join(",")).selectAll(".trace");a.zoomScalePts=v.selectAll("path.point"),a.zoomScaleTxt=v.selectAll(".textpoint")}}function p(p,a){var b=a.plotgroup,j=a.id,g=c.layerValue2layerClass[a.xaxis.layer],h=c.layerValue2layerClass[a.yaxis.layer],l=p._fullLayout._hasOnlyLargeSploms;if(a.mainplot){var d=a.mainplotinfo,i=d.plotgroup,e=j+"-x",f=j+"-y";a.minorGridlayer=d.minorGridlayer,a.gridlayer=d.gridlayer,a.zerolinelayer=d.zerolinelayer,m(d.overlinesBelow,"path",e),m(d.overlinesBelow,"path",f),m(d.overaxesBelow,"g",e),m(d.overaxesBelow,"g",f),a.plot=m(d.overplot,"g",j),m(d.overlinesAbove,"path",e),m(d.overlinesAbove,"path",f),m(d.overaxesAbove,"g",e),m(d.overaxesAbove,"g",f),a.xlines=i.select(".overlines-"+g).select("."+e),a.ylines=i.select(".overlines-"+h).select("."+f),a.xaxislayer=i.select(".overaxes-"+g).select("."+e),a.yaxislayer=i.select(".overaxes-"+h).select("."+f)}else if(l)a.xlines=m(b,"path","xlines-above"),a.ylines=m(b,"path","ylines-above"),a.xaxislayer=m(b,"g","xaxislayer-above"),a.yaxislayer=m(b,"g","yaxislayer-above");else{var o=m(b,"g","layer-subplot");a.shapelayer=m(o,"g","shapelayer"),a.imagelayer=m(o,"g","imagelayer"),a.minorGridlayer=m(b,"g","minor-gridlayer"),a.gridlayer=m(b,"g","gridlayer"),a.zerolinelayer=m(b,"g","zerolinelayer"),m(b,"path","xlines-below"),m(b,"path","ylines-below"),a.overlinesBelow=m(b,"g","overlines-below"),m(b,"g","xaxislayer-below"),m(b,"g","yaxislayer-below"),a.overaxesBelow=m(b,"g","overaxes-below"),a.plot=m(b,"g","plot"),a.overplot=m(b,"g","overplot"),a.xlines=m(b,"path","xlines-above"),a.ylines=m(b,"path","ylines-above"),a.overlinesAbove=m(b,"g","overlines-above"),m(b,"g","xaxislayer-above"),m(b,"g","yaxislayer-above"),a.overaxesAbove=m(b,"g","overaxes-above"),a.xlines=b.select(".xlines-"+g),a.ylines=b.select(".ylines-"+h),a.xaxislayer=b.select(".xaxislayer-"+g),a.yaxislayer=b.select(".yaxislayer-"+h)}l||(n(a.minorGridlayer,"g",a.xaxis._id),n(a.minorGridlayer,"g",a.yaxis._id),a.minorGridlayer.selectAll("g").map(function(a){return a[0]}).sort(k.idSort),n(a.gridlayer,"g",a.xaxis._id),n(a.gridlayer,"g",a.yaxis._id),a.gridlayer.selectAll("g").map(function(a){return a[0]}).sort(k.idSort)),a.xlines.style("fill","none").classed("crisp",!0),a.ylines.style("fill","none").classed("crisp",!0)}function q(b,c){if(b){var g={};for(var h in b.each(function(b){var a=b[0];f.select(this).remove(),r(a,c),g[a]=!0}),c._plots)for(var d=c._plots[h].overlays||[],a=0;a<d.length;a++){var e=d[a];g[e.id]&&e.plot.selectAll(".trace").remove()}}}function r(b,a){a._draggers.selectAll("g."+b).remove(),a._defs.select("#clip"+a._uid+b+"plot").remove()}a.name="cartesian",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=c.idRegex,a.attrRegex=c.attrRegex,a.attributes=b("./attributes"),a.layoutAttributes=b("./layout_attributes"),a.supplyLayoutDefaults=b("./layout_defaults"),a.transitionAxes=b("./transition_axes"),a.finalizeSubplots=function(o,q){var e,a,b,h=q._subplots,i=h.xaxis,j=h.yaxis,l=h.cartesian,g=l.concat(h.gl2d||[]),m={},n={};for(e=0;e<g.length;e++){var p=g[e].split("y");m[p[0]]=1,n["y"+p[1]]=1}for(e=0;e<i.length;e++)m[a=i[e]]||(b=(o[k.id2name(a)]||{}).anchor,c.idRegex.y.test(b)||(b="y"),l.push(a+b),g.push(a+b),n[b]||(n[b]=1,d.pushUnique(j,b)));for(e=0;e<j.length;e++)n[b=j[e]]||(a=(o[k.id2name(b)]||{}).anchor,c.idRegex.x.test(a)||(a="x"),l.push(a+b),g.push(a+b),m[a]||(m[a]=1,d.pushUnique(i,a)));if(!g.length){for(var f in a="",b="",o)c.attrRegex.test(f)&&("x"===f.charAt(0)?(!a|| +f.substr(5)< +a.substr(5))&&(a=f):(!b|| +f.substr(5)< +b.substr(5))&&(b=f));a=a?k.name2id(a):"x",b=b?k.name2id(b):"y",i.push(a),j.push(b),l.push(a+b)}},a.plot=function(e,c,l,m){var j=e._fullLayout,k=j._subplots.cartesian,f=e.calcdata;if(!Array.isArray(c))for(n=0,c=[];n<f.length;n++)c.push(n);for(n=0;n<k.length;n++){for(var n,a,g=k[n],p=j._plots[g],d=[],h=0;h<f.length;h++){var i=f[h],b=i[0].trace;b.xaxis+b.yaxis===g&&((-1!==c.indexOf(b.index)||b.carpet)&&(a&&a[0].trace.xaxis+a[0].trace.yaxis===g&& -1!==["tonextx","tonexty","tonext"].indexOf(b.fill)&& -1===d.indexOf(a)&&d.push(a),d.push(i)),a=i)}o(e,p,d,l,m)}},a.clean=function(t,c,u,a){var f,b,g,h=a._plots||{},l=c._plots||{},d=a._subplots||{};if(a._hasOnlyLargeSploms&&!c._hasOnlyLargeSploms)for(g in h)(f=h[g]).plotgroup&&f.plotgroup.remove();var m=a._has&&a._has("gl"),n=c._has&&c._has("gl");if(m&&!n)for(g in h)(f=h[g])._scene&&f._scene.destroy();if(d.xaxis&&d.yaxis){var i=k.listIds({_fullLayout:a});for(b=0;b<i.length;b++){var j=i[b];c[k.id2name(j)]||a._infolayer.selectAll(".g-"+j+"title").remove()}}var o=a._has&&a._has("cartesian"),p=c._has&&c._has("cartesian");if(o&&!p)q(a._cartesianlayer.selectAll(".subplot"),a),a._defs.selectAll(".axesclip").remove(),delete a._axisConstraintGroups,delete a._axisMatchGroups;else if(d.cartesian)for(b=0;b<d.cartesian.length;b++){var e=d.cartesian[b];if(!l[e]){var s="."+e+",."+e+"-x,."+e+"-y";a._cartesianlayer.selectAll(s).remove(),r(e,a)}}},a.drawFramework=function(b){var c=b._fullLayout,d=function(p){var a,g,c,b,d,e,f=p._fullLayout,k=f._subplots.cartesian,i=k.length,l=[],h=[];for(a=0;a<i;a++){c=k[a],d=(b=f._plots[c]).xaxis,e=b.yaxis;var q=d._mainAxis,r=e._mainAxis,j=q._id+r._id,m=f._plots[j];b.overlays=[],j!==c&&m?(b.mainplot=j,b.mainplotinfo=m,h.push(c)):(b.mainplot=void 0,b.mainplotinfo=void 0,l.push(c))}for(a=0;a<h.length;a++)c=h[a],(b=f._plots[c]).mainplotinfo.overlays.push(b);var s=l.concat(h),n=new Array(i);for(a=0;a<i;a++){c=s[a],d=(b=f._plots[c]).xaxis,e=b.yaxis;var o=[c,d.layer,e.layer,d.overlaying||"",e.overlaying||""];for(g=0;g<b.overlays.length;g++)o.push(b.overlays[g].id);n[a]=o}return n}(b),a=c._cartesianlayer.selectAll(".subplot").data(d,String);a.enter().append("g").attr("class",function(a){return"subplot "+a[0]}),a.order(),a.exit().call(q,c),a.each(function(e){var d=e[0],a=c._plots[d];a.plotgroup=f.select(this),p(b,a),a.draglayer=m(c._draggers,"g",d)})},a.rangePlot=function(a,b,c){p(a,b),o(a,b,c),h.style(a)},a.toSVG=function(a){var c=a._fullLayout._glimages,b=f.select(a).selectAll(".svg-container");b.filter(function(c,a){return a===b.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");c.append("svg:image").attr({xmlns:l.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},a.updateFx=b("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(b,v,z){"use strict";var d=b("../font_attributes"),c=b("../../components/color/attributes"),e=b("../../components/drawing/attributes").dash,f=b("../../lib/extend").extendFlat,g=b("../../plot_api/plot_template").templatedArray,h=b("../../plots/cartesian/axis_format_attributes").descriptionWithDates,w=b("../../constants/numerical").ONEDAY,a=b("./constants"),x=a.HOUR_PATTERN,y=a.WEEKDAY_PATTERN,i={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function j(a){return{valType:"integer",min:0,dflt:a?5:0,editType:"ticks"}}var k={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},l={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},m={valType:"data_array",editType:"ticks"},n={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function o(b){var a={valType:"number",min:0,editType:"ticks"};return b||(a.dflt=5),a}function p(b){var a={valType:"number",min:0,editType:"ticks"};return b||(a.dflt=1),a}var q={valType:"color",dflt:c.defaultLine,editType:"ticks"},r={valType:"color",dflt:c.lightLine,editType:"ticks"};function s(b){var a={valType:"number",min:0,editType:"ticks"};return b||(a.dflt=1),a}var t=f({},e,{editType:"ticks"}),u={valType:"boolean",editType:"ticks"};v.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:c.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:d({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:g("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[y,x,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:w},editType:"calc"}),tickmode:i,nticks:j(),tick0:k,dtick:l,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:m,ticktext:{valType:"data_array",editType:"ticks"},ticks:n,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:o(),tickwidth:p(),tickcolor:q,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:f({},e,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:d({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:h("tick label")},tickformatstops:g("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:h("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:c.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:u,gridcolor:r,gridwidth:s(),griddash:t,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:c.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:c.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},minor:{tickmode:i,nticks:j("minor"),tick0:k,dtick:l,tickvals:m,ticks:n,ticklen:o("minor"),tickwidth:p("minor"),tickcolor:q,gridcolor:r,gridwidth:s("minor"),griddash:t,showgrid:u,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:d({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(a,d,e){"use strict";var f=a("../../lib"),g=a("../../components/color"),h=a("../../components/fx/helpers").isUnifiedHover,i=a("../../components/fx/hovermode_defaults"),j=a("../../plot_api/plot_template"),k=a("../layout_attributes"),l=a("./layout_attributes"),m=a("./type_defaults"),n=a("./axis_defaults"),o=a("./constraints"),p=a("./position_defaults"),b=a("./axis_ids"),q=b.id2name,r=b.name2id,s=a("./constants").AX_ID_PATTERN,c=a("../../registry"),t=c.traceIs,u=c.getComponentMethod;function v(a,b,c){Array.isArray(a[b])?a[b].push(c):a[b]=[c]}d.exports=function(y,d,Q){var a,E,w,z,e,R=d.autotypenumbers,F={},M={},S={},T={},U={},V={},W={},I={},J={},N={};for(x=0;x<Q.length;x++){var x,D,C,A,c=Q[x];if(t(c,"cartesian")||t(c,"gl2d")){if(c.xaxis)v(F,C=q(c.xaxis),c);else if(c.xaxes)for(D=0;D<c.xaxes.length;D++)v(F,q(c.xaxes[D]),c);if(c.yaxis)v(F,A=q(c.yaxis),c);else if(c.yaxes)for(D=0;D<c.yaxes.length;D++)v(F,q(c.yaxes[D]),c);"funnel"===c.type?"h"===c.orientation?(C&&(M[C]=!0),A&&(W[A]=!0)):A&&(S[A]=!0):"image"===c.type?(A&&(I[A]=!0),C&&(I[C]=!0)):(A&&(U[A]=!0,V[A]=!0),t(c,"carpet")&&("carpet"!==c.type||c._cheater)||C&&(T[C]=!0)),"carpet"===c.type&&c._cheater&&C&&(M[C]=!0),t(c,"2dMap")&&(J[C]=!0,J[A]=!0),t(c,"oriented")&&(N["h"===c.orientation?A:C]=!0)}}var X=d._subplots,Y=X.xaxis,Z=X.yaxis,O=f.simpleMap(Y,q),K=f.simpleMap(Z,q),$=O.concat(K),_=g.background;Y.length&&Z.length&&(_=f.coerce(y,d,k,"plot_bgcolor"));var aa=g.combine(_,d.paper_bgcolor);function ab(){var b=F[a]||[];e._traceIndices=b.map(function(a){return a._expandedIndex}),e._annIndices=[],e._shapeIndices=[],e._selectionIndices=[],e._imgIndices=[],e._subplotsWith=[],e._counterAxes=[],e._name=e._attr=a,e._id=E}function B(a,b){return f.coerce(z,e,l,a,b)}function G(a,b){return f.coerce2(z,e,l,a,b)}function ac(a){return"x"===a?Z:Y}function ad(e,f){for(var c="x"===e?O:K,d=[],a=0;a<c.length;a++){var b=c[a];b===f||(y[b]||{}).overlaying||d.push(r(b))}return d}var L={x:ac("x"),y:ac("y")},ah=L.x.concat(L.y),ai={},P=[];function ae(){var a=z.matches;s.test(a)&& -1===ah.indexOf(a)&&(ai[a]=z.type,P=Object.keys(ai))}var af=i(y,d),H=h(af);for(x=0;x<$.length;x++){E=r(a=$[x]),w=a.charAt(0),f.isPlainObject(y[a])||(y[a]={}),z=y[a],e=j.newContainer(d,a,w+"axis"),ab();var aj="x"===w&&!T[a]&&M[a]||"y"===w&&!U[a]&&S[a],ak="y"===w&&(!V[a]&&W[a]||I[a]),ag={hasMinor:!0,letter:w,font:d.font,outerTicks:J[a],showGrid:!N[a],data:F[a]||[],bgColor:aa,calendar:d.calendar,automargin:!0,visibleDflt:aj,reverseDflt:ak,autotypenumbersDflt:R,splomStash:((d._splomAxes||{})[w]||{})[E]};B("uirevision",d.uirevision),m(z,e,B,ag),n(z,e,B,ag,d);var al=H&&w===af.charAt(0),am=G("spikecolor",H?e.color:void 0),an=G("spikethickness",H?1.5:void 0),ao=G("spikedash",H?"dot":void 0),ap=G("spikemode",H?"across":void 0),aq=G("spikesnap"),ar=B("showspikes",!!al||!!am||!!an||!!ao||!!ap||!!aq);ar||(delete e.spikecolor,delete e.spikethickness,delete e.spikedash,delete e.spikemode,delete e.spikesnap),p(z,e,B,{letter:w,counterAxes:L[w],overlayableAxes:ad(w,a),grid:d.grid}),B("title.standoff"),ae(),e._input=z}for(x=0;x<P.length;){w=(a=q(E=P[x++])).charAt(0),f.isPlainObject(y[a])||(y[a]={}),z=y[a],e=j.newContainer(d,a,w+"axis"),ab();var as={letter:w,font:d.font,outerTicks:J[a],showGrid:!N[a],data:[],bgColor:aa,calendar:d.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:R,splomStash:((d._splomAxes||{})[w]||{})[E]};B("uirevision",d.uirevision),e.type=ai[E]||"linear",n(z,e,B,as,d),p(z,e,B,{letter:w,counterAxes:L[w],overlayableAxes:ad(w,a),grid:d.grid}),B("fixedrange"),ae(),e._input=z}var at=u("rangeslider","handleDefaults"),au=u("rangeselector","handleDefaults");for(x=0;x<O.length;x++)z=y[a=O[x]],e=d[a],at(y,d,a),"date"===e.type&&au(z,e,d,K,e.calendar),B("fixedrange");for(x=0;x<K.length;x++){z=y[a=K[x]],e=d[a];var av=d[q(e.anchor)],aw=u("rangeslider","isVisible")(av);B("fixedrange",aw)}o.handleDefaults(y,d,{axIds:ah.concat(P).sort(b.idSort),axHasImage:I})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(a,b,c){"use strict";var d=a("tinycolor2").mix,e=a("../../components/color/attributes"),f=a("../../lib");b.exports=function(x,a,g,b){var h=(b=b||{}).dfltColor;function c(c,d){return f.coerce2(x,a,b.attributes,c,d)}var i=c("linecolor",h),j=c("linewidth"),k=g("showline",b.showLine||!!i||!!j);k||(delete a.linecolor,delete a.linewidth);var l=d(h,b.bgColor,b.blend||e.lightFraction).toRgbString(),m=c("gridcolor",l),n=c("gridwidth"),o=c("griddash"),p=g("showgrid",b.showGrid||!!m||!!n||!!o);if(p||(delete a.gridcolor,delete a.gridwidth,delete a.griddash),b.hasMinor){var q=c("minor.gridcolor",d(a.gridcolor,b.bgColor,67).toRgbString()),r=c("minor.gridwidth",a.gridwidth||1),s=c("minor.griddash",a.griddash||"solid"),t=g("minor.showgrid",!!q||!!r||!!s);t||(delete a.minor.gridcolor,delete a.minor.gridwidth,delete a.minor.griddash)}if(!b.noZeroLine){var u=c("zerolinecolor",h),v=c("zerolinewidth"),w=g("zeroline",b.showGrid||!!u||!!v);w||(delete a.zerolinecolor,delete a.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib");b.exports=function(g,a,l,i){var j,b,c,k,m=i.counterAxes||[],n=i.overlayableAxes||[],h=i.letter,f=i.grid;f&&(b=f._domains[h][f._axisMap[a._id]],j=f._anchors[a._id],b&&(c=f[h+"side"].split(" ")[0],k=f.domain[h]["right"===c||"top"===c?1:0])),b=b||[0,1],j=j||(d(g.position)?"free":m[0]||"free"),c=c||("x"===h?"bottom":"left"),k=k||0,"free"===e.coerce(g,a,{anchor:{valType:"enumerated",values:["free"].concat(m),dflt:j}},"anchor")&&l("position",k),e.coerce(g,a,{side:{valType:"enumerated",values:"x"===h?["bottom","top"]:["left","right"],dflt:c}},"side");var o=!1;if(n.length&&(o=e.coerce(g,a,{overlaying:{valType:"enumerated",values:[!1].concat(n),dflt:!1}},"overlaying")),!o){var p=l("domain",b);p[0]>p[1]-1/4096&&(a.domain=b),e.noneOrAll(g.domain,a.domain,b)}return l("layer"),a}},{"../../lib":515,"fast-isnumeric":190}],583:[function(a,b,c){"use strict";var d=a("./show_dflt");b.exports=function(e,g,a,h,b){b||(b={});var f=b.tickSuffixDflt,c=d(e);a("tickprefix")&&a("showtickprefix",c),a("ticksuffix",f)&&a("showticksuffix",c)}},{"./show_dflt":586}],584:[function(a,b,c){"use strict";var d=a("../../constants/alignment").FROM_BL;b.exports=function(a,f,e){void 0===e&&(e=d[a.constraintoward||"center"]);var b=[a.r2l(a.range[0]),a.r2l(a.range[1])],c=b[0]+(b[1]-b[0])*e;a.range=a._input.range=[a.l2r(c+(b[0]-c)*f),a.l2r(c+(b[1]-c)*f)],a.setScale()}},{"../../constants/alignment":483}],585:[function(b,e,f){"use strict";var g=b("@plotly/d3"),h=b("d3-time-format").utcFormat,c=b("../../lib"),i=c.numberFormat,j=b("fast-isnumeric"),k=c.cleanNumber,l=c.ms2DateTime,m=c.dateTime2ms,n=c.ensureNumber,o=c.isArrayOrTypedArray,a=b("../../constants/numerical"),p=a.FP_SAFE,q=a.BADNUM,r=a.LOG_CLIP,s=a.ONEWEEK,t=a.ONEDAY,u=a.ONEHOUR,v=a.ONEMIN,w=a.ONESEC,x=b("./axis_ids"),d=b("./constants"),y=d.HOUR_PATTERN,z=d.WEEKDAY_PATTERN;function A(a){return Math.pow(10,a)}function B(a){return null!=a}e.exports=function(a,e){e=e||{};var G=a._id||"x",H=G.charAt(0);function E(b,e){if(b>0)return Math.log(b)/Math.LN10;if(!(b<=0)||!e||!a.range||2!==a.range.length)return q;var c=a.range[0],d=a.range[1];return .5*(c+d-2*r*Math.abs(c-d))}function I(b,i,f,g){if((g||{}).msUTC&&j(b))return+b;var d=m(b,f||a.calendar);if(d===q){if(!j(b))return q;b=+b;var e=Math.floor(10*c.mod(b+.05,1)),h=Math.round(b-e/10);d=m(new Date(h))+e/10}return d}function J(b,c,d){return l(b,c,d||a.calendar)}function F(b){return a._categories[Math.round(b)]}function K(b){if(B(b)){if(void 0===a._categoriesMap&&(a._categoriesMap={}),void 0!==a._categoriesMap[b])return a._categoriesMap[b];a._categories.push("number"==typeof b?String(b):b);var c=a._categories.length-1;return a._categoriesMap[b]=c,c}return q}function L(b){if(a._categoriesMap)return a._categoriesMap[b]}function C(a){var b=L(a);return void 0!==b?b:j(a)?+a:void 0}function M(a){return j(a)?+a:L(a)}function N(a,b,c){return g.round(c+b*a,2)}function O(a,b,c){return(a-c)/b}var D=function(b){return j(b)?N(b,a._m,a._b):q},b=function(b){return O(b,a._m,a._b)};if(a.rangebreaks){var P="y"===H;D=function(c){if(!j(c))return q;var h=a._rangebreaks.length;if(!h)return N(c,a._m,a._b);var d=P;a.range[0]>a.range[1]&&(d=!d);for(var e=d?-1:1,f=e*c,g=0,b=0;b<h;b++){var i=e*a._rangebreaks[b].min,k=e*a._rangebreaks[b].max;if(f<i)break;if(f>k)g=b+1;else{g=f<(i+k)/2?b:b+1;break}}var l=a._B[g]||0;return isFinite(l)?N(c,a._m2,l):0},b=function(c){var d=a._rangebreaks.length;if(!d)return O(c,a._m,a._b);for(var e=0,b=0;b<d&&!(c<a._rangebreaks[b].pmin);b++)c>a._rangebreaks[b].pmax&&(e=b+1);return O(c,a._m2,a._B[e])}}a.c2l="log"===a.type?E:n,a.l2c="log"===a.type?A:n,a.l2p=D,a.p2l=b,a.c2p="log"===a.type?function(a,b){return D(E(a,b))}:D,a.p2c="log"===a.type?function(a){return A(b(a))}:b,-1!==["linear","-"].indexOf(a.type)?(a.d2r=a.r2d=a.d2c=a.r2c=a.d2l=a.r2l=k,a.c2d=a.c2r=a.l2d=a.l2r=n,a.d2p=a.r2p=function(b){return a.l2p(k(b))},a.p2d=a.p2r=b,a.cleanPos=n):"log"===a.type?(a.d2r=a.d2l=function(a,b){return E(k(a),b)},a.r2d=a.r2c=function(a){return A(k(a))},a.d2c=a.r2l=k,a.c2d=a.l2r=n,a.c2r=E,a.l2d=A,a.d2p=function(b,c){return a.l2p(a.d2r(b,c))},a.p2d=function(a){return A(b(a))},a.r2p=function(b){return a.l2p(k(b))},a.p2r=b,a.cleanPos=n):"date"===a.type?(a.d2r=a.r2d=c.identity,a.d2c=a.r2c=a.d2l=a.r2l=I,a.c2d=a.c2r=a.l2d=a.l2r=J,a.d2p=a.r2p=function(b,d,c){return a.l2p(I(b,0,c))},a.p2d=a.p2r=function(a,c,d){return J(b(a),c,d)},a.cleanPos=function(b){return c.cleanDate(b,q,a.calendar)}):"category"===a.type?(a.d2c=a.d2l=K,a.r2d=a.c2d=a.l2d=F,a.d2r=a.d2l_noadd=C,a.r2c=function(c){var b=M(c);return void 0!==b?b:a.fraction2r(.5)},a.l2r=a.c2r=n,a.r2l=M,a.d2p=function(b){return a.l2p(a.r2c(b))},a.p2d=function(a){return F(b(a))},a.r2p=a.d2p,a.p2r=b,a.cleanPos=function(a){return"string"==typeof a&&""!==a?a:n(a)}):"multicategory"===a.type&&(a.r2d=a.c2d=a.l2d=F,a.d2r=a.d2l_noadd=C,a.r2c=function(c){var b=C(c);return void 0!==b?b:a.fraction2r(.5)},a.r2c_just_indices=L,a.l2r=a.c2r=n,a.r2l=C,a.d2p=function(b){return a.l2p(a.r2c(b))},a.p2d=function(a){return F(b(a))},a.r2p=a.d2p,a.p2r=b,a.cleanPos=function(a){return Array.isArray(a)||"string"==typeof a&&""!==a?a:n(a)},a.setupMultiCategory=function(p){var b,f,h=a._traceIndices,m=a._matchGroup;if(m&&0===a._categories.length){for(var n in m)if(n!==G){var q=e[x.id2name(n)];h=h.concat(q._traceIndices)}}var d=[[0,{}],[0,{}]],i=[];for(b=0;b<h.length;b++){var l=p[h[b]];if(H in l){var g=l[H],r=l._length||c.minRowLength(g);if(o(g[0])&&o(g[1]))for(f=0;f<r;f++){var j=g[0][f],k=g[1][f];B(j)&&B(k)&&(i.push([j,k]),j in d[0][1]||(d[0][1][j]=d[0][0]++),k in d[1][1]||(d[1][1][k]=d[1][0]++))}}}for(i.sort(function(a,b){var c=d[0][1],e=c[a[0]]-c[b[0]];if(e)return e;var f=d[1][1];return f[a[1]]-f[b[1]]}),b=0;b<i.length;b++)K(i[b])}),a.fraction2r=function(c){var b=a.r2l(a.range[0]),d=a.r2l(a.range[1]);return a.l2r(b+c*(d-b))},a.r2fraction=function(c){var b=a.r2l(a.range[0]),d=a.r2l(a.range[1]);return(a.r2l(c)-b)/(d-b)},a.cleanRange=function(f,h){h||(h={}),f||(f="range");var e,g,b=c.nestedProperty(a,f).get();if(g=(g="date"===a.type?c.dfltRange(a.calendar):"y"===H?d.DFLTRANGEY:"realaxis"===a._name?[0,1]:h.dfltRange||d.DFLTRANGEX).slice(),("tozero"===a.rangemode||"nonnegative"===a.rangemode)&&(g[0]=0),!b||2!==b.length){c.nestedProperty(a,f).set(g);return}for("date"!==a.type||a.autorange||(b[0]=c.cleanDate(b[0],q,a.calendar),b[1]=c.cleanDate(b[1],q,a.calendar)),e=0;e<2;e++)if("date"===a.type){if(!c.isDateTime(b[e],a.calendar)){a[f]=g;break}if(a.r2l(b[0])===a.r2l(b[1])){var i=c.constrain(a.r2l(b[0]),c.MIN_MS+1e3,c.MAX_MS-1e3);b[0]=a.l2r(i-1e3),b[1]=a.l2r(i+1e3);break}}else{if(!j(b[e]))if(j(b[1-e]))b[e]=b[1-e]*(e?10:.1);else{a[f]=g;break}if(b[e]< -p?b[e]=-p:b[e]>p&&(b[e]=p),b[0]===b[1]){var k=Math.max(1,Math.abs(1e-6*b[0]));b[0]-=k,b[1]+=k}}},a.setScale=function(m){var b,c,g=e._size;if(a.overlaying){var n=x.getFromId({_fullLayout:e},a.overlaying);a.domain=n.domain}var i=m&&a._r?"_r":"range",k=a.calendar;a.cleanRange(i);var d=a.r2l(a[i][0],k),f=a.r2l(a[i][1],k),j="y"===H;if(j?(a._offset=g.t+(1-a.domain[1])*g.h,a._length=g.h*(a.domain[1]-a.domain[0]),a._m=a._length/(d-f),a._b=-a._m*f):(a._offset=g.l+a.domain[0]*g.w,a._length=g.w*(a.domain[1]-a.domain[0]),a._m=a._length/(f-d),a._b=-a._m*d),a._rangebreaks=[],a._lBreaks=0,a._m2=0,a._B=[],a.rangebreaks&&(a._rangebreaks=a.locateBreaks(Math.min(d,f),Math.max(d,f)),a._rangebreaks.length)){for(b=0;b<a._rangebreaks.length;b++)c=a._rangebreaks[b],a._lBreaks+=Math.abs(c.max-c.min);var h=j;d>f&&(h=!h),h&&a._rangebreaks.reverse();var l=h?-1:1;for(a._m2=l*a._length/(Math.abs(f-d)-a._lBreaks),a._B.push(-a._m2*(j?f:d)),b=0;b<a._rangebreaks.length;b++)c=a._rangebreaks[b],a._B.push(a._B[a._B.length-1]-l*a._m2*(c.max-c.min));for(b=0;b<a._rangebreaks.length;b++)(c=a._rangebreaks[b]).pmin=D(c.min),c.pmax=D(c.max)}if(!isFinite(a._m)||!isFinite(a._b)||a._length<0)throw e._replotting=!1,new Error("Something went wrong with axis scaling")},a.maskBreaks=function(g){var m,e,f,d,h,b=a.rangebreaks||[];b._cachedPatterns||(b._cachedPatterns=b.map(function(b){return b.enabled&&b.bounds?c.simpleMap(b.bounds,b.pattern?k:a.d2c):null})),b._cachedValues||(b._cachedValues=b.map(function(b){return b.enabled&&b.values?c.simpleMap(b.values,a.d2c).sort(c.sorterAsc):null}));for(var i=0;i<b.length;i++){var j=b[i];if(j.enabled){if(j.bounds){var o=j.pattern;switch(e=(m=b._cachedPatterns[i])[0],f=m[1],o){case z:d=(h=new Date(g)).getUTCDay(),e>f&&(f+=7,d<e&&(d+=7));break;case y:var p=(h=new Date(g)).getUTCHours(),r=h.getUTCMinutes(),s=h.getUTCSeconds(),t=h.getUTCMilliseconds();d=p+(r/60+s/3600+t/36e5),e>f&&(f+=24,d<e&&(d+=24));break;case"":d=g;break}if(d>=e&&d<f)return q}else for(var n=b._cachedValues[i],l=0;l<n.length;l++)if(f=(e=n[l])+j.dvalue,g>=e&&g<f)return q}}return g},a.locateBreaks=function(x,A){var m=[];if(!a.rangebreaks)return m;var p=a.rangebreaks.slice().sort(function(a,b){return a.pattern===z&&b.pattern===y?-1:b.pattern===z&&a.pattern===y?1:0}),q=function(a,b){if(a=c.constrain(a,x,A),b=c.constrain(b,x,A),a!==b){for(var f=!0,e=0;e<m.length;e++){var d=m[e];a<d.max&&b>=d.min&&(a<d.min&&(d.min=a),b>d.max&&(d.max=b),f=!1)}f&&m.push({min:a,max:b})}};for(B=0;B<p.length;B++){var e=p[B];if(e.enabled)if(e.bounds){var B,h,b,g,j,i,f=x,n=A;e.pattern&&(f=Math.floor(f)),b=(h=c.simpleMap(e.bounds,e.pattern?k:a.r2l))[0],g=h[1];var d=new Date(f);switch(e.pattern){case z:i=s,j=((g<b?7:0)+(g-b))*t,f+=b*t-(d.getUTCDay()*t+d.getUTCHours()*u+d.getUTCMinutes()*v+d.getUTCSeconds()*w+d.getUTCMilliseconds());break;case y:i=t,j=((g<b?24:0)+(g-b))*u,f+=b*u-(d.getUTCHours()*u+d.getUTCMinutes()*v+d.getUTCSeconds()*w+d.getUTCMilliseconds());break;default:f=Math.min(h[0],h[1]),n=Math.max(h[0],h[1]),i=n-f,j=i}for(var l=f;l<n;l+=i)q(l,l+j)}else for(var r=c.simpleMap(e.values,a.d2c),o=0;o<r.length;o++)g=(b=r[o])+e.dvalue,q(b,g)}return m.sort(function(a,b){return a.min-b.min}),m},a.makeCalcdata=function(e,g,k){var d,h,b,f,i=a.type,j="date"===i&&e[g+"calendar"];if(g in e){if(d=e[g],f=e._length||c.minRowLength(d),c.isTypedArray(d)&&("linear"===i||"log"===i)){if(f===d.length)return d;if(d.subarray)return d.subarray(0,f)}if("multicategory"===i)return function(b,c){for(var d=new Array(c),a=0;a<c;a++){var e=(b[0]||[])[a],f=(b[1]||[])[a];d[a]=L([e,f])}return d}(d,f);for(b=0,h=new Array(f);b<f;b++)h[b]=a.d2c(d[b],0,j,k)}else{var l=g+"0" in e?a.d2c(e[g+"0"],0,j):0,m=e["d"+g]?Number(e["d"+g]):1;for(b=0,d=e[({x:"y",y:"x"})[g]],f=e._length||d.length,h=new Array(f);b<f;b++)h[b]=l+b*m}if(a.rangebreaks)for(b=0;b<f;b++)h[b]=a.maskBreaks(h[b]);return h},a.isValidRange=function(b){return Array.isArray(b)&&2===b.length&&j(a.r2l(b[0]))&&j(a.r2l(b[1]))},a.isPtWithinRange=function(e,f){var b=a.c2l(e[H],null,f),c=a.r2l(a.range[0]),d=a.r2l(a.range[1]);return c<d?c<=b&&b<=d:d<=b&&b<=c},a._emptyCategories=function(){a._categories=[],a._categoriesMap={}},a.clearCalc=function(){var g=a._matchGroup;if(g){var b=null,c=null;for(var h in g){var d=e[x.id2name(h)];if(d._categories){b=d._categories,c=d._categoriesMap;break}}b&&c?(a._categories=b,a._categoriesMap=c):a._emptyCategories()}else a._emptyCategories();if(a._initialCategories)for(var f=0;f<a._initialCategories.length;f++)K(a._initialCategories[f])},a.sortByInitialCategories=function(){var b=[];if(a._emptyCategories(),a._initialCategories)for(var c=0;c<a._initialCategories.length;c++)K(a._initialCategories[c]);b=b.concat(a._traceIndices);var g=a._matchGroup;for(var f in g)if(G!==f){var d=e[x.id2name(f)];d._categories=a._categories,d._categoriesMap=a._categoriesMap,b=b.concat(d._traceIndices)}return b};var f=e._d3locale;"date"===a.type&&(a._dateFormat=f?f.timeFormat:h,a._extraFormat=e._extraFormat),a._separators=e.separators,a._numFormat=f?f.numberFormat:i,delete a._minDtick,delete a._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(b,a,c){"use strict";a.exports=function(b){var a=["showexponent","showtickprefix","showticksuffix"].filter(function(a){return void 0!==b[a]});if(a.every(function(c){return b[c]===b[a[0]]})||1===a.length)return b[a[0]]}},{}],587:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color").contrast,f=a("./layout_attributes"),g=a("./show_dflt"),h=a("../array_container_defaults");function i(b,c){function a(a,e){return d.coerce(b,c,f.tickformatstops,a,e)}a("enabled")&&(a("dtickrange"),a("value"))}b.exports=function(m,c,a,j,b){b||(b={});var n=g(m);if(a("showticklabels")){var k=b.font||{},l=c.color,o=-1!==(c.ticklabelposition||"").indexOf("inside")?e(b.bgColor):l&&l!==f.color.dflt?l:k.color;if(d.coerceFont(a,"tickfont",{family:k.family,size:k.size,color:o}),b.noTicklabelstep||"multicategory"===j||"log"===j||a("ticklabelstep"),b.noAng||a("tickangle"),"category"!==j){var p=a("tickformat");h(m,c,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:i}),c.tickformatstops.length||delete c.tickformatstops,b.noExp||p||"date"===j||(a("showexponent",n),a("exponentformat"),a("minexponent"),a("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(h,c,j,i){var a=i.isMinor,f=a?h.minor||{}:h,b=a?c.minor:c,g=a?e.minor:e,k=d.coerce2(f,b,g,"ticklen",a?.6*(c.ticklen||5):void 0),l=d.coerce2(f,b,g,"tickwidth",a?c.tickwidth||1:void 0),m=d.coerce2(f,b,g,"tickcolor",(a?c.tickcolor:void 0)||b.color),n=j((a?"minor.":"")+"ticks",!a&&i.outerTicks||k||l||m?"outside":"");n||(delete b.ticklen,delete b.tickwidth,delete b.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(a,b,c){"use strict";var d=a("./clean_ticks"),e=a("../../lib").isArrayOrTypedArray;b.exports=function(k,c,a,f,g){g||(g={});var b=g.isMinor,r=b?k.minor||{}:k,h=b?c.minor:c,i=b?"minor.":"";function j(a){var b=r[a];return void 0!==b?b:(h._template||{})[a]}var n=j("tick0"),l=j("dtick"),o=j("tickvals"),p=e(o)?"array":l?"linear":"auto",m=a(i+"tickmode",p);if("auto"===m)a(i+"nticks");else if("linear"===m){var q=h.dtick=d.dtick(l,f);h.tick0=d.tick0(n,f,c.calendar,q)}else"multicategory"!==f&&(void 0===a(i+"tickvals")?h.tickmode="auto":b||a("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../registry"),f=a("../../lib"),g=a("../../components/drawing"),h=a("./axes");b.exports=function(a,c,i,b){var j,k,n,l,o=a._fullLayout;if(0===c.length){h.redrawComponents(a);return}function p(a){var c=a.xaxis,d=a.yaxis;o._defs.select("#"+a.clipId+"> rect").call(g.setTranslate,0,0).call(g.setScale,1,1),a.plot.call(g.setTranslate,c._offset,d._offset).call(g.setScale,1,1);var b=a.plot.selectAll(".scatterlayer .trace");b.selectAll(".point").call(g.setPointGroupScale,1,1),b.selectAll(".textpoint").call(g.setTextPointsScale,1,1),b.call(g.hideOutsideRangePoints,a)}function q(k,b){var l=k.plotinfo,d=l.xaxis,e=l.yaxis,m=d._length,n=e._length,q=!!k.xr1,r=!!k.yr1,c=[];if(q){var i=f.simpleMap(k.xr0,d.r2l),o=f.simpleMap(k.xr1,d.r2l),u=i[1]-i[0],v=o[1]-o[0];c[0]=(i[0]*(1-b)+b*o[0]-i[0])/(i[1]-i[0])*m,c[2]=m*(1-b+b*v/u),d.range[0]=d.l2r(i[0]*(1-b)+b*o[0]),d.range[1]=d.l2r(i[1]*(1-b)+b*o[1])}else c[0]=0,c[2]=m;if(r){var j=f.simpleMap(k.yr0,e.r2l),p=f.simpleMap(k.yr1,e.r2l),w=j[1]-j[0],x=p[1]-p[0];c[1]=(j[1]*(1-b)+b*p[1]-j[1])/(j[0]-j[1])*n,c[3]=n*(1-b+b*x/w),e.range[0]=d.l2r(j[0]*(1-b)+b*p[0]),e.range[1]=e.l2r(j[1]*(1-b)+b*p[1])}else c[1]=0,c[3]=n;h.drawOne(a,d,{skipTitle:!0}),h.drawOne(a,e,{skipTitle:!0}),h.redrawComponents(a,[d._id,e._id]);var s=q?m/c[2]:1,t=r?n/c[3]:1,y=q?c[0]:0,z=r?c[1]:0,A=q?c[0]/c[2]*m:0,B=r?c[1]/c[3]*n:0,C=d._offset-A,D=e._offset-B;l.clipRect.call(g.setTranslate,y,z).call(g.setScale,1/s,1/t),l.plot.call(g.setTranslate,C,D).call(g.setScale,s,t),g.setPointGroupScale(l.zoomScalePts,1/s,1/t),g.setTextPointsScale(l.zoomScaleTxt,1/s,1/t)}b&&(j=b());var r=d.ease(i.easing);function m(){for(var d=r(Math.min(1,((n=Date.now())-k)/i.duration)),b=0;b<c.length;b++)q(c[b],d);n-k>i.duration?(!function(){for(var d={},f=0;f<c.length;f++){var b=c[f],g=b.plotinfo.xaxis,h=b.plotinfo.yaxis;b.xr1&&(d[g._name+".range"]=b.xr1.slice()),b.yr1&&(d[h._name+".range"]=b.yr1.slice())}return j&&j(),e.call("relayout",a,d).then(function(){for(var a=0;a<c.length;a++)p(c[a].plotinfo)})}(),l=window.cancelAnimationFrame(m)):l=window.requestAnimationFrame(m)}return a._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(l),l=null,function(){for(var d={},f=0;f<c.length;f++){var b=c[f],g=b.plotinfo.xaxis,h=b.plotinfo.yaxis;b.xr0&&(d[g._name+".range"]=b.xr0.slice()),b.yr0&&(d[h._name+".range"]=b.yr0.slice())}return e.call("relayout",a,d).then(function(){for(var a=0;a<c.length;a++)p(c[a].plotinfo)})}()}),k=Date.now(),l=window.requestAnimationFrame(m),Promise.resolve()}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(a,b,c){"use strict";var d=a("../../registry").traceIs,e=a("./axis_autotype");function f(a){return({v:"x",h:"y"})[a.orientation||"v"]}function g(a,c){var b=f(a),e=d(a,"box-violin"),g=d(a._fullInput||{},"candlestick");return e&&!g&&c===b&& void 0===a[b]&& void 0===a[b+"0"]}b.exports=function(h,a,c,b){c("autotypenumbers",b.autotypenumbersDflt),"-"===c("type",(b.splomStash||{}).type)&&(function(c,n){if("-"===c.type){var l,i=c._id,b=i.charAt(0);-1!==i.indexOf("scene")&&(i=b);var a=function(d,e,b){for(var c=0;c<d.length;c++){var a=d[c];if("splom"===a.type&&a._length>0&&(a["_"+b+"axes"]||{})[e])return a;if((a[b+"axis"]||b)===e){if(g(a,b))return a;if((a[b]||[]).length||a[b+"0"])return a}}}(n,i,b);if(a){if("histogram"===a.type&&b===({v:"y",h:"x"})[a.orientation||"v"]){c.type="linear";return}var o=b+"calendar",j=a[o],k={noMultiCategory:!d(a,"cartesian")||d(a,"noMultiCategory")};if("box"===a.type&&a._hasPreCompStats&&b===({h:"x",v:"y"})[a.orientation||"v"]&&(k.noMultiCategory=!0),k.autotypenumbers=c.autotypenumbers,g(a,b)){var p=f(a),m=[];for(l=0;l<n.length;l++){var h=n[l];d(h,"box-violin")&&(h[b+"axis"]||b)===i&&(void 0!==h[p]?m.push(h[p][0]):void 0!==h.name?m.push(h.name):m.push("text"),h[o]!==j&&(j=void 0))}c.type=e(m,j,k)}else if("splom"===a.type){var q=a.dimensions[a._axesDim[i]];q.visible&&(c.type=e(q.values,j,k))}else c.type=e(a[b]||[a[b+"0"]],j,k)}}}(a,b.data),"-"===a.type?a.type="linear":h.type=a.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(b,c,a){"use strict";var d=b("../registry"),e=b("../lib");function f(f,a,g){var d,b,c,h=!1;if("data"===a.type)d=f._fullData[null!==a.traces?a.traces[0]:0];else{if("layout"!==a.type)return!1;d=f._fullLayout}return b=e.nestedProperty(d,a.prop).get(),c=g[a.type]=g[a.type]||{},c.hasOwnProperty(a.prop)&&c[a.prop]!==b&&(h=!0),c[a.prop]=b,{changed:h,value:b}}function g(f,c){var d=[],a=c[0],b={};if("string"==typeof a)b[a]=c[1];else{if(!e.isPlainObject(a))return d;b=a}return i(b,function(a,c,b){d.push({type:"layout",prop:a,value:b})},"",0),d}function h(h,d){var a,b,f,c,g=[];if(b=d[0],f=d[1],a=d[2],c={},"string"==typeof b)c[b]=f;else{if(!e.isPlainObject(b))return g;c=b,void 0===a&&(a=f)}return void 0===a&&(a=null),i(c,function(j,l,e){if(Array.isArray(e)){var c,b,f=Math.min((b=e.slice()).length,h.data.length);a&&(f=Math.min(f,a.length)),c=[];for(var d=0;d<f;d++)c[d]=a?a[d]:d}else b=e,c=a?a.slice():null;if(null===c)Array.isArray(b)&&(b=b[0]);else if(Array.isArray(c)){if(!Array.isArray(b)){var k=b;b=[];for(var i=0;i<c.length;i++)b[i]=k}b.length=Math.min(c.length,b.length)}g.push({type:"data",prop:j,traces:c,value:b})},"",0),g}function i(a,b,c,d){Object.keys(a).forEach(function(f){var g=a[f];if("_"!==f[0]){var h=c+(d>0?".":"")+f;e.isPlainObject(g)?i(g,b,h,d+1):b(h,f,g)}})}a.manageCommandObserver=function(d,c,j,k){var b={},l=!0;c&&c._commandObserver&&(b=c._commandObserver),b.cache||(b.cache={}),b.lookupTable={};var g=a.hasSimpleAPICommandBindings(d,j,b.lookupTable);if(c&&c._commandObserver){if(g)return b;if(c._commandObserver.remove)return c._commandObserver.remove(),c._commandObserver=null,b}if(g){f(d,g,b.cache),b.check=function(){if(l){var a=f(d,g,b.cache);return a.changed&&k&& void 0!==b.lookupTable[a.value]&&(b.disable(),Promise.resolve(k({value:a.value,type:g.type,prop:g.prop,traces:g.traces,index:b.lookupTable[a.value]})).then(b.enable,b.enable)),a.changed}};for(var i=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],h=0;h<i.length;h++)d._internalOn(i[h],b.check);b.remove=function(){for(var a=0;a<i.length;a++)d._removeInternalListener(i[a],b.check)}}else e.log("Unable to automatically bind plot updates to API command"),b.lookupTable={},b.remove=function(){};return b.disable=function(){l=!1},b.enable=function(){l=!0},c&&(c._commandObserver=b),b},a.hasSimpleAPICommandBindings=function(m,h,i){var n=h.length;for(j=0;j<n;j++){var j,b,c,k=h[j],l=k.method,g=k.args;if(Array.isArray(g)||(g=[]),!l)return!1;var e=a.computeAPICommandBindings(m,l,g);if(1!==e.length)return!1;if(b){if((c=e[0]).type!==b.type)return!1;if(c.prop!==b.prop)return!1;if(Array.isArray(b.traces)){if(!Array.isArray(c.traces))return!1;c.traces.sort();for(var f=0;f<b.traces.length;f++)if(b.traces[f]!==c.traces[f])return!1}else if(c.prop!==b.prop)return!1}else b=e[0],Array.isArray(b.traces)&&b.traces.sort();var d=(c=e[0]).value;if(Array.isArray(d)){if(1!==d.length)return!1;d=d[0]}i&&(i[d]=j)}return b},a.executeAPICommand=function(g,c,a){if("skip"===c)return Promise.resolve();var h=d.apiMethodRegistry[c],f=[g];Array.isArray(a)||(a=[]);for(var b=0;b<a.length;b++)f.push(a[b]);return h.apply(null,f).catch(function(a){return e.warn("API call to Plotly."+c+" rejected.",a),Promise.reject(a)})},a.computeAPICommandBindings=function(d,e,a){var b,c;switch(Array.isArray(a)||(a=[]),e){case"restyle":b=h(d,a);break;case"relayout":b=g(d,a);break;case"update":b=h(d,[a[0],a[2]]).concat(g(d,[a[1]]));break;case"animate":b=(c=a,Array.isArray(c[0])&&1===c[0].length&& -1!==["string","number"].indexOf(typeof c[0][0])?[{type:"layout",prop:"_currentFrame",value:c[0][0].toString()}]:[]);break;default:b=[]}return b}},{"../lib":515,"../registry":647}],593:[function(b,c,a){"use strict";var d=b("../lib/extend").extendFlat;a.attributes=function(a,b){b=b||{};var e={valType:"info_array",editType:(a=a||{}).editType,items:[{valType:"number",min:0,max:1,editType:a.editType},{valType:"number",min:0,max:1,editType:a.editType}],dflt:[0,1]};a.name&&a.name,a.trace,b.description&&b.description;var c={x:d({},e,{}),y:d({},e,{}),editType:a.editType};return a.noGridCell||(c.row={valType:"integer",min:0,dflt:0,editType:a.editType},c.column={valType:"integer",min:0,dflt:0,editType:a.editType}),c},a.defaults=function(b,k,c,d){var e=d&&d.x||[0,1],f=d&&d.y||[0,1],a=k.grid;if(a){var g=c("domain.column");void 0!==g&&(g<a.columns?e=a._domains.x[g]:delete b.domain.column);var h=c("domain.row");void 0!==h&&(h<a.rows?f=a._domains.y[h]:delete b.domain.row)}var i=c("domain.x",e),j=c("domain.y",f);i[0]<i[1]||(b.domain.x=e.slice()),j[0]<j[1]||(b.domain.y=f.slice())}},{"../lib/extend":505}],594:[function(b,a,c){"use strict";a.exports=function(b){var c=b.editType,d=b.colorEditType;void 0===d&&(d=c);var a={family:{valType:"string",noBlank:!0,strict:!0,editType:c},size:{valType:"number",min:1,editType:c},color:{valType:"color",editType:d},editType:c};return b.autoSize&&(a.size.dflt="auto"),b.autoColor&&(a.color.dflt="auto"),b.arrayOk&&(a.family.arrayOk=!0,a.size.arrayOk=!0,a.color.arrayOk=!0),a}},{}],595:[function(b,a,c){"use strict";a.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(b,c,a){"use strict";a.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},a.axesNames=["lonaxis","lataxis"],a.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},a.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},a.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},a.clipPad=.001,a.precision=.1,a.landColor="#F0DC82",a.waterColor="#3399FF",a.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},a.sphereSVG={type:"Sphere"},a.fillLayers={ocean:1,land:1,lakes:1},a.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},a.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],a.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],a.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(a,d,g){"use strict";var h=a("@plotly/d3"),c=a("d3-geo"),i=c.geoPath,j=c.geoDistance,k=a("d3-geo-projection"),l=a("../../registry"),e=a("../../lib"),m=e.strTranslate,n=a("../../components/color"),o=a("../../components/drawing"),p=a("../../components/fx"),q=a("../plots"),r=a("../cartesian/axes"),s=a("../cartesian/autorange").getAutoRange,t=a("../../components/dragelement"),u=a("../../components/selections").prepSelect,v=a("../../components/selections").clearOutline,w=a("../../components/selections").selectOnClick,x=a("./zoom"),y=a("./constants"),z=a("../../lib/geo_location_utils"),A=a("../../lib/topojson_utils"),B=a("topojson-client").feature;function f(a){this.id=a.id,this.graphDiv=a.graphDiv,this.container=a.container,this.topojsonURL=a.topojsonURL,this.isStatic=a.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var b=f.prototype;function C(g,h){var f=y.clipPad,a=g[0]+f,b=g[1]-f,c=h[0]+f,e=h[1]-f;a>0&&b<0&&(b+=360);var d=(b-a)/4;return{type:"Polygon",coordinates:[[[a,c],[a,e],[a+d,e],[a+2*d,e],[a+3*d,e],[b,e],[b,c],[b-d,c],[b-2*d,c],[b-3*d,c],[a,c]]]}}d.exports=function(a){return new f(a)},b.plot=function(b,c,n,o){var a=this;if(o)return a.update(b,c,!0);a._geoCalcData=b,a._fullLayout=c;var h=c[this.id],d=[],e=!1;for(var i in y.layerNameToAdjective)if("frame"!==i&&h["show"+i]){e=!0;break}for(var j=!1,k=0;k<b.length;k++){var f=b[0][0].trace;f._geo=a,f.locationmode&&(e=!0);var g=f.marker;if(g){var p=g.angle,l=g.angleref;(p||"north"===l||"previous"===l)&&(j=!0)}}if(this._hasMarkerAngles=j,e){var m=A.getTopojsonName(h);(null===a.topojson||m!==a.topojsonName)&&(a.topojsonName=m,void 0===PlotlyGeoAssets.topojson[a.topojsonName]&&d.push(a.fetchTopojson()))}d=d.concat(z.fetchTraceGeoData(b)),n.push(new Promise(function(f,e){Promise.all(d).then(function(){a.topojson=PlotlyGeoAssets.topojson[a.topojsonName],a.update(b,c),f()}).catch(e)}))},b.fetchTopojson=function(){var a=this,b=A.getTopojsonPath(a.topojsonURL,a.topojsonName);return new Promise(function(c,d){h.json(b,function(e,f){if(e)return 404===e.status?d(new Error(["plotly.js could not find topojson file at",b+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):d(new Error(["unexpected error while fetching topojson file at",b].join(" ")));PlotlyGeoAssets.topojson[a.topojsonName]=f,c()})})},b.update=function(c,b,h){var a=b[this.id];this.hasChoropleth=!1;for(var e=0;e<c.length;e++){var g=c[e],d=g[0].trace;"choropleth"===d.type&&(this.hasChoropleth=!0),!0===d.visible&&d._length>0&&d._module.calcGeoJSON(g,b)}if(!h){if(this.updateProjection(c,b))return;this.viewInitial&&this.scope===a.scope||this.saveViewInitial(a)}this.scope=a.scope,this.updateBaseLayers(b,a),this.updateDims(b,a),this.updateFx(b,a),q.generalUpdatePerTraceModule(this.graphDiv,this,c,a);var f=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=f.selectAll(".point"),this.dataPoints.text=f.selectAll("text"),this.dataPaths.line=f.selectAll(".js-line");var i=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=i.selectAll("path"),this._render()},b.updateProjection=function(M,w){var x=this.graphDiv,b=w[this.id],g=w._size,q=b.domain,r=b.projection,z=b.lonaxis,A=b.lataxis,m=z._ax,n=A._ax,a=this.projection=function(b){for(var d=b.projection,h=d.type,f=y.projNames[h],a=(c[f="geo"+e.titleCase(f)]||k[f])(),l=b._isSatellite?180*Math.acos(1/d.distance)/Math.PI:b._isClipped?y.lonaxisSpan[h]/2:null,m=["center","rotate","parallels","clipExtent"],g=0;g<m.length;g++){var n=m[g];"function"!=typeof a[n]&&(a[n]=function(b){return b?a:[]})}return a.isLonLatOverEdges=function(b){if(null===a(b))return!0;if(!l)return!1;var c=a.rotate();return j(b,[-c[0],-c[1]])>l*Math.PI/180},a.getPath=function(){return i().projection(a)},a.getBounds=function(b){return a.getPath().bounds(b)},a.precision(y.precision),b._isSatellite&&a.tilt(d.tilt).distance(d.distance),l&&a.clipAngle(l-y.clipPad),a}(b),p=[[g.l+g.w*q.x[0],g.t+g.h*(1-q.y[1])],[g.l+g.w*q.x[1],g.t+g.h*(1-q.y[0])]],h=b.center||{},d=r.rotation||{},B=z.range||[],D=A.range||[];if(b.fitbounds){m._length=p[1][0]-p[0][0],n._length=p[1][1]-p[0][1],m.range=s(x,m),n.range=s(x,n);var l=(m.range[0]+m.range[1])/2,o=(n.range[0]+n.range[1])/2;if(b._isScoped)h={lon:l,lat:o};else if(b._isClipped){h={lon:l,lat:o},d={lon:l,lat:o,roll:d.roll};var E=r.type,F=y.lonaxisSpan[E]/2||180,G=y.lataxisSpan[E]/2||90;B=[l-F,l+F],D=[o-G,o+G]}else h={lon:l,lat:o},d={lon:l,lat:d.lat,roll:d.roll}}a.center([h.lon-d.lon,h.lat-d.lat]).rotate([-d.lon,-d.lat,d.roll]).parallels(r.parallels);var H=C(B,D);a.fitExtent(p,H);var f=this.bounds=a.getBounds(H),I=this.fitScale=a.scale(),t=a.translate();if(b.fitbounds){var u=a.getBounds(C(m.range,n.range)),J=Math.min((f[1][0]-f[0][0])/(u[1][0]-u[0][0]),(f[1][1]-f[0][1])/(u[1][1]-u[0][1]));isFinite(J)?a.scale(J*I):e.warn("Something went wrong during"+this.id+"fitbounds computations.")}else a.scale(r.scale*I);var K=this.midPt=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2];if(a.translate([t[0]+(K[0]-t[0]),t[1]+(K[1]-t[1])]).clipExtent(f),b._isAlbersUsa){var L=a([h.lon,h.lat]),v=a.translate();a.translate([v[0]-(L[0]-v[0]),v[1]-(L[1]-v[1])])}},b.updateBaseLayers=function(d,e){var a=this,f=a.topojson,g=a.layers,i=a.basePaths;function j(a){return"lonaxis"===a||"lataxis"===a}function k(a){return Boolean(y.lineLayers[a])}function l(a){return Boolean(y.fillLayers[a])}var c=(this.hasChoropleth?y.layersForChoropleth:y.layers).filter(function(a){return k(a)||l(a)?e["show"+a]:!j(a)||e[a].showgrid}),b=a.framework.selectAll(".layer").data(c,String);b.exit().each(function(a){delete g[a],delete i[a],h.select(this).remove()}),b.enter().append("g").attr("class",function(a){return"layer "+a}).each(function(b){var c=g[b]=h.select(this);"bg"===b?a.bgRect=c.append("rect").style("pointer-events","all"):j(b)?i[b]=c.append("path").style("fill","none"):"backplot"===b?c.append("g").classed("choroplethlayer",!0):"frontplot"===b?c.append("g").classed("scatterlayer",!0):k(b)?i[b]=c.append("path").style("fill","none").style("stroke-miterlimit",2):l(b)&&(i[b]=c.append("path").style("stroke","none"))}),b.order(),b.each(function(a){var b=i[a],c=y.layerNameToAdjective[a];"frame"===a?b.datum(y.sphereSVG):k(a)||l(a)?b.datum(B(f,f.objects[a])):j(a)&&b.datum(function(a,f,n){var b,c,g,j=f[a],d=y.scopeDefaults[f.scope];"lonaxis"===a?(b=d.lonaxisRange,c=d.lataxisRange,g=function(a,b){return[a,b]}):"lataxis"===a&&(b=d.lataxisRange,c=d.lonaxisRange,g=function(a,b){return[b,a]});var k={type:"linear",range:[b[0],b[1]-1e-6],tick0:j.tick0,dtick:j.dtick};r.setConvert(k,n);var h=r.calcTicks(k);f.isScoped||"lonaxis"!==a||h.pop();for(var l=h.length,m=new Array(l),e=0;e<l;e++)for(var o=h[e].x,p=m[e]=[],i=c[0];i<c[1]+2.5;i+=2.5)p.push(g(o,i));return{type:"MultiLineString",coordinates:m}}(a,e,d)).call(n.stroke,e[a].gridcolor).call(o.dashLine,e[a].griddash,e[a].gridwidth),k(a)?b.call(n.stroke,e[c+"color"]).call(o.dashLine,"",e[c+"width"]):l(a)&&b.call(n.fill,e[c+"color"])})},b.updateDims=function(h,g){var a=this.bounds,b=(g.framewidth||0)/2,c=a[0][0]-b,d=a[0][1]-b,e=a[1][0]-c+b,f=a[1][1]-d+b;o.setRect(this.clipRect,c,d,e,f),this.bgRect.call(o.setRect,c,d,e,f).call(n.fill,g.bgcolor),this.xaxis._offset=c,this.xaxis._length=e,this.yaxis._offset=d,this.yaxis._length=f},b.updateFx=function(d,i){var a=this,f=a.graphDiv,b=a.bgRect,c=d.dragmode,k=d.clickmode;if(!a.isStatic){var j=function(c,b){b.isRect?(c.range={})[a.id]=[m([b.xmin,b.ymin]),m([b.xmax,b.ymax])]:(c.lassoPoints={})[a.id]=b.map(m)},g={element:a.bgRect.node(),gd:f,plotinfo:{id:a.id,xaxis:a.xaxis,yaxis:a.yaxis,fillRangeItems:j},xaxes:[a.xaxis],yaxes:[a.yaxis],subplot:a.id,clickFn:function(a){2===a&&v(f)}};"pan"===c?(b.node().onmousedown=null,b.call(x(a,i)),b.on("dblclick.zoom",function(){var b=a.viewInitial,c={};for(var d in b)c[a.id+"."+d]=b[d];l.call("_guiRelayout",f,c),f.emit("plotly_doubleclick",null)}),f._context._scrollZoom.geo||b.on("wheel.zoom",null)):("select"===c||"lasso"===c)&&(b.on(".zoom",null),g.prepFn=function(a,b,d){u(a,b,d,g,c)},t.init(g)),b.on("mousemove",function(){var b=a.projection.invert(e.getPositionFromD3Event());if(!b)return t.unhover(f,h.event);a.xaxis.p2c=function(){return b[0]},a.yaxis.p2c=function(){return b[1]},p.hover(f,h.event,a.id)}),b.on("mouseout",function(){f._dragging||t.unhover(f,h.event)}),b.on("click",function(){"select"!==c&&"lasso"!==c&&(k.indexOf("select")> -1&&w(h.event,f,[a.xaxis],[a.yaxis],a.id,g),k.indexOf("event")> -1&&p.click(f,h.event))})}function m(b){return a.projection.invert([b[0]+a.xaxis._offset,b[1]+a.yaxis._offset])}},b.makeFramework=function(){var a=this,c=a.graphDiv,b=c._fullLayout,d="clip"+b._uid+a.id;a.clipDef=b._clips.append("clipPath").attr("id",d),a.clipRect=a.clipDef.append("rect"),a.framework=h.select(a.container).append("g").attr("class","geo "+a.id).call(o.setClipUrl,d,c),a.project=function(c){var b=a.projection(c);return b?[b[0]-a.xaxis._offset,b[1]-a.yaxis._offset]:[null,null]},a.xaxis={_id:"x",c2p:function(b){return a.project(b)[0]}},a.yaxis={_id:"y",c2p:function(b){return a.project(b)[1]}},a.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},r.setConvert(a.mockAxis,b)},b.saveViewInitial=function(a){var d,b=a.center||{},f=a.projection,c=f.rotation||{};this.viewInitial={fitbounds:a.fitbounds,"projection.scale":f.scale},d=a._isScoped?{"center.lon":b.lon,"center.lat":b.lat}:a._isClipped?{"projection.rotation.lon":c.lon,"projection.rotation.lat":c.lat}:{"center.lon":b.lon,"center.lat":b.lat,"projection.rotation.lon":c.lon},e.extendFlat(this.viewInitial,d)},b.render=function(a){this._hasMarkerAngles&&a?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},b._render=function(){var a,b=this.projection,c=b.getPath();function d(c){var a=b(c.lonlat);return a?m(a[0],a[1]):null}function e(a){return b.isLonLatOverEdges(a.lonlat)?"none":null}for(a in this.basePaths)this.basePaths[a].attr("d",c);for(a in this.dataPaths)this.dataPaths[a].attr("d",function(a){return c(a.geojson)});for(a in this.dataPoints)this.dataPoints[a].attr("display",e).attr("transform",d)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(a,d,f){"use strict";var g=a("../../plots/get_data").getSubplotCalcData,e=a("../../lib").counterRegex,h=a("./geo"),b=e("geo"),c={};c.geo={valType:"subplotid",dflt:"geo",editType:"calc"},d.exports={attr:"geo",name:"geo",idRoot:"geo",idRegex:b,attrRegex:b,attributes:c,layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),plot:function(a){for(var b=a._fullLayout,i=a.calcdata,f=b._subplots.geo,e=0;e<f.length;e++){var c=f[e],j=g(i,"geo",c),k=b[c],d=k._subplot;d||(d=h({id:c,graphDiv:a,container:b._geolayer.node(),topojsonURL:a._context.topojsonURL,staticPlot:a._context.staticPlot}),b[c]._subplot=d),d.plot(j,b,a._promises)}},updateFx:function(e){for(var a=e._fullLayout,c=a._subplots.geo,b=0;b<c.length;b++){var d=a[c[b]];d._subplot.updateFx(a,d)}},clean:function(g,f,h,c){for(var d=c._subplots.geo||[],a=0;a<d.length;a++){var e=d[a],b=c[e]._subplot;!f[e]&&b&&(b.framework.remove(),b.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(a,f,k){"use strict";var b=a("../../components/color/attributes"),g=a("../domain").attributes,h=a("../../components/drawing/attributes").dash,c=a("./constants"),i=a("../../plot_api/edit_types").overrideAll,d=a("../../lib/sort_object_keys"),e={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:b.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:h},j=f.exports=i({domain:g({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:d(c.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:d(c.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:b.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:c.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:c.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:c.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:c.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:b.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:b.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:b.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:b.background},lonaxis:e,lataxis:e},"plot","from-root");j.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../subplot_defaults"),g=a("../get_data").getSubplotData,c=a("./constants"),h=a("./layout_attributes"),i=c.axesNames;function j(E,b,a,v){var w,p,q,F=g(v.fullData,"geo",v.id).map(function(a){return a._expandedIndex}),G=a("resolution"),l=a("scope"),n=c.scopeDefaults[l],m=a("projection.type",n.projType),r=b._isAlbersUsa="albers usa"===m;r&&(l=b.scope="usa");var k=b._isScoped="world"!==l,H=b._isSatellite="satellite"===m,I=b._isConic=-1!==m.indexOf("conic")||"albers"===m,J=b._isClipped=!!c.lonaxisSpan[m];if(!1===E.visible){var d=e.extendDeep({},b._template);d.showcoastlines=!1,d.showcountries=!1,d.showframe=!1,d.showlakes=!1,d.showland=!1,d.showocean=!1,d.showrivers=!1,d.showsubunits=!1,d.lonaxis&&(d.lonaxis.showgrid=!1),d.lataxis&&(d.lataxis.showgrid=!1),b._template=d}for(var j=a("visible"),o=0;o<i.length;o++){var h,s,f=i[o],K=[30,10][o];if(k)s=n[f+"Range"];else{var x=c[f+"Span"],y=(x[m]||x["*"])/2,z=a("projection.rotation."+f.substr(0,3),n.projRotate[o]);s=[z-y,z+y]}var L=a(f+".range",s);a(f+".tick0"),a(f+".dtick",K),(h=a(f+".showgrid",!!j&&void 0))&&(a(f+".gridcolor"),a(f+".gridwidth"),a(f+".griddash")),b[f]._ax={type:"linear",_id:f.slice(0,3),_traceIndices:F,setScale:e.identity,c2l:e.identity,r2l:e.identity,autorange:!0,range:L.slice(),_m:1,_input:{}}}var A=b.lonaxis.range,B=b.lataxis.range,C=A[0],t=A[1];C>0&&t<0&&(t+=360);var D=(C+t)/2;if(!r){var u=k?n.projRotate:[D,0,0];w=a("projection.rotation.lon",u[0]),a("projection.rotation.lat",u[1]),a("projection.rotation.roll",u[2]),h=a("showcoastlines",!k&&j),h&&(a("coastlinecolor"),a("coastlinewidth")),h=a("showocean",!!j&&void 0),h&&a("oceancolor")}r?(p=-96.6,q=38.7):(p=k?D:w,q=(B[0]+B[1])/2),a("center.lon",p),a("center.lat",q),H&&(a("projection.tilt"),a("projection.distance")),I&&a("projection.parallels",n.projParallels||[0,60]),a("projection.scale"),(h=a("showland",!!j&&void 0))&&a("landcolor"),(h=a("showlakes",!!j&&void 0))&&a("lakecolor"),(h=a("showrivers",!!j&&void 0))&&(a("rivercolor"),a("riverwidth")),(h=a("showcountries",k&&"usa"!==l&&j))&&(a("countrycolor"),a("countrywidth")),("usa"===l||"north america"===l&&50===G)&&(a("showsubunits",j),a("subunitcolor"),a("subunitwidth")),!k&&(h=a("showframe",j))&&(a("framecolor"),a("framewidth")),a("bgcolor"),a("fitbounds")&&(delete b.projection.scale,k?(delete b.center.lon,delete b.center.lat):J?(delete b.center.lon,delete b.center.lat,delete b.projection.rotation.lon,delete b.projection.rotation.lat,delete b.lonaxis.range,delete b.lataxis.range):(delete b.center.lon,delete b.center.lat,delete b.projection.rotation.lon))}b.exports=function(b,c,a){f(b,c,a,{type:"geo",attributes:h,handleDefaults:j,fullData:a,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../registry"),g=Math.PI/180,h=180/Math.PI,i={cursor:"pointer"},j={cursor:"auto"};function k(b,a){return d.behavior.zoom().translate(a.translate()).scale(a.scale())}function l(a,g,h){var d=a.id,b=a.graphDiv,i=b.layout,l=i[d],j=b._fullLayout,m=j[d],n={},k={};function c(a,b){n[d+"."+a]=e.nestedProperty(l,a).get(),f.call("_storeDirectGUIEdit",i,j._preGUI,n);var c=e.nestedProperty(m,a);c.get()!==b&&(c.set(b),e.nestedProperty(l,a).set(b),k[d+"."+a]=b)}h(c),c("projection.scale",g.scale()/a.fitScale),c("fitbounds",!1),b.emit("plotly_relayout",k)}function m(b,c){var a=k(b,c);function e(a){var d=c.invert(b.midPt);a("center.lon",d[0]),a("center.lat",d[1])}return a.on("zoomstart",function(){d.select(this).style(i)}).on("zoom",function(){c.scale(d.event.scale).translate(d.event.translate),b.render(!0);var a=c.invert(b.midPt);b.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":c.scale()/b.fitScale,"geo.center.lon":a[0],"geo.center.lat":a[1]})}).on("zoomend",function(){d.select(this).style(j),l(b,c,e)}),a}function n(b,c){var e,f,g,h,m,n,o,p,q,a=k(b,c);function r(a){return c.invert(a)}function s(a){var e=c.rotate(),d=c.invert(b.midPt);a("projection.rotation.lon",-e[0]),a("center.lon",d[0]),a("center.lat",d[1])}return a.on("zoomstart",function(){d.select(this).style(i),e=d.mouse(this),f=c.rotate(),g=c.translate(),h=f,m=r(e)}).on("zoom",function(){if(n=d.mouse(this),function(a){var b=r(a);if(!b)return!0;var d=c(b);return Math.abs(d[0]-a[0])>2||Math.abs(d[1]-a[1])>2}(e)){a.scale(c.scale()),a.translate(c.translate());return}c.scale(d.event.scale),c.translate([g[0],d.event.translate[1]]),m?r(n)&&(p=r(n),o=[h[0]+(p[0]-m[0]),f[1],f[2]],c.rotate(o),h=o):m=r(e=n),q=!0,b.render(!0);var j=c.rotate(),i=c.invert(b.midPt);b.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":c.scale()/b.fitScale,"geo.center.lon":i[0],"geo.center.lat":i[1],"geo.projection.rotation.lon":-j[0]})}).on("zoomend",function(){d.select(this).style(j),q&&l(b,c,s)}),a}function o(c,b){var f,g={r:b.rotate(),k:b.scale()},a=k(c,b),e=B(a,"zoomstart","zoom","zoomend"),h=0,m=a.on;function n(a){var c=b.rotate();a("projection.rotation.lon",-c[0]),a("projection.rotation.lat",-c[1])}return a.on("zoomstart",function(){d.select(this).style(i);var c,k=d.mouse(this),j=b.rotate(),l=j,n=b.translate(),o=q(j);f=p(b,k),m.call(a,"zoom",function(){var c=d.mouse(this);if(b.scale(g.k=d.event.scale),f){if(p(b,c)){b.rotate(j).translate(n);var h=x(r(o,s(f,p(b,c)))),a=g.r=t(h,f,l);isFinite(a[0])&&isFinite(a[1])&&isFinite(a[2])||(a=l),b.rotate(a),l=a}}else f=p(b,k=c);(function(a){a({type:"zoom"})})(e.of(this,arguments))}),c=e.of(this,arguments),h++ ||c({type:"zoomstart"})}).on("zoomend",function(){var f;d.select(this).style(j),m.call(a,"zoom",null),f=e.of(this,arguments),--h||f({type:"zoomend"}),l(c,b,n)}).on("zoom.redraw",function(){c.render(!0);var a=b.rotate();c.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":b.scale()/c.fitScale,"geo.projection.rotation.lon":-a[0],"geo.projection.rotation.lat":-a[1]})}),d.rebind(a,e,"on")}function p(b,c){var a=b.invert(c);return a&&isFinite(a[0])&&isFinite(a[1])&&y(a)}function q(h){var i=.5*h[0]*g,j=.5*h[1]*g,k=.5*h[2]*g,a=Math.sin(i),b=Math.cos(i),c=Math.sin(j),d=Math.cos(j),e=Math.sin(k),f=Math.cos(k);return[b*d*f+a*c*e,a*d*f-b*c*e,b*c*f+a*d*e,b*d*e-a*c*f]}function r(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=b[0],h=b[1],i=b[2],j=b[3];return[c*g-d*h-e*i-f*j,c*h+d*g+e*j-f*i,c*i-d*j+e*g+f*h,c*j+d*i-e*h+f*g]}function s(b,c){if(b&&c){var a=A(b,c),e=Math.sqrt(z(a,a)),f=.5*Math.acos(Math.max(-1,Math.min(1,z(b,c)))),d=Math.sin(f)/e;return e&&[Math.cos(f),a[2]*d,-a[1]*d,a[0]*d]}}function t(i,e,a){var f,c,b=w(e,2,i[0]);b=w(b,1,i[1]),b=w(b,0,i[2]-a[2]);var j=e[0],k=e[1],m=e[2],n=b[0],d=b[1],o=b[2],l=Math.atan2(k,j)*h,g=Math.sqrt(j*j+k*k);Math.abs(d)>g?(c=(d>0?90:-90)-l,f=0):(c=Math.asin(d/g)*h-l,f=Math.sqrt(g*g-d*d));var p=180-c-2*l,q=(Math.atan2(o,n)-Math.atan2(m,f))*h,r=(Math.atan2(o,n)-Math.atan2(m,-f))*h,s=u(a[0],a[1],c,q),t=u(a[0],a[1],p,r);return s<=t?[c,q,a[2]]:[p,r,a[2]]}function u(c,d,e,f){var a=v(e-c),b=v(f-d);return Math.sqrt(a*a+b*b)}function v(a){return(a%360+540)%360-180}function w(a,e,j){var f=j*g,b=a.slice(),c=0===e?1:0,d=2===e?1:2,h=Math.cos(f),i=Math.sin(f);return b[c]=a[c]*h-a[d]*i,b[d]=a[d]*h+a[c]*i,b}function x(a){return[Math.atan2(2*(a[0]*a[1]+a[2]*a[3]),1-2*(a[1]*a[1]+a[2]*a[2]))*h,Math.asin(Math.max(-1,Math.min(1,2*(a[0]*a[2]-a[3]*a[1]))))*h,Math.atan2(2*(a[0]*a[3]+a[1]*a[2]),1-2*(a[2]*a[2]+a[3]*a[3]))*h]}function y(a){var b=a[0]*g,c=a[1]*g,d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function z(b,d){for(var c=0,a=0,e=b.length;a<e;++a)c+=b[a]*d[a];return c}function A(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function B(f){for(var a=0,e=arguments.length,b=[];++a<e;)b.push(arguments[a]);var c=d.dispatch.apply(null,b);return c.of=function(a,b){return function(e){var g;try{g=e.sourceEvent=d.event,e.target=f,d.event=e,c[e.type].apply(a,b)}finally{d.event=g}}},c}b.exports=function(a,b){var c=a.projection;return(b._isScoped?m:b._isClipped?o:n)(a,c)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(b,c,a){"use strict";var d=b("../registry"),e=b("./cartesian/constants").SUBPLOT_PATTERN;a.getSubplotCalcData=function(b,g,h){var c=d.subplotsRegistry[g];if(!c)return[];for(var i=c.attr,e=[],a=0;a<b.length;a++){var f=b[a];f[0].trace[i]===h&&e.push(f)}return e},a.getModuleCalcData=function(b,a){var h,c=[],i=[];if(!(h="string"==typeof a?d.getModule(a).plot:"function"==typeof a?a:a.plot))return[c,b];for(var e=0;e<b.length;e++){var f=b[e],g=f[0].trace;!0===g.visible&&0!==g._length&&(g._module.plot===h?c.push(f):i.push(f))}return[c,i]},a.getSubplotData=function(h,b,i){if(!d.subplotsRegistry[b])return[];var a,j,k,c=d.subplotsRegistry[b].attr,f=[];if("gl2d"===b){var l=i.match(e);j="x"+l[1],k="y"+l[2]}for(var g=0;g<h.length;g++)a=h[g],"gl2d"===b&&d.traceIs(a,"gl2d")?a[c[0]]===j&&a[c[1]]===k&&f.push(a):a[c]===i&&f.push(a);return f}},{"../registry":647,"./cartesian/constants":573}],603:[function(a,b,c){"use strict";var d=a("mouse-change"),e=a("mouse-wheel"),f=a("mouse-event-offset"),g=a("../cartesian/constants"),h=a("has-passive-events");function i(a,b){this.element=a,this.plot=b,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}b.exports=function(c){var a=c.mouseContainer,j=c.glplot,b=new i(a,j);function l(){c.xaxis.autorange=!1,c.yaxis.autorange=!1}function k(m,h,d){var e,f,a=c.calcDataBox(),k=j.viewBox,u=b.lastPos[0],v=b.lastPos[1],n=g.MINDRAG*j.pixelRatio,o=g.MINZOOM*j.pixelRatio;function p(d,e,f){var g=Math.min(e,f),h=Math.max(e,f);g!==h?(a[d]=g,a[d+2]=h,b.dataBox=a,c.setRanges(a)):(c.selectBox.selectBox=[0,0,1,1],c.glplot.setDirty())}switch(h*=j.pixelRatio,d*=j.pixelRatio,d=k[3]-k[1]-d,c.fullLayout.dragmode){case"zoom":if(m){var q=h/(k[2]-k[0])*(a[2]-a[0])+a[0],r=d/(k[3]-k[1])*(a[3]-a[1])+a[1];b.boxInited||(b.boxStart[0]=q,b.boxStart[1]=r,b.dragStart[0]=h,b.dragStart[1]=d),b.boxEnd[0]=q,b.boxEnd[1]=r,b.boxInited=!0,b.boxEnabled||b.boxStart[0]===b.boxEnd[0]&&b.boxStart[1]===b.boxEnd[1]||(b.boxEnabled=!0);var s=Math.abs(b.dragStart[0]-h)<o,t=Math.abs(b.dragStart[1]-d)<o;if(function(){for(var b=c.graphDiv._fullLayout._axisConstraintGroups,d=c.xaxis._id,e=c.yaxis._id,a=0;a<b.length;a++)if(-1!==b[a][d]){if(-1!==b[a][e])return!0;break}return!1}()&&!(s&&t)){e=b.boxEnd[0]-b.boxStart[0],f=b.boxEnd[1]-b.boxStart[1];var i=(a[3]-a[1])/(a[2]-a[0]);Math.abs(e*i)>Math.abs(f)?(b.boxEnd[1]=b.boxStart[1]+Math.abs(e)*i*(f>=0?1:-1),b.boxEnd[1]<a[1]?(b.boxEnd[1]=a[1],b.boxEnd[0]=b.boxStart[0]+(a[1]-b.boxStart[1])/Math.abs(i)):b.boxEnd[1]>a[3]&&(b.boxEnd[1]=a[3],b.boxEnd[0]=b.boxStart[0]+(a[3]-b.boxStart[1])/Math.abs(i))):(b.boxEnd[0]=b.boxStart[0]+Math.abs(f)/i*(e>=0?1:-1),b.boxEnd[0]<a[0]?(b.boxEnd[0]=a[0],b.boxEnd[1]=b.boxStart[1]+(a[0]-b.boxStart[0])*Math.abs(i)):b.boxEnd[0]>a[2]&&(b.boxEnd[0]=a[2],b.boxEnd[1]=b.boxStart[1]+(a[2]-b.boxStart[0])*Math.abs(i)))}else s&&(b.boxEnd[0]=b.boxStart[0]),t&&(b.boxEnd[1]=b.boxStart[1])}else b.boxEnabled?(e=b.boxStart[0]!==b.boxEnd[0],f=b.boxStart[1]!==b.boxEnd[1],e||f?(e&&(p(0,b.boxStart[0],b.boxEnd[0]),c.xaxis.autorange=!1),f&&(p(1,b.boxStart[1],b.boxEnd[1]),c.yaxis.autorange=!1),c.relayoutCallback()):c.glplot.setDirty(),b.boxEnabled=!1,b.boxInited=!1):b.boxInited&&(b.boxInited=!1);break;case"pan":b.boxEnabled=!1,b.boxInited=!1,m?(b.panning||(b.dragStart[0]=h,b.dragStart[1]=d),Math.abs(b.dragStart[0]-h)<n&&(h=b.dragStart[0]),Math.abs(b.dragStart[1]-d)<n&&(d=b.dragStart[1]),e=(u-h)*(a[2]-a[0])/(j.viewBox[2]-j.viewBox[0]),f=(v-d)*(a[3]-a[1])/(j.viewBox[3]-j.viewBox[1]),a[0]+=e,a[2]+=e,a[1]+=f,a[3]+=f,c.setRanges(a),b.panning=!0,b.lastInputTime=Date.now(),l(),c.cameraChanged(),c.handleAnnotations()):b.panning&&(b.panning=!1,c.relayoutCallback());break}b.lastPos[0]=h,b.lastPos[1]=d}return b.mouseListener=d(a,k),a.addEventListener("touchstart",function(c){var b=f(c.changedTouches[0],a);k(0,b[0],b[1]),k(1,b[0],b[1]),c.preventDefault()},!!h&&{passive:!1}),a.addEventListener("touchmove",function(b){b.preventDefault();var c=f(b.changedTouches[0],a);k(1,c[0],c[1]),b.preventDefault()},!!h&&{passive:!1}),a.addEventListener("touchend",function(a){k(0,b.lastPos[0],b.lastPos[1]),a.preventDefault()},!!h&&{passive:!1}),b.wheelListener=e(a,function(m,h){if(!c.scrollZoom)return!1;var a=c.calcDataBox(),d=j.viewBox,i=b.lastPos[0],k=b.lastPos[1],e=Math.exp(5*h/(d[3]-d[1])),f=i/(d[2]-d[0])*(a[2]-a[0])+a[0],g=k/(d[3]-d[1])*(a[3]-a[1])+a[1];return a[0]=(a[0]-f)*e+f,a[2]=(a[2]-f)*e+f,a[1]=(a[1]-g)*e+g,a[3]=(a[3]-g)*e+g,c.setRanges(a),b.lastInputTime=Date.now(),l(),c.cameraChanged(),c.handleAnnotations(),c.relayoutCallback(),!0},!0),b}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(b,c,e){"use strict";var f=b("../cartesian/axes"),g=b("../../lib/str2rgbarray");function d(a){this.scene=a,this.gl=a.gl,this.pixelRatio=a.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var a=d.prototype,h=["xaxis","yaxis"];a.merge=function(m){for(a=0,this.titleEnable=!1,this.backgroundColor=g(m.plot_bgcolor);a<2;++a){var d,b,n,e,f,i,j,k,l,a,c,o=(d=h[a]).charAt(0);for(c=0,n=(b=m[this.scene[d]._name]).title.text===this.scene.fullLayout._dfltTitle[o]?"":b.title.text;c<=2;c+=2)this.labelEnable[a+c]=!1,this.labels[a+c]=n,this.labelColor[a+c]=g(b.title.font.color),this.labelFont[a+c]=b.title.font.family,this.labelSize[a+c]=b.title.font.size,this.labelPad[a+c]=this.getLabelPad(d,b),this.tickEnable[a+c]=!1,this.tickColor[a+c]=g((b.tickfont||{}).color),this.tickAngle[a+c]="auto"===b.tickangle?0:-(Math.PI*b.tickangle)/180,this.tickPad[a+c]=this.getTickPad(b),this.tickMarkLength[a+c]=0,this.tickMarkWidth[a+c]=b.tickwidth||0,this.tickMarkColor[a+c]=g(b.tickcolor),this.borderLineEnable[a+c]=!1,this.borderLineColor[a+c]=g(b.linecolor),this.borderLineWidth[a+c]=b.linewidth||0;j=this.hasSharedAxis(b),f=this.hasAxisInDfltPos(d,b)&&!j,i=this.hasAxisInAltrPos(d,b)&&!j,e=b.mirror||!1,k=j?-1!==String(e).indexOf("all"):!!e,l=j?"allticks"===e:-1!==String(e).indexOf("ticks"),f?this.labelEnable[a]=!0:i&&(this.labelEnable[a+2]=!0),f?this.tickEnable[a]=b.showticklabels:i&&(this.tickEnable[a+2]=b.showticklabels),(f||k)&&(this.borderLineEnable[a]=b.showline),(i||k)&&(this.borderLineEnable[a+2]=b.showline),(f||l)&&(this.tickMarkLength[a]=this.getTickMarkLength(b)),(i||l)&&(this.tickMarkLength[a+2]=this.getTickMarkLength(b)),this.gridLineEnable[a]=b.showgrid,this.gridLineColor[a]=g(b.gridcolor),this.gridLineWidth[a]=b.gridwidth,this.zeroLineEnable[a]=b.zeroline,this.zeroLineColor[a]=g(b.zerolinecolor),this.zeroLineWidth[a]=b.zerolinewidth}},a.hasSharedAxis=function(b){var a=this.scene,c=a.fullLayout._subplots.gl2d;return 0!==f.findSubplotsWithAxis(c,b).indexOf(a.id)},a.hasAxisInDfltPos=function(a,c){var b=c.side;return"xaxis"===a?"bottom"===b:"yaxis"===a?"left"===b:void 0},a.hasAxisInAltrPos=function(a,c){var b=c.side;return"xaxis"===a?"top"===b:"yaxis"===a?"right"===b:void 0},a.getLabelPad=function(d,a){var b=a.title.font.size,c=a.showticklabels;return"xaxis"===d?"top"===a.side?-10+b*(1.5+(c?1:0)):-10+b*(1.5+(c?.5:0)):"yaxis"===d?"right"===a.side?10+b*(1.5+(c?1:.5)):10+b*(1.5+(c?.5:0)):void 0},a.getTickPad=function(a){return"outside"===a.ticks?10+a.ticklen:15},a.getTickMarkLength=function(a){if(!a.ticks)return 0;var b=a.ticklen;return"inside"===a.ticks?-b:b},c.exports=function(a){return new d(a)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(b,h,a){"use strict";var c=b("../../plot_api/edit_types").overrideAll,i=b("./scene2d"),e=b("../layout_attributes"),j=b("../../constants/xmlns_namespaces"),d=b("../cartesian/constants"),f=b("../cartesian"),g=b("../../components/fx/layout_attributes"),k=b("../get_data").getSubplotData;a.name="gl2d",a.attr=["xaxis","yaxis"],a.idRoot=["x","y"],a.idRegex=d.idRegex,a.attrRegex=d.attrRegex,a.attributes=b("../cartesian/attributes"),a.supplyLayoutDefaults=function(b,a,c){a._has("cartesian")||f.supplyLayoutDefaults(b,a,c)},a.layoutAttrOverrides=c(f.layoutAttributes,"plot","from-root"),a.baseLayoutAttrOverrides=c({plot_bgcolor:e.plot_bgcolor,hoverlabel:g.hoverlabel},"plot","nested"),a.plot=function(a){for(var b=a._fullLayout,h=a._fullData,f=b._subplots.gl2d,d=0;d<f.length;d++){var e=f[d],g=b._plots[e],j=k(h,"gl2d",e),c=g._scene2d;void 0===c&&(c=new i({id:e,graphDiv:a,container:a.querySelector(".gl-container"),staticPlot:a._context.staticPlot,plotGlPixelRatio:a._context.plotGlPixelRatio},b),g._scene2d=c),c.plot(j,a.calcdata,b,a.layout)}},a.clean=function(g,h,i,a){for(var d=a._subplots.gl2d||[],b=0;b<d.length;b++){var c=d[b],e=a._plots[c];e._scene2d&&0===k(g,"gl2d",c).length&&(e._scene2d.destroy(),delete a._plots[c])}f.clean.apply(this,arguments)},a.drawFramework=function(a){a._context.staticPlot||f.drawFramework(a)},a.toSVG=function(e){for(var a=e._fullLayout,c=a._subplots.gl2d,b=0;b<c.length;b++){var d=a._plots[c[b]]._scene2d,f=d.toImage("png");a._glimages.append("svg:image").attr({xmlns:j.svg,"xlink:href":f,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),d.destroy()}},a.updateFx=function(d){for(var a=d._fullLayout,c=a._subplots.gl2d,b=0;b<c.length;b++)a._plots[c[b]]._scene2d.updateFx(a.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(b,f,g){"use strict";var h,i,j=b("../../registry"),k=b("../../plots/cartesian/axes"),l=b("../../components/fx"),m=b("../../../stackgl_modules").gl_plot2d,n=b("../../../stackgl_modules").gl_spikes2d,o=b("../../../stackgl_modules").gl_select_box,p=b("webgl-context"),q=b("./convert"),r=b("./camera"),s=b("../../lib/show_no_webgl_msg"),c=b("../cartesian/constraints"),t=c.enforce,u=c.clean,v=b("../cartesian/autorange").doAutoRange,d=b("../../components/dragelement/helpers"),w=d.drawMode,x=d.selectMode,y=["xaxis","yaxis"],z=b("../cartesian/constants").SUBPLOT_PATTERN;function e(a,b){this.container=a.container,this.graphDiv=a.graphDiv,this.pixelRatio=a.plotGlPixelRatio||window.devicePixelRatio,this.id=a.id,this.staticPlot=!!a.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(b),this.makeFramework(),this.stopped||(this.glplotOptions=q(this),this.glplotOptions.merge(b),this.glplot=m(this.glplotOptions),this.camera=r(this),this.traces={},this.spikes=n(this.glplot),this.selectBox=o(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}f.exports=e;var a=e.prototype;a.makeFramework=function(){if(this.staticPlot){if(!i&&!(i=p({canvas:h=document.createElement("canvas"),preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0})))throw new Error("Error creating static canvas/context for image server");this.canvas=h,this.gl=i}else{var d=this.container.querySelector(".gl-canvas-focus"),e=p({canvas:d,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!e){s(this),this.stopped=!0;return}this.canvas=d,this.gl=e}var b=this.canvas;b.style.width="100%",b.style.height="100%",b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style["pointer-events"]="none",this.updateSize(b);var a=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");a.style.position="absolute",a.style.top=a.style.left="0px",a.style.width=a.style.height="100%",a.style["z-index"]=20,a.style["pointer-events"]="none";var c=this.mouseContainer=document.createElement("div");c.style.position="absolute",c.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var f=this.container;f.appendChild(a),f.appendChild(c);var g=this;c.addEventListener("mouseout",function(){g.isMouseOver=!1,g.unhover()}),c.addEventListener("mouseover",function(){g.isMouseOver=!0})},a.toImage=function(l){l||(l="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(h),this.updateSize(this.canvas);var i,a=this.glplot.gl,b=a.drawingBufferWidth,g=a.drawingBufferHeight;a.clearColor(1,1,1,0),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),a.bindFramebuffer(a.FRAMEBUFFER,null);var c=new Uint8Array(b*g*4);a.readPixels(0,0,b,g,a.RGBA,a.UNSIGNED_BYTE,c);for(var j=0,k=g-1;j<k;++j,--k)for(var d=0;d<b;++d)for(var e=0;e<4;++e){var o=c[4*(b*j+d)+e];c[4*(b*j+d)+e]=c[4*(b*k+d)+e],c[4*(b*k+d)+e]=o}var f=document.createElement("canvas");f.width=b,f.height=g;var m=f.getContext("2d",{willReadFrequently:!0}),n=m.createImageData(b,g);switch(n.data.set(c),m.putImageData(n,0,0),l){case"jpeg":i=f.toDataURL("image/jpeg");break;case"webp":i=f.toDataURL("image/webp");break;default:i=f.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(h),i},a.updateSize=function(a){a||(a=this.canvas);var b=this.pixelRatio,c=this.fullLayout,f=c.width,g=c.height,d=0|Math.ceil(b*f),e=0|Math.ceil(b*g);return(a.width!==d||a.height!==e)&&(a.width=d,a.height=e),a},a.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var b=[k.calcTicks(this.xaxis),k.calcTicks(this.yaxis)],a=0;a<2;++a)for(var c=0;c<b[a].length;++c)b[a][c].text=b[a][c].text+"";return b},a.updateRefs=function(b){this.fullLayout=b;var a=this.id.match(z),c="xaxis"+a[1],d="yaxis"+a[2];this.xaxis=this.fullLayout[c],this.yaxis=this.fullLayout[d]},a.relayoutCallback=function(){var d=this.graphDiv,b=this.xaxis,c=this.yaxis,e=d.layout,a={},h=a[b._name+".range"]=b.range.slice(),i=a[c._name+".range"]=c.range.slice();a[b._name+".autorange"]=b.autorange,a[c._name+".autorange"]=c.autorange,j.call("_storeDirectGUIEdit",d.layout,d._fullLayout._preGUI,a);var f=e[b._name];f.range=h,f.autorange=b.autorange;var g=e[c._name];g.range=i,g.autorange=c.autorange,a.lastInputTime=this.camera.lastInputTime,d.emit("plotly_relayout",a)},a.cameraChanged=function(){var b=this.camera;this.glplot.setDataBox(this.calcDataBox());var a=this.computeTickMarks();(function(e,f){for(var a=0;a<2;++a){var c=e[a],d=f[a];if(c.length!==d.length)return!0;for(var b=0;b<c.length;++b)if(c[b].x!==d[b].x)return!0}return!1})(a,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=a,this.glplotOptions.dataBox=b.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},a.handleAnnotations=function(){for(var d=this.graphDiv,b=this.fullLayout.annotations,a=0;a<b.length;a++){var c=b[a];c.xref===this.xaxis._id&&c.yref===this.yaxis._id&&j.getComponentMethod("annotations","drawOne")(d,a)}},a.destroy=function(){if(this.glplot){var a=this.traces;a&&Object.keys(a).map(function(b){a[b].dispose(),delete a[b]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},a.plot=function(k,l,b){var g,e,m=this.glplot;this.updateRefs(b),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(k,l),this.updateFx(b.dragmode);var i=b.width,j=b.height;this.updateSize(this.canvas);var c=this.glplotOptions;c.merge(b),c.screenBox=[0,0,i,j];var h={_fullLayout:{_axisConstraintGroups:b._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:b._size}};u(h,this.xaxis),u(h,this.yaxis);var a=b._size,f=this.xaxis.domain,d=this.yaxis.domain;for(e=0,c.viewBox=[a.l+f[0]*a.w,a.b+d[0]*a.h,i-a.r-(1-f[1])*a.w,j-a.t-(1-d[1])*a.h],this.mouseContainer.style.width=a.w*(f[1]-f[0])+"px",this.mouseContainer.style.height=a.h*(d[1]-d[0])+"px",this.mouseContainer.height=a.h*(d[1]-d[0]),this.mouseContainer.style.left=a.l+f[0]*a.w+"px",this.mouseContainer.style.top=a.t+(1-d[1])*a.h+"px";e<2;++e)(g=this[y[e]])._length=c.viewBox[e+2]-c.viewBox[e],v(this.graphDiv,g),g.setScale();t(h),c.ticks=this.computeTickMarks(),c.dataBox=this.calcDataBox(),c.merge(b),m.update(c),this.glplot.draw()},a.calcDataBox=function(){var a=this.xaxis,b=this.yaxis,c=a.range,d=b.range,e=a.r2l,f=b.r2l;return[e(c[0]),f(d[0]),e(c[1]),f(d[1])]},a.setRanges=function(a){var b=this.xaxis,c=this.yaxis,d=b.l2r,e=c.l2r;b.range=[d(a[0]),d(a[2])],c.range=[e(a[1]),e(a[3])]},a.updateTraces=function(c,j){var a,d,b,g=Object.keys(this.traces);this.fullData=c;traceIdLoop:for(a=0;a<g.length;a++){var f=g[a],h=this.traces[f];for(d=0;d<c.length;d++)if((b=c[d]).uid===f&&b.type===h.type)continue traceIdLoop;h.dispose(),delete this.traces[f]}for(a=0;a<c.length;a++){b=c[a];var i=j[a],e=this.traces[b.uid];e?e.update(b,i):(e=b._module.plot(this,b,i),this.traces[b.uid]=e)}this.glplot.objects.sort(function(a,b){return a._trace.index-b._trace.index})},a.updateFx=function(a){x(a)||w(a)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),"pan"===a?this.mouseContainer.style.cursor="move":"zoom"===a?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},a.emitPointAction=function(a,f){for(var b,g=a.trace.uid,d=a.pointIndex,c=0;c<this.fullData.length;c++)this.fullData[c].uid===g&&(b=this.fullData[c]);var e={x:a.traceCoord[0],y:a.traceCoord[1],curveNumber:b.index,pointNumber:d,data:b._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};l.appendArrayPointValue(e,b,d),this.graphDiv.emit(f,{points:[e]})},a.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var e,a=this.glplot,c=this.camera,j=c.mouseListener,p=1===this.lastButtonState&&0===j.buttons,k=this.fullLayout;this.lastButtonState=j.buttons,this.cameraChanged();var q=j.x*a.pixelRatio,r=this.canvas.height-a.pixelRatio*j.y;if(c.boxEnabled&&"zoom"===k.dragmode){this.selectBox.enabled=!0;for(var o=this.selectBox.selectBox=[Math.min(c.boxStart[0],c.boxEnd[0]),Math.min(c.boxStart[1],c.boxEnd[1]),Math.max(c.boxStart[0],c.boxEnd[0]),Math.max(c.boxStart[1],c.boxEnd[1])],f=0;f<2;f++)c.boxStart[f]===c.boxEnd[f]&&(o[f]=a.dataBox[f],o[f+2]=a.dataBox[f+2]);a.setDirty()}else if(!c.panning&&this.isMouseOver){this.selectBox.enabled=!1;var m=k._size,s=this.xaxis.domain,t=this.yaxis.domain,d=(e=a.pick(q/a.pixelRatio+m.l+s[0]*m.w,r/a.pixelRatio-(m.t+(1-t[1])*m.h)))&&e.object._trace.handlePick(e);if(d&&p&&this.emitPointAction(d,"plotly_click"),e&&"skip"!==e.object._trace.hoverinfo&&k.hovermode&&d&&(!this.lastPickResult||this.lastPickResult.traceUid!==d.trace.uid||this.lastPickResult.dataCoord[0]!==d.dataCoord[0]||this.lastPickResult.dataCoord[1]!==d.dataCoord[1])){var b=d;this.lastPickResult={traceUid:d.trace?d.trace.uid:null,dataCoord:d.dataCoord.slice()},this.spikes.update({center:e.dataCoord}),b.screenCoord=[((a.viewBox[2]-a.viewBox[0])*(e.dataCoord[0]-a.dataBox[0])/(a.dataBox[2]-a.dataBox[0])+a.viewBox[0])/a.pixelRatio,(this.canvas.height-(a.viewBox[3]-a.viewBox[1])*(e.dataCoord[1]-a.dataBox[1])/(a.dataBox[3]-a.dataBox[1])-a.viewBox[1])/a.pixelRatio],this.emitPointAction(d,"plotly_hover");var g=this.fullData[b.trace.index]||{},h=b.pointIndex,n=l.castHoverinfo(g,k,h);if(n&&"all"!==n){var i=n.split("+");-1===i.indexOf("x")&&(b.traceCoord[0]=void 0),-1===i.indexOf("y")&&(b.traceCoord[1]=void 0),-1===i.indexOf("z")&&(b.traceCoord[2]=void 0),-1===i.indexOf("text")&&(b.textLabel=void 0),-1===i.indexOf("name")&&(b.name=void 0)}l.loneHover({x:b.screenCoord[0],y:b.screenCoord[1],xLabel:this.hoverFormatter("xaxis",b.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",b.traceCoord[1]),zLabel:b.traceCoord[2],text:b.textLabel,name:b.name,color:l.castHoverOption(g,h,"bgcolor")||b.color,borderColor:l.castHoverOption(g,h,"bordercolor"),fontFamily:l.castHoverOption(g,h,"font.family"),fontSize:l.castHoverOption(g,h,"font.size"),fontColor:l.castHoverOption(g,h,"font.color"),nameLength:l.castHoverOption(g,h,"namelength"),textAlign:l.castHoverOption(g,h,"align")},{container:this.svgContainer,gd:this.graphDiv})}}e||this.unhover(),a.draw()}},a.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),l.loneUnhover(this.svgContainer))},a.hoverFormatter=function(c,a){if(void 0!==a){var b=this[c];return k.tickText(b,b.c2l(a),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(b,h,a){"use strict";var d=b("../../plot_api/edit_types").overrideAll,e=b("../../components/fx/layout_attributes"),i=b("./scene"),j=b("../get_data").getSubplotData,f=b("../../lib"),k=b("../../constants/xmlns_namespaces"),g="gl3d",c="scene";a.name=g,a.attr=c,a.idRoot=c,a.idRegex=a.attrRegex=f.counterRegex("scene"),a.attributes=b("./layout/attributes"),a.layoutAttributes=b("./layout/layout_attributes"),a.baseLayoutAttrOverrides=d({hoverlabel:e.hoverlabel},"plot","nested"),a.supplyLayoutDefaults=b("./layout/defaults"),a.plot=function(b){for(var d=b._fullLayout,l=b._fullData,k=d._subplots[g],e=0;e<k.length;e++){var f=k[e],m=j(l,g,f),h=d[f],a=h.camera,c=h._scene;c||(c=new i({id:f,graphDiv:b,container:b.querySelector(".gl-container"),staticPlot:b._context.staticPlot,plotGlPixelRatio:b._context.plotGlPixelRatio,camera:a},d),h._scene=c),c.viewInitial||(c.viewInitial={up:{x:a.up.x,y:a.up.y,z:a.up.z},eye:{x:a.eye.x,y:a.eye.y,z:a.eye.z},center:{x:a.center.x,y:a.center.y,z:a.center.z}}),c.plot(m,d,b.layout)}},a.clean=function(f,e,h,a){for(var d=a._subplots[g]||[],c=0;c<d.length;c++){var b=d[c];!e[b]&&a[b]._scene&&(a[b]._scene.destroy(),a._infolayer&&a._infolayer.selectAll(".annotation-"+b).remove())}},a.toSVG=function(i){for(var c=i._fullLayout,e=c._subplots[g],a=c._size,d=0;d<e.length;d++){var f=c[e[d]],b=f.domain,h=f._scene,j=h.toImage("png");c._glimages.append("svg:image").attr({xmlns:k.svg,"xlink:href":j,x:a.l+a.w*b.x[0],y:a.t+a.h*(1-b.y[1]),width:a.w*(b.x[1]-b.x[0]),height:a.h*(b.y[1]-b.y[0]),preserveAspectRatio:"none"}),h.destroy()}},a.cleanId=function(b){if(b.match(/^scene[0-9]*$/)){var a=b.substr(5);return"1"===a&&(a=""),c+a}},a.updateFx=function(d){for(var a=d._fullLayout,c=a._subplots[g],b=0;b<c.length;b++)a[c[b]]._scene.updateFx(a.dragmode,a.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(b,a,c){"use strict";a.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(b,d,g){"use strict";var e=b("../../../components/color"),a=b("../../cartesian/layout_attributes"),c=b("../../../lib/extend").extendFlat,f=b("../../../plot_api/edit_types").overrideAll;d.exports=f({visible:a.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:e.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:a.color,categoryorder:a.categoryorder,categoryarray:a.categoryarray,title:{text:a.title.text,font:a.title.font},type:c({},a.type,{values:["-","linear","log","date","category"]}),autotypenumbers:a.autotypenumbers,autorange:a.autorange,rangemode:a.rangemode,range:c({},a.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,mirror:a.mirror,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:a.tickfont,tickangle:a.tickangle,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,minexponent:a.minexponent,separatethousands:a.separatethousands,tickformat:a.tickformat,tickformatstops:a.tickformatstops,hoverformat:a.hoverformat,showline:a.showline,linecolor:a.linecolor,linewidth:a.linewidth,showgrid:a.showgrid,gridcolor:c({},a.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:a.gridwidth,zeroline:a.zeroline,zerolinecolor:a.zerolinecolor,zerolinewidth:a.zerolinewidth,_deprecated:{title:a._deprecated.title,titlefont:a._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(a,b,c){"use strict";var d=a("tinycolor2").mix,e=a("../../../lib"),f=a("../../../plot_api/plot_template"),g=a("./axis_attributes"),h=a("../../cartesian/type_defaults"),i=a("../../cartesian/axis_defaults"),j=["xaxis","yaxis","zaxis"];b.exports=function(n,o,b){var l,c;function a(a,b){return e.coerce(l,c,g,a,b)}for(var m=0;m<j.length;m++){var k=j[m];l=n[k]||{},(c=f.newContainer(o,k))._id=k[0]+b.scene,c._name=k,h(l,c,a,b),i(l,c,a,{font:b.font,letter:k[0],data:b.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:b.bgColor,calendar:b.calendar},b.fullLayout),a("gridcolor",d(c.color,b.bgColor,72.72727272727273).toRgbString()),a("title.text",k[0]),c.setScale=e.noop,a("showspikes")&&(a("spikesides"),a("spikethickness"),a("spikecolor",c.color)),a("showaxeslabels"),a("showbackground")&&a("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(a,b,d){"use strict";var e=a("../../../lib/str2rgbarray"),f=a("../../../lib"),g=["xaxis","yaxis","zaxis"];function c(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}c.prototype.merge=function(d,h){for(var c=this,b=0;b<3;++b){var a=h[g[b]];if(!a.visible){c.tickEnable[b]=!1,c.labelEnable[b]=!1,c.lineEnable[b]=!1,c.lineTickEnable[b]=!1,c.gridEnable[b]=!1,c.zeroEnable[b]=!1,c.backgroundEnable[b]=!1;continue}c.labels[b]=d._meta?f.templateString(a.title.text,d._meta):a.title.text,"font"in a.title&&(a.title.font.color&&(c.labelColor[b]=e(a.title.font.color)),a.title.font.family&&(c.labelFont[b]=a.title.font.family),a.title.font.size&&(c.labelSize[b]=a.title.font.size)),"showline"in a&&(c.lineEnable[b]=a.showline),"linecolor"in a&&(c.lineColor[b]=e(a.linecolor)),"linewidth"in a&&(c.lineWidth[b]=a.linewidth),"showgrid"in a&&(c.gridEnable[b]=a.showgrid),"gridcolor"in a&&(c.gridColor[b]=e(a.gridcolor)),"gridwidth"in a&&(c.gridWidth[b]=a.gridwidth),"log"===a.type?c.zeroEnable[b]=!1:"zeroline"in a&&(c.zeroEnable[b]=a.zeroline),"zerolinecolor"in a&&(c.zeroLineColor[b]=e(a.zerolinecolor)),"zerolinewidth"in a&&(c.zeroLineWidth[b]=a.zerolinewidth),"ticks"in a&&a.ticks?c.lineTickEnable[b]=!0:c.lineTickEnable[b]=!1,"ticklen"in a&&(c.lineTickLength[b]=c._defaultLineTickLength[b]=a.ticklen),"tickcolor"in a&&(c.lineTickColor[b]=e(a.tickcolor)),"tickwidth"in a&&(c.lineTickWidth[b]=a.tickwidth),"tickangle"in a&&(c.tickAngle[b]="auto"===a.tickangle?-3600:-(Math.PI*a.tickangle)/180),"showticklabels"in a&&(c.tickEnable[b]=a.showticklabels),"tickfont"in a&&(a.tickfont.color&&(c.tickColor[b]=e(a.tickfont.color)),a.tickfont.family&&(c.tickFont[b]=a.tickfont.family),a.tickfont.size&&(c.tickSize[b]=a.tickfont.size)),"mirror"in a?-1!==["ticks","all","allticks"].indexOf(a.mirror)?(c.lineTickMirror[b]=!0,c.lineMirror[b]=!0):!0===a.mirror?(c.lineTickMirror[b]=!1,c.lineMirror[b]=!0):(c.lineTickMirror[b]=!1,c.lineMirror[b]=!1):c.lineMirror[b]=!1,"showbackground"in a&& !1!==a.showbackground?(c.backgroundEnable[b]=!0,c.backgroundColor[b]=e(a.backgroundcolor)):c.backgroundEnable[b]=!1}},b.exports=function(b,d){var a=new c;return a.merge(b,d),a}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(a,b,c){"use strict";var d=a("../../../lib"),e=a("../../../components/color"),f=a("../../../registry"),g=a("../../subplot_defaults"),h=a("./axis_defaults"),i=a("./layout_attributes"),j=a("../../get_data").getSubplotData,k="gl3d";function l(c,g,a,b){for(var q=a("bgcolor"),r=e.combine(q,b.paper_bgcolor),m=["up","center","eye"],i=0;i<m.length;i++)a("camera."+m[i]+".x"),a("camera."+m[i]+".y"),a("camera."+m[i]+".z");a("camera.projection.type");var p=!!a("aspectratio.x")&&!!a("aspectratio.y")&&!!a("aspectratio.z"),s=a("aspectmode",p?"manual":"auto");p||(c.aspectratio=g.aspectratio={x:1,y:1,z:1},"manual"===s&&(g.aspectmode="auto"),c.aspectmode=g.aspectmode);var t=j(b.fullData,k,b.id);h(c,g,{font:b.font,scene:b.id,data:t,bgColor:r,calendar:b.calendar,autotypenumbersDflt:b.autotypenumbersDflt,fullLayout:b.fullLayout}),f.getComponentMethod("annotations3d","handleDefaults")(c,g,b);var d=b.getDfltFromLayout("dragmode");if(!1!==d&&!d)if(d="orbit",c.camera&&c.camera.up){var n=c.camera.up.x,o=c.camera.up.y,l=c.camera.up.z;0!==l&&(n&&o&&l?l/Math.sqrt(n*n+o*o+l*l)>.999&&(d="turntable"):d="turntable")}else d="turntable";a("dragmode",d),a("hovermode",b.getDfltFromLayout("hovermode"))}b.exports=function(c,a,b){var e=a._basePlotModules.length>1;g(c,a,b,{type:k,attributes:i,handleDefaults:l,fullLayout:a,font:a.font,fullData:b,getDfltFromLayout:function(a){if(!e&&d.validate(c[a],i[a]))return c[a]},autotypenumbersDflt:a.autotypenumbers,paper_bgcolor:a.paper_bgcolor,calendar:a.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(a,e,h){"use strict";var b=a("./axis_attributes"),f=a("../../domain").attributes,c=a("../../../lib/extend").extendFlat,g=a("../../../lib").counterRegex;function d(a,b,c){return{x:{valType:"number",dflt:a,editType:"camera"},y:{valType:"number",dflt:b,editType:"camera"},z:{valType:"number",dflt:c,editType:"camera"},editType:"camera"}}e.exports={_arrayAttrRegexps:[g("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:c(d(0,0,1),{}),center:c(d(0,0,0),{}),eye:c(d(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:f({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:b,yaxis:b,zaxis:b,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(a,b,d){"use strict";var e=a("../../../lib/str2rgbarray"),f=["xaxis","yaxis","zaxis"];function c(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}c.prototype.merge=function(c){for(var a=0;a<3;++a){var b=c[f[a]];if(!b.visible){this.enabled[a]=!1,this.drawSides[a]=!1;continue}this.enabled[a]=b.showspikes,this.colors[a]=e(b.spikecolor),this.drawSides[a]=b.spikesides,this.lineWidth[a]=b.spikethickness}},b.exports=function(b){var a=new c;return a.merge(b),a}},{"../../../lib/str2rgbarray":540}],615:[function(a,b,c){"use strict";b.exports=function(c){for(var l=c.axesOptions,i=c.glplot.axesPixels,m=c.fullSceneLayout,k=[[],[],[]],a=0;a<3;++a){var b=m[f[a]];if(b._length=(i[a].hi-i[a].lo)*i[a].pixelsPerDataUnit/c.dataScale[a],Math.abs(b._length)===1/0||isNaN(b._length))k[a]=[];else{b._input_range=b.range.slice(),b.range[0]=i[a].lo/c.dataScale[a],b.range[1]=i[a].hi/c.dataScale[a],b._m=1/(c.dataScale[a]*i[a].pixelsPerDataUnit),b.range[0]===b.range[1]&&(b.range[0]-=1,b.range[1]+=1);var n=b.tickmode;if("auto"===b.tickmode){b.tickmode="linear";var o=b.nticks||e.constrain(b._length/40,4,9);d.autoTicks(b,Math.abs(b.range[1]-b.range[0])/o)}for(var j=d.calcTicks(b,{msUTC:!0}),h=0;h<j.length;++h)j[h].x=j[h].x*c.dataScale[a],"date"===b.type&&(j[h].text=j[h].text.replace(/\<br\>/g," "));k[a]=j,b.tickmode=n}}l.ticks=k;for(var a=0;a<3;++a){g[a]=.5*(c.glplot.bounds[0][a]+c.glplot.bounds[1][a]);for(var h=0;h<2;++h)l.bounds[h][a]=c.glplot.bounds[h][a]}c.contourLevels=function(f){for(var d=new Array(3),a=0;a<3;++a){for(var c=f[a],e=new Array(c.length),b=0;b<c.length;++b)e[b]=c[b].x;d[a]=e}return d}(k)};var d=a("../../cartesian/axes"),e=a("../../../lib"),f=["xaxis","yaxis","zaxis"],g=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(b,a,c){"use strict";function d(d,e){var a,b,c=[0,0,0,0];for(a=0;a<4;++a)for(b=0;b<4;++b)c[b]+=d[4*a+b]*e[a];return c}a.exports=function(a,b){return d(a.projection,d(a.view,d(a.model,[b[0],b[1],b[2],1])))}},{}],617:[function(b,e,g){"use strict";var h,i,c=b("../../../stackgl_modules").gl_plot3d,j=c.createCamera,k=c.createScene,l=b("webgl-context"),m=b("has-passive-events"),n=b("../../registry"),f=b("../../lib"),o=f.preserveDrawingBuffer(),p=b("../../plots/cartesian/axes"),q=b("../../components/fx"),r=b("../../lib/str2rgbarray"),s=b("../../lib/show_no_webgl_msg"),t=b("./project"),u=b("./layout/convert"),v=b("./layout/spikes"),w=b("./layout/tick_marks");function d(c,d){var a=document.createElement("div"),e=c.container;this.graphDiv=c.graphDiv;var b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.style.position="absolute",b.style.top=b.style.left="0px",b.style.width=b.style.height="100%",b.style["z-index"]=20,b.style["pointer-events"]="none",a.appendChild(b),this.svgContainer=b,a.id=c.id,a.style.position="absolute",a.style.top=a.style.left="0px",a.style.width=a.style.height="100%",e.appendChild(a),this.fullLayout=d,this.id=c.id||"scene",this.fullSceneLayout=d[this.id],this.plotArgs=[[],{},{}],this.axesOptions=u(d,d[this.id]),this.spikeOptions=v(d[this.id]),this.container=a,this.staticMode=!!c.staticPlot,this.pixelRatio=this.pixelRatio||c.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=n.getComponentMethod("annotations3d","convert"),this.drawAnnotations=n.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var a=d.prototype;a.prepareOptions=function(){var a={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:o,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!i&&!(i=l({canvas:h=document.createElement("canvas"),preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0})))throw new Error("error creating static canvas/context for image server");a.gl=i,a.canvas=h}return a};var x=!0;a.tryCreatePlot=function(){var a=this,b=a.prepareOptions(),c=!0;try{a.glplot=k(b)}catch(d){if(a.staticMode||!x||o)c=!1;else{f.warn("webgl setup failed possibly due to false preserveDrawingBuffer config. The mobile/tablet device may not be detected by is-mobile module. Enabling preserveDrawingBuffer in second attempt to create webgl scene...");try{o=b.glOptions.preserveDrawingBuffer=!0,a.glplot=k(b)}catch(e){o=b.glOptions.preserveDrawingBuffer=!1,c=!1}}}return x=!1,c},a.initializeGLCamera=function(){var b=this,a=b.fullSceneLayout.camera,c="orthographic"===a.projection.type;b.camera=j(b.container,{center:[a.center.x,a.center.y,a.center.z],eye:[a.eye.x,a.eye.y,a.eye.z],up:[a.up.x,a.up.y,a.up.z],_ortho:c,zoomMin:.01,zoomMax:100,mode:"orbit"})},a.initializeGLPlot=function(){var a=this;if(a.initializeGLCamera(),!a.tryCreatePlot())return s(a);a.traces={},a.make4thDimension();var b=a.graphDiv,c=b.layout,d=function(){var b={};return a.isCameraChanged(c)&&(b[a.id+".camera"]=a.getCamera()),a.isAspectChanged(c)&&(b[a.id+".aspectratio"]=a.glplot.getAspectratio(),"manual"!==c[a.id].aspectmode&&(a.fullSceneLayout.aspectmode=c[a.id].aspectmode=b[a.id+".aspectmode"]="manual")),b},e=function(a){if(!1!==a.fullSceneLayout.dragmode){var b=d();a.saveLayout(c),a.graphDiv.emit("plotly_relayout",b)}};return a.glplot.canvas&&(a.glplot.canvas.addEventListener("mouseup",function(){e(a)}),a.glplot.canvas.addEventListener("wheel",function(f){if(b._context._scrollZoom.gl3d){if(a.camera._ortho){var c=f.deltaX>f.deltaY?1.1:1/1.1,d=a.glplot.getAspectratio();a.glplot.setAspectratio({x:c*d.x,y:c*d.y,z:c*d.z})}e(a)}},!!m&&{passive:!1}),a.glplot.canvas.addEventListener("mousemove",function(){if(!1!==a.fullSceneLayout.dragmode&&0!==a.camera.mouseListener.buttons){var b=d();a.graphDiv.emit("plotly_relayouting",b)}}),a.staticMode||a.glplot.canvas.addEventListener("webglcontextlost",function(c){b&&b.emit&&b.emit("plotly_webglcontextlost",{event:c,layer:a.id})},!1)),a.glplot.oncontextloss=function(){a.recoverContext()},a.glplot.onrender=function(){a.render()},!0},a.render=function(){var d=this,j=d.graphDiv,o=d.svgContainer,A=d.container.getBoundingClientRect();j._fullLayout._calcInverseTransform(j);var D=j._fullLayout._invScaleX,E=j._fullLayout._invScaleY,u=A.width*D,v=A.height*E;o.setAttributeNS(null,"viewBox","0 0 "+u+" "+v),o.setAttributeNS(null,"width",u),o.setAttributeNS(null,"height",v),w(d),d.glplot.axes.update(d.axesOptions);for(var B=Object.keys(d.traces),l=null,a=d.glplot.selection,x=0;x<B.length;++x)"skip"!==(e=d.traces[B[x]]).data.hoverinfo&&e.handlePick(a)&&(l=e),e.setContourLevels&&e.setContourLevels();function m(c,a,e){var b=d.fullSceneLayout[c+"axis"];return"log"!==b.type&&(a=b.d2l(a)),p.hoverLabelText(b,a,e)}if(null!==l){var e,r,s=t(d.glplot.cameraParams,a.dataCoordinate);e=l.data;var c=j._fullData[e.index],g=a.index,b={xLabel:m("x",a.traceCoordinate[0],e.xhoverformat),yLabel:m("y",a.traceCoordinate[1],e.yhoverformat),zLabel:m("z",a.traceCoordinate[2],e.zhoverformat)},y=q.castHoverinfo(c,d.fullLayout,g),h=(y||"").split("+"),n=y&&"all"===y;c.hovertemplate||n||(-1===h.indexOf("x")&&(b.xLabel=void 0),-1===h.indexOf("y")&&(b.yLabel=void 0),-1===h.indexOf("z")&&(b.zLabel=void 0),-1===h.indexOf("text")&&(a.textLabel=void 0),-1!==h.indexOf("name")||(l.name=void 0));var i=[];"cone"===e.type||"streamtube"===e.type?(b.uLabel=m("x",a.traceCoordinate[3],e.uhoverformat),(n|| -1!==h.indexOf("u"))&&i.push("u: "+b.uLabel),b.vLabel=m("y",a.traceCoordinate[4],e.vhoverformat),(n|| -1!==h.indexOf("v"))&&i.push("v: "+b.vLabel),b.wLabel=m("z",a.traceCoordinate[5],e.whoverformat),(n|| -1!==h.indexOf("w"))&&i.push("w: "+b.wLabel),b.normLabel=a.traceCoordinate[6].toPrecision(3),(n|| -1!==h.indexOf("norm"))&&i.push("norm: "+b.normLabel),"streamtube"===e.type&&(b.divergenceLabel=a.traceCoordinate[7].toPrecision(3),(n|| -1!==h.indexOf("divergence"))&&i.push("divergence: "+b.divergenceLabel)),a.textLabel&&i.push(a.textLabel),r=i.join("<br>")):"isosurface"===e.type||"volume"===e.type?(b.valueLabel=p.hoverLabelText(d._mockAxis,d._mockAxis.d2l(a.traceCoordinate[3]),e.valuehoverformat),i.push("value: "+b.valueLabel),a.textLabel&&i.push(a.textLabel),r=i.join("<br>")):r=a.textLabel;var k={x:a.traceCoordinate[0],y:a.traceCoordinate[1],z:a.traceCoordinate[2],data:c._input,fullData:c,curveNumber:c.index,pointNumber:g};q.appendArrayPointValue(k,c,g),e._module.eventData&&(k=c._module.eventData(k,a,c,{},g));var z={points:[k]};if(d.fullSceneLayout.hovermode){var C=[];q.loneHover({trace:c,x:(.5+.5*s[0]/s[3])*u,y:(.5-.5*s[1]/s[3])*v,xLabel:b.xLabel,yLabel:b.yLabel,zLabel:b.zLabel,text:r,name:l.name,color:q.castHoverOption(c,g,"bgcolor")||l.color,borderColor:q.castHoverOption(c,g,"bordercolor"),fontFamily:q.castHoverOption(c,g,"font.family"),fontSize:q.castHoverOption(c,g,"font.size"),fontColor:q.castHoverOption(c,g,"font.color"),nameLength:q.castHoverOption(c,g,"namelength"),textAlign:q.castHoverOption(c,g,"align"),hovertemplate:f.castOption(c,g,"hovertemplate"),hovertemplateLabels:f.extendFlat({},k,b),eventData:[k]},{container:o,gd:j,inOut_bbox:C}),k.bbox=C[0]}a.buttons&&a.distance<5?j.emit("plotly_click",z):j.emit("plotly_hover",z),this.oldEventData=z}else q.loneUnhover(o),this.oldEventData&&j.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;d.drawAnnotations(d)},a.recoverContext=function(){var a=this;a.glplot.dispose();var b=function(){if(a.glplot.gl.isContextLost()){requestAnimationFrame(b);return}if(!a.initializeGLPlot()){f.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}a.plot.apply(a,a.plotArgs)};requestAnimationFrame(b)};var y=["xaxis","yaxis","zaxis"];function z(n,g,b){for(var o=n.fullSceneLayout,a=0;a<3;a++){var c,j=y[a],h=j.charAt(0),k=o[j],d=g[h],l=g[h+"calendar"],m=g["_"+h+"length"];if(f.isArrayOrTypedArray(d))for(var e=0;e<(m||d.length);e++)if(f.isArrayOrTypedArray(d[e]))for(var i=0;i<d[e].length;++i)!isNaN(c=k.d2l(d[e][i],0,l))&&isFinite(c)&&(b[0][a]=Math.min(b[0][a],c),b[1][a]=Math.max(b[1][a],c));else!isNaN(c=k.d2l(d[e],0,l))&&isFinite(c)&&(b[0][a]=Math.min(b[0][a],c),b[1][a]=Math.max(b[1][a],c));else b[0][a]=Math.min(b[0][a],0),b[1][a]=Math.max(b[1][a],m-1)}}a.plot=function(g,o,B){var f,i,a,d,h,p,m,c=this;if(c.plotArgs=[g,o,B],!c.glplot.contextLost){var e=o[c.id],w=B[c.id];c.fullLayout=o,c.fullSceneLayout=e,c.axesOptions.merge(o,e),c.spikeOptions.merge(e),c.setViewport(e),c.updateFx(e.dragmode,e.hovermode),c.camera.enableWheel=c.graphDiv._context._scrollZoom.gl3d,c.glplot.setClearColor(r(e.bgcolor)),c.setConvert(h),g?Array.isArray(g)||(g=[g]):g=[];var n=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(a=0;a<g.length;++a)!0===(f=g[a]).visible&&0!==f._length&&z(this,f,n);!function(i,b){for(var e=i.fullSceneLayout,f=e.annotations||[],a=0;a<3;a++)for(var g=y[a],j=g.charAt(0),k=e[g],d=0;d<f.length;d++){var h=f[d];if(h.visible){var c=k.r2l(h[j]);!isNaN(c)&&isFinite(c)&&(b[0][a]=Math.min(b[0][a],c),b[1][a]=Math.max(b[1][a],c))}}}(this,n);var j=[1,1,1];for(d=0;d<3;++d)n[1][d]===n[0][d]?j[d]=1:j[d]=1/(n[1][d]-n[0][d]);for(c.dataScale=j,c.convertAnnotations(this),a=0;a<g.length;++a)!0===(f=g[a]).visible&&0!==f._length&&((i=c.traces[f.uid])?i.data.type===f.type?i.update(f):(i.dispose(),i=f._module.plot(this,f),c.traces[f.uid]=i):(i=f._module.plot(this,f),c.traces[f.uid]=i),i.name=f.name);var v=Object.keys(c.traces);traceIdLoop:for(a=0;a<v.length;++a){for(d=0;d<g.length;++d)if(g[d].uid===v[a]&& !0===g[d].visible&&0!==g[d]._length)continue traceIdLoop;(i=c.traces[v[a]]).dispose(),delete c.traces[v[a]]}c.glplot.objects.sort(function(a,b){return a._trace.data.index-b._trace.data.index});var b=[[0,0,0],[0,0,0]],L=[],q={};for(a=0;a<3;++a){if((p=(h=e[y[a]]).type)in q?(q[p].acc*=j[a],q[p].count+=1):q[p]={acc:j[a],count:1},h.autorange){b[0][a]=1/0,b[1][a]=-1/0;var C=c.glplot.objects,D=c.fullSceneLayout.annotations||[],M=h._name.charAt(0);for(d=0;d<C.length;d++){var x=C[d],E=x.bounds,F=x._trace.data._pad||0;"ErrorBars"===x.constructor.name&&h._lowerLogErrorBound?b[0][a]=Math.min(b[0][a],h._lowerLogErrorBound):b[0][a]=Math.min(b[0][a],E[0][a]/j[a]-F),b[1][a]=Math.max(b[1][a],E[1][a]/j[a]+F)}for(d=0;d<D.length;d++){var G=D[d];if(G.visible){var H=h.r2l(G[M]);b[0][a]=Math.min(b[0][a],H),b[1][a]=Math.max(b[1][a],H)}}if("rangemode"in h&&"tozero"===h.rangemode&&(b[0][a]=Math.min(b[0][a],0),b[1][a]=Math.max(b[1][a],0)),b[0][a]>b[1][a])b[0][a]=-1,b[1][a]=1;else{var I=b[1][a]-b[0][a];b[0][a]-=I/32,b[1][a]+=I/32}if("reversed"===h.autorange){var N=b[0][a];b[0][a]=b[1][a],b[1][a]=N}}else{var J=h.range;b[0][a]=h.r2l(J[0]),b[1][a]=h.r2l(J[1])}b[0][a]===b[1][a]&&(b[0][a]-=1,b[1][a]+=1),L[a]=b[1][a]-b[0][a],c.glplot.setBounds(a,{min:b[0][a]*j[a],max:b[1][a]*j[a]})}var s=e.aspectmode;if("cube"===s)m=[1,1,1];else if("manual"===s){var A=e.aspectratio;m=[A.x,A.y,A.z]}else if("auto"===s||"data"===s){var t=[1,1,1];for(a=0;a<3;++a){var K=q[p=(h=e[y[a]]).type];t[a]=Math.pow(K.acc,1/K.count)/j[a]}m="data"===s?t:Math.max.apply(null,t)/Math.min.apply(null,t)<=4?t:[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");e.aspectratio.x=w.aspectratio.x=m[0],e.aspectratio.y=w.aspectratio.y=m[1],e.aspectratio.z=w.aspectratio.z=m[2],c.glplot.setAspectratio(e.aspectratio),c.viewInitial.aspectratio||(c.viewInitial.aspectratio={x:e.aspectratio.x,y:e.aspectratio.y,z:e.aspectratio.z}),c.viewInitial.aspectmode||(c.viewInitial.aspectmode=e.aspectmode);var k=e.domain||null,l=o._size||null;if(k&&l){var u=c.container.style;u.position="absolute",u.left=l.l+k.x[0]*l.w+"px",u.top=l.t+(1-k.y[1])*l.h+"px",u.width=l.w*(k.x[1]-k.x[0])+"px",u.height=l.h*(k.y[1]-k.y[0])+"px"}c.glplot.redraw()}},a.destroy=function(){var a=this;a.glplot&&(a.camera.mouseListener.enabled=!1,a.container.removeEventListener("wheel",a.camera.wheelListener),a.camera=null,a.glplot.dispose(),a.container.parentNode.removeChild(a.container),a.glplot=null)},a.getCamera=function(){var a;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(a=this.camera).up[0],y:a.up[1],z:a.up[2]},center:{x:a.center[0],y:a.center[1],z:a.center[2]},eye:{x:a.eye[0],y:a.eye[1],z:a.eye[2]},projection:{type:!0===a._ortho?"orthographic":"perspective"}}},a.setViewport=function(b){var a,c=b.camera;this.camera.lookAt.apply(this,[[(a=c).eye.x,a.eye.y,a.eye.z],[a.center.x,a.center.y,a.center.z],[a.up.x,a.up.y,a.up.z]]),this.glplot.setAspectratio(b.aspectratio),"orthographic"===c.projection.type!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},a.isCameraChanged=function(g){var c=this.getCamera(),a=f.nestedProperty(g,this.id+".camera").get();function h(f,c,a,d){var b=["up","center","eye"],e=["x","y","z"];return c[b[a]]&&f[b[a]][e[d]]===c[b[a]][e[d]]}var b=!1;if(void 0===a)b=!0;else{for(var d=0;d<3;d++)for(var e=0;e<3;e++)if(!h(c,a,d,e)){b=!0;break}(!a.projection||c.projection&&c.projection.type!==a.projection.type)&&(b=!0)}return b},a.isAspectChanged=function(c){var b=this.glplot.getAspectratio(),a=f.nestedProperty(c,this.id+".aspectratio").get();return void 0===a||a.x!==b.x||a.y!==b.y||a.z!==b.z},a.saveLayout=function(b){var c,j,k,d,l,m,a=this,e=a.fullLayout,g=a.isCameraChanged(b),h=a.isAspectChanged(b),o=g||h;if(o){var i={};g&&(c=a.getCamera(),k=(j=f.nestedProperty(b,a.id+".camera")).get(),i[a.id+".camera"]=k),h&&(d=a.glplot.getAspectratio(),m=(l=f.nestedProperty(b,a.id+".aspectratio")).get(),i[a.id+".aspectratio"]=m),n.call("_storeDirectGUIEdit",b,e._preGUI,i),g&&(j.set(c),f.nestedProperty(e,a.id+".camera").set(c)),h&&(l.set(d),f.nestedProperty(e,a.id+".aspectratio").set(d),a.glplot.redraw())}return o},a.updateFx=function(d,o){var b=this,a=b.camera;if(a)if("orbit"===d)a.mode="orbit",a.keyBindingMode="rotate";else if("turntable"===d){a.up=[0,0,1],a.mode="turntable",a.keyBindingMode="rotate";var h=b.graphDiv,p=h._fullLayout,c=b.fullSceneLayout.camera,i=c.up.x,j=c.up.y,e=c.up.z;if(e/Math.sqrt(i*i+j*j+e*e)<.999){var k=b.id+".camera.up",g={x:0,y:0,z:1},l={};l[k]=g;var m=h.layout;n.call("_storeDirectGUIEdit",m,p._preGUI,l),c.up=g,f.nestedProperty(m,k).set(g)}}else a.keyBindingMode=d;b.fullSceneLayout.hovermode=o},a.toImage=function(g){g||(g="png"),this.staticMode&&this.container.appendChild(h),this.glplot.redraw();var e,a=this.glplot.gl,b=a.drawingBufferWidth,c=a.drawingBufferHeight;a.bindFramebuffer(a.FRAMEBUFFER,null);var f=new Uint8Array(b*c*4);a.readPixels(0,0,b,c,a.RGBA,a.UNSIGNED_BYTE,f),function(a,d,i){for(var e=0,f=i-1;e<f;++e,--f)for(var b=0;b<d;++b)for(var c=0;c<4;++c){var g=4*(d*e+b)+c,h=4*(d*f+b)+c,j=a[g];a[g]=a[h],a[h]=j}}(f,b,c),function(b,f,h){for(var c=0;c<h;++c)for(var d=0;d<f;++d){var e=4*(f*c+d),g=b[e+3];if(g>0)for(var i=255/g,a=0;a<3;++a)b[e+a]=Math.min(i*b[e+a],255)}}(f,b,c);var d=document.createElement("canvas");d.width=b,d.height=c;var i=d.getContext("2d",{willReadFrequently:!0}),j=i.createImageData(b,c);switch(j.data.set(f),i.putImageData(j,0,0),g){case"jpeg":e=d.toDataURL("image/jpeg");break;case"webp":e=d.toDataURL("image/webp");break;default:e=d.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(h),e},a.setConvert=function(){for(var a=0;a<3;a++){var b=this.fullSceneLayout[y[a]];p.setConvert(b,this.fullLayout),b.setScale=f.noop}},a.make4thDimension=function(){var a=this,b=a.graphDiv._fullLayout;a._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},p.setConvert(a._mockAxis,b)},e.exports=d},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(b,a,c){"use strict";a.exports=function(c,e,f,b){b=b||c.length;for(var d=new Array(b),a=0;a<b;a++)d[a]=[c[a],e[a],f[a]];return d}},{}],619:[function(a,h,k){"use strict";var d=a("./font_attributes"),i=a("./animation_attributes"),b=a("../components/color/attributes"),e=a("../components/shapes/draw_newshape/attributes"),f=a("../components/selections/draw_newselection/attributes"),j=a("./pad_attributes"),g=a("../lib/extend").extendFlat,c=d({editType:"calc"});c.family.dflt='"Open Sans", verdana, arial, sans-serif',c.size.dflt=12,c.color.dflt=b.defaultLine,h.exports={font:c,title:{text:{valType:"string",editType:"layoutstyle"},font:d({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:g(j({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:b.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:b.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:b.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:e.newshape,activeshape:e.activeshape,newselection:f.newselection,activeselection:f.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:g({},i.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:d({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(g,h,j){"use strict";var i=g("../../lib/sort_object_keys"),a="1.10.1",b='\xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',c=['\xa9 <a target="_blank" href="https://carto.com/">Carto</a>',b].join(" "),d='Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a> under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>',e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:b,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:c,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:c,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:d,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:d,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:'Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a> under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>',tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},f=i(e);h.exports={requiredVersion:a,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:f,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+a+"."].join("\n"),noAccessTokenErrorMsg:"Missing Mapbox access token.\nMapbox trace type require a Mapbox access token to be registered.\nFor example:\n  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });\nMore info here: https://www.mapbox.com/help/define-access-token/",missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",f.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:"Set multiple mapbox access token across different mapbox subplot,\nusing first token found as mapbox-gl does not allow multipleaccess tokens on the same page.",mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{"../../lib/sort_object_keys":538}],621:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(i,c){var e=i.split(" "),j=e[0],k=e[1],f=d.isArrayOrTypedArray(c)?d.mean(c):c,g=.5+f/100,h=1.5+f/100,a=["",""],b=[0,0];switch(j){case"top":a[0]="top",b[1]=-h;break;case"bottom":a[0]="bottom",b[1]=h;break}switch(k){case"left":a[1]="right",b[0]=-g;break;case"right":a[1]="left",b[0]=g;break}return{anchor:a[0]&&a[1]?a.join("-"):a[0]?a[0]:a[1]?a[1]:"center",offset:b}}},{"../../lib":515}],622:[function(b,e,a){"use strict";var f=b("mapbox-gl/dist/mapbox-gl-unminified"),c=b("../../lib"),g=c.strTranslate,h=c.strScale,i=b("../../plots/get_data").getSubplotCalcData,j=b("../../constants/xmlns_namespaces"),k=b("@plotly/d3"),l=b("../../components/drawing"),m=b("../../lib/svg_text_utils"),n=b("./mapbox"),d="mapbox",o=a.constants=b("./constants");function p(a){return"string"==typeof a&&(-1!==o.styleValuesMapbox.indexOf(a)||0===a.indexOf("mapbox://"))}a.name=d,a.attr="subplot",a.idRoot=d,a.idRegex=a.attrRegex=c.counterRegex(d),a.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},a.layoutAttributes=b("./layout_attributes"),a.supplyLayoutDefaults=b("./layout_defaults"),a.plot=function(b){var g=b._fullLayout,l=b.calcdata,j=g._subplots[d];if(f.version!==o.requiredVersion)throw new Error(o.wrongVersionErrorMsg);var m=function(g,h){var l=g._fullLayout,m=g._context;if(""===m.mapboxAccessToken)return"";for(var a=[],d=[],i=!1,j=!1,e=0;e<h.length;e++){var f=l[h[e]],b=f.accesstoken;p(f.style)&&(b?c.pushUnique(a,b):(p(f._input.style)&&(c.error("Uses Mapbox map style, but did not set an access token."),i=!0),j=!0)),b&&c.pushUnique(d,b)}if(j){var k=i?o.noAccessTokenErrorMsg:o.missingStyleErrorMsg;throw c.error(k),new Error(k)}return a.length?(a.length>1&&c.warn(o.multipleTokensErrorMsg),a[0]):(d.length&&c.log(["Listed mapbox access token(s)",d.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(b,j);f.accessToken=m;for(var k=0;k<j.length;k++){var h=j[k],q=i(l,d,h),e=g[h],a=e._subplot;a||(a=new n(b,h),g[h]._subplot=a),a.viewInitial||(a.viewInitial={center:c.extendFlat({},e.center),zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),a.plot(q,g,b._promises)}},a.clean=function(g,f,h,a){for(var e=a._subplots[d]||[],b=0;b<e.length;b++){var c=e[b];!f[c]&&a[c]._subplot&&a[c]._subplot.destroy()}},a.toSVG=function(t){for(var e=t._fullLayout,u=e._subplots[d],a=e._size,n=0;n<u.length;n++){var p=e[u[n]],b=p.domain,z=p._subplot.toImage("png");e._glimages.append("svg:image").attr({xmlns:j.svg,"xlink:href":z,x:a.l+a.w*b.x[0],y:a.t+a.h*(1-b.y[1]),width:a.w*(b.x[1]-b.x[0]),height:a.h*(b.y[1]-b.y[0]),preserveAspectRatio:"none"});var v=k.select(p._subplot.div);if(null!==v.select(".mapboxgl-ctrl-logo").node().offsetParent){var f=e._glimages.append("g");f.attr("transform",g(a.l+a.w*b.x[0]+10,a.t+a.h*(1-b.y[0])-31)),f.append("path").attr("d",o.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),f.append("path").attr("d",o.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),f.append("path").attr("d",o.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),f.append("polygon").attr("points",o.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var q=v.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),r=e._glimages.append("g"),i=r.append("text");i.text(q).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":q});var c=l.bBox(i.node()),s=a.w*(b.x[1]-b.x[0]);if(c.width>s/2){var w=q.split("|").join("<br>");i.text(w).attr("data-unformatted",w).call(m.convertToTspans,t),c=l.bBox(i.node())}i.attr("transform",g(-3,-c.height+8)),r.insert("rect",".static-attribution").attr({x:-c.width-6,y:-c.height-3,width:c.width+6,height:c.height+3,fill:"rgba(255, 255, 255, 0.75)"});var x=1;c.width+6>s&&(x=s/(c.width+6));var y=[a.l+a.w*b.x[1],a.t+a.h*(1-b.y[0])];r.attr("transform",g(y[0],y[1])+h(x))}},a.updateFx=function(e){for(var a=e._fullLayout,c=a._subplots[d],b=0;b<c.length;b++)a[c[b]]._subplot.updateFx(a)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(b,c,e){"use strict";var f=b("../../lib"),g=b("../../lib/svg_text_utils").sanitizeHTML,h=b("./convert_text_opts"),i=b("./constants");function d(a,b){this.subplot=a,this.uid=a.uid+"-"+b,this.index=b,this.idSource="source-"+this.uid,this.idLayer=i.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var a=d.prototype;function j(c){if(!c.visible)return!1;var a=c.source;if(Array.isArray(a)&&a.length>0){for(var b=0;b<a.length;b++)if("string"!=typeof a[b]||0===a[b].length)return!1;return!0}return f.isPlainObject(a)||"string"==typeof a&&a.length>0}function k(a){var d={},c={};switch(a.type){case"circle":f.extendFlat(c,{"circle-radius":a.circle.radius,"circle-color":a.color,"circle-opacity":a.opacity});break;case"line":f.extendFlat(c,{"line-width":a.line.width,"line-color":a.color,"line-opacity":a.opacity,"line-dasharray":a.line.dash});break;case"fill":f.extendFlat(c,{"fill-color":a.color,"fill-outline-color":a.fill.outlinecolor,"fill-opacity":a.opacity});break;case"symbol":var b=a.symbol,e=h(b.textposition,b.iconsize);f.extendFlat(d,{"icon-image":b.icon+"-15","icon-size":b.iconsize/10,"text-field":b.text,"text-size":b.textfont.size,"text-anchor":e.anchor,"text-offset":e.offset,"symbol-placement":b.placement}),f.extendFlat(c,{"icon-color":a.color,"text-color":b.textfont.color,"text-opacity":a.opacity});break;case"raster":f.extendFlat(c,{"raster-fade-duration":0,"raster-opacity":a.opacity});break}return{layout:d,paint:c}}a.update=function(a){this.visible?this.needsNewImage(a)?this.updateImage(a):this.needsNewSource(a)?(this.removeLayer(),this.updateSource(a),this.updateLayer(a)):this.needsNewLayer(a)?this.updateLayer(a):this.updateStyle(a):(this.updateSource(a),this.updateLayer(a)),this.visible=j(a)},a.needsNewImage=function(a){return this.subplot.map.getSource(this.idSource)&&"image"===this.sourceType&&"image"===a.sourcetype&&(this.source!==a.source||JSON.stringify(this.coordinates)!==JSON.stringify(a.coordinates))},a.needsNewSource=function(a){return this.sourceType!==a.sourcetype||JSON.stringify(this.source)!==JSON.stringify(a.source)||this.layerType!==a.type},a.needsNewLayer=function(a){return this.layerType!==a.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},a.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},a.updateImage=function(a){this.subplot.map.getSource(this.idSource).updateImage({url:a.source,coordinates:a.coordinates});var b=this.findFollowingMapboxLayerId(this.lookupBelow());null!==b&&this.subplot.map.moveLayer(this.idLayer,b)},a.updateSource=function(e){var f=this.subplot.map;if(f.getSource(this.idSource)&&f.removeSource(this.idSource),this.sourceType=e.sourcetype,this.source=e.source,j(e)){var c,d,a,h,b,i=(a=(c=e).sourcetype,h=c.source,b={type:a},"geojson"===a?d="data":"vector"===a?d="string"==typeof h?"url":"tiles":"raster"===a?(d="tiles",b.tileSize=256):"image"===a&&(d="url",b.coordinates=c.coordinates),b[d]=h,c.sourceattribution&&(b.attribution=g(c.sourceattribution)),b);f.addSource(this.idSource,i)}},a.findFollowingMapboxLayerId=function(a){if("traces"===a)for(var d=this.subplot.getMapLayers(),b=0;b<d.length;b++){var c=d[b].id;if("string"==typeof c&&0===c.indexOf(i.traceLayerPrefix)){a=c;break}}return a},a.updateLayer=function(a){var d=this.subplot,b=k(a),c=this.lookupBelow(),e=this.findFollowingMapboxLayerId(c);this.removeLayer(),j(a)&&d.addLayer({id:this.idLayer,source:this.idSource,"source-layer":a.sourcelayer||"",type:a.type,minzoom:a.minzoom,maxzoom:a.maxzoom,layout:b.layout,paint:b.paint},e),this.layerType=a.type,this.below=c},a.updateStyle=function(a){if(j(a)){var b=k(a);this.subplot.setOptions(this.idLayer,"setLayoutProperty",b.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",b.paint)}},a.removeLayer=function(){var a=this.subplot.map;a.getLayer(this.idLayer)&&a.removeLayer(this.idLayer)},a.dispose=function(){var a=this.subplot.map;a.getLayer(this.idLayer)&&a.removeLayer(this.idLayer),a.getSource(this.idSource)&&a.removeSource(this.idSource)},c.exports=function(b,c,e){var a=new d(b,c);return a.update(e),a}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(a,f,m){"use strict";var c=a("../../lib"),d=a("../../components/color").defaultLine,g=a("../domain").attributes,h=a("../font_attributes"),i=a("../../traces/scatter/attributes").textposition,j=a("../../plot_api/edit_types").overrideAll,k=a("../../plot_api/plot_template").templatedArray,b=a("./constants"),e=h({});e.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var l=f.exports=j({_arrayAttrRegexps:[c.counterRegex("mapbox",".layers",!0)],domain:g({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:b.styleValuesMapbox.concat(b.styleValuesNonMapbox),dflt:b.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:k("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:d},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:d}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:e,textposition:c.extendFlat({},i,{arrayOk:!1})}})},"plot","from-root");l.uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../subplot_defaults"),f=a("../array_container_defaults"),g=a("./layout_attributes");function h(c,b,a,d){a("accesstoken",d.accessToken),a("style"),a("center.lon"),a("center.lat"),a("zoom"),a("bearing"),a("pitch");var e=a("bounds.west"),g=a("bounds.east"),h=a("bounds.south"),j=a("bounds.north");(void 0===e|| void 0===g|| void 0===h|| void 0===j)&&delete b.bounds,f(c,b,{name:"layers",handleItemDefaults:i}),b._input=c}function i(i,h){function a(a,b){return d.coerce(i,h,g.layers,a,b)}if(a("visible")){var e,c=a("sourcetype"),f="raster"===c||"image"===c;a("source"),a("sourceattribution"),"vector"===c&&a("sourcelayer"),"image"===c&&a("coordinates"),f&&(e="raster");var b=a("type",e);f&&"raster"!==b&&(b=h.type="raster",d.log("Source types *raster* and *image* must drawn *raster* layer type.")),a("below"),a("color"),a("opacity"),a("minzoom"),a("maxzoom"),"circle"===b&&a("circle.radius"),"line"===b&&(a("line.width"),a("line.dash")),"fill"===b&&a("fill.outlinecolor"),"symbol"===b&&(a("symbol.icon"),a("symbol.iconsize"),a("symbol.text"),d.coerceFont(a,"symbol.textfont"),a("symbol.textposition"),a("symbol.placement"))}}b.exports=function(b,a,c){e(b,a,c,{type:"mapbox",attributes:g,handleDefaults:h,partition:"y",accessToken:a._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(b,e,f){"use strict";var g=b("mapbox-gl/dist/mapbox-gl-unminified"),h=b("../../lib"),i=b("../../lib/geo_location_utils"),j=b("../../registry"),k=b("../cartesian/axes"),l=b("../../components/dragelement"),m=b("../../components/fx"),c=b("../../components/dragelement/helpers"),n=c.drawMode,o=c.selectMode,p=b("../../components/selections").prepSelect,q=b("../../components/selections").clearOutline,r=b("../../components/selections").clearSelectionsCache,s=b("../../components/selections").selectOnClick,t=b("./constants"),u=b("./layers");function d(a,c){this.id=c,this.gd=a;var b=a._fullLayout,d=a._context;this.container=b._glcontainer.node(),this.isStatic=d.staticPlot,this.uid=b._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(b),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var a=d.prototype;a.plot=function(f,c,d){var b,a=this,e=c[a.id];a.map&&e.accesstoken!==a.accessToken&&(a.map.remove(),a.map=null,a.styleObj=null,a.traceHash={},a.layerList=[]),b=new Promise(a.map?function(b,d){a.updateMap(f,c,b,d)}:function(b,d){a.createMap(f,c,b,d)}),d.push(b)},a.createMap=function(e,f,m,h){var a=this,b=f[a.id],k=a.styleObj=w(b.style);a.accessToken=b.accesstoken;var c=b.bounds,l=c?[[c.west,c.south],[c.east,c.north]]:null,j=a.map=new g.Map({container:a.div,style:k.style,center:y(b.center),zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,maxBounds:l,interactive:!a.isStatic,preserveDrawingBuffer:a.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new g.AttributionControl({compact:!0}));j._canvas.style.left="0px",j._canvas.style.top="0px",a.rejectOnError(h),a.isStatic||a.initFx(e,f);var d=[];d.push(new Promise(function(a){j.once("load",a)})),d=d.concat(i.fetchTraceGeoData(e)),Promise.all(d).then(function(){a.fillBelowLookup(e,f),a.updateData(e),a.updateLayout(f),a.resolveOnRender(m)}).catch(h)},a.updateMap=function(e,f,j,d){var a=this,g=a.map,h=f[this.id];a.rejectOnError(d);var b=[],c=w(h.style);JSON.stringify(a.styleObj)!==JSON.stringify(c)&&(a.styleObj=c,g.setStyle(c.style),a.traceHash={},b.push(new Promise(function(a){g.once("styledata",a)}))),b=b.concat(i.fetchTraceGeoData(e)),Promise.all(b).then(function(){a.fillBelowLookup(e,f),a.updateData(e),a.updateLayout(f),a.resolveOnRender(j)}).catch(d)},a.fillBelowLookup=function(i,n){var a,b,c,d,j=n[this.id].layers,g=this.belowLookup={},k=!1;for(a=0;a<i.length;a++){var e=i[a][0].trace,l=e._module;"string"==typeof e.below?b=e.below:l.getBelow&&(b=l.getBelow(e,this)),""===b&&(k=!0),g["trace-"+e.uid]=b||""}for(a=0;a<j.length;a++){var m=j[a];b="string"==typeof m.below?m.below:k?"traces":"",g["layout-"+a]=b}var f={};for(c in g)f[b=g[c]]?f[b].push(c):f[b]=[c];for(b in f){var h=f[b];if(h.length>1)for(a=0;a<h.length;a++)0===(c=h[a]).indexOf("trace-")?(d=c.split("trace-")[1],this.traceHash[d]&&(this.traceHash[d].below=null)):0===c.indexOf("layout-")&&(d=c.split("layout-")[1],this.layerList[d]&&(this.layerList[d].below=null))}};var v={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function w(a){var b={};return h.isPlainObject(a)?(b.id=a.id,b.style=a):"string"==typeof a?(b.id=a,-1!==t.styleValuesMapbox.indexOf(a)?b.style=x(a):t.stylesNonMapbox[a]?b.style=t.stylesNonMapbox[a]:b.style=a):(b.id=t.styleValueDflt,b.style=x(t.styleValueDflt)),b.transition={duration:0,delay:0},b}function x(a){return t.styleUrlPrefix+a+"-"+t.styleUrlSuffix}function y(a){return[a.lon,a.lat]}a.updateData=function(f){var b,c,a,e,d=this.traceHash,i=f.slice().sort(function(a,b){return v[a[0].trace.type]-v[b[0].trace.type]});for(a=0;a<i.length;a++){var g=i[a];b=d[(c=g[0].trace).uid];var j=!1;b&&(b.type===c.type?(b.update(g),j=!0):b.dispose()),!j&&c._module&&(d[c.uid]=c._module.plot(this,g))}var k=Object.keys(d);idLoop:for(a=0;a<k.length;a++){var h=k[a];for(e=0;e<f.length;e++)if(h===(c=f[e][0].trace).uid)continue idLoop;(b=d[h]).dispose(),delete d[h]}},a.updateLayout=function(b){var a=this.map,c=b[this.id];this.dragging||this.wheeling||(a.setCenter(y(c.center)),a.setZoom(c.zoom),a.setBearing(c.bearing),a.setPitch(c.pitch)),this.updateLayers(b),this.updateFramework(b),this.updateFx(b),this.map.resize(),this.gd._context._scrollZoom.mapbox?a.scrollZoom.enable():a.scrollZoom.disable()},a.resolveOnRender=function(b){var a=this.map;a.on("render",function c(){a.loaded()&&(a.off("render",c),setTimeout(b,10))})},a.rejectOnError=function(c){var a=this.map;function b(){c(new Error(t.mapOnErrorMsg))}a.once("error",b),a.once("style.error",b),a.once("source.error",b),a.once("tile.error",b),a.once("layer.error",b)},a.createFramework=function(c){var a=this,b=a.div=document.createElement("div");b.id=a.uid,b.style.position="absolute",a.container.appendChild(b),a.xaxis={_id:"x",c2p:function(b){return a.project(b).x}},a.yaxis={_id:"y",c2p:function(b){return a.project(b).y}},a.updateFramework(c),a.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},k.setConvert(a.mockAxis,c)},a.initFx=function(e,f){var b=this,g=b.gd,a=b.map;function d(){m.loneUnhover(f._hoverlayer)}function c(){var a=b.getView();g.emit("plotly_relayouting",b.getViewEditsWithDerived(a))}a.on("moveend",function(e){if(b.map){var d=g._fullLayout;if(e.originalEvent||b.wheeling){var a=d[b.id];j.call("_storeDirectGUIEdit",g.layout,d._preGUI,b.getViewEdits(a));var c=b.getView();a._input.center=a.center=c.center,a._input.zoom=a.zoom=c.zoom,a._input.bearing=a.bearing=c.bearing,a._input.pitch=a.pitch=c.pitch,g.emit("plotly_relayout",b.getViewEditsWithDerived(c))}e.originalEvent&&"mouseup"===e.originalEvent.type?b.dragging=!1:b.wheeling&&(b.wheeling=!1),d._rehover&&d._rehover()}}),a.on("wheel",function(){b.wheeling=!0}),a.on("mousemove",function(c){var d=b.div.getBoundingClientRect(),e=[c.originalEvent.offsetX,c.originalEvent.offsetY];c.target.getBoundingClientRect=function(){return d},b.xaxis.p2c=function(){return a.unproject(e).lng},b.yaxis.p2c=function(){return a.unproject(e).lat},g._fullLayout._rehover=function(){g._fullLayout._hoversubplot===b.id&&g._fullLayout[b.id]&&m.hover(g,c,b.id)},m.hover(g,c,b.id),g._fullLayout._hoversubplot=b.id}),a.on("dragstart",function(){b.dragging=!0,d()}),a.on("zoomstart",d),a.on("mouseout",function(){g._fullLayout._hoversubplot=null}),a.on("drag",c),a.on("zoom",c),a.on("dblclick",function(){var c=g._fullLayout[b.id];j.call("_storeDirectGUIEdit",g.layout,g._fullLayout._preGUI,b.getViewEdits(c));var e=b.viewInitial;a.setCenter(y(e.center)),a.setZoom(e.zoom),a.setBearing(e.bearing),a.setPitch(e.pitch);var d=b.getView();c._input.center=c.center=d.center,c._input.zoom=c.zoom=d.zoom,c._input.bearing=c.bearing=d.bearing,c._input.pitch=c.pitch=d.pitch,g.emit("plotly_doubleclick",null),g.emit("plotly_relayout",b.getViewEditsWithDerived(d))}),b.clearOutline=function(){r(b.dragOptions),q(b.dragOptions.gd)},b.onClickInPanFn=function(a){return function(c){var d=g._fullLayout.clickmode;d.indexOf("select")> -1&&s(c.originalEvent,g,[b.xaxis],[b.yaxis],b.id,a),d.indexOf("event")> -1&&m.click(g,c.originalEvent)}}},a.updateFx=function(c){var d,a=this,b=a.map,f=a.gd;if(!a.isStatic){var e=c.dragmode;d=function(c,b){b.isRect?(c.range={})[a.id]=[i([b.xmin,b.ymin]),i([b.xmax,b.ymax])]:(c.lassoPoints={})[a.id]=b.map(i)};var g=a.dragOptions;a.dragOptions=h.extendDeep(g||{},{dragmode:c.dragmode,element:a.div,gd:f,plotinfo:{id:a.id,domain:c[a.id].domain,xaxis:a.xaxis,yaxis:a.yaxis,fillRangeItems:d},xaxes:[a.xaxis],yaxes:[a.yaxis],subplot:a.id}),b.off("click",a.onClickInPanHandler),o(e)||n(e)?(b.dragPan.disable(),b.on("zoomstart",a.clearOutline),a.dragOptions.prepFn=function(b,c,d){p(b,c,d,a.dragOptions,e)},l.init(a.dragOptions)):(b.dragPan.enable(),b.off("zoomstart",a.clearOutline),a.div.onmousedown=null,a.div.ontouchstart=null,a.div.removeEventListener("touchstart",a.div._ontouchstart),a.onClickInPanHandler=a.onClickInPanFn(a.dragOptions),b.on("click",a.onClickInPanHandler))}function i(c){var b=a.map.unproject(c);return[b.lng,b.lat]}},a.updateFramework=function(d){var a=d[this.id].domain,b=d._size,c=this.div.style;c.width=b.w*(a.x[1]-a.x[0])+"px",c.height=b.h*(a.y[1]-a.y[0])+"px",c.left=b.l+a.x[0]*b.w+"px",c.top=b.t+(1-a.y[1])*b.h+"px",this.xaxis._offset=b.l+a.x[0]*b.w,this.xaxis._length=b.w*(a.x[1]-a.x[0]),this.yaxis._offset=b.t+(1-a.y[1])*b.h,this.yaxis._length=b.h*(a.y[1]-a.y[0])},a.updateLayers=function(d){var a,c=d[this.id].layers,b=this.layerList;if(c.length!==b.length){for(a=0;a<b.length;a++)b[a].dispose();for(a=0,b=this.layerList=[];a<c.length;a++)b.push(u(this,a,c[a]))}else for(a=0;a<c.length;a++)b[a].update(c[a])},a.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},a.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},a.setOptions=function(c,d,a){for(var b in a)this.map[d](c,b,a[b])},a.getMapLayers=function(){return this.map.getStyle().layers},a.addLayer=function(b,a){var c=this.map;if("string"==typeof a){if(""===a){c.addLayer(b,a);return}for(var e=this.getMapLayers(),d=0;d<e.length;d++)if(a===e[d].id){c.addLayer(b,a);return}h.warn(["Trying to add layer with *below* value",a,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}c.addLayer(b)},a.project=function(a){return this.map.project(new g.LngLat(a[0],a[1]))},a.getView=function(){var a=this.map,b=a.getCenter(),f=b.lng,g=b.lat,c=a.getCanvas(),d=parseInt(c.style.width),e=parseInt(c.style.height);return{center:{lon:f,lat:g},zoom:a.getZoom(),bearing:a.getBearing(),pitch:a.getPitch(),_derived:{coordinates:[a.unproject([0,0]).toArray(),a.unproject([d,0]).toArray(),a.unproject([d,e]).toArray(),a.unproject([0,e]).toArray()]}}},a.getViewEdits=function(e){for(var f=this.id,b=["center","zoom","bearing","pitch"],c={},a=0;a<b.length;a++){var d=b[a];c[f+"."+d]=e[d]}return c},a.getViewEditsWithDerived=function(a){var c=this.id,b=this.getViewEdits(a);return b[c+"._derived"]=a._derived,b},e.exports=d},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(b,a,c){"use strict";a.exports=function(b){var a=b.editType;return{t:{valType:"number",dflt:0,editType:a},r:{valType:"number",dflt:0,editType:a},b:{valType:"number",dflt:0,editType:a},l:{valType:"number",dflt:0,editType:a},editType:a}}},{}],628:[function(b,f,h){"use strict";var i=b("@plotly/d3"),j=b("d3-time-format").timeFormatLocale,k=b("d3-format").formatLocale,l=b("fast-isnumeric"),e=b("../registry"),m=b("../plot_api/plot_schema"),n=b("../plot_api/plot_template"),d=b("../lib"),o=b("../components/color"),p=b("../constants/numerical").BADNUM,q=b("./cartesian/axis_ids"),r=b("../components/shapes/handle_outline").clearOutline,s=b("./animation_attributes"),t=b("./frame_attributes"),u=b("../plots/get_data").getModuleCalcData,v=d.relinkPrivateKeys,w=d._,a=f.exports={};d.extendFlat(a,e),a.attributes=b("./attributes"),a.attributes.type.values=a.allTypes,a.fontAttrs=b("./font_attributes"),a.layoutAttributes=b("./layout_attributes"),a.fontWeight="normal";var x=a.transformsRegistry,c=b("./command");a.executeAPICommand=c.executeAPICommand,a.computeAPICommandBindings=c.computeAPICommandBindings,a.manageCommandObserver=c.manageCommandObserver,a.hasSimpleAPICommandBindings=c.hasSimpleAPICommandBindings,a.redrawText=function(b){return b=d.getGraphDiv(b),new Promise(function(c){setTimeout(function(){b._fullLayout&&(e.getComponentMethod("annotations","draw")(b),e.getComponentMethod("legend","draw")(b),e.getComponentMethod("colorbar","draw")(b),c(a.previousPromises(b)))},300)})},a.resize=function(a){a=d.getGraphDiv(a);var b,c=new Promise(function(c,f){(!a||d.isHidden(a))&&f(new Error("Resize must be passed a displayed plot div element.")),a._redrawTimer&&clearTimeout(a._redrawTimer),a._resolveResize&&(b=a._resolveResize),a._resolveResize=c,a._redrawTimer=setTimeout(function(){if(!a.layout||a.layout.width&&a.layout.height||d.isHidden(a)){c(a);return}delete a.layout.width,delete a.layout.height;var b=a.changed;a.autoplay=!0,e.call("relayout",a,{autosize:!0}).then(function(){a.changed=b,a._resolveResize===c&&(delete a._resolveResize,c(a))})},100)});return b&&b(c),c},a.previousPromises=function(a){if((a._promises||[]).length)return Promise.all(a._promises).then(function(){a._promises=[]})},a.addLinks=function(b){if(b._context.showLink||b._context.showSources){var f=b._fullLayout,c=d.ensureSingle(f._paper,"text","js-plot-link-container",function(a){a.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:o.defaultLine,"pointer-events":"all"}).each(function(){var a=i.select(this);a.append("tspan").classed("js-link-to-tool",!0),a.append("tspan").classed("js-link-spacer",!0),a.append("tspan").classed("js-sourcelinks",!0)})}),g=c.node(),e={y:f._paper.attr("height")-9};document.body.contains(g)&&g.getComputedTextLength()>=f.width-20?(e["text-anchor"]="start",e.x=5):(e["text-anchor"]="end",e.x=f._paper.attr("width")-7),c.attr(e);var h=c.select(".js-link-to-tool"),j=c.select(".js-link-spacer"),k=c.select(".js-sourcelinks");b._context.showSources&&b._context.showSources(b),b._context.showLink&&function(b,c){c.text("");var d=c.append("a").attr({"xlink:xlink:href":"#","class":"link--impt link--embedview","font-weight":"bold"}).text(b._context.linkText+" \xbb");if(b._context.sendData)d.on("click",function(){a.sendDataToCloud(b)});else{var e=window.location.pathname.split("/"),f=window.location.search;d.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+e[2].split(".")[0]+"/"+e[1]+f})}}(b,h),j.text(h.text()&&k.text()?" - ":"")}},a.sendDataToCloud=function(b){var c=(window.PLOTLYENV||{}).BASE_URL||b._context.plotlyServerURL;if(c){b.emit("plotly_beforeexport");var d=i.select(b).append("div").attr("id","hiddenform").style("display","none"),e=d.append("form").attr({action:c+"/external",method:"post",target:"_blank"});return e.append("input").attr({type:"text",name:"data"}).node().value=a.graphJson(b,!1,"keepdata"),e.node().submit(),d.remove(),b.emit("plotly_afterexport"),!1}};var y=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],z=["year","month","dayMonth","dayMonthYear"];function A(){var b,c,a=e.collectableSubplotTypes,g={};if(!a){a=[];var h=e.subplotsRegistry;for(var i in h){var f=h[i].attr;if(f&&(a.push(i),Array.isArray(f)))for(c=0;c<f.length;c++)d.pushUnique(a,f[c])}}for(b=0;b<a.length;b++)g[a[b]]=[];return g}function B(c,l){var a=c._context.locale;a||(a="en-US");var b=!1,k={};function d(d){for(var e=!0,c=0;c<l.length;c++){var a=l[c];k[a]||(d[a]?k[a]=d[a]:e=!1)}e&&(b=!0)}for(var f=0;f<2;f++){for(var g=c._context.locales,h=0;h<2;h++){var i=(g[a]||{}).format;if(i&&(d(i),b))break;g=e.localeRegistry}var j=a.split("-")[0];if(b||j===a)break;a=j}return b||d(e.localeRegistry.en.format),k}function C(a,g){var l={_fullLayout:g},h="x"===a._id.charAt(0),i=a._mainAxis._anchorAxis,b="",d="",c="";if(i&&(c=i._mainAxis._id,b=h?a._id+c:c+a._id),!b||!g._plots[b]){b="";for(var j=a._counterAxes,e=0;e<j.length;e++){var f=j[e],k=h?a._id+f:f+a._id;d||(d=k);var m=q.getFromId(l,f);if(c&&m.overlaying===c){b=k;break}}}return b||d}function g(e){var a=e.transforms;if(Array.isArray(a)&&a.length)for(var b=0;b<a.length;b++){var c=a[b],d=c._module||x[c.type];if(d&&d.makesData)return!0}return!1}function D(b,g,h,i){for(var e=b.transforms,c=[b],a=0;a<e.length;a++){var f=e[a],d=x[f.type];d&&d.transform&&(c=d.transform(c,{transform:f,fullTrace:b,fullData:g,layout:h,fullLayout:i,transformIndex:a}))}return c}function E(a){return"string"==typeof a&&"px"===a.substr(a.length-2)&&parseFloat(a)}function F(a){var c=a.margin;if(!a._size){var b=a._size={l:Math.round(c.l),r:Math.round(c.r),t:Math.round(c.t),b:Math.round(c.b),p:Math.round(c.pad)};b.w=Math.round(a.width)-b.l-b.r,b.h=Math.round(a.height)-b.t-b.b}a._pushmargin||(a._pushmargin={}),a._pushmarginIds||(a._pushmarginIds={})}a.supplyDefaults=function(f,G){var o,s,c,l,P=G&&G.skipUpdateCalc,g=f._fullLayout||{};if(g._skipDefaults){delete g._skipDefaults;return}var b=f._fullLayout={},i=f.layout||{},m=f._fullData||[],h=f._fullData=[],t=f.data||[],H=f.calcdata||[],I=f._context||{};f._transitionData||a.createTransitionData(f),b._dfltTitle={plot:w(f,"Click to enter Plot title"),x:w(f,"Click to enter X axis title"),y:w(f,"Click to enter Y axis title"),colorbar:w(f,"Click to enter Colorscale title"),annotation:w(f,"new text")},b._traceWord=w(f,"trace");var u=B(f,y);if(b._mapboxAccessToken=I.mapboxAccessToken,g._initialAutoSizeIsDone){var Q=g.width,R=g.height;a.supplyLayoutGlobalDefaults(i,b,u),i.width||(b.width=Q),i.height||(b.height=R),a.sanitizeMargins(b)}else{a.supplyLayoutGlobalDefaults(i,b,u);var x=!i.width||!i.height,J=b.autosize,S=I.autosizable;x&&(J||S)?a.plotAutoSize(f,i,b):x&&a.sanitizeMargins(b),!J&&x&&(i.width=b.width,i.height=b.height)}b._d3locale=(o=u,s=b.separators,o.decimal=s.charAt(0),o.thousands=s.charAt(1),{numberFormat:function(a){try{a=k(o).format(d.adjustFormat(a))}catch(b){return d.warnBadFormat(a),d.noFormat}return a},timeFormat:j(o).utcFormat}),b._extraFormat=B(f,z),b._initialAutoSizeIsDone=!0,b._dataLength=t.length,b._modules=[],b._visibleModules=[],b._basePlotModules=[];var C=b._subplots=A(),K=b._splomAxes={x:{},y:{}},T=b._splomSubplots={};b._splomGridDflt={},b._scatterStackOpts={},b._firstScatter={},b._alignmentOpts={},b._colorAxes={},b._requestRangeslider={},b._traceUids=function(f,g){var a,h,i=g.length,c=[];for(a=0;a<f.length;a++){var e=f[a]._fullInput;e!==h&&c.push(e),h=e}var k=c.length,l=new Array(i),m={};function n(a,b){l[b]=a,m[a]=1}function j(a,b){if(a&&"string"==typeof a&&!m[a])return n(a,b),!0}for(a=0;a<i;a++){var b=g[a].uid;"number"==typeof b&&(b=String(b)),!j(b,a)&&(a<k&&j(c[a].uid,a)||n(d.randstr(m),a))}return l}(m,t),b._globalTransforms=(f._context||{}).globalTransforms,a.supplyDataDefaults(t,h,i,b);var p=Object.keys(K.x),q=Object.keys(K.y);if(p.length>1&&q.length>1){for(e.getComponentMethod("grid","sizeDefaults")(i,b),c=0;c<p.length;c++)d.pushUnique(C.xaxis,p[c]);for(c=0;c<q.length;c++)d.pushUnique(C.yaxis,q[c]);for(var U in T)d.pushUnique(C.cartesian,U)}if(b._has=a._hasPlotType.bind(b),m.length===h.length)for(c=0;c<h.length;c++)v(h[c],m[c]);a.supplyLayoutModuleDefaults(i,b,h,f._transitionData);var L=b._visibleModules,D=[];for(c=0;c<L.length;c++){var M=L[c].crossTraceDefaults;M&&d.pushUnique(D,M)}for(c=0;c<D.length;c++)D[c](h,b);b._hasOnlyLargeSploms=1===b._basePlotModules.length&&"splom"===b._basePlotModules[0].name&&p.length>15&&q.length>15&&0===b.shapes.length&&0===b.images.length,a.linkSubplots(h,b,m,g),a.cleanPlot(h,b,m,g);var V=!!(g._has&&g._has("gl2d")),W=!!(b._has&&b._has("gl2d")),X=!!(g._has&&g._has("cartesian")),Y=!!(b._has&&b._has("cartesian")),N=X||V,O=Y||W;N&&!O?g._bgLayer.remove():O&&!N&&(b._shouldCreateBgLayer=!0),g._zoomlayer&&!f._dragging&&r({_fullLayout:g}),function(f,a){var c,d=[];a.meta&&(c=a._meta={meta:a.meta,layout:{meta:a.meta}});for(var e=0;e<f.length;e++){var b=f[e];b.meta?d[b.index]=b._meta={meta:b.meta}:a.meta&&(b._meta={meta:a.meta}),a.meta&&(b._meta.layout={meta:a.meta})}d.length&&(c||(c=a._meta={}),c.data=d)}(h,b),v(b,g),e.getComponentMethod("colorscale","crossTraceDefaults")(h,b),b._preGUI||(b._preGUI={}),b._tracePreGUI||(b._tracePreGUI={});var E=b._tracePreGUI,n={};for(l in E)n[l]="old";for(c=0;c<h.length;c++)n[l=h[c]._fullInput.uid]||(E[l]={}),n[l]="new";for(l in n)"old"===n[l]&&delete E[l];F(b),e.getComponentMethod("rangeslider","makeData")(b),P||H.length!==h.length||a.supplyDefaultsUpdateCalc(H,h)},a.supplyDefaultsUpdateCalc=function(k,g){for(var a=0;a<g.length;a++){var h=g[a],b=(k[a]||[])[0];if(b&&b.trace){var e=b.trace;if(e._hasCalcTransform){var c,f,i,j=e._arrayAttrs;for(c=0;c<j.length;c++)f=j[c],i=d.nestedProperty(e,f).get().slice(),d.nestedProperty(h,f).set(i)}b.trace=h}}},a.createTransitionData=function(a){a._transitionData||(a._transitionData={}),a._transitionData._frames||(a._transitionData._frames=[]),a._transitionData._frameHash||(a._transitionData._frameHash={}),a._transitionData._counter||(a._transitionData._counter=0),a._transitionData._interruptCallbacks||(a._transitionData._interruptCallbacks=[])},a._hasPlotType=function(b){var a,c=this._basePlotModules||[];for(a=0;a<c.length;a++)if(c[a].name===b)return!0;var d=this._modules||[];for(a=0;a<d.length;a++){var f=d[a].name;if(f===b)return!0;var g=e.modules[f];if(g&&g.categories[b])return!0}return!1},a.cleanPlot=function(d,e,f,a){var b,c,g=a._basePlotModules||[];for(b=0;b<g.length;b++){var h=g[b];h.clean&&h.clean(d,e,f,a)}var j=a._has&&a._has("gl"),k=e._has&&e._has("gl");j&&!k&& void 0!==a._glcontainer&&(a._glcontainer.selectAll(".gl-canvas").remove(),a._glcontainer.selectAll(".no-webgl").remove(),a._glcanvas=null);var l=!!a._infolayer;oldLoop:for(b=0;b<f.length;b++){var i=f[b].uid;for(c=0;c<d.length;c++)if(i===d[c].uid)continue oldLoop;l&&a._infolayer.select(".cb"+i).remove()}},a.linkSubplots=function(p,j,z,x){var a,y=x._plots||{},s=j._plots={},t=j._subplots,h={_fullData:p,_fullLayout:j},u=t.cartesian.concat(t.gl2d||[]);for(b=0;b<u.length;b++){var b,c,f,g=u[b],v=y[g],k=q.getFromId(h,g,"x"),l=q.getFromId(h,g,"y");for(v?f=s[g]=v:(f=s[g]={}).id=g,k._counterAxes.push(l._id),l._counterAxes.push(k._id),k._subplotsWith.push(g),l._subplotsWith.push(g),f.xaxis=k,f.yaxis=l,f._hasClipOnAxisFalse=!1,c=0;c<p.length;c++){var r=p[c];if(r.xaxis===f.xaxis._id&&r.yaxis===f.yaxis._id&& !1===r.cliponaxis){f._hasClipOnAxisFalse=!0;break}}}var m=q.list(h,null,!0);for(b=0;b<m.length;b++){a=m[b];var i=null;a.overlaying&&(i=q.getFromId(h,a.overlaying))&&i.overlaying&&(a.overlaying=!1,i=null),a._mainAxis=i||a,i&&(a.domain=i.domain.slice()),a._anchorAxis="free"===a.anchor?null:q.getFromId(h,a.anchor)}for(b=0;b<m.length;b++)if((a=m[b])._counterAxes.sort(q.idSort),a._subplotsWith.sort(d.subplotSort),a._mainSubplot=C(a,j),a._counterAxes.length&&(a.spikemode&& -1!==a.spikemode.indexOf("across")||a.automargin&&a.mirror&&"free"!==a.anchor||e.getComponentMethod("rangeslider","isVisible")(a))){var n=1,o=0;for(c=0;c<a._counterAxes.length;c++){var w=q.getFromId(h,a._counterAxes[c]);n=Math.min(n,w.domain[0]),o=Math.max(o,w.domain[1])}n<o&&(a._counterDomainMin=n,a._counterDomainMax=o)}},a.clearExpandedTraceDefaultColors=function(a){var b,e,c;for(e=[],(b=a._module._colorAttrs)||(a._module._colorAttrs=b=[],m.crawl(a._module.attributes,function(a,d,f,c){e[c]=d,e.length=c+1,"color"===a.valType&& void 0===a.dflt&&b.push(e.join("."))})),c=0;c<b.length;c++)d.nestedProperty(a,"_input."+b[c]).get()||d.nestedProperty(a,b[c]).set(null)},a.supplyDataDefaults=function(o,p,q,f){var c,b,h,z=f._modules,A=f._visibleModules,B=f._basePlotModules,l=0,u=0;function r(a){p.push(a);var b=a._module;b&&(d.pushUnique(z,b),!0===a.visible&&d.pushUnique(A,b),d.pushUnique(B,a._module.basePlotModule),l++,!1!==a._input.visible&&u++)}f._transformModules=[];var s={},m=[],w=(q.template||{}).data||{},x=n.traceTemplater(w);for(c=0;c<o.length;c++){if(h=o[c],(b=x.newTrace(h)).uid=f._traceUids[c],a.supplyTraceDefaults(h,b,u,f,c),b.index=c,b._input=h,b._expandedIndex=l,b.transforms&&b.transforms.length)for(var y=!1!==h.visible&& !1===b.visible,t=D(b,p,q,f),k=0;k<t.length;k++){var i=t[k],g={_template:b._template,type:b.type,uid:b.uid+k};y&& !1===i.visible&&delete i.visible,a.supplyTraceDefaults(i,g,l,f,c),v(g,i),g.index=c,g._input=h,g._fullInput=b,g._expandedIndex=l,g._expandedInput=i,r(g)}else b._fullInput=b,b._expandedInput=b,r(b);e.traceIs(b,"carpetAxis")&&(s[b.carpet]=b),e.traceIs(b,"carpetDependent")&&m.push(c)}for(c=0;c<m.length;c++)if((b=p[m[c]]).visible){var j=s[b.carpet];if(b._carpet=j,!j||!j.visible){b.visible=!1;continue}b.xaxis=j.xaxis,b.yaxis=j.yaxis}},a.supplyAnimationDefaults=function(b){b=b||{};var c,e={};function f(a,c){return d.coerce(b||{},e,s,a,c)}if(f("mode"),f("direction"),f("fromcurrent"),Array.isArray(b.frame))for(c=0,e.frame=[];c<b.frame.length;c++)e.frame[c]=a.supplyAnimationFrameDefaults(b.frame[c]||{});else e.frame=a.supplyAnimationFrameDefaults(b.frame||{});if(Array.isArray(b.transition))for(c=0,e.transition=[];c<b.transition.length;c++)e.transition[c]=a.supplyAnimationTransitionDefaults(b.transition[c]||{});else e.transition=a.supplyAnimationTransitionDefaults(b.transition||{});return e},a.supplyAnimationFrameDefaults=function(c){var b={};function a(a,e){return d.coerce(c||{},b,s.frame,a,e)}return a("duration"),a("redraw"),b},a.supplyAnimationTransitionDefaults=function(c){var b={};function a(a,e){return d.coerce(c||{},b,s.transition,a,e)}return a("duration"),a("easing"),b},a.supplyFrameDefaults=function(c){var b={};function a(a,e){return d.coerce(c,b,t,a,e)}return a("group"),a("name"),a("traces"),a("baseframe"),a("data"),a("layout"),b},a.supplyTraceDefaults=function(h,b,u,g,v){var k,q=g.colorway||o.defaults,r=q[u%q.length];function c(c,e){return d.coerce(h,b,a.attributes,c,e)}var s=c("visible");c("type"),c("name",g._traceWord+" "+v),c("uirevision",g.uirevision);var f=a.getModule(b);if(b._module=f,f){var i=f.basePlotModule,j=i.attr,m=i.attributes;if(j&&m){var l=g._subplots,n="";if(s||"gl2d"!==i.name){if(Array.isArray(j))for(k=0;k<j.length;k++){var p=j[k],t=d.coerce(h,b,m,p);l[p]&&d.pushUnique(l[p],t),n+=t}else n=d.coerce(h,b,m,j);l[i.name]&&d.pushUnique(l[i.name],n)}}}return s&&(c("customdata"),c("ids"),c("meta"),e.traceIs(b,"showLegend")?(d.coerce(h,b,f.attributes.showlegend?f.attributes:a.attributes,"showlegend"),c("legendwidth"),c("legendgroup"),c("legendgrouptitle.text"),c("legendrank"),b._dfltShowLegend=!0):b._dfltShowLegend=!1,f&&f.supplyDefaults(h,b,r,g),e.traceIs(b,"noOpacity")||c("opacity"),e.traceIs(b,"notLegendIsolatable")&&(b.visible=!!b.visible),e.traceIs(b,"noHover")||(b.hovertemplate||d.coerceHoverinfo(h,b,g),"parcats"!==b.type&&e.getComponentMethod("fx","supplyDefaults")(h,b,r,g)),f&&f.selectPoints&&c("selectedpoints"),a.supplyTransformDefaults(h,b,g)),b},a.hasMakesDataTransform=g,a.supplyTransformDefaults=function(c,f,h){if(f._length||g(c)){var k=h._globalTransforms||[],m=h._transformModules||[];if(Array.isArray(c.transforms)||0!==k.length)for(var n=c.transforms||[],l=k.concat(n),o=f.transforms=[],i=0;i<l.length;i++){var e,b=l[i],j=b.type,a=x[j],p=!(b._module&&b._module===a),q=a&&"function"==typeof a.transform;a||d.warn("Unrecognized transform type "+j+"."),a&&a.supplyDefaults&&(p||q)?((e=a.supplyDefaults(b,f,h,c)).type=j,e._module=a,d.pushUnique(m,a)):e=d.extendFlat({},b),o.push(e)}}},a.supplyLayoutGlobalDefaults=function(c,f,h){function b(b,e){return d.coerce(c,f,a.layoutAttributes,b,e)}var g=c.template;d.isPlainObject(g)&&(f.template=g,f._template=g.layout,f._dataTemplate=g.data),b("autotypenumbers");var i=d.coerceFont(b,"font"),k=i.size;d.coerceFont(b,"title.font",d.extendFlat({},i,{size:Math.round(1.4*k)})),b("title.text",f._dfltTitle.plot),b("title.xref"),b("title.yref"),b("title.x"),b("title.y"),b("title.xanchor"),b("title.yanchor"),b("title.pad.t"),b("title.pad.r"),b("title.pad.b"),b("title.pad.l"),b("uniformtext.mode")&&b("uniformtext.minsize"),b("autosize",!(c.width&&c.height)),b("width"),b("height"),b("minreducedwidth"),b("minreducedheight"),b("margin.l"),b("margin.r"),b("margin.t"),b("margin.b"),b("margin.pad"),b("margin.autoexpand"),c.width&&c.height&&a.sanitizeMargins(f),e.getComponentMethod("grid","sizeDefaults")(c,f),b("paper_bgcolor"),b("separators",h.decimal+h.thousands),b("hidesources"),b("colorway"),b("datarevision");var j=b("uirevision");b("editrevision",j),b("selectionrevision",j),e.getComponentMethod("modebar","supplyLayoutDefaults")(c,f),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(c,f,b),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(c,f,b),b("meta"),d.isPlainObject(c.transition)&&(b("transition.duration"),b("transition.easing"),b("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(c,f,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(c,f,b)},a.plotAutoSize=function(f,i,e){var b,c,j=f._context||{},h=j.frameMargins,k=d.isPlotDiv(f);if(k&&f.emit("plotly_autosize"),j.fillFrame)b=window.innerWidth,c=window.innerHeight,document.body.style.overflow="hidden";else{var g=k?window.getComputedStyle(f):{};if(b=E(g.width)||E(g.maxWidth)||e.width,c=E(g.height)||E(g.maxHeight)||e.height,l(h)&&h>0){var m=1-2*h;b=Math.round(m*b),c=Math.round(m*c)}}var n=a.layoutAttributes.width.min,o=a.layoutAttributes.height.min;b<n&&(b=n),c<o&&(c=o);var p=!i.width&&Math.abs(e.width-b)>1,q=!i.height&&Math.abs(e.height-c)>1;(q||p)&&(p&&(e.width=b),q&&(e.height=c)),f._initialAutoSize||(f._initialAutoSize={width:b,height:c}),a.sanitizeMargins(e)},a.supplyLayoutModuleDefaults=function(f,a,g,n){var h,b,c,i=e.componentsRegistry,j=a._basePlotModules,k=e.subplotsRegistry.cartesian;for(h in i)(c=i[h]).includeBasePlot&&c.includeBasePlot(f,a);for(var o in j.length||j.push(k),a._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(f,a),k.finalizeSubplots(f,a)),a._subplots)a._subplots[o].sort(d.subplotSort);for(b=0;b<j.length;b++)(c=j[b]).supplyLayoutDefaults&&c.supplyLayoutDefaults(f,a,g);var l=a._modules;for(b=0;b<l.length;b++)(c=l[b]).supplyLayoutDefaults&&c.supplyLayoutDefaults(f,a,g);var m=a._transformModules;for(b=0;b<m.length;b++)(c=m[b]).supplyLayoutDefaults&&c.supplyLayoutDefaults(f,a,g,n);for(h in i)(c=i[h]).supplyLayoutDefaults&&c.supplyLayoutDefaults(f,a,g)},a.purge=function(a){var b=a._fullLayout||{};void 0!==b._glcontainer&&(b._glcontainer.selectAll(".gl-canvas").remove(),b._glcontainer.remove(),b._glcanvas=null),b._modeBar&&b._modeBar.destroy(),a._transitionData&&(a._transitionData._interruptCallbacks&&(a._transitionData._interruptCallbacks.length=0),a._transitionData._animationRaf&&window.cancelAnimationFrame(a._transitionData._animationRaf)),d.clearThrottle(),d.clearResponsive(a),delete a.data,delete a.layout,delete a._fullData,delete a._fullLayout,delete a.calcdata,delete a.empty,delete a.fid,delete a.undoqueue,delete a.undonum,delete a.autoplay,delete a.changed,delete a._promises,delete a._redrawTimer,delete a._hmlumcount,delete a._hmpixcount,delete a._transitionData,delete a._transitioning,delete a._initialAutoSize,delete a._transitioningWithDuration,delete a._dragging,delete a._dragged,delete a._dragdata,delete a._hoverdata,delete a._snapshotInProgress,delete a._editing,delete a._mouseDownTime,delete a._legendMouseDownTime,a.removeAllListeners&&a.removeAllListeners()},a.style=function(c){var a,e=c._fullLayout._visibleModules,b=[];for(a=0;a<e.length;a++){var f=e[a];f.style&&d.pushUnique(b,f.style)}for(a=0;a<b.length;a++)b[a](c)},a.sanitizeMargins=function(c){if(c&&c.margin){var b,d=c.width,e=c.height,a=c.margin,f=d-(a.l+a.r),g=e-(a.t+a.b);f<0&&(b=(d-1)/(a.l+a.r),a.l=Math.floor(b*a.l),a.r=Math.floor(b*a.r)),g<0&&(b=(e-1)/(a.t+a.b),a.t=Math.floor(b*a.t),a.b=Math.floor(b*a.b))}},a.clearAutoMarginIds=function(a){a._fullLayout._pushmarginIds={}},a.allowAutoMargin=function(a,b){a._fullLayout._pushmarginIds[b]=1},a.autoMargin=function(j,g,b){var e=j._fullLayout,k=e.width,l=e.height,c=e.margin,q=e.minreducedwidth,r=e.minreducedheight,s=d.constrain(k-c.l-c.r,2,q),t=d.constrain(l-c.t-c.b,2,r),m=Math.max(0,k-s),n=Math.max(0,l-t),o=e._pushmargin,p=e._pushmarginIds;if(!1!==c.autoexpand){if(b){var f=b.pad;if(void 0===f&&(f=Math.min(12,c.l,c.r,c.t,c.b)),m){var h=(b.l+b.r)/m;h>1&&(b.l/=h,b.r/=h)}if(n){var i=(b.t+b.b)/n;i>1&&(b.t/=i,b.b/=i)}var u=void 0!==b.xl?b.xl:b.x,v=void 0!==b.xr?b.xr:b.x,w=void 0!==b.yt?b.yt:b.y,x=void 0!==b.yb?b.yb:b.y;o[g]={l:{val:u,size:b.l+f},r:{val:v,size:b.r+f},b:{val:x,size:b.b+f},t:{val:w,size:b.t+f}},p[g]=1}else delete o[g],delete p[g];if(!e._replotting)return a.doAutoMargin(j)}},a.doAutoMargin=function(u){var z,P,b=u._fullLayout,n=b.width,o=b.height;b._size||(b._size={}),F(b);var c=b._size,g=b.margin,A=d.extendFlat({},c),h=g.l,i=g.r,j=g.t,k=g.b,f=b._pushmargin,B=b._pushmarginIds,Q=b.minreducedwidth,R=b.minreducedheight;if(!1!==b.margin.autoexpand){for(var C in f)B[C]||delete f[C];for(var D in f.base={l:{val:0,size:h},r:{val:1,size:i},t:{val:1,size:j},b:{val:0,size:k}},f){var E=f[D].l||{},G=f[D].b||{},p=E.val,v=E.size,r=G.val,w=G.size;for(var m in f){if(l(v)&&f[m].r){var s=f[m].r.val,H=f[m].r.size;if(s>p){var I=(v*s+(H-n)*p)/(s-p),J=(H*(1-p)+(v-n)*(1-s))/(s-p);I+J>h+i&&(h=I,i=J)}}if(l(w)&&f[m].t){var t=f[m].t.val,K=f[m].t.size;if(t>r){var L=(w*t+(K-o)*r)/(t-r),M=(K*(1-r)+(w-o)*(1-t))/(t-r);L+M>k+j&&(k=L,j=M)}}}}}var S=d.constrain(n-g.l-g.r,2,Q),T=d.constrain(o-g.t-g.b,2,R),N=Math.max(0,n-S),O=Math.max(0,o-T);if(N){var x=(h+i)/N;x>1&&(h/=x,i/=x)}if(O){var y=(k+j)/O;y>1&&(k/=y,j/=y)}if(c.l=Math.round(h),c.r=Math.round(i),c.t=Math.round(j),c.b=Math.round(k),c.p=Math.round(g.pad),c.w=Math.round(n)-c.l-c.r,c.h=Math.round(o)-c.t-c.b,!b._replotting&&a.didMarginChange(A,c)){"_redrawFromAutoMarginCount"in b?b._redrawFromAutoMarginCount++:b._redrawFromAutoMarginCount=1;var U=3*(1+Object.keys(B).length);if(b._redrawFromAutoMarginCount<U)return e.call("_doPlot",u);b._size=A,d.warn("Too many auto-margin redraws.")}z=u,P=q.list(z,"",!0),["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(c){for(var a=0;a<P.length;a++){var b=P[a][c];b&&b()}})};var G=["l","r","t","b","p","w","h"];function H(c,h,f){var i=!1,g=[a.previousPromises,function(){if(c._transitionData)return c._transitioning=!1,function(b){var a=Promise.resolve();if(!b)return a;for(;b.length;)a=a.then(b.shift());return a}(c._transitionData._interruptCallbacks)},f.prepareFn,a.rehover,a.reselect,function(){return c.emit("plotly_transitioning",[]),new Promise(function(b){c._transitioning=!0,h.duration>0&&(c._transitioningWithDuration=!0),c._transitionData._interruptCallbacks.push(function(){i=!0}),f.redraw&&c._transitionData._interruptCallbacks.push(function(){return e.call("redraw",c)}),c._transitionData._interruptCallbacks.push(function(){c.emit("plotly_transitioninterrupted",[])});var d=0,g=0;function a(){return d++,function(){var a;g++,i||g!==d||(a=b,c._transitionData&&(function(a){if(a)for(;a.length;)a.shift()}(c._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(f.redraw)return e.call("redraw",c)}).then(function(){c._transitioning=!1,c._transitioningWithDuration=!1,c.emit("plotly_transitioned",[])}).then(a)))}}f.runFn(a),setTimeout(a())})}],b=d.syncOrAsync(g,c);return b&&b.then||(b=Promise.resolve()),b.then(function(){return c})}a.didMarginChange=function(d,e){for(var a=0;a<G.length;a++){var b=G[a],c=d[b],f=e[b];if(!l(c)||Math.abs(f-c)>1)return!0}return!1},a.graphJson=function(b,g,n,k,e,l){(e&&g&&!b._fullData||e&&!g&&!b._fullLayout)&&a.supplyDefaults(b);var m=e?b._fullData:b.data,i=e?b._fullLayout:b.layout,j=(b._transitionData||{})._frames;function h(a,b){if("function"==typeof a)return b?"_function_":null;if(d.isPlainObject(a)){var e,c={};return Object.keys(a).sort().forEach(function(f){if(-1===["_","["].indexOf(f.charAt(0))){if("function"==typeof a[f]){b&&(c[f]="_function");return}if("keepdata"===n){if("src"===f.substr(f.length-3))return}else if("keepstream"===n){if("string"==typeof(e=a[f+"src"])&&e.indexOf(":")>0&&!d.isPlainObject(a.stream))return}else if("keepall"!==n&&"string"==typeof(e=a[f+"src"])&&e.indexOf(":")>0)return;c[f]=h(a[f],b)}}),c}return Array.isArray(a)?a.map(function(a){return h(a,b)}):d.isTypedArray(a)?d.simpleMap(a,d.identity):d.isJSDate(a)?d.ms2DateTimeLocal(+a):a}var c={data:(m||[]).map(function(b){var a=h(b);return g&&delete a.fit,a})};if(!g&&(c.layout=h(i),e)){var f=i._size;c.layout.computed={margin:{b:f.b,l:f.l,r:f.r,t:f.t}}}return j&&(c.frames=h(j)),l&&(c.config=h(b._context,!0)),"object"===k?c:JSON.stringify(c)},a.modifyFrames=function(g,h){var e,a,b,c=g._transitionData._frames,d=g._transitionData._frameHash;for(e=0;e<h.length;e++)switch((a=h[e]).type){case"replace":b=a.value;var i=(c[a.index]||{}).name,f=b.name;c[a.index]=d[f]=b,f!==i&&(delete d[i],d[f]=b);break;case"insert":d[(b=a.value).name]=b,c.splice(a.index,0,b);break;case"delete":delete d[(b=c[a.index]).name],c.splice(a.index,1);break}return Promise.resolve()},a.computeFrame=function(l,h){var d,f,g,e,i=l._transitionData._frameHash;if(!h)throw new Error("computeFrame must be given a string frame name");var b=i[h.toString()];if(!b)return!1;for(var j=[b],k=[b.name];b.baseframe&&(b=i[b.baseframe.toString()])&& -1===k.indexOf(b.name);)j.push(b),k.push(b.name);for(var c={};b=j.pop();)if(b.layout&&(c.layout=a.extendLayout(c.layout,b.layout)),b.data){if(c.data||(c.data=[]),!(f=b.traces))for(d=0,f=[];d<b.data.length;d++)f[d]=d;for(c.traces||(c.traces=[]),d=0;d<b.data.length;d++)void 0!==(g=f[d])&&null!==g&&(-1===(e=c.traces.indexOf(g))&&(e=c.data.length,c.traces[e]=g),c.data[e]=a.extendTrace(c.data[e],b.data[d]))}return c},a.recomputeFrameHash=function(c){for(var e=c._transitionData._frameHash={},d=c._transitionData._frames,b=0;b<d.length;b++){var a=d[b];a&&a.name&&(e[a.name]=a)}},a.extendObjectWithContainers=function(g,o,b){var k,l,c,f,h,i,e,p=d.extendDeepNoArrays({},o||{}),m=d.expandObjectPaths(p),j={};if(b&&b.length)for(c=0;c<b.length;c++)void 0===(l=(k=d.nestedProperty(m,b[c])).get())?d.nestedProperty(j,b[c]).set(null):(k.set(null),d.nestedProperty(j,b[c]).set(l));if(g=d.extendDeepNoArrays(g||{},m),b&&b.length){for(c=0;c<b.length;c++)if(i=d.nestedProperty(j,b[c]).get()){for(e=(h=d.nestedProperty(g,b[c])).get(),Array.isArray(e)||(e=[],h.set(e)),f=0;f<i.length;f++){var n=i[f];null===n?e[f]=null:e[f]=a.extendObjectWithContainers(e[f],n)}h.set(e)}}return g},a.dataArrayContainers=["transforms","dimensions"],a.layoutArrayContainers=e.layoutArrayContainers,a.extendTrace=function(b,c){return a.extendObjectWithContainers(b,c,a.dataArrayContainers)},a.extendLayout=function(b,c){return a.extendObjectWithContainers(b,c,a.layoutArrayContainers)},a.transition=function(c,g,h,i,e,f){var b={redraw:e.redraw},j={},k=[];return b.prepareFn=function(){for(var A=Array.isArray(g)?g.length:0,o=i.slice(0,A),l=0;l<o.length;l++){var x=o[l],r=c._fullData[x]._module;if(r){if(r.animatable){var s=r.basePlotModule.name;j[s]||(j[s]=[]),j[s].push(x)}c.data[o[l]]=a.extendTrace(c.data[o[l]],g[l])}}var t=d.expandObjectPaths(d.extendDeepNoArrays({},h)),B=/^[xy]axis[0-9]*$/;for(var y in t)B.test(y)&&delete t[y].range;a.extendLayout(c.layout,t),delete c.calcdata,a.supplyDefaults(c),a.doCalcdata(c);var b=d.expandObjectPaths(h);if(b){var z=c._fullLayout._plots;for(var C in z){var u=z[C],e=u.xaxis,f=u.yaxis,p=e.range.slice(),q=f.range.slice(),m=null,n=null,v=null,w=null;Array.isArray(b[e._name+".range"])?m=b[e._name+".range"].slice():Array.isArray((b[e._name]||{}).range)&&(m=b[e._name].range.slice()),Array.isArray(b[f._name+".range"])?n=b[f._name+".range"].slice():Array.isArray((b[f._name]||{}).range)&&(n=b[f._name].range.slice()),p&&m&&(e.r2l(p[0])!==e.r2l(m[0])||e.r2l(p[1])!==e.r2l(m[1]))&&(v={xr0:p,xr1:m}),q&&n&&(f.r2l(q[0])!==f.r2l(n[0])||f.r2l(q[1])!==f.r2l(n[1]))&&(w={yr0:q,yr1:n}),(v||w)&&k.push(d.extendFlat({plotinfo:u},v,w))}}return Promise.resolve()},b.runFn=function(g){var b,a,e=c._fullLayout._basePlotModules,l=k.length;if(h)for(a=0;a<e.length;a++)e[a].transitionAxes&&e[a].transitionAxes(c,k,f,g);for(var m in l?((b=d.extendFlat({},f)).duration=0,delete j.cartesian):b=f,j){var i=j[m];c._fullData[i[0]]._module.basePlotModule.plot(c,i,b,g)}},H(c,f,b)},a.transitionFromReact=function(b,f,g,h){var c=b._fullLayout,e=c.transition,a={},i=[];return a.prepareFn=function(){var q=c._plots;for(var r in a.redraw=!1,"some"===f.anim&&(a.redraw=!0),"some"===g.anim&&(a.redraw=!0),q){var j=q[r],b=j.xaxis,e=j.yaxis,k=h[b._name].range.slice(),l=h[e._name].range.slice(),m=b.range.slice(),n=e.range.slice();b.setScale(),e.setScale();var o=null,p=null;(b.r2l(k[0])!==b.r2l(m[0])||b.r2l(k[1])!==b.r2l(m[1]))&&(o={xr0:k,xr1:m}),(e.r2l(l[0])!==e.r2l(n[0])||e.r2l(l[1])!==e.r2l(n[1]))&&(p={yr0:l,yr1:n}),(o||p)&&i.push(d.extendFlat({plotinfo:j},o,p))}return Promise.resolve()},a.runFn=function(o){for(var a,c,g,m=b._fullData,n=b._fullLayout,p=n._basePlotModules,h=[],j=0;j<m.length;j++)h.push(j);function k(){if(b._fullLayout)for(var c=0;c<p.length;c++)p[c].transitionAxes&&p[c].transitionAxes(b,i,a,o)}function l(){if(b._fullLayout)for(var a=0;a<p.length;a++)p[a].plot(b,g,c,o)}i.length&&f.anim?"traces first"===e.ordering?(a=d.extendFlat({},e,{duration:0}),g=h,c=e,setTimeout(k,e.duration),l()):(a=e,g=null,c=d.extendFlat({},e,{duration:0}),setTimeout(l,a.duration),k()):i.length?(a=e,k()):f.anim&&(g=h,c=e,l())},H(b,e,a)},a.doCalcdata=function(c,l){var i,u,a,v,h=q.list(c),d=c._fullData,b=c._fullLayout,n=new Array(d.length),o=(c.calcdata||[]).slice();for(a=0,c.calcdata=n,b._numBoxes=0,b._numViolins=0,b._violinScaleGroupStats={},c._hmpixcount=0,c._hmlumcount=0,b._piecolormap={},b._sunburstcolormap={},b._treemapcolormap={},b._iciclecolormap={},b._funnelareacolormap={};a<d.length;a++)if(Array.isArray(l)&& -1===l.indexOf(a)){n[a]=o[a];continue}for(a=0;a<d.length;a++)(i=d[a])._arrayAttrs=m.findArrayAttributes(i),i._extremes={};var j=b._subplots.polar||[];for(a=0;a<j.length;a++)h.push(b[j[a]].radialaxis,b[j[a]].angularaxis);for(var r in b._colorAxes){var k=b[r];!1!==k.cauto&&(delete k.cmin,delete k.cmax)}var s=!1;function t(e){if(u=(i=d[e])._module,!0===i.visible&&i.transforms){if(u&&u.calc){var a=u.calc(c,i);a[0]&&a[0].t&&a[0].t._scene&&delete a[0].t._scene.dirty}for(v=0;v<i.transforms.length;v++){var b=i.transforms[v];(u=x[b.type])&&u.calcTransform&&(i._hasCalcTransform=!0,s=!0,u.calcTransform(c,i,b))}}}function f(e,f){if(!!(u=(i=d[e])._module).isContainer===f){var a=[];if(!0===i.visible&&0!==i._length){delete i._indexToPoints;var b=i.transforms||[];for(v=b.length-1;v>=0;v--)if(b[v].enabled){i._indexToPoints=b[v]._indexToPoints;break}u&&u.calc&&(a=u.calc(c,i))}Array.isArray(a)&&a[0]||(a=[{x:p,y:p}]),a[0].t||(a[0].t={}),a[0].trace=i,n[e]=a}}for(K(h,d,b),a=0;a<d.length;a++)f(a,!0);for(a=0;a<d.length;a++)t(a);for(s&&K(h,d,b),a=0;a<d.length;a++)f(a,!0);for(a=0;a<d.length;a++)f(a,!1);L(c);var g=J(h,c);if(g.length){for(a=0,b._numBoxes=0,b._numViolins=0;a<g.length;a++)f(g[a],!0);for(a=0;a<g.length;a++)f(g[a],!1);L(c)}e.getComponentMethod("fx","calc")(c),e.getComponentMethod("errorbars","calc")(c)};var I=/(total|sum|min|max|mean|median) (ascending|descending)/;function J(s,m){var n=[];function z(e,b,f){var c=b._id.charAt(0);if("histogram2dcontour"!==e)return function(a,b){return"y"===c?b:a};var a=b._counterAxes[0],d=q.getFromId(m,a),g="x"===c||"x"===a&&"category"===d.type,h="y"===c||"y"===a&&"category"===d.type;return function(b,a){return 0===b||0===a?-1:g&&b===f[a].length-1?-1:h&&a===f.length-1?-1:("y"===c?a:b)-1}}var A={min:function(a){return d.aggNums(Math.min,null,a)},max:function(a){return d.aggNums(Math.max,null,a)},sum:function(a){return d.aggNums(function(a,b){return a+b},null,a)},total:function(a){return d.aggNums(function(a,b){return a+b},null,a)},mean:function(a){return d.mean(a)},median:function(a){return d.median(a)}};for(J=0;J<s.length;J++){var f=s[J];if("category"===f.type){var o=f.categoryorder.match(I);if(o){var B=o[1],C=o[2],t=f._id.charAt(0),p="x"===t,i=[];for(k=0;k<f._categories.length;k++)i.push([f._categories[k],[]]);for(k=0;k<f._traceIndices.length;k++){var u=f._traceIndices[k],j=m._fullData[u];if(!0===j.visible){var v=j.type;e.traceIs(j,"histogram")&&(delete j._xautoBinFinished,delete j._yautoBinFinished);var D="splom"===v,E="scattergl"===v,w=m.calcdata[u];for(F=0;F<w.length;F++){var J,k,F,a,g,h,c,b=w[F];if(D){var r=j._axesDim[f._id];if(!p){var x=j._diag[r][0];x&&(f=m._fullLayout[q.id2name(x)])}var y=b.trace.dimensions[r].values;for(a=0;a<y.length;a++)for(g=0,h=f._categoriesMap[y[a]];g<b.trace.dimensions.length;g++)if(g!==r){var G=b.trace.dimensions[g];i[h][1].push(G.values[a])}}else if(E){for(a=0;a<b.t.x.length;a++)p?(h=b.t.x[a],c=b.t.y[a]):(h=b.t.y[a],c=b.t.x[a]),i[h][1].push(c);b.t&&b.t._scene&&delete b.t._scene.dirty}else if(b.hasOwnProperty("z")){c=b.z;var H=z(j.type,f,c);for(a=0;a<c.length;a++)for(g=0;g<c[a].length;g++)(h=H(g,a))+1&&i[h][1].push(c[a][g])}else for(void 0===(h=b.p)&&(h=b[t]),void 0===(c=b.s)&&(c=b.v),void 0===c&&(c=p?b.y:b.x),Array.isArray(c)||(c=void 0===c?[]:[c]),a=0;a<c.length;a++)i[h][1].push(c[a])}}}f._categoriesValue=i;var l=[];for(k=0;k<i.length;k++)l.push([i[k][0],A[B](i[k][1])]);l.sort(function(a,b){return a[1]-b[1]}),f._categoriesAggregatedValue=l,f._initialCategories=l.map(function(a){return a[0]}),"descending"===C&&f._initialCategories.reverse(),n=n.concat(f.sortByInitialCategories())}}}return n}function K(g,i,b){var h={};function c(a){a.clearCalc(),"multicategory"===a.type&&a.setupMultiCategory(i),h[a._id]=1}d.simpleMap(g,c);for(var e=b._axisMatchGroups||[],a=0;a<e.length;a++)for(var f in e[a])h[f]||c(b[q.id2name(f)])}function L(h){var c,a,e,f=h._fullLayout,m=f._visibleModules,b={};for(a=0;a<m.length;a++){var n=m[a],i=n.crossTraceCalc;if(i){var j=n.basePlotModule.name;b[j]?d.pushUnique(b[j],i):b[j]=[i]}}for(e in b){var g=b[e],k=f._subplots[e];if(Array.isArray(k))for(c=0;c<k.length;c++){var l=k[c],o="cartesian"===e?f._plots[l]:f[l];for(a=0;a<g.length;a++)g[a](h,o,l)}else for(a=0;a<g.length;a++)g[a](h)}}a.rehover=function(a){a._fullLayout._rehover&&a._fullLayout._rehover()},a.redrag=function(a){a._fullLayout._redrag&&a._fullLayout._redrag()},a.reselect=function(a){var b=a._fullLayout,c=(a.layout||{}).selections,d=b._previousSelections;b._previousSelections=c;var f=b._reselect||JSON.stringify(c)!==JSON.stringify(d);e.getComponentMethod("selections","reselect")(a,f)},a.generalUpdatePerTraceModule=function(l,e,g,m){var b,h=e.traceHash,a={};for(b=0;b<g.length;b++){var i=g[b],c=i[0].trace;c.visible&&(a[c.type]=a[c.type]||[],a[c.type].push(i))}for(var f in h)if(!a[f]){var j=h[f][0];j[0].trace.visible=!1,a[f]=[j]}for(var n in a){var k=a[n];k[0][0].trace._module.plot(l,e,d.filterVisible(k),m)}e.traceHash=a},a.plotBasePlot=function(c,a,h,d,f){var b=e.getModule(c),g=u(a.calcdata,b)[0];b.plot(a,g,d,f)},a.cleanBasePlot=function(a,f,c,g,b){var d=b._has&&b._has(a),e=c._has&&c._has(a);d&&!e&&b["_"+a+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(b,a,c){"use strict";a.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(b,c,f){"use strict";var a=b("../../lib"),g=b("../../lib/polygon").tester,h=a.findIndexOfMin,i=a.isAngleInsideSector,j=a.angleDelta,k=a.angleDist;function d(i,j,o,k){var a,b,g=k[0],d=k[1],h=e(Math.sin(j)-Math.sin(i)),c=e(Math.cos(j)-Math.cos(i)),f=Math.tan(o),l=e(1/f),m=h/c,n=d-m*g;return l?h&&c?(a=n/(f-m),b=f*a):c?(a=d*l,b=d):(a=g,b=g*f):h&&c?(a=0,b=n):c?(a=0,b=d):a=b=NaN,[a,b]}function l(b,c,e,f){return a.isFullCircle([c,e])?function(c,d){var a,e=d.length,b=new Array(e+1);for(a=0;a<e;a++){var f=d[a];b[a]=[c*Math.cos(f),c*Math.sin(f)]}return b[a]=b[0].slice(),b}(b,f):function(v,o,p,b){var e,f,q=b.length,c=[];function r(a){return[v*Math.cos(a),v*Math.sin(a)]}function l(a,b,c){return d(a,b,c,r(a))}function g(b){return a.mod(b,q)}function s(a){return i(a,[o,p])}var j=h(b,function(a){return s(a)?k(a,o):1/0}),t=l(b[j],b[g(j-1)],o);for(c.push(t),e=j,f=0;f<q;e++,f++){var m=b[g(e)];if(!s(m))break;c.push(r(m))}var n=h(b,function(a){return s(a)?k(a,p):1/0}),u=l(b[n],b[g(n+1)],p);return c.push(u),c.push([0,0]),c.push(c[0].slice()),c}(b,c,e,f)}function e(a){return Math.abs(a)>1e-10?a:0}function m(d,b,c){b=b||0,c=c||0;for(var e=d.length,f=new Array(e),a=0;a<e;a++){var g=d[a];f[a]=[b+g[0],c-g[1]]}return f}c.exports={isPtInsidePolygon:function(d,c,a,b,e){if(!i(c,b))return!1;a[0]<a[1]?(h=a[0],j=a[1]):(h=a[1],j=a[0]);var h,j,k=g(l(h,b[0],b[1],e)),m=g(l(j,b[0],b[1],e)),f=[d*Math.cos(c),d*Math.sin(c)];return m.contains(f)&&!k.contains(f)},findPolygonOffset:function(f,g,h,i){for(var a=1/0,b=1/0,d=l(f,g,h,i),c=0;c<d.length;c++){var e=d[c];a=Math.min(a,e[0]),b=Math.min(b,-e[1])}return[a,b]},findEnclosingVertexAngles:function(e,b){var c=h(b,function(b){var a=j(b,e);return a>0?a:1/0}),d=a.mod(c+1,b.length);return[b[c],b[d]]},findIntersectionXY:d,findXYatLength:function(f,a,c,g){var b=-a*c,e=a*a+1,d=2*(a*b-c),h=Math.sqrt(d*d-4*e*(b*b+c*c-f*f)),i=(-d+h)/(2*e),j=(-d-h)/(2*e);return[[i,a*i+b+g],[j,a*j+b+g]]},clampTiny:e,pathPolygon:function(a,b,c,d,e,f){return"M"+m(l(a,b,c,d),e,f).join("L")},pathPolygonAnnulus:function(a,b,c,d,e,f,g){a<b?(h=a,i=b):(h=b,i=a);var h,i,j=m(l(h,c,d,e),f,g),k=m(l(i,c,d,e),f,g);return"M"+k.reverse().join("L")+"M"+j.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(a,g,i){"use strict";var j=a("../get_data").getSubplotCalcData,h=a("../../lib").counterRegex,k=a("./polar"),c=a("./constants"),d=c.attr,b=c.name,e=h(b),f={};f[d]={valType:"subplotid",dflt:b,editType:"calc"},g.exports={attr:d,name:b,idRoot:b,idRegex:e,attrRegex:e,attributes:f,layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),plot:function(a){for(var c=a._fullLayout,h=a.calcdata,g=c._subplots[b],f=0;f<g.length;f++){var d=g[f],i=j(h,b,d),e=c[d]._subplot;e||(e=k(a,d),c[d]._subplot=e),e.plot(i,c,a._promises)}},clean:function(l,d,m,c){for(var f=c._subplots[b]||[],h=c._has&&c._has("gl"),i=d._has&&d._has("gl"),j=h&&!i,e=0;e<f.length;e++){var g=f[e],a=c[g]._subplot;if(!d[g]&&a)for(var k in a.framework.remove(),a.layers["radial-axis-title"].remove(),a.clipPaths)a.clipPaths[k].remove();j&&a._scene&&(a._scene.destroy(),a._scene=null)}},toSVG:a("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(c,i,l){"use strict";var j=c("../../components/color/attributes"),a=c("../cartesian/layout_attributes"),k=c("../domain").attributes,b=c("../../lib").extendFlat,d=c("../../plot_api/edit_types").overrideAll,e=d({color:a.color,showline:b({},a.showline,{dflt:!0}),linecolor:a.linecolor,linewidth:a.linewidth,showgrid:b({},a.showgrid,{dflt:!0}),gridcolor:a.gridcolor,gridwidth:a.gridwidth,griddash:a.griddash},"plot","from-root"),f=d({tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,ticklabelstep:a.ticklabelstep,showticklabels:a.showticklabels,showtickprefix:a.showtickprefix,tickprefix:a.tickprefix,showticksuffix:a.showticksuffix,ticksuffix:a.ticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,minexponent:a.minexponent,separatethousands:a.separatethousands,tickfont:a.tickfont,tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,layer:a.layer},"plot","from-root"),g={visible:b({},a.visible,{dflt:!0}),type:b({},a.type,{values:["-","linear","log","date","category"]}),autotypenumbers:a.autotypenumbers,autorange:b({},a.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:b({},a.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:a.categoryorder,categoryarray:a.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:b({},a.title.text,{editType:"plot",dflt:""}),font:b({},a.title.font,{editType:"plot"}),editType:"plot"},hoverformat:a.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:a._deprecated.title,titlefont:a._deprecated.titlefont}};b(g,e,f);var h={visible:b({},a.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:a.autotypenumbers,categoryorder:a.categoryorder,categoryarray:a.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:a.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};b(h,e,f),i.exports={domain:k({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:j.background},radialaxis:g,angularaxis:h,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../../components/color"),g=a("../../plot_api/plot_template"),h=a("../subplot_defaults"),i=a("../get_data").getSubplotData,j=a("../cartesian/tick_value_defaults"),k=a("../cartesian/tick_mark_defaults"),l=a("../cartesian/tick_label_defaults"),m=a("../cartesian/prefix_suffix_defaults"),n=a("../cartesian/category_order_defaults"),o=a("../cartesian/line_grid_defaults"),p=a("../cartesian/axis_autotype"),q=a("./layout_attributes"),r=a("./set_convert"),c=a("./constants"),s=c.axisNames;function t(x,v,w,h){var I=w("bgcolor");h.bgColor=f.combine(I,h.paper_bgcolor);var J=w("sector");w("hole");var t=i(h.fullData,c.name,h.id),K=h.layoutOut;function a(a,b){return w(H+"."+a,b)}for(var y=0;y<s.length;y++){H=s[y],e.isPlainObject(x[H])||(x[H]={});var d=x[H],b=g.newContainer(v,H);b._id=b._name=H,b._attr=h.id+"."+H,b._traceIndices=t.map(function(a){return a._expandedIndex});var G=c.axisName2dataArray[H],p=u(d,b,a,t,G,h);n(d,b,a,{axData:t,dataAttr:G});var L=a("visible");switch(r(b,v,K),a("uirevision",v.uirevision),b._m=1,H){case"radialaxis":var z=a("autorange",!b.isValidRange(d.range));d.autorange=z,z&&("linear"===p||"-"===p)&&a("rangemode"),"reversed"===z&&(b._m=-1),a("range"),b.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if("date"===p){e.log("Polar plots do not support date angular axes yet.");for(var A=0;A<t.length;A++)t[A].visible=!1;p=d.type=b.type="linear"}a("linear"===p?"thetaunit":"period");var M=a("direction");a("rotation",{counterclockwise:0,clockwise:90}[M]);break}if(m(d,b,a,b.type,{tickSuffixDflt:"degrees"===b.thetaunit?"\xb0":void 0}),L){var H,B,C,D,E,F=h.font||{};C=(B=a("color"))===d.color?B:F.color,D=F.size,E=F.family,j(d,b,a,b.type),l(d,b,a,b.type,{font:{color:C,size:D,family:E}}),k(d,b,a,{outerTicks:!0}),o(d,b,a,{dfltColor:B,bgColor:h.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:q[H]}),a("layer"),"radialaxis"===H&&(a("side"),a("angle",J[0]),a("title.text"),e.coerceFont(a,"title.font",{color:C,size:e.bigFont(D),family:E}))}"category"!==p&&a("hoverformat"),b._input=d}"category"===v.angularaxis.type&&w("gridshape")}function u(g,a,e,d,f,h){var b,i=e("autotypenumbers",h.autotypenumbersDflt),j=e("type");if("-"===j){for(var c=0;c<d.length;c++)if(d[c].visible){b=d[c];break}b&&b[f]&&(a.type=p(b[f],"gregorian",{noMultiCategory:!0,autotypenumbers:i})),"-"===a.type?a.type="linear":g.type=a.type}return a.type}b.exports=function(d,a,b){h(d,a,b,{type:c.name,attributes:q,handleDefaults:t,font:a.font,autotypenumbersDflt:a.autotypenumbers,paper_bgcolor:a.paper_bgcolor,fullData:b,layoutOut:a})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(a,e,g){"use strict";var h=a("@plotly/d3"),i=a("tinycolor2"),j=a("../../registry"),c=a("../../lib"),k=c.strRotate,l=c.strTranslate,m=a("../../components/color"),n=a("../../components/drawing"),o=a("../plots"),p=a("../../plots/cartesian/axes"),q=a("../cartesian/set_convert"),r=a("./set_convert"),s=a("../cartesian/autorange").doAutoRange,t=a("../cartesian/dragbox"),u=a("../../components/dragelement"),v=a("../../components/fx"),w=a("../../components/titles"),x=a("../../components/selections").prepSelect,y=a("../../components/selections").selectOnClick,z=a("../../components/selections").clearOutline,A=a("../../lib/setcursor"),B=a("../../lib/clear_gl_canvases"),C=a("../../plot_api/subroutines").redrawReglTraces,D=a("../../constants/alignment").MID_SHIFT,E=a("./constants"),F=a("./helpers"),d=a("../smith/helpers"),G=d.smith,H=d.reactanceArc,I=d.resistanceArc,J=d.smithTransform,K=c._,L=c.mod,M=c.deg2rad,N=c.rad2deg;function f(d,a,b){this.isSmith=b||!1,this.id=a,this.gd=d,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var c=d._fullLayout,e="clip"+c._uid+a;this.clipIds.forTraces=e+"-for-traces",this.clipPaths.forTraces=c._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=c["_"+(b?"smith":"polar")+"layer"].append("g").attr("class",a),this.getHole=function(a){return this.isSmith?0:a.hole},this.getSector=function(a){return this.isSmith?[0,360]:a.sector},this.getRadial=function(a){return this.isSmith?a.realaxis:a.radialaxis},this.getAngular=function(a){return this.isSmith?a.imaginaryaxis:a.angularaxis},b||(this.radialTickLayout=null,this.angularTickLayout=null)}var b=f.prototype;function O(a){var b=a.ticks+String(a.ticklen)+String(a.showticklabels);return"side"in a&&(b+=a.side),b}function P(d,a){var b=c.findIndexOfMin(a,function(a){return c.angleDist(d,a)});return a[b]}function Q(a,b,c){return b?(a.attr("display",null),a.attr(c)):a&&a.attr("display","none"),a}e.exports=function(a,b,c){return new f(a,b,c)},b.plot=function(d,c){for(var a=this,b=c[a.id],f=!1,e=0;e<d.length;e++)if(!1===d[e][0].trace.cliponaxis){f=!0;break}a._hasClipOnAxisFalse=f,a.updateLayers(c,b),a.updateLayout(c,b),o.generalUpdatePerTraceModule(a.gd,a,d,b),a.updateFx(c,b),a.isSmith&&(delete b.realaxis.range,delete b.imaginaryaxis.range)},b.updateLayers=function(m,d){var g=this.isSmith,n=this.layers,i=this.getRadial(d),j=this.getAngular(d),e=E.layerNames,k=e.indexOf("frontplot"),a=e.slice(0,k),b="below traces"===j.layer,c="below traces"===i.layer;b&&a.push("angular-line"),c&&a.push("radial-line"),b&&a.push("angular-axis"),c&&a.push("radial-axis"),a.push("frontplot"),b||a.push("angular-line"),c||a.push("radial-line"),b||a.push("angular-axis"),c||a.push("radial-axis");var l=(g?"smith":"polar")+"sublayer",f=this.framework.selectAll("."+l).data(a,String);f.enter().append("g").attr("class",function(a){return l+" "+a}).each(function(b){var a=n[b]=h.select(this);switch(b){case"frontplot":g||a.append("g").classed("barlayer",!0),a.append("g").classed("scatterlayer",!0);break;case"backplot":a.append("g").classed("maplayer",!0);break;case"plotbg":n.bg=a.append("path");break;case"radial-grid":a.style("fill","none");break;case"angular-grid":a.style("fill","none");break;case"radial-line":a.append("line").style("fill","none");break;case"angular-line":a.append("path").style("fill","none");break}}),f.order()},b.updateLayout=function(f,b){var o,v,p,q,j,z,a=this,E=a.layers,c=f._size,F=a.getRadial(b),T=a.getAngular(b),g=b.domain.x,h=b.domain.y;a.xOffset=c.l+c.w*g[0],a.yOffset=c.t+c.h*(1-h[1]);var G,H,I,J,K,A,N,d,e,r,s,t,u,w=a.xLength=c.w*(g[1]-g[0]),x=a.yLength=c.h*(h[1]-h[0]),O=a.getSector(b);a.sectorInRad=O.map(M);var k=a.sectorBBox=(A=(G=O)[0],N=G[1],d=L(A,360),e=d+(N-A),r=Math.cos(M(d)),s=Math.sin(M(d)),t=Math.cos(M(e)),u=Math.sin(M(e)),K=d<=90&&e>=90||d>90&&e>=450?1:s<=0&&u<=0?0:Math.max(s,u),H=d<=180&&e>=180||d>180&&e>=540?-1:r>=0&&t>=0?0:Math.min(r,t),I=d<=270&&e>=270||d>270&&e>=630?-1:s>=0&&u>=0?0:Math.min(s,u),J=e>=360?1:r<=0&&t<=0?0:Math.max(r,t),[H,I,J,K]),P=k[2]-k[0],U=k[3]-k[1],B=Math.abs(U/P);x/w>B?(o=w,v=w*B,j=(x-v)/c.h/2,p=[g[0],g[1]],q=[h[0]+j,h[1]-j]):(o=x/B,v=x,j=(w-o)/c.w/2,p=[g[0]+j,g[1]-j],q=[h[0],h[1]]),a.xLength2=o,a.yLength2=v,a.xDomain2=p,a.yDomain2=q;var C=a.xOffset2=c.l+c.w*p[0],D=a.yOffset2=c.t+c.h*(1-q[1]),y=a.radius=o/P,V=a.innerRadius=a.getHole(b)*y,Q=a.cx=C-y*k[0],R=a.cy=D+y*k[3],W=a.cxx=Q-C,X=a.cyy=R-D,i=F.side;"counterclockwise"===i?(z=i,i="top"):"clockwise"===i&&(z=i,i="bottom"),a.radialAxis=a.mockAxis(f,b,F,{_id:"x",side:i,_trueSide:z,domain:[V/c.w,y/c.w]}),a.angularAxis=a.mockAxis(f,b,T,{side:"right",domain:[0,Math.PI],autorange:!1}),a.doAutoRange(f,b),a.updateAngularAxis(f,b),a.updateRadialAxis(f,b),a.updateRadialAxisTitle(f,b),a.xaxis=a.mockCartesianAxis(f,b,{_id:"x",domain:p}),a.yaxis=a.mockCartesianAxis(f,b,{_id:"y",domain:q});var S=a.pathSubplot();a.clipPaths.forTraces.select("path").attr("d",S).attr("transform",l(W,X)),E.frontplot.attr("transform",l(C,D)).call(n.setClipUrl,a._hasClipOnAxisFalse?null:a.clipIds.forTraces,a.gd),E.bg.attr("d",S).attr("transform",l(Q,R)).call(m.fill,b.bgcolor)},b.mockAxis=function(b,d,e,f){var a=c.extendFlat({},e,f);return r(a,d,b),a},b.mockCartesianAxis=function(d,h,b){var e=this,f=e.isSmith,g=b._id,a=c.extendFlat({type:"linear"},b);q(a,d);var i={x:[0,2],y:[1,3]};return a.setRange=function(){var b=e.sectorBBox,c=i[g],d=e.radialAxis._rl,f=(d[1]-d[0])/(1-e.getHole(h));a.range=[b[c[0]]*f,b[c[1]]*f]},a.isPtWithinRange="x"!==g||f?function(){return!0}:function(a){return e.isPtInside(a)},a.setRange(),a.setScale(),a},b.doAutoRange=function(f,d){var e=this.gd,a=this.radialAxis,c=this.getRadial(d);s(e,a);var b=a.range;c.range=b.slice(),c._input.range=b.slice(),a._rl=[a.r2l(b[0],null,"gregorian"),a.r2l(b[1],null,"gregorian")]},b.updateRadialAxis=function(B,q){var b=this,i=b.gd,f=b.layers,j=b.radius,r=b.innerRadius,x=b.cx,y=b.cy,d=b.getRadial(q),s=L(b.getSector(q)[0],360),a=b.radialAxis,g=r<j,e=b.isSmith;e||(b.fillViewInitialKey("radialaxis.angle",d.angle),b.fillViewInitialKey("radialaxis.range",a.range.slice()),a.setGeometry()),"auto"===a.tickangle&&s>90&&s<=270&&(a.tickangle=180);var t=e?function(c){var a=J(b,G([c.x,0]));return l(a[0]-x,a[1]-y)}:function(b){return l(a.l2p(b.x)+r,0)},u=O(d);if(b.radialTickLayout!==u&&(f["radial-axis"].selectAll(".xtick").remove(),b.radialTickLayout=u),g){a.setScale();var n=0,h=e?(a.tickvals||[]).filter(function(a){return a>=0}).map(function(b){return p.tickText(a,b,!0,!1)}):p.calcTicks(a),z=e?h:p.clipEnds(a,h),o=p.getTickSigns(a)[2];e&&(("top"===a.ticks&&"bottom"===a.side||"bottom"===a.ticks&&"top"===a.side)&&(o=-o),"top"===a.ticks&&"top"===a.side&&(n=-a.ticklen),"bottom"===a.ticks&&"bottom"===a.side&&(n=a.ticklen)),p.drawTicks(i,a,{vals:h,layer:f["radial-axis"],path:p.makeTickPath(a,0,o),transFn:t,crisp:!1}),p.drawGrid(i,a,{vals:z,layer:f["radial-grid"],path:e?function(a){return I(b,a.x,-1/0,1/0)}:function(c){return b.pathArc(a.r2p(c.x)+r)},transFn:c.noop,crisp:!1}),p.drawLabels(i,a,{vals:h,layer:f["radial-axis"],transFn:t,labelFns:p.makeLabelFns(a,n)})}var A=b.radialAxisAngle=b.vangles?N(P(M(d.angle),b.vangles)):d.angle,v=l(x,y),w=v+k(-A);Q(f["radial-axis"],g&&(d.showticklabels||d.ticks),{transform:w}),Q(f["radial-grid"],g&&d.showgrid,{transform:e?"":v}),Q(f["radial-line"].select("line"),g&&d.showline,{x1:e?-j:r,y1:0,x2:j,y2:0,transform:w}).attr("stroke-width",d.linewidth).call(m.stroke,d.linecolor)},b.updateRadialAxisTitle=function(u,o,e){if(!this.isSmith){var a=this,f=a.gd,g=a.radius,p=a.cx,q=a.cy,b=a.getRadial(o),r=a.id+"title",c=0;if(b.title){var h=n.bBox(a.layers["radial-axis"].node()).height,d=b.title.font.size,i=b.side;c="top"===i?d:"counterclockwise"===i?-(h+.4*d):h+.8*d}var j=void 0!==e?e:a.radialAxisAngle,k=M(j),l=Math.cos(k),m=Math.sin(k),s=p+g/2*l+c*m,t=q-g/2*m+c*l;a.layers["radial-axis-title"]=w.draw(f,r,{propContainer:b,propName:a.id+".radialaxis.title",placeholder:K(f,"Click to enter radial axis title"),attributes:{x:s,y:t,"text-anchor":"middle"},transform:{rotate:-j}})}},b.updateAngularAxis=function(v,n){var e,b=this,j=b.gd,g=b.layers,w=b.radius,x=b.innerRadius,r=b.cx,s=b.cy,h=b.getAngular(n),a=b.angularAxis,f=b.isSmith;f||(b.fillViewInitialKey("angularaxis.rotation",h.rotation),a.setGeometry(),a.setScale());var t=f?function(c){var a=J(b,G([0,c.x]));return Math.atan2(a[0]-r,a[1]-s)-Math.PI/2}:function(b){return a.t2g(b.x)};"linear"===a.type&&"radians"===a.thetaunit&&(a.tick0=N(a.tick0),a.dtick=N(a.dtick));var y=function(a){return l(r+w*Math.cos(a),s-w*Math.sin(a))},z=p.makeLabelFns(a,0).labelStandoff,i={};i.xFn=function(a){return Math.cos(t(a))*z},i.yFn=function(a){var b=t(a);return-Math.sin(b)*(z+a.fontSize*(Math.sin(b)>0?.2:1))+Math.abs(Math.cos(b))*(a.fontSize*D)},i.anchorFn=function(b){var a=Math.cos(t(b));return .1>Math.abs(a)?"middle":a>0?"start":"end"},i.heightFn=function(a,c,b){return -0.5*(1+Math.sin(t(a)))*b};var o=O(h);b.angularTickLayout!==o&&(g["angular-axis"].selectAll("."+a._id+"tick").remove(),b.angularTickLayout=o);var d=f?[1/0].concat(a.tickvals||[]).map(function(b){return p.tickText(a,b,!0,!1)}):p.calcTicks(a);if(f&&(d[0].text="\u221E",d[0].fontSize*=1.75),"linear"===n.gridshape?(e=d.map(t),0>c.angleDelta(e[0],e[1])&&(e=e.slice().reverse())):e=null,b.vangles=e,"category"===a.type&&(d=d.filter(function(a){return c.isAngleInsideSector(t(a),b.sectorInRad)})),a.visible){var q="inside"===a.ticks?-1:1,u=(a.linewidth||1)/2;p.drawTicks(j,a,{vals:d,layer:g["angular-axis"],path:"M"+q*u+",0h"+q*a.ticklen,transFn:f?function(c){var a=J(b,G([0,c.x])),d=Math.atan2(a[0]-r,a[1]-s)-Math.PI/2;return l(a[0],a[1])+k(-N(d))}:function(b){var a=t(b);return y(a)+k(-N(a))},crisp:!1}),p.drawGrid(j,a,{vals:d,layer:g["angular-grid"],path:f?function(a){return H(b,a.x,0,1/0)}:function(d){var a=t(d),b=Math.cos(a),c=Math.sin(a);return"M"+[r+x*b,s-x*c]+"L"+[r+w*b,s-w*c]},transFn:c.noop,crisp:!1}),p.drawLabels(j,a,{vals:d,layer:g["angular-axis"],repositionOnUpdate:!0,transFn:f?function(c){var a=J(b,G([0,c.x]));return l(a[0],a[1])}:function(a){return y(t(a))},labelFns:i})}Q(g["angular-line"].select("path"),h.showline,{d:b.pathSubplot(),transform:l(r,s)}).attr("stroke-width",h.linewidth).call(m.stroke,h.linecolor)},b.updateFx=function(a,b){this.gd._context.staticPlot||(this.isSmith||(this.updateAngularDrag(a),this.updateRadialDrag(a,b,0),this.updateRadialDrag(a,b,1)),this.updateHoverAndMainDrag(a))},b.updateHoverAndMainDrag=function(d){var n,o,p,q,r,s,w,A,B,C,D,a=this,G=a.isSmith,f=a.gd,g=a.layers,H=d._zoomlayer,I=E.MINZOOM,J=E.OFFEDGE,K=a.radius,L=a.innerRadius,k=a.cx,m=a.cy,M=a.cxx,N=a.cyy,O=a.sectorInRad,P=a.vangles,Q=a.radialAxis,R=F.clampTiny,S=F.findXYatLength,T=F.findEnclosingVertexAngles,U=E.cornerHalfWidth,V=E.cornerLen/2,b=t.makeDragger(g,"path","maindrag",!1===d.dragmode?"none":"crosshair");h.select(b).attr("d",a.pathSubplot()).attr("transform",l(k,m)),b.onmousemove=function(c){v.hover(f,c,a.id),f._fullLayout._lasthover=b,f._fullLayout._hoversubplot=a.id},b.onmouseout=function(a){f._dragging||u.unhover(f,a)};var e={element:b,gd:f,subplot:a.id,plotinfo:{id:a.id,xaxis:a.xaxis,yaxis:a.yaxis},xaxes:[a.xaxis],yaxes:[a.yaxis]};function W(a,b){return Math.sqrt(a*a+b*b)}function X(a,b){return W(a-M,b-N)}function Y(a,b){return Math.atan2(N-b,a-M)}function Z(a,b){return[a*Math.cos(b),a*Math.sin(-b)]}function $(d,e){if(0===d)return a.pathSector(2*U);var f=V/d,g=e-f,h=e+f,i=Math.max(0,Math.min(d,K)),b=i-U,c=i+U;return"M"+Z(b,g)+"A"+[b,b]+" 0,0,0 "+Z(b,h)+"L"+Z(c,h)+"A"+[c,c]+" 0,0,1 "+Z(c,g)+"Z"}function _(g,n,o){if(0===g)return a.pathSector(2*U);var h,i,d,e,j=Z(g,n),k=Z(g,o),c=R((j[0]+k[0])/2),b=R((j[1]+k[1])/2);if(c&&b){var l=b/c,m=-1/l,f=S(U,l,c,b);h=S(V,m,f[0][0],f[0][1]),i=S(V,m,f[1][0],f[1][1])}else b?(d=V,e=U):(d=U,e=V),h=[[c-d,b-e],[c+d,b-e]],i=[[c-d,b+e],[c+d,b+e]];return"M"+h.join("L")+"L"+i.reverse().join("L")+"Z"}function aa(b,a){return(a=Math.max(Math.min(a,K),L),b<J?b=0:K-b<J?b=K:a<J?a=0:K-a<J&&(a=K),Math.abs(a-b)>I)?(b<a?(r=b,s=a):(r=a,s=b),!0):(r=null,s=null,!1)}function ab(a,b){a=a||w,b=b||"M0,0Z",C.attr("d",a),D.attr("d",b),t.transitionZoombox(C,D,A,B),A=!0;var c={};ag(c),f.emit("plotly_relayouting",c)}function ac(c,d){c*=n,d*=o;var b,e,g=X(p,q),h=Math.min(X(p+c,q+d),K),f=Y(p,q);aa(g,h)&&(b=w+a.pathSector(s),r&&(b+=a.pathSector(r)),e=$(r,f)+$(s,f)),ab(b,e)}function ad(c,d,a,e){var b=F.findIntersectionXY(a,e,a,[c-M,N-d]);return W(b[0],b[1])}function ae(h,i){var c,d,e=p+h,f=q+i,j=Y(p,q),k=Y(e,f),b=T(j,P),g=T(k,P),l=ad(p,q,b[0],b[1]),m=Math.min(ad(e,f,g[0],g[1]),K);aa(l,m)&&(c=w+a.pathSector(s),r&&(c+=a.pathSector(r)),d=[_(r,b[0],b[1]),_(s,b[0],b[1])].join(" ")),ab(c,d)}function af(){if(t.removeZoombox(f),null!==r&&null!==s){var a={};ag(a),t.showDoubleClickNotifier(f),j.call("_guiRelayout",f,a)}}function ag(d){var b=Q._rl,c=(b[1]-b[0])/(1-L/K)/K,e=[b[0]+(r-L)*c,b[0]+(s-L)*c];d[a.id+".radialaxis.range"]=e}function ah(b,c){var d=f._fullLayout.clickmode;if(t.removeZoombox(f),2===b){var g={};for(var h in a.viewInitial)g[a.id+"."+h]=a.viewInitial[h];f.emit("plotly_doubleclick",null),j.call("_guiRelayout",f,g)}d.indexOf("select")> -1&&1===b&&y(c,f,[a.xaxis],[a.yaxis],a.id,e),d.indexOf("event")> -1&&v.click(f,c,a.id)}e.prepFn=function(v,d,g){var h=f._fullLayout.dragmode,j=b.getBoundingClientRect();f._fullLayout._calcInverseTransform(f);var y=f._fullLayout._invTransform;n=f._fullLayout._invScaleX,o=f._fullLayout._invScaleY;var l=c.apply3DTransform(y)(d-j.left,g-j.top);if(p=l[0],q=l[1],P){var u=F.findPolygonOffset(K,O[0],O[1],P);p+=M+u[0],q+=N+u[1]}switch(h){case"zoom":e.clickFn=ah,G||(P?e.moveFn=ae:e.moveFn=ac,e.doneFn=af,r=null,s=null,w=a.pathSubplot(),A=!1,B=i(f._fullLayout[a.id].bgcolor).getLuminance(),(C=t.makeZoombox(H,B,k,m,w)).attr("fill-rule","evenodd"),D=t.makeCorners(H,k,m),z(f));break;case"select":case"lasso":x(v,d,g,e,h);break}},u.init(e)},b.updateRadialDrag=function(x,y,r){var i,m,n,F,G,H,a=this,A=a.gd,D=a.layers,e=a.radius,o=a.innerRadius,s=a.cx,v=a.cy,p=a.radialAxis,q=E.radialDragBoxSize,b=q/2;if(p.visible){var f=M(a.radialAxisAngle),d=p._rl,I=d[0],J=d[1],K=d[r],L=.75*(d[1]-d[0])/(1-a.getHole(y))/e;r?(i=s+(e+b)*Math.cos(f),m=v-(e+b)*Math.sin(f),n="radialdrag"):(i=s+(o-b)*Math.cos(f),m=v-(o-b)*Math.sin(f),n="radialdrag-inner");var w=t.makeRectDragger(D,n,"crosshair",-b,-b,q,q),g={element:w,gd:A};!1===x.dragmode&&(g.dragmode=!1),Q(h.select(w),p.visible&&o<e,{transform:l(i,m)}),g.prepFn=function(){F=null,G=null,H=null,g.moveFn=O,g.doneFn=S,z(A)},g.clampFn=function(a,b){return Math.sqrt(a*a+b*b)<E.MINDRAG&&(a=0,b=0),[a,b]},u.init(g)}function O(b,d){if(F)F(b,d);else{var a=[b,-d],h=[Math.cos(f),Math.sin(f)],e=Math.abs(c.dot(a,h)/Math.sqrt(c.dot(a,a)));isNaN(e)||(F=e<.5?T:U)}var g={};R(g),A.emit("plotly_relayouting",g)}function R(b){null!==G?b[a.id+".radialaxis.angle"]=G:null!==H&&(b[a.id+".radialaxis.range["+r+"]"]=H)}function S(){null!==G?j.call("_guiRelayout",A,a.id+".radialaxis.angle",G):null!==H&&j.call("_guiRelayout",A,a.id+".radialaxis.range["+r+"]",H)}function T(d,e){if(0!==r){G=Math.atan2(v-(m+e),i+d-s),a.vangles&&(G=P(G,a.vangles)),G=N(G);var b=l(s,v)+k(-G);D["radial-axis"].attr("transform",b),D["radial-line"].select("line").attr("transform",b);var c=a.gd._fullLayout,f=c[a.id];a.updateRadialAxisTitle(c,f,G)}}function U(k,l){if(H=K-L*c.dot([k,-l],[Math.cos(f),Math.sin(f)]),L>0!=(r?H>I:H<J)){H=null;return}var b=A._fullLayout,d=b[a.id];p.range[r]=H,p._rl[r]=H,a.updateRadialAxis(b,d),a.xaxis.setRange(),a.xaxis.setScale(),a.yaxis.setRange(),a.yaxis.setScale();var e=!1;for(var g in a.traceHash){var h=a.traceHash[g],i=c.filterVisible(h);h[0][0].trace._module.plot(A,a,i,d),j.traceIs(g,"gl")&&i.length&&(e=!0)}e&&(B(A),C(A))}},b.updateAngularDrag=function(e){var r,s,v,w,x,y,a=this,m=a.gd,f=a.layers,g=a.radius,D=a.angularAxis,o=a.cx,p=a.cy,F=a.cxx,G=a.cyy,q=E.angularDragBoxSize,d=t.makeDragger(f,"path","angulardrag",!1===e.dragmode?"none":"move"),b={element:d,gd:m};function H(a,b){return Math.atan2(G+q-b,a-F-q)}!1===e.dragmode?b.dragmode=!1:h.select(d).attr("d",a.pathAnnulus(g,g+q)).attr("transform",l(o,p)).call(A,"move");var i=f.frontplot.select(".scatterlayer").selectAll(".trace"),I=i.selectAll(".point"),J=i.selectAll(".textpoint");function K(M,O){var d=a.gd._fullLayout,g=d[a.id],P=r+M*e._invScaleX,Q=s+O*e._invScaleY,R=H(P,Q),b=N(R-y);if(w=v+b,f.frontplot.attr("transform",l(a.xOffset2,a.yOffset2)+k([-b,F,G])),a.vangles){x=a.radialAxisAngle+b;var q=l(o,p)+k(-b),t=l(o,p)+k(-x);f.bg.attr("transform",q),f["radial-grid"].attr("transform",q),f["radial-axis"].attr("transform",t),f["radial-line"].select("line").attr("transform",t),a.updateRadialAxisTitle(d,g,x)}else a.clipPaths.forTraces.select("path").attr("transform",l(F,G)+k(b));I.each(function(){var a=h.select(this),c=n.getTranslate(a);a.attr("transform",l(c.x,c.y)+k([b]))}),J.each(function(){var a=h.select(this),c=a.select("text"),d=n.getTranslate(a);a.attr("transform",k([b,c.attr("x"),c.attr("y")])+l(d.x,d.y))}),D.rotation=c.modHalf(w,360),a.updateAngularAxis(d,g),a._hasClipOnAxisFalse&&!c.isFullCircle(a.sectorInRad)&&i.call(n.hideOutsideRangePoints,a);var u=!1;for(var z in a.traceHash)if(j.traceIs(z,"gl")){var A=a.traceHash[z],E=c.filterVisible(A);A[0][0].trace._module.plot(m,a,E,g),E.length&&(u=!0)}u&&(B(m),C(m));var K={};L(K),m.emit("plotly_relayouting",K)}function L(b){b[a.id+".angularaxis.rotation"]=w,a.vangles&&(b[a.id+".radialaxis.angle"]=x)}function M(){J.select("text").attr("transform",null);var a={};L(a),j.call("_guiRelayout",m,a)}b.prepFn=function(j,h,i){v=e[a.id].angularaxis.rotation;var f=d.getBoundingClientRect();r=h-f.left,s=i-f.top,m._fullLayout._calcInverseTransform(m);var g=c.apply3DTransform(e._invTransform)(r,s);r=g[0],s=g[1],y=H(r,s),b.moveFn=K,b.doneFn=M,z(m)},a.vangles&&!c.isFullCircle(a.sectorInRad)&&(b.prepFn=c.noop,A(h.select(d),null)),u.init(b)},b.isPtInside=function(a){if(this.isSmith)return!0;var e=this.sectorInRad,b=this.vangles,f=this.angularAxis.c2g(a.theta),d=this.radialAxis,g=d.c2l(a.r),h=d._rl,i=b?F.isPtInsidePolygon:c.isPtInsideSector;return i(g,f,h,e,b)},b.pathArc=function(d){var a=this.sectorInRad,b=this.vangles;return(b?F.pathPolygon:c.pathArc)(d,a[0],a[1],b)},b.pathSector=function(d){var a=this.sectorInRad,b=this.vangles;return(b?F.pathPolygon:c.pathSector)(d,a[0],a[1],b)},b.pathAnnulus=function(d,e){var a=this.sectorInRad,b=this.vangles;return(b?F.pathPolygonAnnulus:c.pathAnnulus)(d,e,a[0],a[1],b)},b.pathSubplot=function(){var a=this.innerRadius,b=this.radius;return a?this.pathAnnulus(a,b):this.pathSector(b)},b.fillViewInitialKey=function(a,b){a in this.viewInitial||(this.viewInitial[a]=b)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(a,c,d){"use strict";var b=a("../../lib"),e=a("../cartesian/set_convert"),f=b.deg2rad,g=b.rad2deg;c.exports=function(a,c,h){switch(e(a,h),a._id){case"x":case"radialaxis":var d,i;d=a,i=c._subplot,d.setGeometry=function(){var a=d._rl[0],b=d._rl[1],c=i.innerRadius,e=(i.radius-c)/(b-a),f=c/e,g=a>b?function(a){return a<=0}:function(a){return a>=0};d.c2g=function(c){var b=d.c2l(c)-a;return(g(b)?b:0)+f},d.g2c=function(b){return d.l2c(b+a-f)},d.g2p=function(a){return a*e},d.c2p=function(a){return d.g2p(d.c2g(a))}};break;case"angularaxis":!function(a,d){var c=a.type;if("linear"===c){var e=a.d2c,h=a.c2d;a.d2c=function(b,c){var a;return a=e(b),"degrees"===c?f(a):a},a.c2d=function(b,c){var a;return h((a=b,"degrees"===c?g(a):a))}}a.makeCalcdata=function(g,i){var h,d,e=g[i],f=g._length,j=function(b){return a.d2c(b,g.thetaunit)};if(e){if(b.isTypedArray(e)&&"linear"===c){if(f===e.length)return e;if(e.subarray)return e.subarray(0,f)}for(d=0,h=new Array(f);d<f;d++)h[d]=j(e[d])}else{var k=i+"0",l="d"+i,m=k in g?j(g[k]):0,n=g[l]?j(g[l]):(a.period||2*Math.PI)/f;for(d=0,h=new Array(f);d<f;d++)h[d]=m+d*n}return h},a.setGeometry=function(){var i,j,k,l,e=d.sector,m=e.map(f),p={clockwise:-1,counterclockwise:1}[a.direction],q=f(a.rotation),r=function(a){return p*a+q},o=function(a){return(a-q)/p};switch(c){case"linear":j=i=b.identity,l=f,k=g,a.range=b.isFullCircle(m)?[e[0],e[0]+360]:m.map(o).map(g);break;case"category":var n=a._categories.length,h=a.period?Math.max(a.period,n):n;0===h&&(h=1),j=l=function(a){return 2*a*Math.PI/h},i=k=function(a){return a*h/Math.PI/2},a.range=[0,h];break}a.c2g=function(a){return r(j(a))},a.g2c=function(a){return i(o(a))},a.t2g=function(a){return r(l(a))},a.g2t=function(a){return k(o(a))}}}(a,c);break}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(b,a,c){"use strict";a.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(d,a,e){"use strict";function f(a){return a<0?-1:a>0?1:0}function b(c){var b=c[0],a=c[1];if(!isFinite(b)||!isFinite(a))return[1,0];var d=(b+1)*(b+1)+a*a;return[(b*b+a*a-1)/d,2*a/d]}function c(a,b){var c=b[0],d=b[1];return[c*a.radius+a.cx,-d*a.radius+a.cy]}function g(a,b){return b*a.radius}a.exports={smith:b,reactanceArc:function(d,a,m,n){var e=c(d,b([m,a])),f=e[0],h=e[1],i=c(d,b([n,a])),j=i[0],k=i[1];if(0===a)return["M"+f+","+h,"L"+j+","+k].join(" ");var l=g(d,1/Math.abs(a));return["M"+f+","+h,"A"+l+","+l+" 0 0,"+(a<0?1:0)+" "+j+","+k].join(" ")},resistanceArc:function(d,e,h,i){var a=g(d,1/(e+1)),j=c(d,b([e,h])),k=j[0],l=j[1],m=c(d,b([e,i])),n=m[0],o=m[1];if(f(h)!==f(i)){var p=c(d,b([e,0])),q=p[0],r=p[1];return["M"+k+","+l,"A"+a+","+a+" 0 0,"+(0<h?0:1)+" "+q+","+r,"A"+a+","+a+" 0 0,"+(i<0?0:1)+n+","+o,].join(" ")}return["M"+k+","+l,"A"+a+","+a+" 0 0,"+(i<h?0:1)+" "+n+","+o].join(" ")},smithTransform:c}},{}],638:[function(a,g,i){"use strict";var j=a("../get_data").getSubplotCalcData,h=a("../../lib").counterRegex,k=a("../polar/polar"),c=a("./constants"),d=c.attr,b=c.name,e=h(b),f={};f[d]={valType:"subplotid",dflt:b,editType:"calc"},g.exports={attr:d,name:b,idRoot:b,idRegex:e,attrRegex:e,attributes:f,layoutAttributes:a("./layout_attributes"),supplyLayoutDefaults:a("./layout_defaults"),plot:function(a){for(var c=a._fullLayout,h=a.calcdata,g=c._subplots[b],f=0;f<g.length;f++){var d=g[f],i=j(h,b,d),e=c[d]._subplot;e||(e=k(a,d,!0),c[d]._subplot=e),e.plot(i,c,a._promises)}},clean:function(i,g,j,d){for(var e=d._subplots[b]||[],c=0;c<e.length;c++){var f=e[c],a=d[f]._subplot;if(!g[f]&&a)for(var h in a.framework.remove(),a.clipPaths)a.clipPaths[h].remove()}},toSVG:a("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(c,g,l){"use strict";var h=c("../../components/color/attributes"),a=c("../cartesian/layout_attributes"),i=c("../domain").attributes,b=c("../../lib").extendFlat,d=c("../../plot_api/edit_types").overrideAll,e=d({color:a.color,showline:b({},a.showline,{dflt:!0}),linecolor:a.linecolor,linewidth:a.linewidth,showgrid:b({},a.showgrid,{dflt:!0}),gridcolor:a.gridcolor,gridwidth:a.gridwidth,griddash:a.griddash},"plot","from-root"),f=d({ticklen:a.ticklen,tickwidth:b({},a.tickwidth,{dflt:2}),tickcolor:a.tickcolor,showticklabels:a.showticklabels,showtickprefix:a.showtickprefix,tickprefix:a.tickprefix,showticksuffix:a.showticksuffix,ticksuffix:a.ticksuffix,tickfont:a.tickfont,tickformat:a.tickformat,hoverformat:a.hoverformat,layer:a.layer},"plot","from-root"),j=b({visible:b({},a.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:b({},a.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},e,f),k=b({visible:b({},a.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:a.ticks,editType:"calc"},e,f);g.exports={domain:i({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:h.background},realaxis:j,imaginaryaxis:k,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../../components/color"),g=a("../../plot_api/plot_template"),h=a("../subplot_defaults"),i=a("../get_data").getSubplotData,j=a("../cartesian/prefix_suffix_defaults"),k=a("../cartesian/tick_label_defaults"),l=a("../cartesian/line_grid_defaults"),m=a("../cartesian/set_convert"),n=a("./layout_attributes"),c=a("./constants"),o=c.axisNames,p=function(a,b){var c={};return function(d){var e=b?b(d):d;if(e in c)return c[e];var f=a(d);return c[e]=f,f}}(function(a){return a.slice().reverse().map(function(a){return-a}).concat([0]).concat(a)},String);function q(r,d,B,h){var C=B("bgcolor");h.bgColor=f.combine(C,h.paper_bgcolor);var D=i(h.fullData,c.name,h.id),E=h.layoutOut;function b(a,b){return B(q+"."+a,b)}for(var t=0;t<o.length;t++){q=o[t],e.isPlainObject(r[q])||(r[q]={});var s=r[q],a=g.newContainer(d,q);a._id=a._name=q,a._attr=h.id+"."+q,a._traceIndices=D.map(function(a){return a._expandedIndex});var x=b("visible");if(a.type="linear",m(a,E),j(s,a,b,a.type),x){var q,u,y,z,A,v="realaxis"===q;(v&&b("side"),v)?b("tickvals"):b("tickvals",p(d.realaxis.tickvals||n.realaxis.tickvals.dflt));var w=h.font||{};x&&(y=(u=b("color"))===s.color?u:w.color,z=w.size,A=w.family),k(s,a,b,a.type,{noTicklabelstep:!0,noAng:!v,noExp:!0,font:{color:y,size:z,family:A}}),e.coerce2(r,d,n,q+".ticklen"),e.coerce2(r,d,n,q+".tickwidth"),e.coerce2(r,d,n,q+".tickcolor",d.color),b("ticks")||(delete d[q].ticklen,delete d[q].tickwidth,delete d[q].tickcolor),l(s,a,b,{dfltColor:u,bgColor:h.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:n[q]}),b("layer")}b("hoverformat"),delete a.type,a._input=s}}b.exports=function(d,a,b){h(d,a,b,{noUirevision:!0,type:c.name,attributes:n,handleDefaults:q,font:a.font,paper_bgcolor:a.paper_bgcolor,fullData:b,layoutOut:a})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/plot_template"),f=a("./domain").defaults;b.exports=function(i,g,s,a){var m,j,o=a.type,t=a.attributes,p=a.handleDefaults,q=a.partition||"x",k=g._subplots[o],h=k.length,r=h&&k[0].replace(/\d+$/,"");function l(a,b){return d.coerce(m,j,t,a,b)}for(var b=0;b<h;b++){var c=k[b];m=i[c]?i[c]:i[c]={},j=e.newContainer(g,c,r),a.noUirevision||l("uirevision",g.uirevision);var n={};n[q]=[b/h,(b+1)/h],f(j,g,l,n),a.id=c,p(m,j,l,a)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(c,d,a){"use strict";var b=c("../constants/docs");function e(d){var e=d.description?" "+d.description:"",a=d.keys||[];if(a.length>0){for(var b=[],c=0;c<a.length;c++)b[c]="`"+a[c]+"`";e+="Finally, the template string has access to ",e=1===a.length?"variable "+b[0]:"variables "+b.slice(0,-1).join(", ")+" and "+b.slice(-1)+"."}return e}b.FORMAT_LINK,b.DATE_FORMAT_LINK,a.hovertemplateAttrs=function(a,b){a=a||{},e(b=b||{});var c={valType:"string",dflt:"",editType:a.editType||"none"};return!1!==a.arrayOk&&(c.arrayOk=!0),c},a.texttemplateAttrs=function(a,b){a=a||{},e(b=b||{});var c={valType:"string",dflt:"",editType:a.editType||"calc"};return!1!==a.arrayOk&&(c.arrayOk=!0),c}},{"../constants/docs":486}],643:[function(b,g,a){"use strict";var h=b("./ternary"),i=b("../../plots/get_data").getSubplotCalcData,d=b("../../lib").counterRegex,c="ternary";a.name=c;var e=a.attr="subplot";a.idRoot=c,a.idRegex=a.attrRegex=d(c);var f=a.attributes={};f[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},a.layoutAttributes=b("./layout_attributes"),a.supplyLayoutDefaults=b("./layout_defaults"),a.plot=function(b){for(var a=b._fullLayout,j=b.calcdata,g=a._subplots[c],f=0;f<g.length;f++){var d=g[f],k=i(j,c,d),e=a[d]._subplot;e||(e=new h({id:d,graphDiv:b,container:a._ternarylayer.node()},a),a[d]._subplot=e),e.plot(k,a,b._promises)}},a.clean=function(h,g,i,d){for(var e=d._subplots[c]||[],b=0;b<e.length;b++){var f=e[b],a=d[f]._subplot;!g[f]&&a&&(a.plotContainer.remove(),a.clipDef.remove(),a.clipDefRelative.remove(),a.layers["a-title"].remove(),a.layers["b-title"].remove(),a.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(b,f,j){"use strict";var g=b("../../components/color/attributes"),h=b("../domain").attributes,a=b("../cartesian/layout_attributes"),i=b("../../plot_api/edit_types").overrideAll,d=b("../../lib/extend").extendFlat,e={title:{text:a.title.text,font:a.title.font},color:a.color,tickmode:a.tickmode,nticks:d({},a.nticks,{dflt:6,min:1}),tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:a.ticks,ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,ticklabelstep:a.ticklabelstep,showticklabels:a.showticklabels,showtickprefix:a.showtickprefix,tickprefix:a.tickprefix,showticksuffix:a.showticksuffix,ticksuffix:a.ticksuffix,showexponent:a.showexponent,exponentformat:a.exponentformat,minexponent:a.minexponent,separatethousands:a.separatethousands,tickfont:a.tickfont,tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,hoverformat:a.hoverformat,showline:d({},a.showline,{dflt:!0}),linecolor:a.linecolor,linewidth:a.linewidth,showgrid:d({},a.showgrid,{dflt:!0}),gridcolor:a.gridcolor,gridwidth:a.gridwidth,griddash:a.griddash,layer:a.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:a._deprecated.title,titlefont:a._deprecated.titlefont}},c=f.exports=i({domain:h({name:"ternary"}),bgcolor:{valType:"color",dflt:g.background},sum:{valType:"number",dflt:1,min:0},aaxis:e,baxis:e,caxis:e},"plot","from-root");c.uirevision={valType:"any",editType:"none"},c.aaxis.uirevision=c.baxis.uirevision=c.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../plot_api/plot_template"),f=a("../../lib"),g=a("../subplot_defaults"),h=a("../cartesian/tick_label_defaults"),i=a("../cartesian/prefix_suffix_defaults"),j=a("../cartesian/tick_mark_defaults"),k=a("../cartesian/tick_value_defaults"),l=a("../cartesian/line_grid_defaults"),m=a("./layout_attributes"),n=["aaxis","baxis","caxis"];function o(a,b,h,c){var f,i,j,o=h("bgcolor"),q=h("sum");c.bgColor=d.combine(o,c.paper_bgcolor);for(var g=0;g<n.length;g++)i=a[f=n[g]]||{},(j=e.newContainer(b,f))._name=f,p(i,j,c,b);var k=b.aaxis,l=b.baxis,m=b.caxis;k.min+l.min+m.min>=q&&(k.min=0,l.min=0,m.min=0,a.aaxis&&delete a.aaxis.min,a.baxis&&delete a.baxis.min,a.caxis&&delete a.caxis.min)}function p(d,b,c,r){var g=m[b._name];function a(a,c){return f.coerce(d,b,g,a,c)}a("uirevision",r.uirevision),b.type="linear";var e=a("color"),n=e!==g.color.dflt?e:c.font.color,o=b._name.charAt(0).toUpperCase(),p="Component "+o,q=a("title.text",p);b._hovertitle=q===p?q:o,f.coerceFont(a,"title.font",{family:c.font.family,size:f.bigFont(c.font.size),color:n}),a("min"),k(d,b,a,"linear"),i(d,b,a,"linear"),h(d,b,a,"linear"),j(d,b,a,{outerTicks:!0}),a("showticklabels")&&(f.coerceFont(a,"tickfont",{family:c.font.family,size:c.font.size,color:n}),a("tickangle"),a("tickformat")),l(d,b,a,{dfltColor:e,bgColor:c.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:g}),a("hoverformat"),a("layer")}b.exports=function(b,a,c){g(b,a,c,{type:"ternary",attributes:m,handleDefaults:o,font:a.font,paper_bgcolor:a.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(b,g,i){"use strict";var j=b("@plotly/d3"),k=b("tinycolor2"),l=b("../../registry"),d=b("../../lib"),m=d.strTranslate,n=d._,o=b("../../components/color"),p=b("../../components/drawing"),q=b("../cartesian/set_convert"),r=b("../../lib/extend").extendFlat,s=b("../plots"),t=b("../cartesian/axes"),u=b("../../components/dragelement"),v=b("../../components/fx"),e=b("../../components/dragelement/helpers"),w=e.freeMode,x=e.rectMode,y=b("../../components/titles"),z=b("../../components/selections").prepSelect,A=b("../../components/selections").selectOnClick,B=b("../../components/selections").clearOutline,C=b("../../components/selections").clearSelectionsCache,h=b("../cartesian/constants");function f(a,b){this.id=a.id,this.graphDiv=a.graphDiv,this.init(b),this.makeFramework(b),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}g.exports=f;var c=f.prototype;c.init=function(a){this.container=a._ternarylayer,this.defs=a._defs,this.layoutId=a._uid,this.traceHash={},this.layers={}},c.plot=function(c,e){var a=this,b=e[a.id],f=e._size;a._hasClipOnAxisFalse=!1;for(var d=0;d<c.length;d++)if(!1===c[d][0].trace.cliponaxis){a._hasClipOnAxisFalse=!0;break}a.updateLayers(b),a.adjustLayout(b,f),s.generalUpdatePerTraceModule(a.graphDiv,a,c,b),a.layers.plotbg.select("path").call(o.fill,b.bgcolor)},c.makeFramework=function(b){var a=this,e=a.graphDiv,f=b[a.id],c=a.clipId="clip"+a.layoutId+a.id,g=a.clipIdRelative="clip-relative"+a.layoutId+a.id;a.clipDef=d.ensureSingleById(b._clips,"clipPath",c,function(a){a.append("path").attr("d","M0,0Z")}),a.clipDefRelative=d.ensureSingleById(b._clips,"clipPath",g,function(a){a.append("path").attr("d","M0,0Z")}),a.plotContainer=d.ensureSingle(a.container,"g",a.id),a.updateLayers(f),p.setClipUrl(a.layers.backplot,c,e),p.setClipUrl(a.layers.grids,c,e)},c.updateLayers=function(b){var d=this.layers,a=["draglayer","plotbg","backplot","grids"];"below traces"===b.aaxis.layer&&a.push("aaxis","aline"),"below traces"===b.baxis.layer&&a.push("baxis","bline"),"below traces"===b.caxis.layer&&a.push("caxis","cline"),a.push("frontplot"),"above traces"===b.aaxis.layer&&a.push("aaxis","aline"),"above traces"===b.baxis.layer&&a.push("baxis","bline"),"above traces"===b.caxis.layer&&a.push("caxis","cline");var c=this.plotContainer.selectAll("g.toplevel").data(a,String),e=["agrid","bgrid","cgrid"];c.enter().append("g").attr("class",function(a){return"toplevel "+a}).each(function(a){var b=j.select(this);d[a]=b,"frontplot"===a?b.append("g").classed("scatterlayer",!0):"backplot"===a?b.append("g").classed("maplayer",!0):"plotbg"===a?b.append("path").attr("d","M0,0Z"):"aline"===a||"bline"===a||"cline"===a?b.append("path"):"grids"===a&&e.forEach(function(a){d[a]=b.append("g").classed("grid "+a,!0)})}),c.order()};var D=Math.sqrt(4/3);c.adjustLayout=function(d,i){var e,f,b,c,w,s,a=this,g=d.domain,x=(g.x[0]+g.x[1])/2,y=(g.y[0]+g.y[1])/2,B=g.x[1]-g.x[0],C=g.y[1]-g.y[0],z=B*i.w,A=C*i.h,h=d.sum,j=d.aaxis.min,t=d.baxis.min,u=d.caxis.min;z>D*A?b=(c=A)*D:c=(b=z)/D,w=B*b/z,s=C*c/A,e=i.l+i.w*x-b/2,f=i.t+i.h*(1-y)-c/2,a.x0=e,a.y0=f,a.w=b,a.h=c,a.sum=h,a.xaxis={type:"linear",range:[j+2*u-h,h-j-2*t],domain:[x-w/2,x+w/2],_id:"x"},q(a.xaxis,a.graphDiv._fullLayout),a.xaxis.setScale(),a.xaxis.isPtWithinRange=function(b){return b.a>=a.aaxis.range[0]&&b.a<=a.aaxis.range[1]&&b.b>=a.baxis.range[1]&&b.b<=a.baxis.range[0]&&b.c>=a.caxis.range[1]&&b.c<=a.caxis.range[0]},a.yaxis={type:"linear",range:[j,h-t-u],domain:[y-s/2,y+s/2],_id:"y"},q(a.yaxis,a.graphDiv._fullLayout),a.yaxis.setScale(),a.yaxis.isPtWithinRange=function(){return!0};var v=a.yaxis.domain[0],k=a.aaxis=r({},d.aaxis,{range:[j,h-t-u],side:"left",tickangle:(+d.aaxis.tickangle||0)-30,domain:[v,v+s*D],anchor:"free",position:0,_id:"y",_length:b});q(k,a.graphDiv._fullLayout),k.setScale();var l=a.baxis=r({},d.baxis,{range:[h-j-u,t],side:"bottom",domain:a.xaxis.domain,anchor:"free",position:0,_id:"x",_length:b});q(l,a.graphDiv._fullLayout),l.setScale();var n=a.caxis=r({},d.caxis,{range:[h-j-t,u],side:"right",tickangle:(+d.caxis.tickangle||0)+30,domain:[v,v+s*D],anchor:"free",position:0,_id:"y",_length:b});q(n,a.graphDiv._fullLayout),n.setScale();var E="M"+e+","+(f+c)+"h"+b+"l-"+b/2+",-"+c+"Z";a.clipDef.select("path").attr("d",E),a.layers.plotbg.select("path").attr("d",E),a.clipDefRelative.select("path").attr("d","M0,"+c+"h"+b+"l-"+b/2+",-"+c+"Z");var I=m(e,f);a.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",I),a.clipDefRelative.select("path").attr("transform",null);var F=m(e-l._offset,f+c);a.layers.baxis.attr("transform",F),a.layers.bgrid.attr("transform",F);var G=m(e+b/2,f)+"rotate(30)"+m(0,-k._offset);a.layers.aaxis.attr("transform",G),a.layers.agrid.attr("transform",G);var H=m(e+b/2,f)+"rotate(-30)"+m(0,-n._offset);a.layers.caxis.attr("transform",H),a.layers.cgrid.attr("transform",H),a.drawAxes(!0),a.layers.aline.select("path").attr("d",k.showline?"M"+e+","+(f+c)+"l"+b/2+",-"+c:"M0,0").call(o.stroke,k.linecolor||"#000").style("stroke-width",(k.linewidth||0)+"px"),a.layers.bline.select("path").attr("d",l.showline?"M"+e+","+(f+c)+"h"+b:"M0,0").call(o.stroke,l.linecolor||"#000").style("stroke-width",(l.linewidth||0)+"px"),a.layers.cline.select("path").attr("d",n.showline?"M"+(e+b/2)+","+f+"l"+b/2+","+c:"M0,0").call(o.stroke,n.linecolor||"#000").style("stroke-width",(n.linewidth||0)+"px"),a.graphDiv._context.staticPlot||a.initInteractions(),p.setClipUrl(a.layers.frontplot,a._hasClipOnAxisFalse?null:a.clipId,a.graphDiv)},c.drawAxes=function(h){var c=this.graphDiv,f=this.id.substr(7)+"title",g=this.layers,d=this.aaxis,a=this.baxis,b=this.caxis;if(this.drawAx(d),this.drawAx(a),this.drawAx(b),h){var i=Math.max(d.showticklabels?d.tickfont.size/2:0,(b.showticklabels?.75*b.tickfont.size:0)+("outside"===b.ticks?.87*b.ticklen:0)),e=(a.showticklabels?a.tickfont.size:0)+("outside"===a.ticks?a.ticklen:0)+3;g["a-title"]=y.draw(c,"a"+f,{propContainer:d,propName:this.id+".aaxis.title",placeholder:n(c,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-d.title.font.size/3-i,"text-anchor":"middle"}}),g["b-title"]=y.draw(c,"b"+f,{propContainer:a,propName:this.id+".baxis.title",placeholder:n(c,"Click to enter Component B title"),attributes:{x:this.x0-e,y:this.y0+this.h+.83*a.title.font.size+e,"text-anchor":"middle"}}),g["c-title"]=y.draw(c,"c"+f,{propContainer:b,propName:this.id+".caxis.title",placeholder:n(c,"Click to enter Component C title"),attributes:{x:this.x0+this.w+e,y:this.y0+this.h+.83*b.title.font.size+e,"text-anchor":"middle"}})}},c.drawAx=function(a){var g,b=this,h=b.graphDiv,n=a._name,c=n.charAt(0),u=a._id,i=b.layers[n],o=c+"tickLayout",p=(g=a).ticks+String(g.ticklen)+String(g.showticklabels);b[o]!==p&&(i.selectAll("."+u+"tick").remove(),b[o]=p),a.setScale();var j=t.calcTicks(a),q=t.clipEnds(a,j),k=t.makeTransTickFn(a),r=t.getTickSigns(a)[2],e=d.deg2rad(30),s=r*(a.linewidth||1)/2,f=r*a.ticklen,l=b.w,m=b.h,v={a:"M0,0l"+m+",-"+l/2,b:"M0,0l-"+l/2+",-"+m,c:"M0,0l-"+m+","+l/2}[c];t.drawTicks(h,a,{vals:"inside"===a.ticks?q:j,layer:i,path:"b"===c?"M0,"+s+"l"+Math.sin(e)*f+","+Math.cos(e)*f:"M"+s+",0l"+Math.cos(e)*f+","+ -Math.sin(e)*f,transFn:k,crisp:!1}),t.drawGrid(h,a,{vals:q,layer:b.layers[c+"grid"],path:v,transFn:k,crisp:!1}),t.drawLabels(h,a,{vals:j,layer:i,transFn:k,labelFns:t.makeLabelFns(a,0,30)})};var a=h.MINZOOM/2+.87,E="m-0.87,.5h"+a+"v3h-"+(a+5.2)+"l"+(a/2+2.6)+",-"+(.87*a+4.5)+"l2.6,1.5l-"+a/2+","+.87*a+"Z",F="m0.87,.5h-"+a+"v3h"+(a+5.2)+"l-"+(a/2+2.6)+",-"+(.87*a+4.5)+"l-2.6,1.5l"+a/2+","+.87*a+"Z",G="m0,1l"+a/2+","+.87*a+"l2.6,-1.5l-"+(a/2+2.6)+",-"+(.87*a+4.5)+"l-"+(a/2+2.6)+","+(.87*a+4.5)+"l2.6,1.5l"+a/2+",-"+.87*a+"Z",H=!0;function I(a){j.select(a).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}c.clearOutline=function(){C(this.dragOptions),B(this.dragOptions.gd)},c.initInteractions=function(){var e,f,g,i,j,q,r,s,t,y,B,C,a=this,b=a.layers.plotbg.select("path").node(),c=a.graphDiv,J=c._fullLayout._zoomlayer;function K(c){var b={};return b[a.id+".aaxis.min"]=c.a,b[a.id+".baxis.min"]=c.b,b[a.id+".caxis.min"]=c.c,b}function L(b,d){var e=c._fullLayout.clickmode;I(c),2===b&&(c.emit("plotly_doubleclick",null),l.call("_guiRelayout",c,K({a:0,b:0,c:0}))),e.indexOf("select")> -1&&1===b&&A(d,c,[a.xaxis],[a.yaxis],a.id,a.dragOptions),e.indexOf("event")> -1&&v.click(c,d,a.id)}function M(c,b){return 1-b/a.h}function N(b,c){return 1-(b+(a.h-c)/Math.sqrt(3))/a.w}function O(b,c){return(b-(a.h-c)/Math.sqrt(3))/a.w}function P(x,z){var m=g+x*e,n=i+z*f,k=Math.max(0,Math.min(1,M(g,i),M(m,n))),o=Math.max(0,Math.min(1,N(g,i),N(m,n))),p=Math.max(0,Math.min(1,O(g,i),O(m,n))),b=(k/2+p)*a.w,l=(1-k/2-o)*a.w,u=(b+l)/2,v=l-b,d=(1-k)*a.h,w=d-v/D;v<h.MINZOOM?(r=j,B.attr("d",t),C.attr("d","M0,0Z")):(r={a:j.a+k*q,b:j.b+o*q,c:j.c+p*q},B.attr("d",t+"M"+b+","+d+"H"+l+"L"+u+","+w+"L"+b+","+d+"Z"),C.attr("d","M"+g+","+i+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+b+","+d+E+"M"+l+","+d+F+"M"+u+","+w+G)),y||(B.transition().style("fill",s>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),C.transition().style("opacity",1).duration(200),y=!0),c.emit("plotly_relayouting",K(r))}function Q(){I(c),r!==j&&(l.call("_guiRelayout",c,K(r)),H&&c.data&&c._context.showTips&&(d.notifier(n(c,"Double-click to zoom back out"),"long"),H=!1))}function R(e,f){var i=e/a.xaxis._m,g=f/a.yaxis._m,b=[(r={a:j.a-g,b:j.b+(i+g)/2,c:j.c-(i-g)/2}).a,r.b,r.c].sort(d.sorterAsc),h={a:b.indexOf(r.a),b:b.indexOf(r.b),c:b.indexOf(r.c)};b[0]<0&&(b[1]+b[0]/2<0?(b[2]+=b[0]+b[1],b[0]=b[1]=0):(b[2]+=b[0]/2,b[1]+=b[0]/2,b[0]=0),r={a:b[h.a],b:b[h.b],c:b[h.c]},f=(j.a-r.a)*a.yaxis._m,e=(j.c-r.c-j.b+r.b)*a.xaxis._m);var k=m(a.x0+e,a.y0+f);a.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",k);var l=m(-e,-f);a.clipDefRelative.select("path").attr("transform",l),a.aaxis.range=[r.a,a.sum-r.b-r.c],a.baxis.range=[a.sum-r.a-r.c,r.b],a.caxis.range=[a.sum-r.a-r.b,r.c],a.drawAxes(!1),a._hasClipOnAxisFalse&&a.plotContainer.select(".scatterlayer").selectAll(".trace").call(p.hideOutsideRangePoints,a),c.emit("plotly_relayouting",K(r))}function S(){l.call("_guiRelayout",c,K(r))}this.dragOptions={element:b,gd:c,plotinfo:{id:a.id,domain:c._fullLayout[a.id].domain,xaxis:a.xaxis,yaxis:a.yaxis},subplot:a.id,prepFn:function(E,n,p){a.dragOptions.xaxes=[a.xaxis],a.dragOptions.yaxes=[a.yaxis],e=c._fullLayout._invScaleX,f=c._fullLayout._invScaleY;var u,v,A,D,l,h=a.dragOptions.dragmode=c._fullLayout.dragmode;w(h)?a.dragOptions.minDrag=1:a.dragOptions.minDrag=void 0,"zoom"===h?(a.dragOptions.moveFn=P,a.dragOptions.clickFn=L,a.dragOptions.doneFn=Q,u=n,v=p,g=u-(A=b.getBoundingClientRect()).left,i=v-A.top,c._fullLayout._calcInverseTransform(c),D=c._fullLayout._invTransform,l=d.apply3DTransform(D)(g,i),g=l[0],i=l[1],j={a:a.aaxis.range[0],b:a.baxis.range[1],c:a.caxis.range[1]},r=j,q=a.aaxis.range[1]-j.a,s=k(a.graphDiv._fullLayout[a.id].bgcolor).getLuminance(),t="M0,"+a.h+"L"+a.w/2+", 0L"+a.w+","+a.h+"Z",y=!1,B=J.append("path").attr("class","zoombox").attr("transform",m(a.x0,a.y0)).style({fill:s>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",t),C=J.append("path").attr("class","zoombox-corners").attr("transform",m(a.x0,a.y0)).style({fill:o.background,stroke:o.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),a.clearOutline(c)):"pan"===h?(a.dragOptions.moveFn=R,a.dragOptions.clickFn=L,a.dragOptions.doneFn=S,r=j={a:a.aaxis.range[0],b:a.baxis.range[1],c:a.caxis.range[1]},a.clearOutline(c)):(x(h)||w(h))&&z(E,n,p,a.dragOptions,h)}},b.onmousemove=function(d){v.hover(c,d,a.id),c._fullLayout._lasthover=b,c._fullLayout._hoversubplot=a.id},b.onmouseout=function(a){c._dragging||u.unhover(c,a)},u.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(b,d,a){"use strict";var e=b("./lib/loggers"),f=b("./lib/noop"),g=b("./lib/push_unique"),h=b("./lib/is_plain_object"),i=b("./lib/dom").addStyleRule,c=b("./lib/extend"),j=b("./plots/attributes"),k=b("./plots/layout_attributes"),l=c.extendFlat,m=c.extendDeepAll;function n(b){var c=b.name,f=b.categories,g=b.meta;if(a.modules[c]){e.log("Type "+c+" already registered");return}a.subplotsRegistry[b.basePlotModule.name]||o(b.basePlotModule);for(var j={},d=0;d<f.length;d++)j[f[d]]=!0,a.allCategories[f[d]]=!0;for(var p in a.modules[c]={_module:b,categories:j},g&&Object.keys(g).length&&(a.modules[c].meta=g),a.allTypes.push(c),a.componentsRegistry)t(p,c);b.layoutAttributes&&l(a.traceLayoutAttributes,b.layoutAttributes);var k=b.basePlotModule,h=k.name;if("mapbox"===h){var m=k.constants.styleRules;for(var n in m)i(".js-plotly-plot .plotly .mapboxgl-"+n,m[n])}("geo"===h||"mapbox"===h)&& void 0===window.PlotlyGeoAssets&&(window.PlotlyGeoAssets={topojson:{}})}function o(b){var c=b.name;if(a.subplotsRegistry[c]){e.log("Plot type "+c+" already registered.");return}for(var d in s(b),a.subplotsRegistry[c]=b,a.componentsRegistry)v(d,b.name)}function p(b){if("string"!=typeof b.name)throw new Error("Component module *name* must be a string.");var c=b.name;for(var d in a.componentsRegistry[c]=b,b.layoutAttributes&&(b.layoutAttributes._isLinkedToArray&&g(a.layoutArrayContainers,c),s(b)),a.modules)t(c,d);for(var e in a.subplotsRegistry)v(c,e);for(var f in a.transformsRegistry)u(c,f);b.schema&&b.schema.layout&&m(k,b.schema.layout)}function q(b){if("string"!=typeof b.name)throw new Error("Transform module *name* must be a string.");var c="Transform module "+b.name,d="function"==typeof b.transform,f="function"==typeof b.calcTransform;if(!d&&!f)throw new Error(c+" is missing a *transform* or *calcTransform* method.");for(var g in d&&f&&e.log([c+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),h(b.attributes)||e.log(c+" registered without an *attributes* object."),"function"!=typeof b.supplyDefaults&&e.log(c+" registered without a *supplyDefaults* method."),a.transformsRegistry[b.name]=b,a.componentsRegistry)u(g,b.name)}function r(h){var d=h.name,i=d.split("-")[0],e=h.dictionary,f=h.format,j=e&&Object.keys(e).length,k=f&&Object.keys(f).length,g=a.localeRegistry,b=g[d];if(b||(g[d]=b={}),i!==d){var c=g[i];c||(g[i]=c={}),j&&c.dictionary===b.dictionary&&(c.dictionary=e),k&&c.format===b.format&&(c.format=f)}j&&(b.dictionary=e),k&&(b.format=f)}function s(d){if(d.layoutAttributes){var b=d.layoutAttributes._arrayAttrRegexps;if(b)for(var c=0;c<b.length;c++)g(a.layoutArrayRegexes,b[c])}}function t(e,c){var b=a.componentsRegistry[e].schema;if(b&&b.traces){var d=b.traces[c];d&&m(a.modules[c]._module.attributes,d)}}function u(e,c){var b=a.componentsRegistry[e].schema;if(b&&b.transforms){var d=b.transforms[c];d&&m(a.transformsRegistry[c].attributes,d)}}function v(g,h){var d=a.componentsRegistry[g].schema;if(d&&d.subplots){var b=a.subplotsRegistry[h],e=b.layoutAttributes,c="subplot"===b.attr?b.name:b.attr;Array.isArray(c)&&(c=c[0]);var f=d.subplots[c];e&&f&&m(e,f)}}function w(a){return"object"==typeof a&&(a=a.type),a}a.modules={},a.allCategories={},a.allTypes=[],a.subplotsRegistry={},a.transformsRegistry={},a.componentsRegistry={},a.layoutArrayContainers=[],a.layoutArrayRegexes=[],a.traceLayoutAttributes={},a.localeRegistry={},a.apiMethodRegistry={},a.collectableSubplotTypes=null,a.register=function(c){if(a.collectableSubplotTypes=null,c)c&&!Array.isArray(c)&&(c=[c]);else throw new Error("No argument passed to Plotly.register.");for(var d=0;d<c.length;d++){var b=c[d];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":n(b);break;case"transform":q(b);break;case"component":p(b);break;case"locale":r(b);break;case"apiMethod":var e=b.name;a.apiMethodRegistry[e]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},a.getModule=function(c){var b=a.modules[w(c)];return!!b&&b._module},a.traceIs=function(b,d){if("various"===(b=w(b)))return!1;var c=a.modules[b];return c||(b&&e.log("Unrecognized trace type "+b+"."),c=a.modules[j.type.dflt]),!!c.categories[d]},a.getTransformIndices=function(d,e){for(var b=[],c=d.transforms||[],a=0;a<c.length;a++)c[a].type===e&&b.push(a);return b},a.hasTransform=function(c,d){for(var b=c.transforms||[],a=0;a<b.length;a++)if(b[a].type===d)return!0;return!1},a.getComponentMethod=function(c,d){var b=a.componentsRegistry[c];return b?b[d]||f:f},a.call=function(){var b=arguments[0],c=[].slice.call(arguments,1);return a.apiMethodRegistry[b].apply(null,c)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(a,c,d){"use strict";var e=a("../registry"),b=a("../lib"),f=b.extendFlat,g=b.extendDeep;function h(b){var a;switch(b){case"themes__thumb":a={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":a={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:a={}}return a}function i(a){return["xaxis","yaxis","zaxis"].indexOf(a.slice(0,5))> -1}c.exports=function(l,a){var b,r=l.data,s=l.layout,m=g([],r),d=g({},s,h(a.tileClass)),t=l._context||{};if(a.width&&(d.width=a.width),a.height&&(d.height=a.height),"thumbnail"===a.tileClass||"themes__thumb"===a.tileClass){d.annotations=[];var n=Object.keys(d);for(b=0;b<n.length;b++)i(n[b])&&(d[n[b]].title={text:""});for(b=0;b<m.length;b++){var j=m[b];j.showscale=!1,j.marker&&(j.marker.showscale=!1),e.traceIs(j,"pie-like")&&(j.textposition="none")}}if(Array.isArray(a.annotations))for(b=0;b<a.annotations.length;b++)d.annotations.push(a.annotations[b]);var o=Object.keys(d).filter(function(a){return a.match(/^scene\d*$/)});if(o.length){var k={};for("thumbnail"===a.tileClass&&(k={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),b=0;b<o.length;b++){var c=d[o[b]];c.xaxis||(c.xaxis={}),c.yaxis||(c.yaxis={}),c.zaxis||(c.zaxis={}),f(c.xaxis,k),f(c.yaxis,k),f(c.zaxis,k),c._scene=null}}var p=document.createElement("div");a.tileClass&&(p.className=a.tileClass);var q={gd:p,td:p,layout:d,data:m,config:{staticPlot:void 0===a.staticPlot||a.staticPlot,plotGlPixelRatio:void 0===a.plotGlPixelRatio?2:a.plotGlPixelRatio,displaylogo:a.displaylogo||!1,showLink:a.showLink||!1,showTips:a.showTips||!1,mapboxAccessToken:t.mapboxAccessToken}};return"transparent"!==a.setBackground&&(q.config.setBackground=a.setBackground||"opaque"),q.gd.defaultLayout=h(a.tileClass),q}},{"../lib":515,"../registry":647}],649:[function(a,b,c){"use strict";var d=a("../lib"),e=a("../plot_api/to_image"),f=a("./filesaver"),g=a("./helpers");b.exports=function(b,a){var c;return d.isPlainObject(b)||(c=d.getGraphDiv(b)),(a=a||{}).format=a.format||"png",a.width=a.width||null,a.height=a.height||null,a.imageDataOnly=!0,new Promise(function(k,h){c&&c._snapshotInProgress&&h(new Error("Snapshotting already in progress.")),d.isIE()&&"svg"!==a.format&&h(new Error(g.MSG_IE_BAD_FORMAT)),c&&(c._snapshotInProgress=!0);var i=e(b,a),j=a.filename||b.fn||"newplot";j+="."+a.format.replace("-","."),i.then(function(b){return c&&(c._snapshotInProgress=!1),f(b,j,a.format)}).then(function(a){k(a)}).catch(function(a){c&&(c._snapshotInProgress=!1),h(a)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(a,b,c){"use strict";var d=a("../lib"),e=a("./helpers");b.exports=function(b,c,f){var a=document.createElement("a"),g="download"in a;return new Promise(function(h,i){if(d.isIE())return k=e.createBlob(b,"svg"),window.navigator.msSaveBlob(k,c),k=null,h(c);if(g)return k=e.createBlob(b,f),l=e.createObjectURL(k),a.href=l,a.download=c,document.body.appendChild(a),a.click(),document.body.removeChild(a),e.revokeObjectURL(l),k=null,h(c);if(d.isSafari()){var k,l,j="svg"===f?",":";base64,";return e.octetStream(j+encodeURIComponent(b)),h(c)}i(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(b,c,a){"use strict";var d=b("../registry");a.getDelay=function(a){return a._has&&(a._has("gl3d")||a._has("gl2d")||a._has("mapbox"))?500:0},a.getRedrawFunc=function(a){return function(){d.getComponentMethod("colorbar","draw")(a)}},a.encodeSVG=function(a){return"data:image/svg+xml,"+encodeURIComponent(a)},a.encodeJSON=function(a){return"data:application/json,"+encodeURIComponent(a)};var e=window.URL||window.webkitURL;a.createObjectURL=function(a){return e.createObjectURL(a)},a.revokeObjectURL=function(a){return e.revokeObjectURL(a)},a.createBlob=function(a,b){if("svg"===b)return new window.Blob([a],{type:"image/svg+xml;charset=utf-8"});if("full-json"===b)return new window.Blob([a],{type:"application/json;charset=utf-8"});var c=function(b){for(var c=b.length,d=new ArrayBuffer(c),e=new Uint8Array(d),a=0;a<c;a++)e[a]=b.charCodeAt(a);return d}(window.atob(a));return new window.Blob([c],{type:"image/"+b})},a.octetStream=function(a){document.location.href="data:application/octet-stream"+a},a.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,a.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(a,c,e){"use strict";var b=a("./helpers"),d={getDelay:b.getDelay,getRedrawFunc:b.getRedrawFunc,clone:a("./cloneplot"),toSVG:a("./tosvg"),svgToImg:a("./svgtoimg"),toImage:a("./toimage"),downloadImage:a("./download")};c.exports=d},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(a,b,c){"use strict";var d=a("../lib"),e=a("events").EventEmitter,f=a("./helpers");b.exports=function(a){var b=a.emitter||new e,c=new Promise(function(t,n){var i,e,o=window.Image,j=a.svg,k=a.format||"png";if(d.isIE()&&"svg"!==k){var l=new Error(f.MSG_IE_BAD_FORMAT);return(n(l),a.promise)?c:b.emit("error",l)}var g=a.canvas,m=a.scale||1,p=a.width||300,q=a.height||150,r=m*p,s=m*q,u=g.getContext("2d",{willReadFrequently:!0}),h=new o;"svg"===k||d.isSafari()?e=f.encodeSVG(j):(i=f.createBlob(j,"svg"),e=f.createObjectURL(i)),g.width=r,g.height=s,h.onload=function(){var c;switch(i=null,f.revokeObjectURL(e),"svg"!==k&&u.drawImage(h,0,0,r,s),k){case"jpeg":c=g.toDataURL("image/jpeg");break;case"png":c=g.toDataURL("image/png");break;case"webp":c=g.toDataURL("image/webp");break;case"svg":c=e;break;default:var d="Image format is not jpeg, png, svg or webp.";if(n(new Error(d)),!a.promise)return b.emit("error",d)}t(c),a.promise||b.emit("success",c)},h.onerror=function(c){if(i=null,f.revokeObjectURL(e),n(c),!a.promise)return b.emit("error",c)},h.src=e});return a.promise?c:b}},{"../lib":515,"./helpers":651,events:84}],654:[function(a,b,c){"use strict";var d=a("events").EventEmitter,e=a("../registry"),f=a("../lib"),g=a("./helpers"),h=a("./cloneplot"),i=a("./tosvg"),j=a("./svgtoimg");b.exports=function(c,m){var k=new d,b=h(c,{format:"png"}),a=b.gd;a.style.position="absolute",a.style.left="-5000px",document.body.appendChild(a);var l=g.getRedrawFunc(a);return e.call("_doPlot",a,b.data,b.layout,b.config).then(l).then(function(){setTimeout(function(){var c=i(a),b=document.createElement("canvas");b.id=f.randstr(),(k=j({format:m.format,width:a._fullLayout.width,height:a._fullLayout.height,canvas:b,emitter:k,svg:c})).clean=function(){a&&document.body.removeChild(a)}},g.getDelay(a._fullLayout))}).catch(function(a){k.emit("error",a)}),k}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(a,c,d){"use strict";var e=a("@plotly/d3"),f=a("../lib"),g=a("../components/drawing"),h=a("../components/color"),i=a("../constants/xmlns_namespaces"),j=/"/g,b="TOBESTRIPPED",k=new RegExp('("'+b+")|("+b+'")',"g");c.exports=function(q,m,n){var d,l=q._fullLayout,a=l._paper,r=l._toppaper,o=l.width,p=l.height;a.insert("rect",":first-child").call(g.setRect,0,0,o,p).call(h.fill,l.paper_bgcolor);var s=l._basePlotModules||[];for(d=0;d<s.length;d++){var t=s[d];t.toSVG&&t.toSVG(q)}if(r){var z=r.node().childNodes,u=Array.prototype.slice.call(z);for(d=0;d<u.length;d++){var v=u[d];v.childNodes.length&&a.node().appendChild(v)}}l._draggers&&l._draggers.remove(),a.node().style.background="",a.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var a=e.select(this);if("hidden"===this.style.visibility||"none"===this.style.display){a.remove();return}a.style({visibility:null,display:null});var c=this.style.fontFamily;c&& -1!==c.indexOf('"')&&a.style("font-family",c.replace(j,b))}),a.selectAll(".gradient_filled,.pattern_filled").each(function(){var d=e.select(this),a=this.style.fill;a&& -1!==a.indexOf("url(")&&d.style("fill",a.replace(j,b));var c=this.style.stroke;c&& -1!==c.indexOf("url(")&&d.style("stroke",c.replace(j,b))}),("pdf"===m||"eps"===m)&&a.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),a.node().setAttributeNS(i.xmlns,"xmlns",i.svg),a.node().setAttributeNS(i.xmlns,"xmlns:xlink",i.xlink),"svg"===m&&n&&(a.attr("width",n*o),a.attr("height",n*p),a.attr("viewBox","0 0 "+o+" "+p));var w,x,y,c=new window.XMLSerializer().serializeToString(a.node());return c=(c=(c=(w=c,x=e.select("body").append("div").style({display:"none"}).html(""),y=w.replace(/(&[^;]*;)/gi,function(a){return"&lt;"===a?"&#60;":"&rt;"===a?"&#62;":-1!==a.indexOf("<")|| -1!==a.indexOf(">")?"":x.html(a).text()}),x.remove(),y)).replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(k,"'"),f.isIE()&&(c=(c=(c=c.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),c}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,e){for(var b=0;b<a.length;b++)a[b].i=b;d.mergeArray(e.text,a,"tx"),d.mergeArray(e.hovertext,a,"htx");var c=e.marker;if(c){d.mergeArray(c.opacity,a,"mo",!0),d.mergeArray(c.color,a,"mc");var f=c.line;f&&(d.mergeArray(f.color,a,"mlc"),d.mergeArrayCastPositive(f.width,a,"mlw"))}}},{"../../lib":515}],657:[function(b,h,r){"use strict";var a=b("../scatter/attributes"),e=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,i=b("../../plots/template_attributes").hovertemplateAttrs,j=b("../../plots/template_attributes").texttemplateAttrs,f=b("../../components/colorscale/attributes"),k=b("../../plots/font_attributes"),g=b("./constants"),l=b("../../components/drawing/attributes").pattern,c=b("../../lib/extend").extendFlat,d=k({editType:"calc",arrayOk:!0,colorEditType:"style"}),m=a.marker,n=m.line,o=c({},n.width,{dflt:0}),p=c({width:o,editType:"calc"},f("marker.line")),q=c({line:p,editType:"calc"},f("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:l});h.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),text:a.text,texttemplate:j({editType:"plot"},{keys:g.eventDataKeys}),hovertext:a.hovertext,hovertemplate:i({},{keys:g.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:c({},d,{}),insidetextfont:c({},d,{}),outsidetextfont:c({},d,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:c({},a.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:q,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,color:a.selected.marker.color,editType:"style"},textfont:a.selected.textfont,editType:"style"},unselected:{marker:{opacity:a.unselected.marker.opacity,color:a.unselected.marker.color,editType:"style"},textfont:a.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../plots/cartesian/align_period"),f=a("../../components/colorscale/helpers").hasColorscale,g=a("../../components/colorscale/calc"),h=a("./arrays_to_calcdata"),i=a("../scatter/calc_selection");b.exports=function(l,a){var m,r,j,k,o,n,p=d.getFromId(l,a.xaxis||"x"),q=d.getFromId(l,a.yaxis||"y"),s={msUTC:!!(a.base||0===a.base)};"h"===a.orientation?(m=p.makeCalcdata(a,"x",s),j=q.makeCalcdata(a,"y"),k=e(a,q,"y",j),o=!!a.yperiodalignment,n="y"):(m=q.makeCalcdata(a,"y",s),j=p.makeCalcdata(a,"x"),k=e(a,p,"x",j),o=!!a.xperiodalignment,n="x");for(var t=Math.min((r=k.vals).length,m.length),c=new Array(t),b=0;b<t;b++)c[b]={p:r[b],s:m[b]},o&&(c[b].orig_p=j[b],c[b][n+"End"]=k.ends[b],c[b][n+"Start"]=k.starts[b]),a.ids&&(c[b].id=String(a.ids[b]));return f(a,"marker")&&g(l,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),f(a,"marker.line")&&g(l,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}),h(c,a),i(c,a),c}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(b,a,c){"use strict";a.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(a,b,d){"use strict";var e=a("fast-isnumeric"),f=a("../../lib").isArrayOrTypedArray,g=a("../../constants/numerical").BADNUM,h=a("../../registry"),i=a("../../plots/cartesian/axes"),j=a("../../plots/cartesian/constraints").getAxisGroup,k=a("./sieve.js");function c(i,e,f,a,g){var b,c,d,h;if(a.length){switch(l(f,a),g.mode){case"overlay":m(e,f,a,g);break;case"group":for(d=0,b=[],c=[];d<a.length;d++)void 0===(h=a[d])[0].trace.offset?c.push(h):b.push(h);c.length&&n(i,e,f,c,g),b.length&&m(e,f,b,g);break;case"stack":case"relative":for(d=0,b=[],c=[];d<a.length;d++)void 0===(h=a[d])[0].trace.base?c.push(h):b.push(h);c.length&&o(i,e,f,c,g),b.length&&m(e,f,b,g);break}z(a,e)}}function l(i,j){var g,a;for(g=0;g<j.length;g++){var c,b=j[g],d=b[0].trace,h="funnel"===d.type?d._base:d.base,k="h"===d.orientation?d.xcalendar:d.ycalendar,l="category"===i.type||"multicategory"===i.type?function(){return null}:i.d2c;if(f(h)){for(a=0;a<Math.min(h.length,b.length);a++)e(c=l(h[a],0,k))?(b[a].b=+c,b[a].hasB=1):b[a].b=0;for(;a<b.length;a++)b[a].b=0}else{var m=e(c=l(h,0,k));for(a=0,c=m?c:0;a<b.length;a++)b[a].b=c,m&&(b[a].hasB=1)}}}function m(d,e,f,a){for(var c=0;c<f.length;c++){var g=f[c],b=new k([g],{posAxis:d,sepNegVal:!1,overlapNoMerge:!a.norm});p(d,b,a),a.norm?(w(b),y(e,b,a)):u(e,b)}}function n(e,c,d,f,b){var a=new k(f,{posAxis:c,sepNegVal:!1,overlapNoMerge:!b.norm});q(e,c,a,b),x(a,c),b.norm?(w(a),y(d,a,b)):u(d,a)}function o(l,h,i,d,a){var c=new k(d,{posAxis:h,sepNegVal:"relative"===a.mode,overlapNoMerge:!(a.norm||"stack"===a.mode||"relative"===a.mode)});p(h,c,a),v(i,c,a);for(var e=0;e<d.length;e++)for(var j=d[e],f=0;f<j.length;f++){var b=j[f];b.s!==g&&b.b+b.s===c.get(b.p,b.s)&&(b._outmost=!0)}a.norm&&y(i,c,a)}function p(e,a,f){for(var g=a.minDiff,c=a.traces,h=g*(1-f.gap),i=h*(1-(f.groupgap||0)),j=-i/2,d=0;d<c.length;d++){var b=c[d][0].t;b.barwidth=i,b.poffset=j,b.bargroupwidth=h,b.bardelta=g}a.binWidth=c[0][0].t.barwidth/100,r(a),s(e,a),t(e,a)}function q(v,h,a,m){for(var n=v._fullLayout,w=a.positions,x=a.distinctPositions,o=a.minDiff,b=a.traces,i=b.length,k=w.length!==x.length,c=o*(1-m.gap),y=j(n,h._id)+b[0][0].trace.orientation,z=n._alignmentOpts[y]||{},d=0;d<i;d++){var l,p,q=b[d],u=q[0].trace,A=z[u.alignmentgroup]||{},e=Object.keys(A.offsetGroups||{}).length,f=(l=e?c/e:k?c/i:c)*(1-(m.groupgap||0));p=e?((2*u._offsetIndex+1-e)*l-f)/2:k?((2*d+1-i)*l-f)/2:-f/2;var g=q[0].t;g.barwidth=f,g.poffset=p,g.bargroupwidth=c,g.bardelta=o}a.binWidth=b[0][0].t.barwidth/100,r(a),s(h,a),t(h,a,k)}function r(o){var m=o.traces;for(p=0;p<m.length;p++){var p,a,b,g=m[p],n=g[0],j=n.trace,c=n.t,h=j._offset||j.offset,k=c.poffset;if(f(h)){for(a=0,b=Array.prototype.slice.call(h,0,g.length);a<b.length;a++)e(b[a])||(b[a]=k);for(a=b.length;a<g.length;a++)b.push(k);c.poffset=b}else void 0!==h&&(c.poffset=h);var i=j._width||j.width,l=c.barwidth;if(f(i)){var d=Array.prototype.slice.call(i,0,g.length);for(a=0;a<d.length;a++)e(d[a])||(d[a]=l);for(a=d.length;a<g.length;a++)d.push(l);if(c.barwidth=d,void 0===h){for(a=0,b=[];a<g.length;a++)b.push(k+(l-d[a])/2);c.poffset=b}}else void 0!==i&&(c.barwidth=i,void 0===h&&(c.poffset=k+(l-i)/2))}}function s(i,j){for(var g=j.traces,k=A(i),b=0;b<g.length;b++)for(var c=g[b],h=c[0].t,d=h.poffset,l=Array.isArray(d),e=h.barwidth,m=Array.isArray(e),a=0;a<c.length;a++){var f=c[a],n=f.w=m?e[a]:e;f[k]=f.p+(l?d[a]:d)+n/2}}function t(g,c,r){var n=c.traces,o=c.minDiff/2;i.minDtick(g,c.minDiff,c.distinctPositions[0],r);for(var h=0;h<n.length;h++){var d,e,f,a,b=n[h],p=b[0],j=p.trace,k=[];for(a=0;a<b.length;a++)e=(d=b[a]).p-o,f=d.p+o,k.push(e,f);if(j.width||j.offset){var q=p.t,l=q.poffset,m=q.barwidth,s=Array.isArray(l),t=Array.isArray(m);for(a=0;a<b.length;a++){d=b[a];var u=s?l[a]:l,v=t?m[a]:m;f=(e=d.p+u)+v,k.push(e,f)}}j._extremes[g._id]=i.findExtremes(g,k,{padded:!1})}}function u(b,l){for(var g=l.traces,m=A(b),c=0;c<g.length;c++){for(var d=g[c],n=d[0].trace,e=[],h=!1,f=0;f<d.length;f++){var a=d[f],j=a.b,k=j+a.s;a[m]=k,e.push(k),a.hasB&&e.push(j),a.hasB&&a.b||(h=!0)}n._extremes[b._id]=i.findExtremes(b,e,{tozero:h,padded:!0})}}function v(c,d,h){var l=A(c),a=d.traces;for(p=0;p<a.length;p++)if("funnel"===(m=(n=a[p])[0].trace).type)for(q=0;q<n.length;q++)(b=n[q]).s!==g&&d.put(b.p,-0.5*b.s);for(p=0;p<a.length;p++){o="funnel"===(m=(n=a[p])[0].trace).type;var e=[];for(q=0;q<n.length;q++)if((b=n[q]).s!==g){j=o?b.s:b.s+b.b;var n,m,o,p,q,b,j,f=d.put(b.p,j),k=f+j;b.b=f,b[l]=k,!h.norm&&(e.push(k),b.hasB&&e.push(f))}h.norm||(m._extremes[c._id]=i.findExtremes(c,e,{tozero:!0,padded:!0}))}}function w(d){for(var e=d.traces,b=0;b<e.length;b++)for(var f=e[b],c=0;c<f.length;c++){var a=f[c];a.s!==g&&d.put(a.p,a.b+a.s)}}function x(h,i){for(var e=h.traces,c=0;c<e.length;c++){var b=e[c];if(void 0===b[0].trace.base)for(var j=new k([b],{posAxis:i,sepNegVal:!0,overlapNoMerge:!0}),d=0;d<b.length;d++){var a=b[d];if(a.p!==g){var f=j.put(a.p,a.b+a.s);f&&(a.b=f)}}}}function y(b,n,o){var p=n.traces,t=A(b),d="fraction"===o.norm?1:100,w=d/1e9,u=b.l2c(b.c2l(0)),x="stack"===o.mode?d:u;function q(a){return e(b.c2l(a))&&(a<u-w||a>x+w||!e(u))}for(var f=0;f<p.length;f++){for(var h=p[f],v=h[0].trace,j=[],r=!1,c=!1,k=0;k<h.length;k++){var a=h[k];if(a.s!==g){var s=Math.abs(d/n.get(a.p,a.s));a.b*=s,a.s*=s;var l=a.b,m=l+a.s;a[t]=m,j.push(m),c=c||q(m),a.hasB&&(j.push(l),c=c||q(l)),a.hasB&&a.b||(r=!0)}}v._extremes[b._id]=i.findExtremes(b,j,{tozero:r,padded:c})}}function z(h,p){var c,b,d,n=A(p),f={},i=1/0,j=-1/0;for(c=0;c<h.length;c++)for(b=0,d=h[c];b<d.length;b++){var k=d[b].p;e(k)&&(i=Math.min(i,k),j=Math.max(j,k))}var s=1e4/(j-i),q=f.round=function(a){return String(Math.round(s*(a-i)))};for(c=0;c<h.length;c++){(d=h[c])[0].t.extents=f;var l=d[0].t.poffset,r=Array.isArray(l);for(b=0;b<d.length;b++){var a=d[b],m=a[n]-a.w/2;if(e(m)){var o=a[n]+a.w/2,g=q(a.p);f[g]?f[g]=[Math.min(m,f[g][0]),Math.max(o,f[g][1])]:f[g]=[m,o]}a.p0=a.p+(r?l[b]:l),a.p1=a.p0+a.w,a.s0=a.b,a.s1=a.s0+a.s}}}function A(a){return a._id.charAt(0)}b.exports={crossTraceCalc:function(d,k){for(var g=k.xaxis,i=k.yaxis,j=d._fullLayout,l=d._fullData,m=d.calcdata,n=[],o=[],e=0;e<l.length;e++){var f=l[e];if(!0===f.visible&&h.traceIs(f,"bar")&&f.xaxis===g._id&&f.yaxis===i._id&&("h"===f.orientation?n.push(m[e]):o.push(m[e]),f._computePh))for(var b=d.calcdata[e],a=0;a<b.length;a++)"function"==typeof b[a].ph0&&(b[a].ph0=b[a].ph0()),"function"==typeof b[a].ph1&&(b[a].ph1=b[a].ph1())}var p={xCat:"category"===g.type||"multicategory"===g.type,yCat:"category"===i.type||"multicategory"===i.type,mode:j.barmode,norm:j.barnorm,gap:j.bargap,groupgap:j.bargroupgap};c(d,g,i,o,p),c(d,i,g,n,p)},setGroupPositions:c}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(a,b,f){"use strict";var c=a("../../lib"),g=a("../../components/color"),h=a("../../registry"),i=a("../scatter/xy_defaults"),j=a("../scatter/period_defaults"),k=a("./style_defaults"),l=a("../../plots/cartesian/constraints").getAxisGroup,m=a("./attributes"),n=c.coerceFont;function d(n,a,g,h){var i=a.orientation,j=l(g,a[({v:"x",h:"y"})[i]+"axis"])+i,k=g._alignmentOpts||{},m=h("alignmentgroup"),b=k[j];b||(b=k[j]={});var c=b[m];c?c.traces.push(a):c=b[m]={traces:[a],alignmentIndex:Object.keys(b).length,offsetGroups:{}};var d=h("offsetgroup"),e=c.offsetGroups,f=e[d];d&&(f||(f=e[d]={offsetIndex:Object.keys(e).length}),a._offsetIndex=f.offsetIndex)}function e(f,v,m,a,d,b){var o=!1!==(b=b||{}).moduleHasSelected,p=!1!==b.moduleHasUnselected,q=!1!==b.moduleHasConstrain,r=!1!==b.moduleHasCliponaxis,s=!1!==b.moduleHasTextangle,t=!1!==b.moduleHasInsideanchor,u=!!b.hasPathbar,g=Array.isArray(d)||"auto"===d,h=g||"inside"===d,i=g||"outside"===d;if(h||i){var e=n(a,"textfont",m.font),j=c.extendFlat({},e),k=!(f.textfont&&f.textfont.color);if(k&&delete j.color,n(a,"insidetextfont",j),u){var l=c.extendFlat({},e);k&&delete l.color,n(a,"pathbar.textfont",l)}i&&n(a,"outsidetextfont",e),o&&a("selected.textfont.color"),p&&a("unselected.textfont.color"),q&&a("constraintext"),r&&a("cliponaxis"),s&&a("textangle"),a("texttemplate")}h&&t&&a("insidetextanchor")}b.exports={supplyDefaults:function(d,b,o,f){function a(a,e){return c.coerce(d,b,m,a,e)}if(!i(d,b,f,a)){b.visible=!1;return}j(d,b,f,a),a("xhoverformat"),a("yhoverformat"),a("orientation",b.x&&!b.y?"h":"v"),a("base"),a("offset"),a("width"),a("text"),a("hovertext"),a("hovertemplate");var p=a("textposition");e(d,b,f,a,p,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),k(d,b,a,o,f);var l=(b.marker.line||{}).color,n=h.getComponentMethod("errorbars","supplyDefaults");n(d,b,l||g.defaultLine,{axis:"y"}),n(d,b,l||g.defaultLine,{axis:"x",inherit:"y"}),c.coerceSelectionMarkerOpacity(b,a)},crossTraceDefaults:function(e,f){var a;function g(b){return c.coerce(a._input,a,m,b)}if("group"===f.barmode)for(var b=0;b<e.length;b++)"bar"===(a=e[b]).type&&d(a._input,a,f,g)},handleGroupingDefaults:d,handleText:e}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(b,a,c){"use strict";a.exports=function(a,b,c){return a.x="xVal"in b?b.xVal:b.x,a.y="yVal"in b?b.yVal:b.y,b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),"h"===c.orientation?(a.label=a.y,a.value=a.x):(a.label=a.x,a.value=a.y),a}},{}],663:[function(b,c,a){"use strict";var d=b("fast-isnumeric"),e=b("tinycolor2"),f=b("../../lib").isArrayOrTypedArray;a.coerceString=function(b,a,c){if("string"==typeof a){if(a||!b.noBlank)return a}else if(("number"==typeof a|| !0===a)&&!b.strict)return String(a);return void 0!==c?c:b.dflt},a.coerceNumber=function(b,a,c){if(d(a)){a=+a;var e=b.min,f=b.max;if(!(void 0!==e&&a<e|| void 0!==f&&a>f))return a}return void 0!==c?c:b.dflt},a.coerceColor=function(c,a,b){return e(a).isValid()?a:void 0!==b?b:c.dflt},a.coerceEnumerated=function(b,a,c){return(b.coerceNumber&&(a=+a),-1!==b.values.indexOf(a))?a:void 0!==c?c:b.dflt},a.getValue=function(a,c){var b;return Array.isArray(a)?c<a.length&&(b=a[c]):b=a,b},a.getLineWidth=function(a,b){return 0<b.mlw?b.mlw:f(a.marker.line.width)?0:a.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(a,b,e){"use strict";var f=a("../../components/fx"),g=a("../../registry"),h=a("../../components/color"),i=a("../../lib").fillText,j=a("./helpers").getLineWidth,k=a("../../plots/cartesian/axes").hoverLabelText,l=a("../../constants/numerical").BADNUM;function c(a,v,w,x,N){var y,o,c,d,p,q,H,h=a.cd,e=h[0].trace,z=h[0].t,j="closest"===x,O="waterfall"===e.type,P=a.maxHoverDistance,A=a.maxSpikeDistance;"h"===e.orientation?(y=w,o=v,c="y",d="x",p=T,q=S):(y=v,o=w,c="x",d="y",q=T,p=S);var r=e[c+"period"];function B(a){return Q(a,-1)}function C(a){return Q(a,1)}function Q(a,b){var d=a.w;return a[c]+b*d/2}function R(a){return a[c+"End"]-a[c+"Start"]}var D=j?B:r?function(a){return a.p-R(a)/2}:function(a){return Math.min(B(a),a.p-z.bardelta/2)},E=j?C:r?function(a){return a.p+R(a)/2}:function(a){return Math.max(C(a),a.p+z.bardelta/2)};function I(a,b,c){return N.finiteRange&&(c=0),f.inbox(a-y,b-y,c+Math.min(1,Math.abs(b-a)/H)-1)}function S(a){return I(D(a),E(a),P)}function J(b){var a=b[d];if(O){var c=Math.abs(b.rawS)||0;o>0?a+=c:o<0&&(a-=c)}return a}function T(c){var a=o,d=c.b,b=J(c);return f.inbox(d-a,b-a,P+(b-a)/(b-d)-1)}var g=a[c+"a"],s=a[d+"a"];H=Math.abs(g.r2c(g.range[1])-g.r2c(g.range[0]));var K=f.getDistanceFunction(x,p,q,function(a){return(p(a)+q(a))/2});if(f.getClosest(h,K,a),!1!==a.index&&h[a.index].p!==l){j||r||(D=function(a){return Math.min(B(a),a.p-z.bargroupwidth/2)},E=function(a){return Math.max(C(a),a.p+z.bargroupwidth/2)});var b=h[a.index],L=e.base?b.b+b.s:b.s;a[d+"0"]=a[d+"1"]=s.c2p(b[d],!0),a[d+"LabelVal"]=L;var F=z.extents[z.extents.round(b.p)];a[c+"0"]=g.c2p(j?D(b):F[0],!0),a[c+"1"]=g.c2p(j?E(b):F[1],!0);var t,m,u,n,G,M=void 0!==b.orig_p;return a[c+"LabelVal"]=M?b.orig_p:b.p,a.labelLabel=k(g,a[c+"LabelVal"],e[c+"hoverformat"]),a.valueLabel=k(s,a[d+"LabelVal"],e[d+"hoverformat"]),a.baseLabel=k(s,b.b,e[d+"hoverformat"]),a.spikeDistance=(t=b,m=o,u=t.b,n=J(t),(f.inbox(u-m,n-m,A+(n-m)/(n-u)-1)+I(B(G=b),C(G),A))/2),a[c+"Spike"]=g.c2p(b.p,!0),i(b,e,a),a.hovertemplate=e.hovertemplate,a}}function d(a,b){var c=b.mcc||a.marker.color,d=b.mlcc||a.marker.line.color,e=j(a,b);return h.opacity(c)?c:h.opacity(d)&&e?d:void 0}b.exports={hoverPoints:function(h,i,j,k,l){var a=c(h,i,j,k,l);if(a){var b=a.cd,e=b[0].trace,f=b[a.index];return a.color=d(e,f),g.getComponentMethod("errorbars","hoverInfo")(f,e,a),[a]}},hoverOnBars:c,getTraceColor:d}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc").crossTraceCalc,colorbar:a("../scatter/marker_colorbar"),arraysToCalcdata:a("./arrays_to_calcdata"),plot:a("./plot").plot,style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"bar",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(b,a,c){"use strict";a.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../plots/cartesian/axes"),f=a("../../lib"),g=a("./layout_attributes");b.exports=function(p,h,i){function b(a,b){return f.coerce(p,h,g,a,b)}for(var j=!1,k=!1,l=!1,m={},n=b("barmode"),c=0;c<i.length;c++){var a=i[c];if(d.traceIs(a,"bar")&&a.visible){if(j=!0,"group"===n){var o=a.xaxis+a.yaxis;m[o]&&(l=!0),m[o]=!0}a.visible&&"histogram"===a.type&&"category"!==e.getFromId({_fullLayout:h},a["v"===a.orientation?"xaxis":"yaxis"]).type&&(k=!0)}}if(!j){delete h.barmode;return}"overlay"!==n&&b("barnorm"),b("bargap",k&&!l?0:.2),b("bargroupgap")}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(a,d,g){"use strict";var h=a("@plotly/d3"),i=a("fast-isnumeric"),j=a("../../lib"),k=a("../../lib/svg_text_utils"),l=a("../../components/color"),m=a("../../components/drawing"),n=a("../../registry"),o=a("../../plots/cartesian/axes").tickText,b=a("./uniform_text"),p=b.recordMinTextSize,q=b.clearMinTextSize,r=a("./style"),s=a("./helpers"),e=a("./constants"),c=a("./attributes"),t=c.text,u=c.textposition,v=a("../../components/fx/helpers").appendArrayPointValue,w=e.TEXTPAD;function x(a){return a.id}function y(a,b){return a<b?1:-1}function z(b,d,a,c){var e;return!d.uniformtext.mode&&A(a)?(c&&(e=c()),b.transition().duration(a.duration).ease(a.easing).each("end",function(){e&&e()}).each("interrupt",function(){e&&e()})):b}function A(a){return a&&a.duration>0}function B(a){return"auto"===a?0:a}function C(a,e){var b=Math.PI/180*e,c=Math.abs(Math.sin(b)),d=Math.abs(Math.cos(b));return{x:a.width*d+a.height*c,y:a.width*c+a.height*d}}function f(g,h,i,j,b,f){var o=!!f.isHorizontal,E=!!f.constrained,x=f.angle||0,z=f.anchor||"end",p="start"===z,q=((f.leftToRight||0)+1)/2,A=1-q,k=b.width,l=b.height,c=Math.abs(h-g),d=Math.abs(j-i),e=c>2*w&&d>2*w?w:0;c-=2*e,d-=2*e;var r=B(x);"auto"===x&&!(k<=c&&l<=d)&&(k>c||l>d)&&(!(k>d||l>c)||k<l!=c<d)&&(r+=90);var m=C(b,r),D=1;E&&(D=Math.min(1,c/m.x,d/m.y));var F=b.left*A+b.right*q,G=(b.top+b.bottom)/2,s=(g+w)*A+(h-w)*q,t=(i+j)/2,u=0,v=0;if(p||"end"===z){var n=(o?m.x:m.y)/2,a=o?y(g,h):y(i,j);o?p?(s=g+a*e,u=-a*n):(s=h-a*e,u=a*n):p?(t=i+a*e,v=-a*n):(t=j-a*e,v=a*n)}return{textX:F,textY:G,targetX:s,targetY:t,anchorX:u,anchorY:v,scale:D,rotate:r}}d.exports={plot:function(d,b,e,g,c,E){var F=b.xaxis,G=b.yaxis,a=d._fullLayout;c||(c={mode:a.barmode,norm:a.barmode,gap:a.bargap,groupgap:a.bargroupgap},q("bar",a));var D=j.makeTraceGroups(g,e,"trace bars").each(function(q){var n=h.select(this),e=q[0].trace,D="waterfall"===e.type,H="funnel"===e.type,I="bar"===e.type,N=I||H,J=0;D&&e.connector.visible&&"between"===e.connector.mode&&(J=e.connector.line.width/2);var O="h"===e.orientation,P=A(c),K=j.ensureSingle(n,"g","points"),L=function(a){if(a.ids)return x}(e),g=K.selectAll("g.point").data(j.identity,L);g.enter().append("g").classed("point",!0),g.exit().remove(),g.each(function(H,_){var R,S,I,T,U,V,K,L,W,X,Y=h.select(this),M=(I=H,T=F,U=G,K=[],L=[],W=(V=O)?T:U,X=V?U:T,K[0]=W.c2p(I.s0,!0),L[0]=X.c2p(I.p0,!0),K[1]=W.c2p(I.s1,!0),L[1]=X.c2p(I.p1,!0),V?[K,L]:[L,K]),n=M[0][0],x=M[0][1],g=M[1][0],A=M[1][1],D=(O?x-n:A-g)==0;if(D&&N&&s.getLineWidth(e,H)&&(D=!1),D||(D=!i(n)||!i(x)||!i(g)||!i(A)),H.isBlank=D,D&&(O?x=n:A=g),J&&!D&&(O?(n-=y(n,x)*J,x+=y(n,x)*J):(g-=y(g,A)*J,A+=y(g,A)*J)),"waterfall"===e.type){if(!D){var Z=e[H.dir].marker;R=Z.line.width,S=Z.color}}else R=s.getLineWidth(e,H),S=H.mc||e.marker.color;function aa(a){var b=h.round(R/2%1,2);return 0===c.gap&&0===c.groupgap?h.round(Math.round(a)-b,2):a}if(!d._context.staticPlot){var Q=1>l.opacity(S)||R>.01?aa:function(a,b,c){return c&&a===b?a:Math.abs(a-b)>=2?aa(a):a>b?Math.ceil(a):Math.floor(a)};n=Q(n,x,O),x=Q(x,n,O),g=Q(g,A,!O),A=Q(A,g,!O)}var $=z(j.ensureSingle(Y,"path"),a,c,E);if($.style("vector-effect","non-scaling-stroke").attr("d",isNaN((x-n)*(A-g))||D&&d._context.staticPlot?"M0,0Z":"M"+n+","+g+"V"+A+"H"+x+"V"+g+"Z").call(m.setClipUrl,b.layerClipId,d),!a.uniformtext.mode&&P){var ab=m.makePointStyleFns(e);m.singlePointStyle(H,$,e,ab,d)}(function(U,al,G,H,h,n,I,q,J,V,aD){var a,c,i,d,e,W,K,x=al.xaxis,A=al.yaxis,L=U._fullLayout;function am(b,c,d){return j.ensureSingle(b,"text").text(c).attr({"class":"bartext bartext-"+a,"text-anchor":"middle","data-notex":1}).call(m.font,d).call(k.convertToTspans,U)}var an,M,N,X,Y,ao,Z,ap,aq,ar,b=H[0].trace,O="h"===b.orientation,$=(an=L,M=H,N=h,X=x,Y=A,ao=(Z=M[0].trace).texttemplate?function(w,m,n,p,q){var i,g,k,r,d=m[0].trace,s=j.castOption(d,n,"texttemplate");if(!s)return"";var h="histogram"===d.type,x="waterfall"===d.type,y="funnel"===d.type,e="h"===d.orientation;function f(a){return o(r,r.c2l(a),!0).text}e?(i="y",g=q,k="x",r=p):(i="x",g=p,k="y",r=q);var t,b=m[n],a={};a.label=b.p,a.labelLabel=a[i+"Label"]=(t=b.p,o(g,g.c2l(t),!0).text);var l=j.castOption(d,b.i,"text");(0===l||l)&&(a.text=l),a.value=b.s,a.valueLabel=a[k+"Label"]=f(b.s);var c={};v(c,d,b.i),(h|| void 0===c.x)&&(c.x=e?a.value:a.label),(h|| void 0===c.y)&&(c.y=e?a.label:a.value),(h|| void 0===c.xLabel)&&(c.xLabel=e?a.valueLabel:a.labelLabel),(h|| void 0===c.yLabel)&&(c.yLabel=e?a.labelLabel:a.valueLabel),x&&(a.delta=+b.rawS||b.s,a.deltaLabel=f(a.delta),a.final=b.v,a.finalLabel=f(a.final),a.initial=a.final-a.delta,a.initialLabel=f(a.initial)),y&&(a.value=b.s,a.valueLabel=f(a.value),a.percentInitial=b.begR,a.percentInitialLabel=j.formatPercent(b.begR),a.percentPrevious=b.difR,a.percentPreviousLabel=j.formatPercent(b.difR),a.percentTotal=b.sumR,a.percenTotalLabel=j.formatPercent(b.sumR));var u=j.castOption(d,b.i,"customdata");return u&&(a.customdata=u),j.texttemplateString(s,a,w._d3locale,c,a,d._meta||{})}(an,M,N,X,Y):Z.textinfo?function(h,k,n,p){var a,e=h[0].trace,q="h"===e.orientation,r="waterfall"===e.type,s="funnel"===e.type;function f(a){return o(q?n:p,+a,!0).text}var t=e.textinfo,d=h[k],v=t.split("+"),c=[],b=function(a){return -1!==v.indexOf(a)};if(b("label")&&c.push(o(q?p:n,h[k].p,!0).text),b("text")&&(0===(a=j.castOption(e,d.i,"text"))||a)&&c.push(a),r){var l=+d.rawS||d.s,m=d.v,u=m-l;b("initial")&&c.push(f(u)),b("delta")&&c.push(f(l)),b("final")&&c.push(f(m))}if(s){b("value")&&c.push(f(d.s));var g=0;b("percent initial")&&g++,b("percent previous")&&g++,b("percent total")&&g++;var i=g>1;b("percent initial")&&(a=j.formatPercent(d.begR),i&&(a+=" of initial"),c.push(a)),b("percent previous")&&(a=j.formatPercent(d.difR),i&&(a+=" of previous"),c.push(a)),b("percent total")&&(a=j.formatPercent(d.sumR),i&&(a+=" of total"),c.push(a))}return c.join("<br>")}(M,N,X,Y):s.getValue(Z.text,N),s.coerceString(t,ao));a=(ap=b,aq=h,ar=s.getValue(ap.textposition,aq),s.coerceEnumerated(u,ar));var aE="stack"===V.mode||"relative"===V.mode,P=H[h],as=!aE||P._outmost;if(!$||"none"===a||(P.isBlank||n===I||q===J)&&("auto"===a||"inside"===a)){G.select("text").remove();return}var at=L.font,aF=r.getBarColor(H[h],b),au=r.getInsideTextFont(b,h,at,aF),aG=r.getOutsideTextFont(b,h,at),av=G.datum();O?"log"===x.type&&av.s0<=0&&(n=x.range[0]<x.range[1]?0:x._length):"log"===A.type&&av.s0<=0&&(q=A.range[0]<A.range[1]?A._length:0);var Q=Math.abs(I-n)-2*w,R=Math.abs(J-q)-2*w;if("outside"!==a||as||P.hasB||(a="inside"),"auto"===a)if(as){a="inside",c=am(G,$,W=j.ensureUniformFontSize(U,au)),d=(i=m.bBox(c.node())).width,e=i.height;var aH=d>0&&e>0,aI=d<=Q&&e<=R,aJ=d<=R&&e<=Q,aK=O?Q>=d*(R/e):R>=e*(Q/d);aH&&(aI||aJ||aK)?a="inside":(a="outside",c.remove(),c=null)}else a="inside";if(!c){var aL=(c=am(G,$,W=j.ensureUniformFontSize(U,"outside"===a?aG:au))).attr("transform");if(c.attr("transform",""),d=(i=m.bBox(c.node())).width,e=i.height,c.attr("transform",aL),d<=0||e<=0){c.remove();return}}var S,D,T,E,g,_,aa,l,aw,ax,ay,az,ab,ac,ad,ae,af,ag,aA,aB,ah,ai,aj,ak,F,aC=b.textangle;(K="outside"===a?(S=n,D=I,T=q,E=J,g=i,l=!!(_={isHorizontal:O,constrained:"both"===b.constraintext||"outside"===b.constraintext,angle:aC}).isHorizontal,aw=!!_.constrained,ax=_.angle||0,ay=g.width,az=g.height,ab=Math.abs(D-S),ac=Math.abs(E-T),aa=l?ac>2*w?w:0:ab>2*w?w:0,ad=1,aw&&(ad=l?Math.min(1,ac/az):Math.min(1,ab/ay)),ae=B(ax),af=C(g,ae),ag=(l?af.x:af.y)/2,aA=(g.left+g.right)/2,aB=(g.top+g.bottom)/2,ah=(S+D)/2,ai=(T+E)/2,aj=0,ak=0,F=l?y(D,S):y(T,E),l?(ah=D-F*aa,aj=F*ag):(ai=E+F*aa,ak=-F*ag),{textX:aA,textY:aB,targetX:ah,targetY:ai,anchorX:aj,anchorY:ak,scale:ad,rotate:ae}):f(n,I,q,J,i,{isHorizontal:O,constrained:"both"===b.constraintext||"inside"===b.constraintext,angle:aC,anchor:b.insidetextanchor})).fontSize=W.size,p("histogram"===b.type?"bar":b.type,K,L),P.transform=K;var aM=z(c,L,V,aD);j.setTransormAndDisplay(aM,K)})(d,b,Y,q,_,n,x,g,A,c,E),b.layerClipId&&m.hideOutsideRangePoint(H,Y.select("text"),F,G,e.xcalendar,e.ycalendar)});var M=!1===e.cliponaxis;m.setClipUrl(n,M?null:b.layerClipId,d)});n.getComponentMethod("errorbars","plot")(d,D,b,c)},toMoveInsideBar:f}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(b,a,c){"use strict";function d(a,e,f,b,i){var g=e.c2p(b?a.s0:a.p0,!0),c=e.c2p(b?a.s1:a.p1,!0),h=f.c2p(b?a.p0:a.s0,!0),d=f.c2p(b?a.p1:a.s1,!0);return i?[(g+c)/2,(h+d)/2]:b?[c,(h+d)/2]:[(g+c)/2,d]}a.exports=function(e,f){var a,c=e.cd,g=e.xaxis,h=e.yaxis,i=c[0].trace,k="funnel"===i.type,l="h"===i.orientation,j=[];if(!1===f)for(a=0;a<c.length;a++)c[a].selected=0;else for(a=0;a<c.length;a++){var b=c[a],m="ct"in b?b.ct:d(b,g,h,l,k);f.contains(m,!1,a,e)?(j.push({pointNumber:a,x:g.c2d(b.x),y:h.c2d(b.y)}),b.selected=1):b.selected=0}return j}},{}],670:[function(b,c,d){"use strict";c.exports=a;var e=b("../../lib").distinctVals,f=b("../../constants/numerical").BADNUM;function a(c,d){this.traces=c,this.sepNegVal=d.sepNegVal,this.overlapNoMerge=d.overlapNoMerge;for(var a=1/0,g=[],h=0;h<c.length;h++){for(var b=c[h],i=0;i<b.length;i++){var k=b[i];k.p!==f&&g.push(k.p)}b[0]&&b[0].width1&&(a=Math.min(b[0].width1,a))}this.positions=g;var j=e(g);this.distinctPositions=j.vals,1===j.vals.length&&a!==1/0?this.minDiff=a:this.minDiff=Math.min(j.minDiff,a);var l=(d.posAxis||{}).type;("category"===l||"multicategory"===l)&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}a.prototype.put=function(d,a){var b=this.getLabel(d,a),c=this.bins[b]||0;return this.bins[b]=c+a,c},a.prototype.get=function(a,b){var c=this.getLabel(a,b);return this.bins[c]||0},a.prototype.getLabel=function(a,b){return(b<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?a:Math.round(a/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(a,c,i){"use strict";var j=a("@plotly/d3"),k=a("../../components/color"),l=a("../../components/drawing"),m=a("../../lib"),n=a("../../registry"),d=a("./uniform_text").resizeText,b=a("./attributes"),o=b.textfont,p=b.insidetextfont,q=b.outsidetextfont,r=a("./helpers");function s(a,b,c){l.pointStyle(a.selectAll("path"),b,c),e(a,b,c)}function e(a,b,c){a.selectAll("text").each(function(d){var a=j.select(this),e=m.ensureUniformFontSize(c,t(a,d,b,c));l.font(a,e)})}function t(d,b,a,i){var e=i._fullLayout.font,c=a.textfont;if(d.classed("bartext-inside")){var j=h(b,a);c=f(a,b.i,e,j)}else d.classed("bartext-outside")&&(c=g(a,b.i,e));return c}function u(a,b,c){return v(o,a.textfont,b,c)}function f(a,c,d,e){var b=u(a,c,d);return(void 0===a._input.textfont|| void 0===a._input.textfont.color||Array.isArray(a.textfont.color)&& void 0===a.textfont.color[c])&&(b={color:k.contrast(e),family:b.family,size:b.size}),v(p,a.insidetextfont,c,b)}function g(a,b,c){var d=u(a,b,c);return v(q,a.outsidetextfont,b,d)}function v(b,a,c,d){a=a||{};var e=r.getValue(a.family,c),f=r.getValue(a.size,c),g=r.getValue(a.color,c);return{family:r.coerceString(b.family,e,d.family),size:r.coerceNumber(b.size,f,d.size),color:r.coerceColor(b.color,g,d.color)}}function h(a,b){return"waterfall"===b.type?b[a.dir].marker.color:a.mcc||a.mc||b.marker.color}c.exports={style:function(b){var a=j.select(b).selectAll("g.barlayer").selectAll("g.trace");d(b,a,"bar");var c=a.size(),e=b._fullLayout;a.style("opacity",function(a){return a[0].trace.opacity}).each(function(a){("stack"===e.barmode&&c>1||0===e.bargap&&0===e.bargroupgap&&!a[0].trace.marker.line.width)&&j.select(this).attr("shape-rendering","crispEdges")}),a.selectAll("g.points").each(function(a){s(j.select(this),a[0].trace,b)}),n.getComponentMethod("errorbars","style")(a)},styleTextPoints:e,styleOnSelect:function(e,g,a){var b,c,f,d=g[0].trace;d.selectedpoints?(b=a,c=d,f=e,l.selectedPointStyle(b.selectAll("path"),c),function(a,b,c){a.each(function(e){var a,d=j.select(this);if(e.selected){a=m.ensureUniformFontSize(c,t(d,e,b,c));var f=b.selected.textfont&&b.selected.textfont.color;f&&(a.color=f),l.font(d,a)}else l.selectedTextStyle(d,b)})}(b.selectAll("text"),c,f)):(s(a,d,e),n.getComponentMethod("errorbars","style")(a))},getInsideTextFont:f,getOutsideTextFont:g,getBarColor:h,resizeText:d}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults"),g=a("../../lib").coercePattern;b.exports=function(b,c,a,j,h){var k=a("marker.color",j),i=e(b,"marker");i&&f(b,c,h,a,{prefix:"marker.",cLetter:"c"}),a("marker.line.color",d.defaultLine),e(b,"marker.line")&&f(b,c,h,a,{prefix:"marker.line.",cLetter:"c"}),a("marker.line.width"),a("marker.opacity"),g(a,"marker.pattern",k,i),a("selected.marker.color"),a("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib");function f(a){return"_"+a+"Text_minsize"}b.exports={recordMinTextSize:function(g,b,a){if(a.uniformtext.mode){var c=f(g),d=a.uniformtext.minsize,e=b.scale*b.fontSize;b.hide=e<d,a[c]=a[c]||1/0,b.hide||(a[c]=Math.min(a[c],Math.max(e,d)))}},clearMinTextSize:function(a,b){b[f(a)]=void 0},resizeText:function(f,g,b){var c=f._fullLayout,h=c["_"+b+"Text_minsize"];if(h){var a,i="hide"===c.uniformtext.mode;switch(b){case"funnelarea":case"pie":case"sunburst":a="g.slice";break;case"treemap":case"icicle":a="g.slice, g.pathbar";break;default:a="g.points > g.point"}g.selectAll(a).each(function(b){var a=b.transform;if(a){a.scale=i&&a.hide?0:h/a.fontSize;var c=d.select(this).select("text");e.setTransormAndDisplay(c,a)}})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(d,e,g){"use strict";var f=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../lib/extend").extendFlat,a=d("../scatterpolar/attributes"),b=d("../bar/attributes");e.exports={r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,base:c({},b.base,{}),offset:c({},b.offset,{}),width:c({},b.width,{}),text:c({},b.text,{}),hovertext:c({},b.hovertext,{}),marker:b.marker,hoverinfo:a.hoverinfo,hovertemplate:f(),selected:b.selected,unselected:b.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(a,b,c){"use strict";var d=a("../../components/colorscale/helpers").hasColorscale,e=a("../../components/colorscale/calc"),f=a("../bar/arrays_to_calcdata"),g=a("../bar/cross_trace_calc").setGroupPositions,h=a("../scatter/calc_selection"),i=a("../../registry").traceIs,j=a("../../lib").extendFlat;b.exports={calc:function(g,a){for(var i=g._fullLayout,j=a.subplot,n=i[j].radialaxis,k=i[j].angularaxis,o=n.makeCalcdata(a,"r"),p=k.makeCalcdata(a,"theta"),l=a._length,c=new Array(l),q=o,r=p,b=0;b<l;b++)c[b]={p:r[b],s:q[b]};function m(b){var c=a[b];void 0!==c&&(a["_"+b]=Array.isArray(c)?k.makeCalcdata(a,b):k.d2c(c,a.thetaunit))}return"linear"===k.type&&(m("width"),m("offset")),d(a,"marker")&&e(g,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),d(a,"marker.line")&&e(g,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}),f(c,a),h(c,a),c},crossTraceCalc:function(d,a,k){for(var e=d.calcdata,f=[],b=0;b<e.length;b++){var h=e[b],c=h[0].trace;!0===c.visible&&i(c,"bar")&&c.subplot===k&&f.push(h)}var l=j({},a.radialaxis,{_id:"x"}),m=a.angularaxis;g(d,m,l,f,{mode:a.barmode,norm:a.barnorm,gap:a.bargap,groupgap:a.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatterpolar/defaults").handleRThetaDefaults,f=a("../bar/style_defaults"),g=a("./attributes");b.exports=function(c,b,i,h){function a(a,e){return d.coerce(c,b,g,a,e)}if(!e(c,b,h,a)){b.visible=!1;return}a("thetaunit"),a("base"),a("offset"),a("width"),a("text"),a("hovertext"),a("hovertemplate"),f(c,b,a,i,h),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(a,b,d){"use strict";var e=a("../../components/fx"),c=a("../../lib"),f=a("../bar/hover").getTraceColor,g=c.fillText,h=a("../scatterpolar/hover").makeHoverPointText,i=a("../../plots/polar/helpers").isPtInsidePolygon;b.exports=function(a,k,l){var m=a.cd,d=m[0].trace,j=a.subplot,n=j.radialAxis,o=j.angularAxis,p=j.vangles,s=p?i:c.isPtInsideSector,t=a.maxHoverDistance,u=o._period||2*Math.PI,v=Math.abs(n.g2p(Math.sqrt(k*k+l*l))),q=Math.atan2(l,k);if(n.range[0]>n.range[1]&&(q+=Math.PI),e.getClosest(m,function(a){return s(v,q,[a.rp0,a.rp1],[a.thetag0,a.thetag1],p)?t+Math.min(1,Math.abs(a.thetag1-a.thetag0)/u)-1+(a.rp1-v)/(a.rp1-a.rp0)-1:1/0},a),!1!==a.index){var b=m[a.index];a.x0=a.x1=b.ct[0],a.y0=a.y1=b.ct[1];var r=c.extendFlat({},b,{r:b.s,theta:b.p});return g(b,d,a),h(r,d,j,a),a.hovertemplate=d.hovertemplate,a.color=f(d,b),a.xLabelVal=a.yLabelVal=void 0,b.s<0&&(a.idealAlign="left"),[a]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"barpolar",basePlotModule:a("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("../scatterpolar/format_labels"),style:a("../bar/style").style,styleOnSelect:a("../bar/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(b,a,c){"use strict";a.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(i,j,c){var f,g={};function h(a,b){return d.coerce(i[f]||{},j[f],e,a,b)}for(var a=0;a<c.length;a++){var b=c[a];"barpolar"!==b.type|| !0!==b.visible||g[f=b.subplot]||(h("barmode"),h("bargap"),g[f]=1)}}},{"../../lib":515,"./layout_attributes":679}],681:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../components/drawing"),h=a("../../plots/polar/helpers");b.exports=function(l,a,c){var b,i,j,m=a.xaxis,n=a.yaxis,o=a.radialAxis,p=a.angularAxis,q=(i=(b=a).cxx,j=b.cyy,b.vangles?function(g,k,a,c){f.angleDelta(a,c)>0?(d=a,e=c):(d=c,e=a);var d,e,l=h.findEnclosingVertexAngles(d,b.vangles)[0],m=h.findEnclosingVertexAngles(e,b.vangles)[1],n=[l,(d+e)/2,m];return h.pathPolygonAnnulus(g,k,d,e,n,i,j)}:function(a,b,c,d){return f.pathAnnulus(a,b,c,d,i,j)}),k=a.layers.frontplot.select("g.barlayer");f.makeTraceGroups(k,c,"trace bars").each(function(){var c=d.select(this),b=f.ensureSingle(c,"g","points").selectAll("g.point").data(f.identity);b.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),b.exit().remove(),b.each(function(a){var g,l=d.select(this),h=a.rp0=o.c2p(a.s0),i=a.rp1=o.c2p(a.s1),b=a.thetag0=p.c2g(a.p0),c=a.thetag1=p.c2g(a.p1);if(e(h)&&e(i)&&e(b)&&e(c)&&h!==i&&b!==c){var j=o.c2g(a.s1),k=(b+c)/2;a.ct=[m.c2p(j*Math.cos(k)),n.c2p(j*Math.sin(k))],g=q(h,i,b,c)}else g="M0,0Z";f.ensureSingle(l,"path").attr("d",g)}),g.setClipUrl(c,a._hasClipOnAxisFalse?a.clipIds.forTraces:null,l)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(c,h,k){"use strict";var a=c("../scatter/attributes"),e=c("../bar/attributes"),i=c("../../components/color/attributes"),f=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,j=c("../../plots/template_attributes").hovertemplateAttrs,b=c("../../lib/extend").extendFlat,d=a.marker,g=d.line;h.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:f("x"),yhoverformat:f("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:b({},d.symbol,{arrayOk:!1,editType:"plot"}),opacity:b({},d.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:b({},d.angle,{arrayOk:!1,editType:"calc"}),size:b({},d.size,{arrayOk:!1,editType:"calc"}),color:b({},d.color,{arrayOk:!1,editType:"style"}),line:{color:b({},g.color,{arrayOk:!1,dflt:i.defaultLine,editType:"style"}),width:b({},g.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:e.offsetgroup,alignmentgroup:e.alignmentgroup,selected:{marker:a.selected.marker,editType:"style"},unselected:{marker:a.unselected.marker,editType:"style"},text:b({},a.text,{}),hovertext:b({},a.hovertext,{}),hovertemplate:j({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(a,b,d){"use strict";var e=a("fast-isnumeric"),f=a("../../plots/cartesian/axes"),g=a("../../plots/cartesian/align_period"),c=a("../../lib"),h=a("../../constants/numerical").BADNUM,i=c._;function j(c,e){for(var a=c.length,d=new Array(a+1),b=0;b<a;b++)d[b]=c[b]-e;return d[a]=c[a-1]+e,d}function k(b){for(var c=new Array(b),a=0;a<b;a++)c[a]=[];return c}b.exports=function(w,b){var K=w._fullLayout,aa=f.getFromId(w,b.xaxis||"x"),ab=f.getFromId(w,b.yaxis||"y"),A=[],L="violin"===b.type?"_numViolins":"_numBoxes";"h"===b.orientation?(C=aa,H="x",ap=ab,Q="y",an=!!b.yperiodalignment):(C=ab,H="y",ap=aa,Q="x",an=!!b.xperiodalignment);var ac=function(a,d,b,m){var f,i=d+"0" in a;if(d in a||i&&"d"+d in a){var j=b.makeCalcdata(a,d);return[g(a,b,d,j).vals,j]}f=i?a[d+"0"]:"name"in a&&("category"===b.type||e(a.name)&& -1!==["linear","log"].indexOf(b.type)||c.isDateTime(a.name)&&"date"===b.type)?a.name:m;for(var n="multicategory"===b.type?b.r2c_just_indices(f):b.d2c(f,0,a[d+"calendar"]),k=a._length,l=new Array(k),h=0;h<k;h++)l[h]=n;return[l]}(b,Q,ap,K[L]),M=ac[0],ad=ac[1],ae=c.distinctVals(M,ap),N=ae.vals,af=ae.minDiff/2,ag="all"===(b.boxpoints||b.points)?c.identity:function(b){return b.v<a.lf||b.v>a.uf};if(b._hasPreCompStats){var G=b[H],x=function(a){return C.d2c((b[a]||[])[v])},O=1/0,P=-1/0;for(v=0;v<b._length;v++){var v,B,C,H,ap,Q,an,a,y,d,l,I,J,z,ah=M[v];if(e(ah)){if((a={}).pos=a[Q]=ah,an&&ad&&(a.orig_p=ad[v]),a.q1=x("q1"),a.med=x("median"),a.q3=x("q3"),y=[],G&&c.isArrayOrTypedArray(G[v]))for(B=0;B<G[v].length;B++)(J=C.d2c(G[v][B]))!==h&&(m(I={v:J,i:[v,B]},b,[v,B]),y.push(I));if(a.pts=y.sort(o),l=(d=a[H]=y.map(p)).length,a.med!==h&&a.q1!==h&&a.q3!==h&&a.med>=a.q1&&a.q3>=a.med){var R=x("lowerfence");a.lf=R!==h&&R<=a.q1?R:q(a,d,l);var S=x("upperfence");a.uf=S!==h&&S>=a.q3?S:r(a,d,l);var T=x("mean");a.mean=T!==h?T:l?c.mean(d,l):(a.q1+a.q3)/2;var ai=x("sd");a.sd=T!==h&&ai>=0?ai:l?c.stdev(d,l,a.mean):a.q3-a.q1,a.lo=s(a),a.uo=t(a);var D=x("notchspan");D=D!==h&&D>0?D:u(a,l),a.ln=a.med-D,a.un=a.med+D;var E=a.lf,F=a.uf;b.boxpoints&&d.length&&(E=Math.min(E,d[0]),F=Math.max(F,d[l-1])),b.notched&&(E=Math.min(E,a.ln),F=Math.max(F,a.un)),a.min=E,a.max=F}else c.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+a.q1,"median = "+a.med,"q3 = "+a.q3].join("\n")),z=a.med!==h?a.med:a.q1!==h?a.q3!==h?(a.q1+a.q3)/2:a.q1:a.q3!==h?a.q3:0,a.med=z,a.q1=a.q3=z,a.lf=a.uf=z,a.mean=a.sd=z,a.ln=a.un=z,a.min=a.max=z;O=Math.min(O,a.min),P=Math.max(P,a.max),a.pts2=y.filter(ag),A.push(a)}}b._extremes[C._id]=f.findExtremes(C,[O,P],{padded:!0})}else{var U,V,W=C.makeCalcdata(b,H),ao=j(N,af),X=N.length,Y=k(X);for(v=0;v<b._length;v++)if(e(J=W[v])){var Z=c.findBin(M[v],ao);Z>=0&&Z<X&&(m(I={v:J,i:v},b,v),Y[Z].push(I))}var $=1/0,_=-1/0,aj=b.quartilemethod,ak="exclusive"===aj,al="inclusive"===aj;for(v=0;v<X;v++)if(Y[v].length>0){(a={}).pos=a[Q]=N[v],y=a.pts=Y[v].sort(o),d=a[H]=y.map(p),l=d.length,a.min=d[0],a.max=d[l-1],a.mean=c.mean(d,l),a.sd=c.stdev(d,l,a.mean),a.med=c.interp(d,.5),l%2&&(ak||al)?(ak?(U=d.slice(0,l/2),V=d.slice(l/2+1)):al&&(U=d.slice(0,l/2+1),V=d.slice(l/2)),a.q1=c.interp(U,.5),a.q3=c.interp(V,.5)):(a.q1=c.interp(d,.25),a.q3=c.interp(d,.75)),a.lf=q(a,d,l),a.uf=r(a,d,l),a.lo=s(a),a.uo=t(a);var am=u(a,l);a.ln=a.med-am,a.un=a.med+am,$=Math.min($,a.ln),_=Math.max(_,a.un),a.pts2=y.filter(ag),A.push(a)}b._extremes[C._id]=f.findExtremes(C,b.notched?W.concat([$,_]):W,{padded:!0})}return(n(A,b),A.length>0)?(A[0].t={num:K[L],dPos:af,posLetter:Q,valLetter:H,labels:{med:i(w,"median:"),min:i(w,"min:"),q1:i(w,"q1:"),q3:i(w,"q3:"),max:i(w,"max:"),mean:"sd"===b.boxmean?i(w,"mean \xb1 \u03C3:"):i(w,"mean:"),lf:i(w,"lower fence:"),uf:i(w,"upper fence:")}},K[L]++,A):[{t:{empty:!0}}]};var l={text:"tx",hovertext:"htx"};function m(e,d,b){for(var a in l)c.isArrayOrTypedArray(d[a])&&(Array.isArray(b)?c.isArrayOrTypedArray(d[a][b[0]])&&(e[l[a]]=d[a][b[0]][b[1]]):e[l[a]]=d[a][b])}function n(e,f){if(c.isArrayOrTypedArray(f.selectedpoints))for(var b=0;b<e.length;b++){for(var d=e[b].pts||[],g={},a=0;a<d.length;a++)g[d[a].i]=a;c.tagSelected(d,f,g)}}function o(a,b){return a.v-b.v}function p(a){return a.v}function q(a,b,d){return 0===d?a.q1:Math.min(a.q1,b[Math.min(c.findBin(2.5*a.q1-1.5*a.q3,b,!0)+1,d-1)])}function r(a,b,d){return 0===d?a.q3:Math.max(a.q3,b[Math.max(c.findBin(2.5*a.q3-1.5*a.q1,b),0)])}function s(a){return 4*a.q1-3*a.q3}function t(a){return 4*a.q3-3*a.q1}function u(a,b){return 0===b?0:1.57*(a.q3-a.q1)/Math.sqrt(b)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(a,b,d){"use strict";var e=a("../../plots/cartesian/axes"),f=a("../../lib"),g=a("../../plots/cartesian/constraints").getAxisGroup,h=["v","h"];function c(t,J,u,h){var K=J.calcdata,j=J._fullLayout,L=h._id,M=L.charAt(0),F=[],N=0;for(V=0;V<u.length;V++)for(k=0,l=K[u[V]];k<l.length;k++)F.push(h.c2l(l[k].pos,!0)),N+=(l[k].pts2||[]).length;if(F.length){var v=f.distinctVals(F);("category"===h.type||"multicategory"===h.type)&&(v.minDiff=1);var T=v.minDiff/2;e.minDtick(h,v.minDiff,v.vals[0],!0);var O=j["violin"===t?"_numViolins":"_numBoxes"],U="group"===j[t+"mode"]&&O>1,w=1-j[t+"gap"],P=1-j[t+"groupgap"];for(V=0;V<u.length;V++){var V,k,l,a,m,i,x,c,d,n,G,o,p,y,z,b=(l=K[u[V]])[0].trace,q=l[0].t,r=b.width,Q=b.side;if(r)a=m=x=r/2,i=0;else if(a=T,U){var W=g(j,h._id)+b.orientation,X=j._alignmentOpts[W]||{},Y=X[b.alignmentgroup]||{},R=Object.keys(Y.offsetGroups||{}).length,H=R||O,Z=R?b._offsetIndex:q.num;m=a*w*P/H,i=2*a*(-0.5+(Z+.5)/H)*w,x=a*w/H}else m=a*w*P,i=0,x=a;q.dPos=a,q.bPos=i,q.bdPos=m,q.wHover=x;var s=i+m,I=Boolean(r),$=(b.boxpoints||b.points)&&N>0;if("positive"===Q?(c=a*(r?1:.5),n=s,d=n=i):"negative"===Q?(c=n=i,d=a*(r?1:.5),G=s):(c=d=a,n=G=s),$){var A=b.pointpos,B=b.jitter,C=b.marker.size/2,D=0;A+B>=0&&((D=s*(A+B))>c?(I=!0,y=C,o=D):D>n&&(y=C,o=c)),D<=c&&(o=c);var E=0;A-B<=0&&((E=-s*(A-B))>d?(I=!0,z=C,p=E):E>G&&(z=C,p=d)),E<=d&&(p=d)}else o=c,p=d;var S=new Array(l.length);for(k=0;k<l.length;k++)S[k]=l[k].pos;b._extremes[L]=e.findExtremes(h,S,{padded:I,vpadminus:p,vpadplus:o,vpadLinearized:!0,ppadminus:{x:z,y:y}[M],ppadplus:{x:y,y:z}[M]})}}}b.exports={crossTraceCalc:function(e,f){for(var g=e.calcdata,i=f.xaxis,j=f.yaxis,d=0;d<h.length;d++){for(var k=h[d],n="h"===k?j:i,l=[],b=0;b<g.length;b++){var m=g[b],o=m[0].t,a=m[0].trace;!0!==a.visible||"box"!==a.type&&"candlestick"!==a.type||o.empty||(a.orientation||"v")!==k||a.xaxis!==i._id||a.yaxis!==j._id||l.push(b)}c("box",e,l,n)}},setPositionOffset:c}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(a,b,e){"use strict";var f=a("../../lib"),g=a("../../registry"),h=a("../../components/color"),i=a("../scatter/period_defaults"),j=a("../bar/defaults").handleGroupingDefaults,k=a("../../plots/cartesian/axis_autotype"),l=a("./attributes");function c(A,e,a,s){function x(a){var b=0;return a&&a.length&&(b+=1,f.isArrayOrTypedArray(a[0])&&a[0].length&&(b+=1)),b}function p(a){return f.validate(A[a],l[a])}var b=a("y"),h=a("x");if("box"===e.type){var t=a("q1"),u=a("median"),v=a("q3");e._hasPreCompStats=t&&t.length&&u&&u.length&&v&&v.length,w=Math.min(f.minRowLength(t),f.minRowLength(u),f.minRowLength(v))}var n=x(b),i=x(h),o=n&&f.minRowLength(b),j=i&&f.minRowLength(h),y=s.calendar,z={autotypenumbers:s.autotypenumbers};if(e._hasPreCompStats)switch(String(i)+String(n)){case"00":var B=p("x0")||p("dx"),C=p("y0")||p("dy");m=C&&!B?"h":"v",c=w;break;case"10":m="v",c=Math.min(w,j);break;case"20":m="h",c=Math.min(w,h.length);break;case"01":m="h",c=Math.min(w,o);break;case"02":m="v",c=Math.min(w,b.length);break;case"12":m="v",c=Math.min(w,j,b.length);break;case"21":m="h",c=Math.min(w,h.length,o);break;case"11":c=0;break;case"22":var w,m,c,d,q=!1;for(d=0;d<h.length;d++)if("category"===k(h[d],y,z)){q=!0;break}if(q)m="v",c=Math.min(w,j,b.length);else{for(d=0;d<b.length;d++)if("category"===k(b[d],y,z)){q=!0;break}q?(m="h",c=Math.min(w,h.length,o)):(m="v",c=Math.min(w,j,b.length))}break}else n>0?(m="v",c=i>0?Math.min(j,o):Math.min(o)):i>0?(m="h",c=Math.min(j)):c=0;if(!c){e.visible=!1;return}e._length=c;var r=a("orientation",m);e._hasPreCompStats?"v"===r&&0===i?(a("x0",0),a("dx",1)):"h"===r&&0===n&&(a("y0",0),a("dy",1)):"v"===r&&0===i?a("x0"):"h"===r&&0===n&&a("y0"),g.getComponentMethod("calendars","handleTraceDefaults")(A,e,["x","y"],s)}function d(g,b,a,h){var i=h.prefix,j=f.coerce2(g,b,l,"marker.outliercolor"),k=a("marker.line.outliercolor"),d="outliers";b._hasPreCompStats?d="all":(j||k)&&(d="suspectedoutliers");var c=a(i+"points",d);c?(a("jitter","all"===c?.3:0),a("pointpos","all"===c?-1.5:0),a("marker.symbol"),a("marker.opacity"),a("marker.size"),a("marker.angle"),a("marker.color",b.line.color),a("marker.line.color"),a("marker.line.width"),"suspectedoutliers"===c&&(a("marker.line.outliercolor",b.marker.color),a("marker.line.outlierwidth")),a("selected.marker.color"),a("unselected.marker.color"),a("selected.marker.size"),a("unselected.marker.size"),a("text"),a("hovertext")):delete b.marker;var e=a("hoveron");("all"===e|| -1!==e.indexOf("points"))&&a("hovertemplate"),f.coerceSelectionMarkerOpacity(b,a)}b.exports={supplyDefaults:function(e,b,q,m){function a(a,c){return f.coerce(e,b,l,a,c)}if(c(e,b,a,m),!1!==b.visible){i(e,b,m,a),a("xhoverformat"),a("yhoverformat");var g=b._hasPreCompStats;g&&(a("lowerfence"),a("upperfence")),a("line.color",(e.marker||{}).color||q),a("line.width"),a("fillcolor",h.addOpacity(b.line.color,.5));var j=!1;if(g){var n=a("mean"),o=a("sd");n&&n.length&&(j=!0,o&&o.length&&(j="sd"))}a("boxmean",j),a("whiskerwidth"),a("width"),a("quartilemethod");var k=!1;if(g){var p=a("notchspan");p&&p.length&&(k=!0)}else f.validate(e.notchwidth,l.notchwidth)&&(k=!0);a("notched",k)&&a("notchwidth"),d(e,b,a,{prefix:"box"})}},crossTraceDefaults:function(d,e){var g,a;function h(b){return f.coerce(a._input,a,l,b)}for(var b=0;b<d.length;b++){var c=(a=d[b]).type;("box"===c||"violin"===c)&&(g=a._input,"group"===e[c+"mode"]&&j(g,a,e,h))}},handleSampleDefaults:c,handlePointsDefaults:d}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(b,a,c){"use strict";a.exports=function(b,a){return a.hoverOnBox&&(b.hoverOnBox=a.hoverOnBox),"xVal"in a&&(b.x=a.xVal),"yVal"in a&&(b.y=a.yVal),a.xa&&(b.xaxis=a.xa),a.ya&&(b.yaxis=a.ya),b}},{}],687:[function(a,b,f){"use strict";var g=a("../../plots/cartesian/axes"),c=a("../../lib"),h=a("../../components/fx"),i=a("../../components/color"),j=c.fillText;function d(a,E,F,R){var m,k,e,n,G,H,w,x,p,I,J,s,t,y,u=a.cd,K=a.xa,L=a.ya,b=u[0].trace,o=u[0].t,M="violin"===b.type,v=o.bdPos,X=o.wHover,Y=function(a){return e.c2l(a.pos)+o.bPos-e.c2l(H)};M&&"both"!==b.side?("positive"===b.side&&(p=function(b){var a=Y(b);return h.inbox(a,a+X,I)},s=v,t=0),"negative"===b.side&&(p=function(b){var a=Y(b);return h.inbox(a-X,a,I)},s=0,t=v)):(p=function(b){var a=Y(b);return h.inbox(a-X,a+X,I)},s=t=v),y=M?function(a){return h.inbox(a.span[0]-G,a.span[1]-G,I)}:function(a){return h.inbox(a.min-G,a.max-G,I)},"h"===b.orientation?(G=E,H=F,w=y,x=p,m="y",e=L,k="x",n=K):(G=F,H=E,w=p,x=y,m="x",e=K,k="y",n=L);var N=Math.min(1,v/Math.abs(e.r2c(e.range[1])-e.r2c(e.range[0])));function O(a){return(w(a)+x(a))/2}I=a.maxHoverDistance-N,J=a.maxSpikeDistance-N;var S=h.getDistanceFunction(R,w,x,O);if(h.getClosest(u,S,a),!1===a.index)return[];var d=u[a.index],P=b.line.color,Q=(b.marker||{}).color;i.opacity(P)&&b.line.width?a.color=P:i.opacity(Q)&&b.boxpoints?a.color=Q:a.color=b.fillcolor,a[m+"0"]=e.c2p(d.pos+o.bPos-t,!0),a[m+"1"]=e.c2p(d.pos+o.bPos+s,!0),a[m+"LabelVal"]=void 0!==d.orig_p?d.orig_p:d.pos;var q=m+"Spike";a.spikeDistance=O(d)*J/I,a[q]=e.c2p(d.pos,!0);var z=b.boxmean||(b.meanline||{}).visible,A=b.boxpoints||b.points,B=A&&z?["max","uf","q3","med","mean","q1","lf","min"]:A&&!z?["max","uf","q3","med","q1","lf","min"]:!A&&z?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],T=n.range[1]<n.range[0];b.orientation===(T?"v":"h")&&B.reverse();for(var U=a.spikeDistance,V=a[q],f=[],C=0;C<B.length;C++){var r=B[C];if(r in d){var D=d[r],W=n.c2p(D,!0),j=c.extendFlat({},a);j.attr=r,j[k+"0"]=j[k+"1"]=W,j[k+"LabelVal"]=D,j[k+"Label"]=(o.labels?o.labels[r]+" ":"")+g.hoverLabelText(n,D,b[k+"hoverformat"]),j.hoverOnBox=!0,"mean"===r&&"sd"in d&&"sd"===b.boxmean&&(j[k+"err"]=d.sd),j.hovertemplate=!1,f.push(j)}}a.name="",a.spikeDistance=void 0,a[q]=void 0;for(var l=0;l<f.length;l++)"med"!==f[l].attr?(f[l].name="",f[l].spikeDistance=void 0,f[l][q]=void 0):(f[l].spikeDistance=U,f[l][q]=V);return f}function e(d,v,w){for(var b,e,a,g,i=d.cd,o=d.xa,p=d.ya,f=i[0].trace,A=o.c2p(v),B=p.c2p(w),x=function(a){var b=Math.max(3,a.mrc||0);return Math.max(Math.abs(o.c2p(a.x)-A)-b,1-3/b)},y=function(a){var b=Math.max(3,a.mrc||0);return Math.max(Math.abs(p.c2p(a.y)-B)-b,1-3/b)},z=h.quadrature(x,y),k=!1,l=0;l<i.length;l++){e=i[l];for(var m=0;m<(e.pts||[]).length;m++){var q=z(a=e.pts[m]);q<=d.distance&&(d.distance=q,k=[l,m])}}if(!k)return!1;a=(e=i[k[0]]).pts[k[1]];var r=o.c2p(a.x,!0),s=p.c2p(a.y,!0),n=a.mrc||1;b=c.extendFlat({},d,{index:a.i,color:(f.marker||{}).color,name:f.name,x0:r-n,x1:r+n,y0:s-n,y1:s+n,spikeDistance:d.distance,hovertemplate:f.hovertemplate});var t=e.orig_p,u=void 0!==t?t:e.pos;return"h"===f.orientation?(g=p,b.xLabelVal=a.x,b.yLabelVal=u):(g=o,b.xLabelVal=u,b.yLabelVal=a.y),b[g._id.charAt(0)+"Spike"]=g.c2p(e.pos,!0),j(a,f,b),b}b.exports={hoverPoints:function(c,f,g,h){var a,i=c.cd[0].trace.hoveron,b=[];return(-1!==i.indexOf("boxes")&&(b=b.concat(d(c,f,g,h))),-1!==i.indexOf("points")&&(a=e(c,f,g)),"closest"===h)?a?[a]:b:(a&&b.push(a),b)},hoverOnBoxes:d,hoverOnPoints:e}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults").supplyLayoutDefaults,calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc").crossTraceCalc,plot:a("./plot").plot,style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"box",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(b,a,c){"use strict";a.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(a,b,d){"use strict";var e=a("../../registry"),f=a("../../lib"),g=a("./layout_attributes");function c(i,j,d,b,a){for(var g=a+"Layout",f=!1,c=0;c<d.length;c++){var h=d[c];if(e.traceIs(h,g)){f=!0;break}}f&&(b(a+"mode"),b(a+"gap"),b(a+"groupgap"))}b.exports={supplyLayoutDefaults:function(a,b,d){c(a,b,d,function(c,d){return f.coerce(a,b,g,c,d)},"box")},_supply:c}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(a,b,f){"use strict";var g=a("@plotly/d3"),h=a("../../lib"),i=a("../../components/drawing"),j=5,k=.01;function c(i,d,b,a){var e,f,l="h"===b.orientation,m=d.val,j=d.pos,n=!!j.rangebreaks,o=a.bPos,p=a.wdPos||0,q=a.bPosPxOffset||0,r=b.whiskerwidth||0,k=b.notched||!1,s=k?1-2*b.notchwidth:1;Array.isArray(a.bdPos)?(e=a.bdPos[0],f=a.bdPos[1]):(e=a.bdPos,f=a.bdPos);var c=i.selectAll("path.box").data("violin"!==b.type||b.box.visible?h.identity:[]);c.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),c.exit().remove(),c.each(function(a){if(a.empty)return"M0,0Z";var d=j.c2l(a.pos+o,!0),c=j.l2p(d-e)+q,i=j.l2p(d+f)+q,t=n?(c+i)/2:j.l2p(d)+q,x=b.whiskerwidth,y=n?c*x+(1-x)*t:j.l2p(d-p)+q,z=n?i*x+(1-x)*t:j.l2p(d+p)+q,A=j.l2p(d-e*s)+q,B=j.l2p(d+f*s)+q,u=m.c2p(a.q1,!0),v=m.c2p(a.q3,!0),w=h.constrain(m.c2p(a.med,!0),Math.min(u,v)+1,Math.max(u,v)-1),G=void 0===a.lf|| !1===b.boxpoints,C=m.c2p(G?a.min:a.lf,!0),D=m.c2p(G?a.max:a.uf,!0),E=m.c2p(a.ln,!0),F=m.c2p(a.un,!0);l?g.select(this).attr("d","M"+w+","+A+"V"+B+"M"+u+","+c+"V"+i+(k?"H"+E+"L"+w+","+B+"L"+F+","+i:"")+"H"+v+"V"+c+(k?"H"+F+"L"+w+","+A+"L"+E+","+c:"")+"ZM"+u+","+t+"H"+C+"M"+v+","+t+"H"+D+(0===r?"":"M"+C+","+y+"V"+z+"M"+D+","+y+"V"+z)):g.select(this).attr("d","M"+A+","+w+"H"+B+"M"+c+","+u+"H"+i+(k?"V"+E+"L"+B+","+w+"L"+i+","+F:"")+"V"+v+"H"+c+(k?"V"+F+"L"+A+","+w+"L"+c+","+E:"")+"ZM"+t+","+u+"V"+C+"M"+t+","+v+"V"+D+(0===r?"":"M"+y+","+C+"H"+z+"M"+y+","+D+"H"+z))})}function d(f,c,d,e){var g=c.x,l=c.y,n=e.bdPos,o=e.bPos,m=d.boxpoints||d.points;h.seedPseudoRandom();var a=f.selectAll("g.points").data(m?function(a){return a.forEach(function(a){a.t=e,a.trace=d}),a}:[]);a.enter().append("g").attr("class","points"),a.exit().remove();var b=a.selectAll("path").data(function(b){var a,s,c=b.pts2,p=Math.max((b.max-b.min)/10,b.q3-b.q1),w=1e-9*p,x=p*k,f=[],g=0;if(d.jitter){if(0===p)for(a=0,g=1,f=new Array(c.length);a<c.length;a++)f[a]=1;else for(a=0;a<c.length;a++){var t=Math.max(0,a-j),q=c[t].v,u=Math.min(c.length-1,a+j),r=c[u].v;"all"!==m&&(c[a].v<b.lf?r=Math.min(r,b.lf):q=Math.max(q,b.uf));var i=Math.sqrt(x*(u-t)/(r-q+w))||0;i=h.constrain(Math.abs(i),0,1),f.push(i),g=Math.max(i,g)}s=2*d.jitter/(g||1)}for(a=0;a<c.length;a++){var e=c[a],l=e.v,y=d.jitter?s*f[a]*(h.pseudoRandom()-.5):0,v=b.pos+o+n*(d.pointpos+y);"h"===d.orientation?(e.y=v,e.x=l):(e.x=v,e.y=l),"suspectedoutliers"===m&&l<b.uo&&l>b.lo&&(e.so=!0)}return c});b.enter().append("path").classed("point",!0),b.exit().remove(),b.call(i.translatePoints,g,l)}function e(i,d,a,b){var e,f,k=d.val,j=d.pos,l=!!j.rangebreaks,m=b.bPos,n=b.bPosPxOffset||0,o=a.boxmean||(a.meanline||{}).visible;Array.isArray(b.bdPos)?(e=b.bdPos[0],f=b.bdPos[1]):(e=b.bdPos,f=b.bdPos);var c=i.selectAll("path.mean").data("box"===a.type&&a.boxmean||"violin"===a.type&&a.box.visible&&a.meanline.visible?h.identity:[]);c.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),c.exit().remove(),c.each(function(b){var i=j.c2l(b.pos+m,!0),c=j.l2p(i-e)+n,p=j.l2p(i+f)+n,d=l?(c+p)/2:j.l2p(i)+n,h=k.c2p(b.mean,!0),q=k.c2p(b.mean-b.sd,!0),r=k.c2p(b.mean+b.sd,!0);"h"===a.orientation?g.select(this).attr("d","M"+h+","+c+"V"+p+("sd"===o?"m0,0L"+q+","+d+"L"+h+","+c+"L"+r+","+d+"Z":"")):g.select(this).attr("d","M"+c+","+h+"H"+p+("sd"===o?"m0,0L"+d+","+q+"L"+c+","+h+"L"+d+","+r+"Z":""))})}b.exports={plot:function(i,a,b,f){var j=a.xaxis,k=a.yaxis;h.makeTraceGroups(f,b,"trace boxes").each(function(m){var f,h,i=g.select(this),l=m[0],a=l.t,b=l.trace;if(a.wdPos=a.bdPos*b.whiskerwidth,!0!==b.visible||a.empty){i.remove();return}"h"===b.orientation?(f=k,h=j):(f=j,h=k),c(i,{pos:f,val:h},b,a),d(i,{x:j,y:k},b,a),e(i,{pos:f,val:h},b,a)})},plotBoxAndWhiskers:c,plotPoints:d,plotBoxMean:e}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(b,a,c){"use strict";a.exports=function(e,f){var a,b,d=e.cd,g=e.xaxis,h=e.yaxis,i=[];if(!1===f)for(a=0;a<d.length;a++)for(b=0;b<(d[a].pts||[]).length;b++)d[a].pts[b].selected=0;else for(a=0;a<d.length;a++)for(b=0;b<(d[a].pts||[]).length;b++){var c=d[a].pts[b],j=g.c2p(c.x),k=h.c2p(c.y);f.contains([j,k],null,c.i,e)?(i.push({pointNumber:c.i,x:g.c2d(c.x),y:h.c2d(c.y)}),c.selected=1):c.selected=0}return i}},{}],693:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../components/color"),f=a("../../components/drawing");b.exports={style:function(b,g,c){var a=c||d.select(b).selectAll("g.trace.boxes");a.style("opacity",function(a){return a[0].trace.opacity}),a.each(function(i){var g=d.select(this),a=i[0].trace,c=a.line.width;function j(a,b,c,d){a.style("stroke-width",b+"px").call(e.stroke,c).call(e.fill,d)}var h=g.selectAll("path.box");if("candlestick"===a.type)h.each(function(b){if(!b.empty){var e=d.select(this),c=a[b.dir];j(e,c.line.width,c.line.color,c.fillcolor),e.style("opacity",a.selectedpoints&&!b.selected?.3:1)}});else{j(h,c,a.line.color,a.fillcolor),g.selectAll("path.mean").style({"stroke-width":c,"stroke-dasharray":2*c+"px,"+c+"px"}).call(e.stroke,a.line.color);var k=g.selectAll("path.point");f.pointStyle(k,a,b)}})},styleOnSelect:function(c,d,e){var a=d[0].trace,b=e.selectAll("path.point");a.selectedpoints?f.selectedPointStyle(b,a):f.pointStyle(b,a,c)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(b,g,h){"use strict";var c=b("../../lib").extendFlat,d=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,a=b("../ohlc/attributes"),e=b("../box/attributes");function f(a){return{line:{color:c({},e.line.color,{dflt:a}),width:e.line.width,editType:"style"},fillcolor:e.fillcolor,editType:"style"}}g.exports={xperiod:a.xperiod,xperiod0:a.xperiod0,xperiodalignment:a.xperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),x:a.x,open:a.open,high:a.high,low:a.low,close:a.close,line:{width:c({},e.line.width,{}),editType:"style"},increasing:f(a.increasing.line.color.dflt),decreasing:f(a.decreasing.line.color.dflt),text:a.text,hovertext:a.hovertext,whiskerwidth:c({},e.whiskerwidth,{dflt:0}),hoverlabel:a.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../../plots/cartesian/align_period"),g=a("../ohlc/calc").calcCommon;function h(b,c,d,a){return{min:d,q1:Math.min(b,a),med:a,q3:Math.max(b,a),max:c}}b.exports=function(b,a){var i=b._fullLayout,j=e.getFromId(b,a.xaxis),m=e.getFromId(b,a.yaxis),k=j.makeCalcdata(a,"x"),l=f(a,j,"x",k).vals,c=g(b,a,k,l,m,h);return c.length?(d.extendFlat(c[0].t,{num:i._numBoxes,dPos:d.distinctVals(l).minDiff/2,posLetter:"x",valLetter:"y"}),i._numBoxes++,c):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color"),f=a("../ohlc/ohlc_defaults"),g=a("../scatter/period_defaults"),h=a("./attributes");function i(f,c,a,b){var d=a(b+".line.color");a(b+".line.width",c.line.width),a(b+".fillcolor",e.addOpacity(d,.5))}b.exports=function(c,b,j,e){function a(a,e){return d.coerce(c,b,h,a,e)}if(!f(c,b,a,e)){b.visible=!1;return}g(c,b,e,a,{x:!0}),a("xhoverformat"),a("yhoverformat"),a("line.width"),i(c,b,a,"increasing"),i(c,b,a,"decreasing"),a("text"),a("hovertext"),a("whiskerwidth"),e._requestRangeslider[b.xaxis]=!0}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"candlestick",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:a("./attributes"),layoutAttributes:a("../box/layout_attributes"),supplyLayoutDefaults:a("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:a("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("../box/plot").plot,layerName:"boxlayer",style:a("../box/style").style,hoverPoints:a("../ohlc/hover").hoverPoints,selectPoints:a("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(a,b,c){"use strict";var d=a("./axis_defaults"),e=a("../../plot_api/plot_template");b.exports=function(b,c,f,a,g){var h,i,j,k;a("a")||(a("da"),a("a0")),a("b")||(a("db"),a("b0")),h=b,i=c,j=f,k=g,["aaxis","baxis"].forEach(function(a){var b=a.charAt(0),c=h[a]||{},f=e.newContainer(i,a);d(c,f,{noTicklabelstep:!0,tickfont:"x",id:b+"axis",letter:b,font:i.font,name:a,data:h[b],calendar:i.calendar,dfltColor:k,bgColor:j.paper_bgcolor,autotypenumbersDflt:j.autotypenumbers,fullLayout:j}),f._categories=f._categories||[],h[a]||"-"===c.type||(h[a]={type:c.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;function e(f,i){if(!d(f)||i>=10)return null;for(var a=1/0,b=-1/0,j=f.length,g=0;g<j;g++){var c=f[g];if(d(c)){var h=e(c,i+1);h&&(a=Math.min(h[0],a),b=Math.max(h[1],b))}else a=Math.min(c,a),b=Math.max(c,b)}return[a,b]}b.exports=function(a){return e(a,0)}},{"../../lib":515}],700:[function(b,e,g){"use strict";var f=b("../../plots/font_attributes"),c=b("./axis_attributes"),d=b("../../components/color/attributes"),a=f({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif',a.size.dflt=12,a.color.dflt=d.defaultLine,e.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:c,baxis:c,font:a,color:{valType:"color",dflt:d.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(c,m,p,t){var e,q,u,D,f,g,h,i,r,s,n,j,k,a=d(p)?"a":"b",v=("a"===a?c.aaxis:c.baxis).smoothing,w="a"===a?c.a2i:c.b2j,x="a"===a?p:t,y="a"===a?t:p,E="a"===a?m.a.length:m.b.length,F="a"===a?m.b.length:m.a.length,z=Math.floor("a"===a?c.b2j(y):c.a2i(y)),A="a"===a?function(a){return c.evalxy([],a,z)}:function(a){return c.evalxy([],z,a)};v&&(u=Math.max(0,Math.min(F-2,z)),D=z-u,q="a"===a?function(a,b){return c.dxydi([],a,u,b,D)}:function(a,b){return c.dxydj([],u,a,D,b)});var l=w(x[0]),o=w(x[1]),b=l<o?1:-1,B=(o-l)*1e-8,G=b>0?Math.min:Math.max,H=b>0?Math.max:Math.min,I=(b>0?Math.floor:Math.ceil)(l+B),J=(b>0?Math.ceil:Math.floor)(o-B);h=A(l);var C=[[h]];for(e=I;e*b<J*b;e+=b)f=[],n=H(l,e),j=G(o,e+b),k=j-n,g=Math.max(0,Math.min(E-2,Math.floor(.5*(n+j)))),i=A(j),v&&(r=q(g,n-g),s=q(g,j-g),f.push([h[0]+r[0]/3*k,h[1]+r[1]/3*k]),f.push([i[0]-s[0]/3*k,i[1]-s[1]/3*k])),f.push(i),C.push(f),h=i;return C}},{"../../lib":515}],702:[function(a,g,j){"use strict";var b=a("../../plots/font_attributes"),c=a("../../components/color/attributes"),d=a("../../plots/cartesian/layout_attributes"),h=a("../../plots/cartesian/axis_format_attributes").descriptionWithDates,i=a("../../plot_api/edit_types").overrideAll,e=a("../../components/drawing/attributes").dash,f=a("../../lib/extend").extendFlat;g.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:b({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:d.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:b({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:h("tick label")},tickformatstops:i(d.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:c.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:f({},e,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:f({},e,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:c.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:b({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(a,b,c){"use strict";var d=a("./attributes"),e=a("../../components/color").addOpacity,f=a("../../registry"),g=a("../../lib"),h=a("../../plots/cartesian/tick_value_defaults"),i=a("../../plots/cartesian/tick_label_defaults"),j=a("../../plots/cartesian/prefix_suffix_defaults"),k=a("../../plots/cartesian/category_order_defaults"),l=a("../../plots/cartesian/set_convert"),m=a("../../plots/cartesian/axis_autotype");b.exports=function(n,a,c){var r=c.letter,s=c.font||{},E=d[r+"axis"];function b(b,c){return g.coerce(n,a,E,b,c)}function o(b,c){return g.coerce2(n,a,E,b,c)}c.name&&(a._name=c.name,a._id=c.name),b("autotypenumbers",c.autotypenumbersDflt);var p=b("type");"-"===p&&(c.data&&function(a,b){if("-"===a.type){var c=a._id.charAt(0)+"calendar",d=a[c];a.type=m(b,d,{autotypenumbers:a.autotypenumbers})}}(a,c.data),"-"===a.type?a.type="linear":p=n.type=a.type),b("smoothing"),b("cheatertype"),b("showticklabels"),b("labelprefix",r+" = "),b("labelsuffix"),b("showtickprefix"),b("showticksuffix"),b("separatethousands"),b("tickformat"),b("exponentformat"),b("minexponent"),b("showexponent"),b("categoryorder"),b("tickmode"),b("tickvals"),b("ticktext"),b("tick0"),b("dtick"),"array"===a.tickmode&&(b("arraytick0"),b("arraydtick")),b("labelpadding"),a._hovertitle=r,"date"===p&&f.getComponentMethod("calendars","handleDefaults")(n,a,"calendar",c.calendar),l(a,c.fullLayout),a.c2p=g.identity;var q=b("color",c.dfltColor),v=q===n.color?q:s.color;b("title.text")&&(g.coerceFont(b,"title.font",{family:s.family,size:g.bigFont(s.size),color:v}),b("title.offset")),b("tickangle"),b("autorange",!a.isValidRange(n.range))&&b("rangemode"),b("range"),a.cleanRange(),b("fixedrange"),h(n,a,b,p),j(n,a,b,p,c),i(n,a,b,p,c),k(n,a,b,{data:c.data,dataAttr:r});var w=o("gridcolor",e(q,.3)),t=o("gridwidth"),x=o("griddash"),u=b("showgrid");u||(delete a.gridcolor,delete a.gridwidth,delete a.griddash);var y=o("startlinecolor",q),z=o("startlinewidth",t),A=b("startline",a.showgrid||!!y||!!z);A||(delete a.startlinecolor,delete a.startlinewidth);var B=o("endlinecolor",q),C=o("endlinewidth",t),D=b("endline",a.showgrid||!!B||!!C);return D||(delete a.endlinecolor,delete a.endlinewidth),u?(b("minorgridcount"),b("minorgridwidth",t),b("minorgriddash",x),b("minorgridcolor",e(w,.06)),a.minorgridcount||(delete a.minorgridwidth,delete a.minorgriddash,delete a.minorgridcolor)):(delete a.gridcolor,delete a.gridwidth,delete a.griddash),"none"===a.showticklabels&&(delete a.tickfont,delete a.tickangle,delete a.showexponent,delete a.exponentformat,delete a.minexponent,delete a.tickformat,delete a.showticksuffix,delete a.showtickprefix),a.showticksuffix||delete a.ticksuffix,a.showtickprefix||delete a.tickprefix,b("tickmode"),a}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib").isArray1D,f=a("./cheater_basis"),g=a("./array_minmax"),h=a("./calc_gridlines"),i=a("./calc_labels"),j=a("./calc_clippath"),k=a("../heatmap/clean_2d_array"),l=a("./smooth_fill_2d_array"),m=a("../heatmap/convert_column_xyz"),n=a("./set_convert");b.exports=function(w,a){var x=d.getFromId(w,a.xaxis),y=d.getFromId(w,a.yaxis),t=a.aaxis,u=a.baxis,b=a.x,c=a.y,v=[];b&&e(b)&&v.push("x"),c&&e(c)&&v.push("y"),v.length&&m(a,t,u,"a","b",v);var r=a._a=a._a||a.a,s=a._b=a._b||a.b;b=a._x||a.x,c=a._y||a.y;var o={};a._cheater&&(b=f("index"===t.cheatertype?r.length:r,"index"===u.cheatertype?s.length:s,a.cheaterslope)),a._x=b=k(b),a._y=c=k(c),l(b,r,s),l(c,r,s),n(a),a.setScale();var p=g(b),q=g(c),z=.5*(p[1]-p[0]),A=.5*(p[1]+p[0]),B=.5*(q[1]-q[0]),C=.5*(q[1]+q[0]);return p=[A-1.3*z,A+1.3*z],q=[C-1.3*B,C+1.3*B],a._extremes[x._id]=d.findExtremes(x,p,{padded:!0}),a._extremes[y._id]=d.findExtremes(y,q,{padded:!0}),h(a,"a","b"),h(a,"b","a"),i(a,t),i(a,u),o.clipsegments=j(a._xctrl,a._yctrl,t,u),o.x=b,o.y=c,o.a=r,o.b=s,[o]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(b,a,c){"use strict";a.exports=function(d,h,k,l){var a,b,c,g=[],i=!!k.smoothing,j=!!l.smoothing,e=d[0].length-1,f=d.length-1;for(a=0,b=[],c=[];a<=e;a++)b[a]=d[0][a],c[a]=h[0][a];for(g.push({x:b,y:c,bicubic:i}),a=0,b=[],c=[];a<=f;a++)b[a]=d[a][e],c[a]=h[a][e];for(g.push({x:b,y:c,bicubic:j}),a=e,b=[],c=[];a>=0;a--)b[e-a]=d[f][a],c[e-a]=h[f][a];for(g.push({x:b,y:c,bicubic:i}),a=f,b=[],c=[];a>=0;a--)b[f-a]=d[a][0],c[f-a]=h[a][0];return g.push({x:b,y:c,bicubic:j}),g}},{}],706:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib/extend").extendFlat;b.exports=function(f,u,v){var g,r,l,h,o,i,j,c,p,k,m,s,w,x,b=f["_"+u],a=f[u+"axis"],y=a._gridlines=[],z=a._minorgridlines=[],q=a._boundarylines=[],B=f["_"+v],C=f[v+"axis"];"array"===a.tickmode&&(a.tickvals=b.slice());var A=f._xctrl,D=f._yctrl,E=A[0].length,F=A.length,G=f._a.length,H=f._b.length;d.prepTicks(a),"array"===a.tickmode&&delete a.tickvals;var I=a.smoothing?3:1;function n(o){var d,e,j,m,k,l,n,g,p,q,r,s,h=[],i=[],b={};if("b"===u)for(d=0,j=Math.floor(Math.max(0,Math.min(H-2,e=f.b2j(o)))),m=e-j,b.length=H,b.crossLength=G,b.xy=function(a){return f.evalxy([],a,e)},b.dxy=function(a,b){return f.dxydi([],a,j,b,m)};d<G;d++)l=Math.min(G-2,d),n=d-l,g=f.evalxy([],d,e),C.smoothing&&d>0&&(p=f.dxydi([],d-1,j,0,m),h.push(k[0]+p[0]/3),i.push(k[1]+p[1]/3),q=f.dxydi([],d-1,j,1,m),h.push(g[0]-q[0]/3),i.push(g[1]-q[1]/3)),h.push(g[0]),i.push(g[1]),k=g;else for(e=0,l=Math.floor(Math.max(0,Math.min(G-2,d=f.a2i(o)))),n=d-l,b.length=G,b.crossLength=H,b.xy=function(a){return f.evalxy([],d,a)},b.dxy=function(a,b){return f.dxydj([],l,a,n,b)};e<H;e++)j=Math.min(H-2,e),m=e-j,g=f.evalxy([],d,e),C.smoothing&&e>0&&(r=f.dxydj([],l,e-1,n,0),h.push(k[0]+r[0]/3),i.push(k[1]+r[1]/3),s=f.dxydj([],l,e-1,n,1),h.push(g[0]-s[0]/3),i.push(g[1]-s[1]/3)),h.push(g[0]),i.push(g[1]),k=g;return b.axisLetter=u,b.axis=a,b.crossAxis=C,b.value=o,b.constvar=v,b.index=c,b.x=h,b.y=i,b.smoothing=C.smoothing,b}function t(e){var d,i,j,k,l,g=[],h=[],c={};if(c.length=b.length,c.crossLength=B.length,"b"===u)for(d=0,j=Math.max(0,Math.min(H-2,e)),l=Math.min(1,Math.max(0,e-j)),c.xy=function(a){return f.evalxy([],a,e)},c.dxy=function(a,b){return f.dxydi([],a,j,b,l)};d<E;d++)g[d]=A[e*I][d],h[d]=D[e*I][d];else for(d=0,i=Math.max(0,Math.min(G-2,e)),k=Math.min(1,Math.max(0,e-i)),c.xy=function(a){return f.evalxy([],e,a)},c.dxy=function(a,b){return f.dxydj([],i,a,k,b)};d<F;d++)g[d]=A[d][e*I],h[d]=D[d][e*I];return c.axisLetter=u,c.axis=a,c.crossAxis=C,c.value=b[e],c.constvar=v,c.index=e,c.x=g,c.y=h,c.smoothing=C.smoothing,c}if("array"===a.tickmode){for(h=5e-15,i=(o=[Math.floor((b.length-1-a.arraytick0)/a.arraydtick*(1+h)),Math.ceil(-a.arraytick0/a.arraydtick/(1+h))].sort(function(a,b){return a-b}))[0]-1,j=o[1]+1,c=i;c<j;c++)(r=a.arraytick0+a.arraydtick*c)<0||r>b.length-1||y.push(e(t(r),{color:a.gridcolor,width:a.gridwidth,dash:a.griddash}));for(c=i;c<j;c++)if(m=Math.min((l=a.arraytick0+a.arraydtick*c)+a.arraydtick,b.length-1),!(l<0)&&!(l>b.length-1)&& !(m<0)&&!(m>b.length-1))for(g=0,s=b[l],w=b[m];g<a.minorgridcount;g++)!((x=m-l)<=0)&&((k=s+(w-s)*(g+1)/(a.minorgridcount+1)*(a.arraydtick/x))<b[0]||k>b[b.length-1]||z.push(e(n(k),{color:a.minorgridcolor,width:a.minorgridwidth,dash:a.minorgriddash})));a.startline&&q.push(e(t(0),{color:a.startlinecolor,width:a.startlinewidth})),a.endline&&q.push(e(t(b.length-1),{color:a.endlinecolor,width:a.endlinewidth}))}else{for(h=5e-15,i=(o=[Math.floor((b[b.length-1]-a.tick0)/a.dtick*(1+h)),Math.ceil((b[0]-a.tick0)/a.dtick/(1+h))].sort(function(a,b){return a-b}))[0],j=o[1],c=i;c<=j;c++)p=a.tick0+a.dtick*c,y.push(e(n(p),{color:a.gridcolor,width:a.gridwidth,dash:a.griddash}));for(c=i-1;c<j+1;c++)for(g=0,p=a.tick0+a.dtick*c;g<a.minorgridcount;g++)(k=p+a.dtick*(g+1)/(a.minorgridcount+1))<b[0]||k>b[b.length-1]||z.push(e(n(k),{color:a.minorgridcolor,width:a.minorgridwidth,dash:a.minorgriddash}));a.startline&&q.push(e(n(b[0]),{color:a.startlinecolor,width:a.startlinewidth})),a.endline&&q.push(e(n(b[b.length-1]),{color:a.endlinecolor,width:a.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib/extend").extendFlat;b.exports=function(k,c){var b,f,i,j,a,h=c._labels=[],g=c._gridlines;for(b=0;b<g.length;b++)a=g[b],-1!==["start","both"].indexOf(c.showticklabels)&&(e(f=d.tickText(c,a.value),{prefix:i,suffix:j,endAnchor:!0,xy:a.xy(0),dxy:a.dxy(0,0),axis:a.axis,length:a.crossAxis.length,font:a.axis.tickfont,isFirst:0===b,isLast:b===g.length-1}),h.push(f)),-1!==["end","both"].indexOf(c.showticklabels)&&(e(f=d.tickText(c,a.value),{endAnchor:!1,xy:a.xy(a.crossLength-1),dxy:a.dxy(a.crossLength-2,1),axis:a.axis,length:a.crossAxis.length,font:a.axis.tickfont,isFirst:0===b,isLast:b===g.length-1}),h.push(f))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(b,a,c){"use strict";a.exports=function(j,a,k,l){var f=j[0]-a[0],g=j[1]-a[1],h=k[0]-a[0],i=k[1]-a[1],b=Math.pow(f*f+g*g,.25),c=Math.pow(h*h+i*i,.25),m=(c*c*f-b*b*h)*l,n=(c*c*g-b*b*i)*l,d=c*(b+c)*3,e=b*(b+c)*3;return[[a[0]+(d&&m/d),a[1]+(d&&n/d)],[a[0]-(e&&m/e),a[1]-(e&&n/e)]]}},{}],709:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(f,g,r){var b,a,n,o,p,l,h=[],i=d(f)?f.length:f,j=d(g)?g.length:g,c=d(f)?f:null,e=d(g)?g:null;c&&(n=(c.length-1)/(c[c.length-1]-c[0])/(i-1)),e&&(o=(e.length-1)/(e[e.length-1]-e[0])/(j-1));var k=1/0,m=-1/0;for(a=0;a<j;a++)for(b=0,h[a]=[],p=e?(e[a]-e[0])*o:a/(j-1);b<i;b++)k=Math.min(l=(c?(c[b]-c[0])*n:b/(i-1))-p*r,k),m=Math.max(l,m),h[a][b]=l;var q=1/(m-k),s=-k*q;for(a=0;a<j;a++)for(b=0;b<i;b++)h[a][b]=q*h[a][b]+s;return h}},{"../../lib":515}],710:[function(a,b,c){"use strict";var d=a("./catmull_rom"),e=a("../../lib").ensureArray;function f(a,b,c){var d=-0.5*c[0]+1.5*b[0],e=-0.5*c[1]+1.5*b[1];return[(2*d+a[0])/3,(2*e+a[1])/3,]}b.exports=function(c,g,n,q,o,p){var k,l,b,a,t,u,v,w,j,i,r=n[0].length,s=n.length,h=o?3*r-2:r,m=p?3*s-2:s;for(b=0,c=e(c,m),g=e(g,m);b<m;b++)c[b]=e(c[b],h),g[b]=e(g[b],h);for(l=0,a=0;l<s;l++,a+=p?3:1)for(k=0,t=c[a],u=g[a],v=n[l],w=q[l],b=0;k<r;k++,b+=o?3:1)t[b]=v[k],u[b]=w[k];if(o)for(l=0,a=0;l<s;l++,a+=p?3:1){for(k=1,b=3;k<r-1;k++,b+=3)j=d([n[l][k-1],q[l][k-1]],[n[l][k],q[l][k]],[n[l][k+1],q[l][k+1]],o),c[a][b-1]=j[0][0],g[a][b-1]=j[0][1],c[a][b+1]=j[1][0],g[a][b+1]=j[1][1];i=f([c[a][0],g[a][0]],[c[a][2],g[a][2]],[c[a][3],g[a][3]]),c[a][1]=i[0],g[a][1]=i[1],i=f([c[a][h-1],g[a][h-1]],[c[a][h-3],g[a][h-3]],[c[a][h-4],g[a][h-4]]),c[a][h-2]=i[0],g[a][h-2]=i[1]}if(p)for(b=0;b<h;b++){for(a=3;a<m-3;a+=3)j=d([c[a-3][b],g[a-3][b]],[c[a][b],g[a][b]],[c[a+3][b],g[a+3][b]],p),c[a-1][b]=j[0][0],g[a-1][b]=j[0][1],c[a+1][b]=j[1][0],g[a+1][b]=j[1][1];i=f([c[0][b],g[0][b]],[c[2][b],g[2][b]],[c[3][b],g[3][b]]),c[1][b]=i[0],g[1][b]=i[1],i=f([c[m-1][b],g[m-1][b]],[c[m-3][b],g[m-3][b]],[c[m-4][b],g[m-4][b]]),c[m-2][b]=i[0],g[m-2][b]=i[1]}if(o&&p)for(a=1;a<m;a+=(a+1)%3==0?2:1){for(b=3;b<h-3;b+=3)j=d([c[a][b-3],g[a][b-3]],[c[a][b],g[a][b]],[c[a][b+3],g[a][b+3]],o),c[a][b-1]=.5*(c[a][b-1]+j[0][0]),g[a][b-1]=.5*(g[a][b-1]+j[0][1]),c[a][b+1]=.5*(c[a][b+1]+j[1][0]),g[a][b+1]=.5*(g[a][b+1]+j[1][1]);i=f([c[a][0],g[a][0]],[c[a][2],g[a][2]],[c[a][3],g[a][3]]),c[a][1]=.5*(c[a][1]+i[0]),g[a][1]=.5*(g[a][1]+i[1]),i=f([c[a][h-1],g[a][h-1]],[c[a][h-3],g[a][h-3]],[c[a][h-4],g[a][h-4]]),c[a][h-2]=.5*(c[a][h-2]+i[0]),g[a][h-2]=.5*(g[a][h-2]+i[1])}return[c,g]}},{"../../lib":515,"./catmull_rom":708}],711:[function(b,a,c){"use strict";a.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(b,a,c){"use strict";a.exports=function(c,a,b){return a&&b?function(g,a,b,h,e){g||(g=[]),a*=3,b*=3;var o,p,q,r,d,f,s=h*h,n=1-h,t=n*n,u=n*h*2,i=-3*t,j=3*(t-u),k=3*(u-s),l=3*s,v=e*e,x=v*e,m=1-e,w=m*m,y=w*m;for(f=0;f<c.length;f++)o=i*(d=c[f])[b][a]+j*d[b][a+1]+k*d[b][a+2]+l*d[b][a+3],p=i*d[b+1][a]+j*d[b+1][a+1]+k*d[b+1][a+2]+l*d[b+1][a+3],q=i*d[b+2][a]+j*d[b+2][a+1]+k*d[b+2][a+2]+l*d[b+2][a+3],r=i*d[b+3][a]+j*d[b+3][a+1]+k*d[b+3][a+2]+l*d[b+3][a+3],g[f]=y*o+3*(w*e*p+m*v*q)+x*r;return g}:a?function(f,a,b,g,i){f||(f=[]),a*=3;var j,k,e,d,l=g*g,h=1-g,m=h*h,n=h*g*2,o=-3*m,p=3*(m-n),q=3*(n-l),r=3*l,s=1-i;for(e=0;e<c.length;e++)j=o*(d=c[e])[b][a]+p*d[b][a+1]+q*d[b][a+2]+r*d[b][a+3],k=o*d[b+1][a]+p*d[b+1][a+1]+q*d[b+1][a+2]+r*d[b+1][a+3],f[e]=s*j+i*k;return f}:b?function(g,b,a,q,e){g||(g=[]),a*=3;var i,j,k,l,f,d,m=e*e,o=m*e,h=1-e,n=h*h,p=n*h;for(f=0;f<c.length;f++)i=(d=c[f])[a][b+1]-d[a][b],j=d[a+1][b+1]-d[a+1][b],k=d[a+2][b+1]-d[a+2][b],l=d[a+3][b+1]-d[a+3][b],g[f]=p*i+3*(n*e*j+h*m*k)+o*l;return g}:function(b,d,e,k,g){b||(b=[]);var h,i,a,f,j=1-g;for(a=0;a<c.length;a++)h=(f=c[a])[e][d+1]-f[e][d],i=f[e+1][d+1]-f[e+1][d],b[a]=j*h+g*i;return b}}},{}],713:[function(b,a,c){"use strict";a.exports=function(c,a,b){return a&&b?function(g,a,b,e,h){g||(g=[]),a*=3,b*=3;var o,p,q,r,d,f,s=e*e,x=s*e,i=1-e,t=i*i,y=t*i,u=h*h,n=1-h,v=n*n,w=n*h*2,j=-3*v,k=3*(v-w),l=3*(w-u),m=3*u;for(f=0;f<c.length;f++)o=j*(d=c[f])[b][a]+k*d[b+1][a]+l*d[b+2][a]+m*d[b+3][a],p=j*d[b][a+1]+k*d[b+1][a+1]+l*d[b+2][a+1]+m*d[b+3][a+1],q=j*d[b][a+2]+k*d[b+1][a+2]+l*d[b+2][a+2]+m*d[b+3][a+2],r=j*d[b][a+3]+k*d[b+1][a+3]+l*d[b+2][a+3]+m*d[b+3][a+3],g[f]=y*o+3*(t*e*p+i*s*q)+x*r;return g}:a?function(g,a,b,q,e){g||(g=[]),a*=3;var i,j,k,l,f,d,m=e*e,o=m*e,h=1-e,n=h*h,p=n*h;for(f=0;f<c.length;f++)i=(d=c[f])[b+1][a]-d[b][a],j=d[b+1][a+1]-d[b][a+1],k=d[b+1][a+2]-d[b][a+2],l=d[b+1][a+3]-d[b][a+3],g[f]=p*i+3*(n*e*j+h*m*k)+o*l;return g}:b?function(f,b,a,i,g){f||(f=[]),a*=3;var j,k,e,d,s=1-i,l=g*g,h=1-g,m=h*h,n=h*g*2,o=-3*m,p=3*(m-n),q=3*(n-l),r=3*l;for(e=0;e<c.length;e++)j=o*(d=c[e])[a][b]+p*d[a+1][b]+q*d[a+2][b]+r*d[a+3][b],k=o*d[a][b+1]+p*d[a+1][b+1]+q*d[a+2][b+1]+r*d[a+3][b+1],f[e]=s*j+i*k;return f}:function(b,d,e,g,k){b||(b=[]);var h,i,a,f,j=1-g;for(a=0;a<c.length;a++)h=(f=c[a])[e+1][d]-f[e][d],i=f[e+1][d+1]-f[e][d+1],b[a]=j*h+g*i;return b}}},{}],714:[function(b,a,c){"use strict";a.exports=function(e,c,d,a,b){var f=c-2,g=d-2;return a&&b?function(m,q,r){m||(m=[]);var s,t,u,v,c,i,a=Math.max(0,Math.min(Math.floor(q),f)),b=Math.max(0,Math.min(Math.floor(r),g)),d=Math.max(0,Math.min(1,q-a)),j=Math.max(0,Math.min(1,r-b));a*=3,b*=3;var k=d*d,n=k*d,h=1-d,l=h*h,o=l*h,w=j*j,y=w*j,p=1-j,x=p*p,z=x*p;for(i=0;i<e.length;i++)s=o*(c=e[i])[b][a]+3*(l*d*c[b][a+1]+h*k*c[b][a+2])+n*c[b][a+3],t=o*c[b+1][a]+3*(l*d*c[b+1][a+1]+h*k*c[b+1][a+2])+n*c[b+1][a+3],u=o*c[b+2][a]+3*(l*d*c[b+2][a+1]+h*k*c[b+2][a+2])+n*c[b+2][a+3],v=o*c[b+3][a]+3*(l*d*c[b+3][a+1]+h*k*c[b+3][a+2])+n*c[b+3][a+3],m[i]=z*s+3*(x*j*t+p*w*u)+y*v;return m}:a?function(j,m,n){j||(j=[]);var o,p,q,r,d,c,a=Math.max(0,Math.min(Math.floor(m),f)),b=Math.max(0,Math.min(Math.floor(n),g)),h=Math.max(0,Math.min(1,m-a)),i=Math.max(0,Math.min(1,n-b));a*=3;var s=h*h,u=s*h,k=1-h,t=k*k,v=t*k,l=1-i;for(d=0;d<e.length;d++)o=l*(c=e[d])[b][a]+i*c[b+1][a],p=l*c[b][a+1]+i*c[b+1][a+1],q=l*c[b][a+2]+i*c[b+1][a+1],r=l*c[b][a+3]+i*c[b+1][a+1],j[d]=v*o+3*(t*h*p+k*s*q)+u*r;return j}:b?function(j,m,n){j||(j=[]);var o,p,q,r,d,c,b=Math.max(0,Math.min(Math.floor(m),f)),a=Math.max(0,Math.min(Math.floor(n),g)),h=Math.max(0,Math.min(1,m-b)),i=Math.max(0,Math.min(1,n-a));a*=3;var s=i*i,u=s*i,k=1-i,t=k*k,v=t*k,l=1-h;for(d=0;d<e.length;d++)o=l*(c=e[d])[a][b]+h*c[a][b+1],p=l*c[a+1][b]+h*c[a+1][b+1],q=l*c[a+2][b]+h*c[a+2][b+1],r=l*c[a+3][b]+h*c[a+3][b+1],j[d]=v*o+3*(t*i*p+k*s*q)+u*r;return j}:function(d,j,k){d||(d=[]);var l,m,a,h,b=Math.max(0,Math.min(Math.floor(j),f)),c=Math.max(0,Math.min(Math.floor(k),g)),i=Math.max(0,Math.min(1,j-b)),n=Math.max(0,Math.min(1,k-c)),p=1-n,o=1-i;for(a=0;a<e.length;a++)l=o*(h=e[a])[c][b]+i*h[c][b+1],m=o*h[c+1][b]+i*h[c+1][b+1],d[a]=p*l+n*m;return d}}},{}],715:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./xy_defaults"),f=a("./ab_defaults"),g=a("./attributes"),h=a("../../components/color/attributes");b.exports=function(c,a,k,i){function b(b,e){return d.coerce(c,a,g,b,e)}a._clipPathId="clip"+a.uid+"carpet";var j=b("color",h.defaultLine);if(d.coerceFont(b,"font"),b("carpet"),f(c,a,i,b,j),!a.a||!a.b){a.visible=!1;return}a.a.length<3&&(a.aaxis.smoothing=0),a.b.length<3&&(a.baxis.smoothing=0),e(c,a,b)||(a.visible=!1),a._cheater&&b("cheaterslope")}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),plot:a("./plot"),calc:a("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(b,a,c){"use strict";a.exports=function(d,e){for(var b,f=d._fullData.length,c=0;c<f;c++){var a=d._fullData[c];if(a.index!==e.index&&"carpet"===a.type&&(b||(b=a),a.carpet===e.carpet))return a}return b}},{}],718:[function(b,a,c){"use strict";a.exports=function(b,d,e){if(0===b.length)return"";var a,c=[],f=e?3:1;for(a=0;a<b.length;a+=f)c.push(b[a]+","+d[a]),e&&a<b.length-f&&(c.push("C"),c.push([b[a+1]+","+d[a+1],b[a+2]+","+d[a+2]+" ",].join(" ")));return c.join(e?"":"L")}},{}],719:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray;b.exports=function(a,c,e){var b;for(d(a)?a.length>c.length&&(a=a.slice(0,c.length)):a=[],b=0;b<c.length;b++)a[b]=e(c[b]);return a}},{"../../lib":515}],720:[function(b,a,c){"use strict";a.exports=function(e,f,g,i,a,b){var j=a[0]*e.dpdx(f),k=a[1]*e.dpdy(g),c=1,h=1;if(b){var l=Math.sqrt(a[0]*a[0]+a[1]*a[1]),m=Math.sqrt(b[0]*b[0]+b[1]*b[1]),n=(a[0]*b[0]+a[1]*b[1])/l/m;h=Math.max(0,n)}var d=180*Math.atan2(k,j)/Math.PI;return d< -90?(d+=180,c=-c):d>90&&(d-=180,c=-c),{angle:d,flip:c,p:e.c2p(i,f,g),offsetMultplier:h}}},{}],721:[function(a,d,f){"use strict";var g=a("@plotly/d3"),h=a("../../components/drawing"),i=a("./map_1d_array"),j=a("./makepath"),k=a("./orient_text"),l=a("../../lib/svg_text_utils"),b=a("../../lib"),m=b.strRotate,n=b.strTranslate,c=a("../../constants/alignment");function o(f,k,c,l,d,e){var b="const-"+d+"-lines",a=c.selectAll("."+b).data(e);a.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),a.each(function(b){var a=b,c=a.x,d=a.y,e=i([],c,f.c2p),l=i([],d,k.c2p),m="M"+j(e,l,a.smoothing),n=g.select(this);n.attr("d",m).style("stroke-width",a.width).style("stroke",a.color).style("stroke-dasharray",h.dashStyle(a.dash,a.width)).style("fill","none")}),a.exit().remove()}function p(i,j,o,p,q,d,e,b){var a=d.selectAll("text."+b).data(e);a.enter().append("text").classed(b,!0);var f=0,c={};return a.each(function(a,r){if("auto"===a.axis.tickangle)b=k(p,j,o,a.xy,a.dxy);else{var b,d=(a.axis.tickangle+180)*Math.PI/180;b=k(p,j,o,a.xy,[Math.cos(d),Math.sin(d)])}r||(c={angle:b.angle,flip:b.flip});var e=(a.endAnchor?-1:1)*b.flip,s=g.select(this).attr({"text-anchor":e>0?"start":"end","data-notex":1}).call(h.font,a.font).text(a.text).call(l.convertToTspans,i),q=h.bBox(this);s.attr("transform",n(b.p[0],b.p[1])+m(b.angle)+n(a.axis.labelpadding*e,.3*q.height)),f=Math.max(f,q.width+a.axis.labelpadding)}),a.exit().remove(),c.maxExtent=f,c}d.exports=function(c,a,d,e){var f=a.xaxis,h=a.yaxis,l=c._fullLayout._clips;b.makeTraceGroups(e,d,"trace").each(function(L){var t=g.select(this),u=L[0],m=u.trace,n=m.aaxis,q=m.baxis,G=b.ensureSingle(t,"g","minorlayer"),H=b.ensureSingle(t,"g","majorlayer"),I=b.ensureSingle(t,"g","boundarylayer"),A=b.ensureSingle(t,"g","labellayer");t.style("opacity",m.opacity),o(f,h,H,n,"a",n._gridlines,!0),o(f,h,H,q,"b",q._gridlines,!0),o(f,h,G,n,"a",n._minorgridlines,!0),o(f,h,G,q,"b",q._minorgridlines,!0),o(f,h,I,n,"a-boundary",n._boundarylines),o(f,h,I,q,"b-boundary",q._boundarylines);var B,C,a,D,v,w,x,y,d,e,s,z,E,J,F,K,M=p(c,f,h,m,u,A,n._labels,"a-label"),N=p(c,f,h,m,u,A,q._labels,"b-label");B=c,C=A,a=m,D=u,v=f,w=h,x=M,y=N,E=b.aggNums(Math.min,null,a.a),J=b.aggNums(Math.max,null,a.a),F=b.aggNums(Math.min,null,a.b),K=b.aggNums(Math.max,null,a.b),d=.5*(E+J),e=F,s=a.ab2xy(d,e,!0),z=a.dxyda_rough(d,e),void 0===x.angle&&b.extendFlat(x,k(a,v,w,s,a.dxydb_rough(d,e))),r(B,C,a,D,s,z,a.aaxis,v,w,x,"a-title"),d=E,e=.5*(F+K),s=a.ab2xy(d,e,!0),z=a.dxydb_rough(d,e),void 0===y.angle&&b.extendFlat(y,k(a,v,w,s,a.dxyda_rough(d,e))),r(B,C,a,D,s,z,a.baxis,v,w,y,"b-title"),function(e,m,f,n,o){var d,g,h,a,c=f.select("#"+e._clipPathId);c.size()||(c=f.append("clipPath").classed("carpetclip",!0));var p=b.ensureSingle(c,"path","carpetboundary"),k=m.clipsegments,l=[];for(a=0;a<k.length;a++)g=i([],(d=k[a]).x,n.c2p),h=i([],d.y,o.c2p),l.push(j(g,h,d.bicubic));var q="M"+l.join("L")+"Z";c.attr("id",e._clipPathId),p.attr("d",q)}(m,u,l,f,h)})};var e=c.LINE_SPACING,q=(1-c.MID_SHIFT)/e+1;function r(j,f,o,p,r,s,b,t,u,i,c){var d=[];b.title.text&&d.push(b.title.text);var a=f.selectAll("text."+c).data(d),v=i.maxExtent;a.enter().append("text").classed(c,!0),a.each(function(){var a=k(o,t,u,r,s);-1===["start","both"].indexOf(b.showticklabels)&&(v=0);var d=b.title.font.size;v+=d+b.title.offset;var f=(i.angle+(i.flip<0?180:0)-a.angle+450)%360,c=g.select(this);c.text(b.title.text).call(l.convertToTspans,j),f>90&&f<270&&(v=(-l.lineCount(c)+q)*e*d-v),c.attr("transform",n(a.p[0],a.p[1])+m(a.angle)+n(0,v)).attr("text-anchor","middle").call(h.font,b.title.font)}),a.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(a,b,c){"use strict";var d=a("./constants"),e=a("../../lib/search").findBin,f=a("./compute_control_points"),g=a("./create_spline_evaluator"),h=a("./create_i_derivative_evaluator"),i=a("./create_j_derivative_evaluator");b.exports=function(a){var b=a._a,c=a._b,l=b.length,m=c.length,t=a.aaxis,u=a.baxis,n=b[0],o=b[l-1],p=c[0],q=c[m-1],r=b[b.length-1]-b[0],s=c[c.length-1]-c[0],j=r*d.RELATIVE_CULL_TOLERANCE,k=s*d.RELATIVE_CULL_TOLERANCE;n-=j,o+=j,p-=k,q+=k,a.isVisible=function(a,b){return a>n&&a<o&&b>p&&b<q},a.isOccluded=function(a,b){return a<n||a>o||b<p||b>q},a.setScale=function(){var c=a._x,d=a._y,b=f(a._xctrl,a._yctrl,c,d,t.smoothing,u.smoothing);a._xctrl=b[0],a._yctrl=b[1],a.evalxy=g([a._xctrl,a._yctrl],l,m,t.smoothing,u.smoothing),a.dxydi=h([a._xctrl,a._yctrl],t.smoothing,u.smoothing),a.dxydj=i([a._xctrl,a._yctrl],t.smoothing,u.smoothing)},a.i2a=function(c){var a=Math.max(0,Math.floor(c[0]),l-2),d=c[0]-a;return(1-d)*b[a]+d*b[a+1]},a.j2b=function(b){var a=Math.max(0,Math.floor(b[1]),l-2),d=b[1]-a;return(1-d)*c[a]+d*c[a+1]},a.ij2ab=function(b){return[a.i2a(b[0]),a.j2b(b[1])]},a.a2i=function(c){var a=Math.max(0,Math.min(e(c,b),l-2)),d=b[a],f=b[a+1];return Math.max(0,Math.min(l-1,a+(c-d)/(f-d)))},a.b2j=function(b){var a=Math.max(0,Math.min(e(b,c),m-2)),d=c[a],f=c[a+1];return Math.max(0,Math.min(m-1,a+(b-d)/(f-d)))},a.ab2ij=function(b){return[a.a2i(b[0]),a.b2j(b[1])]},a.i2c=function(b,c){return a.evalxy([],b,c)},a.ab2xy=function(d,e,r){if(!r&&(d<b[0]||d>b[l-1]|e<c[0]||e>c[m-1]))return[!1,!1];var p=a.a2i(d),q=a.b2j(e),i=a.evalxy([],p,q);if(r){var f,j,g,k,n=0,o=0,h=[];d<b[0]?(f=0,j=0,n=(d-b[0])/(b[1]-b[0])):d>b[l-1]?(f=l-2,j=1,n=(d-b[l-1])/(b[l-1]-b[l-2])):(f=Math.max(0,Math.min(l-2,Math.floor(p))),j=p-f),e<c[0]?(g=0,k=0,o=(e-c[0])/(c[1]-c[0])):e>c[m-1]?(g=m-2,k=1,o=(e-c[m-1])/(c[m-1]-c[m-2])):(g=Math.max(0,Math.min(m-2,Math.floor(q))),k=q-g),n&&(a.dxydi(h,f,g,j,k),i[0]+=h[0]*n,i[1]+=h[1]*n),o&&(a.dxydj(h,f,g,j,k),i[0]+=h[0]*o,i[1]+=h[1]*o)}return i},a.c2p=function(a,b,c){return[b.c2p(a[0]),c.c2p(a[1])]},a.p2x=function(a,b,c){return[b.p2c(a[0]),c.p2c(a[1])]},a.dadi=function(c){var a=Math.max(0,Math.min(b.length-2,c));return b[a+1]-b[a]},a.dbdj=function(b){var a=Math.max(0,Math.min(c.length-2,b));return c[a+1]-c[a]},a.dxyda=function(b,f,c,g){var d=a.dxydi(null,b,f,c,g),e=a.dadi(b,c);return[d[0]/e,d[1]/e]},a.dxydb=function(f,b,g,c){var d=a.dxydj(null,f,b,g,c),e=a.dbdj(b,c);return[d[0]/e,d[1]/e]},a.dxyda_rough=function(c,d,g){var b=r*(g||.1),e=a.ab2xy(c+b,d,!0),f=a.ab2xy(c-b,d,!0);return[(e[0]-f[0])*.5/b,(e[1]-f[1])*.5/b]},a.dxydb_rough=function(c,d,g){var b=s*(g||.1),e=a.ab2xy(c,d+b,!0),f=a.ab2xy(c,d-b,!0);return[(e[0]-f[0])*.5/b,(e[1]-f[1])*.5/b]},a.dpdx=function(a){return a._m},a.dpdy=function(a){return a._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(c,e,f){var v=[],B=[],i=c[0].length,j=c.length;function G(b,d){var a,e=0,f=0;return b>0&& void 0!==(a=c[d][b-1])&&(f++,e+=a),b<i-1&& void 0!==(a=c[d][b+1])&&(f++,e+=a),d>0&& void 0!==(a=c[d-1][b])&&(f++,e+=a),d<j-1&& void 0!==(a=c[d+1][b])&&(f++,e+=a),e/Math.max(1,f)}var y=0;for(a=0;a<i;a++)for(b=0;b<j;b++)void 0===c[b][a]&&(v.push(a),B.push(b),c[b][a]=G(a,b)),y=Math.max(y,Math.abs(c[b][a]));if(!v.length)return c;var H=1e-5,o=0,I=100,C=0,J=v.length;do{for(K=0,o=0;K<J;K++){a=v[K],b=B[K];var a,b,K,p,q,r,s,t,u,z,A,D,E,F,m,g,n,h,w,x,k=0,l=0;0===a?(n=e[w=Math.min(i-1,2)],h=e[1],m=c[b][w],g=c[b][1],l+=g+(g-m)*(e[0]-h)/(h-n),k++):a===i-1&&(n=e[w=Math.max(0,i-3)],h=e[i-2],m=c[b][w],g=c[b][i-2],l+=g+(g-m)*(e[i-1]-h)/(h-n),k++),(0===a||a===i-1)&&b>0&&b<j-1&&(p=f[b+1]-f[b],q=f[b]-f[b-1],l+=(q*c[b+1][a]+p*c[b-1][a])/(q+p),k++),0===b?(n=f[x=Math.min(j-1,2)],h=f[1],m=c[x][a],g=c[1][a],l+=g+(g-m)*(f[0]-h)/(h-n),k++):b===j-1&&(n=f[x=Math.max(0,j-3)],h=f[j-2],m=c[x][a],g=c[j-2][a],l+=g+(g-m)*(f[j-1]-h)/(h-n),k++),(0===b||b===j-1)&&a>0&&a<i-1&&(p=e[a+1]-e[a],q=e[a]-e[a-1],l+=(q*c[b][a+1]+p*c[b][a-1])/(q+p),k++),k?l/=k:(r=e[a+1]-e[a],s=e[a]-e[a-1],t=f[b+1]-f[b],u=f[b]-f[b-1],z=r*s*(r+s),A=t*u*(t+u),l=(z*(u*c[b+1][a]+t*c[b-1][a])+A*(s*c[b][a+1]+r*c[b][a-1]))/(A*(s+r)+z*(u+t))),o+=(E=(D=l-c[b][a])/y)*E,F=k?0:.85,c[b][a]+=D*(1+F)}o=Math.sqrt(o)}while((C++)<I&&o>H)return d.log("Smoother converged to",o,"after",C,"iterations"),c}},{"../../lib":515}],724:[function(a,b,c){"use strict";var d=a("../../lib").isArray1D;b.exports=function(i,a,h){var c=h("x"),f=c&&c.length,e=h("y"),g=e&&e.length;if(!f&&!g)return!1;if(a._cheater=!c,(!f||d(c))&&(!g||d(e))){var b=f?c.length:1/0;g&&(b=Math.min(b,e.length)),a.a&&a.a.length&&(b=Math.min(b,a.a.length)),a.b&&a.b.length&&(b=Math.min(b,a.b.length)),a._length=b}else a._length=null;return!0}},{"../../lib":515}],725:[function(c,f,j){"use strict";var g=c("../../plots/template_attributes").hovertemplateAttrs,a=c("../scattergeo/attributes"),h=c("../../components/colorscale/attributes"),d=c("../../plots/attributes"),i=c("../../components/color/attributes").defaultLine,b=c("../../lib/extend").extendFlat,e=a.marker.line;f.exports=b({locations:{valType:"data_array",editType:"calc"},locationmode:a.locationmode,z:{valType:"data_array",editType:"calc"},geojson:b({},a.geojson,{}),featureidkey:a.featureidkey,text:b({},a.text,{}),hovertext:b({},a.hovertext,{}),marker:{line:{color:b({},e.color,{dflt:i}),width:b({},e.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:a.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:b({},d.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:g(),showlegend:b({},d.showlegend,{dflt:!1})},h("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../constants/numerical").BADNUM,f=a("../../components/colorscale/calc"),g=a("../scatter/arrays_to_calcdata"),h=a("../scatter/calc_selection");function i(a){return a&&"string"==typeof a}b.exports=function(o,a){var k,l=a._length,j=new Array(l);k=a.geojson?function(a){return i(a)||d(a)}:i;for(var b=0;b<l;b++){var c=j[b]={},m=a.locations[b],n=a.z[b];k(m)&&d(n)?(c.loc=m,c.z=n):(c.loc=null,c.z=e),c.index=b}return g(j,a),f(o,a,{vals:a.z,containerStr:"",cLetter:"z"}),h(j,a),j}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(j,b,l,k){function a(a,c){return d.coerce(j,b,f,a,c)}var i,c=a("locations"),g=a("z");if(!(c&&c.length&&d.isArrayOrTypedArray(g)&&g.length)){b.visible=!1;return}b._length=Math.min(c.length,g.length);var h=a("geojson");("string"==typeof h&&""!==h||d.isPlainObject(h))&&(i="geojson-id"),"geojson-id"===a("locationmode",i)&&a("featureidkey"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),e(j,b,k,a,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(b,a)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(b,a,c){"use strict";a.exports=function(a,c,f,d,e){a.location=c.location,a.z=c.z;var b=d[e];return b.fIn&&b.fIn.properties&&(a.properties=b.fIn.properties),a.ct=b.ct,a}},{}],729:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("./attributes"),f=a("../../lib").fillText;b.exports=function(a,j,k){var b,h,g,c,i=a.cd,m=i[0].trace,l=a.subplot,n=[j,k],o=[j+360,k];for(h=0;h<i.length;h++)if(b=i[h],c=!1,b._polygons){for(g=0;g<b._polygons.length;g++)b._polygons[g].contains(n)&&(c=!c),b._polygons[g].contains(o)&&(c=!c);if(c)break}if(c&&b)return a.x0=a.x1=a.xa.c2p(b.ct),a.y0=a.y1=a.ya.c2p(b.ct),a.index=b.index,a.location=b.loc,a.z=b.z,a.zLabel=d.tickText(l.mockAxis,l.mockAxis.c2l(b.z),"hover").text,a.hovertemplate=b.hovertemplate,function(a,b,g){if(!b.hovertemplate){var h=g.hi||b.hoverinfo,i=String(g.loc),c="all"===h?e.hoverinfo.flags:h.split("+"),j=-1!==c.indexOf("name"),k=-1!==c.indexOf("location"),l=-1!==c.indexOf("z"),m=-1!==c.indexOf("text"),n=!j&&k,d=[];n?a.nameOverride=i:(j&&(a.nameOverride=b.name),k&&d.push(i)),l&&d.push(a.zLabel),m&&f(g,b,d),a.extraText=d.join("<br>")}}(a,m,b),[a]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),calc:a("./calc"),calcGeoJSON:a("./plot").calcGeoJSON,plot:a("./plot").plot,style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"choropleth",basePlotModule:a("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../lib/geo_location_utils"),g=a("../../lib/topojson_utils").getTopojsonFeatures,h=a("../../plots/cartesian/autorange").findExtremes,i=a("./style").style;b.exports={calcGeoJSON:function(k,p){for(var a=k[0].trace,d=p[a.geo],q=d._subplot,e=a.locationmode,r=a._length,s="geojson-id"===e?f.extractTraceFeature(k):g(a,q.topojson),l=[],m=[],n=0;n<r;n++){var b=k[n],c="geojson-id"===e?b.fOut:f.locationToFeature(e,b.loc,s);if(c){b.geojson=c,b.ct=c.properties.ct,b._polygons=f.feature2polygons(c);var i=f.computeBbox(c);l.push(i[0],i[2]),m.push(i[1],i[3])}else b.geojson=null}if("geojson"===d.fitbounds&&"geojson-id"===e){var j=f.computeBbox(f.getTraceGeojson(a));l=[j[0],j[2]],m=[j[1],j[3]]}var o={padded:!0};a._extremes.lon=h(d.lonaxis._ax,l,o),a._extremes.lat=h(d.lataxis._ax,m,o)},plot:function(f,a,b){var c=a.layers.backplot.select(".choroplethlayer");e.makeTraceGroups(c,b,"trace choropleth").each(function(b){var a=d.select(this).selectAll("path.choroplethlocation").data(e.identity);a.enter().append("path").classed("choroplethlocation",!0),a.exit().remove(),i(f,b)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(b,a,c){"use strict";a.exports=function(c,f){var a,e,b,g,h,d=c.cd,j=c.xaxis,k=c.yaxis,i=[];if(!1===f)for(a=0;a<d.length;a++)d[a].selected=0;else for(a=0;a<d.length;a++)(b=(e=d[a]).ct)&&(g=j.c2p(b),h=k.c2p(b),f.contains([g,h],null,a,c)?(i.push({pointNumber:a,lon:b[0],lat:b[1]}),e.selected=1):e.selected=0);return i}},{}],733:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../components/color"),f=a("../../components/drawing"),g=a("../../components/colorscale");function h(i,b){var a=b[0].trace,c=b[0].node3.selectAll(".choroplethlocation"),h=a.marker||{},j=h.line||{},k=g.makeColorScaleFuncFromTrace(a);c.each(function(a){d.select(this).attr("fill",k(a.z)).call(e.stroke,a.mlc||j.color).call(f.dashLine,"",a.mlw||j.width||0).style("opacity",h.opacity)}),f.selectedPointStyle(c,a)}b.exports={style:function(b,a){a&&h(b,a)},styleOnSelect:function(c,a){var d=a[0].node3,b=a[0].trace;b.selectedpoints?f.selectedPointStyle(d.selectAll(".choroplethlocation"),b):h(c,a)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(c,d,h){"use strict";var a=c("../choropleth/attributes"),e=c("../../components/colorscale/attributes"),f=c("../../plots/template_attributes").hovertemplateAttrs,g=c("../../plots/attributes"),b=c("../../lib/extend").extendFlat;d.exports=b({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:b({},a.featureidkey,{}),below:{valType:"string",editType:"plot"},text:a.text,hovertext:a.hovertext,marker:{line:{color:b({},a.marker.line.color,{editType:"plot"}),width:b({},a.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:b({},a.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:b({},a.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:b({},a.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:a.hoverinfo,hovertemplate:f({},{keys:["properties"]}),showlegend:b({},g.showlegend,{dflt:!1})},e("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(a,b,d){"use strict";var e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../components/colorscale"),h=a("../../components/drawing"),i=a("../../lib/geojson_utils").makeBlank,j=a("../../lib/geo_location_utils");function c(c){var b,a=c[0].trace,d=a._opts;if(a.selectedpoints){for(var i=h.makeSelectedPointStyleFns(a),e=0;e<c.length;e++){var g=c[e];g.fOut&&(g.fOut.properties.mo2=i.selectedOpacityFn(g))}b={type:"identity",property:"mo2"}}else b=f.isArrayOrTypedArray(a.marker.opacity)?{type:"identity",property:"mo"}:a.marker.opacity;return f.extendFlat(d.fill.paint,{"fill-opacity":b}),f.extendFlat(d.line.paint,{"line-opacity":b}),d}b.exports={convert:function(b){var k,l,m,d=b[0].trace,w=!0===d.visible&&0!==d._length,p={layout:{visibility:"none"},paint:{}},q={layout:{visibility:"none"},paint:{}},n=d._opts={fill:p,line:q,geojson:i()};if(!w)return n;var u=j.extractTraceFeature(b);if(!u)return n;var x=g.makeColorScaleFuncFromTrace(d),r=d.marker,o=r.line||{};f.isArrayOrTypedArray(r.opacity)&&(k=function(b){var a=b.mo;return e(a)?+f.constrain(a,0,1):0}),f.isArrayOrTypedArray(o.color)&&(l=function(a){return a.mlc}),f.isArrayOrTypedArray(o.width)&&(m=function(a){return a.mlw});for(var s=0;s<b.length;s++){var a=b[s],t=a.fOut;if(t){var h=t.properties;h.fc=x(a.z),k&&(h.mo=k(a)),l&&(h.mlc=l(a)),m&&(h.mlw=m(a)),a.ct=h.ct,a._polygons=j.feature2polygons(t)}}var v=k?{type:"identity",property:"mo"}:r.opacity;return f.extendFlat(p.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":v}),f.extendFlat(q.paint,{"line-color":l?{type:"identity",property:"mlc"}:o.color,"line-width":m?{type:"identity",property:"mlw"}:o.width,"line-opacity":v}),p.layout.visibility="visible",q.layout.visibility="visible",n.geojson={type:"FeatureCollection",features:u},c(b),n},convertOnSelect:c}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(i,b,k,j){function a(a,c){return d.coerce(i,b,f,a,c)}var c=a("locations"),g=a("z"),h=a("geojson");if(!d.isArrayOrTypedArray(c)||!c.length||!d.isArrayOrTypedArray(g)||!g.length||!("string"==typeof h&&""!==h||d.isPlainObject(h))){b.visible=!1;return}a("featureidkey"),b._length=Math.min(c.length,g.length),a("below"),a("text"),a("hovertext"),a("hovertemplate"),a("marker.line.width")&&a("marker.line.color"),a("marker.opacity"),e(i,b,j,a,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(b,a)}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),calc:a("../choropleth/calc"),plot:a("./plot"),hoverPoints:a("../choropleth/hover"),eventData:a("../choropleth/event_data"),selectPoints:a("../choropleth/select"),styleOnSelect:function(b,a){a&&a[0].trace._glTrace.updateOnSelect(a)},getBelow:function(f,e){for(var b=e.getMapLayers(),c=b.length-2;c>=0;c--){var a=b[c].id;if("string"==typeof a&&0===a.indexOf("water")){for(var d=c+1;d<b.length;d++)if("string"==typeof(a=b[d].id)&& -1===a.indexOf("plotly-"))return a}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:a("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(b,c,e){"use strict";var f=b("./convert").convert,g=b("./convert").convertOnSelect,h=b("../../plots/mapbox/constants").traceLayerPrefix;function d(b,a){this.type="choroplethmapbox",this.subplot=b,this.uid=a,this.sourceId="source-"+a,this.layerList=[["fill",h+a+"-fill"],["line",h+a+"-line"]],this.below=null}var a=d.prototype;a.update=function(a){this._update(f(a)),a[0].trace._glTrace=this},a.updateOnSelect=function(a){this._update(g(a))},a._update=function(b){var a=this.subplot,f=this.layerList,c=a.belowLookup["trace-"+this.uid];a.map.getSource(this.sourceId).setData(b.geojson),c!==this.below&&(this._removeLayers(),this._addLayers(b,c),this.below=c);for(var d=0;d<f.length;d++){var g=f[d],i=g[0],h=g[1],e=b[i];a.setOptions(h,"setLayoutProperty",e.layout),"visible"===e.layout.visibility&&a.setOptions(h,"setPaintProperty",e.paint)}},a._addLayers=function(f,g){for(var h=this.subplot,b=this.layerList,i=this.sourceId,a=0;a<b.length;a++){var c=b[a],d=c[0],e=f[d];h.addLayer({type:d,id:c[1],source:i,layout:e.layout,paint:e.paint},g)}},a._removeLayers=function(){for(var c=this.subplot.map,b=this.layerList,a=b.length-1;a>=0;a--)c.removeLayer(b[a][1])},a.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},c.exports=function(b,c){var e=c[0].trace,a=new d(b,e.uid),h=a.sourceId,g=f(c),i=a.below=b.belowLookup["trace-"+e.uid];return b.map.addSource(h,{type:"geojson",data:g.geojson}),a._addLayers(g,i),c[0].trace._glTrace=a,a}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(a,f,i){"use strict";var g=a("../../components/colorscale/attributes"),b=a("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=a("../../plots/template_attributes").hovertemplateAttrs,j=a("../mesh3d/attributes"),e=a("../../plots/attributes"),d=a("../../lib/extend").extendFlat,c={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:h({editType:"calc"},{keys:["norm"]}),uhoverformat:b("u",1),vhoverformat:b("v",1),whoverformat:b("w",1),xhoverformat:b("x"),yhoverformat:b("y"),zhoverformat:b("z"),showlegend:d({},e.showlegend,{dflt:!1})};d(c,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){c[a]=j[a]}),c.hoverinfo=d({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),c.transforms=void 0,f.exports=c},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(n,a){for(var f=a.u,g=a.v,h=a.w,i=Math.min(a.x.length,a.y.length,a.z.length,f.length,g.length,h.length),c=-1/0,e=1/0,b=0;b<i;b++){var j=f[b],k=g[b],l=h[b],m=Math.sqrt(j*j+k*k+l*l);c=Math.max(c,m),e=Math.min(e,m)}a._len=i,a._normMax=c,d(n,a,{vals:[e,c],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(a,c,e){"use strict";var f=a("../../../stackgl_modules").gl_cone3d,g=a("../../../stackgl_modules").gl_cone3d.createConeMesh,h=a("../../lib").simpleMap,i=a("../../lib/gl_format_color").parseColorScale,j=a("../../components/colorscale").extractOpts,k=a("../../plots/gl3d/zip3");function d(a,b){this.scene=a,this.uid=b,this.mesh=null,this.data=null}var b=d.prototype;b.handlePick=function(b){if(b.object===this.mesh){var a=b.index=b.data.index,g=this.data.x[a],h=this.data.y[a],i=this.data.z[a],d=this.data.u[a],e=this.data.v[a],f=this.data.w[a];b.traceCoordinate=[g,h,i,d,e,f,Math.sqrt(d*d+e*e+f*f)];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&& void 0!==c[a]?b.textLabel=c[a]:c&&(b.textLabel=c),!0}};var l={xaxis:0,yaxis:1,zaxis:2},m={tip:1,tail:0,cm:.25,center:.5},n={tip:1,tail:1,cm:.75,center:.5};function o(g,a){var p=g.fullSceneLayout,q=g.dataScale,c={};function d(b,a){var c=p[a],d=q[l[a]];return h(b,function(a){return c.d2l(a)*d})}c.vectors=k(d(a.u,"xaxis"),d(a.v,"yaxis"),d(a.w,"zaxis"),a._len),c.positions=k(d(a.x,"xaxis"),d(a.y,"yaxis"),d(a.z,"zaxis"),a._len);var o=j(a);c.colormap=i(a),c.vertexIntensityBounds=[o.min/a._normMax,o.max/a._normMax],c.coneOffset=m[a.anchor],"scaled"===a.sizemode?c.coneSize=a.sizeref||.5:c.coneSize=a.sizeref&&a._normMax?a.sizeref/a._normMax:.5;var b=f(c),e=a.lightposition;return b.lightPosition=[e.x,e.y,e.z],b.ambient=a.lighting.ambient,b.diffuse=a.lighting.diffuse,b.specular=a.lighting.specular,b.roughness=a.lighting.roughness,b.fresnel=a.lighting.fresnel,b.opacity=a.opacity,a._pad=n[a.anchor]*b.vectorScale*b.coneScale*a._normMax,b}b.update=function(a){this.data=a;var b=o(this.scene,a);this.mesh.update(b)},b.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},c.exports=function(a,c){var f=a.glplot.gl,h=o(a,c),e=g(f,h),b=new d(a,c.uid);return b.mesh=e,b.data=c,e._trace=b,a.glplot.add(e),b}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(l,b,n,m){function a(a,c){return d.coerce(l,b,f,a,c)}var c=a("u"),g=a("v"),h=a("w"),i=a("x"),j=a("y"),k=a("z");if(!c||!c.length||!g||!g.length||!h||!h.length||!i||!i.length||!j||!j.length||!k||!k.length){b.visible=!1;return}a("sizeref"),a("sizemode"),a("anchor"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),e(l,b,m,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),b._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"cone",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:a("./calc"),plot:a("./convert"),eventData:function(a,b){return a.norm=b.traceCoordinate[6],a},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(b,i,p){"use strict";var a=b("../heatmap/attributes"),d=b("../scatter/attributes"),f=b("../../plots/cartesian/axis_format_attributes"),e=f.axisHoverFormat,j=f.descriptionOnlyNumbers,k=b("../../components/colorscale/attributes"),l=b("../../components/drawing/attributes").dash,m=b("../../plots/font_attributes"),c=b("../../lib/extend").extendFlat,g=b("../../constants/filter_ops"),n=g.COMPARISON_OPS2,o=g.INTERVAL_OPS,h=d.line;i.exports=c({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,text:a.text,hovertext:a.hovertext,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:a.hovertemplate,texttemplate:c({},a.texttemplate,{}),textfont:c({},a.textfont,{}),hoverongaps:a.hoverongaps,connectgaps:c({},a.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:m({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:j("contour label")},operation:{valType:"enumerated",values:[].concat(n).concat(o),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:c({},h.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:l,smoothing:c({},h.smoothing,{}),editType:"plot"}},k("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(a,b,c){"use strict";var d=a("../../components/colorscale"),e=a("../heatmap/calc"),f=a("./set_contours"),g=a("./end_plus");b.exports=function(i,a){var h,j=e(i,a),k=j[0].z;f(a,k);var c=a.contours,o=d.extractOpts(a);if("heatmap"===c.coloring&&o.auto&& !1===a.autocontour){var l=c.start,p=g(c),b=c.size||1,m=Math.floor((p-l)/b)+1;isFinite(b)||(b=1,m=1);var n=l-b/2,q=n+m*b;h=[n,q]}else h=k;return d.calc(i,a,{vals:h,cLetter:"z"}),j}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(b,a,c){"use strict";a.exports=function(j,k){var c=j[0],f=c.z;switch(k.type){case"levels":var n=Math.min(f[0][0],f[0][1]);for(a=0;a<j.length;a++){var g=j[a];g.prefixBoundary=!g.edgepaths.length&&(n>g.level||g.starts.length&&n===g.level)}break;case"constraint":if(c.prefixBoundary=!1,c.edgepaths.length)return;var a,i,h,l=c.x.length,m=c.y.length,d=-1/0,b=1/0;for(a=0;a<m;a++)b=Math.min(b,f[a][0]),b=Math.min(b,f[a][l-1]),d=Math.max(d,f[a][0]),d=Math.max(d,f[a][l-1]);for(a=1;a<l-1;a++)b=Math.min(b,f[0][a]),b=Math.min(b,f[m-1][a]),d=Math.max(d,f[0][a]),d=Math.max(d,f[m-1][a]);var e=k.value;switch(k._operation){case">":e>d&&(c.prefixBoundary=!0);break;case"<":(e<b||c.starts.length&&e===b)&&(c.prefixBoundary=!0);break;case"[]":i=Math.min(e[0],e[1]),h=Math.max(e[0],e[1]),(h<b||i>d||c.starts.length&&h===b)&&(c.prefixBoundary=!0);break;case"][":i=Math.min(e[0],e[1]),h=Math.max(e[0],e[1]),i<b&&h>d&&(c.prefixBoundary=!0);break}break}}},{}],747:[function(a,b,c){"use strict";var d=a("../../components/colorscale"),e=a("./make_color_map"),f=a("./end_plus");b.exports={min:"zmin",max:"zmax",calc:function(l,g,a){var b=g.contours,h=g.line,k=b.size||1,i=b.coloring,j=e(g,{isColorbar:!0});if("heatmap"===i){var c=d.extractOpts(g);a._fillgradient=c.reversescale?d.flipScale(c.colorscale):c.colorscale,a._zrange=[c.min,c.max]}else"fill"===i&&(a._fillcolor=j);a._line={color:"lines"===i?j:h.color,width:!1!==b.showlines?h.width:0,dash:h.dash},a._levels={start:b.start,end:f(b),size:k}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(b,a,c){"use strict";a.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(a,d,e){"use strict";var f=a("fast-isnumeric"),g=a("./label_defaults"),b=a("../../components/color"),h=b.addOpacity,i=b.opacity,c=a("../../constants/filter_ops"),j=c.CONSTRAINT_REDUCTION,k=c.COMPARISON_OPS2;d.exports=function(r,n,b,s,o,t){var d,p,e,l,a,c,m=n.contours,q=b("contours.operation");m._operation=j[q],l=b,a=m,-1===k.indexOf(a.operation)?(l("contours.value",[0,1]),Array.isArray(a.value)?a.value.length>2?a.value=a.value.slice(2):0===a.length?a.value=[0,1]:a.length<2?(c=parseFloat(a.value[0]),a.value=[c,c+1]):a.value=[parseFloat(a.value[0]),parseFloat(a.value[1])]:f(a.value)&&(c=parseFloat(a.value),a.value=[c,c+1])):(l("contours.value",0),f(a.value)||(Array.isArray(a.value)?a.value=parseFloat(a.value[0]):a.value=0)),"="===q?d=m.showlines=!0:(d=b("contours.showlines"),e=b("fillcolor",h((r.line||{}).color||o,.5))),d&&(p=b("line.color",e&&i(e)?h(n.fillcolor,1):o),b("line.width",2),b("line.dash")),b("line.smoothing"),g(b,s,p,t)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(b,d,e){"use strict";var f=b("../../constants/filter_ops"),g=b("fast-isnumeric");function h(d,a){var c,e=Array.isArray(a);function b(a){return g(a)?+a:null}return -1!==f.COMPARISON_OPS2.indexOf(d)?c=b(e?a[0]:a):-1!==f.INTERVAL_OPS.indexOf(d)?c=e?[b(a[0]),b(a[1])]:[b(a),b(a)]:-1!==f.SET_OPS.indexOf(d)&&(c=e?a.map(b):[b(a)]),c}function c(a){return function(b){var c=Math.min((b=h(a,b))[0],b[1]),d=Math.max(b[0],b[1]);return{start:c,end:d,size:d-c}}}function a(a){return function(b){return{start:b=h(a,b),end:1/0,size:1/0}}}d.exports={"[]":c("[]"),"][":c("]["),">":a(">"),"<":a("<"),"=":a("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(b,a,c){"use strict";a.exports=function(g,c,a,b){var d=b("contours.start"),e=b("contours.end"),f=a("contours.size");((!1===d|| !1===e?c.autocontour=!0:a("autocontour",!1))||!f)&&a("ncontours")}},{}],752:[function(a,b,c){"use strict";var d=a("../../lib");function e(a){return d.extendFlat({},a,{edgepaths:d.extendDeep([],a.edgepaths),paths:d.extendDeep([],a.paths),starts:d.extendDeep([],a.starts)})}b.exports=function(f,i){var a,b,g,c=function(a){return a.reverse()},h=function(a){return a};switch(i){case"=":case"<":return f;case">":for(1!==f.length&&d.warn("Contour data invalid for the specified inequality operation."),b=f[0],a=0;a<b.edgepaths.length;a++)b.edgepaths[a]=c(b.edgepaths[a]);for(a=0;a<b.paths.length;a++)b.paths[a]=c(b.paths[a]);for(a=0;a<b.starts.length;a++)b.starts[a]=c(b.starts[a]);return f;case"][":var j=c;c=h,h=j;case"[]":for(2!==f.length&&d.warn("Contour data invalid for the specified inequality range operation."),b=e(f[0]),g=e(f[1]),a=0;a<b.edgepaths.length;a++)b.edgepaths[a]=c(b.edgepaths[a]);for(a=0;a<b.paths.length;a++)b.paths[a]=c(b.paths[a]);for(a=0;a<b.starts.length;a++)b.starts[a]=c(b.starts[a]);for(;g.edgepaths.length;)b.edgepaths.push(h(g.edgepaths.shift()));for(;g.paths.length;)b.paths.push(h(g.paths.shift()));for(;g.starts.length;)b.starts.push(h(g.starts.shift()));return[b]}}},{"../../lib":515}],753:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../heatmap/xyz_defaults"),f=a("../scatter/period_defaults"),g=a("./constraint_defaults"),h=a("./contours_defaults"),i=a("./style_defaults"),j=a("../heatmap/label_defaults"),k=a("./attributes");b.exports=function(c,b,m,l){function a(a,e){return d.coerce(c,b,k,a,e)}if(!e(c,b,a,l)){b.visible=!1;return}f(c,b,l,a),a("xhoverformat"),a("yhoverformat"),a("text"),a("hovertext"),a("hoverongaps"),a("hovertemplate");var n="constraint"===a("contours.type");a("connectgaps",d.isArray1D(b.z)),n?g(c,b,a,l,m):(h(c,b,a,function(a){return d.coerce2(c,b,k,a)}),i(c,b,a,l)),b.contours&&"heatmap"===b.contours.coloring&&j(a,l)}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./constraint_mapping"),f=a("./end_plus");b.exports=function(b,j,a){for(var c="constraint"===b.type?e[b._operation](b.value):b,k=c.size,g=[],l=f(c),h=a.trace._carpetTrace,m=h?{xaxis:h.aaxis,yaxis:h.baxis,x:a.a,y:a.b}:{xaxis:j.xaxis,yaxis:j.yaxis,x:a.x,y:a.y},i=c.start;i<l;i+=k)if(g.push(d.extendFlat({level:i,crossings:{},starts:[],edgepaths:[],paths:[],z:a.z,smoothing:a.trace.line.smoothing},m)),g.length>1e3){d.warn("Too many contours, clipping at 1000",b);break}return g}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(b,a,c){"use strict";a.exports=function(a){return a.end+a.size/1e6}},{}],756:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./constants");function f(a,b,c,d){return Math.abs(a[0]-b[0])<c&&Math.abs(a[1]-b[1])<d}function g(a,b){var c=a[2]-b[2],d=a[3]-b[3];return Math.sqrt(c*c+d*d)}function h(c,h,C,t,u){var b,v,m,n,F,G,s,H,k,o,q,A,w=h.join(","),p=c.crossings[w],l=i(p,C,h),a=[j(c,h,[-l[0],-l[1]])],L=c.z.length,M=c.z[0].length,D=h.slice(),I=l.slice();for(b=0;b<1e4;b++){if(p>20?(p=e.CHOOSESADDLE[p][0>(l[0]||l[1])?0:1],c.crossings[w]=e.SADDLEREMAINDER[p]):delete c.crossings[w],!(l=e.NEWDELTA[p])){d.log("Found bad marching index:",p,h,c.level);break}a.push(j(c,h,l)),h[0]+=l[0],h[1]+=l[1],w=h.join(","),f(a[a.length-1],a[a.length-2],t,u)&&a.pop();var N=l[0]&&(h[0]<0||h[0]>M-2)||l[1]&&(h[1]<0||h[1]>L-2),O=h[0]===D[0]&&h[1]===D[1]&&l[0]===I[0]&&l[1]===I[1];if(O||C&&N)break;p=c.crossings[w]}1e4===b&&d.log("Infinite loop in contour?");var x=f(a[0],a[a.length-1],t,u),J=0,P=.2*c.smoothing,r=[],B=0;for(b=1;b<a.length;b++)J+=H=g(a[b],a[b-1]),r.push(H);var E=J/r.length*P;function y(b){return a[b%a.length]}for(b=a.length-2;b>=B;b--)if((v=r[b])<E){for(n=0,m=b-1;m>=B&&v+r[m]<E;m--)v+=r[m];if(x&&b===a.length-2)for(n=0;n<m&&v+r[n]<E;n++)v+=r[n];G=b-m+n+1,s=Math.floor((b+m+n+2)/2),F=x||b!==a.length-2?x|| -1!==m?G%2?y(s):[(y(s)[0]+y(s+1)[0])/2,(y(s)[1]+y(s+1)[1])/2]:a[0]:a[a.length-1],a.splice(m+1,b-m+1,F),b=m+1,n&&(B=n),x&&(b===a.length-2?a[n]=a[a.length-1]:0===b&&(a[a.length-1]=a[0]))}for(a.splice(0,B),b=0;b<a.length;b++)a[b].length=2;if(!(a.length<2))if(x)a.pop(),c.paths.push(a);else{C||d.log("Unclosed interior contour?",c.level,D.join(","),a.join("L"));var z=!1;for(k=0;k<c.edgepaths.length;k++)if(q=c.edgepaths[k],!z&&f(q[0],a[a.length-1],t,u)){a.pop(),z=!0;var K=!1;for(o=0;o<c.edgepaths.length;o++)if(f((A=c.edgepaths[o])[A.length-1],a[0],t,u)){K=!0,a.shift(),c.edgepaths.splice(k,1),o===k?c.paths.push(a.concat(A)):(o>k&&o--,c.edgepaths[o]=A.concat(a,q));break}K||(c.edgepaths[k]=a.concat(q))}for(k=0;k<c.edgepaths.length&&!z;k++)f((q=c.edgepaths[k])[q.length-1],a[0],t,u)&&(a.shift(),c.edgepaths[k]=q.concat(a),z=!0);z||c.edgepaths.push(a)}}function i(a,f,d){var b=0,c=0;return a>20&&f?208===a||1114===a?b=0===d[0]?1:-1:c=0===d[1]?1:-1:-1!==e.BOTTOMSTART.indexOf(a)?c=1:-1!==e.LEFTSTART.indexOf(a)?b=1:-1!==e.TOPSTART.indexOf(a)?c=-1:b=-1,[b,c]}function j(a,j,i){var b=j[0]+Math.max(i[0],0),c=j[1]+Math.max(i[1],0),h=a.z[c][b],d=a.xaxis,e=a.yaxis;if(i[1]){var f=(a.level-h)/(a.z[c][b+1]-h),k=(1!==f?(1-f)*d.c2l(a.x[b]):0)+(0!==f?f*d.c2l(a.x[b+1]):0);return[d.c2p(d.l2c(k),!0),e.c2p(a.y[c],!0),b+f,c]}var g=(a.level-h)/(a.z[c+1][b]-h),l=(1!==g?(1-g)*e.c2l(a.y[c]):0)+(0!==g?g*e.c2l(a.y[c+1]):0);return[d.c2p(a.x[b],!0),e.c2p(e.l2c(l),!0),b,c+g]}b.exports=function(j,b,c){var e,f,g,a,i;for(g=0,b=b||.01,c=c||.01;g<j.length;g++){for(i=0,a=j[g];i<a.starts.length;i++)f=a.starts[i],h(a,f,"edge",b,c);for(e=0;Object.keys(a.crossings).length&&e<1e4;)e++,f=Object.keys(a.crossings)[0].split(",").map(Number),h(a,f,void 0,b,c);1e4===e&&d.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../heatmap/hover");b.exports=function(c,f,g,h,a){a||(a={}),a.isContour=!0;var b=e(c,f,g,h,a);return b&&b.forEach(function(b){var a=b.trace;"constraint"===a.contours.type&&(a.fillcolor&&d.opacity(a.fillcolor)?b.color=d.addOpacity(a.fillcolor,1):a.contours.showlines&&d.opacity(a.line.color)&&(b.color=d.addOpacity(a.line.color,1)))}),b}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot").plot,style:a("./style"),colorbar:a("./colorbar"),hoverPoints:a("./hover"),moduleType:"trace",name:"contour",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,e,f,b){if(b||(b={}),a("contours.showlabels")){var c=e.font;d.coerceFont(a,"contours.labelfont",{family:c.family,size:c.size,color:f}),a("contours.labelformat")}!1!==b.hasHover&&a("zhoverformat")}},{"../../lib":515}],760:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../components/colorscale"),f=a("./end_plus");b.exports=function(p){var g,a,c=p.contours,q=c.start,v=f(c),i=c.size||1,n=Math.floor((v-q)/i)+1,r="lines"===c.coloring?0:1,j=e.extractOpts(p);isFinite(i)||(i=1,n=1);var o=j.reversescale?e.flipScale(j.colorscale):j.colorscale,m=o.length,k=new Array(m),b=new Array(m);if("heatmap"===c.coloring){var h=j.min,l=j.max;for(a=0;a<m;a++)g=o[a],k[a]=g[0]*(l-h)+h,b[a]=g[1];var s=d.extent([h,l,c.start,c.start+i*(n-1)]),t=s[h<l?0:1],u=s[h<l?1:0];t!==h&&(k.splice(0,0,t),b.splice(0,0,b[0])),u!==l&&(k.push(u),b.push(b[b.length-1]))}else for(a=0;a<m;a++)g=o[a],k[a]=(g[0]*(n+r-1)-r/2)*i+q,b[a]=g[1];return e.makeColorScaleFunc({domain:k,range:b},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(a,b,c){"use strict";var d=a("./constants");function e(c,a){var b=(a[0][0]>c?0:1)+(a[0][1]>c?0:2)+(a[1][1]>c?0:4)+(a[1][0]>c?0:8);return 5===b||10===b?c>(a[0][0]+a[0][1]+a[1][0]+a[1][1])/4?5===b?713:1114:5===b?104:208:15===b?0:b}b.exports=function(k){var a,b,c,f,n,o,h,i,j,g=k[0].z,l=g.length,m=g[0].length,p=2===l||2===m;for(b=0;b<l-1;b++)for(f=[],0===b&&(f=f.concat(d.BOTTOMSTART)),b===l-2&&(f=f.concat(d.TOPSTART)),a=0;a<m-1;a++)for(c=f.slice(),0===a&&(c=c.concat(d.LEFTSTART)),a===m-2&&(c=c.concat(d.RIGHTSTART)),n=a+","+b,o=[[g[b][a],g[b][a+1]],[g[b+1][a],g[b+1][a+1]]],j=0;j<k.length;j++)(h=e((i=k[j]).level,o))&&(i.crossings[n]=h,-1!==c.indexOf(h)&&(i.starts.push([a,b]),p&& -1!==c.indexOf(h,c.indexOf(h)+1)&&i.starts.push([a,b])))}},{"./constants":748}],762:[function(a,d,b){"use strict";var e=a("@plotly/d3"),f=a("../../lib"),g=a("../../components/drawing"),h=a("../../components/colorscale"),i=a("../../lib/svg_text_utils"),j=a("../../plots/cartesian/axes"),k=a("../../plots/cartesian/set_convert"),l=a("../heatmap/plot"),m=a("./make_crossings"),n=a("./find_all_paths"),o=a("./empty_pathinfo"),p=a("./convert_to_constraints"),q=a("./close_boundaries"),c=a("./constants"),r=c.LABELOPTIMIZER;function s(c,l){var a,b,m,h,i,n,j="",d=0,k=c.edgepaths.map(function(b,a){return a}),o=!0;function q(a){return .01>Math.abs(a[1]-l[0][1])}function r(a){return .01>Math.abs(a[1]-l[2][1])}function s(a){return .01>Math.abs(a[0]-l[0][0])}function p(a){return .01>Math.abs(a[0]-l[2][0])}for(;k.length;){for(n=g.smoothopen(c.edgepaths[d],c.smoothing),j+=o?n:n.replace(/^M/,"L"),k.splice(k.indexOf(d),1),a=c.edgepaths[d][c.edgepaths[d].length-1],h=-1,m=0;m<4;m++){if(!a){f.log("Missing end?",d,c);break}for(q(a)&&!p(a)?b=l[1]:s(a)?b=l[0]:r(a)?b=l[3]:p(a)&&(b=l[2]),i=0;i<c.edgepaths.length;i++){var e=c.edgepaths[i][0];.01>Math.abs(a[0]-b[0])?.01>Math.abs(a[0]-e[0])&&(e[1]-a[1])*(b[1]-e[1])>=0&&(b=e,h=i):.01>Math.abs(a[1]-b[1])?.01>Math.abs(a[1]-e[1])&&(e[0]-a[0])*(b[0]-e[0])>=0&&(b=e,h=i):f.log("endpt to newendpt is not vert. or horz.",a,b,e)}if(a=b,h>=0)break;j+="L"+b}if(h===c.edgepaths.length){f.log("unclosed perimeter path");break}d=h,(o=-1===k.indexOf(d))&&(d=k[0],j+="Z")}for(d=0;d<c.paths.length;d++)j+=g.smoothclosed(c.paths[d],c.smoothing);return j}function t(h,g,m,b){var n=g.width/2,o=g.height/2,d=h.x,e=h.y,c=h.theta,i=Math.cos(c)*n,j=Math.sin(c)*n,p=(d>b.center?b.right-d:d-b.left)/(i+Math.abs(Math.sin(c)*o)),q=(e>b.middle?b.bottom-e:e-b.top)/(Math.abs(j)+Math.cos(c)*o);if(p<1||q<1)return 1/0;var k=r.EDGECOST*(1/(p-1)+1/(q-1));k+=r.ANGLECOST*c*c;for(var x=d-i,y=e-j,z=d+i,A=e+j,l=0;l<m.length;l++){var a=m[l],s=Math.cos(a.theta)*a.width/2,t=Math.sin(a.theta)*a.width/2,u=2*f.segmentDistance(x,y,z,A,a.x-s,a.y-t,a.x+s,a.y+t)/(g.height+a.height),v=a.level===g.level,w=v?r.SAMELEVELDISTANCE:1;if(u<=w)return 1/0;k+=r.NEIGHBORCOST*(v?r.SAMELEVELFACTOR:1)/(u-w)}return k}b.plot=function(i,a,d,h){var j=a.xaxis,k=a.yaxis;f.makeTraceGroups(h,d,"contour").each(function(C){var r=e.select(this),h=C[0],O=h.trace,v=h.x,w=h.y,d=O.contours,t=o(d,a,h),P=f.ensureSingle(r,"g","heatmapcoloring"),D=[];"heatmap"===d.coloring&&(D=[C]),l(i,a,D,P),m(t),n(t);var E,F,G,x,H,y,I,u,z,Q,A,J=j.c2p(v[0],!0),K=j.c2p(v[v.length-1],!0),L=k.c2p(w[0],!0),M=k.c2p(w[w.length-1],!0),B=[[J,M],[K,M],[K,L],[J,L]],N=t;"constraint"===d.type&&(N=p(t,d._operation)),E=r,F=B,G=d,(x=f.ensureSingle(E,"g","contourbg").selectAll("path").data("fill"===G.coloring?[0]:[])).enter().append("path"),x.exit().remove(),x.attr("d","M"+F.join("L")+"Z").style("stroke","none"),H=r,y=N,I=B,z="fill"===(u=d).coloring||"constraint"===u.type&&"="!==u._operation,Q="M"+I.join("L")+"Z",z&&q(y,u),(A=f.ensureSingle(H,"g","contourfill").selectAll("path").data(z?y:[])).enter().append("path"),A.exit().remove(),A.each(function(a){var b=(a.prefixBoundary?Q:"")+s(a,I);b?e.select(this).attr("d",b).style("stroke","none"):e.select(this).remove()}),function(r,i,l,d,m){var s=f.ensureSingle(r,"g","contourlines"),n=!1!==m.showlines,h=m.showlabels,t=n&&h,u=b.createLines(s,n||h,i),C=b.createLineClip(s,t,l,d.trace.uid),o=r.selectAll("g.contourlabels").data(h?[0]:[]);if(o.exit().remove(),o.enter().append("g").classed("contourlabels",!0),h){var v=[],D=[];f.clearLocationCache();var K=b.labelFormatter(l,d),E=g.tester.append("text").attr("data-notex",1).call(g.font,m.labelfont),j=i[0].xaxis,k=i[0].yaxis,p=j._length,q=k._length,w=j.range,x=k.range,F=f.aggNums(Math.min,null,d.x),G=f.aggNums(Math.max,null,d.x),H=f.aggNums(Math.min,null,d.y),I=f.aggNums(Math.max,null,d.y),y=Math.max(j.c2p(F,!0),0),z=Math.min(j.c2p(G,!0),p),A=Math.max(k.c2p(I,!0),0),B=Math.min(k.c2p(H,!0),q),a={};w[0]<w[1]?(a.left=y,a.right=z):(a.left=z,a.right=y),x[0]<x[1]?(a.top=A,a.bottom=B):(a.top=B,a.bottom=A),a.middle=(a.top+a.bottom)/2,a.center=(a.left+a.right)/2,v.push([[a.left,a.top],[a.right,a.top],[a.right,a.bottom],[a.left,a.bottom]]);var J=Math.sqrt(p*p+q*q),L=c.LABELDISTANCE*J/Math.max(1,i.length/c.LABELINCREASE);u.each(function(d){var g=b.calcTextOpts(d.level,K,E,l);e.select(this).selectAll("path").each(function(){var e=this,d=f.getVisibleSegment(e,a,g.height/2);if(d&&!(d.len<(g.width+g.height)*c.LABELMIN))for(var j=Math.min(Math.ceil(d.len/L),c.LABELMAX),h=0;h<j;h++){var i=b.findBestTextLocation(e,d,g,D,a);if(!i)break;b.addLabelData(i,g,D,v)}})}),E.remove(),b.drawLabels(o,D,l,C,t?v:null)}h&&!n&&u.remove()}(r,t,i,h,d),function(k,h,i,b,j){var d=b.trace,l=i._fullLayout._clips,c="clip"+d.uid,e=l.selectAll("#"+c).data(d.connectgaps?[]:[0]);if(e.enter().append("clipPath").classed("contourclip",!0).attr("id",c),e.exit().remove(),!1===d.connectgaps){var a={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:h.xaxis,yaxis:h.yaxis,x:b.x,y:b.y,z:function(b){var a,d,e=b.trace._emptypoints,c=[],g=b.z.length,h=b.z[0].length,f=[];for(a=0;a<h;a++)f.push(1);for(a=0;a<g;a++)c.push(f.slice());for(a=0;a<e.length;a++)c[(d=e[a])[0]][d[1]]=0;return b.zmask=c,c}(b),smoothing:0};m([a]),n([a]),q([a],{type:"levels"}),f.ensureSingle(e,"path","").attr("d",(a.prefixBoundary?"M"+j.join("L")+"Z":"")+s(a,j))}else c=null;g.setClipUrl(k,c,i)}(r,a,i,h,B)})},b.createLines=function(f,d,e){var h=e[0].smoothing,a=f.selectAll("g.contourlevel").data(d?e:[]);if(a.exit().remove(),a.enter().append("g").classed("contourlevel",!0),d){var b=a.selectAll("path.openline").data(function(a){return a.pedgepaths||a.edgepaths});b.exit().remove(),b.enter().append("path").classed("openline",!0),b.attr("d",function(a){return g.smoothopen(a,h)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var c=a.selectAll("path.closedline").data(function(a){return a.ppaths||a.paths});c.exit().remove(),c.enter().append("path").classed("closedline",!0),c.attr("d",function(a){return g.smoothclosed(a,h)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return a},b.createLineClip=function(e,c,d,f){var h=d._fullLayout._clips,a=c?"clipline"+f:null,b=h.selectAll("#"+a).data(c?[0]:[]);return b.exit().remove(),b.enter().append("clipPath").classed("contourlineclip",!0).attr("id",a),g.setClipUrl(e,a,d),b},b.labelFormatter=function(g,i){var e=g._fullLayout,f=i.trace,b=f.contours,a={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(b.labelformat)a.tickformat=b.labelformat,k(a,e);else{var d=h.extractOpts(f);if(d&&d.colorbar&&d.colorbar._axis)a=d.colorbar._axis;else{if("constraint"===b.type){var c=b.value;Array.isArray(c)?a.range=[c[0],c[c.length-1]]:a.range=[c,c]}else a.range=[b.start,b.end],a.nticks=(b.end-b.start)/b.size;a.range[0]===a.range[1]&&(a.range[1]+=a.range[0]||1),a.nticks||(a.nticks=1e3),k(a,e),j.prepTicks(a),a._tmin=null,a._tmax=null}}return function(b){return j.tickText(a,b).text}},b.calcTextOpts=function(b,f,c,h){var d=f(b);c.text(d).call(i.convertToTspans,h);var e=c.node(),a=g.bBox(e,!0);return{text:d,width:a.width,height:a.height,fontSize:+e.style["font-size"].replace("px",""),level:b,dy:(a.top+a.bottom)/2}},b.findBestTextLocation=function(o,b,j,p,q){var c,a,d,k,l,e=j.width;b.isClosed?(a=b.len/r.INITIALSEARCHPOINTS,c=b.min+a/2,d=b.max):(a=(b.len-e)/(r.INITIALSEARCHPOINTS+1),c=b.min+a+e/2,d=b.max-(a+e)/2);for(var g=1/0,i=0;i<r.ITERATIONS;i++){for(var h=c;h<d;h+=a){var m=f.getTextLocation(o,b.total,h,e),n=t(m,j,p,q);n<g&&(g=n,l=m,k=h)}if(g>2*r.MAXCOST)break;i&&(a/=2),d=(c=k-a/2)+1.5*a}if(g<=r.MAXCOST)return l},b.addLabelData=function(e,a,h,i){var g=a.fontSize,b=a.width+g/3,c=Math.max(0,a.height-g/3),j=e.x,k=e.y,f=e.theta,m=Math.sin(f),n=Math.cos(f),d=function(a,b){return[j+a*n-b*m,k+a*m+b*n]},l=[d(-b/2,-c/2),d(-b/2,c/2),d(b/2,c/2),d(b/2,-c/2)];h.push({text:a.text,x:j,y:k,dy:a.dy,theta:f,level:a.level,width:b,height:c}),i.push(l)},b.drawLabels=function(g,h,k,j,a){var c=g.selectAll("text").data(h,function(a){return a.text+","+a.x+","+a.y+","+a.theta});if(c.exit().remove(),c.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(a){var b=a.x+Math.sin(a.theta)*a.dy,c=a.y-Math.cos(a.theta)*a.dy;e.select(this).text(a.text).attr({x:b,y:c,transform:"rotate("+180*a.theta/Math.PI+" "+b+" "+c+")"}).call(i.convertToTspans,k)}),a){for(var d="",b=0;b<a.length;b++)d+="M"+a[b].join("L")+"Z";f.ensureSingle(j,"path","").attr("d",d)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../lib");function f(a,b,e){var c={type:"linear",range:[a,b]};return d.autoTicks(c,(b-a)/(e||15)),c}b.exports=function(b,l){var a=b.contours;if(b.autocontour){var h=b.zmin,i=b.zmax;(b.zauto|| void 0===h)&&(h=e.aggNums(Math.min,null,l)),(b.zauto|| void 0===i)&&(i=e.aggNums(Math.max,null,l));var j=f(h,i,b.ncontours);a.size=j.dtick,a.start=d.tickFirst(j),j.range.reverse(),a.end=d.tickFirst(j),a.start===h&&(a.start+=a.size),a.end===i&&(a.end-=a.size),a.start>a.end&&(a.start=a.end=(a.start+a.end)/2),b._input.contours||(b._input.contours={}),e.extendFlat(b._input.contours,{start:a.start,end:a.end,size:a.size}),b._input.autocontour=!0}else if("constraint"!==a.type){var m,c=a.start,g=a.end,k=b._input.contours;c>g&&(a.start=k.start=g,g=a.end=k.end=c,c=a.start),a.size>0||(m=c===g?1:f(c,g,b.ncontours).dtick,k.size=a.size=m)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../components/drawing"),f=a("../heatmap/style"),g=a("./make_color_map");b.exports=function(a){var b=d.select(a).selectAll("g.contour");b.style("opacity",function(a){return a[0].trace.opacity}),b.each(function(j){var f,b=d.select(this),c=j[0].trace,a=c.contours,o=c.line,k=a.size||1,l=a.start,h="constraint"===a.type,m=!h&&"lines"===a.coloring,i=!h&&"fill"===a.coloring,n=m||i?g(c):null;b.selectAll("g.contourlevel").each(function(a){d.select(this).selectAll("path").call(e.lineGroupStyle,o.width,m?n(a.level):o.color,o.dash)});var p=a.labelfont;b.selectAll("g.contourlabels text").each(function(a){e.font(d.select(this),{family:p.family,size:p.size,color:p.color||(m?n(a.level):o.color)})}),h?b.selectAll("g.contourfill path").style("fill",c.fillcolor):i&&(b.selectAll("g.contourfill path").style("fill",function(a){return void 0===f&&(f=a.level),n(a.level+.5*k)}),void 0===f&&(f=l),b.selectAll("g.contourbg path").style("fill",n(f-.5*k)))}),f(a)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(a,b,c){"use strict";var d=a("../../components/colorscale/defaults"),e=a("./label_defaults");b.exports=function(f,b,a,g,j){var h,c=a("contours.coloring"),i="";"fill"===c&&(h=a("contours.showlines")),!1!==h&&("lines"!==c&&(i=a("line.color","#000")),a("line.width",.5),a("line.dash")),"none"!==c&&(!0!==f.showlegend&&(b.showlegend=!1),b._dfltShowLegend=!1,d(f,b,g,a,{prefix:"",cLetter:"z"})),a("line.smoothing"),e(a,g,i,j)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(d,e,h){"use strict";var a=d("../heatmap/attributes"),c=d("../contour/attributes"),f=d("../../components/colorscale/attributes"),g=d("../../lib/extend").extendFlat,b=c.contours;e.exports=g({carpet:{valType:"string",editType:"calc"},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:c.fillcolor,autocontour:c.autocontour,ncontours:c.ncontours,contours:{type:b.type,start:b.start,end:b.end,size:b.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:b.showlines,showlabels:b.showlabels,labelfont:b.labelfont,labelformat:b.labelformat,operation:b.operation,value:b.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:c.line.color,width:c.line.width,dash:c.line.dash,smoothing:c.line.smoothing,editType:"plot"},transforms:void 0},f("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc"),e=a("../../lib"),f=a("../heatmap/convert_column_xyz"),g=a("../heatmap/clean_2d_array"),h=a("../heatmap/interp2d"),i=a("../heatmap/find_empties"),j=a("../heatmap/make_bound_array"),k=a("./defaults"),l=a("../carpet/lookup_carpetid"),m=a("../contour/set_contours");b.exports=function(n,b){var r=b._carpetTrace=l(n,b);if(r&&r.visible&&"legendonly"!==r.visible){if(!b.a||!b.b){var u=n.data[r.index],o=n.data[b.index];o.a||(o.a=u.a),o.b||(o.b=u.b),k(o,b,b._defaultColor,n._fullLayout)}var v,a,s,w,x,t,y,z,c,A,p,q,B,C,D,E,F,G=(v=n,p=(A=(a=b)._carpetTrace).aaxis,q=A.baxis,p._minDtick=0,q._minDtick=0,e.isArray1D(a.z)&&f(a,p,q,"a","b",["z"]),s=a._a=a._a||a.a,t=a._b=a._b||a.b,s=s?p.makeCalcdata(a,"_a"):[],t=t?q.makeCalcdata(a,"_b"):[],w=a.a0||0,x=a.da||1,y=a.b0||0,z=a.db||1,c=a._z=g(a._z||a.z,a.transpose),a._emptypoints=i(c),h(c,a._emptypoints),B=e.maxRowLength(c),C="scaled"===a.xtype?"":s,D=j(a,C,w,x,B,p),E="scaled"===a.ytype?"":t,F=j(a,E,y,z,c.length,q),"levels"===a.contours.type&&"none"!==a.contours.coloring&&d(v,a,{vals:c,containerStr:"",cLetter:"z"}),[{a:D,b:F,z:c}]);return m(b,b._z),G}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../heatmap/xyz_defaults"),f=a("./attributes"),g=a("../contour/constraint_defaults"),h=a("../contour/contours_defaults"),i=a("../contour/style_defaults");b.exports=function(c,a,k,j){function b(b,e){return d.coerce(c,a,f,b,e)}if(b("carpet"),c.a&&c.b){if(!e(c,a,b,j,"a","b")){a.visible=!1;return}b("text"),"constraint"===b("contours.type")?g(c,a,b,j,k,{hasHover:!1}):(h(c,a,b,function(b){return d.coerce2(c,a,f,b)}),i(c,a,b,j,{hasHover:!1}))}else a._defaultColor=k,a._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../contour/colorbar"),calc:a("./calc"),plot:a("./plot"),style:a("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../carpet/map_1d_array"),f=a("../carpet/makepath"),g=a("../../components/drawing"),h=a("../../lib"),i=a("../contour/make_crossings"),j=a("../contour/find_all_paths"),k=a("../contour/plot"),l=a("../contour/constants"),m=a("../contour/convert_to_constraints"),n=a("../contour/empty_pathinfo"),o=a("../contour/close_boundaries"),p=a("../carpet/lookup_carpetid"),q=a("../carpet/axis_aligned_line");function r(c,g,h){var d=c.getPointAtLength(g),e=c.getPointAtLength(h),a=e.x-d.x,b=e.y-d.y,f=Math.sqrt(a*a+b*b);return[a/f,b/f]}function s(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return[a[0]/b,a[1]/b]}function t(b,c){var a=Math.abs(b[0]*c[0]+b[1]*c[1]);return Math.sqrt(1-a*a)/a}b.exports=function(u,a,b,c){var v=a.xaxis,w=a.yaxis;h.makeTraceGroups(c,b,"contour").each(function(T){var F,G,H,B,C=d.select(this),A=T[0],D=A.trace,x=D._carpetTrace=p(u,D),E=u.calcdata[x.index][0];if(x.visible&&"legendonly"!==x.visible){var b=A.a,c=A.b,y=D.contours,z=n(y,a,A),K="constraint"===y.type,L=y._operation,M=K?"="===L?"lines":"fill":y.coloring,U=[[b[0],c[c.length-1]],[b[b.length-1],c[c.length-1]],[b[b.length-1],c[0]],[b[0],c[0]]];i(z),j(z,(b[b.length-1]-b[0])*1e-8,(c[c.length-1]-c[0])*1e-8);var N=z;"constraint"===y.type&&(N=m(z,L)),function(h,i){var e,b,a,c,j,k,f,g,d;for(e=0;e<h.length;e++){for(b=0,j=(c=h[e]).pedgepaths=[],k=c.ppaths=[];b<c.edgepaths.length;b++){for(a=0,d=c.edgepaths[b],f=[];a<d.length;a++)f[a]=i(d[a]);j.push(f)}for(b=0;b<c.paths.length;b++){for(a=0,d=c.paths[b],g=[];a<d.length;a++)g[a]=i(d[a]);k.push(g)}}}(z,ab);var O=[];for(B=E.clipsegments.length-1;B>=0;B--)G=e([],(F=E.clipsegments[B]).x,v.c2p),H=e([],F.y,w.c2p),G.reverse(),H.reverse(),O.push(f(G,H,F.bicubic));var P,Q,V,W,I,X,Y,Z,$,R,_,S,J,aa="M"+O.join("L")+"Z";(function(k,d,l,m,n,o){var b,g,i,a,c=h.ensureSingle(k,"g","contourbg").selectAll("path").data("fill"!==o||n?[]:[0]);c.enter().append("path"),c.exit().remove();var j=[];for(a=0;a<d.length;a++)g=e([],(b=d[a]).x,l.c2p),i=e([],b.y,m.c2p),j.push(f(g,i,b.bicubic));c.attr("d","M"+j.join("L")+"Z").style("stroke","none")})(C,E.clipsegments,v,w,K,M),P=D,Q=C,V=v,W=w,I=N,X=U,Y=ab,Z=x,$=E,R=M,_=aa,(S="fill"===R)&&o(I,P.contours),(J=h.ensureSingle(Q,"g","contourfill").selectAll("path").data(S?I:[])).enter().append("path"),J.exit().remove(),J.each(function(a){var b=(a.prefixBoundary?_:"")+function(z,d,f,p,A,B,C,D){var b,a,c,m,i,j,n,k="",l=d.edgepaths.map(function(b,a){return a}),r=!0,s=1e-4*Math.abs(f[0][0]-f[2][0]),t=1e-4*Math.abs(f[0][1]-f[2][1]);function v(a){return Math.abs(a[1]-f[0][1])<t}function w(a){return Math.abs(a[1]-f[2][1])<t}function x(a){return Math.abs(a[0]-f[0][0])<s}function u(a){return Math.abs(a[0]-f[2][0])<s}function o(a,d){var b,e,c,f,g="";for(v(a)&&!u(a)||w(a)&&!x(a)?(f=A.aaxis,c=q(A,B,[a[0],d[0]],.5*(a[1]+d[1]))):(f=A.baxis,c=q(A,B,.5*(a[0]+d[0]),[a[1],d[1]])),b=1;b<c.length;b++)for(g+=f.smoothing?"C":"L",e=0;e<c[b].length;e++){var h=c[b][e];g+=[C.c2p(h[0]),D.c2p(h[1])]+" "}return g}for(b=0,a=null;l.length;){var y=d.edgepaths[b][0];for(a&&(k+=o(a,y)),n=g.smoothopen(d.edgepaths[b].map(p),d.smoothing),k+=r?n:n.replace(/^M/,"L"),l.splice(l.indexOf(b),1),a=d.edgepaths[b][d.edgepaths[b].length-1],i=-1,m=0;m<4;m++){if(!a){h.log("Missing end?",b,d);break}for(v(a)&&!u(a)?c=f[1]:x(a)?c=f[0]:w(a)?c=f[3]:u(a)&&(c=f[2]),j=0;j<d.edgepaths.length;j++){var e=d.edgepaths[j][0];Math.abs(a[0]-c[0])<s?Math.abs(a[0]-e[0])<s&&(e[1]-a[1])*(c[1]-e[1])>=0&&(c=e,i=j):Math.abs(a[1]-c[1])<t?Math.abs(a[1]-e[1])<t&&(e[0]-a[0])*(c[0]-e[0])>=0&&(c=e,i=j):h.log("endpt to newendpt is not vert. or horz.",a,c,e)}if(i>=0)break;k+=o(a,c),a=c}if(i===d.edgepaths.length){h.log("unclosed perimeter path");break}b=i,(r=-1===l.indexOf(b))&&(b=l[0],k+=o(a,c)+"Z",a=null)}for(b=0;b<d.paths.length;b++)k+=g.smoothclosed(d.paths[b].map(p),d.smoothing);return k}(P,a,X,Y,Z,$,V,W);b?d.select(this).attr("d",b).style("stroke","none"):d.select(this).remove()}),function(m,n,e,o,f,p,D){var q=h.ensureSingle(m,"g","contourlines"),i=!1!==f.showlines,c=f.showlabels,u=i&&c,v=k.createLines(q,i||c,n),w=k.createLineClip(q,u,e,o.trace.uid),j=m.selectAll("g.contourlabels").data(c?[0]:[]);if(j.exit().remove(),j.enter().append("g").classed("contourlabels",!0),c){var x=p.xaxis,y=p.yaxis,a=x._length,b=y._length,z=[[[0,0],[a,0],[a,b],[0,b]]],A=[];h.clearLocationCache();var E=k.labelFormatter(e,o),B=g.tester.append("text").attr("data-notex",1).call(g.font,f.labelfont),F={left:0,right:a,center:a/2,top:0,bottom:b,middle:b/2},C=Math.sqrt(a*a+b*b),G=l.LABELDISTANCE*C/Math.max(1,n.length/l.LABELINCREASE);v.each(function(a){var b=k.calcTextOpts(a.level,E,B,e);d.select(this).selectAll("path").each(function(g){var d=this,c=h.getVisibleSegment(d,F,b.height/2);if(c&&(function(f,i,e,a,b,l){for(var c,d=0;d<e.pedgepaths.length;d++)i===e.pedgepaths[d]&&(c=e.edgepaths[d]);if(c){var m=b.a[0],n=b.a[b.a.length-1],o=b.b[0],p=b.b[b.b.length-1],j=r(f,0,1),k=r(f,a.total,a.total-1),g=q(c[0],j),h=a.total-q(c[c.length-1],k);a.min<g&&(a.min=g),a.max>h&&(a.max=h),a.len=a.max-a.min}function q(a,d){var c=0;return(.1>Math.abs(a[0]-m)||.1>Math.abs(a[0]-n))&&(c=Math.max(c,l*t(d,s(b.dxydb_rough(a[0],a[1],.1)))/2)),(.1>Math.abs(a[1]-o)||.1>Math.abs(a[1]-p))&&(c=Math.max(c,l*t(d,s(b.dxyda_rough(a[0],a[1],.1)))/2)),c}}(d,g,a,c,D,b.height),!(c.len<(b.width+b.height)*l.LABELMIN)))for(var i=Math.min(Math.ceil(c.len/G),l.LABELMAX),e=0;e<i;e++){var f=k.findBestTextLocation(d,c,b,A,F);if(!f)break;k.addLabelData(f,b,A,z)}})}),B.remove(),k.drawLabels(j,A,e,w,u?z:null)}c&&!i&&v.remove()}(C,z,u,A,y,a,x),g.setClipUrl(C,x._clipPathId,u)}function ab(a){var b=x.ab2xy(a[0],a[1],!0);return[v.c2p(b[0]),w.c2p(b[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(a,e,h){"use strict";var f=a("../../components/colorscale/attributes"),g=a("../../plots/template_attributes").hovertemplateAttrs,d=a("../../plots/attributes"),b=a("../scattermapbox/attributes"),c=a("../../lib/extend").extendFlat;e.exports=c({lon:b.lon,lat:b.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:b.text,hovertext:b.hovertext,hoverinfo:c({},d.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:g(),showlegend:c({},d.showlegend,{dflt:!1})},f("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib").isArrayOrTypedArray,f=a("../../constants/numerical").BADNUM,g=a("../../components/colorscale/calc"),h=a("../../lib")._;b.exports=function(i,b){for(var j=b._length,k=new Array(j),c=b.z,l=e(c)&&c.length,a=0;a<j;a++){var m=k[a]={},n=b.lon[a],o=b.lat[a];if(m.lonlat=d(n)&&d(o)?[+n,+o]:[f,f],l){var p=c[a];m.z=d(p)?p:f}}return g(i,b,{vals:l?c:[0,1],containerStr:"",cLetter:"z"}),j&&(k[0].t={labels:{lat:h(i,"lat:")+" ",lon:h(i,"lon:")+" "}}),k}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../components/color"),g=a("../../components/colorscale"),h=a("../../constants/numerical").BADNUM,i=a("../../lib/geojson_utils").makeBlank;b.exports=function(m){var a,b=m[0].trace,x=!0===b.visible&&0!==b._length,y={layout:{visibility:"none"},paint:{}},j=b._opts={heatmap:y,geojson:i()};if(!x)return j;var p=[],q=b.z,k=b.radius,r=e.isArrayOrTypedArray(q)&&q.length,s=e.isArrayOrTypedArray(k);for(a=0;a<m.length;a++){var t=m[a],u=t.lonlat;if(u[0]!==h){var n={};if(r){var v=t.z;n.z=v!==h?v:0}s&&(n.r=d(k[a])&&k[a]>0?+k[a]:0),p.push({type:"Feature",geometry:{type:"Point",coordinates:u},properties:n})}}var c=g.extractOpts(b),l=c.reversescale?g.flipScale(c.colorscale):c.colorscale,o=l[0][1],w=["interpolate",["linear"],["heatmap-density"],0,1>f.opacity(o)?o:f.addOpacity(o,0)];for(a=1;a<l.length;a++)w.push(l[a][0],l[a][1]);var z=["interpolate",["linear"],["get","z"],c.min,0,c.max,1];return e.extendFlat(j.heatmap.paint,{"heatmap-weight":r?z:1/(c.max-c.min),"heatmap-color":w,"heatmap-radius":s?{type:"identity",property:"r"}:b.radius,"heatmap-opacity":b.opacity}),j.geojson={type:"FeatureCollection",features:p},j.heatmap.layout.visibility="visible",j}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(g,b,k,h){function a(a,c){return d.coerce(g,b,f,a,c)}var i=a("lon")||[],j=a("lat")||[],c=Math.min(i.length,j.length);if(!c){b.visible=!1;return}b._length=c,a("z"),a("radius"),a("below"),a("text"),a("hovertext"),a("hovertemplate"),e(g,b,h,a,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(b,a,c){"use strict";a.exports=function(a,b){return a.lon=b.lon,a.lat=b.lat,a.z=b.z,a}},{}],776:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../scattermapbox/hover").hoverPoints,f=a("../scattermapbox/hover").getExtraText;b.exports=function(i,j,k){var g=e(i,j,k);if(g){var a=g[0],c=a.cd,l=c[0].trace,b=c[a.index];if(delete a.color,"z"in b){var h=a.subplot.mockAxis;a.z=b.z,a.zLabel=d.tickText(h,h.c2l(b.z),"hover").text}return a.extraText=f(l,b,c[0].t.labels),[a]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),formatLabels:a("../scattermapbox/format_labels"),calc:a("./calc"),plot:a("./plot"),hoverPoints:a("./hover"),eventData:a("./event_data"),getBelow:function(f,e){for(var c=e.getMapLayers(),a=0;a<c.length;a++){var d=c[a],b=d.id;if("symbol"===d.type&&"string"==typeof b&& -1===b.indexOf("plotly-"))return b}},moduleType:"trace",name:"densitymapbox",basePlotModule:a("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(b,c,e){"use strict";var f=b("./convert"),g=b("../../plots/mapbox/constants").traceLayerPrefix;function d(b,a){this.type="densitymapbox",this.subplot=b,this.uid=a,this.sourceId="source-"+a,this.layerList=[["heatmap",g+a+"-heatmap"]],this.below=null}var a=d.prototype;a.update=function(j){var a=this.subplot,g=this.layerList,b=f(j),c=a.belowLookup["trace-"+this.uid];a.map.getSource(this.sourceId).setData(b.geojson),c!==this.below&&(this._removeLayers(),this._addLayers(b,c),this.below=c);for(var d=0;d<g.length;d++){var h=g[d],k=h[0],i=h[1],e=b[k];a.setOptions(i,"setLayoutProperty",e.layout),"visible"===e.layout.visibility&&a.setOptions(i,"setPaintProperty",e.paint)}},a._addLayers=function(f,g){for(var h=this.subplot,b=this.layerList,i=this.sourceId,a=0;a<b.length;a++){var c=b[a],d=c[0],e=f[d];h.addLayer({type:d,id:c[1],source:i,layout:e.layout,paint:e.paint},g)}},a._removeLayers=function(){for(var c=this.subplot.map,b=this.layerList,a=b.length-1;a>=0;a--)c.removeLayer(b[a][1])},a.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},c.exports=function(b,c){var e=c[0].trace,a=new d(b,e.uid),h=a.sourceId,g=f(c),i=a.below=b.belowLookup["trace-"+e.uid];return b.map.addSource(h,{type:"geojson",data:g.geojson}),a._addLayers(g,i),a}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,e){for(var b=0;b<a.length;b++)a[b].i=b;d.mergeArray(e.text,a,"tx"),d.mergeArray(e.hovertext,a,"htx");var c=e.marker;if(c){d.mergeArray(c.opacity,a,"mo"),d.mergeArray(c.color,a,"mc");var f=c.line;f&&(d.mergeArray(f.color,a,"mlc"),d.mergeArrayCastPositive(f.width,a,"mlw"))}}},{"../../lib":515}],780:[function(b,h,m){"use strict";var e,a=b("../bar/attributes"),d=b("../scatter/attributes").line,i=b("../../plots/attributes"),f=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,j=b("../../plots/template_attributes").hovertemplateAttrs,k=b("../../plots/template_attributes").texttemplateAttrs,g=b("./constants"),c=b("../../lib/extend").extendFlat,l=b("../../components/color");h.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:f("x"),yhoverformat:f("y"),hovertext:a.hovertext,hovertemplate:j({},{keys:g.eventDataKeys}),hoverinfo:c({},i.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:k({editType:"plot"},{keys:g.eventDataKeys.concat(["label","value"])}),text:a.text,textposition:a.textposition,insidetextanchor:c({},a.insidetextanchor,{dflt:"middle"}),textangle:c({},a.textangle,{dflt:0}),textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:c({},a.orientation,{}),offset:c({},a.offset,{arrayOk:!1}),width:c({},a.width,{arrayOk:!1}),marker:(delete(e=c({},a.marker)).pattern,e),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:c({},d.color,{dflt:l.defaultLine}),width:c({},d.width,{dflt:0,editType:"plot"}),dash:d.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../plots/cartesian/align_period"),f=a("./arrays_to_calcdata"),g=a("../scatter/calc_selection"),h=a("../../constants/numerical").BADNUM;function i(a){return a===h?0:a}b.exports=function(t,b){var k,u,l,m,p,n,a,c,q,r=d.getFromId(t,b.xaxis||"x"),s=d.getFromId(t,b.yaxis||"y");"h"===b.orientation?(k=r.makeCalcdata(b,"x"),l=s.makeCalcdata(b,"y"),m=e(b,s,"y",l),p=!!b.yperiodalignment,n="y"):(k=s.makeCalcdata(b,"y"),l=r.makeCalcdata(b,"x"),m=e(b,r,"x",l),p=!!b.xperiodalignment,n="x");var o=Math.min((u=m.vals).length,k.length),j=new Array(o);for(a=0,b._base=[];a<o;a++){k[a]<0&&(k[a]=h);var v=!1;k[a]!==h&&a+1<o&&k[a+1]!==h&&(v=!0),c=j[a]={p:u[a],s:k[a],cNext:v},b._base[a]=-0.5*c.s,p&&(j[a].orig_p=l[a],j[a][n+"End"]=m.ends[a],j[a][n+"Start"]=m.starts[a]),b.ids&&(c.id=String(b.ids[a])),0===a&&(j[0].vTotal=0),j[0].vTotal+=i(c.s),c.begR=i(c.s)/i(j[0].s)}for(a=0;a<o;a++)(c=j[a]).s!==h&&(c.sumR=c.s/j[0].vTotal,c.difR=void 0!==q?c.s/q:1,q=c.s);return f(j,b),g(j,b),j}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(b,a,c){"use strict";a.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(a,b,c){"use strict";var d=a("../bar/cross_trace_calc").setGroupPositions;b.exports=function(e,k){var a,c,g=e._fullLayout,l=e._fullData,p=e.calcdata,h=k.xaxis,i=k.yaxis,j=[],m=[],n=[];for(c=0;c<l.length;c++){var f=l[c],q="h"===f.orientation;!0===f.visible&&f.xaxis===h._id&&f.yaxis===i._id&&"funnel"===f.type&&(a=p[c],q?n.push(a):m.push(a),j.push(a))}var o={mode:g.funnelmode,norm:g.funnelnorm,gap:g.funnelgap,groupgap:g.funnelgroupgap};for(d(e,h,i,m,o),d(e,i,h,n,o),c=0;c<j.length;c++){a=j[c];for(var b=0;b<a.length;b++)b+1<a.length&&(a[b].nextP0=a[b+1].p0,a[b].nextS0=a[b+1].s0,a[b].nextP1=a[b+1].p1,a[b].nextS1=a[b+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../bar/defaults").handleGroupingDefaults,f=a("../bar/defaults").handleText,g=a("../scatter/xy_defaults"),h=a("../scatter/period_defaults"),i=a("./attributes"),j=a("../../components/color");b.exports={supplyDefaults:function(c,b,m,e){function a(a,e){return d.coerce(c,b,i,a,e)}if(!g(c,b,e,a)){b.visible=!1;return}h(c,b,e,a),a("xhoverformat"),a("yhoverformat"),a("orientation",b.y&&!b.x?"v":"h"),a("offset"),a("width");var k,l,n=a("text");a("hovertext"),a("hovertemplate");var o=a("textposition");f(c,b,e,a,o,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===b.textposition||b.texttemplate||a("textinfo",Array.isArray(n)?"text+value":"value");var p=a("marker.color",m);a("marker.line.color",j.defaultLine),a("marker.line.width");var q=a("connector.visible");q&&(a("connector.fillcolor",(k=p,l=d.isArrayOrTypedArray(k)?"#000":k,j.addOpacity(l,.5*j.opacity(l)))),a("connector.line.width")&&(a("connector.line.color"),a("connector.line.dash")))},crossTraceDefaults:function(b,c){var f;function g(a){return d.coerce(f._input,f,i,a)}if("group"===c.funnelmode)for(var a=0;a<b.length;a++)e((f=b[a])._input,f,c,g)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(b,a,c){"use strict";a.exports=function(b,a){return b.x="xVal"in a?a.xVal:a.x,b.y="yVal"in a?a.yVal:a.y,"percentInitial"in a&&(b.percentInitial=a.percentInitial),"percentPrevious"in a&&(b.percentPrevious=a.percentPrevious),"percentTotal"in a&&(b.percentTotal=a.percentTotal),a.xa&&(b.xaxis=a.xa),a.ya&&(b.yaxis=a.ya),b}},{}],786:[function(a,b,c){"use strict";var d=a("../../components/color").opacity,e=a("../bar/hover").hoverOnBars,f=a("../../lib").formatPercent;b.exports=function(q,r,s,t,u){var a=e(q,r,s,t,u);if(a){var n,g,h,j,k,o,p=a.cd,l=p[0].trace,v="h"===l.orientation,b=p[a.index];a[(v?"x":"y")+"LabelVal"]=b.s,a.percentInitial=b.begR,a.percentInitialLabel=f(b.begR,1),a.percentPrevious=b.difR,a.percentPreviousLabel=f(b.difR,1),a.percentTotal=b.sumR,a.percentTotalLabel=f(b.sumR,1);var c=b.hi||l.hoverinfo,i=[];if(c&&"none"!==c&&"skip"!==c){var w="all"===c,x=c.split("+"),m=function(a){return w|| -1!==x.indexOf(a)};m("percent initial")&&i.push(a.percentInitialLabel+" of initial"),m("percent previous")&&i.push(a.percentPreviousLabel+" of previous"),m("percent total")&&i.push(a.percentTotalLabel+" of total")}return a.extraText=i.join("<br>"),a.color=(n=l,g=b,h=n.marker,j=g.mc||h.color,k=g.mlc||h.line.color,o=g.mlw||h.line.width,d(j)?j:d(k)&&o?k:void 0),[a]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc"),plot:a("./plot"),style:a("./style").style,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(b,a,c){"use strict";a.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(h,i,c){var f=!1;function a(a,b){return d.coerce(h,i,e,a,b)}for(var b=0;b<c.length;b++){var g=c[b];if(g.visible&&"funnel"===g.type){f=!0;break}}f&&(a("funnelmode"),a("funnelgap",.2),a("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../constants/numerical").BADNUM,h=a("../bar/plot"),i=a("../bar/uniform_text").clearMinTextSize;function j(a,g,h,f){var b=[],c=[],d=f?g:h,e=f?h:g;return b[0]=d.c2p(a.s0,!0),c[0]=e.c2p(a.p0,!0),b[1]=d.c2p(a.s1,!0),c[1]=e.c2p(a.p1,!0),b[2]=d.c2p(a.nextS0,!0),c[2]=e.c2p(a.nextP0,!0),b[3]=d.c2p(a.nextS1,!0),c[3]=e.c2p(a.nextP1,!0),f?[b,c]:[c,b]}b.exports=function(b,c,k,l){var a=b._fullLayout;i("funnel",a),function(h,a,b,c){var i=a.xaxis,k=a.yaxis;e.makeTraceGroups(c,b,"trace bars").each(function(m){var n=d.select(this),c=m[0].trace,l=e.ensureSingle(n,"g","regions");if(!c.connector||!c.connector.visible){l.remove();return}var o="h"===c.orientation,b=l.selectAll("g.region").data(e.identity);b.enter().append("g").classed("region",!0),b.exit().remove();var p=b.size();b.each(function(m,q){if(q===p-1||m.cNext){var n=j(m,i,k,o),b=n[0],c=n[1],l="";b[0]!==g&&c[0]!==g&&b[1]!==g&&c[1]!==g&&b[2]!==g&&c[2]!==g&&b[3]!==g&&c[3]!==g&&(o?l+="M"+b[0]+","+c[1]+"L"+b[2]+","+c[2]+"H"+b[3]+"L"+b[1]+","+c[1]+"Z":l+="M"+b[1]+","+c[1]+"L"+b[2]+","+c[3]+"V"+c[2]+"L"+b[1]+","+c[0]+"Z"),""===l&&(l="M0,0Z"),e.ensureSingle(d.select(this),"path").attr("d",l).call(f.setClipUrl,a.layerClipId,h)}})})}(b,c,k,l),function(g,a,b,c){var h=a.xaxis,i=a.yaxis;e.makeTraceGroups(c,b,"trace bars").each(function(l){var m=d.select(this),b=l[0].trace,k=e.ensureSingle(m,"g","lines");if(!b.connector||!b.connector.visible||!b.connector.line.width){k.remove();return}var n="h"===b.orientation,c=k.selectAll("g.line").data(e.identity);c.enter().append("g").classed("line",!0),c.exit().remove();var o=c.size();c.each(function(l,p){if(p===o-1||l.cNext){var m=j(l,h,i,n),b=m[0],c=m[1],k="";void 0!==b[3]&& void 0!==c[3]&&(n?(k+="M"+b[0]+","+c[1]+"L"+b[2]+","+c[2],k+="M"+b[1]+","+c[1]+"L"+b[3]+","+c[2]):(k+="M"+b[1]+","+c[1]+"L"+b[2]+","+c[3],k+="M"+b[1]+","+c[0]+"L"+b[2]+","+c[2])),""===k&&(k="M0,0Z"),e.ensureSingle(d.select(this),"path").attr("d",k).call(f.setClipUrl,a.layerClipId,g)}})})}(b,c,k,l),h.plot(b,c,k,l,{mode:a.funnelmode,norm:a.funnelmode,gap:a.funnelgap,groupgap:a.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../components/drawing"),g=a("../../components/color"),h=a("../../constants/interactions").DESELECTDIM,c=a("../bar/style"),i=a("../bar/uniform_text").resizeText,j=c.styleTextPoints;b.exports={style:function(b,d,c){var a=c||e.select(b).selectAll("g.funnellayer").selectAll("g.trace");i(b,a,"funnel"),a.style("opacity",function(a){return a[0].trace.opacity}),a.each(function(c){var a=e.select(this),d=c[0].trace;a.selectAll(".point > path").each(function(a){if(!a.isBlank){var b=d.marker;e.select(this).call(g.fill,a.mc||b.color).call(g.stroke,a.mlc||b.line.color).call(f.dashLine,b.line.dash,a.mlw||b.line.width).style("opacity",d.selectedpoints&&!a.selected?h:1)}}),j(a,d,b),a.selectAll(".regions").each(function(){e.select(this).selectAll("path").style("stroke-width",0).call(g.fill,d.connector.fillcolor)}),a.selectAll(".lines").each(function(){var a=d.connector.line;f.lineGroupStyle(e.select(this).selectAll("path"),a.width,a.color,a.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(c,d,i){"use strict";var a=c("../pie/attributes"),e=c("../../plots/attributes"),f=c("../../plots/domain").attributes,g=c("../../plots/template_attributes").hovertemplateAttrs,h=c("../../plots/template_attributes").texttemplateAttrs,b=c("../../lib/extend").extendFlat;d.exports={labels:a.labels,label0:a.label0,dlabel:a.dlabel,values:a.values,marker:{colors:a.marker.colors,line:{color:b({},a.marker.line.color,{dflt:null}),width:b({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:a.text,hovertext:a.hovertext,scalegroup:b({},a.scalegroup,{}),textinfo:b({},a.textinfo,{flags:["label","text","value","percent"]}),texttemplate:h({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:b({},e.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:g({},{keys:["label","color","value","text","percent"]}),textposition:b({},a.textposition,{values:["inside","none"],dflt:"inside"}),textfont:a.textfont,insidetextfont:a.insidetextfont,title:{text:a.title.text,font:a.title.font,position:b({},a.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:f({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(b,c,a){"use strict";var d=b("../../plots/plots");a.name="funnelarea",a.plot=function(b,c,e,f){d.plotBasePlot(a.name,b,c,e,f)},a.clean=function(b,c,e,f){d.cleanBasePlot(a.name,b,c,e,f)}},{"../../plots/plots":628}],794:[function(a,b,c){"use strict";var d=a("../pie/calc");b.exports={calc:function(a,b){return d.calc(a,b)},crossTraceCalc:function(a){d.crossTraceCalc(a,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults,g=a("../bar/defaults").handleText,h=a("../pie/defaults").handleLabelsAndValues;b.exports=function(m,b,r,c){function a(a,c){return d.coerce(m,b,e,a,c)}var i,n=a("labels"),o=a("values"),j=h(n,o),k=j.len;if(b._hasLabels=j.hasLabels,b._hasValues=j.hasValues,!b._hasLabels&&b._hasValues&&(a("label0"),a("dlabel")),!k){b.visible=!1;return}b._length=k,a("marker.line.width")&&a("marker.line.color",c.paper_bgcolor),a("marker.colors"),a("scalegroup");var p=a("text"),l=a("texttemplate");if(l||(i=a("textinfo",Array.isArray(p)?"text+percent":"percent")),a("hovertext"),a("hovertemplate"),l||i&&"none"!==i){var q=a("textposition");g(m,b,c,a,q,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}f(b,c,a),a("title.text")&&(a("title.position"),d.coerceFont(a,"title.font",c.font)),a("aspectratio"),a("baseratio")}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"funnelarea",basePlotModule:a("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),style:a("./style"),styleOne:a("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(a,b,d){"use strict";var c=a("../pie/layout_attributes").hiddenlabels;b.exports={hiddenlabels:c,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(c,b){function a(a,f){return d.coerce(c,b,e,a,f)}a("hiddenlabels"),a("funnelareacolorway",b.colorway),a("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(a,e,f){"use strict";var g=a("@plotly/d3"),h=a("../../components/drawing"),c=a("../../lib"),i=c.strScale,j=c.strTranslate,k=a("../../lib/svg_text_utils"),l=a("../bar/plot").toMoveInsideBar,d=a("../bar/uniform_text"),m=d.recordMinTextSize,n=d.clearMinTextSize,o=a("../pie/helpers"),b=a("../pie/plot"),p=b.attachFxHandlers,q=b.determineInsideTextFont,r=b.layoutAreas,s=b.prerenderTitles,t=b.positionTitleOutside,u=b.formatSliceLabel;function v(a,b){var c=b[0]-a[0],d=b[1]-a[1];return"l"+c+","+d}function w(a,b){return[.5*(a[0]+b[0]),.5*(a[1]+b[1])]}e.exports=function(a,b){var e=a._context.staticPlot,d=a._fullLayout;n("funnelarea",d),s(b,a),r(b,d._size),c.makeTraceGroups(d._funnelarealayer,b,"trace").each(function(b){var f=g.select(this),n=b[0],r=n.trace;(function(d){if(d.length){var e,a,c,f=d[0],k=f.trace,u=k.aspectratio,i=k.baseratio;i>.999&&(i=.999);var l=Math.pow(i,2),j=f.vTotal,v=j*l/(1-l),x=j,y=v/j,b=[];for(b.push(B()),a=d.length-1;a> -1;a--)(c=d[a]).hidden||(y+=c.v/x,b.push(B()));var g=1/0,h=-1/0;for(a=0;a<b.length;a++)g=Math.min(g,(e=b[a])[1]),h=Math.max(h,e[1]);for(a=0;a<b.length;a++)b[a][1]-=(h+g)/2;var z=b[b.length-1][0],m=f.r,n=(h-g)/2,A=m/z,o=m/n*u;for(a=0,f.r=o*n;a<b.length;a++)b[a][0]*=A,b[a][1]*=o;var p=[-(e=b[0])[0],e[1]],q=[e[0],e[1]],r=0;for(a=d.length-1;a> -1;a--)if(!(c=d[a]).hidden){var s=b[r+=1][0],t=b[r][1];c.TL=[-s,t],c.TR=[s,t],c.BL=p,c.BR=q,c.pxmid=w(c.TR,c.BR),p=c.TL,q=c.TR}}function B(){var a,b={x:a=Math.sqrt(y),y:-a};return[b.x,b.y]}})(b),f.each(function(){var f=g.select(this).selectAll("g.slice").data(b);f.enter().append("g").classed("slice",!0),f.exit().remove(),f.each(function(f,z){if(f.hidden){g.select(this).selectAll("path,g").remove();return}f.pointNumber=f.i,f.curveNumber=r.index;var t=n.cx,w=n.cy,i=g.select(this),s=i.selectAll("path.surface").data([f]);s.enter().append("path").classed("surface",!0).style({"pointer-events":e?"none":"all"}),i.call(p,a,b);var x="M"+(t+f.TR[0])+","+(w+f.TR[1])+v(f.TR,f.BR)+v(f.BR,f.BL)+v(f.BL,f.TL)+"Z";s.attr("d",x),u(a,f,n);var y=o.castOption(r.textposition,f.pts),j=i.selectAll("g.slicetext").data(f.text&&"none"!==y?[0]:[]);j.enter().append("g").classed("slicetext",!0),j.exit().remove(),j.each(function(){var e,j,n,i=c.ensureSingle(g.select(this),"text","",function(a){a.attr("data-notex",1)}),o=c.ensureUniformFontSize(a,q(r,f,d.font));i.text(f.text).attr({"class":"slicetext",transform:"","text-anchor":"middle"}).call(h.font,o).call(k.convertToTspans,a);var p=h.bBox(i.node()),s=Math.min(f.BL[1],f.BR[1])+w,u=Math.max(f.TL[1],f.TR[1])+w;j=Math.max(f.TL[0],f.BL[0])+t,n=Math.min(f.TR[0],f.BR[0])+t,e=l(j,n,s,u,p,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),e.fontSize=o.size,m(r.type,e,d),b[z].transform=e,c.setTransormAndDisplay(i,e)})});var s=g.select(this).selectAll("g.titletext").data(r.title.text?[0]:[]);s.enter().append("g").classed("titletext",!0),s.exit().remove(),s.each(function(){var f=c.ensureSingle(g.select(this),"text","",function(a){a.attr("data-notex",1)}),e=r.title.text;r._meta&&(e=c.templateString(e,r._meta)),f.text(e).attr({"class":"titletext",transform:"","text-anchor":"middle"}).call(h.font,r.title.font).call(k.convertToTspans,a);var b=t(n,d._size);f.attr("transform",j(b.x,b.y)+i(Math.min(1,b.scale))+j(b.tx,b.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../pie/style_one"),f=a("../bar/uniform_text").resizeText;b.exports=function(a){var b=a._fullLayout._funnelarealayer.selectAll(".trace");f(a,b,"funnelarea"),b.each(function(b){var c=b[0].trace,a=d.select(this);a.style({opacity:c.opacity}),a.selectAll("path.surface").each(function(a){d.select(this).call(e,a,c)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(c,e,k){"use strict";var b=c("../scatter/attributes"),f=c("../../plots/attributes"),g=c("../../plots/font_attributes"),d=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=c("../../plots/template_attributes").hovertemplateAttrs,i=c("../../plots/template_attributes").texttemplateAttrs,j=c("../../components/colorscale/attributes"),a=c("../../lib/extend").extendFlat;e.exports=a({z:{valType:"data_array",editType:"calc"},x:a({},b.x,{impliedEdits:{xtype:"array"}}),x0:a({},b.x0,{impliedEdits:{xtype:"scaled"}}),dx:a({},b.dx,{impliedEdits:{xtype:"scaled"}}),y:a({},b.y,{impliedEdits:{ytype:"array"}}),y0:a({},b.y0,{impliedEdits:{ytype:"scaled"}}),dy:a({},b.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:a({},b.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:a({},b.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:a({},b.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:a({},b.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:a({},b.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:a({},b.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z",1),hovertemplate:h(),texttemplate:i({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:g({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:a({},f.showlegend,{dflt:!1})},{transforms:void 0},j("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../plots/cartesian/align_period"),h=a("../histogram2d/calc"),i=a("../../components/colorscale/calc"),j=a("./convert_column_xyz"),k=a("./clean_2d_array"),l=a("./interp2d"),m=a("./find_empties"),n=a("./make_bound_array"),o=a("../../constants/numerical").BADNUM;function p(b){for(var c=[],e=b.length,a=0;a<e;a++){var d=b[a];d!==o&&c.push(d)}return c}b.exports=function(B,a){var b,C,D,w,c,E,F,x,r,u,q,s=f.getFromId(B,a.xaxis||"x"),t=f.getFromId(B,a.yaxis||"y"),G=d.traceIs(a,"contour"),y=d.traceIs(a,"histogram"),Q=d.traceIs(a,"gl2d"),L=G?"best":a.zsmooth;if(s._minDtick=0,t._minDtick=0,y)w=(q=h(B,a)).orig_x,b=q.x,C=q.x0,D=q.dx,x=q.orig_y,c=q.y,E=q.y0,F=q.dy,r=q.z;else{var H=a.z;e.isArray1D(H)?(j(a,s,t,"x","y",["z"]),b=a._x,c=a._y,H=a._z):(w=a.x?s.makeCalcdata(a,"x"):[],x=a.y?t.makeCalcdata(a,"y"):[],b=g(a,s,"x",w).vals,c=g(a,t,"y",x).vals,a._x=b,a._y=c),C=a.x0,D=a.dx,E=a.y0,F=a.dy,r=k(H,a,s,t)}function I(b){L=a._input.zsmooth=a.zsmooth=!1,e.warn('cannot use zsmooth: "fast": '+b)}if((s.rangebreaks||t.rangebreaks)&&(r=function(f,g,c){for(var d=[],e=-1,a=0;a<c.length;a++)if(g[a]!==o){e++,d[e]=[];for(var b=0;b<c[a].length;b++)f[b]!==o&&d[e].push(c[a][b])}return d}(b,c,r),y||(b=p(b),c=p(c),a._x=b,a._y=c)),!y&&(G||a.connectgaps)&&(a._emptypoints=m(r),l(r,a._emptypoints)),"fast"===L){if("log"===s.type||"log"===t.type)I("log axis found");else if(!y){if(b.length){var M=(b[b.length-1]-b[0])/(b.length-1),R=Math.abs(M/100);for(u=0;u<b.length-1;u++)if(Math.abs(b[u+1]-b[u]-M)>R){I("x scale is not linear");break}}if(c.length&&"fast"===L){var N=(c[c.length-1]-c[0])/(c.length-1),S=Math.abs(N/100);for(u=0;u<c.length-1;u++)if(Math.abs(c[u+1]-c[u]-N)>S){I("y scale is not linear");break}}}}var O=e.maxRowLength(r),z="scaled"===a.xtype?"":b,J=n(a,z,C,D,O,s),A="scaled"===a.ytype?"":c,K=n(a,A,E,F,r.length,t);Q||(a._extremes[s._id]=f.findExtremes(s,J),a._extremes[t._id]=f.findExtremes(t,K));var v={x:J,y:K,z:r,text:a._text||a.text,hovertext:a._hovertext||a.hovertext};if(a.xperiodalignment&&w&&(v.orig_x=w),a.yperiodalignment&&x&&(v.orig_y=x),z&&z.length===J.length-1&&(v.xCenter=z),A&&A.length===K.length-1&&(v.yCenter=A),y&&(v.xRanges=q.xRanges,v.yRanges=q.yRanges,v.pts=q.pts),G||i(B,a,{vals:r,cLetter:"z"}),G&&a.contours&&"heatmap"===a.contours.coloring){var P={type:"contour"===a.type?"heatmap":"histogram2d",xcalendar:a.xcalendar,ycalendar:a.ycalendar};v.xfill=n(P,z,C,D,O,s),v.yfill=n(P,A,E,F,r.length,t)}return[v]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../constants/numerical").BADNUM;b.exports=function(b,n,g,h){function q(a){if(d(a))return+a}if(n&&n.transpose){for(a=0,i=0;a<b.length;a++)i=Math.max(i,b[a].length);if(0===i)return!1;r=function(a){return a.length},s=function(a,b,c){return(a[c]||[])[b]}}else i=b.length,r=function(a,b){return a[b].length},s=function(a,b,c){return(a[b]||[])[c]};function o(b){if(!n||"carpet"===n.type||"contourcarpet"===n.type||!b||"category"!==b.type||!n["_"+b._id.charAt(0)].length)return e.identity;var c=b._id.charAt(0),g={},d=n["_"+c+"CategoryMap"]||n[c];for(a=0;a<d.length;a++)g[d[a]]=a;return function(c){var a=g[b._categories[c]];return a+1?a:f}}var i,j,r,s,a,c,p,k,l,t=o(g),u=o(h);h&&"category"===h.type&&(i=h._categories.length);var m=new Array(i);for(a=0;a<i;a++)for(c=0,j=g&&"category"===g.type?g._categories.length:r(b,a),m[a]=new Array(j);c<j;c++)m[a][c]=q((p=b,k=u(a),l=t(c),k===f||l===f?f:s(p,k,l)));return m}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(b,a,c){"use strict";a.exports={min:"zmin",max:"zmax"}},{}],805:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../constants/numerical").BADNUM,f=a("../../plots/cartesian/align_period");b.exports=function(a,j,k,l,m,g){var b,c,t,u,D=a._length,h=j.makeCalcdata(a,l),i=k.makeCalcdata(a,m);h=f(a,j,l,h).vals,i=f(a,k,m,i).vals;var v=a.text,w=void 0!==v&&d.isArray1D(v),x=a.hovertext,y=void 0!==x&&d.isArray1D(x),A=d.distinctVals(h),n=A.vals,B=d.distinctVals(i),o=B.vals,z=[],p=o.length,q=n.length;for(b=0;b<g.length;b++)z[b]=d.init2dArray(p,q);w&&(t=d.init2dArray(p,q)),y&&(u=d.init2dArray(p,q));var C=d.init2dArray(p,q);for(b=0;b<D;b++)if(h[b]!==e&&i[b]!==e){var r=d.findBin(h[b]+A.minDiff/2,n),s=d.findBin(i[b]+B.minDiff/2,o);for(c=0;c<g.length;c++){var E=a[g[c]],F=z[c];F[s][r]=E[b],C[s][r]=b}w&&(t[s][r]=v[b]),y&&(u[s][r]=x[b])}for(c=0,a["_"+l]=n,a["_"+m]=o;c<g.length;c++)a["_"+g[c]]=z[c];w&&(a._text=t),y&&(a._hovertext=u),j&&"category"===j.type&&(a["_"+l+"CategoryMap"]=n.map(function(a){return j._categories[a]})),k&&"category"===k.type&&(a["_"+m+"CategoryMap"]=o.map(function(a){return k._categories[a]})),a._after2before=C}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./xyz_defaults"),f=a("./label_defaults"),g=a("../scatter/period_defaults"),h=a("./style_defaults"),i=a("../../components/colorscale/defaults"),j=a("./attributes");b.exports=function(k,b,l,c){function a(a,c){return d.coerce(k,b,j,a,c)}if(!e(k,b,a,c)){b.visible=!1;return}g(k,b,c,a),a("xhoverformat"),a("yhoverformat"),a("text"),a("hovertext"),a("hovertemplate"),f(a,c),h(k,b,a,c),a("hoverongaps"),a("connectgaps",d.isArray1D(b.z)&& !1!==b.zsmooth),i(k,b,c,a,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(a,b,c){"use strict";var d=a("../../lib").maxRowLength;b.exports=function(h){var p,b,a,e,i,c,j,m,n=[],f={},k=[],o=h[0],g=[],l=[0,0,0],q=d(h);for(b=0;b<h.length;b++)for(a=0,p=g,g=o,o=h[b+1]||[];a<q;a++)void 0===g[a]&&((c=(void 0!==g[a-1]?1:0)+(void 0!==g[a+1]?1:0)+(void 0!==p[a]?1:0)+(void 0!==o[a]?1:0))?(0===b&&c++,0===a&&c++,b===h.length-1&&c++,a===g.length-1&&c++,c<4&&(f[[b,a]]=[b,a,c]),n.push([b,a,c])):k.push([b,a]));for(;k.length;){for(j={},m=!1,i=k.length-1;i>=0;i--)b=(e=k[i])[0],a=e[1],c=((f[[b-1,a]]||l)[2]+(f[[b+1,a]]||l)[2]+(f[[b,a-1]]||l)[2]+(f[[b,a+1]]||l)[2])/20,c&&(j[e]=[b,a,c],k.splice(i,1),m=!0);if(!m)throw"findEmpties iterated with no new neighbors";for(e in j)f[e]=j[e],n.push(j[e])}return n.sort(function(a,b){return b[2]-a[2]})}},{"../../lib":515}],808:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../../components/colorscale").extractOpts;b.exports=function(j,v,w,M,x){x||(x={});var p,q,h,a,k,m,n,y,E=x.isContour,i=j.cd[0],o=i.trace,l=j.xa,r=j.ya,b=i.x,c=i.y,z=i.z,F=i.xCenter,G=i.yCenter,H=i.zmask,J=o.zhoverformat,s=b,t=c;if(!1!==j.index){try{h=Math.round(j.index[1]),a=Math.round(j.index[0])}catch(N){e.error("Error hovering on heatmap, pointNumber must be [row,col], found:",j.index);return}if(h<0||h>=z[0].length||a<0||a>z.length)return}else{if(d.inbox(v-b[0],v-b[b.length-1],0)>0||d.inbox(w-c[0],w-c[c.length-1],0)>0)return;if(E){for(k=1,s=[2*b[0]-b[1]];k<b.length;k++)s.push((b[k]+b[k-1])/2);for(s.push([2*b[b.length-1]-b[b.length-2]]),t=[2*c[0]-c[1]],k=1;k<c.length;k++)t.push((c[k]+c[k-1])/2);t.push([2*c[c.length-1]-c[c.length-2]])}h=Math.max(0,Math.min(s.length-2,e.findBin(v,s))),a=Math.max(0,Math.min(t.length-2,e.findBin(w,t)))}var A=l.c2p(b[h]),B=l.c2p(b[h+1]),C=r.c2p(c[a]),D=r.c2p(c[a+1]);E?(m=i.orig_x||b,n=i.orig_y||c,B=A,p=m[h],D=C,q=n[a]):(m=i.orig_x||F||b,n=i.orig_y||G||c,p=F?m[h]:(m[h]+m[h+1])/2,q=G?n[a]:(n[a]+n[a+1])/2,l&&"category"===l.type&&(p=b[h]),r&&"category"===r.type&&(q=c[a]),o.zsmooth&&(A=B=l.c2p(p),C=D=r.c2p(q)));var u=z[a][h];if(H&&!H[a][h]&&(u=void 0),void 0!==u||o.hoverongaps){Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[a])?y=i.hovertext[a][h]:Array.isArray(i.text)&&Array.isArray(i.text[a])&&(y=i.text[a][h]);var I=g(o),K={type:"linear",range:[I.min,I.max],hoverformat:J,_separators:l._separators,_numFormat:l._numFormat},L=f.tickText(K,u,"hover").text;return[e.extendFlat(j,{index:o._after2before?o._after2before[a][h]:[a,h],distance:j.maxHoverDistance,spikeDistance:j.maxSpikeDistance,x0:A,x1:B,y0:C,y1:D,xLabelVal:p,yLabelVal:q,zLabelVal:u,zLabel:L,text:y})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),colorbar:a("./colorbar"),style:a("./style"),hoverPoints:a("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(a,b,c){"use strict";var d=a("../../lib"),e=[[-1,0],[1,0],[0,-1],[0,1]];function f(a){return .5-.25*Math.min(1,.5*a)}function g(c,n,o){var p,a,b,i,j,q,r,d,f,k,l,g,h,m=0;for(i=0;i<n.length;i++){for(j=0,a=(p=n[i])[0],b=p[1],l=c[a][b],k=0,f=0;j<4;j++)(r=c[a+(q=e[j])[0]])&& void 0!==(d=r[b+q[1]])&&(0===k?g=h=d:(g=Math.min(g,d),h=Math.max(h,d)),f++,k+=d);if(0===f)throw"iterateInterp2d order is wrong: no defined neighbors";c[a][b]=k/f,void 0===l?f<4&&(m=1):(c[a][b]=(1+o)*c[a][b]-o*l,h>g&&(m=Math.max(m,Math.abs(c[a][b]-l)/(h-g))))}return m}b.exports=function(e,b){var a,c=1;for(g(e,b),a=0;a<b.length&&!(b[a][2]<4);a++);for(b=b.slice(a),a=0;a<100&&c>.01;a++)c=g(e,b,f(c));return c>.01&&d.log("interp2d didn't converge quickly",c),e}},{"../../lib":515}],811:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){a("texttemplate");var c=d.extendFlat({},b.font,{color:"auto",size:"auto"});d.coerceFont(a,"textfont",c)}},{"../../lib":515}],812:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib").isArrayOrTypedArray;b.exports=function(i,a,j,r,f,g){var m,n,b,c=[],k=d.traceIs(i,"contour"),o=d.traceIs(i,"histogram"),p=d.traceIs(i,"gl2d");if(e(a)&&a.length>1&&!o&&"category"!==g.type){var h=a.length;if(!(h<=f))return k?a.slice(0,f):a.slice(0,f+1);if(k||p)c=a.slice(0,f);else if(1===f)c=[a[0]-.5,a[0]+.5];else{for(b=1,c=[1.5*a[0]-.5*a[1]];b<h;b++)c.push((a[b-1]+a[b])*.5);c.push(1.5*a[h-1]-.5*a[h-2])}if(h<f){var l=c[c.length-1],s=l-c[c.length-2];for(b=h;b<f;b++)l+=s,c.push(l)}}else{var q=i[g._id.charAt(0)+"calendar"];for(m=o?g.r2c(j,0,q):e(a)&&1===a.length?a[0]:void 0===j?0:("log"===g.type?g.d2c:g.r2c)(j,0,q),n=r||1,b=k||p?0:-0.5;b<f;b++)c.push(m+n*b)}return c}},{"../../lib":515,"../../registry":647}],813:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("tinycolor2"),f=a("../../registry"),g=a("../../components/drawing"),h=a("../../plots/cartesian/axes"),i=a("../../lib"),j=a("../../lib/svg_text_utils"),k=a("../scatter/format_labels"),l=a("../../components/color"),m=a("../../components/colorscale").extractOpts,n=a("../../components/colorscale").makeColorScaleFuncFromTrace,o=a("../../constants/xmlns_namespaces"),p=a("../../constants/alignment").LINE_SPACING,q="heatmap-label";function r(a){return a.selectAll("g."+q)}function s(a){r(a).remove()}function t(g,c){var d=c.length-2,e=i.constrain(i.findBin(g,c),0,d),h=c[e],j=c[e+1],b=i.constrain(e+(g-h)/(j-h)-.5,0,d),a=Math.round(b),f=Math.abs(b-a);return b&&b!==d&&f?{bin0:a,frac:f,bin1:Math.round(a+f/(b-a))}:{bin0:a,bin1:a,frac:0}}function u(d,b){var f=b.length-1,a=i.constrain(i.findBin(d,b),0,f),e=b[a],c=(d-e)/(b[a+1]-e)||0;return c<=0?{bin0:a,bin1:a,frac:0}:c<.5?{bin0:a,bin1:a+1,frac:c}:{bin0:a+1,bin1:a,frac:1-c}}function v(a,b,c){a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=Math.round(255*c[3])}b.exports=function(w,a,b,c){var x=a.xaxis,y=a.yaxis;i.makeTraceGroups(c,b,"hm").each(function(at){var R=d.select(this),c=at[0],A=c.trace,ab=A.xgap||0,ac=A.ygap||0,L=c.z,F=c.x,G=c.y,ad=c.xCenter,ae=c.yCenter,au=f.traceIs(A,"contour"),M=au?"best":A.zsmooth,H=L.length,N=i.maxRowLength(L),af=!1,ag=!1;for(a=0;void 0===aA&&a<F.length-1;)aA=x.c2p(F[a]),a++;for(a=F.length-1;void 0===ba&&a>0;)ba=x.c2p(F[a]),a--;for(ba<aA&&(bb=ba,ba=aA,aA=bb,af=!0),a=0;void 0===aB&&a<G.length-1;)aB=y.c2p(G[a]),a++;for(a=G.length-1;void 0===bc&&a>0;)bc=y.c2p(G[a]),a--;if(bc<aB&&(bb=aB,aB=bc,bc=bb,ag=!0),au&&(ad=F,ae=G,F=c.xfill,G=c.yfill),"fast"!==M){var U="best"===M?0:.5;aA=Math.max(-U*x._length,aA),ba=Math.min((1+U)*x._length,ba),aB=Math.max(-U*y._length,aB),bc=Math.min((1+U)*y._length,bc)}var C=Math.round(ba-aA),I=Math.round(bc-aB);if(C<=0||I<=0){R.selectAll("image").data([]).exit().remove(),s(R);return}"fast"===M?(bd=N,be=H):(bd=C,be=I);var V=document.createElement("canvas");V.width=bd,V.height=be;var W=V.getContext("2d"),a8=n(A,{noNumericCheck:!0,returnArray:!0});"fast"===M?(ah=af?function(a){return N-1-a}:i.identity,aC=ag?function(a){return H-1-a}:i.identity):(ah=function(a){return i.constrain(Math.round(x.c2p(F[a])-aA),0,C)},aC=function(a){return i.constrain(Math.round(y.c2p(G[a])-aB),0,I)});var av=aC(0),z=[av,av],aW=af?0:1,aX=ag?0:1,S=0,aw=0,ax=0,ay=0;function az(c,b){if(void 0!==c){var a=a8(c);return a[0]=Math.round(a[0]),a[1]=Math.round(a[1]),a[2]=Math.round(a[2]),S+=b,aw+=a[0]*b,ax+=a[1]*b,ay+=a[2]*b,a}return[0,0,0,0]}function aY(f,g,c,i){var h,a=f[c.bin0];if(void 0===a)return az(void 0,1);var e=f[c.bin1],b=g[c.bin0],d=g[c.bin1],j=e-a||0,k=b-a||0;return h=void 0===e?void 0===d?0:void 0===b?2*(d-a):(2*d-b-a)*2/3:void 0===d?void 0===b?0:(2*a-e-b)*2/3:void 0===b?(2*d-e-a)*2/3:d+a-e-b,az(a+c.frac*j+i.frac*(k+c.frac*h))}if(M){var X=0;try{Z=new Uint8Array(C*I*4)}catch(a9){Z=new Array(C*I*4)}if("best"===M){var aA,ba,bb,aB,bc,a,b,D,bd,be,ah,aC,B,aD,Y,T,Z,ai,aE,aF,aj=ad||F,ak=ae||G,aG=new Array(aj.length),aH=new Array(ak.length),aI=new Array(C),aZ=ad?u:t,a$=ae?u:t;for(a=0;a<aj.length;a++)aG[a]=Math.round(x.c2p(aj[a])-aA);for(a=0;a<ak.length;a++)aH[a]=Math.round(y.c2p(ak[a])-aB);for(a=0;a<C;a++)aI[a]=aZ(a,aG);for(b=0;b<I;b++)for(a=0,aE=L[(ai=a$(b,aH)).bin0],aF=L[ai.bin1];a<C;a++,X+=4)v(Z,X,T=aY(aE,aF,aI[a],ai))}else for(b=0;b<H;b++)for(a=0,Y=L[b],z=aC(b);a<C;a++)T=az(Y[a],1),X=(z*C+ah(a))*4,v(Z,X,T);var al=W.createImageData(C,I);try{al.data.set(Z)}catch(bf){var aJ=al.data,a_=aJ.length;for(b=0;b<a_;b++)aJ[b]=Z[b]}W.putImageData(al,0,0)}else{var a0=Math.floor(ab/2),a1=Math.floor(ac/2);for(b=0;b<H;b++)if(Y=L[b],z.reverse(),z[aX]=aC(b+1),z[0]!==z[1]&& void 0!==z[0]&& void 0!==z[1])for(a=0,B=[aD=ah(0),aD];a<N;a++)B.reverse(),B[aW]=ah(a+1),B[0]!==B[1]&& void 0!==B[0]&& void 0!==B[1]&&(T=az(Y[a],(B[1]-B[0])*(z[1]-z[0])),W.fillStyle="rgba("+T.join(",")+")",W.fillRect(B[0]+a0,z[0]+a1,B[1]-B[0]-ab,z[1]-z[0]-ac))}var a2=e("rgb("+(aw=Math.round(aw/S))+","+(ax=Math.round(ax/S))+","+(ay=Math.round(ay/S))+")");w._hmpixcount=(w._hmpixcount||0)+S,w._hmlumcount=(w._hmlumcount||0)+S*a2.getLuminance();var aK=R.selectAll("image").data(at);aK.enter().append("svg:image").attr({xmlns:o.svg,preserveAspectRatio:"none"}),aK.attr({height:I,width:C,x:aA,y:aB,"xlink:href":V.toDataURL("image/png")}),s(R);var aL=A.texttemplate;if(aL){var aM=m(A),a3={type:"linear",range:[aM.min,aM.max],_separators:x._separators,_numFormat:x._numFormat},aN="histogram2dcontour"===A.type,O="contour"===A.type,a4=O?1:0,a5=O?H-1:H,a6=O?1:0,a7=O?N-1:N,P=[];for(a=a4;a<a5;a++){if(O)aO=c.y[a];else if(aN){if(0===a||a===H-1)continue;aO=c.y[a]}else if(c.yCenter)aO=c.yCenter[a];else{if(a+1===H&& void 0===c.y[a+1])continue;aO=(c.y[a]+c.y[a+1])/2}var am=Math.round(y.c2p(aO));if(!(0>am)&&!(am>y._length))for(b=a6;b<a7;b++){if(O)an=c.x[b];else if(aN){if(0===b||b===N-1)continue;an=c.x[b]}else if(c.xCenter)an=c.xCenter[b];else{if(b+1===N&& void 0===c.x[b+1])continue;an=(c.x[b]+c.x[b+1])/2}var aO,an,ao=Math.round(x.c2p(an));if(!(0>ao)&&!(ao>x._length)){var E=k({x:an,y:aO},A,w._fullLayout);E.x=an,E.y=aO;var $=c.z[a][b];void 0===$?(E.z="",E.zLabel=""):(E.z=$,E.zLabel=h.tickText(a3,$,"hover").text);var _=c.text&&c.text[a]&&c.text[a][b];(void 0===_|| !1===_)&&(_=""),E.text=_;var ap=i.texttemplateString(aL,E,w._fullLayout._d3locale,E,A._meta||{});if(ap){var aP=ap.split("<br>"),aQ=aP.length,aq=0;for(D=0;D<aQ;D++)aq=Math.max(aq,aP[D].length);P.push({l:aQ,c:aq,t:ap,x:ao,y:am,z:$})}}}}var aR=A.textfont,bg=aR.family,Q=aR.size,aS=w._fullLayout.font.size;if(!Q||"auto"===Q){var J=1/0,K=1/0,ar=0,as=0;for(D=0;D<P.length;D++){var aa=P[D];if(ar=Math.max(ar,aa.l),as=Math.max(as,aa.c),D<P.length-1){var aT=P[D+1],aU=Math.abs(aT.x-aa.x),aV=Math.abs(aT.y-aa.y);aU&&(J=Math.min(J,aU)),aV&&(K=Math.min(K,aV))}}isFinite(J)&&isFinite(K)?(J-=ab,K-=ac,J/=as,K/=ar,J/=p/2,K/=p,Q=Math.min(Math.floor(J),Math.floor(K),aS)):Q=aS}if(Q<=0||!isFinite(Q))return;var bh=function(a){return a.x},bi=function(a){return a.y-Q*(a.l*p/2-1)};r(R).data(P).enter().append("g").classed(q,1).append("text").attr("text-anchor","middle").each(function(a){var c=d.select(this),b=aR.color;b&&"auto"!==b||(b=l.contrast("rgba("+a8(a.z).join()+")")),c.attr("data-notex",1).call(j.positionText,bh(a),bi(a)).call(g.font,bg,Q,b).text(a.t).call(j.convertToTspans,w)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(a,b,c){"use strict";var d=a("@plotly/d3");b.exports=function(a){d.select(a).selectAll(".hm image").style("opacity",function(a){return a.trace.opacity})}},{"@plotly/d3":58}],815:[function(b,a,c){"use strict";a.exports=function(b,c,a){!1===a("zsmooth")&&(a("xgap"),a("ygap")),a("zhoverformat")}},{}],816:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../registry");function g(a,b){var c=b(a);return"scaled"===(c?b(a+"type","array"):"scaled")&&(b(a+"0"),b("d"+a)),c}b.exports=function(i,j,a,o,b,c){var k,l,h=a("z");if(b=b||"x",c=c||"y",void 0===h||!h.length)return 0;if(e.isArray1D(i.z)){k=a(b),l=a(c);var m=e.minRowLength(k),n=e.minRowLength(l);if(0===m||0===n)return 0;j._length=Math.min(m,n,h.length)}else{if(k=g(b,a),l=g(c,a),!function(f){for(var a,g=!0,h=!1,i=!1,b=0;b<f.length;b++){if(a=f[b],!e.isArrayOrTypedArray(a)){g=!1;break}a.length>0&&(h=!0);for(var c=0;c<a.length;c++)if(d(a[c])){i=!0;break}}return g&&h&&i}(h))return 0;a("transpose"),j._length=null}return"heatmapgl"===i.type||(f.getComponentMethod("calendars","handleTraceDefaults")(i,j,[b,c],o),!0)}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(a,f,k){"use strict";for(var g=a("../heatmap/attributes"),h=a("../../components/colorscale/attributes"),i=a("../../lib/extend").extendFlat,j=a("../../plot_api/edit_types").overrideAll,d=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],b={},c=0;c<d.length;c++){var e=d[c];b[e]=g[e]}b.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},i(b,h("",{cLetter:"z",autoColorDflt:!1})),f.exports=j(b,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(a,c,e){"use strict";var f=a("../../../stackgl_modules").gl_heatmap2d,g=a("../../plots/cartesian/axes"),h=a("../../lib/str2rgbarray");function d(a,b){this.scene=a,this.uid=b,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=f(a.glplot,this.options),this.heatmap._trace=this}var b=d.prototype;b.handlePick=function(c){var a=this.options,d=a.shape,b=c.pointId,e=b%d[0],f=Math.floor(b/d[0]);return{trace:this,dataCoord:c.dataCoord,traceCoord:[a.x[e],a.y[f],a.z[b]],textLabel:this.textLabels[b],name:this.name,pointIndex:[f,e],hoverinfo:this.hoverinfo}},b.update=function(a,k){var d,e,b=k[0];this.index=a.index,this.name=a.name,this.hoverinfo=a.hoverinfo;var c=b.z;this.options.z=[].concat.apply([],c);var l=c[0].length,m=c.length;this.options.shape=[l,m],this.options.x=b.x,this.options.y=b.y,this.options.zsmooth=a.zsmooth;var f=function(c){for(var e=c.colorscale,f=c.zmin,k=c.zmax,d=e.length,g=new Array(d),i=new Array(4*d),a=0;a<d;a++){var j=e[a],l=h(j[1]);g[a]=f+j[0]*(k-f);for(var b=0;b<4;b++)i[4*a+b]=l[b]}return{colorLevels:g,colorValues:i}}(a);this.options.colorLevels=f.colorLevels,this.options.colorValues=f.colorValues,this.textLabels=[].concat.apply([],a.text),this.heatmap.update(this.options);var i=this.scene.xaxis,j=this.scene.yaxis;!1===a.zsmooth&&(d={ppad:b.x[1]-b.x[0]},e={ppad:b.y[1]-b.y[0]}),a._extremes[i._id]=g.findExtremes(i,b.x,d),a._extremes[j._id]=g.findExtremes(j,b.y,e)},b.dispose=function(){this.heatmap.dispose()},c.exports=function(c,a,e){var b=new d(c,a.uid);return b.update(a,e),b}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../heatmap/xyz_defaults"),f=a("../../components/colorscale/defaults"),g=a("./attributes");b.exports=function(c,b,i,h){function a(a,e){return d.coerce(c,b,g,a,e)}if(!e(c,b,a,h)){b.visible=!1;return}a("text"),a("zsmooth"),f(c,b,h,a,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../heatmap/colorbar"),calc:a("../heatmap/calc"),plot:a("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:a("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(b,g,k){"use strict";var a=b("../bar/attributes"),e=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=b("../../plots/template_attributes").hovertemplateAttrs,i=b("../../plots/template_attributes").texttemplateAttrs,c=b("../../plots/font_attributes"),f=b("./bin_attributes"),j=b("./constants"),d=b("../../lib/extend").extendFlat;g.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:e("x"),yhoverformat:e("y"),text:d({},a.text,{}),hovertext:d({},a.hovertext,{}),orientation:a.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:f("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:f("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:h({},{keys:j.eventDataKeys}),texttemplate:i({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:d({},a.textposition,{arrayOk:!1}),textfont:c({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:c({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:c({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:a.insidetextanchor,textangle:a.textangle,cliponaxis:a.cliponaxis,constraintext:a.constraintext,marker:a.marker,offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,_deprecated:{bardir:a._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(b,a,c){"use strict";a.exports=function(b,c){for(var e=b.length,d=0,a=0;a<e;a++)c[a]?(b[a]/=c[a],d+=b[a]):b[a]=null;return d}},{}],823:[function(b,a,c){"use strict";a.exports=function(a,b){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(a,b,c){"use strict";var d=a("fast-isnumeric");b.exports={count:function(a,c,b){return b[a]++,1},sum:function(b,c,e,f){var a=f[c];return d(a)?(a=Number(a),e[b]+=a,a):0},avg:function(b,c,e,f,g){var a=f[c];return d(a)&&(a=Number(a),e[b]+=a,g[b]++),0},min:function(b,e,c,f){var a=f[e];if(d(a)){if(a=Number(a),!d(c[b]))return c[b]=a,a;if(c[b]>a){var g=a-c[b];return c[b]=a,g}}return 0},max:function(b,e,c,f){var a=f[e];if(d(a)){if(a=Number(a),!d(c[b]))return c[b]=a,a;if(c[b]<a){var g=a-c[b];return c[b]=a,g}}return 0}}},{"fast-isnumeric":190}],825:[function(b,c,d){"use strict";var a=b("../../constants/numerical"),e=a.ONEAVGYEAR,f=a.ONEAVGMONTH,g=a.ONEDAY,h=a.ONEHOUR,i=a.ONEMIN,j=a.ONESEC,k=b("../../plots/cartesian/axes").tickIncrement;function l(b,c,f,h){if(b*c<=0)return 1/0;for(var i=Math.abs(c-b),d="date"===f.type,a=m(i,d),g=0;g<10;g++){var e=m(80*a,d);if(a===e)break;if(n(e,b,c,d,f,h))a=e;else break}return a}function m(a,b){return b&&a>j?a>g?a>1.1*e?e:a>1.1*f?f:g:a>h?h:a>i?i:j:Math.pow(10,Math.floor(Math.log(a)/Math.LN10))}function n(a,b,c,i,d,f){if(i&&a>g){var j=o(b,d,f),k=o(c,d,f),h=a===e?0:1;return j[h]!==k[h]}return Math.floor(c/a)-Math.floor(b/a)>.1}function o(b,c,d){var a=c.c2d(b,e,d).split("-");return""===a[0]&&(a.unshift(),a[0]="-"+a[0]),a}c.exports=function(r,m,n,a,h){var b,o,p=-1.1*m,c=-0.1*m,q=r-c,d=n[0],f=n[1],i=Math.min(l(d+c,d+q,a,h),l(f+c,f+q,a,h)),j=Math.min(l(d+p,d+c,a,h),l(f+p,f+c,a,h));if(i>j&&j<Math.abs(f-d)/4e3?(b=i,o=!1):(b=Math.min(i,j),o=!0),"date"===a.type&&b>g){var s=b===e?1:6,t=b===e?"M12":"M1";return function(d,i){var c=a.c2d(d,e,h),f=c.indexOf("-",s);f>0&&(c=c.substr(0,f));var b=a.d2c(c,0,h);if(b<d){var g=k(b,t,!1,h);(b+g)/2<d+r&&(b=g)}return i&&o?k(b,t,!0,h):b}}return function(c,d){var a=b*Math.round(c/b);return a+b/10<c&&a+.9*b<c+r&&(a+=b),d&&o&&(a-=b),a}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(a,b,d){"use strict";var e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../registry"),h=a("../../plots/cartesian/axes"),i=a("../bar/arrays_to_calcdata"),j=a("./bin_functions"),k=a("./norm_functions"),l=a("./average"),m=a("./bin_label_vals");function c(C,d,c,i,M){var p,o,j,k,l,D,u,m=i+"bins",E=C._fullLayout,N=d["_"+i+"bingroup"],a=E._histogramBinOpts[N],O="overlay"===E.barmode,r=function(a){return c.r2c(a,0,k)},s=function(a){return c.c2r(a,0,k)},S="date"===c.type?function(a){return a||0===a?f.cleanDate(a,null,k):null}:function(a){return e(a)?Number(a):null};function F(a,b,c){b[a+"Found"]?(b[a]=S(b[a]),null===b[a]&&(b[a]=c[a])):(D[a]=b[a]=c[a],f.nestedProperty(o[0],m+"."+a).set(c[a]))}if(d["_"+i+"autoBinFinished"])delete d["_"+i+"autoBinFinished"];else{o=a.traces;var v=[],G=!0,H=!1,I=!1;for(p=0;p<o.length;p++)if((j=o[p]).visible){var J=a.dirs[p];l=j["_"+J+"pos0"]=c.makeCalcdata(j,J),v=f.concat(v,l),delete j["_"+i+"autoBinFinished"],!0===d.visible&&(G?G=!1:(delete j._autoBin,j["_"+i+"autoBinFinished"]=1),g.traceIs(j,"2dMap")&&(H=!0),"histogram2dcontour"===j.type&&(I=!0))}k=o[0][i+"calendar"];var b=h.autoBin(v,c,a.nbins,H,k,a.sizeFound&&a.size);if(D=(o[0]._autoBin={})[a.dirs[0]]={},I&&(a.size||(b.start=s(h.tickIncrement(r(b.start),b.size,!0,k))),void 0===a.end&&(b.end=s(h.tickIncrement(r(b.end),b.size,!1,k)))),O&&!g.traceIs(d,"2dMap")&&0===b._dataSpan&&"category"!==c.type&&"multicategory"!==c.type){if(M)return[b,l,!0];b=n(C,d,c,i,m)}(u=j.cumulative||{}).enabled&&"include"!==u.currentbin&&("decreasing"===u.direction?b.start=s(h.tickIncrement(r(b.start),b.size,!0,k)):b.end=s(h.tickIncrement(r(b.end),b.size,!1,k))),a.size=b.size,a.sizeFound||(D.size=b.size,f.nestedProperty(o[0],m+".size").set(b.size)),F("start",a,b),F("end",a,b)}l=d["_"+i+"pos0"],delete d["_"+i+"pos0"];var K=d._input[m]||{},q=f.extendFlat({},a),L=a.start,w=c.r2l(K.start),x=void 0!==w;if((a.startFound||x)&&w!==c.r2l(L)){var y=x?w:f.aggNums(Math.min,null,l),P={type:"category"===c.type||"multicategory"===c.type?"linear":c.type,r2l:c.r2l,dtick:a.size,tick0:L,calendar:k,range:[y,h.tickIncrement(y,a.size,!1,k)].map(c.l2r)},t=h.tickFirst(P);t>c.r2l(y)&&(t=h.tickIncrement(t,a.size,!0,k)),q.start=c.l2r(t),x||f.nestedProperty(d,m+".start").set(q.start)}var Q=a.end,z=c.r2l(K.end),A=void 0!==z;if((a.endFound||A)&&z!==c.r2l(Q)){var R=A?z:f.aggNums(Math.max,null,l);q.end=c.l2r(R),A||f.nestedProperty(d,m+".start").set(q.end)}var B="autobin"+i;return!1===d._input[B]&&(d._input[m]=f.extendFlat({},d[m]||{}),delete d._input[B],delete d[B]),[q,l]}function n(l,h,m,e,i){var a,b,n,r=l._fullLayout,s=o(l,h),t=!1,d=1/0,g=[h];for(a=0;a<s.length;a++)if((b=s[a])===h)t=!0;else if(t){var p=c(l,b,m,e,!0),w=p[0],x=p[2];b["_"+e+"autoBinFinished"]=1,b["_"+e+"pos0"]=p[1],x?g.push(b):d=Math.min(d,w.size)}else d=Math.min(d,(n=r._histogramBinOpts[b["_"+e+"bingroup"]]).size||b[i].size);var j=new Array(g.length);for(a=0;a<g.length;a++)for(var q=g[a]["_"+e+"pos0"],k=0;k<q.length;k++)if(void 0!==q[k]){j[a]=q[k];break}for(isFinite(d)||(d=f.distinctVals(j).minDiff),a=0;a<g.length;a++){var u=(b=g[a])[e+"calendar"],v={start:m.c2r(j[a]-d/2,0,u),end:m.c2r(j[a]+d/2,0,u),size:d};b._input[i]=b[i]=v,(n=r._histogramBinOpts[b["_"+e+"bingroup"]])&&f.extendFlat(n,v)}return h[i]}function o(f,b){for(var g=b.xaxis,h=b.yaxis,i=b.orientation,d=[],e=f._fullData,c=0;c<e.length;c++){var a=e[c];"histogram"===a.type&& !0===a.visible&&a.orientation===i&&a.xaxis===g&&a.yaxis===h&&d.push(a)}return d}b.exports={calc:function(o,b){var a,v,Q,g,R,G,s=[],d=[],S="h"===b.orientation,T=h.getFromId(o,S?b.yaxis:b.xaxis),z=S?"y":"x",U={x:"y",y:"x"}[z],H=b[z+"calendar"],w=b.cumulative,V=c(o,b,T,z),p=V[0],A=V[1],W="string"==typeof p.size,q=[],x=W?q:p,X=[],I=[],r=[],J=0,B=b.histnorm,y=b.histfunc,K=-1!==B.indexOf("density");w.enabled&&K&&(B=B.replace(/ ?density$/,""),K=!1);var aa="max"===y||"min"===y?null:0,Y=j.count,Z=k[B],L=!1,C=function(a){return T.r2c(a,0,H)};for(f.isArrayOrTypedArray(b[U])&&"count"!==y&&(R=b[U],L="avg"===y,Y=j[y]),a=C(p.start),Q=C(p.end)+(a-h.tickIncrement(a,p.size,!1,H))/1e6;a<Q&&s.length<1e6&&(v=h.tickIncrement(a,p.size,!1,H),s.push((a+v)/2),d.push(aa),r.push([]),q.push(a),K&&X.push(1/(v-a)),L&&I.push(0),!(v<=a));)a=v;q.push(a),W||"date"!==T.type||(x={start:C(x.start),end:C(x.end),size:x.size}),o._fullLayout._roundFnOpts||(o._fullLayout._roundFnOpts={});var D=b["_"+z+"bingroup"],t={leftGap:1/0,rightGap:1/0};D&&(o._fullLayout._roundFnOpts[D]||(o._fullLayout._roundFnOpts[D]=t),t=o._fullLayout._roundFnOpts[D]);var ab=d.length,E=!0,M=t.leftGap,N=t.rightGap,$={};for(a=0;a<A.length;a++){var F=A[a];(g=f.findBin(F,x))>=0&&g<ab&&(J+=Y(g,a,d,R,I),E&&r[g].length&&F!==A[r[g][0]]&&(E=!1),r[g].push(a),$[a]=g,M=Math.min(M,F-q[g]),N=Math.min(N,q[g+1]-F))}t.leftGap=M,t.rightGap=N,E||(G=function(a,b){return function(){var c=o._fullLayout._roundFnOpts[D];return m(c.leftGap,c.rightGap,q,T,H)(a,b)}}),L&&(J=l(d,I)),Z&&Z(d,J,X),w.enabled&&function(b,d,c){var a,g,h;function e(a){h=b[a],b[a]/=2}function f(a){g=b[a],b[a]=h+g/2,h+=g}if("half"===c)if("increasing"===d)for(e(0),a=1;a<b.length;a++)f(a);else for(e(b.length-1),a=b.length-2;a>=0;a--)f(a);else if("increasing"===d){for(a=1;a<b.length;a++)b[a]+=b[a-1];"exclude"===c&&(b.unshift(0),b.pop())}else{for(a=b.length-2;a>=0;a--)b[a]+=b[a+1];"exclude"===c&&(b.push(0),b.shift())}}(d,w.direction,w.currentbin);var O=Math.min(s.length,d.length),n=[],P=0,_=O-1;for(a=0;a<O;a++)if(d[a]){P=a;break}for(a=O-1;a>=P;a--)if(d[a]){_=a;break}for(a=P;a<=_;a++)if(e(s[a])&&e(d[a])){var u={p:s[a],s:d[a],b:0};w.enabled||(u.pts=r[a],E?u.ph0=u.ph1=r[a].length?A[r[a][0]]:s[a]:(b._computePh=!0,u.ph0=G(q[a]),u.ph1=G(q[a+1],!0))),n.push(u)}return 1===n.length&&(n[0].width1=h.tickIncrement(n[0].p,p.size,!1,H)-n[0].p),i(n,b),f.isArrayOrTypedArray(b.selectedpoints)&&f.tagSelected(n,b,$),n},calcAllAutoBins:c}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(b,a,c){"use strict";a.exports={eventDataKeys:["binNumber"]}},{}],828:[function(a,b,d){"use strict";var c=a("../../lib"),e=a("../../plots/cartesian/axis_ids"),f=a("../../registry").traceIs,g=a("../bar/defaults").handleGroupingDefaults,h=c.nestedProperty,i=a("../../plots/cartesian/constraints").getAxisGroup,j=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],k=["x","y"];b.exports=function(z,b){var A=b._histogramBinOpts={},u=[],p={},s=[];function m(a,b){return c.coerce(n._input,n,n._module.attributes,a,b)}function t(a){return"v"===a.orientation?"x":"y"}function v(d,g,f){var j,k,l=d.uid+"__"+f;g||(g=l);var h=(j=d,k=f,e.getFromTrace({_fullLayout:b},j,k).type),i=d[f+"calendar"]||"",a=A[g],m=!0;a&&(h===a.axType&&i===a.calendar?(m=!1,a.traces.push(d),a.dirs.push(f)):(g=l,h!==a.axType&&c.warn(["Attempted to group the bins of trace",d.index,"set on a","type:"+h,"axis","with bins on","type:"+a.axType,"axis."].join(" ")),i!==a.calendar&&c.warn(["Attempted to group the bins of trace",d.index,"set with a",i,"calendar","with bins",a.calendar?"on a "+a.calendar+" calendar":"w/o a set calendar"].join(" ")))),m&&(A[g]={traces:[d],dirs:[f],axType:h,calendar:d[f+"calendar"]||""}),d["_"+f+"bingroup"]=g}for(l=0;l<z.length;l++)f(n=z[l],"histogram")&&(u.push(n),delete n._xautoBinFinished,delete n._yautoBinFinished,f(n,"2dMap")||g(n._input,n,b,m));var E=b._alignmentOpts||{};for(l=0;l<u.length;l++){if(n=u[l],G="",!f(n,"2dMap")){if(r=t(n),"group"===b.barmode&&n.alignmentgroup){var B=i(b,n[r+"axis"])+n.orientation;(E[B]||{})[n.alignmentgroup]&&(G=B)}G||"overlay"===b.barmode||(G=i(b,n.xaxis)+i(b,n.yaxis)+t(n))}G?(p[G]||(p[G]=[]),p[G].push(n)):s.push(n)}for(G in p){if(1===(q=p[G]).length){s.push(q[0]);continue}var C=!1;for(q.length&&(n=q[0],C=m("bingroup")),G=C||G,l=0;l<q.length;l++){var w=(n=q[l])._input.bingroup;w&&w!==G&&c.warn(["Trace",n.index,"must match","within bingroup",G+".","Ignoring its bingroup:",w,"setting."].join(" ")),n.bingroup=G,v(n,G,t(n))}}for(l=0;l<s.length;l++){n=s[l];var x=m("bingroup");if(f(n,"2dMap"))for(H=0;H<2;H++)v(n,m((r=k[H])+"bingroup",x?x+"__"+r:null),r);else v(n,x,t(n))}for(G in A){var d=A[G];for(F=0,q=d.traces;F<j.length;F++){var n,q,G,r,l,F,H,o,y,D=j[F],a=D.name;if("nbins"!==a||!d.sizeFound){for(l=0;l<q.length;l++){if(n=q[l],r=d.dirs[l],o=D.aStr[r],void 0!==h(n._input,o).get()){d[a]=m(o),d[a+"Found"]=!0;break}(y=(n._autoBin||{})[r]||{})[a]&&h(n,o).set(y[a])}if("start"===a||"end"===a)for(;l<q.length;l++)(n=q[l])["_"+r+"bingroup"]&&m(o,(y=(n._autoBin||{})[r]||{})[a]);"nbins"!==a||d.sizeFound||d.nbinsFound||(n=q[0],d[a]=m(o))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../components/color"),g=a("../bar/defaults").handleText,h=a("../bar/style_defaults"),i=a("./attributes");b.exports=function(c,b,r,j){function a(a,d){return e.coerce(c,b,i,a,d)}var k=a("x"),l=a("y");a("cumulative.enabled")&&(a("cumulative.direction"),a("cumulative.currentbin")),a("text");var s=a("textposition");g(c,b,j,a,s,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),a("hovertext"),a("hovertemplate"),a("xhoverformat"),a("yhoverformat");var m=a("orientation",l&&!k?"h":"v"),n="v"===m?"x":"y",o=k&&l?Math.min(e.minRowLength(k)&&e.minRowLength(l)):e.minRowLength(b[n]||[]);if(!o){b.visible=!1;return}b._length=o,d.getComponentMethod("calendars","handleTraceDefaults")(c,b,["x","y"],j),b["v"===m?"y":"x"]&&a("histfunc"),a("histnorm"),a("autobin"+n),h(c,b,a,r,j),e.coerceSelectionMarkerOpacity(b,a);var p=(b.marker.line||{}).color,q=d.getComponentMethod("errorbars","supplyDefaults");q(c,b,p||f.defaultLine,{axis:"y"}),q(c,b,p||f.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(b,a,c){"use strict";a.exports=function(a,b,f,h,d){if(a.x="xVal"in b?b.xVal:b.x,a.y="yVal"in b?b.yVal:b.y,"zLabelVal"in b&&(a.z=b.zLabelVal),b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),!(f.cumulative||{}).enabled){var c,e=Array.isArray(d)?h[0].pts[d[0]][d[1]]:h[d].pts;if(a.pointNumbers=e,a.binNumber=a.pointNumber,delete a.pointNumber,delete a.pointIndex,f._indexToPoints){c=[];for(var g=0;g<e.length;g++)c=c.concat(f._indexToPoints[e[g]])}else c=e;a.pointIndices=c}return a}},{}],831:[function(a,b,c){"use strict";var d=a("../bar/hover").hoverPoints,e=a("../../plots/cartesian/axes").hoverLabelText;b.exports=function(a,h,i,j,k){var b=d(a,h,i,j,k);if(b){var g=(a=b[0]).cd[a.index],c=a.cd[0].trace;if(!c.cumulative.enabled){var f="h"===c.orientation?"y":"x";a[f+"Label"]=e(a[f+"a"],[g.ph0,g.ph1],c[f+"hoverformat"])}return b}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("../bar/layout_attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("./cross_trace_defaults"),supplyLayoutDefaults:a("../bar/layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("../bar/cross_trace_calc").crossTraceCalc,plot:a("../bar/plot").plot,layerName:"barlayer",style:a("../bar/style").style,styleOnSelect:a("../bar/style").styleOnSelect,colorbar:a("../scatter/marker_colorbar"),hoverPoints:a("./hover"),selectPoints:a("../bar/select"),eventData:a("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(b,a,c){"use strict";a.exports={percent:function(b,c){for(var d=b.length,e=100/c,a=0;a<d;a++)b[a]*=e},probability:function(b,c){for(var d=b.length,a=0;a<d;a++)b[a]/=c},density:function(c,f,d,b){var e=c.length;b=b||1;for(var a=0;a<e;a++)c[a]*=d[a]*b},"probability density":function(b,c,e,d){var f=b.length;d&&(c/=d);for(var a=0;a<f;a++)b[a]*=e[a]/c}}},{}],834:[function(b,g,l){"use strict";var a=b("../histogram/attributes"),f=b("../histogram/bin_attributes"),d=b("../heatmap/attributes"),h=b("../../plots/attributes"),e=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,i=b("../../plots/template_attributes").hovertemplateAttrs,j=b("../../plots/template_attributes").texttemplateAttrs,k=b("../../components/colorscale/attributes"),c=b("../../lib/extend").extendFlat;g.exports=c({x:a.x,y:a.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:f("x"),nbinsy:a.nbinsy,ybins:f("y"),autobinx:a.autobinx,autobiny:a.autobiny,bingroup:c({},a.bingroup,{}),xbingroup:c({},a.bingroup,{}),ybingroup:c({},a.bingroup,{}),xgap:d.xgap,ygap:d.ygap,zsmooth:d.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:i({},{keys:"z"}),texttemplate:j({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:d.textfont,showlegend:c({},h.showlegend,{dflt:!1})},k("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../histogram/bin_functions"),g=a("../histogram/norm_functions"),h=a("../histogram/average"),i=a("../histogram/bin_label_vals"),j=a("../histogram/calc").calcAllAutoBins;function k(b,d,e,f){var a,c=new Array(b);if(f)for(a=0;a<b;a++)c[a]=1/(d[a+1]-d[a]);else{var g=1/e;for(a=0;a<b;a++)c[a]=g}return c}function l(b,a){return{start:b(a.start),end:b(a.end),size:a.size}}function m(b,g,h,j,k,l){var a,d=b.length-1,e=new Array(d),f=i(h,j,b,k,l);for(a=0;a<d;a++){var c=(g||[])[a];e[a]=void 0===c?[f(b[a]),f(b[a+1],!0)]:[c,c]}return e}b.exports=function(C,c){var a,D,i,b,K=e.getFromId(C,c.xaxis),L=e.getFromId(C,c.yaxis),M=c.xcalendar,N=c.ycalendar,O=function(a){return K.r2c(a,0,M)},P=function(a){return L.r2c(a,0,N)},an=function(a){return K.c2r(a,0,M)},ao=function(a){return L.c2r(a,0,N)},ab=j(C,c,K,"x"),r=ab[0],s=ab[1],ac=j(C,c,L,"y"),t=ac[0],u=ac[1],n=c._length;s.length>n&&s.splice(n,s.length-n),u.length>n&&u.splice(n,u.length-n);var o=[],E=[],ad=[],Q="string"==typeof r.size,R="string"==typeof t.size,p=[],q=[],F=Q?p:r,G=R?q:t,S=0,T=[],U=[],ae=c.histnorm,v=c.histfunc,ap=-1!==ae.indexOf("density"),aq="max"===v||"min"===v?null:0,af=f.count,ag=g[ae],H=!1,ah=[],ai=[],aj="z"in c?c.z:"marker"in c&&Array.isArray(c.marker.color)?c.marker.color:"";aj&&"count"!==v&&(H="avg"===v,af=f[v]);var ak=r.size,w=O(r.start),ar=O(r.end)+(w-e.tickIncrement(w,ak,!1,M))/1e6;for(a=w;a<ar;a=e.tickIncrement(a,ak,!1,M))E.push(aq),p.push(a),H&&ad.push(0);p.push(a);var x=E.length,V=(a-w)/x,as=an(w+V/2),al=t.size,y=P(t.start),at=P(t.end)+(y-e.tickIncrement(y,al,!1,N))/1e6;for(a=y;a<at;a=e.tickIncrement(a,al,!1,N)){o.push(E.slice()),q.push(a);var am=new Array(x);for(D=0;D<x;D++)am[D]=[];U.push(am),H&&T.push(ad.slice())}q.push(a);var z=o.length,W=(a-y)/z,au=ao(y+W/2);ap&&(ah=k(E.length,F,V,Q),ai=k(o.length,G,W,R)),Q||"date"!==K.type||(F=l(O,F)),R||"date"!==L.type||(G=l(P,G));var X=!0,Y=!0,I=new Array(x),J=new Array(z),Z=1/0,$=1/0,_=1/0,aa=1/0;for(a=0;a<n;a++){var A=s[a],B=u[a];i=d.findBin(A,F),b=d.findBin(B,G),i>=0&&i<x&&b>=0&&b<z&&(S+=af(i,a,o[b],aj,T[b]),U[b][i].push(a),X&&(void 0===I[i]?I[i]=A:I[i]!==A&&(X=!1)),Y&&(void 0===J[b]?J[b]=B:J[b]!==B&&(Y=!1)),Z=Math.min(Z,A-p[i]),$=Math.min($,p[i+1]-A),_=Math.min(_,B-q[b]),aa=Math.min(aa,q[b+1]-B))}if(H)for(b=0;b<z;b++)S+=h(o[b],T[b]);if(ag)for(b=0;b<z;b++)ag(o[b],S,ah,ai[b]);return{x:s,xRanges:m(p,X&&I,Z,$,K,M),x0:as,dx:V,y:u,yRanges:m(q,Y&&J,_,aa,L,N),y0:au,dy:W,z:o,pts:U}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./sample_defaults"),f=a("../heatmap/style_defaults"),g=a("../../components/colorscale/defaults"),h=a("../heatmap/label_defaults"),i=a("./attributes");b.exports=function(j,b,k,c){function a(a,c){return d.coerce(j,b,i,a,c)}e(j,b,a,c),!1!==b.visible&&(f(j,b,a,c),g(j,b,c,a,{prefix:"",cLetter:"z"}),a("hovertemplate"),h(a,c),a("xhoverformat"),a("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(a,b,c){"use strict";var d=a("../heatmap/hover"),e=a("../../plots/cartesian/axes").hoverLabelText;b.exports=function(a,j,k,l,m){var b=d(a,j,k,l,m);if(b){var f=(a=b[0]).index,n=f[0],o=f[1],c=a.cd[0],g=c.trace,h=c.xRanges[o],i=c.yRanges[n];return a.xLabel=e(a.xa,[h[0],h[1]],g.xhoverformat),a.yLabel=e(a.ya,[i[0],i[1]],g.yhoverformat),b}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../histogram/cross_trace_defaults"),calc:a("../heatmap/calc"),plot:a("../heatmap/plot"),layerName:"heatmaplayer",colorbar:a("../heatmap/colorbar"),style:a("../heatmap/style"),hoverPoints:a("./hover"),eventData:a("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports=function(g,b,a,h){var i=a("x"),j=a("y"),c=e.minRowLength(i),f=e.minRowLength(j);if(!c||!f){b.visible=!1;return}b._length=Math.min(c,f),d.getComponentMethod("calendars","handleTraceDefaults")(g,b,["x","y"],h),(a("z")||a("marker.color"))&&a("histfunc"),a("histnorm"),a("autobinx"),a("autobiny")}},{"../../lib":515,"../../registry":647}],840:[function(c,f,h){"use strict";var a=c("../histogram2d/attributes"),b=c("../contour/attributes"),g=c("../../components/colorscale/attributes"),d=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=c("../../lib/extend").extendFlat;f.exports=e({x:a.x,y:a.y,z:a.z,marker:a.marker,histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:a.xbins,nbinsy:a.nbinsy,ybins:a.ybins,autobinx:a.autobinx,autobiny:a.autobiny,bingroup:a.bingroup,xbingroup:a.xbingroup,ybingroup:a.ybingroup,autocontour:b.autocontour,ncontours:b.ncontours,contours:b.contours,line:{color:b.line.color,width:e({},b.line.width,{dflt:.5}),dash:b.line.dash,smoothing:b.line.smoothing,editType:"plot"},xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z",1),hovertemplate:a.hovertemplate,texttemplate:b.texttemplate,textfont:b.textfont},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../histogram2d/sample_defaults"),f=a("../contour/contours_defaults"),g=a("../contour/style_defaults"),h=a("../heatmap/label_defaults"),i=a("./attributes");b.exports=function(c,b,k,j){function a(a,e){return d.coerce(c,b,i,a,e)}e(c,b,a,j),!1!==b.visible&&(f(c,b,a,function(a){return d.coerce2(c,b,i,a)}),g(c,b,a,j),a("xhoverformat"),a("yhoverformat"),a("hovertemplate"),b.contours&&"heatmap"===b.contours.coloring&&h(a,j))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../histogram/cross_trace_defaults"),calc:a("../contour/calc"),plot:a("../contour/plot").plot,layerName:"contourlayer",style:a("../contour/style"),colorbar:a("../contour/colorbar"),hoverPoints:a("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(b,f,l){"use strict";var g=b("../../plots/template_attributes").hovertemplateAttrs,h=b("../../plots/template_attributes").texttemplateAttrs,i=b("../../components/colorscale/attributes"),j=b("../../plots/domain").attributes,c=b("../pie/attributes"),a=b("../sunburst/attributes"),d=b("../treemap/attributes"),e=b("../treemap/constants"),k=b("../../lib/extend").extendFlat;f.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:d.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:k({colors:a.marker.colors,line:a.marker.line,editType:"calc"},i("marker",{colorAttr:"colors",anim:!1})),leaf:a.leaf,pathbar:d.pathbar,text:c.text,textinfo:a.textinfo,texttemplate:h({editType:"plot"},{keys:e.eventDataKeys.concat(["label","value"])}),hovertext:c.hovertext,hoverinfo:a.hoverinfo,hovertemplate:g({},{keys:e.eventDataKeys}),textfont:c.textfont,insidetextfont:c.insidetextfont,outsidetextfont:d.outsidetextfont,textposition:d.textposition,sort:c.sort,root:a.root,domain:j({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(b,c,a){"use strict";var d=b("../../plots/plots");a.name="icicle",a.plot=function(b,c,e,f){d.plotBasePlot(a.name,b,c,e,f)},a.clean=function(b,c,e,f){d.cleanBasePlot(a.name,b,c,e,f)}},{"../../plots/plots":628}],845:[function(b,c,a){"use strict";var d=b("../sunburst/calc");a.calc=function(a,b){return d.calc(a,b)},a.crossTraceCalc=function(a){return d._runCrossTraceCalc("icicle",a)}},{"../sunburst/calc":1060}],846:[function(a,c,d){"use strict";var e=a("../../lib"),f=a("./attributes"),g=a("../../components/color"),h=a("../../plots/domain").defaults,i=a("../bar/defaults").handleText,j=a("../bar/constants").TEXTPAD,b=a("../../components/colorscale"),k=b.hasColorscale,l=b.handleDefaults;c.exports=function(d,b,s,c){function a(a,c){return e.coerce(d,b,f,a,c)}var m=a("labels"),n=a("parents");if(!m||!m.length||!n||!n.length){b.visible=!1;return}var o=a("values");a(o&&o.length?"branchvalues":"count"),a("level"),a("maxdepth"),a("tiling.orientation"),a("tiling.flip"),a("tiling.pad");var r=a("text");a("texttemplate"),b.texttemplate||a("textinfo",Array.isArray(r)?"text+label":"label"),a("hovertext"),a("hovertemplate");var p=a("pathbar.visible");i(d,b,c,a,"auto",{hasPathbar:p,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("textposition"),a("marker.line.width")&&a("marker.line.color",c.paper_bgcolor),a("marker.colors");var q=b._hasColorscale=k(d,"marker","colors")||(d.marker||{}).coloraxis;q&&l(d,b,c,a,{prefix:"marker.",cLetter:"c"}),a("leaf.opacity",q?1:.7),b._hovered={marker:{line:{width:2,color:g.contrast(c.paper_bgcolor)}}},p&&(a("pathbar.thickness",b.pathbar.textfont.size+2*j),a("pathbar.side"),a("pathbar.edgeshape")),a("sort"),a("root.color"),h(b,c,a),b._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../lib/svg_text_utils"),h=a("./partition"),i=a("./style").styleOne,j=a("../treemap/constants"),k=a("../sunburst/helpers"),l=a("../sunburst/fx"),m=a("../sunburst/plot").formatSliceLabel;b.exports=function(o,v,w,c,a){var p=a.width,q=a.height,B=a.viewX,C=a.viewY,x=a.pathSlice,D=a.toMoveInsideSlice,E=a.strTransform,r=a.hasTransition,y=a.handleSlicesExit,F=a.makeUpdateSliceInterpolator,G=a.makeUpdateTextInterpolator,s=a.prevEntry,H=o._context.staticPlot,I=o._fullLayout,b=v[0].trace,J=-1!==b.textposition.indexOf("left"),K=-1!==b.textposition.indexOf("right"),L=-1!==b.textposition.indexOf("bottom"),t=h(w,[p,q],{flipX:b.tiling.flip.indexOf("x")> -1,flipY:b.tiling.flip.indexOf("y")> -1,orientation:b.tiling.orientation,pad:{inner:b.tiling.pad},maxDepth:b._maxDepth}).descendants(),z=1/0,u=-1/0;t.forEach(function(a){var c=a.depth;c>=b._maxDepth?(a.x0=a.x1=(a.x0+a.x1)/2,a.y0=a.y1=(a.y0+a.y1)/2):(z=Math.min(z,c),u=Math.max(u,c))}),c=c.data(t,k.getPtId),b._maxVisibleLayers=isFinite(u)?u-z+1:0,c.enter().append("g").classed("slice",!0),y(c,!1,{},[p,q],x),c.order();var A=null;if(r&&s){var M=k.getPtId(s);c.each(function(a){null===A&&k.getPtId(a)===M&&(A={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1})})}var N=function(){return A||{x0:0,x1:p,y0:0,y1:q}},n=c;return r&&(n=n.transition().each("end",function(){var a=d.select(this);k.setSliceCursor(a,o,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),n.each(function(a){a._x0=B(a.x0),a._x1=B(a.x1),a._y0=C(a.y0),a._y1=C(a.y1),a._hoverX=B(a.x1-b.tiling.pad),a._hoverY=L?C(a.y1-b.tiling.pad/2):C(a.y0+b.tiling.pad/2);var h=d.select(this),n=e.ensureSingle(h,"path","surface",function(a){a.style("pointer-events",H?"none":"all")});r?n.transition().attrTween("d",function(a){var c=F(a,!1,N(),[p,q],{orientation:b.tiling.orientation,flipX:b.tiling.flip.indexOf("x")> -1,flipY:b.tiling.flip.indexOf("y")> -1});return function(a){return x(c(a))}}):n.attr("d",x),h.call(l,w,o,v,{styleOne:i,eventDataKeys:j.eventDataKeys,transitionTime:j.CLICK_TRANSITION_TIME,transitionEasing:j.CLICK_TRANSITION_EASING}).call(k.setSliceCursor,o,{isTransitioning:o._transitioning}),n.call(i,a,b,{hovered:!1}),a.x0===a.x1||a.y0===a.y1?a._text="":a._text=m(a,w,b,v,I)||"";var t=e.ensureSingle(h,"g","slicetext"),c=e.ensureSingle(t,"text","",function(a){a.attr("data-notex",1)}),s=e.ensureUniformFontSize(o,k.determineTextFont(b,a,I.font));c.text(a._text||" ").classed("slicetext",!0).attr("text-anchor",K?"end":J?"start":"middle").call(f.font,s).call(g.convertToTspans,o),a.textBB=f.bBox(c.node()),a.transform=D(a,{fontSize:s.size}),a.transform.fontSize=s.size,r?c.transition().attrTween("transform",function(a){var b=G(a,!1,N(),[p,q]);return function(a){return E(b(a))}}):c.attr("transform",E(a))}),A}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"icicle",basePlotModule:a("./base_plot"),categories:[],animatable:!0,attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),style:a("./style").style,colorbar:a("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(b,a,c){"use strict";a.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(c,b){function a(a,f){return d.coerce(c,b,e,a,f)}a("iciclecolorway",b.colorway),a("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(a,b,c){"use strict";var d=a("d3-hierarchy"),e=a("../treemap/flip_tree");b.exports=function(b,a,c){var h=c.flipX,i=c.flipY,f="h"===c.orientation,g=c.maxDepth,j=a[0],k=a[1];g&&(j=(b.height+1)*a[0]/Math.min(b.height+1,g),k=(b.height+1)*a[1]/Math.min(b.height+1,g));var l=d.partition().padding(c.pad.inner).size(f?[a[1],j]:[a[0],k])(b);return(f||h||i)&&e(l,a,{swapXY:f,flipX:h,flipY:i}),l}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(a,b,c){"use strict";var d=a("../treemap/draw"),e=a("./draw_descendants");b.exports=function(a,b,c,f){return d(a,b,c,f,{type:"icicle",drawDescendants:e})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../components/color"),g=a("../../lib"),h=a("../bar/uniform_text").resizeText;function c(e,b,a){var c=b.data.data,h=!b.children,d=c.i,i=g.castOption(a,d,"marker.line.color")||f.defaultLine,j=g.castOption(a,d,"marker.line.width")||0;e.style("stroke-width",j).call(f.fill,c.color).call(f.stroke,i).style("opacity",h?a.leaf.opacity:null)}b.exports={style:function(a){var b=a._fullLayout._iciclelayer.selectAll(".trace");h(a,b,"icicle"),b.each(function(b){var a=e.select(this),d=b[0].trace;a.style("opacity",d.opacity),a.selectAll("path.surface").each(function(a){e.select(this).call(c,a,d)})})},styleOne:c}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(c,f,l){"use strict";for(var g=c("../../plots/attributes"),h=c("../../plots/template_attributes").hovertemplateAttrs,e=c("../../lib/extend").extendFlat,i=c("./constants").colormodel,a=["rgb","rgba","rgba256","hsl","hsla"],j=[],k=[],b=0;b<a.length;b++){var d=i[a[b]];j.push("For the `"+a[b]+"` colormodel, it is ["+(d.zminDflt||d.min).join(", ")+"]."),k.push("For the `"+a[b]+"` colormodel, it is ["+(d.zmaxDflt||d.max).join(", ")+"].")}f.exports=e({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:a,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:e({},g.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:h({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./constants"),f=a("fast-isnumeric"),g=a("../../plots/cartesian/axes"),h=a("../../lib").maxRowLength,i=a("./helpers").getImageSize;function j(a,b,c,e){return function(f){return d.constrain((f-a)*b,c,e)}}function k(a,b){return function(c){return d.constrain(c,a,b)}}b.exports=function(p,a){if(a._hasZ)l=a.z.length,m=h(a.z);else if(a._hasSource){var l,m,b,q=i(a.source);l=q.height,m=q.width}var c=g.getFromId(p,a.xaxis||"x"),d=g.getFromId(p,a.yaxis||"y"),n=c.d2c(a.x0)-a.dx/2,o=d.d2c(a.y0)-a.dy/2,r=[n,n+m*a.dx],s=[o,o+l*a.dy];if(c&&"log"===c.type)for(b=0;b<m;b++)r.push(n+b*a.dx);if(d&&"log"===d.type)for(b=0;b<l;b++)s.push(o+b*a.dy);return a._extremes[c._id]=g.findExtremes(c,r),a._extremes[d._id]=g.findExtremes(d,s),a._scaler=function(b){var c=e.colormodel[b.colormodel],d=(c.colormodel||b.colormodel).length;b._sArray=[];for(var a=0;a<d;a++)c.min[a]!==b.zmin[a]||c.max[a]!==b.zmax[a]?b._sArray.push(j(b.zmin[a],(c.max[a]-c.min[a])/(b.zmax[a]-b.zmin[a]),c.min[a],c.max[a])):b._sArray.push(k(c.min[a],c.max[a]));return function(g){for(var c=g.slice(0,d),a=0;a<d;a++){var e=c[a];if(!f(e))return!1;c[a]=b._sArray[a](e)}return c}}(a),[{x0:n,y0:o,z:a.z,w:m,h:l}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(b,a,c){"use strict";a.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(a){return a.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(a){return a.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(a){return a.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(b){var a=b.slice(0,3);return a[1]=a[1]+"%",a[2]=a[2]+"%",a},suffix:["\xb0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(b){var a=b.slice(0,4);return a[1]=a[1]+"%",a[2]=a[2]+"%",a},suffix:["\xb0","%","%",""]}},pixelatedStyle:"image-rendering: optimizeSpeed; image-rendering: -moz-crisp-edges; image-rendering: -o-crisp-edges; image-rendering: -webkit-optimize-contrast; image-rendering: optimize-contrast; image-rendering: crisp-edges; image-rendering: pixelated; "}},{}],857:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("./constants"),g=a("../../snapshot/helpers").IMAGE_URL_PREFIX;b.exports=function(i,a){function b(b,c){return d.coerce(i,a,e,b,c)}b("source"),a.source&&!a.source.match(g)&&delete a.source,a._hasSource=!!a.source;var c,h=b("z");if(a._hasZ=!(void 0===h||!h.length||!h[0]||!h[0].length),!a._hasZ&&!a._hasSource){a.visible=!1;return}b("x0"),b("y0"),b("dx"),b("dy"),a._hasZ?(b("colormodel","rgb"),b("zmin",(c=f.colormodel[a.colormodel]).zminDflt||c.min),b("zmax",c.zmaxDflt||c.max)):a._hasSource&&(a.colormodel="rgba256",c=f.colormodel[a.colormodel],a.zmin=c.zminDflt,a.zmax=c.zmaxDflt),b("zsmooth"),b("text"),b("hovertext"),b("hovertemplate"),a._length=null}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(b,a,c){"use strict";a.exports=function(b,a){return"xVal"in a&&(b.x=a.xVal),"yVal"in a&&(b.y=a.yVal),a.xa&&(b.xaxis=a.xa),a.ya&&(b.yaxis=a.ya),b.color=a.color,b.colormodel=a.trace.colormodel,b.z||(b.z=a.color),b}},{}],859:[function(a,c,b){"use strict";var d=a("probe-image-size/sync"),e=a("../../snapshot/helpers").IMAGE_URL_PREFIX,f=a("buffer/").Buffer;b.getImageSize=function(a){var b=a.replace(e,"");return d(new f(b,"base64"))}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../lib"),f=a("./constants");b.exports=function(k,m,n){var l,q,o,b=k.cd[0],a=b.trace,r=k.xa,z=k.ya;if(!(d.inbox(m-b.x0,m-(b.x0+b.w*a.dx),0)>0||d.inbox(n-b.y0,n-(b.y0+b.h*a.dy),0)>0)){var h=Math.floor((m-b.x0)/a.dx),c=Math.floor(Math.abs(n-b.y0)/a.dy);if(a._hasZ?l=b.z[c][h]:a._hasSource&&(l=a._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(h,c,1,1).data),l){var s=b.hi||a.hoverinfo;if(s){var p=s.split("+");-1!==p.indexOf("all")&&(p=["color"]),-1!==p.indexOf("color")&&(q=!0)}var t=f.colormodel[a.colormodel],u=t.colormodel||a.colormodel,A=u.length,g=a._scaler(l),i=t.suffix,j=[];(a.hovertemplate||q)&&(j.push("["+[g[0]+i[0],g[1]+i[1],g[2]+i[2]].join(", ")),4===A&&j.push(", "+g[3]+i[3]),j.push("]"),j=j.join(""),k.extraText=u.toUpperCase()+": "+j),Array.isArray(a.hovertext)&&Array.isArray(a.hovertext[c])?o=a.hovertext[c][h]:Array.isArray(a.text)&&Array.isArray(a.text[c])&&(o=a.text[c][h]);var v=z.c2p(b.y0+(c+.5)*a.dy),w=b.x0+(h+.5)*a.dx,x=b.y0+(c+.5)*a.dy,y="["+l.slice(0,a.colormodel.length).join(", ")+"]";return[e.extendFlat(k,{index:[c,h],x0:r.c2p(b.x0+h*a.dx),x1:r.c2p(b.x0+(h+1)*a.dx),y0:v,y1:v,color:g,xVal:w,xLabelVal:w,yVal:x,yLabelVal:x,zLabelVal:y,text:o,hovertemplateLabels:{zLabel:y,colorLabel:j,"color[0]Label":g[0]+i[0],"color[1]Label":g[1]+i[1],"color[2]Label":g[2]+i[2],"color[3]Label":g[3]+i[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),style:a("./style"),hoverPoints:a("./hover"),eventData:a("./event_data"),moduleType:"trace",name:"image",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(a,c,d){"use strict";var e=a("@plotly/d3"),b=a("../../lib"),f=b.strTranslate,g=a("../../constants/xmlns_namespaces"),h=a("./constants"),i=b.isIOS()||b.isSafari()||b.isIE();c.exports=function(c,a,d,j){var k=a.xaxis,l=a.yaxis,m=!(i||c._context._exportedPlot);b.makeTraceGroups(j,d,"im").each(function(u){var d,j,q,i,n,a,v=e.select(this),p=u[0],o=p.trace,s=("fast"===o.zsmooth|| !1===o.zsmooth&&m)&&!o._hasZ&&o._hasSource&&"linear"===k.type&&"linear"===l.type;o._realImage=s;var M=p.z,w=p.x0,x=p.y0,y=p.w,z=p.h,A=o.dx,B=o.dy;for(a=0;void 0===d&&a<y;)d=k.c2p(w+a*A),a++;for(a=y;void 0===j&&a>0;)j=k.c2p(w+a*A),a--;for(a=0;void 0===i&&a<z;)i=l.c2p(x+a*B),a++;for(a=z;void 0===n&&a>0;)n=l.c2p(x+a*B),a--;if(j<d&&(q=j,j=d,d=q),n<i&&(q=i,i=n,n=q),!s){var r=.5;d=Math.max(-r*k._length,d),j=Math.min((1+r)*k._length,j),i=Math.max(-r*l._length,i),n=Math.min((1+r)*l._length,n)}var C=Math.round(j-d),D=Math.round(n-i);if(C<=0||D<=0){v.selectAll("image").data([]).exit().remove();return}function N(q){var r,e=document.createElement("canvas");e.width=C,e.height=D;var j=e.getContext("2d",{willReadFrequently:!0}),s=function(a){return b.constrain(Math.round(k.c2p(w+a*A)-d),0,C)},t=function(a){return b.constrain(Math.round(l.c2p(x+a*B)-i),0,D)},u=h.colormodel[o.colormodel],v=u.colormodel||o.colormodel,y=u.fmt;for(a=0;a<p.w;a++){var f=s(a),m=s(a+1);if(!(m===f||isNaN(m)||isNaN(f)))for(var c=0;c<p.h;c++){var g=t(c),n=t(c+1);!(n===g||isNaN(n)||isNaN(g))&&q(a,c)&&((r=o._scaler(q(a,c)))?j.fillStyle=v+"("+y(r).join(",")+")":j.fillStyle="rgba(0,0,0,0)",j.fillRect(f,g,m-f,n-g))}}return e}var t=v.selectAll("image").data([u]);t.enter().append("svg:image").attr({xmlns:g.svg,preserveAspectRatio:"none"}),t.exit().remove();var E=!1===o.zsmooth?h.pixelatedStyle:"";if(s){var F=b.simpleMap(k.range,k.r2l),G=b.simpleMap(l.range,l.r2l),H=F[1]<F[0],I=G[1]>G[0];if(H||I){var J=d+C/2,K=i+D/2;E+="transform:"+f(J+"px",K+"px")+"scale("+(H?-1:1)+","+(I?-1:1)+")"+f(-J+"px",-K+"px")+";"}}t.attr("style",E);var L=new Promise(function(b){if(o._hasZ)b();else if(o._hasSource)if(o._canvas&&o._canvas.el.width===y&&o._canvas.el.height===z&&o._canvas.source===o.source)b();else{var a=document.createElement("canvas");a.width=y,a.height=z;var d=a.getContext("2d",{willReadFrequently:!0});o._image=o._image||new Image;var c=o._image;c.onload=function(){d.drawImage(c,0,0),o._canvas={el:a,source:o.source},b()},c.setAttribute("src",o.source)}}).then(function(){var a;if(o._hasZ)a=N(function(a,b){return M[b][a]}).toDataURL("image/png");else if(o._hasSource)if(s)a=o.source;else{var b=o._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,y,z).data;a=N(function(c,d){var a=4*(d*y+c);return[b[a],b[a+1],b[a+2],b[a+3]]}).toDataURL("image/png")}t.attr({"xlink:href":a,height:D,width:C,x:d,y:i})});c._promises.push(L)})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(a,b,c){"use strict";var d=a("@plotly/d3");b.exports=function(a){d.select(a).selectAll(".im image").style("opacity",function(a){return a[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(b,l,q){"use strict";var c=b("../../lib/extend").extendFlat,g=b("../../lib/extend").extendDeep,m=b("../../plot_api/edit_types").overrideAll,h=b("../../plots/font_attributes"),i=b("../../components/color/attributes"),n=b("../../plots/domain").attributes,a=b("../../plots/cartesian/layout_attributes"),o=b("../../plot_api/plot_template").templatedArray,e=b("../../constants/delta.js"),j=b("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,f=h({editType:"plot",colorEditType:"plot"}),d={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:i.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},k={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},p=o("step",g({},d,{range:k}));l.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:n({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:c({},f,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:j("value")},font:c({},f,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:j("value")},increasing:{symbol:{valType:"string",dflt:e.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:e.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:e.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:e.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:c({},f,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:g({},d,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:m({range:k,visible:c({},a.visible,{dflt:!0}),tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:c({},a.ticks,{dflt:"outside"}),ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,ticklabelstep:a.ticklabelstep,showticklabels:a.showticklabels,tickfont:h({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,minexponent:a.minexponent,showexponent:a.showexponent,editType:"plot"},"plot"),steps:p,threshold:{line:{color:c({},d.line.color,{}),width:c({},d.line.width,{dflt:1}),editType:"plot"},thickness:c({},d.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(b,c,a){"use strict";var d=b("../../plots/plots");a.name="indicator",a.plot=function(b,c,e,f){d.plotBasePlot(a.name,b,c,e,f)},a.clean=function(b,c,e,f){d.cleanBasePlot(a.name,b,c,e,f)}},{"../../plots/plots":628}],866:[function(b,a,c){"use strict";a.exports={calc:function(f,a){var d=[],c=a.value;"number"!=typeof a._lastValue&&(a._lastValue=a.value);var e=a._lastValue,b=e;return a._hasDelta&&"number"==typeof a.delta.reference&&(b=a.delta.reference),d[0]={y:c,lastY:e,delta:c-b,relativeDelta:(c-b)/b},d}}},{}],867:[function(b,a,c){"use strict";a.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults,g=a("../../plot_api/plot_template"),h=a("../../plots/array_container_defaults"),i=a("./constants.js"),j=a("../../plots/cartesian/tick_value_defaults"),k=a("../../plots/cartesian/tick_mark_defaults"),l=a("../../plots/cartesian/tick_label_defaults"),m=a("../../plots/cartesian/prefix_suffix_defaults");function n(b,c){function a(a,f){return d.coerce(b,c,e.gauge.steps,a,f)}a("color"),a("line.color"),a("line.width"),a("range"),a("thickness")}b.exports={supplyDefaults:function(z,a,A,o){function b(b,c){return d.coerce(z,a,e,b,c)}f(a,o,b),b("mode"),a._hasNumber=-1!==a.mode.indexOf("number"),a._hasDelta=-1!==a.mode.indexOf("delta"),a._hasGauge=-1!==a.mode.indexOf("gauge");var u,x,r,v,p,s,y=b("value");a._range=[0,"number"==typeof y?1.5*y:1];var t=new Array(2);function c(a,b){return d.coerce(r,v,e.gauge,a,b)}function q(a,b){return d.coerce(p,s,e.gauge.axis,a,b)}if(a._hasNumber&&(b("number.valueformat"),b("number.font.color",o.font.color),b("number.font.family",o.font.family),b("number.font.size"),void 0===a.number.font.size&&(a.number.font.size=i.defaultNumberFontSize,t[0]=!0),b("number.prefix"),b("number.suffix"),u=a.number.font.size),a._hasDelta&&(b("delta.font.color",o.font.color),b("delta.font.family",o.font.family),b("delta.font.size"),void 0===a.delta.font.size&&(a.delta.font.size=(a._hasNumber?.5:1)*(u||i.defaultNumberFontSize),t[1]=!0),b("delta.reference",a.value),b("delta.relative"),b("delta.valueformat",a.delta.relative?"2%":""),b("delta.increasing.symbol"),b("delta.increasing.color"),b("delta.decreasing.symbol"),b("delta.decreasing.color"),b("delta.position"),b("delta.prefix"),b("delta.suffix"),x=a.delta.font.size),a._scaleNumbers=(!a._hasNumber||t[0])&&(!a._hasDelta||t[1])||!1,b("title.font.color",o.font.color),b("title.font.family",o.font.family),b("title.font.size",.25*(u||x||i.defaultNumberFontSize)),b("title.text"),a._hasGauge){(r=z.gauge)||(r={}),v=g.newContainer(a,"gauge"),c("shape"),(a._isBullet="bullet"===a.gauge.shape)||b("title.align","center"),(a._isAngular="angular"===a.gauge.shape)||b("align","center"),c("bgcolor",o.paper_bgcolor),c("borderwidth"),c("bordercolor"),c("bar.color"),c("bar.line.color"),c("bar.line.width"),c("bar.thickness",i.valueThickness*("bullet"===a.gauge.shape?.5:1)),h(r,v,{name:"steps",handleItemDefaults:n}),c("threshold.value"),c("threshold.thickness"),c("threshold.line.width"),c("threshold.line.color"),p={},r&&(p=r.axis||{}),s=g.newContainer(v,"axis"),q("visible"),a._range=q("range",a._range);var w={outerTicks:!0};j(p,s,q,"linear"),m(p,s,q,"linear",w),l(p,s,q,"linear",w),k(p,s,q,w)}else b("title.align","center"),b("align","center"),a._isAngular=a._isBullet=!1;a._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"indicator",basePlotModule:a("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,calc:a("./calc").calc,plot:a("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(a,c,d){"use strict";var e=a("@plotly/d3"),f=a("d3-interpolate").interpolate,g=a("d3-interpolate").interpolateNumber,b=a("../../lib"),h=b.strScale,i=b.strTranslate,j=b.rad2deg,k=a("../../constants/alignment").MID_SHIFT,l=a("../../components/drawing"),m=a("./constants"),n=a("../../lib/svg_text_utils"),o=a("../../plots/cartesian/axes"),p=a("../../plots/cartesian/axis_defaults"),q=a("../../plots/cartesian/position_defaults"),r=a("../../plots/cartesian/layout_attributes"),s=a("../../components/color"),t={left:"start",center:"middle",right:"end"},u={left:0,center:.5,right:1},v=/[yzafpnmkMGTPEZY]/;function w(a){return a&&a.duration>0}function x(a){a.each(function(a){s.stroke(e.select(this),a.line.color)}).each(function(a){s.fill(e.select(this),a.color)}).style("stroke-width",function(a){return a.line.width})}function y(h,c,i){var d=h._fullLayout,e=b.extendFlat({type:"linear",ticks:"outside",range:i,showline:!0},c),a={type:"linear",_id:"x"+c._id},f={letter:"x",font:d.font,noHover:!0,noTickson:!0};function g(c,d){return b.coerce(e,a,r,c,d)}return p(e,a,g,f,d),q(e,a,g,f),a}function z(a,b,c){return[Math.min(b/a.width,c/a.height),a,b+"x"+c]}function A(a,c,d,f){var g=document.createElementNS("http://www.w3.org/2000/svg","text"),b=e.select(g);return b.text(a).attr("x",0).attr("y",0).attr("text-anchor",d).attr("data-unformatted",a).call(n.convertToTspans,f).call(l.font,c),l.bBox(b.node())}function B(a,f,g,h,d,i){var c="_cache"+f;a[c]&&a[c].key===d||(a[c]={key:d,value:g});var e=b.aggNums(i,null,[a[c].value,h],2);return a[c].value=e,e}c.exports=function(c,d,p,a){var q,r=c._fullLayout;w(p)&&a&&(q=a()),b.makeTraceGroups(r._indicatorlayer,d,"trace").each(function(C){var F,K,G,L,M,a=C[0].trace,D=e.select(this),O=a._hasGauge,H=a._isAngular,I=a._isBullet,E=a.domain,d={w:r._size.w*(E.x[1]-E.x[0]),h:r._size.h*(E.y[1]-E.y[0]),l:r._size.l+r._size.w*E.x[0],r:r._size.r+r._size.w*(1-E.x[1]),t:r._size.t+r._size.h*(1-E.y[1]),b:r._size.b+r._size.h*E.y[0]},W=d.l+d.w/2,P=d.t+d.h/2,N=Math.min(d.w/2,d.h),X=m.innerRadius*N,Q=a.align||"center";if(K=P,O){if(H&&(F=W,K=P+N/2,G=function(c){var a,b;return a=c,[(b=.9*X)/Math.sqrt(a.width/2*(a.width/2)+a.height*a.height),a,b]}),I){var Y=m.bulletPadding,R=1-m.bulletNumberDomainSize+Y;F=d.l+(R+(1-R)*u[Q])*d.w,G=function(a){return z(a,(m.bulletNumberDomainSize-Y)*d.w,d.h)}}}else F=d.l+u[Q]*d.w,G=function(a){return z(a,d.w,d.h)};(function(I,E,F,m){var a=F[0].trace,J=m.numbersX,K=m.numbersY,G=a.align||"center",L=t[G],M=m.transitionOpts,N=m.onComplete,z=b.ensureSingle(E,"g","numbers"),p=[];a._hasNumber&&p.push("number"),a._hasDelta&&(p.push("delta"),"left"===a.delta.position&&p.reverse());var x=z.selectAll("text").data(p);function O(b,a,c,d){if(!b.match("s")||c>=0==d>=0||a(c).slice(-1).match(v)||a(d).slice(-1).match(v))return a;var e=y(I,{tickformat:b.slice().replace("s","f").replace(/\d+/,function(a){return parseInt(a)-1})});return function(b){return 1>Math.abs(b)?o.tickText(e,b).text:a(b)}}x.enter().append("text"),x.attr("text-anchor",function(){return L}).attr("class",function(a){return a}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),x.exit().remove();var k=a.mode+a.align;if(a._hasDelta&&(H=function(){var c=y(I,{tickformat:a.delta.valueformat},a._range);c.setScale(),o.prepTicks(c);var h=function(a){return o.tickText(c,a).text},m=a.delta.suffix,p=a.delta.prefix,f=function(b){var c;return a.delta.relative?b.relativeDelta:b.delta},i=function(b,c){return 0===b||"number"!=typeof b||isNaN(b)?"-":(b>0?a.delta.increasing.symbol:a.delta.decreasing.symbol)+p+c(b)+m},j=function(b){return b.delta>=0?a.delta.increasing.color:a.delta.decreasing.color};void 0===a._deltaLastValue&&(a._deltaLastValue=f(F[0]));var b=z.select("text.delta");function k(){b.text(i(f(F[0]),h)).call(s.fill,j(F[0])).call(n.convertToTspans,I)}return b.call(l.font,a.delta.font).call(s.fill,j({delta:a._deltaLastValue})),w(M)?b.transition().duration(M.duration).ease(M.easing).tween("text",function(){var d=e.select(this),b=f(F[0]),c=a._deltaLastValue,k=O(a.delta.valueformat,h,c,b),l=g(c,b);return a._deltaLastValue=b,function(a){d.text(i(l(a),k)),d.call(s.fill,j({delta:l(a)}))}}).each("end",function(){k(),N&&N()}).each("interrupt",function(){k(),N&&N()}):k(),d=A(i(f(F[0]),h),a.delta.font,L,I),b}(),k+=a.delta.position+a.delta.font.size+a.delta.font.family+a.delta.valueformat,k+=a.delta.increasing.symbol+a.delta.decreasing.symbol,q=d),a._hasNumber&&(function(){var b=y(I,{tickformat:a.number.valueformat},a._range);b.setScale(),o.prepTicks(b);var d=function(a){return o.tickText(b,a).text},f=a.number.suffix,h=a.number.prefix,i=z.select("text.number");function j(){var b="number"==typeof F[0].y?h+d(F[0].y)+f:"-";i.text(b).call(l.font,a.number.font).call(n.convertToTspans,I)}w(M)?i.transition().duration(M.duration).ease(M.easing).each("end",function(){j(),N&&N()}).each("interrupt",function(){j(),N&&N()}).attrTween("text",function(){var b=e.select(this),c=g(F[0].lastY,F[0].y);a._lastValue=F[0].y;var i=O(a.number.valueformat,d,F[0].lastY,F[0].y);return function(a){b.text(h+i(c(a))+f)}}):j(),c=A(h+d(F[0].y)+f,a.number.font,L,I)}(),k+=a.number.font.size+a.number.font.family+a.number.valueformat+a.number.suffix+a.number.prefix,q=c),a._hasDelta&&a._hasNumber){var c,d,q,H,j,f,C=[(c.left+c.right)/2,(c.top+c.bottom)/2],D=[(d.left+d.right)/2,(d.top+d.bottom)/2],r=.75*a.delta.font.size;"left"===a.delta.position&&(j=B(a,"deltaPos",0,-1*(c.width*u[a.align]+d.width*(1-u[a.align])+r),k,Math.min),f=C[1]-D[1],q={width:c.width+d.width+r,height:Math.max(c.height,d.height),left:d.left+j,right:c.right,top:Math.min(c.top,d.top+f),bottom:Math.max(c.bottom,d.bottom+f)}),"right"===a.delta.position&&(j=B(a,"deltaPos",0,c.width*(1-u[a.align])+d.width*u[a.align]+r,k,Math.max),f=C[1]-D[1],q={width:c.width+d.width+r,height:Math.max(c.height,d.height),left:c.left,right:d.right+j,top:Math.min(c.top,d.top+f),bottom:Math.max(c.bottom,d.bottom+f)}),"bottom"===a.delta.position&&(j=null,f=d.height,q={width:Math.max(c.width,d.width),height:c.height+d.height,left:Math.min(c.left,d.left),right:Math.max(c.right,d.right),top:c.bottom-c.height,bottom:c.bottom+d.height}),"top"===a.delta.position&&(j=null,f=c.top,q={width:Math.max(c.width,d.width),height:c.height+d.height,left:Math.min(c.left,d.left),right:Math.max(c.right,d.right),top:c.bottom-c.height-d.height,bottom:c.bottom}),H.attr({dx:j,dy:f})}(a._hasNumber||a._hasDelta)&&z.attr("transform",function(){var c,d=m.numbersScaler(q);k+=d[2];var b=B(a,"numbersScale",1,d[0],k,Math.min);a._scaleNumbers||(b=1),c=a._isAngular?K-b*q.bottom:K-b*(q.top+q.bottom)/2,a._numbersTop=b*q.top+c;var e=q[G];"center"===G&&(e=(q.left+q.right)/2);var f=J-b*e;return i(f=B(a,"numbersTranslate",0,f,k,Math.max),c)+h(b)})})(c,D,C,{numbersX:F,numbersY:K,numbersScaler:G,transitionOpts:p,onComplete:q}),O&&(L={range:a.gauge.axis.range,color:a.gauge.bgcolor,line:{color:a.gauge.bordercolor,width:0},thickness:1},M={range:a.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:a.gauge.bordercolor,width:a.gauge.borderwidth},thickness:1});var S=D.selectAll("g.angular").data(H?C:[]);S.exit().remove();var T=D.selectAll("g.angularaxis").data(H?C:[]);T.exit().remove(),H&&function(r,Q,d,c){var a,s,E,l,b=d[0].trace,m=c.size,H=c.radius,R=c.innerRadius,I=c.gaugeBg,J=c.gaugeOutline,F=[m.l+m.w/2,m.t+m.h/2+H/2],g=c.gauge,n=c.layer,t=c.transitionOpts,S=c.onComplete,T=Math.PI/2;function u(d){var c=b.gauge.axis.range[0],a=(d-c)/(b.gauge.axis.range[1]-c)*Math.PI-T;return a< -T?-T:a>T?T:a}function K(a){return e.svg.arc().innerRadius((R+H)/2-a/2*(H-R)).outerRadius((R+H)/2+a/2*(H-R)).startAngle(-T)}function v(a){a.attr("d",function(a){return K(a.thickness).startAngle(u(a.range[0])).endAngle(u(a.range[1]))()})}g.enter().append("g").classed("angular",!0),g.attr("transform",i(F[0],F[1])),n.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),n.selectAll("g.xangularaxistick,path,text").remove(),(a=y(r,b.gauge.axis)).type="linear",a.range=b.gauge.axis.range,a._id="xangularaxis",a.ticklabeloverflow="allow",a.setScale();var U=function(b){return(a.range[0]-b.x)/(a.range[1]-a.range[0])*Math.PI+Math.PI},h={},V=o.makeLabelFns(a,0).labelStandoff;h.xFn=function(a){return Math.cos(U(a))*V},h.yFn=function(a){var b=U(a),c=Math.sin(b)>0?.2:1;return-Math.sin(b)*(V+a.fontSize*c)+Math.abs(Math.cos(b))*(a.fontSize*k)},h.anchorFn=function(b){var a=Math.cos(U(b));return .1>Math.abs(a)?"middle":a>0?"start":"end"},h.heightFn=function(a,c,b){return -0.5*(1+Math.sin(U(a)))*b};var W=function(a){return i(F[0]+H*Math.cos(a),F[1]-H*Math.sin(a))};E=function(a){return W(U(a))};var L=function(b){var a=U(b);return W(a)+"rotate("+ -j(a)+")"};if(s=o.calcTicks(a),l=o.getTickSigns(a)[2],a.visible){l="inside"===a.ticks?-1:1;var M=(a.linewidth||1)/2;o.drawTicks(r,a,{vals:s,layer:n,path:"M"+l*M+",0h"+l*a.ticklen,transFn:L}),o.drawLabels(r,a,{vals:s,layer:n,transFn:E,labelFns:h})}var p=[I].concat(b.gauge.steps),z=g.selectAll("g.bg-arc").data(p);z.enter().append("g").classed("bg-arc",!0).append("path"),z.select("path").call(v).call(x),z.exit().remove();var G=K(b.gauge.bar.thickness),A=g.selectAll("g.value-arc").data([b.gauge.bar]);A.enter().append("g").classed("value-arc",!0).append("path");var N,O,P,B=A.select("path");w(t)?(B.transition().duration(t.duration).ease(t.easing).each("end",function(){S&&S()}).each("interrupt",function(){S&&S()}).attrTween("d",(N=G,O=u(d[0].lastY),P=u(d[0].y),function(){var a=f(O,P);return function(b){return N.endAngle(a(b))()}})),b._lastValue=d[0].y):B.attr("d","number"==typeof d[0].y?G.endAngle(u(d[0].y)):"M0,0Z"),B.call(x),A.exit().remove(),p=[];var q=b.gauge.threshold.value;(q||0===q)&&p.push({range:[q,q],color:b.gauge.threshold.color,line:{color:b.gauge.threshold.line.color,width:b.gauge.threshold.line.width},thickness:b.gauge.threshold.thickness});var C=g.selectAll("g.threshold-arc").data(p);C.enter().append("g").classed("threshold-arc",!0).append("path"),C.select("path").call(v).call(x),C.exit().remove();var D=g.selectAll("g.gauge-outline").data([J]);D.enter().append("g").classed("gauge-outline",!0).append("path"),D.select("path").call(v).call(x),D.exit().remove()}(c,D,C,{radius:N,innerRadius:X,gauge:S,layer:T,size:d,gaugeBg:L,gaugeOutline:M,transitionOpts:p,onComplete:q});var U=D.selectAll("g.bullet").data(I?C:[]);U.exit().remove();var V=D.selectAll("g.bulletaxis").data(I?C:[]);V.exit().remove(),I&&function(n,I,e,c){var a,h,p,z,q,b=e[0].trace,d=c.gauge,j=c.layer,C=c.gaugeBg,D=c.gaugeOutline,f=c.size,k=b.domain,r=c.transitionOpts,J=c.onComplete;d.enter().append("g").classed("bullet",!0),d.attr("transform",i(f.l,f.t)),j.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),j.selectAll("g.xbulletaxistick,path,text").remove();var l=f.h,A=b.gauge.bar.thickness*l,E=k.x[0],F=k.x[0]+(k.x[1]-k.x[0])*(b._hasNumber||b._hasDelta?1-m.bulletNumberDomainSize:1);function B(b){b.attr("width",function(b){return Math.max(0,a.c2p(b.range[1])-a.c2p(b.range[0]))}).attr("x",function(b){return a.c2p(b.range[0])}).attr("y",function(a){return .5*(1-a.thickness)*l}).attr("height",function(a){return a.thickness*l})}(a=y(n,b.gauge.axis))._id="xbulletaxis",a.domain=[E,F],a.setScale(),h=o.calcTicks(a),p=o.makeTransTickFn(a),z=o.getTickSigns(a)[2],q=f.t+f.h,a.visible&&(o.drawTicks(n,a,{vals:"inside"===a.ticks?o.clipEnds(a,h):h,layer:j,path:o.makeTickPath(a,q,z),transFn:p}),o.drawLabels(n,a,{vals:h,layer:j,transFn:p,labelFns:o.makeLabelFns(a,q)}));var G=[C].concat(b.gauge.steps),t=d.selectAll("g.bg-bullet").data(G);t.enter().append("g").classed("bg-bullet",!0).append("rect"),t.select("rect").call(B).call(x),t.exit().remove();var g=d.selectAll("g.value-bullet").data([b.gauge.bar]);g.enter().append("g").classed("value-bullet",!0).append("rect"),g.select("rect").attr("height",A).attr("y",(l-A)/2).call(x),w(r)?g.select("rect").transition().duration(r.duration).ease(r.easing).each("end",function(){J&&J()}).each("interrupt",function(){J&&J()}).attr("width",Math.max(0,a.c2p(Math.min(b.gauge.axis.range[1],e[0].y)))):g.select("rect").attr("width","number"==typeof e[0].y?Math.max(0,a.c2p(Math.min(b.gauge.axis.range[1],e[0].y))):0),g.exit().remove();var H=e.filter(function(){return b.gauge.threshold.value||0===b.gauge.threshold.value}),u=d.selectAll("g.threshold-bullet").data(H);u.enter().append("g").classed("threshold-bullet",!0).append("line"),u.select("line").attr("x1",a.c2p(b.gauge.threshold.value)).attr("x2",a.c2p(b.gauge.threshold.value)).attr("y1",(1-b.gauge.threshold.thickness)/2*l).attr("y2",(1-(1-b.gauge.threshold.thickness)/2)*l).call(s.stroke,b.gauge.threshold.line.color).style("stroke-width",b.gauge.threshold.line.width),u.exit().remove();var v=d.selectAll("g.gauge-outline").data([D]);v.enter().append("g").classed("gauge-outline",!0).append("rect"),v.select("rect").call(B).call(x),v.exit().remove()}(c,D,C,{gauge:U,layer:V,size:d,gaugeBg:L,gaugeOutline:M,transitionOpts:p,onComplete:q});var J=D.selectAll("text.title").data(C);J.exit().remove(),J.enter().append("text").classed("title",!0),J.attr("text-anchor",function(){return I?t.right:t[a.title.align]}).text(a.title.text).call(l.font,a.title.font).call(n.convertToTspans,c),J.attr("transform",function(){var c,f=d.l+d.w*u[a.title.align],e=m.titlePadding,b=l.bBox(J.node());return O?(H&&(c=a.gauge.axis.visible?l.bBox(T.node()).top-e-b.bottom:d.t+d.h/2-N/2-b.bottom-e),I&&(c=K-(b.top+b.bottom)/2,f=d.l-m.bulletPadding*d.w)):c=a._numbersTop-e-b.bottom,i(f,c)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(a,i,m){"use strict";var j=a("../../components/colorscale/attributes"),d=a("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=a("../../plots/template_attributes").hovertemplateAttrs,c=a("../mesh3d/attributes"),h=a("../../plots/attributes"),e=a("../../lib/extend").extendFlat,l=a("../../plot_api/edit_types").overrideAll;function f(a){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function g(a){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var b=i.exports=l(e({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:f("x"),y:f("y"),z:f("z")},caps:{x:g("x"),y:g("y"),z:g("z")},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:k(),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),valuehoverformat:d("value",1),showlegend:e({},h.showlegend,{dflt:!1})},j("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:c.opacity,lightposition:c.lightposition,lighting:c.lighting,flatshading:c.flatshading,contour:c.contour,hoverinfo:e({},h.hoverinfo)}),"calc","nested");b.flatshading.dflt=!0,b.lighting.facenormalsepsilon.dflt=0,b.x.editType=b.y.editType=b.z.editType=b.value.editType="calc+clearAxisTypes",b.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc"),e=a("../streamtube/calc").processGrid,f=a("../streamtube/calc").filter;b.exports=function(j,a){a._len=Math.min(a.x.length,a.y.length,a.z.length,a.value.length),a._x=f(a.x,a._len),a._y=f(a.y,a._len),a._z=f(a.z,a._len),a._value=f(a.value,a._len);var b=e(a);a._gridFill=b.fill,a._Xs=b.Xs,a._Ys=b.Ys,a._Zs=b.Zs,a._len=b.len;for(var c=1/0,g=-1/0,h=0;h<a._len;h++){var i=a._value[h];c=Math.min(c,i),g=Math.max(g,i)}a._minValues=c,a._maxValues=g,a._vMin=void 0===a.isomin||null===a.isomin?c:a.isomin,a._vMax=void 0===a.isomax||null===a.isomin?g:a.isomax,d(j,a,{vals:[a._vMin,a._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(a,c,g){"use strict";var h=a("../../../stackgl_modules").gl_mesh3d,i=a("../../lib/gl_format_color").parseColorScale,j=a("../../lib/str2rgbarray"),k=a("../../components/colorscale").extractOpts,l=a("../../plots/gl3d/zip3"),d=function(d,b){for(var a=b.length-1;a>0;a--){var e=Math.min(b[a],b[a-1]),c=Math.max(b[a],b[a-1]);if(c>e&&e<d&&d<=c)return{id:a,distRatio:(c-d)/(c-e)}}return{id:0,distRatio:0}};function e(a,b,c){this.scene=a,this.uid=c,this.mesh=b,this.name="",this.data=null,this.showContour=!1}var b=e.prototype;b.handlePick=function(a){if(a.object===this.mesh){var e=a.data.index,g=this.data._meshX[e],h=this.data._meshY[e],i=this.data._meshZ[e],j=this.data._Ys.length,f=this.data._Zs.length,k=d(g,this.data._Xs).id,l=d(h,this.data._Ys).id,m=d(i,this.data._Zs).id,b=a.index=m+f*l+f*j*k;a.traceCoordinate=[this.data._meshX[b],this.data._meshY[b],this.data._meshZ[b],this.data._value[b]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&& void 0!==c[b]?a.textLabel=c[b]:c&&(a.textLabel=c),!0}},b.update=function(a){var b=this.scene,d=b.fullSceneLayout;function e(b,a,c,d){return a.map(function(a){return b.d2l(a,0,d)*c})}this.data=f(a);var h=l(e(d.xaxis,a._meshX,b.dataScale[0],a.xcalendar),e(d.yaxis,a._meshY,b.dataScale[1],a.ycalendar),e(d.zaxis,a._meshZ,b.dataScale[2],a.zcalendar)),m=l(a._meshI,a._meshJ,a._meshK),c={positions:h,cells:m,lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:j(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading},g=k(a);c.vertexIntensity=a._meshIntensity,c.vertexIntensityBounds=[g.min,g.max],c.colormap=i(a),this.mesh.update(c)},b.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var m=["xyz","xzy","yxz","yzx","zxy","zyx"];function f(a){a._meshI=[],a._meshJ=[],a._meshK=[];var f,g,h,i,j,k,l,n=a.surface.show,o=a.spaceframe.show,p=a.surface.fill,q=a.spaceframe.fill,r=!1,s=!1,t=0,b=a._Xs,c=a._Ys,e=a._Zs,u=b.length,v=c.length,w=e.length,x=m.indexOf(a._gridFill.replace(/-/g,"").replace(/\+/g,"")),y=function(a,b,c){switch(x){case 5:return c+w*b+w*v*a;case 4:return c+w*a+w*u*b;case 3:return b+v*c+v*w*a;case 2:return b+v*a+v*u*c;case 1:return a+u*c+u*w*b;default:return a+u*b+u*v*c}},z=a._minValues,A=a._maxValues,B=a._vMin,C=a._vMax;function D(b,c,d){for(var e=k.length,a=g;a<e;a++)if(b===h[a]&&c===i[a]&&d===j[a])return a;return -1}function E(){g=f}function F(){h=[],i=[],j=[],k=[],f=0,E()}function G(a,b,c,d){return h.push(a),i.push(b),j.push(c),k.push(d),f++,f-1}function H(b,c,d){return a._meshI.push(b),a._meshJ.push(c),a._meshK.push(d),t++,t-1}function I(b,e,c){for(var d=[],a=0;a<b.length;a++)d[a]=b[a]*(1-c)+c*e[a];return d}function J(a){l=a}function K(a,b){return"all"===a||null===a||a.indexOf(b)> -1}function L(a,b){return null===a?b:a}function M(A,b,c){E();var h=[b],u=[c];if(l>=1)h=[b],u=[c];else if(l>0){var i,j,d,e,f,k,m,n,o,p,q,r,s,v=(i=b,j=c,d=i[0],e=i[1],f=i[2],k=function(b,d,e){for(var c=[],a=0;a<b.length;a++)c[a]=(b[a]+d[a]+e[a])/3;return c}(d,e,f),m=Math.sqrt(1-l),n=I(k,d,m),o=I(k,e,m),p=I(k,f,m),q=j[0],r=j[1],s=j[2],{xyzv:[[d,e,o],[o,n,d],[e,f,p],[p,o,e],[f,d,n],[n,p,f]],abc:[[q,r,-1],[-1,-1,q],[r,s,-1],[-1,-1,r],[s,q,-1],[-1,-1,s]]});h=v.xyzv,u=v.abc}for(var t=0;t<h.length;t++){b=h[t],c=u[t];for(var g=[],a=0;a<3;a++){var w=b[a][0],x=b[a][1],y=b[a][2],B=b[a][3],z=c[a]> -1?c[a]:D(w,x,y);z> -1?g[a]=z:g[a]=G(w,x,y,L(A,B))}H(g[0],g[1],g[2])}}function N(c,d,e,f){var a=c[3];a<e&&(a=e),a>f&&(a=f);for(var g=(c[3]-a)/(c[3]-d[3]+1e-9),h=[],b=0;b<4;b++)h[b]=(1-g)*c[b]+g*d[b];return h}function O(a,b,c){return a>=b&&a<=c}function P(a){var b=.001*(C-B);return a>=B-b&&a<=C+b}function Q(e){for(var d=[],c=0;c<4;c++){var b=e[c];d.push([a._x[b],a._y[b],a._z[b],a._value[b]])}return d}function R(h,b,e,c,d,f){f||(f=1),e=[-1,-1,-1];var g=!1,a=[O(b[0][3],c,d),O(b[1][3],c,d),O(b[2][3],c,d)];if(!a[0]&&!a[1]&&!a[2])return!1;var i=function(b,a,c){return P(a[0][3])&&P(a[1][3])&&P(a[2][3])?(M(b,a,c),!0):f<3&&R(b,a,c,B,C,++f)};if(a[0]&&a[1]&&a[2])return i(h,b,e)||g;var j=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(f){if(a[f[0]]&&a[f[1]]&&!a[f[2]]){var k=b[f[0]],l=b[f[1]],m=b[f[2]],o=N(m,k,c,d),n=N(m,l,c,d);g=i(h,[n,o,k],[-1,-1,e[f[0]]])||g,g=i(h,[k,l,n],[e[f[0]],e[f[1]],-1])||g,j=!0}}),j||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(f){if(a[f[0]]&&!a[f[1]]&&!a[f[2]]){var k=b[f[0]],l=b[f[1]],m=b[f[2]],n=N(l,k,c,d),o=N(m,k,c,d);g=i(h,[o,n,k],[-1,-1,e[f[0]]])||g,j=!0}}),g}function S(i,g,d,e){var j,k,l,f,b=!1,c=Q(g),a=[O(c[0][3],d,e),O(c[1][3],d,e),O(c[2][3],d,e),O(c[3][3],d,e)];if(!a[0]&&!a[1]&&!a[2]&&!a[3])return b;if(a[0]&&a[1]&&a[2]&&a[3])return s&&(b=(j=i,k=c,l=g,(f=function(a,b,c){M(j,[k[a],k[b],k[c]],[l[a],l[b],l[c]])})(0,1,2),f(3,0,1),f(2,3,0),f(1,2,3),b)),b;var h=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(f){if(a[f[0]]&&a[f[1]]&&a[f[2]]&&!a[f[3]]){var k=c[f[0]],l=c[f[1]],m=c[f[2]],j=c[f[3]];if(s)b=M(i,[k,l,m],[g[f[0]],g[f[1]],g[f[2]]])||b;else{var n=N(j,k,d,e),o=N(j,l,d,e),p=N(j,m,d,e);b=M(null,[n,o,p],[-1,-1,-1])||b}h=!0}}),h||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(f){if(a[f[0]]&&a[f[1]]&&!a[f[2]]&&!a[f[3]]){var t,u,l,j=c[f[0]],k=c[f[1]],m=c[f[2]],n=c[f[3]],o=N(m,j,d,e),p=N(m,k,d,e),q=N(n,k,d,e),r=N(n,j,d,e);s?(b=M(i,[j,r,o],[g[f[0]],-1,-1])||b,b=M(i,[k,p,q],[g[f[1]],-1,-1])||b):b=(t=[o,p,q,r],u=[-1,-1,-1,-1],(l=function(a,b,c){M(null,[t[a],t[b],t[c]],[u[a],u[b],u[c]])})(0,1,2),l(2,3,0),b),h=!0}}),h||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(f){if(a[f[0]]&&!a[f[1]]&&!a[f[2]]&&!a[f[3]]){var j=c[f[0]],n=c[f[1]],o=c[f[2]],p=c[f[3]],k=N(n,j,d,e),l=N(o,j,d,e),m=N(p,j,d,e);s?(b=M(i,[j,k,l],[g[f[0]],-1,-1])||b,b=M(i,[j,l,m],[g[f[0]],-1,-1])||b,b=M(i,[j,m,k],[g[f[0]],-1,-1])||b):b=M(null,[k,l,m],[-1,-1,-1])||b,h=!0}})),b}function T(b,i,e,f,j,g,k,l,h,c,d){var a=!1;return r&&(K(b,"A")&&(a=S(null,[i,e,f,g],c,d)||a),K(b,"B")&&(a=S(null,[e,f,j,h],c,d)||a),K(b,"C")&&(a=S(null,[e,g,k,h],c,d)||a),K(b,"D")&&(a=S(null,[f,g,l,h],c,d)||a),K(b,"E")&&(a=S(null,[e,f,g,h],c,d)||a)),s&&(a=S(b,[e,f,g,h],c,d)||a),a}function U(c,a,d,b,e,f,g,h){return[!0===h[0]||R(c,Q([a,d,b]),[a,d,b],f,g),!0===h[1]||R(c,Q([b,e,a]),[b,e,a],f,g)]}function V(a,b,c,d,e,f,g,i,h){return i?U(a,b,c,e,d,f,g,h):U(a,c,e,d,b,f,g,h)}function W(n,a,b,c,o,p,g){var h,i,j,k,m=!1,l=function(){m=R(n,[h,i,j],[-1,-1,-1],o,p)||m,m=R(n,[j,k,h],[-1,-1,-1],o,p)||m},d=g[0],e=g[1],f=g[2];return d&&(h=I(Q([y(a,b-0,c-0)])[0],Q([y(a-1,b-0,c-0)])[0],d),i=I(Q([y(a,b-0,c-1)])[0],Q([y(a-1,b-0,c-1)])[0],d),j=I(Q([y(a,b-1,c-1)])[0],Q([y(a-1,b-1,c-1)])[0],d),k=I(Q([y(a,b-1,c-0)])[0],Q([y(a-1,b-1,c-0)])[0],d),l()),e&&(h=I(Q([y(a-0,b,c-0)])[0],Q([y(a-0,b-1,c-0)])[0],e),i=I(Q([y(a-0,b,c-1)])[0],Q([y(a-0,b-1,c-1)])[0],e),j=I(Q([y(a-1,b,c-1)])[0],Q([y(a-1,b-1,c-1)])[0],e),k=I(Q([y(a-1,b,c-0)])[0],Q([y(a-1,b-1,c-0)])[0],e),l()),f&&(h=I(Q([y(a-0,b-0,c)])[0],Q([y(a-0,b-0,c-1)])[0],f),i=I(Q([y(a-0,b-1,c)])[0],Q([y(a-0,b-1,c-1)])[0],f),j=I(Q([y(a-1,b-1,c)])[0],Q([y(a-1,b-1,c-1)])[0],f),k=I(Q([y(a-1,b-0,c)])[0],Q([y(a-1,b-0,c-1)])[0],f),l()),m}function X(b,c,d,e,f,g,h,i,j,k,l,m){var a=b;return m?(r&&"even"===b&&(a=null),T(a,c,d,e,f,g,h,i,j,k,l)):(r&&"odd"===b&&(a=null),T(a,j,i,h,g,f,e,d,c,k,l))}function Y(i,g,j,k,d){for(var h=[],e=0,f=0;f<g.length;f++)for(var c=g[f],a=1;a<w;a++)for(var b=1;b<v;b++)h.push(V(i,y(c,b-1,a-1),y(c,b-1,a),y(c,b,a-1),y(c,b,a),j,k,(c+b+a)%2,d&&d[e]?d[e]:[])),e++;return h}function Z(i,g,j,k,d){for(var h=[],e=0,f=0;f<g.length;f++)for(var c=g[f],a=1;a<u;a++)for(var b=1;b<w;b++)h.push(V(i,y(a-1,c,b-1),y(a,c,b-1),y(a-1,c,b),y(a,c,b),j,k,(a+c+b)%2,d&&d[e]?d[e]:[])),e++;return h}function $(i,g,j,k,d){for(var h=[],e=0,f=0;f<g.length;f++)for(var c=g[f],a=1;a<v;a++)for(var b=1;b<u;b++)h.push(V(i,y(b-1,a-1,c),y(b-1,a,c),y(b,a-1,c),y(b,a,c),j,k,(b+a+c)%2,d&&d[e]?d[e]:[])),e++;return h}function _(d,e,f){for(var a=1;a<w;a++)for(var b=1;b<v;b++)for(var c=1;c<u;c++)X(d,y(c-1,b-1,a-1),y(c-1,b-1,a),y(c-1,b,a-1),y(c-1,b,a),y(c,b-1,a-1),y(c,b-1,a),y(c,b,a-1),y(c,b,a),e,f,(c+b+a)%2)}function aa(a,b,c){r=!0,_(a,b,c),r=!1}function ab(h,f,i,j,k,b){for(var g=[],c=0,a=0;a<f.length;a++)for(var l=f[a],d=1;d<w;d++)for(var e=1;e<v;e++)g.push(W(h,l,e,d,i,j,k[a],b&&b[c]?b[c]:[])),c++;return g}function ac(h,f,i,j,k,b){for(var g=[],c=0,a=0;a<f.length;a++)for(var l=f[a],d=1;d<u;d++)for(var e=1;e<w;e++)g.push(W(h,d,l,e,i,j,k[a],b&&b[c]?b[c]:[])),c++;return g}function ad(h,f,i,j,k,b){for(var g=[],c=0,a=0;a<f.length;a++)for(var l=f[a],d=1;d<v;d++)for(var e=1;e<u;e++)g.push(W(h,e,d,l,i,j,k[a],b&&b[c]?b[c]:[])),c++;return g}function ae(c,d){for(var b=[],a=c;a<d;a++)b.push(a);return b}return!function(){if(F(),function(){for(var c=0;c<u;c++)for(var d=0;d<v;d++)for(var e=0;e<w;e++){var b=y(c,d,e);G(a._x[b],a._y[b],a._z[b],a._value[b])}}(),o&&q&&(J(q),s=!0,_(null,B,C),s=!1),n&&p){J(p);for(var x=a.surface.pattern,g=a.surface.count,l=0;l<g;l++){var m=1===g?.5:l/(g-1),f=(1-m)*B+m*C,D=Math.abs(f-z),E=Math.abs(f-A),r=D>E?[z,f]:[f,A];aa(x,r[0],r[1])}}var H=[[Math.min(B,A),Math.max(B,A)],[Math.min(z,C),Math.max(z,C)]];["x","y","z"].forEach(function(h){for(var g=[],p=0;p<H.length;p++){var f=0,i=H[p][0],j=H[p][1],l=a.slices[h];if(l.show&&l.fill){J(l.fill);var m=[],o=[],n=[];if(l.locations.length)for(var q=0;q<l.locations.length;q++){var k=d(l.locations[q],"x"===h?b:"y"===h?c:e);0===k.distRatio?m.push(k.id):k.id>0&&(o.push(k.id),"x"===h?n.push([k.distRatio,0,0]):"y"===h?n.push([0,k.distRatio,0]):n.push([0,0,k.distRatio]))}else m="x"===h?ae(1,u-1):"y"===h?ae(1,v-1):ae(1,w-1);o.length>0&&("x"===h?g[f]=ab(null,o,i,j,n,g[f]):"y"===h?g[f]=ac(null,o,i,j,n,g[f]):g[f]=ad(null,o,i,j,n,g[f]),f++),m.length>0&&("x"===h?g[f]=Y(null,m,i,j,g[f]):"y"===h?g[f]=Z(null,m,i,j,g[f]):g[f]=$(null,m,i,j,g[f]),f++)}var r=a.caps[h];r.show&&r.fill&&(J(r.fill),"x"===h?g[f]=Y(null,[0,u-1],i,j,g[f]):"y"===h?g[f]=Z(null,[0,v-1],i,j,g[f]):g[f]=$(null,[0,w-1],i,j,g[f]),f++)}}),0===t&&F(),a._meshX=h,a._meshY=i,a._meshZ=j,a._meshIntensity=k,a._Xs=b,a._Ys=c,a._Zs=e}(),a}c.exports={findNearestOnAxis:d,generateIsoMeshes:f,createIsosurfaceTrace:function(a,d){var b=h({gl:a.glplot.gl}),c=new e(a,b,d.uid);return b._trace=c,c.update(d),a.glplot.add(b),c}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../../registry"),g=a("./attributes"),h=a("../../components/colorscale/defaults");function c(c,b,m,d,a){var e=a("isomin"),g=a("isomax");null!=g&&null!=e&&e>g&&(b.isomin=null,b.isomax=null);var i=a("x"),j=a("y"),k=a("z"),l=a("value");if(!i||!i.length||!j||!j.length||!k||!k.length||!l||!l.length){b.visible=!1;return}f.getComponentMethod("calendars","handleTraceDefaults")(c,b,["x","y","z"],d),a("valuehoverformat"),["x","y","z"].forEach(function(b){a(b+"hoverformat");var d="caps."+b;a(d+".show")&&a(d+".fill");var c="slices."+b;a(c+".show")&&(a(c+".fill"),a(c+".locations"))}),a("spaceframe.show")&&a("spaceframe.fill"),a("surface.show")&&(a("surface.count"),a("surface.fill"),a("surface.pattern")),a("contour.show")&&(a("contour.color"),a("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(b){a(b)}),h(c,b,d,a,{prefix:"",cLetter:"c"}),b._length=null}b.exports={supplyDefaults:function(a,b,d,f){c(a,b,d,f,function(c,d){return e.coerce(a,b,g,c,d)})},supplyIsoDefaults:c}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,calc:a("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:a("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(c,f,i){"use strict";var g=c("../../components/colorscale/attributes"),d=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=c("../../plots/template_attributes").hovertemplateAttrs,a=c("../surface/attributes"),e=c("../../plots/attributes"),b=c("../../lib/extend").extendFlat;f.exports=b({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:h({editType:"calc"}),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},g("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:a.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:b({},a.contours.x.show,{}),color:a.contours.x.color,width:a.contours.x.width,editType:"calc"},lightposition:{x:b({},a.lightposition.x,{dflt:1e5}),y:b({},a.lightposition.y,{dflt:1e5}),z:b({},a.lightposition.z,{dflt:0}),editType:"calc"},lighting:b({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},a.lighting),hoverinfo:b({},e.hoverinfo,{editType:"calc"}),showlegend:b({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(b,a){a.intensity&&d(b,a,{vals:a.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(a,c,e){"use strict";var f=a("../../../stackgl_modules").gl_mesh3d,g=a("../../../stackgl_modules").delaunay_triangulate,h=a("../../../stackgl_modules").alpha_shape,i=a("../../../stackgl_modules").convex_hull,j=a("../../lib/gl_format_color").parseColorScale,k=a("../../lib/str2rgbarray"),l=a("../../components/colorscale").extractOpts,m=a("../../plots/gl3d/zip3");function d(a,b,c){this.scene=a,this.uid=c,this.mesh=b,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var b=d.prototype;function n(b){for(var c=[],d=b.length,a=0;a<d;a++)c[a]=k(b[a]);return c}function o(d,b,e,f){for(var c=[],g=b.length,a=0;a<g;a++)c[a]=d.d2l(b[a],0,f)*e;return c}function p(b){for(var c=[],d=b.length,a=0;a<d;a++)c[a]=Math.round(b[a]);return c}function q(b,c){for(var d=b.length,a=0;a<d;a++)if(b[a]<= -0.5||b[a]>=c-.5)return!1;return!0}b.handlePick=function(a){if(a.object===this.mesh){var b=a.index=a.data.index;a.data._cellCenter?a.traceCoordinate=a.data.dataCoordinate:a.traceCoordinate=[this.data.x[b],this.data.y[b],this.data.z[b]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&& void 0!==c[b]?a.textLabel=c[b]:c&&(a.textLabel=c),!0}},b.update=function(a){var e,c=this.scene,f=c.fullSceneLayout;this.data=a;var r=a.x.length,d=m(o(f.xaxis,a.x,c.dataScale[0],a.xcalendar),o(f.yaxis,a.y,c.dataScale[1],a.ycalendar),o(f.zaxis,a.z,c.dataScale[2],a.zcalendar));if(a.i&&a.j&&a.k){if(a.i.length!==a.j.length||a.j.length!==a.k.length||!q(a.i,r)||!q(a.j,r)||!q(a.k,r))return;e=m(p(a.i),p(a.j),p(a.k))}else e=0===a.alphahull?i(d):a.alphahull>0?h(a.alphahull,d):function(e,b){for(var c=["x","y","z"].indexOf(e),d=[],f=b.length,a=0;a<f;a++)d[a]=[b[a][(c+1)%3],b[a][(c+2)%3]];return g(d)}(a.delaunayaxis,d);var b={positions:d,cells:e,lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:k(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading};if(a.intensity){var s=l(a);this.color="#fff";var t=a.intensitymode;b[t+"Intensity"]=a.intensity,b[t+"IntensityBounds"]=[s.min,s.max],b.colormap=j(a)}else a.vertexcolor?(this.color=a.vertexcolor[0],b.vertexColors=n(a.vertexcolor)):a.facecolor?(this.color=a.facecolor[0],b.cellColors=n(a.facecolor)):(this.color=a.color,b.meshColor=k(a.color));this.mesh.update(b)},b.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},c.exports=function(a,e){var b=f({gl:a.glplot.gl}),c=new d(a,b,e.uid);return b._trace=c,c.update(e),a.glplot.add(b),c}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../../components/colorscale/defaults"),g=a("./attributes");b.exports=function(c,a,j,h){function b(b,d){return e.coerce(c,a,g,b,d)}function i(c){var a=c.map(function(c){var a=b(c);return a&&e.isArrayOrTypedArray(a)?a:null});return a.every(function(b){return b&&b.length===a[0].length})&&a}if(!i(["x","y","z"])){a.visible=!1;return}if(i(["i","j","k"]),a.i&&(!a.j||!a.k)||a.j&&(!a.k||!a.i)||a.k&&(!a.i||!a.j)){a.visible=!1;return}d.getComponentMethod("calendars","handleTraceDefaults")(c,a,["x","y","z"],h),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(a){b(a)}),b("contour.show")&&(b("contour.color"),b("contour.width")),"intensity"in c?(b("intensity"),b("intensitymode"),f(c,a,h,b,{prefix:"",cLetter:"c"})):(a.showscale=!1,"facecolor"in c?b("facecolor"):"vertexcolor"in c?b("vertexcolor"):b("color",j)),b("text"),b("hovertext"),b("hovertemplate"),b("xhoverformat"),b("yhoverformat"),b("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:a("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(a,g,m){"use strict";var c=a("../../lib").extendFlat,b=a("../scatter/attributes"),d=a("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=a("../../components/drawing/attributes").dash,i=a("../../components/fx/attributes"),e=a("../../constants/delta.js"),j=e.INCREASING.COLOR,k=e.DECREASING.COLOR,l=b.line;function f(a){return{line:{color:c({},l.color,{dflt:a}),width:l.width,dash:h,editType:"style"},editType:"style"}}g.exports={xperiod:b.xperiod,xperiod0:b.xperiod0,xperiodalignment:b.xperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:c({},l.width,{}),dash:c({},h,{}),editType:"style"},increasing:f(j),decreasing:f(k),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:c({},i.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(a,b,e){"use strict";var c=a("../../lib"),f=c._,g=a("../../plots/cartesian/axes"),h=a("../../plots/cartesian/align_period"),i=a("../../constants/numerical").BADNUM;function j(a,b,c,d){return{o:a,h:b,l:c,c:d}}function d(l,d,u,r,h,v){for(var w=h.makeCalcdata(d,"open"),s=h.makeCalcdata(d,"high"),t=h.makeCalcdata(d,"low"),x=h.makeCalcdata(d,"close"),y=Array.isArray(d.text),z=Array.isArray(d.hovertext),n=!0,m=null,A=!!d.xperiodalignment,j=[],a=0;a<r.length;a++){var o=r[a],k=w[a],p=s[a],q=t[a],e=x[a];if(o!==i&&k!==i&&p!==i&&q!==i&&e!==i){e===k?null!==m&&e!==m&&(n=e>m):n=e>k,m=e;var b=v(k,p,q,e);b.pos=o,b.yc=(k+e)/2,b.i=a,b.dir=n?"increasing":"decreasing",b.x=b.pos,b.y=[q,p],A&&(b.orig_p=u[a]),y&&(b.tx=d.text[a]),z&&(b.htx=d.hovertext[a]),j.push(b)}else j.push({pos:o,empty:!0})}return d._extremes[h._id]=g.findExtremes(h,c.concat(t,s),{padded:!0}),j.length&&(j[0].t={labels:{open:f(l,"open:")+" ",high:f(l,"high:")+" ",low:f(l,"low:")+" ",close:f(l,"close:")+" "}}),j}b.exports={calc:function(b,a){var e=g.getFromId(b,a.xaxis),l=g.getFromId(b,a.yaxis),m=function(m,e,f){var a=f._minDiff;if(!a){var b,j=m._fullData,g=[];for(b=0,a=1/0;b<j.length;b++){var d=j[b];if("ohlc"===d.type&& !0===d.visible&&d.xaxis===e._id){g.push(d);var k=e.makeCalcdata(d,"x");d._origX=k;var l=h(f,e,"x",k).vals;d._xcalc=l;var i=c.distinctVals(l).minDiff;i&&isFinite(i)&&(a=Math.min(a,i))}}for(a===1/0&&(a=1),b=0;b<g.length;b++)g[b]._minDiff=a}return a*f.tickwidth}(b,e,a),i=a._minDiff;a._minDiff=null;var n=a._origX;a._origX=null;var k=a._xcalc;a._xcalc=null;var f=d(b,a,n,k,l,j);return(a._extremes[e._id]=g.findExtremes(e,k,{vpad:i/2}),f.length)?(c.extendFlat(f[0].t,{wHover:i/2,tickLen:m}),f):[{t:{empty:!0}}]},calcCommon:d}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./ohlc_defaults"),f=a("../scatter/period_defaults"),g=a("./attributes");function h(d,c,a,b){a(b+".line.color"),a(b+".line.width",c.line.width),a(b+".line.dash",c.line.dash)}b.exports=function(c,b,j,i){function a(a,e){return d.coerce(c,b,g,a,e)}if(!e(c,b,a,i)){b.visible=!1;return}f(c,b,i,a,{x:!0}),a("xhoverformat"),a("yhoverformat"),a("line.width"),a("line.dash"),h(c,b,a,"increasing"),h(c,b,a,"decreasing"),a("text"),a("hovertext"),a("tickwidth"),i._requestRangeslider[b.xaxis]=!0}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(a,c,f){"use strict";var g=a("../../plots/cartesian/axes"),h=a("../../lib"),i=a("../../components/fx"),j=a("../../components/color"),k=a("../../lib").fillText,b=a("../../constants/delta.js"),l={increasing:b.INCREASING.SYMBOL,decreasing:b.DECREASING.SYMBOL};function m(a,v,w,r){var h,k,d=a.cd,c=a.xa,l=d[0].trace,e=d[0].t,m=l.type,x="ohlc"===m?"l":"min",y="ohlc"===m?"h":"max",n=e.bPos||0,f=e.bdPos||e.tickLen,z=e.wHover,o=Math.min(1,f/Math.abs(c.r2c(c.range[1])-c.r2c(c.range[0])));function s(b){var a=b.pos+n-v;return i.inbox(a-z,a+z,h)}function t(a){var b=a[x],c=a[y];return b===c||i.inbox(b-w,c-w,h)}function p(a){return(s(a)+t(a))/2}h=a.maxHoverDistance-o,k=a.maxSpikeDistance-o;var u=i.getDistanceFunction(r,s,t,p);if(i.getClosest(d,u,a),!1===a.index)return null;var b=d[a.index];if(b.empty)return null;var g=l[b.dir],q=g.line.color;return j.opacity(q)&&g.line.width?a.color=q:a.color=g.fillcolor,a.x0=c.c2p(b.pos+n-f,!0),a.x1=c.c2p(b.pos+n+f,!0),a.xLabelVal=void 0!==b.orig_p?b.orig_p:b.pos,a.spikeDistance=p(b)*k/h,a.xSpike=c.c2p(b.pos,!0),a}function d(e,r,s,t){var f=e.cd,i=e.ya,c=f[0].trace,n=f[0].t,o=[],d=m(e,r,s,t);if(!d)return[];var p=f[d.index].hi||c.hoverinfo,u=p.split("+"),v="all"===p,w=v|| -1!==u.indexOf("y");if(!w)return[];for(var q=["high","open","close","low"],j={},k=0;k<q.length;k++){var a,l=q[k],b=c[l][d.index],x=i.c2p(b,!0);b in j?(a=j[b],a.yLabel+="<br>"+n.labels[l]+g.hoverLabelText(i,b,c.yhoverformat)):((a=h.extendFlat({},d)).y0=a.y1=x,a.yLabelVal=b,a.yLabel=n.labels[l]+g.hoverLabelText(i,b,c.yhoverformat),a.name="",o.push(a),j[b]=a)}return o}function e(d,o,p,q){var e=d.cd,r=d.ya,f=e[0].trace,v=e[0].t,a=m(d,o,p,q);if(!a)return[];var b=e[a.index],w=a.index=b.i,s=b.dir;function c(a){return v.labels[a]+g.hoverLabelText(r,f[a][w],f.yhoverformat)}var h=b.hi||f.hoverinfo,i=h.split("+"),j="all"===h,t=j|| -1!==i.indexOf("y"),u=j|| -1!==i.indexOf("text"),n=t?[c("open"),c("high"),c("low"),c("close")+"  "+l[s]]:[];return u&&k(b,f,n),a.extraText=n.join("<br>"),a.y0=a.y1=r.c2p(b.yc,!0),[a]}c.exports={hoverPoints:function(a,b,c,f){return a.cd[0].trace.hoverlabel.split?d(a,b,c,f):e(a,b,c,f)},hoverSplit:d,hoverOnPoints:e}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"ohlc",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc").calc,plot:a("./plot"),style:a("./style"),hoverPoints:a("./hover").hoverPoints,selectPoints:a("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib");b.exports=function(k,c,a,l){var f=a("x"),g=a("open"),h=a("high"),i=a("low"),j=a("close");if(a("hoverlabel.split"),d.getComponentMethod("calendars","handleTraceDefaults")(k,c,["x"],l),g&&h&&i&&j){var b=Math.min(g.length,h.length,i.length,j.length);return f&&(b=Math.min(b,e.minRowLength(f))),c._length=b,b}}},{"../../lib":515,"../../registry":647}],887:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib");b.exports=function(g,a,b,c){var h=a.yaxis,f=a.xaxis,i=!!f.rangebreaks;e.makeTraceGroups(c,b,"trace ohlc").each(function(j){var b=d.select(this),c=j[0],g=c.t;if(!0!==c.trace.visible||g.empty){b.remove();return}var k=g.tickLen,a=b.selectAll("path").data(e.identity);a.enter().append("path"),a.exit().remove(),a.attr("d",function(a){if(a.empty)return"M0,0Z";var c=f.c2p(a.pos-k,!0),d=f.c2p(a.pos+k,!0),b=i?(c+d)/2:f.c2p(a.pos,!0),e=h.c2p(a.o,!0),g=h.c2p(a.h,!0),j=h.c2p(a.l,!0),l=h.c2p(a.c,!0);return"M"+c+","+e+"H"+b+"M"+b+","+g+"V"+j+"M"+d+","+l+"H"+b})})}},{"../../lib":515,"@plotly/d3":58}],888:[function(b,a,c){"use strict";a.exports=function(d,e){var a,c=d.cd,f=d.xaxis,g=d.yaxis,h=[],i=c[0].t.bPos||0;if(!1===e)for(a=0;a<c.length;a++)c[a].selected=0;else for(a=0;a<c.length;a++){var b=c[a];e.contains([f.c2p(b.pos+i),g.c2p(b.yc)],null,b.i,d)?(h.push({pointNumber:b.i,x:f.c2d(b.pos),y:g.c2d(b.yc)}),b.selected=1):b.selected=0}return h}},{}],889:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../components/drawing"),f=a("../../components/color");b.exports=function(b,g,c){var a=c||d.select(b).selectAll("g.ohlclayer").selectAll("g.trace");a.style("opacity",function(a){return a[0].trace.opacity}),a.each(function(a){var b=a[0].trace;d.select(this).selectAll("path").each(function(a){if(!a.empty){var c=b[a.dir].line;d.select(this).style("fill","none").call(f.stroke,c.color).call(e.dashLine,c.dash,c.width).style("opacity",b.selectedpoints&&!a.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(a,e,j){"use strict";var b=a("../../lib/extend").extendFlat,f=a("../../plots/attributes"),c=a("../../plots/font_attributes"),g=a("../../components/colorscale/attributes"),d=a("../../plots/template_attributes").hovertemplateAttrs,h=a("../../plots/domain").attributes,i=b({editType:"calc"},g("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:d({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});e.exports={domain:h({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:b({},f.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:d({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:c({editType:"calc"}),tickfont:c({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:i,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(b,d,a){"use strict";var e=b("../../plots/get_data").getModuleCalcData,f=b("./plot"),c="parcats";a.name=c,a.plot=function(a,h,d,g){var b=e(a.calcdata,c);b.length&&f(a,b[0],d,g)},a.clean=function(e,b,f,a){var c=a._has&&a._has("parcats"),d=b._has&&b._has("parcats");c&&!d&&a._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(a,b,c){"use strict";var d=a("../../lib/gup").wrap,e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/calc"),g=a("../../lib/filter_unique.js"),h=a("../../components/drawing"),i=a("../../lib"),j=a("fast-isnumeric");function k(b,a,c,d){return{dimensionInd:b,categoryInd:a,categoryValue:c,displayInd:a,categoryLabel:d,valueInds:[],count:0,dragY:null}}function l(a,b,c){a.valueInds.push(b),a.count+=c}function m(a,b,c){return{categoryInds:a,color:b,rawColor:c,valueInds:[],count:0}}function n(a,b,c){a.valueInds.push(b),a.count+=c}b.exports=function(J,c){var u,A,B,C,q,r,v,D,a,b,o=i.filterVisible(c.dimensions);if(0===o.length)return[];var E=o.map(function(b){var a;if("trace"===b.categoryorder)a=null;else if("array"===b.categoryorder)a=b.categoryarray;else{a=g(b.values);for(var d=!0,c=0;c<a.length;c++)if(!j(a[c])){d=!1;break}a.sort(d?i.sorterAsc:void 0),"category descending"===b.categoryorder&&(a=a.reverse())}return function(f,a){a=null==a?[]:a.map(function(a){return a});var d={},g={},h=[];a.forEach(function(a,b){d[a]=0,g[a]=b});for(var e=0;e<f.length;e++){var c,b=f[e];void 0===d[b]?(d[b]=1,c=a.push(b)-1,g[b]=c):(d[b]++,c=g[b]),h.push(c)}var i=a.map(function(a){return d[a]});return{uniqueValues:a,uniqueCounts:i,inds:h}}(b.values,a)});q=i.isArrayOrTypedArray(c.counts)?c.counts:[c.counts],function(b){var a;if(function(a){for(var c=new Array(a.length),b=0;b<a.length;b++){if(a[b]<0||a[b]>=a.length)return!1;if(void 0!==c[a[b]])return!1;c[a[b]]=!0}return!0}(b.map(function(a){return a.displayindex})))for(a=0;a<b.length;a++)b[a]._displayindex=b[a].displayindex;else for(a=0;a<b.length;a++)b[a]._displayindex=a}(o),o.forEach(function(a,b){(function(a,b){a._categoryarray=b.uniqueValues,null===a.ticktext|| void 0===a.ticktext?a._ticktext=[]:a._ticktext=a.ticktext.slice();for(var c=a._ticktext.length;c<b.uniqueValues.length;c++)a._ticktext.push(b.uniqueValues[c])})(a,E[b])});var F=c.line;function K(c){var a,b;return i.isArrayOrTypedArray(F.color)?b=a=F.color[c%F.color.length]:a=F.color,{color:D(a),rawColor:b}}F?(e(c,"line")&&f(J,c,{vals:c.line.color,containerStr:"line",cLetter:"c"}),D=h.tryColorscale(F)):D=i.identity;var G=o[0].values.length,s={},H=E.map(function(a){return a.inds});for(a=0,v=0;a<G;a++){var w=[];for(b=0;b<H.length;b++)w.push(H[b][a]);v+=r=q[a%q.length];var x=K(a),y=w+"-"+x.rawColor;void 0===s[y]&&(s[y]=m(w,x.color,x.rawColor)),n(s[y],a,r)}var t=o.map(function(a,g){var b,c,d,e,f;return b=g,c=a._index,d=a._displayindex,e=a.label,f=v,{dimensionInd:b,containerInd:c,displayInd:d,dimensionLabel:e,count:f,categories:[],dragX:null}});for(a=0;a<G;a++)for(b=0,r=q[a%q.length];b<t.length;b++){var I=t[b].containerInd,p=E[b].inds[a],z=t[b].categories;if(void 0===z[p]){var L=c.dimensions[I]._categoryarray[p],M=c.dimensions[I]._ticktext[p];z[p]=k(b,p,L,M)}l(z[p],a,r)}return d((u=t,A=s,B=v,C=u.map(function(a){return a.categories.length}).reduce(function(a,b){return Math.max(a,b)}),{dimensions:u,paths:A,trace:void 0,maxCats:C,count:B}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults"),g=a("../../plots/domain").defaults,h=a("../../plots/array_container_defaults"),i=a("./attributes"),j=a("../parcoords/merge_length");function k(b,c){function a(a,e){return d.coerce(b,c,i.dimensions,a,e)}var e=a("values"),f=a("visible");if(e&&e.length||(f=c.visible=!1),f){a("label"),a("displayindex",c._index);var g,h=b.categoryarray,j=Array.isArray(h)&&h.length>0;j&&(g="array");var k=a("categoryorder",g);"array"===k?(a("categoryarray"),a("ticktext")):(delete b.categoryarray,delete b.ticktext),j||"array"!==k||(c.categoryorder="trace")}}b.exports=function(m,c,n,b){function a(a,b){return d.coerce(m,c,i,a,b)}var l=h(m,c,{name:"dimensions",handleItemDefaults:k}),o=function(c,g,i,h,a){a("line.shape"),a("line.hovertemplate");var b=a("line.color",h.colorway[0]);if(e(c,"line")&&d.isArrayOrTypedArray(b)){if(b.length)return a("line.colorscale"),f(c,g,h,a,{prefix:"line.",cLetter:"c"}),b.length;g.line.color=i}return 1/0}(m,c,n,b,a);g(c,b,a),Array.isArray(l)&&l.length||(c.visible=!1),j(c,l,"values",o),a("hoveron"),a("hovertemplate"),a("arrangement"),a("bundlecolors"),a("sortpaths"),a("counts");var p={family:b.font.family,size:Math.round(b.font.size),color:b.font.color};d.coerceFont(a,"labelfont",p);var q={family:b.font.family,size:Math.round(b.font.size/1.2),color:b.font.color};d.coerceFont(a,"tickfont",q)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:a("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("d3-interpolate").interpolateNumber,g=a("../../plot_api/plot_api"),h=a("../../components/fx"),c=a("../../lib"),i=c.strTranslate,j=a("../../components/drawing"),k=a("tinycolor2"),l=a("../../lib/svg_text_utils");function m(a){return a.key}function n(a){var b=a.parcatsViewModel.dimensions.length,c=a.parcatsViewModel.dimensions[b-1].model.dimensionInd;return a.model.dimensionInd===c}function o(a,b){return a.model.rawColor>b.model.rawColor?1:a.model.rawColor<b.model.rawColor?-1:0}function p(a){if(!a.parcatsViewModel.dragDimension&& -1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")){c.raiseToTop(this),v(e.select(this));var x=r(a),y=s(a);if(a.parcatsViewModel.graphDiv.emit("plotly_hover",{points:x,event:e.event,constraints:y}),-1===a.parcatsViewModel.hoverinfoItems.indexOf("none")){var m,n,b,o=e.mouse(this)[0],f=a.parcatsViewModel.graphDiv,d=a.parcatsViewModel.trace,g=f._fullLayout,p=g._paperdiv.node().getBoundingClientRect(),q=a.parcatsViewModel.graphDiv.getBoundingClientRect();for(b=0;b<a.leftXs.length-1;b++)if(a.leftXs[b]+a.dimWidths[b]-2<=o&&o<=a.leftXs[b+1]+2){var t=a.parcatsViewModel.dimensions[b],z=a.parcatsViewModel.dimensions[b+1];m=(t.x+t.width+z.x)/2,n=(a.topYs[b]+a.topYs[b+1]+a.height)/2;break}var u=a.parcatsViewModel.x+m,A=a.parcatsViewModel.y+n,B=k.mostReadable(a.model.color,["black","white"]),i=a.model.count,w=i/a.parcatsViewModel.model.count,j={countLabel:i,probabilityLabel:w.toFixed(3)},l=[];-1!==a.parcatsViewModel.hoverinfoItems.indexOf("count")&&l.push(["Count:",j.countLabel].join(" ")),-1!==a.parcatsViewModel.hoverinfoItems.indexOf("probability")&&l.push(["P:",j.probabilityLabel].join(" "));var C=l.join("<br>"),D=e.mouse(f)[0];h.loneHover({trace:d,x:u-p.left+q.left,y:A-p.top+q.top,text:C,color:a.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:B,idealAlign:D<u?"right":"left",hovertemplate:(d.line||{}).hovertemplate,hovertemplateLabels:j,eventData:[{data:d._input,fullData:d,count:i,probability:w}]},{container:g._hoverlayer.node(),outerContainer:g._paper.node(),gd:f})}}}function q(a){if(!a.parcatsViewModel.dragDimension&&(u(e.select(this)),h.loneUnhover(a.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),a.parcatsViewModel.pathSelection.sort(o),-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var b=r(a),c=s(a);a.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:b,event:e.event,constraints:c})}}function r(a){for(var c=[],d=H(a.parcatsViewModel),b=0;b<a.model.valueInds.length;b++){var e=a.model.valueInds[b];c.push({curveNumber:d,pointNumber:e})}return c}function s(a){for(var c={},d=a.parcatsViewModel.model.dimensions,b=0;b<d.length;b++){var e=d[b],f=e.categories[a.model.categoryInds[b]];c[e.containerInd]=f.categoryValue}return void 0!==a.model.rawColor&&(c.color=a.model.rawColor),c}function t(a){if(-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")){var b=r(a),c=s(a);a.parcatsViewModel.graphDiv.emit("plotly_click",{points:b,event:e.event,constraints:c})}}function u(a){a.attr("fill",function(a){return a.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function v(a){a.attr("fill-opacity",.8).attr("stroke",function(a){return k.mostReadable(a.model.color,["black","white"])}).attr("stroke-width",.3)}function w(a){a.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function x(a){a.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function y(a){var b=a.parcatsViewModel.pathSelection,c=a.categoryViewModel.model.dimensionInd,d=a.categoryViewModel.model.categoryInd;return b.filter(function(b){return b.model.categoryInds[c]===d&&b.model.color===a.color})}function z(a,f,g){var b=e.select(a).datum(),c=b.categoryViewModel.model,h=b.parcatsViewModel.graphDiv,i=e.select(a.parentNode).selectAll("rect.bandrect"),j=[];i.each(function(a){y(a).each(function(a){Array.prototype.push.apply(j,r(a))})});var d={};d[c.dimensionInd]=c.categoryValue,h.emit(f,{points:j,event:g,constraints:d})}function A(d,f,g){var a=e.select(d).datum(),c=a.categoryViewModel.model,h=a.parcatsViewModel.graphDiv,i=y(a),j=[];i.each(function(a){Array.prototype.push.apply(j,r(a))});var b={};b[c.dimensionInd]=c.categoryValue,void 0!==a.rawColor&&(b.color=a.rawColor),h.emit(f,{points:j,event:g,constraints:b})}function B(c,l,p){c._fullLayout._calcInverseTransform(c);var h,i,q=c._fullLayout._invScaleX,r=c._fullLayout._invScaleY,m=e.select(p.parentNode).select("rect.catrect"),b=m.node().getBoundingClientRect(),a=m.datum(),d=a.parcatsViewModel,s=d.model.dimensions[a.model.dimensionInd],f=d.trace,t=b.top+b.height/2;d.dimensions.length>1&&s.displayInd===d.dimensions.length-1?(h=b.left,i="left"):(h=b.left+b.width,i="right");var j=a.model.count,n=a.model.categoryLabel,o=j/a.parcatsViewModel.model.count,g={countLabel:j,categoryLabel:n,probabilityLabel:o.toFixed(3)},k=[];-1!==a.parcatsViewModel.hoverinfoItems.indexOf("count")&&k.push(["Count:",g.countLabel].join(" ")),-1!==a.parcatsViewModel.hoverinfoItems.indexOf("probability")&&k.push(["P("+g.categoryLabel+"):",g.probabilityLabel].join(" "));var u=k.join("<br>");return{trace:f,x:q*(h-l.left),y:r*(t-l.top),text:u,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:i,hovertemplate:f.hovertemplate,hovertemplateLabels:g,eventData:[{data:f._input,fullData:f,count:j,category:n,probability:o}]}}function C(l){if(!l.parcatsViewModel.dragDimension&& -1===l.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!(e.mouse(this)[1]< -1)){var m,u,T,K,w,n,x,C,D,E,L,M,d,f,a,g,N,o,O,i,r,p,F,G,H,s,j,P,Q,U,V,R,S,q=l.parcatsViewModel.graphDiv,I=q._fullLayout,J=I._paperdiv.node().getBoundingClientRect(),t=l.parcatsViewModel.hoveron,b=this;"color"===t?(u=b,v(K=y(T=e.select(u).datum())),K.each(function(){c.raiseToTop(this)}),e.select(u.parentNode).selectAll("rect.bandrect").filter(function(a){return a.color===T.color}).each(function(){c.raiseToTop(this),function(a){a.attr("stroke","black").attr("stroke-width",1.5)}(e.select(this))}),A(b,"plotly_hover",e.event)):(w=b,e.select(w.parentNode).selectAll("rect.bandrect").each(function(b){var a=y(b);v(a),a.each(function(){c.raiseToTop(this)})}),function(a){a.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(e.select(w.parentNode)),z(b,"plotly_hover",e.event)),-1===l.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===t?m=B(q,J,b):"color"===t?m=(n=q,x=J,C=b,n._fullLayout._calcInverseTransform(n),L=n._fullLayout._invScaleX,M=n._fullLayout._invScaleY,d=C.getBoundingClientRect(),f=e.select(C).datum(),a=f.categoryViewModel,g=a.parcatsViewModel,N=g.model.dimensions[a.model.dimensionInd],o=g.trace,O=d.y+d.height/2,g.dimensions.length>1&&N.displayInd===g.dimensions.length-1?(D=d.left,E="left"):(D=d.left+d.width,E="right"),i=a.model.categoryLabel,r=f.parcatsViewModel.model.count,p=0,f.categoryViewModel.bands.forEach(function(a){a.color===f.color&&(p+=a.count)}),F=a.model.count,G=0,g.pathSelection.each(function(a){a.model.color===f.color&&(G+=a.model.count)}),H=p/r,s={countLabel:r,categoryLabel:i,probabilityLabel:H.toFixed(3)},j=[],-1!==a.parcatsViewModel.hoverinfoItems.indexOf("count")&&j.push(["Count:",s.countLabel].join(" ")),-1!==a.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(j.push("P(color \u2229 "+i+"): "+s.probabilityLabel),j.push("P("+i+" | color): "+(p/G).toFixed(3)),j.push("P(color | "+i+"): "+(p/F).toFixed(3))),P=j.join("<br>"),Q=k.mostReadable(f.color,["black","white"]),{trace:o,x:L*(D-x.left),y:M*(O-x.top),text:P,color:f.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Q,fontSize:10,idealAlign:E,hovertemplate:o.hovertemplate,hovertemplateLabels:s,eventData:[{data:o._input,fullData:o,category:i,count:r,probability:H,categorycount:F,colorcount:G,bandcolorcount:p}]}):"dimension"===t&&(m=(U=q,V=J,R=b,S=[],e.select(R.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){S.push(B(U,V,this))}),S)),m&&h.loneHover(m,{container:I._hoverlayer.node(),outerContainer:I._paper.node(),gd:q}))}}function D(b){var a=b.parcatsViewModel;if(!a.dragDimension&&(u(a.pathSelection),w(a.dimensionSelection.selectAll("g.category")),x(a.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),h.loneUnhover(a.graphDiv._fullLayout._hoverlayer.node()),a.pathSelection.sort(o),-1===a.hoverinfoItems.indexOf("skip"))){var d=b.parcatsViewModel.hoveron,c=this;"color"===d?A(c,"plotly_unhover",e.event):z(c,"plotly_unhover",e.event)}}function E(a){"fixed"!==a.parcatsViewModel.arrangement&&(a.dragDimensionDisplayInd=a.model.displayInd,a.initialDragDimensionDisplayInds=a.parcatsViewModel.model.dimensions.map(function(a){return a.displayInd}),a.dragHasMoved=!1,a.dragCategoryDisplayInd=null,e.select(this).selectAll("g.category").select("rect.catrect").each(function(b){var d=e.mouse(this)[0],f=e.mouse(this)[1];-2<=d&&d<=b.width+2&& -2<=f&&f<=b.height+2&&(a.dragCategoryDisplayInd=b.model.displayInd,a.initialDragCategoryDisplayInds=a.model.categories.map(function(a){return a.displayInd}),b.model.dragY=b.y,c.raiseToTop(this.parentNode),e.select(this.parentNode).selectAll("rect.bandrect").each(function(b){b.y<f&&f<=b.y+b.height&&(a.potentialClickBand=this)}))}),a.parcatsViewModel.dragDimension=a,h.loneUnhover(a.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function F(a){if("fixed"!==a.parcatsViewModel.arrangement&&(a.dragHasMoved=!0,null!==a.dragDimensionDisplayInd)){var h=a.dragDimensionDisplayInd,b=a.parcatsViewModel.dimensions[h];if(null!==a.dragCategoryDisplayInd){var c=b.categories[a.dragCategoryDisplayInd];c.model.dragY+=e.event.dy;var k=c.model.dragY,i=c.model.displayInd,l=b.categories,d=l[i-1],f=l[i+1];void 0!==d&&k<d.y+d.height/2&&(c.model.displayInd=d.model.displayInd,d.model.displayInd=i),void 0!==f&&k+c.height>f.y+f.height/2&&(c.model.displayInd=f.model.displayInd,f.model.displayInd=i),a.dragCategoryDisplayInd=c.model.displayInd}if(null===a.dragCategoryDisplayInd||"freeform"===a.parcatsViewModel.arrangement){b.model.dragX=e.event.x;var g=a.parcatsViewModel.dimensions[h-1],j=a.parcatsViewModel.dimensions[h+1];void 0!==g&&b.model.dragX<g.x+g.width&&(b.model.displayInd=g.model.displayInd,g.model.displayInd=h),void 0!==j&&b.model.dragX+b.width>j.x&&(b.model.displayInd=j.model.displayInd,j.model.displayInd=a.dragDimensionDisplayInd),a.dragDimensionDisplayInd=b.model.displayInd}N(a.parcatsViewModel),M(a.parcatsViewModel),J(a.parcatsViewModel),I(a.parcatsViewModel)}}function G(a){if("fixed"!==a.parcatsViewModel.arrangement&&null!==a.dragDimensionDisplayInd){e.select(this).selectAll("text").attr("font-weight","normal");var b={},k=H(a.parcatsViewModel),d=a.parcatsViewModel.model.dimensions.map(function(a){return a.displayInd}),f=a.initialDragDimensionDisplayInds.some(function(a,b){return a!==d[b]});f&&d.forEach(function(c,d){b["dimensions["+a.parcatsViewModel.model.dimensions[d].containerInd+"].displayindex"]=c});var h=!1;if(null!==a.dragCategoryDisplayInd){var l=a.model.categories.map(function(a){return a.displayInd});if(h=a.initialDragCategoryDisplayInds.some(function(a,b){return a!==l[b]})){var c=a.model.categories.slice().sort(function(a,b){return a.displayInd-b.displayInd}),i=c.map(function(a){return a.categoryValue}),j=c.map(function(a){return a.categoryLabel});b["dimensions["+a.model.containerInd+"].categoryarray"]=[i],b["dimensions["+a.model.containerInd+"].ticktext"]=[j],b["dimensions["+a.model.containerInd+"].categoryorder"]="array"}}-1===a.parcatsViewModel.hoverinfoItems.indexOf("skip")&& !a.dragHasMoved&&a.potentialClickBand&&("color"===a.parcatsViewModel.hoveron?A(a.potentialClickBand,"plotly_click",e.event.sourceEvent):z(a.potentialClickBand,"plotly_click",e.event.sourceEvent)),a.model.dragX=null,null!==a.dragCategoryDisplayInd&&(a.parcatsViewModel.dimensions[a.dragDimensionDisplayInd].categories[a.dragCategoryDisplayInd].model.dragY=null,a.dragCategoryDisplayInd=null),a.dragDimensionDisplayInd=null,a.parcatsViewModel.dragDimension=null,a.dragHasMoved=null,a.potentialClickBand=null,N(a.parcatsViewModel),M(a.parcatsViewModel),e.transition().duration(300).ease("cubic-in-out").each(function(){J(a.parcatsViewModel,!0),I(a.parcatsViewModel,!0)}).each("end",function(){(f||h)&&g.restyle(a.parcatsViewModel.graphDiv,b,[k])})}}function H(b){for(var c,d=b.graphDiv._fullData,a=0;a<d.length;a++)if(b.key===d[a].uid){c=a;break}return c}function I(c,a){var b;void 0===a&&(a=!1),c.pathSelection.data(function(a){return a.paths},m),(b=c.pathSelection,a?b.transition():b).attr("d",function(a){return a.svgD})}function J(d,f){function g(a){return f?a.transition():a}void 0===f&&(f=!1),d.dimensionSelection.data(function(a){return a.dimensions},m);var a=d.dimensionSelection.selectAll("g.category").data(function(a){return a.categories},m);g(d.dimensionSelection).attr("transform",function(a){return i(a.x,0)}),g(a).attr("transform",function(a){return i(0,a.y)}),a.select(".dimlabel").text(function(a,b){return 0===b?a.parcatsViewModel.model.dimensions[a.model.dimensionInd].dimensionLabel:null}),a.select(".catlabel").attr("text-anchor",function(a){return n(a)?"start":"end"}).attr("x",function(a){return n(a)?a.width+5:-5}).each(function(c){var a,b;n(c)?(a=c.width+5,b="start"):(a=-5,b="end"),e.select(this).selectAll("tspan").attr("x",a).attr("text-anchor",b)});var b=a.selectAll("rect.bandrect").data(function(a){return a.bands},m),h=b.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(a){return a.color}).attr("fill-opacity",0);b.attr("fill",function(a){return a.color}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("y",function(a){return a.y}),x(h),b.each(function(){c.raiseToTop(this)}),b.exit().remove()}function K(i,c,j){var g,d=j[0],e=c.margin||{l:80,r:80,t:100,b:80},a=d.trace,b=a.domain,h=c.width,k=c.height,l=Math.floor(h*(b.x[1]-b.x[0])),m=Math.floor(k*(b.y[1]-b.y[0])),n=b.x[0]*h+e.l,o=c.height-b.y[1]*c.height+e.t,p=a.line.shape;g="all"===a.hoverinfo?["count","probability"]:(a.hoverinfo||"").split("+");var f={trace:a,key:a.uid,model:d,x:n,y:o,width:l,height:m,hoveron:a.hoveron,hoverinfoItems:g,arrangement:a.arrangement,bundlecolors:a.bundlecolors,sortpaths:a.sortpaths,labelfont:a.labelfont,categorylabelfont:a.tickfont,pathShape:p,dragDimension:null,margin:e,paths:[],dimensions:[],graphDiv:i,traceSelection:null,pathSelection:null,dimensionSelection:null};return d.dimensions&&(N(f),M(f)),f}function L(e,d,b,g,k){var h,a,i=[],j=[];for(a=0;a<b.length-1;a++)h=f(b[a]+e[a],e[a+1]),i.push(h(k)),j.push(h(1-k));var c="M "+e[0]+","+d[0];for(c+="l"+b[0]+",0 ",a=1;a<b.length;a++)c+="C"+i[a-1]+","+d[a-1]+" "+j[a-1]+","+d[a]+" "+e[a]+","+d[a],c+="l"+b[a]+",0 ";for(c+="l0,"+g+" ",c+="l -"+b[b.length-1]+",0 ",a=b.length-2;a>=0;a--)c+="C"+j[a]+","+(d[a+1]+g)+" "+i[a]+","+(d[a]+g)+" "+(e[a]+b[a])+","+(d[a]+g),c+="l-"+b[a]+",0 ";return c+="Z"}function M(a){var e=a.dimensions,l=a.model,m=e.map(function(a){return a.categories.map(function(a){return a.y})}),x=a.model.dimensions.map(function(a){return a.categories.map(function(a){return a.displayInd})}),y=a.model.dimensions.map(function(a){return a.displayInd}),B=a.dimensions.map(function(a){return a.model.dimensionInd}),n=e.map(function(a){return a.x}),o=e.map(function(a){return a.width}),f=[];for(var q in l.paths)l.paths.hasOwnProperty(q)&&f.push(l.paths[q]);function C(a){var b=a.categoryInds.map(function(a,b){return x[b][a]});return B.map(function(a){return b[a]})}f.sort(function(d,e){var b=C(d),c=C(e);return("backward"===a.sortpaths&&(b.reverse(),c.reverse()),b.push(d.valueInds[0]),c.push(e.valueInds[0]),a.bundlecolors&&(b.unshift(d.rawColor),c.unshift(e.rawColor)),b<c)?-1:b>c?1:0});for(var r=new Array(f.length),s=e[0].model.count,z=e[0].categories.map(function(a){return a.height}).reduce(function(a,b){return a+b}),i=0;i<f.length;i++){var c,t,b=f[i];c=s>0?z*(b.count/s):0;for(var j=new Array(m.length),g=0;g<b.categoryInds.length;g++){var A=b.categoryInds[g],p=x[g][A],k=y[g];j[k]=m[k][p],m[k][p]+=c;var d=a.dimensions[k].categories[p],u=d.bands.length,h=d.bands[u-1];if(void 0===h||b.rawColor!==h.rawColor){var v=void 0===h?0:h.y+h.height;d.bands.push({key:v,color:b.color,rawColor:b.rawColor,height:c,width:d.width,count:b.count,y:v,categoryViewModel:d,parcatsViewModel:a})}else{var w=d.bands[u-1];w.height+=c,w.count+=b.count}}t="hspline"===a.pathShape?L(n,j,o,c,.5):L(n,j,o,c,0),r[i]={key:b.valueInds[0],model:b,height:c,leftXs:n,topYs:j,dimWidths:o,svgD:t,parcatsViewModel:a}}a.paths=r}function N(a){var b=a.model.dimensions.map(function(a){return{displayInd:a.displayInd,dimensionInd:a.dimensionInd}});b.sort(function(a,b){return a.displayInd-b.displayInd});var c=[];for(var d in b){var e=b[d].dimensionInd,f=a.model.dimensions[e];c.push(O(a,f))}a.dimensions=c}function O(b,a){var g,e,c,h,i,d,j=b.model.dimensions.length,p=a.displayInd;g=40+(j>1?(b.width-80-16)/(j-1):0)*p;var k=[],l=b.model.maxCats,m=a.categories.length,n=a.count,q=b.height-8*(l-1),f=(l-m)*8/2,o=a.categories.map(function(a){return{displayInd:a.displayInd,categoryInd:a.categoryInd}});for(o.sort(function(a,b){return a.displayInd-b.displayInd}),d=0;d<m;d++)i=o[d].categoryInd,c=a.categories[i],e=n>0?c.count/n*q:0,h={key:c.valueInds[0],model:c,width:16,height:e,y:null!==c.dragY?c.dragY:f,bands:[],parcatsViewModel:b},f=f+e+8,k.push(h);return{key:a.dimensionInd,x:null!==a.dragX?a.dragX:g,y:0,width:16,model:a,categories:k,parcatsViewModel:b,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}b.exports=function(L,M,N,O){var v,k,y,z,A,B,H,d,r,b,s,f,a,h,g,I,J;v=N,k=L,y=O,z=M,A=k._context.staticPlot,B=v.map(K.bind(0,k,y)),(H=z.selectAll("g.parcatslayer").data([null])).enter().append("g").attr("class","parcatslayer").style("pointer-events",A?"none":"all"),r=(d=H.selectAll("g.trace.parcats").data(B,m)).enter().append("g").attr("class","trace parcats"),d.attr("transform",function(a){return i(a.x,a.y)}),r.append("g").attr("class","paths"),b=d.select("g.paths").selectAll("path.path").data(function(a){return a.paths},m),b.attr("fill",function(a){return a.model.color}),s=b.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(a){return a.model.color}).attr("fill-opacity",0),u(s),b.attr("d",function(a){return a.svgD}),s.empty()||b.sort(o),b.exit().remove(),b.on("mouseover",p).on("mouseout",q).on("click",t),r.append("g").attr("class","dimensions"),f=d.select("g.dimensions").selectAll("g.dimension").data(function(a){return a.dimensions},m),f.enter().append("g").attr("class","dimension"),f.attr("transform",function(a){return i(a.x,0)}),f.exit().remove(),a=f.selectAll("g.category").data(function(a){return a.categories},m),h=a.enter().append("g").attr("class","category"),a.attr("transform",function(a){return i(0,a.y)}),h.append("rect").attr("class","catrect").attr("pointer-events","none"),a.select("rect.catrect").attr("fill","none").attr("width",function(a){return a.width}).attr("height",function(a){return a.height}),w(h),g=a.selectAll("rect.bandrect").data(function(a){return a.bands},m),g.each(function(){c.raiseToTop(this)}),g.attr("fill",function(a){return a.color}),I=g.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(a){return a.color}).attr("fill-opacity",0),g.attr("fill",function(a){return a.color}).attr("width",function(a){return a.width}).attr("height",function(a){return a.height}).attr("y",function(a){return a.y}).attr("cursor",function(a){return"fixed"===a.parcatsViewModel.arrangement?"default":"perpendicular"===a.parcatsViewModel.arrangement?"ns-resize":"move"}),x(I),g.exit().remove(),h.append("text").attr("class","catlabel").attr("pointer-events","none"),J=k._fullLayout.paper_bgcolor,a.select("text.catlabel").attr("text-anchor",function(a){return n(a)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",l.makeTextShadow(J)).style("fill","rgb(0, 0, 0)").attr("x",function(a){return n(a)?a.width+5:-5}).attr("y",function(a){return a.height/2}).text(function(a){return a.model.categoryLabel}).each(function(a){j.font(e.select(this),a.parcatsViewModel.categorylabelfont),l.convertToTspans(e.select(this),k)}),h.append("text").attr("class","dimlabel"),a.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(a){return"fixed"===a.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(a){return a.width/2}).attr("y",-5).text(function(a,b){return 0===b?a.parcatsViewModel.model.dimensions[a.model.dimensionInd].dimensionLabel:null}).each(function(a){j.font(e.select(this),a.parcatsViewModel.labelfont)}),a.selectAll("rect.bandrect").on("mouseover",C).on("mouseout",D),a.exit().remove(),f.call(e.behavior.drag().origin(function(a){return{x:a.x,y:0}}).on("dragstart",E).on("drag",F).on("dragend",G)),d.each(function(a){a.traceSelection=e.select(this),a.pathSelection=e.select(this).selectAll("g.paths").selectAll("path.path"),a.dimensionSelection=e.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),d.exit().remove()}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(a,b,c){"use strict";var d=a("./parcats");b.exports=function(b,e,f,g){var c=b._fullLayout,h=c._paper,a=c._size;d(b,h,e,{width:a.w,height:a.h,margin:{t:a.t,r:a.r,b:a.b,l:a.l}},f,g)}},{"./parcats":895}],897:[function(a,e,i){"use strict";var f=a("../../components/colorscale/attributes"),c=a("../../plots/cartesian/layout_attributes"),d=a("../../plots/font_attributes"),g=a("../../plots/domain").attributes,b=a("../../lib/extend").extendFlat,h=a("../../plot_api/plot_template").templatedArray;e.exports={domain:g({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:d({editType:"plot"}),tickfont:d({editType:"plot"}),rangefont:d({editType:"plot"}),dimensions:h("dimension",{label:{valType:"string",editType:"plot"},tickvals:b({},c.tickvals,{editType:"plot"}),ticktext:b({},c.ticktext,{editType:"plot"}),tickformat:b({},c.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:b({editType:"calc"},f("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(a,c,d){"use strict";var b=a("./constants"),e=a("@plotly/d3"),f=a("../../lib/gup").keyFun,g=a("../../lib/gup").repeat,h=a("../../lib").sorterAsc,i=a("../../lib").strTranslate,j=b.bar.snapRatio;function k(a,b){return a*(1-j)+b*j}var l=b.bar.snapClose;function m(a,b){return a*(1-l)+b*l}function n(l,g,c,n){if(o(c,n))return c;var a=l?-1:1,d=0,e=g.length-1;if(a<0){var p=d;d=e,e=p}for(var b=g[d],i=b,h=d;a*h<a*e;h+=a){var j=h+a,f=g[j];if(a*c<a*m(b,f))return k(b,i);if(a*c<a*f||j===e)return k(f,b);i=b,b=f}}function o(c,b){for(var a=0;a<b.length;a++)if(c>=b[a][0]&&c<=b[a][1])return!0;return!1}function p(a){a.attr("x",-b.bar.captureWidth/2).attr("width",b.bar.captureWidth)}function q(a){a.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function r(b){if(!b.brush.filterSpecified)return"0,"+b.height;for(var e,f,g,a=s(b.brush.filter.getConsolidated(),b.height),c=[0],h=a.length?a[0][0]:null,d=0;d<a.length;d++)f=(e=a[d])[1]-e[0],c.push(h),c.push(f),(g=d+1)<a.length&&(h=a[g][0]-e[1]);return c.push(b.height),c}function s(a,b){return a.map(function(a){return a.map(function(a){return Math.max(0,a*b)}).sort(h)})}function t(){e.select(document.body).style("cursor",null)}function u(a){a.attr("stroke-dasharray",r)}function v(d,a){var c=e.select(d).selectAll(".highlight, .highlight-shadow");u(a?c.transition().duration(b.bar.snapDuration).each("end",a):c)}function w(g,c){var a,m=g.brush,t=m.filterSpecified,h=NaN,d={};if(t){var u=g.height,n=m.filter.getConsolidated(),i=s(n,u),o=NaN,e=NaN,j=NaN;for(a=0;a<=i.length;a++){var k=i[a];if(k&&k[0]<=c&&c<=k[1]){o=a;break}if(e=a?a-1:NaN,k&&k[0]>c){j=a;break}}if(isNaN(h=o)&&(h=isNaN(e)||isNaN(j)?isNaN(e)?j:e:c-i[e][1]<i[j][0]-c?e:j),!isNaN(h)){var p=i[h],q=function(a,c){var d=b.bar.handleHeight;if(!(c>a[1]+d)&&!(c<a[0]-d))return c>=.9*a[1]+.1*a[0]?"n":c<=.9*a[0]+.1*a[1]?"s":"ns"}(p,c);q&&(d.interval=n[h],d.intervalPix=p,d.region=q)}}if(g.ordinal&&!d.region){var f=g.unitTickvals,r=g.unitToPaddedPx.invert(c);for(a=0;a<f.length;a++){var l=[.25*f[Math.max(a-1,0)]+.75*f[a],.25*f[Math.min(a+1,f.length-1)]+.75*f[a]];if(r>=l[0]&&r<=l[1]){d.clickableOrdinalRange=l;break}}}return d}function x(f,c){e.event.sourceEvent.stopPropagation();var d=c.height-e.mouse(f)[1]-2*b.verticalPadding,a=c.brush.svgBrush;a.wasDragged=!0,a._dragging=!0,a.grabbingBar?a.newExtent=[d-a.grabPoint,d+a.barLength-a.grabPoint].map(c.unitToPaddedPx.invert):a.newExtent=[a.startExtent,c.unitToPaddedPx.invert(d)].sort(h),c.brush.filterSpecified=!0,a.extent=a.stayingIntervals.concat([a.newExtent]),a.brushCallback(c),v(f.parentNode)}function y(f,d){var g=d.height-e.mouse(f)[1]-2*b.verticalPadding,a=w(d,g),c="crosshair";a.clickableOrdinalRange?c="pointer":a.region&&(c=a.region+"-resize"),e.select(document.body).style("cursor",c)}function z(a){a.on("mousemove",function(a){e.event.preventDefault(),a.parent.inBrushDrag||y(this,a)}).on("mouseleave",function(a){a.parent.inBrushDrag||t()}).call(e.behavior.drag().on("dragstart",function(a){!function(j,c){e.event.sourceEvent.stopPropagation();var f=c.height-e.mouse(j)[1]-2*b.verticalPadding,k=c.unitToPaddedPx.invert(f),g=c.brush,d=w(c,f),h=d.interval,a=g.svgBrush;if(a.wasDragged=!1,a.grabbingBar="ns"===d.region,a.grabbingBar){var i=h.map(c.unitToPaddedPx);a.grabPoint=f-i[0]-b.verticalPadding,a.barLength=i[1]-i[0]}a.clickableOrdinalRange=d.clickableOrdinalRange,a.stayingIntervals=c.multiselect&&g.filterSpecified?g.filter.getConsolidated():[],h&&(a.stayingIntervals=a.stayingIntervals.filter(function(a){return a[0]!==h[0]&&a[1]!==h[1]})),a.startExtent=d.region?h["s"===d.region?1:0]:k,c.parent.inBrushDrag=!0,a.brushStartCallback()}(this,a)}).on("drag",function(a){x(this,a)}).on("dragend",function(a){!function(f,b){var c=b.brush,h=c.filter,a=c.svgBrush;a._dragging||(y(f,b),x(f,b),b.brush.svgBrush.wasDragged=!1),a._dragging=!1,e.event.sourceEvent.stopPropagation();var j=a.grabbingBar;if(a.grabbingBar=!1,a.grabLocation=void 0,b.parent.inBrushDrag=!1,t(),!a.wasDragged){a.wasDragged=void 0,a.clickableOrdinalRange?c.filterSpecified&&b.multiselect?a.extent.push(a.clickableOrdinalRange):(a.extent=[a.clickableOrdinalRange],c.filterSpecified=!0):j?(a.extent=a.stayingIntervals,0===a.extent.length&&B(c)):B(c),a.brushCallback(b),v(f.parentNode),a.brushEndCallback(c.filterSpecified?h.getConsolidated():[]);return}var g=function(){h.set(h.getConsolidated())};if(b.ordinal){var d=b.unitTickvals;d[d.length-1]<d[0]&&d.reverse(),a.newExtent=[n(0,d,a.newExtent[0],a.stayingIntervals),n(1,d,a.newExtent[1],a.stayingIntervals)];var i=a.newExtent[1]>a.newExtent[0];a.extent=a.stayingIntervals.concat(i?[a.newExtent]:[]),a.extent.length||B(c),a.brushCallback(b),i?v(f.parentNode,g):(g(),v(f.parentNode))}else g();a.brushEndCallback(c.filterSpecified?h.getConsolidated():[])}(this,a)}))}function A(a,b){return a[0]-b[0]}function B(a){a.filterSpecified=!1,a.svgBrush.extent=[[-1/0,1/0]]}function C(e){for(var b,d=e.slice(),a=[],c=d.shift();c;){for(b=c.slice();(c=d.shift())&&c[0]<=b[1];)b[1]=Math.max(b[1],c[1]);a.push(b)}return 1===a.length&&a[0][0]>a[0][1]&&(a=[]),a}c.exports={makeBrush:function(j,b,c,d,e,f){var k,l,g,i,a=(g=[],{set:function(a){1===(g=a.map(function(a){return a.slice().sort(h)}).sort(A)).length&&g[0][0]=== -1/0&&g[0][1]===1/0&&(g=[[0,-1]]),k=C(g),l=g.reduce(function(a,b){return[Math.min(a[0],b[0]),Math.max(a[1],b[1])]},[1/0,-1/0])},get:function(){return g.slice()},getConsolidated:function(){return k},getBounds:function(){return l}});return a.set(c),{filter:a,filterSpecified:b,svgBrush:{extent:[],brushStartCallback:d,brushCallback:(i=e,function(b){var a=b.brush,c=a.svgBrush.extent.map(function(a){return a.slice()}).slice();a.filter.set(c),i()}),brushEndCallback:f}}},ensureAxisBrush:function(l,m,n){var a,c,d,e,h,j,k=l.selectAll("."+b.cn.axisBrush).data(g,f);k.enter().append("g").classed(b.cn.axisBrush,!0),a=k,c=m,d=n._context.staticPlot,(e=a.selectAll(".background").data(g)).enter().append("rect").classed("background",!0).call(p).call(q).style("pointer-events",d?"none":"auto").attr("transform",i(0,b.verticalPadding)),e.call(z).attr("height",function(a){return a.height-b.verticalPadding}),(h=a.selectAll(".highlight-shadow").data(g)).enter().append("line").classed("highlight-shadow",!0).attr("x",-b.bar.width/2).attr("stroke-width",b.bar.width+b.bar.strokeWidth).attr("stroke",c).attr("opacity",b.bar.strokeOpacity).attr("stroke-linecap","butt"),h.attr("y1",function(a){return a.height}).call(u),(j=a.selectAll(".highlight").data(g)).enter().append("line").classed("highlight",!0).attr("x",-b.bar.width/2).attr("stroke-width",b.bar.width-b.bar.strokeWidth).attr("stroke",b.bar.fillColor).attr("opacity",b.bar.fillOpacity).attr("stroke-linecap","butt"),j.attr("y1",function(a){return a.height}).call(u)},cleanRanges:function(a,b){if(Array.isArray(a[0])?(a=a.map(function(a){return a.sort(h)}),a=b.multiselect?C(a.sort(A)):[a[0]]):a=[a.sort(h)],b.tickvals){var c=b.tickvals.slice().sort(h);if(!(a=a.map(function(b){var a=[n(0,c,b[0],[]),n(1,c,b[1],[])];if(a[1]>a[0])return a}).filter(function(a){return a})).length)return}return a.length>1?a:a[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:a("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(a,c,b){"use strict";var d=a("@plotly/d3"),e=a("../../plots/get_data").getModuleCalcData,f=a("./plot"),g=a("../../constants/xmlns_namespaces");b.name="parcoords",b.plot=function(a){var b=e(a.calcdata,"parcoords")[0];b.length&&f(a,b)},b.clean=function(e,b,f,a){var c=a._has&&a._has("parcoords"),d=b._has&&b._has("parcoords");c&&!d&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},b.toSVG=function(a){var c=a._fullLayout._glimages,b=d.select(a).selectAll(".svg-container");b.filter(function(c,a){return a===b.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var a=this.toDataURL("image/png");c.append("svg:image").attr({xmlns:g.svg,"xlink:href":a,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){d.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray,e=a("../../components/colorscale"),f=a("../../lib/gup").wrap;b.exports=function(g,a){var b,c;return e.hasColorscale(a,"line")&&d(a.line.color)?(b=a.line.color,c=e.extractOpts(a.line).colorscale,e.calc(g,a,{vals:b,containerStr:"line",cLetter:"c"})):(b=function(b){for(var c=new Array(b),a=0;a<b;a++)c[a]=.5;return c}(a._length),c=[[0,a.line.color],[1,a.line.color]]),f({lineColor:b,cscale:c})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(b,a,c){"use strict";a.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults"),g=a("../../plots/domain").defaults,h=a("../../plots/array_container_defaults"),i=a("../../plots/cartesian/axes"),j=a("./attributes"),k=a("./axisbrush"),l=a("./constants").maxDimensionCount,m=a("./merge_length");function n(l,b,m,g){function a(a,c){return d.coerce(l,b,j.dimensions,a,c)}var c=a("values"),e=a("visible");if(c&&c.length||(e=b.visible=!1),e){a("label"),a("tickvals"),a("ticktext"),a("tickformat");var h=a("range");b._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:h},i.setConvert(b._ax,g.layout),a("multiselect");var f=a("constraintrange");f&&(b.constraintrange=k.cleanRanges(f,b))}}b.exports=function(i,c,q,b){function a(a,b){return d.coerce(i,c,j,a,b)}var k=i.dimensions;Array.isArray(k)&&k.length>l&&(d.log("parcoords traces support up to "+l+" dimensions at the moment"),k.splice(l));var o=h(i,c,{name:"dimensions",layout:b,handleItemDefaults:n}),r=function(c,g,h,i,a){var b=a("line.color",h);if(e(c,"line")&&d.isArrayOrTypedArray(b)){if(b.length)return a("line.colorscale"),f(c,g,i,a,{prefix:"line.",cLetter:"c"}),b.length;g.line.color=h}return 1/0}(i,c,q,b,a);g(c,b,a),Array.isArray(o)&&o.length||(c.visible=!1),m(c,o,"values",r);var p={family:b.font.family,size:Math.round(b.font.size/1.2),color:b.font.color};d.coerceFont(a,"labelfont",p),d.coerceFont(a,"tickfont",p),d.coerceFont(a,"rangefont",p),a("labelangle"),a("labelside"),a("unselected.line.color"),a("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(b,c,a){"use strict";var d=b("../../lib").isTypedArray;a.convertTypedArray=function(a){return d(a)?Array.prototype.slice.call(a):a},a.isOrdinal=function(a){return!!a.tickvals},a.isVisible=function(a){return a.visible||!("visible"in a)}},{"../../lib":515}],905:[function(a,c,d){"use strict";var b=a("./base_index");b.plot=a("./plot"),c.exports=b},{"./base_index":899,"./plot":909}],906:[function(a,c,d){"use strict";var b=a("glslify"),e=b(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\nuniform sampler2D maskTexture, palette;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(maskTexture,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),f=b(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),g=a("./constants").maxDimensionCount,h=a("../../lib"),i=new Uint8Array(4),j=new Uint8Array(4),k={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function l(b,c,d,e,f){var a=b._gl;a.enable(a.SCISSOR_TEST),a.scissor(c,d,e,f),b.clear({color:[0,0,0,0],depth:1})}function m(b,e,a,f,g,c){var h=c.key;function d(i){var j=Math.min(f,g-i*f);0===i&&(window.cancelAnimationFrame(a.currentRafs[h]),delete a.currentRafs[h],l(b,c.scissorX,c.scissorY,c.scissorWidth,c.viewBoxSize[1])),a.clearOnly||(c.count=2*j,c.offset=2*i*f,e(c),i*f+j<g&&(a.currentRafs[h]=window.requestAnimationFrame(function(){d(i+1)})),a.drawCompleted=!1)}a.drawCompleted||(function(a){a.read({x:0,y:0,width:1,height:1,data:i})}(b),a.drawCompleted=!0),d(0)}function n(a){return Math.max(1e-6,Math.min(.999999,a))}function o(a,b){return(a>>>8*b)%256/255}function p(h,d,i){for(var e=new Array(8*d),j=0,a=0;a<d;a++)for(var b=0;b<2;b++)for(var c=0;c<4;c++){var f=4*h+c,g=i[64*a+f];63===f&&0===b&&(g*=-1),e[j++]=g}return e}function q(b){var a="0"+b;return a.substr(a.length-2)}function r(a){return a<g?"p"+q(a+1)+"_"+q(a+4):"colors"}function s(a,o,x,j,p,q,f,k,l,m,y,z,A,b){for(var c=[[],[]],d=0;d<64;d++)c[0][d]=d===p?1:0,c[1][d]=d===q?1:0;f*=b,k*=b,l*=b,m*=b;var e=a.lines.canvasOverdrag*b,g=a.domain,n=a.canvasWidth*b,r=a.canvasHeight*b,s=a.pad.l*b,t=a.pad.b*b,u=a.layoutHeight*b,v=a.layoutWidth*b,i=a.deselectedLines.color,w=a.deselectedLines.opacity;return h.extendFlat({key:y,resolution:[n,r],viewBoxPos:[f+e,k],viewBoxSize:[l,m],i0:p,i1:q,dim0A:c[0].slice(0,16),dim0B:c[0].slice(16,32),dim0C:c[0].slice(32,48),dim0D:c[0].slice(48,64),dim1A:c[1].slice(0,16),dim1B:c[1].slice(16,32),dim1C:c[1].slice(32,48),dim1D:c[1].slice(48,64),drwLayer:z,contextColor:[i[0]/255,i[1]/255,i[2]/255,"auto"!==w?i[3]*w:Math.max(1/255,Math.pow(1/a.lines.color.length,1/3))],scissorX:(j===o?0:f+e)+(s-e)+v*g.x[0],scissorWidth:(j===x?n-f+e:l+.5)+(j===o?f+e:0),scissorY:k+t+u*g.y[0],scissorHeight:m,viewportX:s-e+v*g.x[0],viewportY:t+u*g.y[0],viewportWidth:n,viewportHeight:r},A)}function t(a){var b=Math.max(0,Math.floor(2047*a[0]),0),c=Math.min(2047,Math.ceil(2047*a[1]),2047);return[Math.min(b,c),Math.max(b,c)]}c.exports=function(x,b){var y,z,A,B,C,c=b.context,D=b.pick,a=b.regl,d=a._gl,i=d.getParameter(d.ALIASED_LINE_WIDTH_RANGE),q=Math.max(i[0],Math.min(i[1],b.viewModel.plotGlPixelRatio)),E={currentRafs:{},drawCompleted:!0,clearOnly:!1},u=function(c){for(var b={},a=0;a<=g;a+=4)b[r(a)]=c.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return b}(a),v=a.texture(k),F=[];w(b);var G=a({profile:!1,blend:{enable:c,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!c,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:a.prop("scissorX"),y:a.prop("scissorY"),width:a.prop("scissorWidth"),height:a.prop("scissorHeight")}},viewport:{x:a.prop("viewportX"),y:a.prop("viewportY"),width:a.prop("viewportWidth"),height:a.prop("viewportHeight")},dither:!1,vert:e,frag:f,primitive:"lines",lineWidth:q,attributes:u,uniforms:{resolution:a.prop("resolution"),viewBoxPos:a.prop("viewBoxPos"),viewBoxSize:a.prop("viewBoxSize"),dim0A:a.prop("dim0A"),dim1A:a.prop("dim1A"),dim0B:a.prop("dim0B"),dim1B:a.prop("dim1B"),dim0C:a.prop("dim0C"),dim1C:a.prop("dim1C"),dim0D:a.prop("dim0D"),dim1D:a.prop("dim1D"),loA:a.prop("loA"),hiA:a.prop("hiA"),loB:a.prop("loB"),hiB:a.prop("hiB"),loC:a.prop("loC"),hiC:a.prop("hiC"),loD:a.prop("loD"),hiD:a.prop("hiD"),palette:v,contextColor:a.prop("contextColor"),maskTexture:a.prop("maskTexture"),drwLayer:a.prop("drwLayer"),maskHeight:a.prop("maskHeight")},offset:a.prop("offset"),count:a.prop("count")});function w(b){y=b.model,z=b.viewModel,A=z.dimensions.slice(),B=A[0]?A[0].values.length:0;var d=y.lines,e=function(e,f,h){for(var b=new Array(e*(g+4)),c=0,a=0;a<e;a++){for(var d=0;d<g;d++)b[c++]=d<f.length?f[d].paddedUnitValues[a]:.5;b[c++]=o(a,2),b[c++]=o(a,1),b[c++]=o(a,0),b[c++]=n(h[a])}return b}(B,A,D?d.color.map(function(b,a){return a/d.color.length}):d.color);!function(b,c,d){for(var a=0;a<=g;a+=4)b[r(a)](p(a/4,c,d))}(u,B,e),c||D||(v=a.texture(h.extendFlat({data:function(c,d){for(var b=new Array(256),a=0;a<256;a++)b[a]=c(a/255).concat(255);return b}(y.unitToColor,255)},k)))}return{render:function(e,i,q){var b,j,k,h=e.length,n=1/0,o=-1/0;for(b=0;b<h;b++)e[b].dim0.canvasX<n&&(n=e[b].dim0.canvasX,j=b),e[b].dim1.canvasX>o&&(o=e[b].dim1.canvasX,k=b);0===h&&l(a,0,0,y.canvasWidth,y.canvasHeight);var r=function(i){var c,e,b,d=[[],[]];for(b=0;b<64;b++){var j=!i&&b<A.length?A[b].brush.filter.getBounds():[-1/0,1/0];d[0][b]=j[0],d[1][b]=j[1]}var g=new Array(16384);for(c=0;c<16384;c++)g[c]=255;if(!i)for(c=0;c<A.length;c++){var k=c%8,n=(c-k)/8,o=Math.pow(2,k),p=A[c],f=p.brush.filter.get();if(!(f.length<2)){var h=t(f[0])[1];for(e=1;e<f.length;e++){var l=t(f[e]);for(b=h+1;b<l[0];b++)g[8*b+n]&=~o;h=Math.max(h,l[1])}}}var m={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:g};return C?C(m):C=a.texture(m),{maskTexture:C,maskHeight:2048,loA:d[0].slice(0,16),loB:d[0].slice(16,32),loC:d[0].slice(32,48),loD:d[0].slice(48,64),hiA:d[1].slice(0,16),hiB:d[1].slice(16,32),hiC:d[1].slice(32,48),hiD:d[1].slice(48,64)}}(c);for(b=0;b<h;b++){var d=e[b],f=d.dim0.crossfilterDimensionIndex,u=d.dim1.crossfilterDimensionIndex,g=d.canvasX,v=d.canvasY,p=g+d.panelSizeX,w=d.plotGlPixelRatio;if(i||!F[f]||F[f][0]!==g||F[f][1]!==p){F[f]=[g,p];var x=s(y,j,k,b,f,u,g,v,d.panelSizeX,d.panelSizeY,d.dim0.crossfilterDimensionIndex,c?0:D?2:1,r,w);E.clearOnly=q,m(a,G,E,i?y.lines.blockLineCount:B,B,x)}}},readPixel:function(b,c){return a.read({x:b,y:c,width:1,height:1,data:j}),j},readPixels:function(e,f,b,c){var d=new Uint8Array(4*b*c);return a.read({x:e,y:f,width:b,height:c,data:d}),d},destroy:function(){for(var a in x.style["pointer-events"]="none",v.destroy(),C&&C.destroy(),u)u[a].destroy()},update:w}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(b,a,c){"use strict";a.exports=function(e,c,f,a){var b,d;for(a||(a=1/0),b=0;b<c.length;b++)(d=c[b]).visible&&(a=Math.min(a,d[f].length));for(a===1/0&&(a=0),e._length=a,b=0;b<c.length;b++)(d=c[b]).visible&&(d._length=a);return a}},{}],908:[function(a,d,e){"use strict";var f=a("@plotly/d3"),b=a("../../lib"),g=b.numberFormat,h=a("color-rgba"),i=a("../../plots/cartesian/axes"),j=b.strRotate,k=b.strTranslate,l=a("../../lib/svg_text_utils"),m=a("../../components/drawing"),n=a("../../components/colorscale"),c=a("../../lib/gup"),o=c.keyFun,p=c.repeat,q=c.unwrap,r=a("./helpers"),s=a("./constants"),t=a("./axisbrush"),u=a("./lines");function v(a,c,d){return b.aggNums(a,null,c,d)}function w(a,b){return y(v(Math.min,a,b),v(Math.max,a,b))}function x(a){var b=a.range;return b?y(b[0],b[1]):w(a.values,a._length)}function y(a,b){return(isNaN(a)||!isFinite(a))&&(a=0),(isNaN(b)||!isFinite(b))&&(b=0),a===b&&(0===a?(a-=1,b+=1):(a*=.9,b*=1.1)),[a,b]}function z(a){return a.dimensions.some(function(a){return a.brush.filterSpecified})}function A(d,u,v){var j,w,y,z,e=q(u),a=e.trace,k=r.convertTypedArray(e.lineColor),l=a.line,A={color:h(a.unselected.line.color),opacity:a.unselected.line.opacity},g=n.extractOpts(l),B=g.reversescale?n.flipScale(e.cscale):e.cscale,c=a.domain,m=a.dimensions,i=d.width,C=a.labelangle,D=a.labelside,E=a.labelfont,F=a.tickfont,G=a.rangefont,o=b.extendDeepNoArrays({},l,{color:k.map(f.scale.linear().domain(x({values:k,range:[g.min,g.max],_length:a._length}))),blockLineCount:s.blockLineCount,canvasOverdrag:s.overdrag*s.canvasPixelRatio}),H=Math.floor(i*(c.x[1]-c.x[0])),I=Math.floor(d.height*(c.y[1]-c.y[0])),J=d.margin||{l:80,r:80,t:100,b:80},p=H,t=I;return{key:v,colCount:m.filter(r.isVisible).length,dimensions:m,tickDistance:s.tickDistance,unitToColor:(w=(j=B).map(function(a){return a[0]}),y=j.map(function(b){var a=h(b[1]);return f.rgb("rgb("+a[0]+","+a[1]+","+a[2]+")")}),z="rgb".split("").map(function(a){var b;return f.scale.linear().clamp(!0).domain(w).range(y.map((b=a,function(a){return a[b]})))}),function(a){return z.map(function(b){return b(a)})}),lines:o,deselectedLines:A,labelAngle:C,labelSide:D,labelFont:E,tickFont:F,rangeFont:G,layoutWidth:i,layoutHeight:d.height,domain:c,translateX:c.x[0]*i,translateY:d.height-c.y[1]*d.height,pad:J,canvasWidth:p*s.canvasPixelRatio+2*o.canvasOverdrag,canvasHeight:t*s.canvasPixelRatio,width:p,height:t,canvasPixelRatio:s.canvasPixelRatio}}function B(k,l,a){var d,c,m=a.width,e=a.height,i=a.dimensions,n=a.canvasPixelRatio,j=function(b){return m*b/Math.max(1,a.colCount-1)},o=s.verticalPadding/e,p=(d=e,c=s.verticalPadding,f.scale.linear().range([c,d-c])),h={key:a.key,xScale:j,model:a,inBrushDrag:!1},q={};return h.dimensions=i.filter(r.isVisible).map(function(d,w){var G,B,C,y,H,I,N,J,K,D,i,L=(K=d,D=o,f.scale.linear().domain(x(K)).range([D,1-D])),E=q[d.label];q[d.label]=(E||0)+1;var O=d.label+(E?"__"+E:""),u=d.constraintrange,F=u&&u.length;F&&!Array.isArray(u[0])&&(u=[u]);var P=F?u.map(function(a){return a.map(L)}):[[-1/0,1/0]],m=d.values;m.length>d._length&&(m=m.slice(0,d._length));var c=d.tickvals;function Q(a,b){return{val:a,text:i[b]}}function R(a,b){return a.val-b.val}if(Array.isArray(c)&&c.length){i=d.ticktext,Array.isArray(i)&&i.length?i.length>c.length?i=i.slice(0,c.length):c.length>i.length&&(c=c.slice(0,i.length)):i=c.map(g(d.tickformat));for(var A=1;A<c.length;A++)if(c[A]<c[A-1]){for(var M=c.map(Q).sort(R),v=0;v<c.length;v++)c[v]=M[v].val,i[v]=M[v].text;break}}else c=void 0;return m=r.convertTypedArray(m),{key:O,label:d.label,tickFormat:d.tickformat,tickvals:c,ticktext:i,ordinal:r.isOrdinal(d),multiselect:d.multiselect,xIndex:w,crossfilterDimensionIndex:w,visibleIndex:d._index,height:e,values:m,paddedUnitValues:m.map(L),unitTickvals:c&&c.map(L),xScale:j,x:j(w),canvasX:j(w)*n,unitToPaddedPx:p,domainScale:(G=e,B=s.verticalPadding,C=d,y=c,H=i,J=x(C),y?f.scale.ordinal().domain(y.map((I=g(C.tickformat),(N=H)?function(b,c){var a=N[c];return null==a?I(b):a}:I))).range(y.map(function(a){return G-B+(a-J[0])/(J[1]-J[0])*(2*B-G)})):f.scale.linear().domain(J).range([G-B,B])),ordinalScale:function(a){if(a.tickvals){var b=x(a);return f.scale.ordinal().domain(a.tickvals).range(a.tickvals.map(function(a){return(a-b[0])/(b[1]-b[0])}))}}(d),parent:h,model:a,brush:t.makeBrush(k,F,P,function(){k.linePickActive(!1)},function(){var a=h;a.focusLayer&&a.focusLayer.render(a.panels,!0);var b=z(a);!k.contextShown()&&b?(a.contextLayer&&a.contextLayer.render(a.panels,!0),k.contextShown(!0)):k.contextShown()&&!b&&(a.contextLayer&&a.contextLayer.render(a.panels,!0,!0),k.contextShown(!1))},function(a){if(h.focusLayer.render(h.panels,!0),h.pickLayer&&h.pickLayer.render(h.panels,!0),k.linePickActive(!0),l&&l.filterChanged){var e=L.invert,c=a.map(function(a){return a.map(e).sort(b.sorterAsc)}).sort(function(a,b){return a[0]-b[0]});l.filterChanged(h.key,d._index,c)}})}}),h}function C(a){a.classed(s.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function D(a,c){var b=a*Math.PI/180;return{dir:"top"===c?1:-1,dx:Math.sin(b),dy:Math.cos(b),degrees:a}}function E(h,c,i){for(var f=c.panels||(c.panels=[]),d=h.data(),b=0;b<d.length-1;b++){var a=f[b]||(f[b]={}),e=d[b],g=d[b+1];a.dim0=e,a.dim1=g,a.canvasX=e.canvasX,a.panelSizeX=g.canvasX-e.canvasX,a.panelSizeY=c.model.canvasHeight,a.y=0,a.canvasY=0,a.plotGlPixelRatio=i}}function F(a,b){return i.tickText(a._ax,b,!1).text}function G(a,c){if(a.ordinal)return"";var b=a.domainScale.domain(),d=b[c?b.length-1:0];return F(a.model.dimensions[a.visibleIndex],d)}d.exports=function(c,I,S,T){var U,V,J=c._context.staticPlot,K=c._fullLayout,L=K._toppaper,M=K._glcontainer,Y=c._context.plotGlPixelRatio,N=c._fullLayout.paper_bgcolor;!function(e){for(var c=0;c<e.length;c++)for(var f=0;f<e[c].length;f++)for(var g=e[c][f].trace,d=g.dimensions,b=0;b<d.length;b++){var h=d[b].values,a=d[b]._ax;a&&(a.range?a.range=y(a.range[0],a.range[1]):a.range=w(h,g._length),a.dtick||(a.dtick=.01*(Math.abs(a.range[1]-a.range[0])||1)),a.tickformat=d[b].tickformat,i.calcTicks(a),a.cleanRange())}}(I);var W=(U=!0,V=!1,{linePickActive:function(a){return arguments.length?U=!!a:U},contextShown:function(a){return arguments.length?V=!!a:V}}),X=I.filter(function(a){return q(a).trace.visible}).map(A.bind(0,S)).map(B.bind(0,W,T));M.each(function(a,c){return b.extendFlat(a,X[c])});var n=M.selectAll(".gl-canvas").each(function(a){a.viewModel=X[0],a.viewModel.plotGlPixelRatio=Y,a.viewModel.paperColor=N,a.model=a.viewModel?a.viewModel.model:null}),Z=null;n.filter(function(a){return a.pick}).style("pointer-events",J?"none":"auto").on("mousemove",function(d){if(W.linePickActive()&&d.lineLayer&&T&&T.hover){var g=f.event,l=this.width,h=this.height,i=f.mouse(this),a=i[0],b=i[1];if(!(a<0)&&!(b<0)&&!(a>=l)&&!(b>=h)){var c=d.lineLayer.readPixel(a,h-1-b),j=0!==c[3],e=j?c[2]+256*(c[1]+256*c[0]):null,k={x:a,y:b,clientX:g.clientX,clientY:g.clientY,dataIndex:d.model.key,curveNumber:e};e!==Z&&(j?T.hover(k):T.unhover&&T.unhover(k),Z=e)}}}),n.style("opacity",function(a){return a.pick?0:1}),L.style("background","rgba(255, 255, 255, 0)");var e=L.selectAll("."+s.cn.parcoords).data(X,o);e.exit().remove(),e.enter().append("g").classed(s.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),e.attr("transform",function(a){return k(a.model.translateX,a.model.translateY)});var g=e.selectAll("."+s.cn.parcoordsControlView).data(p,o);g.enter().append("g").classed(s.cn.parcoordsControlView,!0),g.attr("transform",function(a){return k(a.model.pad.l,a.model.pad.t)});var d=g.selectAll("."+s.cn.yAxis).data(function(a){return a.dimensions},o);d.enter().append("g").classed(s.cn.yAxis,!0),g.each(function(a){E(d,a,Y)}),n.each(function(a){if(a.viewModel){!a.lineLayer||T?a.lineLayer=u(this,a):a.lineLayer.update(a),(a.key||0===a.key)&&(a.viewModel[a.key]=a.lineLayer);var b=!a.context||T;a.lineLayer.render(a.viewModel.panels,b)}}),d.attr("transform",function(a){return k(a.xScale(a.xIndex),0)}),d.call(f.behavior.drag().origin(function(a){return a}).on("drag",function(b){var a=b.parent;W.linePickActive(!1),b.x=Math.max(-s.overdrag,Math.min(b.model.width+s.overdrag,f.event.x)),b.canvasX=b.x*b.model.canvasPixelRatio,d.sort(function(a,b){return a.x-b.x}).each(function(a,c){a.xIndex=c,a.x=b===a?a.x:a.xScale(a.xIndex),a.canvasX=a.x*a.model.canvasPixelRatio}),E(d,a,Y),d.filter(function(a){return 0!==Math.abs(b.xIndex-a.xIndex)}).attr("transform",function(a){return k(a.xScale(a.xIndex),0)}),f.select(this).attr("transform",k(b.x,0)),d.each(function(c,d,e){e===b.parent.key&&(a.dimensions[d]=c)}),a.contextLayer&&a.contextLayer.render(a.panels,!1,!z(a)),a.focusLayer.render&&a.focusLayer.render(a.panels)}).on("dragend",function(b){var a=b.parent;b.x=b.xScale(b.xIndex),b.canvasX=b.x*b.model.canvasPixelRatio,E(d,a,Y),f.select(this).attr("transform",function(a){return k(a.x,0)}),a.contextLayer&&a.contextLayer.render(a.panels,!1,!z(a)),a.focusLayer&&a.focusLayer.render(a.panels),a.pickLayer&&a.pickLayer.render(a.panels,!0),W.linePickActive(!0),T&&T.axesMoved&&T.axesMoved(a.key,a.dimensions.map(function(a){return a.crossfilterDimensionIndex}))})),d.exit().remove();var a=d.selectAll("."+s.cn.axisOverlays).data(p,o);a.enter().append("g").classed(s.cn.axisOverlays,!0),a.selectAll("."+s.cn.axis).remove();var h=a.selectAll("."+s.cn.axis).data(p,o);h.enter().append("g").classed(s.cn.axis,!0),h.each(function(a){var c=a.model.height/a.model.tickDistance,b=a.domainScale,d=b.domain();f.select(this).call(f.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(c,a.tickFormat).tickValues(a.ordinal?d:null).tickFormat(function(b){return r.isOrdinal(a)?b:F(a.model.dimensions[a.visibleIndex],b)}).scale(b)),m.font(h.selectAll("text"),a.model.tickFont)}),h.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),h.selectAll("text").style("text-shadow",l.makeTextShadow(N)).style("cursor","default");var O=a.selectAll("."+s.cn.axisHeading).data(p,o);O.enter().append("g").classed(s.cn.axisHeading,!0);var P=O.selectAll("."+s.cn.axisTitle).data(p,o);P.enter().append("text").classed(s.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",J?"none":"auto"),P.text(function(a){return a.label}).each(function(b){var a=f.select(this);m.font(a,b.model.labelFont),l.convertToTspans(a,c)}).attr("transform",function(b){var a=D(b.model.labelAngle,b.model.labelSide),c=s.axisTitleOffset;return(a.dir>0?"":k(0,2*c+b.model.height))+j(a.degrees)+k(-c*a.dx,-c*a.dy)}).attr("text-anchor",function(b){var a=D(b.model.labelAngle,b.model.labelSide),c=Math.abs(a.dx),d=Math.abs(a.dy);return 2*c>d?a.dir*a.dx<0?"start":"end":"middle"});var v=a.selectAll("."+s.cn.axisExtent).data(p,o);v.enter().append("g").classed(s.cn.axisExtent,!0);var x=v.selectAll("."+s.cn.axisExtentTop).data(p,o);x.enter().append("g").classed(s.cn.axisExtentTop,!0),x.attr("transform",k(0,-s.axisExtentOffset));var Q=x.selectAll("."+s.cn.axisExtentTopText).data(p,o);Q.enter().append("text").classed(s.cn.axisExtentTopText,!0).call(C),Q.text(function(a){return G(a,!0)}).each(function(a){m.font(f.select(this),a.model.rangeFont)});var H=v.selectAll("."+s.cn.axisExtentBottom).data(p,o);H.enter().append("g").classed(s.cn.axisExtentBottom,!0),H.attr("transform",function(a){return k(0,a.model.height+s.axisExtentOffset)});var R=H.selectAll("."+s.cn.axisExtentBottomText).data(p,o);R.enter().append("text").classed(s.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(C),R.text(function(a){return G(a,!1)}).each(function(a){m.font(f.select(this),a.model.rangeFont)}),t.ensureAxisBrush(a,N,c)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(a,c,b){"use strict";var e=a("./parcoords"),f=a("../../lib/prepare_regl"),g=a("./helpers").isVisible,d={};function h(c,b,d){var e=b.indexOf(d),a=c.indexOf(e);return -1===a&&(a+=b.length),a}var b=c.exports=function(b,c){var i=b._fullLayout;if(f(b,[],d)){var n={},o={},p={},q={},a=i._size;c.forEach(function(e,a){var c=e[0].trace;p[a]=c.index;var d=q[a]=c._fullInput.index;n[a]=b.data[d].dimensions,o[a]=b.data[d].dimensions.slice()});var j=function(c,d,k){var e=o[c][d],a=k.map(function(a){return a.slice()}),f="dimensions["+d+"].constraintrange",g=i._tracePreGUI[b._fullData[p[c]]._fullInput.uid];if(void 0===g[f]){var l=e.constraintrange;g[f]=l||null}var h=b._fullData[p[c]].dimensions[d];a.length?(1===a.length&&(a=a[0]),e.constraintrange=a,h.constraintrange=a.slice(),a=[a]):(delete e.constraintrange,delete h.constraintrange,a=null);var j={};j[f]=a,b.emit("plotly_restyle",[j,[q[c]]])},k=function(a){b.emit("plotly_hover",a)},l=function(a){b.emit("plotly_unhover",a)},m=function(a,c){var d,e,f=(d=c,e=o[a].filter(g),function(a,b){return h(d,e,a)-h(d,e,b)});n[a].sort(f),o[a].filter(function(a){return!g(a)}).sort(function(b){return o[a].indexOf(b)}).forEach(function(b){n[a].splice(n[a].indexOf(b),1),n[a].splice(o[a].indexOf(b),0,b)}),b.emit("plotly_restyle",[{dimensions:[n[a]]},[q[a]]])};e(b,c,{width:a.w,height:a.h,margin:{t:a.t,r:a.r,b:a.b,l:a.l}},{filterChanged:j,hover:k,unhover:l,axesMoved:m})}};b.reglPrecompiled=d},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(a,d,k){"use strict";var e=a("../../plots/attributes"),f=a("../../plots/domain").attributes,g=a("../../plots/font_attributes"),h=a("../../components/color/attributes"),i=a("../../plots/template_attributes").hovertemplateAttrs,j=a("../../plots/template_attributes").texttemplateAttrs,b=a("../../lib/extend").extendFlat,c=g({editType:"plot",arrayOk:!0,colorEditType:"plot"});d.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:h.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:b({},e.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:i({},{keys:["label","color","value","percent","text"]}),texttemplate:j({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:b({},c,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:b({},c,{}),outsidetextfont:b({},c,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:b({},c,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:f({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:b({},c,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(b,c,a){"use strict";var d=b("../../plots/plots");a.name="pie",a.plot=function(b,c,e,f){d.plotBasePlot(a.name,b,c,e,f)},a.clean=function(b,c,e,f){d.cleanBasePlot(a.name,b,c,e,f)}},{"../../plots/plots":628}],912:[function(a,b,e){"use strict";var f=a("fast-isnumeric"),g=a("tinycolor2"),h=a("../../components/color"),i={};function c(a){return function(b,c){return!!b&& !!(b=g(b)).isValid()&&(b=h.addOpacity(b,b.getAlpha()),a[c]||(a[c]=b),b)}}function d(b,d){var a,e=JSON.stringify(b),c=d[e];if(!c){for(a=0,c=b.slice();a<b.length;a++)c.push(g(b[a]).lighten(20).toHexString());for(a=0;a<b.length;a++)c.push(g(b[a]).darken(20).toHexString());d[e]=c}return c}b.exports={calc:function(s,a){var b=[],m=s._fullLayout,t=m.hiddenlabels||[],j=a.labels,k=a.marker.colors||[],u=a.values,h=a._length,v=a._hasValues&&h;if(a.dlabel)for(e=0,j=new Array(h);e<h;e++)j[e]=String(a.label0+e*a.dlabel);var n={},o=c(m["_"+a.type+"colormap"]),l=0,p=!1;for(e=0;e<h;e++){if(v){if(!f(i=u[e]))continue;i=+i}else i=1;(void 0===(d=j[e])||""===d)&&(d=e);var e,g,i,d,q,r=n[d=String(d)];void 0===r?(n[d]=b.length,(q=-1!==t.indexOf(d))||(l+=i),b.push({v:i,label:d,color:o(k[e],d),i:e,pts:[e],hidden:q})):(p=!0,g=b[r],g.v+=i,g.pts.push(e),g.hidden||(l+=i),!1===g.color&&k[e]&&(g.color=o(k[e],d)))}return b=b.filter(function(a){return a.v>=0}),("funnelarea"===a.type?p:a.sort)&&b.sort(function(a,b){return b.v-a.v}),b[0]&&(b[0].vTotal=l),b},crossTraceCalc:function(k,n){var a=(n||{}).type;a||(a="pie");var e=k._fullLayout,l=k.calcdata,c=e[a+"colorway"],f=e["_"+a+"colormap"];e["extend"+a+"colors"]&&(c=d(c,i));for(var m=0,g=0;g<l.length;g++){var h=l[g];if(h[0].trace.type===a)for(var j=0;j<h.length;j++){var b=h[j];!1===b.color&&(f[b.label]?b.color=f[b.label]:(f[b.label]=b.color=c[m%c.length],m++))}}},makePullColorFn:c,generateExtendedColors:d}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(a,b,d){"use strict";var e=a("fast-isnumeric"),f=a("../../lib"),g=a("./attributes"),h=a("../../plots/domain").defaults,i=a("../bar/defaults").handleText;function c(g,b){var h,i=Array.isArray(g),c=f.isArrayOrTypedArray(b),a=Math.min(i?g.length:1/0,c?b.length:1/0);if(isFinite(a)||(a=0),a&&c){for(var d=0;d<a;d++){var j=b[d];if(e(j)&&j>0){h=!0;break}}h||(a=0)}return{hasLabels:i,hasValues:c,len:a}}b.exports={handleLabelsAndValues:c,supplyDefaults:function(o,b,t,e){function a(a,c){return f.coerce(o,b,g,a,c)}var j,p=a("labels"),q=a("values"),k=c(p,q),l=k.len;if(b._hasLabels=k.hasLabels,b._hasValues=k.hasValues,!b._hasLabels&&b._hasValues&&(a("label0"),a("dlabel")),!l){b.visible=!1;return}b._length=l,a("marker.line.width")&&a("marker.line.color"),a("marker.colors"),a("scalegroup");var r=a("text"),m=a("texttemplate");if(m||(j=a("textinfo",Array.isArray(r)?"text+percent":"percent")),a("hovertext"),a("hovertemplate"),m||j&&"none"!==j){var d=a("textposition");i(o,b,e,a,d,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(d)||"auto"===d||"outside"===d)&&a("automargin"),("inside"===d||"auto"===d||Array.isArray(d))&&a("insidetextorientation")}h(b,e,a);var n=a("hole");if(a("title.text")){var s=a("title.position",n?"middle center":"top center");n||"middle center"!==s||(b.title.position="top center"),f.coerceFont(a,"title.font",e.font)}a("sort"),a("direction"),a("rotation"),a("pull")}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(a,b,c){"use strict";var d=a("../../components/fx/helpers").appendArrayMultiPointValues;b.exports=function(a,c){var b={curveNumber:c.index,pointNumbers:a.pts,data:c._input,fullData:c,label:a.label,color:a.color,value:a.v,percent:a.percent,text:a.text,bbox:a.bbox,v:a.v};return 1===a.pts.length&&(b.pointNumber=b.i=a.pts[0]),d(b,c,a.pts),"funnelarea"===c.type&&(delete b.v,delete b.i),b}},{"../../components/fx/helpers":403}],915:[function(b,c,a){"use strict";var d=b("../../lib");function e(a){return -1!==a.indexOf("e")?a.replace(/[.]?0+e/,"e"):-1!==a.indexOf(".")?a.replace(/[.]?0+$/,""):a}a.formatPiePercent=function(a,b){var c=e((100*a).toPrecision(3));return d.numSeparate(c,b)+"%"},a.formatPieValue=function(a,b){var c=e(a.toPrecision(10));return d.numSeparate(c,b)},a.getFirstFilled=function(c,d){if(Array.isArray(c))for(var b=0;b<d.length;b++){var a=c[d[b]];if(a||0===a||""===a)return a}},a.castOption=function(b,c){return Array.isArray(b)?a.getFirstFilled(b,c):b||void 0},a.getRotationAngle=function(a){return("auto"===a?0:a)*Math.PI/180}},{"../../lib":515}],916:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,supplyLayoutDefaults:a("./layout_defaults"),layoutAttributes:a("./layout_attributes"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot").plot,style:a("./style"),styleOne:a("./style_one"),moduleType:"trace",name:"pie",basePlotModule:a("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(b,a,c){"use strict";a.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(c,b){function a(a,f){return d.coerce(c,b,e,a,f)}a("hiddenlabels"),a("piecolorway",b.colorway),a("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(a,d,m){"use strict";var n=a("@plotly/d3"),o=a("../../plots/plots"),p=a("../../components/fx"),q=a("../../components/color"),r=a("../../components/drawing"),b=a("../../lib"),s=b.strScale,t=b.strTranslate,u=a("../../lib/svg_text_utils"),c=a("../bar/uniform_text"),v=c.recordMinTextSize,w=c.clearMinTextSize,x=a("../bar/constants").TEXTPAD,y=a("./helpers"),z=a("./event_data"),A=a("../../lib").isValidTextValue;function e(c,f,e){var d=e[0],g=d.cx,h=d.cy,a=d.trace,i="funnelarea"===a.type;"_hasHoverLabel"in a||(a._hasHoverLabel=!1),"_hasHoverEvent"in a||(a._hasHoverEvent=!1),c.on("mouseover",function(c){var l=f._fullLayout,j=f._fullData[a.index];if(!f._dragging&& !1!==l.hovermode){var e=j.hoverinfo;if(Array.isArray(e)&&(e=p.castHoverinfo({hoverinfo:[y.castOption(e,c.pts)],_module:a._module},l,0)),"all"===e&&(e="label+text+value+percent+name"),j.hovertemplate||"none"!==e&&"skip"!==e&&e){var k=c.rInscribed||0,q=g+c.pxmid[0]*(1-k),r=h+c.pxmid[1]*(1-k),t=l.separators,m=[];if(e&& -1!==e.indexOf("label")&&m.push(c.label),c.text=y.castOption(j.hovertext||j.text,c.pts),e&& -1!==e.indexOf("text")){var u=c.text;b.isValidTextValue(u)&&m.push(u)}c.value=c.v,c.valueLabel=y.formatPieValue(c.v,t),e&& -1!==e.indexOf("value")&&m.push(c.valueLabel),c.percent=c.v/d.vTotal,c.percentLabel=y.formatPiePercent(c.percent,t),e&& -1!==e.indexOf("percent")&&m.push(c.percentLabel);var o=j.hoverlabel,s=o.font,v=[];p.loneHover({trace:a,x0:q-k*d.r,x1:q+k*d.r,y:r,_x0:i?g+c.TL[0]:q-k*d.r,_x1:i?g+c.TR[0]:q+k*d.r,_y0:i?h+c.TL[1]:r-k*d.r,_y1:i?h+c.BL[1]:r+k*d.r,text:m.join("<br>"),name:j.hovertemplate|| -1!==e.indexOf("name")?j.name:void 0,idealAlign:c.pxmid[0]<0?"left":"right",color:y.castOption(o.bgcolor,c.pts)||c.color,borderColor:y.castOption(o.bordercolor,c.pts),fontFamily:y.castOption(s.family,c.pts),fontSize:y.castOption(s.size,c.pts),fontColor:y.castOption(s.color,c.pts),nameLength:y.castOption(o.namelength,c.pts),textAlign:y.castOption(o.align,c.pts),hovertemplate:y.castOption(j.hovertemplate,c.pts),hovertemplateLabels:c,eventData:[z(c,j)]},{container:l._hoverlayer.node(),outerContainer:l._paper.node(),gd:f,inOut_bbox:v}),c.bbox=v[0],a._hasHoverLabel=!0}a._hasHoverEvent=!0,f.emit("plotly_hover",{points:[z(c,j)],event:n.event})}}),c.on("mouseout",function(b){var c=f._fullLayout,d=f._fullData[a.index],e=n.select(this).datum();a._hasHoverEvent&&(b.originalEvent=n.event,f.emit("plotly_unhover",{points:[z(e,d)],event:n.event}),a._hasHoverEvent=!1),a._hasHoverLabel&&(p.loneUnhover(c._hoverlayer.node()),a._hasHoverLabel=!1)}),c.on("click",function(b){var c=f._fullLayout,d=f._fullData[a.index];f._dragging|| !1===c.hovermode||(f._hoverdata=[z(b,d)],p.click(f,n.event))})}function f(a,b,d){var c=y.castOption(a.insidetextfont.color,b.pts);!c&&a._input.textfont&&(c=y.castOption(a._input.textfont.color,b.pts));var e=y.castOption(a.insidetextfont.family,b.pts)||y.castOption(a.textfont.family,b.pts)||d.family,f=y.castOption(a.insidetextfont.size,b.pts)||y.castOption(a.textfont.size,b.pts)||d.size;return{color:c||q.contrast(b.color),family:e,size:f}}function g(e,i){for(var f,a,c=0;c<e.length;c++)if((a=(f=e[c][0]).trace).title.text){var d=a.title.text;a._meta&&(d=b.templateString(d,a._meta));var g=r.tester.append("text").attr("data-notex",1).text(d).call(r.font,a.title.font).call(u.convertToTspans,i),h=r.bBox(g.node(),!0);f.titleBox={width:h.width,height:h.height},g.remove()}}function h(d,b,o){var j=o.r||b.rpx1,k=b.rInscribed;if(b.startangle===b.stopangle)return{rCenter:1-k,scale:0,rotate:0,textPosAngle:0};var l=b.ring,v=1===l&&Math.abs(b.startangle-b.stopangle)===2*Math.PI,p=b.halfangle,q=b.midangle,g=o.trace.insidetextorientation,m="horizontal"===g,r="tangential"===g,s="radial"===g,f="auto"===g,e=[];if(!f){var c,a,h=function(a,i){if(B(b,a)){var f=Math.abs(a-b.startangle),g=Math.abs(a-b.stopangle),h=f<g?f:g;(c="tan"===i?D(d,j,l,h,0):C(d,j,l,h,Math.PI/2)).textPosAngle=a,e.push(c)}};if(m||r){for(a=4;a>= -4;a-=2)h(Math.PI*a,"tan");for(a=4;a>= -4;a-=2)h(Math.PI*(a+1),"tan")}if(m||s){for(a=4;a>= -4;a-=2)h(Math.PI*(a+1.5),"rad");for(a=4;a>= -4;a-=2)h(Math.PI*(a+.5),"rad")}}if(v||f||m){if((c={scale:k*j*2/Math.sqrt(d.width*d.width+d.height*d.height),rCenter:1-k,rotate:0}).textPosAngle=(b.startangle+b.stopangle)/2,c.scale>=1)return c;e.push(c)}(f||s)&&((c=C(d,j,l,p,q)).textPosAngle=(b.startangle+b.stopangle)/2,e.push(c)),(f||r)&&((c=D(d,j,l,p,q)).textPosAngle=(b.startangle+b.stopangle)/2,e.push(c));for(var t=0,n=0,i=0;i<e.length;i++){var u=e[i].scale;if(n<u&&(n=u,t=i),!f&&n>=1)break}return e[t]}function B(b,a){var c=b.startangle,d=b.stopangle;return c>a&&a>d||c<a&&a<d}function C(b,a,e,f,g){a=Math.max(0,a-2*x);var c=b.width/b.height,d=G(c,f,a,e);return{scale:2*d/b.height,rCenter:E(c,d/a),rotate:F(g)}}function D(b,a,e,f,g){a=Math.max(0,a-2*x);var c=b.height/b.width,d=G(c,f,a,e);return{scale:2*d/b.width,rCenter:E(c,d/a),rotate:F(g+Math.PI/2)}}function E(b,a){return Math.cos(a)-b*a}function F(a){return(180/Math.PI*a+720)%180-90}function G(a,d,e,c){var b=a+1/(2*Math.tan(d));return e*Math.min(1/(Math.sqrt(b*b+.5)+b),c/(Math.sqrt(a*a+c/2)+a))}function H(a,b){return a.v!==b.vTotal||b.trace.hole?Math.min(1/(1+1/Math.sin(a.halfangle)),a.ring/2):1}function I(e,f){var a=f.pxmid[0],b=f.pxmid[1],c=e.width/2,d=e.height/2;return a<0&&(c*=-1),b<0&&(d*=-1),{scale:1,rCenter:1,rotate:0,x:c+Math.abs(d)*(c>0?1:-1)/2,y:d/(1+a*a/(b*b)),outside:!0}}function i(a,h){var e,i=1,j=1,b=a.trace,c={x:a.cx,y:a.cy},d={tx:0,ty:0};d.ty+=b.title.font.size,e=L(b),-1!==b.title.position.indexOf("top")?(c.y-=(1+e)*a.r,d.ty-=a.titleBox.height):-1!==b.title.position.indexOf("bottom")&&(c.y+=(1+e)*a.r);var f=J(a.r,a.trace.aspectratio),g=h.w*(b.domain.x[1]-b.domain.x[0])/2;return -1!==b.title.position.indexOf("left")?(g+=f,c.x-=(1+e)*f,d.tx+=a.titleBox.width/2):-1!==b.title.position.indexOf("center")?g*=2:-1!==b.title.position.indexOf("right")&&(g+=f,c.x+=(1+e)*f,d.tx-=a.titleBox.width/2),i=g/a.titleBox.width,j=K(a,h)/a.titleBox.height,{x:c.x,y:c.y,scale:Math.min(i,j),tx:d.tx,ty:d.ty}}function J(b,a){return b/(void 0===a?1:a)}function K(a,c){var b=a.trace,d=c.h*(b.domain.y[1]-b.domain.y[0]);return Math.min(a.titleBox.height,d/2)}function L(c){var b,a=c.pull;if(!a)return 0;if(Array.isArray(a))for(b=0,a=0;b<c.pull.length;b++)c.pull[b]>a&&(a=c.pull[b]);return a}function j(e,b){for(var f=[],g=0;g<e.length;g++){var c=e[g][0],a=c.trace,d=a.domain,j=b.w*(d.x[1]-d.x[0]),h=b.h*(d.y[1]-d.y[0]);a.title.text&&"middle center"!==a.title.position&&(h-=K(c,b));var k=j/2,i=h/2;"funnelarea"!==a.type||a.scalegroup||(i/=a.aspectratio),c.r=Math.min(k,i)/(1+L(a)),c.cx=b.l+b.w*(a.domain.x[1]+a.domain.x[0])/2,c.cy=b.t+b.h*(1-a.domain.y[0])-h/2,a.title.text&& -1!==a.title.position.indexOf("bottom")&&(c.cy-=K(c,b)),a.scalegroup&& -1===f.indexOf(a.scalegroup)&&f.push(a.scalegroup)}M(e,f)}function M(d,k){for(var b,c,a,f=0;f<k.length;f++){var g,e,h,i=1/0,l=k[f];for(c=0;c<d.length;c++)(a=(b=d[c][0]).trace).scalegroup===l&&("pie"===a.type?g=b.r*b.r:"funnelarea"===a.type&&(a.aspectratio>1?h=(e=b.r)/a.aspectratio:e=(h=b.r)*a.aspectratio,e*=(1+a.baseratio)/2,g=e*h),i=Math.min(i,g/b.vTotal));for(c=0;c<d.length;c++)if((a=(b=d[c][0]).trace).scalegroup===l){var j=i*b.vTotal;"funnelarea"===a.type&&(j/=(1+a.baseratio)/2,j/=a.aspectratio),b.r=Math.sqrt(j)}}}function N(a,b){return[a*Math.sin(b),-a*Math.cos(b)]}function k(l,a,f){var h=l._fullLayout,d=f.trace,m=d.texttemplate,i=d.textinfo;if(!m&&i&&"none"!==i){var e,u=i.split("+"),g=function(a){return -1!==u.indexOf(a)},q=g("label"),r=g("text"),s=g("value"),t=g("percent"),n=h.separators;if(e=q?[a.label]:[],r){var o=y.getFirstFilled(d.text,a.pts);A(o)&&e.push(o)}s&&e.push(y.formatPieValue(a.v,n)),t&&e.push(y.formatPiePercent(a.v/f.vTotal,n)),a.text=e.join("<br>")}if(m){var p=b.castOption(d,a.i,"texttemplate");if(p){var c,j={label:(c=a).label,value:c.v,valueLabel:y.formatPieValue(c.v,h.separators),percent:c.v/f.vTotal,percentLabel:y.formatPiePercent(c.v/f.vTotal,h.separators),color:c.color,text:c.text,customdata:b.castOption(d,c.i,"customdata")},k=y.getFirstFilled(d.text,a.pts);(A(k)||""===k)&&(j.text=k),a.text=b.texttemplateString(p,j,l._fullLayout._d3locale,j,d._meta||{})}else a.text=""}}function l(a,b){var c=a.rotate*Math.PI/180,d=Math.cos(c),e=Math.sin(c),f=(b.left+b.right)/2,g=(b.top+b.bottom)/2;a.textX=f*d-g*e,a.textY=f*e+g*d,a.noCenter=!0}d.exports={plot:function(a,c){var p=a._context.staticPlot,d=a._fullLayout,m=d._size;w("pie",d),g(c,a),j(c,m);var x=b.makeTraceGroups(d._pielayer,c,"trace").each(function(c){var g=n.select(this),j=c[0],w=j.trace;(function(d){var b,a,f,e=d[0],h=e.r,i=e.trace,c=y.getRotationAngle(i.rotation),g=2*Math.PI/e.vTotal,j="px0",k="px1";if("counterclockwise"===i.direction){for(b=0;b<d.length&&d[b].hidden;b++);if(b===d.length)return;c+=g*d[b].v,g*=-1,j="px1",k="px0"}for(b=0,f=N(h,c);b<d.length;b++)(a=d[b]).hidden||(a[j]=f,a.startangle=c,c+=g*a.v/2,a.pxmid=N(h,c),a.midangle=c,c+=g*a.v/2,f=N(h,c),a.stopangle=c,a[k]=f,a.largeArc=a.v>e.vTotal/2?1:0,a.halfangle=Math.PI*Math.min(a.v/e.vTotal,.5),a.ring=1-i.hole,a.rInscribed=H(a,e))})(c),g.attr("stroke-linejoin","round"),g.each(function(){var z=n.select(this).selectAll("g.slice").data(c);z.enter().append("g").classed("slice",!0),z.exit().remove();var F=[[[],[]],[[],[]]],C=!1;z.each(function(g,G){if(g.hidden){n.select(this).selectAll("path,g").remove();return}g.pointNumber=g.i,g.curveNumber=w.index,F[g.pxmid[1]<0?0:1][g.pxmid[0]<0?0:1].push(g);var m=j.cx,o=j.cy,t=n.select(this),s=t.selectAll("path.surface").data([g]);if(s.enter().append("path").classed("surface",!0).style({"pointer-events":p?"none":"all"}),t.call(e,a,c),w.pull){var x=+y.castOption(w.pull,g.pts)||0;x>0&&(m+=x*g.pxmid[0],o+=x*g.pxmid[1])}function q(b,c,d,a){var e=a*(c[0]-b[0]),f=a*(c[1]-b[1]);return"a"+a*j.r+","+a*j.r+" 0 "+g.largeArc+(d?" 1 ":" 0 ")+e+","+f}g.cxFinal=m,g.cyFinal=o;var i=w.hole;if(g.v===j.vTotal){var A="M"+(m+g.px0[0])+","+(o+g.px0[1])+q(g.px0,g.pxmid,!0,1)+q(g.pxmid,g.px0,!0,1)+"Z";i?s.attr("d","M"+(m+i*g.px0[0])+","+(o+i*g.px0[1])+q(g.px0,g.pxmid,!1,i)+q(g.pxmid,g.px0,!1,i)+"Z"+A):s.attr("d",A)}else{var B=q(g.px0,g.px1,!0,1);if(i){var D=1-i;s.attr("d","M"+(m+i*g.px1[0])+","+(o+i*g.px1[1])+q(g.px1,g.px0,!1,i)+"l"+D*g.px0[0]+","+D*g.px0[1]+B+"Z")}else s.attr("d","M"+m+","+o+"l"+g.px0[0]+","+g.px0[1]+B+"Z")}k(a,g,j);var E=y.castOption(w.textposition,g.pts),z=t.selectAll("g.slicetext").data(g.text&&"none"!==E?[0]:[]);z.enter().append("g").classed("slicetext",!0),z.exit().remove(),z.each(function(){var i,k,s,x,z,A,e,q=b.ensureSingle(n.select(this),"text","",function(a){a.attr("data-notex",1)}),B=b.ensureUniformFontSize(a,"outside"===E?(i=w,k=g,s=d.font,x=y.castOption(i.outsidetextfont.color,k.pts)||y.castOption(i.textfont.color,k.pts)||s.color,z=y.castOption(i.outsidetextfont.family,k.pts)||y.castOption(i.textfont.family,k.pts)||s.family,A=y.castOption(i.outsidetextfont.size,k.pts)||y.castOption(i.textfont.size,k.pts)||s.size,{color:x,family:z,size:A}):f(w,g,d.font));q.text(g.text).attr({"class":"slicetext",transform:"","text-anchor":"middle"}).call(r.font,B).call(u.convertToTspans,a);var p=r.bBox(q.node());if("outside"===E)e=I(p,g);else if(e=h(p,g,j),"auto"===E&&e.scale<1){var H=b.ensureUniformFontSize(a,w.outsidetextfont);q.call(r.font,H),e=I(p=r.bBox(q.node()),g)}var D=e.textPosAngle,F=void 0===D?g.pxmid:N(j.r,D);if(e.targetX=m+F[0]*e.rCenter+(e.x||0),e.targetY=o+F[1]*e.rCenter+(e.y||0),l(e,p),e.outside){var t=e.targetY;g.yLabelMin=t-p.height/2,g.yLabelMid=t,g.yLabelMax=t+p.height/2,g.labelExtraX=0,g.labelExtraY=0,C=!0}e.fontSize=B.size,v(w.type,e,d),c[G].transform=e,b.setTransormAndDisplay(q,e)})});var B=n.select(this).selectAll("g.titletext").data(w.title.text?[0]:[]);if(B.enter().append("g").classed("titletext",!0),B.exit().remove(),B.each(function(){var d,c,f,g=b.ensureSingle(n.select(this),"text","",function(a){a.attr("data-notex",1)}),e=w.title.text;w._meta&&(e=b.templateString(e,w._meta)),g.text(e).attr({"class":"titletext",transform:"","text-anchor":"middle"}).call(r.font,w.title.font).call(u.convertToTspans,a),d="middle center"===w.title.position?(f=Math.sqrt((c=j).titleBox.width*c.titleBox.width+c.titleBox.height*c.titleBox.height),{x:c.cx,y:c.cy,scale:c.trace.hole*c.r*2/f,tx:0,ty:-c.titleBox.height/2+c.trace.title.font.size}):i(j,m),g.attr("transform",t(d.x,d.y)+s(Math.min(1,d.scale))+t(d.tx,d.ty))}),C&&function(h,s){var c,b,i,k,l,m,n,d,e,o,a,f,g;function p(a,b){return a.pxmid[1]-b.pxmid[1]}function q(a,b){return b.pxmid[1]-a.pxmid[1]}function r(a,d){d||(d={});var g,e,c,h,j=d.labelExtraY+(b?d.yLabelMax:d.yLabelMin),i=b?a.yLabelMin:a.yLabelMax,p=b?a.yLabelMax:a.yLabelMin,q=a.cyFinal+l(a.px0[1],a.px1[1]),f=j-i;if(f*n>0&&(a.labelExtraY=f),Array.isArray(s.pull))for(e=0;e<o.length;e++)!((c=o[e])===a||(y.castOption(s.pull,a.pts)||0)>=(y.castOption(s.pull,c.pts)||0))&&((a.pxmid[1]-c.pxmid[1])*n>0?(f=c.cyFinal+l(c.px0[1],c.px1[1])-i-a.labelExtraY)*n>0&&(a.labelExtraY+=f):(p+a.labelExtraY-q)*n>0&&(g=3*m*Math.abs(e-o.indexOf(a)),(h=c.cxFinal+k(c.px0[0],c.px1[0])+g-(a.cxFinal+a.pxmid[0])-a.labelExtraX)*m>0&&(a.labelExtraX+=h)))}for(b=0;b<2;b++)for(c=0,i=b?p:q,l=b?Math.max:Math.min,n=b?1:-1;c<2;c++){for(k=c?Math.max:Math.min,m=c?1:-1,d=h[b][c],d.sort(i),e=h[1-b][c],o=e.concat(d),f=[],a=0;a<d.length;a++)void 0!==d[a].yLabelMid&&f.push(d[a]);for(a=0,g=!1;b&&a<e.length;a++)if(void 0!==e[a].yLabelMid){g=e[a];break}for(a=0;a<f.length;a++){var j=a&&f[a-1];g&&!a&&(j=g),r(f[a],j)}}}(F,w),function(a,c){a.each(function(a){var f=n.select(this);if(!a.labelExtraX&&!a.labelExtraY){f.select("path.textline").remove();return}var j=f.select("g.slicetext text");a.transform.targetX+=a.labelExtraX,a.transform.targetY+=a.labelExtraY,b.setTransormAndDisplay(j,a.transform);var i=a.cxFinal+a.pxmid[0],d="M"+i+","+(a.cyFinal+a.pxmid[1]),g=(a.yLabelMax-a.yLabelMin)*(a.pxmid[0]<0?-1:1)/4;if(a.labelExtraX){var h=a.labelExtraX*a.pxmid[1]/a.pxmid[0],e=a.yLabelMid+a.labelExtraY-(a.cyFinal+a.pxmid[1]);Math.abs(h)>Math.abs(e)?d+="l"+e*a.pxmid[0]/a.pxmid[1]+","+e+"H"+(i+a.labelExtraX+g):d+="l"+a.labelExtraX+","+h+"v"+(e-h)+"h"+g}else d+="V"+(a.yLabelMid+a.labelExtraY)+"h"+g;b.ensureSingle(f,"path","textline").call(q.stroke,c.outsidetextfont.color).attr({"stroke-width":Math.min(2,c.outsidetextfont.size/8),d:d,fill:"none"})})}(z,w),C&&w.automargin){var A=r.bBox(g.node()),x=w.domain,G=m.w*(x.x[1]-x.x[0]),H=m.h*(x.y[1]-x.y[0]),D=(.5*G-j.r)/m.w,E=(.5*H-j.r)/m.h;o.autoMargin(a,"pie."+w.uid+".automargin",{xl:x.x[0]-D,xr:x.x[1]+D,yb:x.y[0]-E,yt:x.y[1]+E,l:Math.max(j.cx-j.r-A.left,0),r:Math.max(A.right-(j.cx+j.r),0),b:Math.max(A.bottom-(j.cy+j.r),0),t:Math.max(j.cy-j.r-A.top,0),pad:5})}})});setTimeout(function(){x.selectAll("tspan").each(function(){var a=n.select(this);a.attr("dy")&&a.attr("dy",a.attr("dy"))})},0)},formatSliceLabel:k,transformInsideText:h,determineInsideTextFont:f,positionTitleOutside:i,prerenderTitles:g,layoutAreas:j,attachFxHandlers:e,computeTransform:l}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("./style_one"),f=a("../bar/uniform_text").resizeText;b.exports=function(a){var b=a._fullLayout._pielayer.selectAll(".trace");f(a,b,"pie"),b.each(function(b){var c=b[0].trace,a=d.select(this);a.style({opacity:c.opacity}),a.selectAll("path.surface").each(function(a){d.select(this).call(e,a,c)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("./helpers").castOption;b.exports=function(c,a,f){var b=f.marker.line,g=e(b.color,a.pts)||d.defaultLine,h=e(b.width,a.pts)||0;c.style("stroke-width",h).call(d.fill,a.color).call(d.stroke,g)}},{"../../components/color":367,"./helpers":915}],922:[function(b,c,d){"use strict";var a=b("../scatter/attributes");c.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:a.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(a,c,e){"use strict";var f=a("../../../stackgl_modules").gl_pointcloud2d,g=a("../../lib/str2rgbarray"),h=a("../../plots/cartesian/autorange").findExtremes,i=a("../scatter/get_trace_color");function d(a,b){this.scene=a,this.uid=b,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=f(a.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var b=d.prototype;b.handlePick=function(b){var a=this.idToIndex[b.pointId];return{trace:this,dataCoord:b.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*a],this.pickXYData[2*a+1]]:[this.pickXData[a],this.pickYData[a]],textLabel:Array.isArray(this.textLabels)?this.textLabels[a]:this.textLabels,color:this.color,name:this.name,pointIndex:a,hoverinfo:this.hoverinfo}},b.update=function(a){this.index=a.index,this.textLabels=a.text,this.name=a.name,this.hoverinfo=a.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(a),this.color=i(a,{})},b.updateFast=function(b){var f,i,j,d,e,c,k=this.xData=this.pickXData=b.x,n=this.yData=this.pickYData=b.y,l=this.pickXYData=b.xy,x=b.xbounds&&b.ybounds,o=b.indices,a=this.bounds;if(l){if(j=l,f=l.length>>>1,x)a[0]=b.xbounds[0],a[2]=b.xbounds[1],a[1]=b.ybounds[0],a[3]=b.ybounds[1];else for(c=0;c<f;c++)d=j[2*c],e=j[2*c+1],d<a[0]&&(a[0]=d),d>a[2]&&(a[2]=d),e<a[1]&&(a[1]=e),e>a[3]&&(a[3]=e);if(o)i=o;else for(c=0,i=new Int32Array(f);c<f;c++)i[c]=c}else for(c=0,f=k.length,j=new Float32Array(2*f),i=new Int32Array(f);c<f;c++)d=k[c],e=n[c],i[c]=c,j[2*c]=d,j[2*c+1]=e,d<a[0]&&(a[0]=d),d>a[2]&&(a[2]=d),e<a[1]&&(a[1]=e),e>a[3]&&(a[3]=e);this.idToIndex=i,this.pointcloudOptions.idToIndex=i,this.pointcloudOptions.positions=j;var p=g(b.marker.color),q=g(b.marker.border.color),r=b.opacity*b.marker.opacity;p[3]*=r,this.pointcloudOptions.color=p;var m=b.marker.blend;if(null===m){var s=100;m=k.length<s||n.length<s}this.pointcloudOptions.blend=m,q[3]*=r,this.pointcloudOptions.borderColor=q;var y=b.marker.sizemin,t=Math.max(b.marker.sizemax,b.marker.sizemin);this.pointcloudOptions.sizeMin=y,this.pointcloudOptions.sizeMax=t,this.pointcloudOptions.areaRatio=b.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var u=this.scene.xaxis,v=this.scene.yaxis,w=t/2||.5;b._extremes[u._id]=h(u,[a[0],a[2]],{ppad:w}),b._extremes[v._id]=h(v,[a[1],a[3]],{ppad:w})},b.dispose=function(){this.pointcloud.dispose()},c.exports=function(c,a){var b=new d(c,a.uid);return b.update(a),b}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes");b.exports=function(b,c,f){function a(a,f){return d.coerce(b,c,e,a,f)}a("x"),a("y"),a("xbounds"),a("ybounds"),b.xy&&b.xy instanceof Float32Array&&(c.xy=b.xy),b.indices&&b.indices instanceof Int32Array&&(c.indices=b.indices),a("text"),a("marker.color",f),a("marker.opacity"),a("marker.blend"),a("marker.sizemin"),a("marker.sizemax"),a("marker.border.color",f),a("marker.border.arearatio"),c._length=null}},{"../../lib":515,"./attributes":922}],925:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("../scatter3d/calc"),plot:a("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:a("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(a,f,o){"use strict";var g=a("../../plots/font_attributes"),h=a("../../plots/attributes"),c=a("../../components/color/attributes"),b=a("../../components/fx/attributes"),i=a("../../plots/domain").attributes,d=a("../../plots/template_attributes").hovertemplateAttrs,j=a("../../components/colorscale/attributes"),k=a("../../plot_api/plot_template").templatedArray,l=a("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,e=a("../../lib/extend").extendFlat,m=a("../../plot_api/edit_types").overrideAll,n=f.exports=m({hoverinfo:e({},h.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:b.hoverlabel,domain:i({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:l("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:g({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:c.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:b.hoverlabel,hovertemplate:d({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:c.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:b.hoverlabel,hovertemplate:d({},{keys:["value","label"]}),colorscales:k("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:e(j().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");n.transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(a,f,b){"use strict";var c=a("../../plot_api/edit_types").overrideAll,g=a("../../plots/get_data").getModuleCalcData,h=a("./plot"),d=a("../../components/fx/layout_attributes"),i=a("../../lib/setcursor"),j=a("../../components/dragelement"),k=a("../../components/selections").prepSelect,l=a("../../lib"),m=a("../../registry"),e="sankey";function n(b,c){var a=b._fullData[c],e=b._fullLayout,f=e.dragmode,o="pan"===e.dragmode?"move":"crosshair",d=a._bgRect;if(d&&"pan"!==f&&"zoom"!==f){i(d,o);var g={_id:"x",c2p:l.identity,_offset:a._sankey.translateX,_length:a._sankey.width},h={_id:"y",c2p:l.identity,_offset:a._sankey.translateY,_length:a._sankey.height},n={gd:b,element:d.node(),plotinfo:{id:c,xaxis:g,yaxis:h,fillRangeItems:l.noop},subplot:c,xaxes:[g],yaxes:[h],doneFnCompleted:function(g){var h,i=b._fullData[c],j=i.node.groups.slice(),d=[];function k(c){for(var b=i._sankey.graph.nodes,a=0;a<b.length;a++)if(b[a].pointNumber===c)return b[a]}for(var e=0;e<g.length;e++){var a=k(g[e].pointNumber);if(a)if(a.group){for(var f=0;f<a.childrenNodes.length;f++)d.push(a.childrenNodes[f].pointNumber);j[a.pointNumber-i.node._count]=!1}else d.push(a.pointNumber)}h=j.filter(Boolean).concat([d]),m.call("_guiRestyle",b,{"node.groups":[h]},c)}};n.prepFn=function(a,b,c){k(a,b,c,n,f)},j.init(n)}}b.name=e,b.baseLayoutAttrOverrides=c({hoverlabel:d.hoverlabel},"plot","nested"),b.plot=function(a){var c=g(a.calcdata,e)[0];h(a,c),b.updateFx(a)},b.clean=function(f,b,g,a){var c=a._has&&a._has(e),d=b._has&&b._has(e);c&&!d&&(a._paperdiv.selectAll(".sankey").remove(),a._paperdiv.selectAll(".bgsankey").remove())},b.updateFx=function(b){for(var a=0;a<b._fullData.length;a++)n(b,a)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(a,c,d){"use strict";var e=a("strongly-connected-components"),b=a("../../lib"),f=a("../../lib/gup").wrap,g=b.isArrayOrTypedArray,h=b.isIndex,i=a("../../components/colorscale");c.exports=function(d,c){var a=function(o){var a,p,k=o.node,c=o.link,v=[],D=g(c.color),E=g(c.customdata),s={},t={},F=c.colorscales.length;for(a=0;a<F;a++){var w=c.colorscales[a],G=i.extractScale(w,{cLetter:"c"}),H=i.makeColorScaleFunc(G);t[w.label]=H}var m=0;for(a=0;a<c.value.length;a++)c.source[a]>m&&(m=c.source[a]),c.target[a]>m&&(m=c.target[a]);var l=m+1;o.node._count=l;var q=o.node.groups,d={};for(a=0;a<q.length;a++){var x=q[a];for(p=0;p<x.length;p++){var u=x[p],I=l+a;d.hasOwnProperty(u)?b.warn("Node "+u+" is already part of a group."):d[u]=I}}var r={source:[],target:[]};for(a=0;a<c.value.length;a++){var y=c.value[a],j=c.source[a],f=c.target[a];if(y>0&&h(j,l)&&h(f,l)&&(!(d.hasOwnProperty(j)&&d.hasOwnProperty(f))||d[j]!==d[f])){d.hasOwnProperty(f)&&(f=d[f]),d.hasOwnProperty(j)&&(j=d[j]),f=+f,s[j=+j]=s[f]=!0;var n="";c.label&&c.label[a]&&(n=c.label[a]);var z=null;n&&t.hasOwnProperty(n)&&(z=t[n]),v.push({pointNumber:a,label:n,color:D?c.color[a]:c.color,customdata:E?c.customdata[a]:c.customdata,concentrationscale:z,source:j,target:f,value:+y}),r.source.push(j),r.target.push(f)}}var A=l+q.length,J=g(k.color),K=g(k.customdata),B=[];for(a=0;a<A;a++)if(s[a]){var L=k.label[a];B.push({group:a>l-1,childrenNodes:[],pointNumber:a,label:L,color:J?k.color[a]:k.color,customdata:K?k.customdata[a]:k.customdata})}var C=!1;return function(f,c,d){for(var g=b.init2dArray(f,0),a=0;a<Math.min(c.length,d.length);a++)if(b.isIndex(c[a],f)&&b.isIndex(d[a],f)){if(c[a]===d[a])return!0;g[c[a]].push(d[a])}return e(g).components.some(function(a){return a.length>1})}(A,r.source,r.target)&&(C=!0),{circular:C,links:v,nodes:B,groups:q,groupLookup:d}}(c);return f({circular:a.circular,_nodes:a.nodes,_links:a.links,_groups:a.groups,_groupLookup:a.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(b,a,c){"use strict";a.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../components/color"),g=a("tinycolor2"),h=a("../../plots/domain").defaults,i=a("../../components/fx/hoverlabel_defaults"),j=a("../../plot_api/plot_template"),k=a("../../plots/array_container_defaults");function l(b,c){function a(a,f){return d.coerce(b,c,e.link.colorscales,a,f)}a("label"),a("cmin"),a("cmax"),a("colorscale")}b.exports=function(m,o,w,n){function c(a,b){return d.coerce(m,o,e,a,b)}var r,s=d.extendDeep(n.hoverlabel,m.hoverlabel),u=m.node,p=j.newContainer(o,"node");function a(a,b){return d.coerce(u,p,e.node,a,b)}a("label"),a("groups"),a("x"),a("y"),a("pad"),a("thickness"),a("line.color"),a("line.width"),a("hoverinfo",m.hoverinfo),i(u,p,a,s),a("hovertemplate");var x=n.colorway;a("color",p.label.map(function(b,a){return f.addOpacity(x[a%x.length],.8)})),a("customdata");var t=m.link||{},q=j.newContainer(o,"link");function b(a,b){return d.coerce(t,q,e.link,a,b)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",m.hoverinfo),i(t,q,b,s),b("hovertemplate");var v=.333>g(n.paper_bgcolor).getLuminance()?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",d.repeat(v,q.value.length)),b("customdata"),k(t,q,{name:"colorscales",handleItemDefaults:l}),h(o,n,c),c("orientation"),c("valueformat"),c("valuesuffix"),p.x.length&&p.y.length&&(r="freeform"),c("arrangement",r),d.coerceFont(c,"textfont",d.extendFlat({},n.font)),o._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),moduleType:"trace",name:"sankey",basePlotModule:a("./base_plot"),selectPoints:a("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(a,c,d){"use strict";var e=a("@plotly/d3"),b=a("../../lib"),f=b.numberFormat,g=a("./render"),h=a("../../components/fx"),i=a("../../components/color"),j=a("./constants").cn,k=b._;function l(a){return""!==a}function m(a,b){return a.filter(function(a){return a.key===b.traceId})}function n(a,b){e.select(a).select("path").style("fill-opacity",b),e.select(a).select("rect").style("fill-opacity",b)}function o(a){e.select(a).select("text.name").style("fill","black")}function p(a){return function(b){return -1!==a.node.sourceLinks.indexOf(b.link)|| -1!==a.node.targetLinks.indexOf(b.link)}}function q(a){return function(b){return -1!==b.node.sourceLinks.indexOf(a.link)|| -1!==b.node.targetLinks.indexOf(a.link)}}function r(c,a,b){a&&b&&m(b,a).selectAll("."+j.sankeyLink).filter(p(a)).call(t.bind(0,a,b,!1))}function s(c,a,b){a&&b&&m(b,a).selectAll("."+j.sankeyLink).filter(p(a)).call(u.bind(0,a,b,!1))}function t(a,b,d,c){var e=c.datum().link.label;c.style("fill-opacity",function(a){if(!a.link.concentrationscale)return .4}),e&&m(b,a).selectAll("."+j.sankeyLink).filter(function(a){return a.link.label===e}).style("fill-opacity",function(a){if(!a.link.concentrationscale)return .4}),d&&m(b,a).selectAll("."+j.sankeyNode).filter(q(a)).call(r)}function u(a,b,d,c){var e=c.datum().link.label;c.style("fill-opacity",function(a){return a.tinyColorAlpha}),e&&m(b,a).selectAll("."+j.sankeyLink).filter(function(a){return a.link.label===e}).style("fill-opacity",function(a){return a.tinyColorAlpha}),d&&m(b,a).selectAll(j.sankeyNode).filter(q(a)).call(s)}function v(c,d){var e=c.hoverlabel||{},a=b.nestedProperty(e,d).get();return!Array.isArray(a)&&a}c.exports=function(a,p){for(var m=a._fullLayout,q=m._paper,c=m._size,b=0;b<a._fullData.length;b++)if(a._fullData[b].visible&&a._fullData[b].type===j.sankey&&!a._fullData[b]._viewInitial){var d=a._fullData[b].node;a._fullData[b]._viewInitial={node:{groups:d.groups.slice(),x:d.x.slice(),y:d.y.slice()}}}var w=k(a,"source:")+" ",x=k(a,"target:")+" ",y=k(a,"concentration:")+" ",z=k(a,"incoming flow count:")+" ",A=k(a,"outgoing flow count:")+" ";g(a,q,p,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},{linkEvents:{hover:function(c,b,d){!1!==a._fullLayout.hovermode&&(e.select(c).call(t.bind(0,b,d,!0)),"skip"!==b.link.trace.link.hoverinfo&&(b.link.fullData=b.link.trace,a.emit("plotly_hover",{event:e.event,points:[b.link]})))},follow:function(r,d){if(!1!==a._fullLayout.hovermode){var c=d.link.trace.link;if("none"!==c.hoverinfo&&"skip"!==c.hoverinfo){for(var k=[],p=0,g=0;g<d.flow.links.length;g++){var b=d.flow.links[g];if("closest"!==a._fullLayout.hovermode||d.link.pointNumber===b.pointNumber){d.link.pointNumber===b.pointNumber&&(p=g),b.fullData=b.trace,c=d.link.trace.link;var j=s(b),q={valueLabel:f(d.valueFormat)(b.value)+d.valueSuffix};k.push({x:j[0],y:j[1],name:q.valueLabel,text:[b.label||"",w+b.source.label,x+b.target.label,b.concentrationscale?y+f("%0.2f")(b.flow.labelConcentration):""].filter(l).join("<br>"),color:v(c,"bgcolor")||i.addOpacity(b.color,1),borderColor:v(c,"bordercolor"),fontFamily:v(c,"font.family"),fontSize:v(c,"font.size"),fontColor:v(c,"font.color"),nameLength:v(c,"namelength"),textAlign:v(c,"align"),idealAlign:e.event.x<j[0]?"right":"left",hovertemplate:c.hovertemplate,hovertemplateLabels:q,eventData:[b]})}}h.loneHover(k,{container:m._hoverlayer.node(),outerContainer:m._paper.node(),gd:a,anchorIndex:p}).each(function(){var a=this;d.link.concentrationscale||n(a,.65),o(a)})}}function s(a){a.circular?(c=(a.circularPathData.leftInnerExtent+a.circularPathData.rightInnerExtent)/2,e=a.circularPathData.verticalFullExtent):(c=(a.source.x1+a.target.x0)/2,e=(a.y0+a.y1)/2);var c,e,b=[c,e];return"v"===a.trace.orientation&&b.reverse(),b[0]+=d.parent.translateX,b[1]+=d.parent.translateY,b}},unhover:function(c,b,d){!1!==a._fullLayout.hovermode&&(e.select(c).call(u.bind(0,b,d,!0)),"skip"!==b.link.trace.link.hoverinfo&&(b.link.fullData=b.link.trace,a.emit("plotly_unhover",{event:e.event,points:[b.link]})),h.loneUnhover(m._hoverlayer.node()))},select:function(d,c){var b=c.link;b.originalEvent=e.event,a._hoverdata=[b],h.click(a,{target:!0})}},nodeEvents:{hover:function(c,b,d){!1!==a._fullLayout.hovermode&&(e.select(c).call(r,b,d),"skip"!==b.node.trace.node.hoverinfo&&(b.node.fullData=b.node.trace,a.emit("plotly_hover",{event:e.event,points:[b.node]})))},follow:function(p,b){if(!1!==a._fullLayout.hovermode){var c=b.node.trace.node;if("none"!==c.hoverinfo&&"skip"!==c.hoverinfo){var q=e.select(p).select("."+j.nodeRect),g=a._fullLayout._paperdiv.node().getBoundingClientRect(),d=q.node().getBoundingClientRect(),r=d.left-2-g.left,s=d.right+2-g.left,t=d.top+d.height/4-g.top,u={valueLabel:f(b.valueFormat)(b.node.value)+b.valueSuffix};b.node.fullData=b.node.trace,a._fullLayout._calcInverseTransform(a);var i=a._fullLayout._invScaleX,w=a._fullLayout._invScaleY,k=h.loneHover({x0:i*r,x1:i*s,y:w*t,name:f(b.valueFormat)(b.node.value)+b.valueSuffix,text:[b.node.label,z+b.node.targetLinks.length,A+b.node.sourceLinks.length].filter(l).join("<br>"),color:v(c,"bgcolor")||b.tinyColorHue,borderColor:v(c,"bordercolor"),fontFamily:v(c,"font.family"),fontSize:v(c,"font.size"),fontColor:v(c,"font.color"),nameLength:v(c,"namelength"),textAlign:v(c,"align"),idealAlign:"left",hovertemplate:c.hovertemplate,hovertemplateLabels:u,eventData:[b.node]},{container:m._hoverlayer.node(),outerContainer:m._paper.node(),gd:a});n(k,.85),o(k)}}},unhover:function(c,b,d){!1!==a._fullLayout.hovermode&&(e.select(c).call(s,b,d),"skip"!==b.node.trace.node.hoverinfo&&(b.node.fullData=b.node.trace,a.emit("plotly_unhover",{event:e.event,points:[b.node]})),h.loneUnhover(m._hoverlayer.node()))},select:function(d,b,f){var c=b.node;c.originalEvent=e.event,a._hoverdata=[c],e.select(d).call(s,b,f),h.click(a,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(a,e,f){"use strict";var g=a("d3-force"),h=a("d3-interpolate").interpolateNumber,i=a("@plotly/d3"),j=a("@plotly/d3-sankey"),k=a("@plotly/d3-sankey-circular"),l=a("./constants"),m=a("tinycolor2"),n=a("../../components/color"),o=a("../../components/drawing"),c=a("../../lib"),p=c.strTranslate,q=c.strRotate,b=a("../../lib/gup"),r=b.keyFun,s=b.repeat,t=b.unwrap,u=a("../../lib/svg_text_utils"),v=a("../../registry"),d=a("../../constants/alignment"),w=d.CAP_SHIFT,x=d.LINE_SPACING;function y(e,z,A){var g=t(z),a=g.trace,h=a.domain,o="h"===a.orientation,r=a.node.pad,q=a.node.thickness,i=e.width*(h.x[1]-h.x[0]),n=e.height*(h.y[1]-h.y[0]),s=g._nodes,B=g._links,u=g.circular;(w=u?k.sankeyCircular().circularLinkGap(0):j.sankey()).iterations(l.sankeyIterations).size(o?[i,n]:[n,i]).nodeWidth(q).nodePadding(r).nodeId(function(a){return a.pointNumber}).nodes(s).links(B);var d=w();for(var v in w.nodePadding()<r&&c.warn("node.pad was reduced to ",w.nodePadding()," to fit within the figure."),g._groupLookup){var w,b,D,E,f,C=parseInt(g._groupLookup[v]);for(b=0;b<d.nodes.length;b++)if(d.nodes[b].pointNumber===C){f=d.nodes[b];break}if(f){var x={pointNumber:parseInt(v),x0:f.x0,x1:f.x1,y0:f.y0,y1:f.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};d.nodes.unshift(x),f.childrenNodes.unshift(x)}}if(!function(){for(b=0;b<d.nodes.length;b++){var e,a,c=d.nodes[b],f={};for(D=0;D<c.targetLinks.length;D++)e=(a=c.targetLinks[D]).source.pointNumber+":"+a.target.pointNumber,f.hasOwnProperty(e)||(f[e]=[]),f[e].push(a);var j=Object.keys(f);for(D=0;D<j.length;D++){var g=f[e=j[D]],h=0,i={};for(E=0;E<g.length;E++)i[(a=g[E]).label]||(i[a.label]=0),i[a.label]+=a.value,h+=a.value;for(E=0;E<g.length;E++)(a=g[E]).flow={value:h,labelConcentration:i[a.label]/h,concentration:a.value/h,links:g},a.concentrationscale&&(a.color=m(a.concentrationscale(a.flow.labelConcentration)))}var k=0;for(D=0;D<c.sourceLinks.length;D++)k+=c.sourceLinks[D].value;for(D=0;D<c.sourceLinks.length;D++)(a=c.sourceLinks[D]).concentrationOut=a.value/k;var l=0;for(D=0;D<c.targetLinks.length;D++)l+=c.targetLinks[D].value;for(D=0;D<c.targetLinks.length;D++)(a=c.targetLinks[D]).concenrationIn=a.value/l}}(),a.node.x.length&&a.node.y.length){for(b=0;b<Math.min(a.node.x.length,a.node.y.length,d.nodes.length);b++)if(a.node.x[b]&&a.node.y[b]){var p=[a.node.x[b]*i,a.node.y[b]*n];d.nodes[b].x0=p[0]-q/2,d.nodes[b].x1=p[0]+q/2;var y=d.nodes[b].y1-d.nodes[b].y0;d.nodes[b].y0=p[1]-y/2,d.nodes[b].y1=p[1]+y/2}"snap"===a.arrangement&&function(a){a.forEach(function(c){var a,d,b,e=0,f=c.length;for(c.sort(function(a,b){return a.y0-b.y0}),b=0;b<f;++b)(a=c[b]).y0>=e||(d=e-a.y0)>1e-6&&(a.y0+=d,a.y1+=d),e=a.y1+r})}(function(f){var g,e,h=f.map(function(a,b){return{x0:a.x0,index:b}}).sort(function(a,b){return a.x0-b.x0}),c=[],d=-1,i=-1/0;for(b=0;b<h.length;b++){var a=f[h[b].index];a.x0>i+q&&(d+=1,g=a.x0),i=a.x0,c[d]||(c[d]=[]),c[d].push(a),e=g-a.x0,a.x0+=e,a.x1+=e}return c}(s=d.nodes)),w.update(d)}return{circular:u,key:A,trace:a,guid:c.randstr(),horizontal:o,width:i,height:n,nodePad:a.node.pad,nodeLineColor:a.node.line.color,nodeLineWidth:a.node.line.width,linkLineColor:a.link.line.color,linkLineWidth:a.link.line.width,linkArrowLength:a.link.arrowlen,valueFormat:a.valueformat,valueSuffix:a.valuesuffix,textFont:a.textfont,translateX:h.x[0]*e.width+e.margin.l,translateY:e.height-h.y[1]*e.height+e.margin.t,dragParallel:o?n:i,dragPerpendicular:o?i:n,arrangement:a.arrangement,sankey:w,graph:d,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function z(a,b,d){var c=m(b.color),e=b.source.label+"|"+b.target.label;return b.trace=a.trace,b.curveNumber=a.trace.index,{circular:a.circular,key:e+"__"+d,traceId:a.key,pointNumber:b.pointNumber,link:b,tinyColorHue:n.tinyRGB(c),tinyColorAlpha:c.getAlpha(),linkPath:A,linkLineColor:a.linkLineColor,linkLineWidth:a.linkLineWidth,linkArrowLength:a.linkArrowLength,valueFormat:a.valueFormat,valueSuffix:a.valueSuffix,sankey:a.sankey,parent:a,interactionState:a.interactionState,flow:b.flow}}function A(){var a=.5;return function(e){var g,d,c,b,f=e.linkArrowLength;if(e.link.circular)return g=e.link,d=f,c=g.width/2,b=g.circularPathData,"top"===g.circularLinkType?"M "+(b.targetX-d)+" "+(b.targetY+c)+" L"+(b.rightInnerExtent-d)+" "+(b.targetY+c)+"A"+(b.rightLargeArcRadius+c)+" "+(b.rightSmallArcRadius+c)+" 0 0 1 "+(b.rightFullExtent-c-d)+" "+(b.targetY-b.rightSmallArcRadius)+"L"+(b.rightFullExtent-c-d)+" "+b.verticalRightInnerExtent+"A"+(b.rightLargeArcRadius+c)+" "+(b.rightLargeArcRadius+c)+" 0 0 1 "+(b.rightInnerExtent-d)+" "+(b.verticalFullExtent-c)+"L"+b.leftInnerExtent+" "+(b.verticalFullExtent-c)+"A"+(b.leftLargeArcRadius+c)+" "+(b.leftLargeArcRadius+c)+" 0 0 1 "+(b.leftFullExtent+c)+" "+b.verticalLeftInnerExtent+"L"+(b.leftFullExtent+c)+" "+(b.sourceY-b.leftSmallArcRadius)+"A"+(b.leftLargeArcRadius+c)+" "+(b.leftSmallArcRadius+c)+" 0 0 1 "+b.leftInnerExtent+" "+(b.sourceY+c)+"L"+b.sourceX+" "+(b.sourceY+c)+"L"+b.sourceX+" "+(b.sourceY-c)+"L"+b.leftInnerExtent+" "+(b.sourceY-c)+"A"+(b.leftLargeArcRadius-c)+" "+(b.leftSmallArcRadius-c)+" 0 0 0 "+(b.leftFullExtent-c)+" "+(b.sourceY-b.leftSmallArcRadius)+"L"+(b.leftFullExtent-c)+" "+b.verticalLeftInnerExtent+"A"+(b.leftLargeArcRadius-c)+" "+(b.leftLargeArcRadius-c)+" 0 0 0 "+b.leftInnerExtent+" "+(b.verticalFullExtent+c)+"L"+(b.rightInnerExtent-d)+" "+(b.verticalFullExtent+c)+"A"+(b.rightLargeArcRadius-c)+" "+(b.rightLargeArcRadius-c)+" 0 0 0 "+(b.rightFullExtent+c-d)+" "+b.verticalRightInnerExtent+"L"+(b.rightFullExtent+c-d)+" "+(b.targetY-b.rightSmallArcRadius)+"A"+(b.rightLargeArcRadius-c)+" "+(b.rightSmallArcRadius-c)+" 0 0 0 "+(b.rightInnerExtent-d)+" "+(b.targetY-c)+"L"+(b.targetX-d)+" "+(b.targetY-c)+(d>0?"L"+b.targetX+" "+b.targetY:"")+"Z":"M "+(b.targetX-d)+" "+(b.targetY-c)+" L"+(b.rightInnerExtent-d)+" "+(b.targetY-c)+"A"+(b.rightLargeArcRadius+c)+" "+(b.rightSmallArcRadius+c)+" 0 0 0 "+(b.rightFullExtent-c-d)+" "+(b.targetY+b.rightSmallArcRadius)+"L"+(b.rightFullExtent-c-d)+" "+b.verticalRightInnerExtent+"A"+(b.rightLargeArcRadius+c)+" "+(b.rightLargeArcRadius+c)+" 0 0 0 "+(b.rightInnerExtent-d)+" "+(b.verticalFullExtent+c)+"L"+b.leftInnerExtent+" "+(b.verticalFullExtent+c)+"A"+(b.leftLargeArcRadius+c)+" "+(b.leftLargeArcRadius+c)+" 0 0 0 "+(b.leftFullExtent+c)+" "+b.verticalLeftInnerExtent+"L"+(b.leftFullExtent+c)+" "+(b.sourceY+b.leftSmallArcRadius)+"A"+(b.leftLargeArcRadius+c)+" "+(b.leftSmallArcRadius+c)+" 0 0 0 "+b.leftInnerExtent+" "+(b.sourceY-c)+"L"+b.sourceX+" "+(b.sourceY-c)+"L"+b.sourceX+" "+(b.sourceY+c)+"L"+b.leftInnerExtent+" "+(b.sourceY+c)+"A"+(b.leftLargeArcRadius-c)+" "+(b.leftSmallArcRadius-c)+" 0 0 1 "+(b.leftFullExtent-c)+" "+(b.sourceY+b.leftSmallArcRadius)+"L"+(b.leftFullExtent-c)+" "+b.verticalLeftInnerExtent+"A"+(b.leftLargeArcRadius-c)+" "+(b.leftLargeArcRadius-c)+" 0 0 1 "+b.leftInnerExtent+" "+(b.verticalFullExtent-c)+"L"+(b.rightInnerExtent-d)+" "+(b.verticalFullExtent-c)+"A"+(b.rightLargeArcRadius-c)+" "+(b.rightLargeArcRadius-c)+" 0 0 1 "+(b.rightFullExtent+c-d)+" "+b.verticalRightInnerExtent+"L"+(b.rightFullExtent+c-d)+" "+(b.targetY+b.rightSmallArcRadius)+"A"+(b.rightLargeArcRadius-c)+" "+(b.rightSmallArcRadius-c)+" 0 0 1 "+(b.rightInnerExtent-d)+" "+(b.targetY+c)+"L"+(b.targetX-d)+" "+(b.targetY+c)+(d>0?"L"+b.targetX+" "+b.targetY:"")+"Z";var l=Math.abs((e.link.target.x0-e.link.source.x1)/2);f>l&&(f=l);var j=e.link.source.x1,i=e.link.target.x0-f,m=h(j,i),n=m(a),o=m(1-a),p=e.link.y0-e.link.width/2,q=e.link.y0+e.link.width/2,k=e.link.y1-e.link.width/2,r=e.link.y1+e.link.width/2,s="M"+j+","+p,t="C"+n+","+p+" "+o+","+k+" "+i+","+k,u="C"+o+","+r+" "+n+","+q+" "+j+","+q,v=f>0?"L"+(i+f)+","+(k+e.link.width/2):"";return s+t+(v+="L"+i+","+r)+u+"Z"}}function B(a,b){var d=m(b.color),f=l.nodePadAcross,g=a.nodePad/2;b.dx=b.x1-b.x0,b.dy=b.y1-b.y0;var h=b.dx,i=Math.max(.5,b.dy),e="node_"+b.pointNumber;return b.group&&(e=c.randstr()),b.trace=a.trace,b.curveNumber=a.trace.index,{index:b.pointNumber,key:e,partOfGroup:b.partOfGroup||!1,group:b.group,traceId:a.key,trace:a.trace,node:b,nodePad:a.nodePad,nodeLineColor:a.nodeLineColor,nodeLineWidth:a.nodeLineWidth,textFont:a.textFont,size:a.horizontal?a.height:a.width,visibleWidth:Math.ceil(h),visibleHeight:i,zoneX:-f,zoneY:-g,zoneWidth:h+2*f,zoneHeight:i+2*g,labelY:a.horizontal?b.dy/2+1:b.dx/2+1,left:1===b.originalLayer,sizeAcross:a.width,forceLayouts:a.forceLayouts,horizontal:a.horizontal,darkBackground:128>=d.getBrightness(),tinyColorHue:n.tinyRGB(d),tinyColorAlpha:d.getAlpha(),valueFormat:a.valueFormat,valueSuffix:a.valueSuffix,sankey:a.sankey,graph:a.graph,arrangement:a.arrangement,uniqueNodeLabelPathId:[a.guid,a.key,e].join("_"),interactionState:a.interactionState,figure:a}}function C(a){a.attr("transform",function(a){return p(a.node.x0.toFixed(3),a.node.y0.toFixed(3))})}function D(a){a.call(C)}function E(a,b){a.call(D),b.attr("d",A())}function F(a){a.attr("width",function(a){return a.node.x1-a.node.x0}).attr("height",function(a){return a.visibleHeight})}function G(a){return a.link.width>1||a.linkLineWidth>0}function H(a){return p(a.translateX,a.translateY)+(a.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function I(a,b,c){a.on(".basic",null).on("mouseover.basic",function(a){a.interactionState.dragInProgress||a.partOfGroup||(c.hover(this,a,b),a.interactionState.hovered=[this,a])}).on("mousemove.basic",function(a){a.interactionState.dragInProgress||a.partOfGroup||(c.follow(this,a),a.interactionState.hovered=[this,a])}).on("mouseout.basic",function(a){a.interactionState.dragInProgress||a.partOfGroup||(c.unhover(this,a,b),a.interactionState.hovered=!1)}).on("click.basic",function(a){a.interactionState.hovered&&(c.unhover(this,a,b),a.interactionState.hovered=!1),a.interactionState.dragInProgress||a.partOfGroup||c.select(this,a,b)})}function J(a,d,e,f){var b=i.behavior.drag().origin(function(a){return{x:a.node.x0+a.visibleWidth/2,y:a.node.y0+a.visibleHeight/2}}).on("dragstart",function(b){if("fixed"!==b.arrangement&&(c.ensureSingle(f._fullLayout._infolayer,"g","dragcover",function(a){f._fullLayout._dragCover=a}),c.raiseToTop(this),b.interactionState.dragInProgress=b.node,O(b.node),b.interactionState.hovered&&(e.nodeEvents.unhover.apply(0,b.interactionState.hovered),b.interactionState.hovered=!1),"snap"===b.arrangement)){var g=b.traceId+"|"+b.key;b.forceLayouts[g]?b.forceLayouts[g].alpha(1):K(a,g,b,f),L(a,d,b,g,f)}}).on("drag",function(b){if("fixed"!==b.arrangement){var e=i.event.x,c=i.event.y;"snap"===b.arrangement?(b.node.x0=e-b.visibleWidth/2,b.node.x1=e+b.visibleWidth/2,b.node.y0=c-b.visibleHeight/2,b.node.y1=c+b.visibleHeight/2):("freeform"===b.arrangement&&(b.node.x0=e-b.visibleWidth/2,b.node.x1=e+b.visibleWidth/2),c=Math.max(0,Math.min(b.size-b.visibleHeight/2,c)),b.node.y0=c-b.visibleHeight/2,b.node.y1=c+b.visibleHeight/2),O(b.node),"snap"!==b.arrangement&&(b.sankey.update(b.graph),E(a.filter(P(b)),d))}}).on("dragend",function(a){if("fixed"!==a.arrangement){a.interactionState.dragInProgress=!1;for(var b=0;b<a.node.childrenNodes.length;b++)a.node.childrenNodes[b].x=a.node.x,a.node.childrenNodes[b].y=a.node.y;"snap"!==a.arrangement&&N(a,f)}});a.on(".drag",null).call(b)}function K(d,b,a,e){Q(a.graph.nodes);var c=a.graph.nodes.filter(function(b){return b.originalX===a.node.originalX}).filter(function(a){return!a.partOfGroup});a.forceLayouts[b]=g.forceSimulation(c).alphaDecay(0).force("collide",g.forceCollide().radius(function(b){return b.dy/2+a.nodePad/2}).strength(1).iterations(l.forceIterations)).force("constrain",M(d,b,c,a,e)).stop()}function L(a,b,c,d,e){window.requestAnimationFrame(function g(){for(h=0;h<l.forceTicksPerFrame;h++)c.forceLayouts[d].tick();if(R(c.graph.nodes),c.sankey.update(c.graph),E(a.filter(P(c)),b),c.forceLayouts[d].alpha()>0)window.requestAnimationFrame(g);else{var h,f=c.node.originalX;c.node.x0=f-c.visibleWidth/2,c.node.x1=f+c.visibleWidth/2,N(c,e)}})}function M(a,b,c,d){return function(){for(var e=0,f=0;f<c.length;f++){var a=c[f];a===d.interactionState.dragInProgress?(a.x=a.lastDraggedX,a.y=a.lastDraggedY):(a.vx=(a.originalX-a.x)/l.forceTicksPerFrame,a.y=Math.min(d.size-a.dy/2,Math.max(a.dy/2,a.y))),e=Math.max(e,Math.abs(a.vx),Math.abs(a.vy))}!d.interactionState.dragInProgress&&e<.1&&d.forceLayouts[b].alpha()>0&&d.forceLayouts[b].alpha(0)}}function N(a,e){for(var c=[],d=[],b=0;b<a.graph.nodes.length;b++){var f=(a.graph.nodes[b].x0+a.graph.nodes[b].x1)/2,g=(a.graph.nodes[b].y0+a.graph.nodes[b].y1)/2;c.push(f/a.figure.width),d.push(g/a.figure.height)}v.call("_guiRestyle",e,{"node.x":[c],"node.y":[d]},a.trace.index).then(function(){e._fullLayout._dragCover&&e._fullLayout._dragCover.remove()})}function O(a){a.lastDraggedX=a.x0+a.dx/2,a.lastDraggedY=a.y0+a.dy/2}function P(a){return function(b){return b.node.originalX===a.node.originalX}}function Q(b){for(var a=0;a<b.length;a++)b[a].y=(b[a].y0+b[a].y1)/2,b[a].x=(b[a].x0+b[a].x1)/2}function R(b){for(var a=0;a<b.length;a++)b[a].y0=b[a].y-b[a].dy/2,b[a].y1=b[a].y0+b[a].dy,b[a].x0=b[a].x-b[a].dx/2,b[a].x1=b[a].x0+b[a].dx}e.exports=function(d,v,D,E,f){var K=d._context.staticPlot,M=!1;c.ensureSingle(d._fullLayout._infolayer,"g","first-render",function(){M=!0});var N=d._fullLayout._dragCover,L=D.filter(function(a){return t(a).trace.visible}).map(y.bind(null,E)),a=v.selectAll("."+l.cn.sankey).data(L,r);a.exit().remove(),a.enter().append("g").classed(l.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",K?"none":"auto").attr("transform",H),a.each(function(a,b){d._fullData[b]._sankey=a;var e="bgsankey-"+a.trace.uid+"-"+b;c.ensureSingle(d._fullLayout._draggers,"rect",e),d._fullData[b]._bgRect=i.select("."+e),d._fullData[b]._bgRect.style("pointer-events",K?"none":"all").attr("width",a.width).attr("height",a.height).attr("x",a.translateX).attr("y",a.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),a.transition().ease(l.ease).duration(l.duration).attr("transform",H);var k=a.selectAll("."+l.cn.sankeyLinks).data(s,r);k.enter().append("g").classed(l.cn.sankeyLinks,!0).style("fill","none");var e=k.selectAll("."+l.cn.sankeyLink).data(function(a){return a.graph.links.filter(function(a){return a.value}).map(z.bind(null,a))},r);e.enter().append("path").classed(l.cn.sankeyLink,!0).call(I,a,f.linkEvents),e.style("stroke",function(a){return G(a)?n.tinyRGB(m(a.linkLineColor)):a.tinyColorHue}).style("stroke-opacity",function(a){return G(a)?n.opacity(a.linkLineColor):a.tinyColorAlpha}).style("fill",function(a){return a.tinyColorHue}).style("fill-opacity",function(a){return a.tinyColorAlpha}).style("stroke-width",function(a){return G(a)?a.linkLineWidth:1}).attr("d",A()),e.style("opacity",function(){return d._context.staticPlot||M||N?1:0}).transition().ease(l.ease).duration(l.duration).style("opacity",1),e.exit().transition().ease(l.ease).duration(l.duration).style("opacity",0).remove();var g=a.selectAll("."+l.cn.sankeyNodeSet).data(s,r);g.enter().append("g").classed(l.cn.sankeyNodeSet,!0),g.style("cursor",function(a){switch(a.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var b=g.selectAll("."+l.cn.sankeyNode).data(function(a){var b=a.graph.nodes;return!function(b){var a,c=[];for(a=0;a<b.length;a++)b[a].originalX=(b[a].x0+b[a].x1)/2,b[a].originalY=(b[a].y0+b[a].y1)/2,-1===c.indexOf(b[a].originalX)&&c.push(b[a].originalX);for(c.sort(function(a,b){return a-b}),a=0;a<b.length;a++)b[a].originalLayerIndex=c.indexOf(b[a].originalX),b[a].originalLayer=b[a].originalLayerIndex/(c.length-1)}(b),b.map(B.bind(null,a))},r);b.enter().append("g").classed(l.cn.sankeyNode,!0).call(C).style("opacity",function(a){return(d._context.staticPlot||M)&&!a.partOfGroup?1:0}),b.call(I,a,f.nodeEvents).call(J,e,f,d),b.transition().ease(l.ease).duration(l.duration).call(C).style("opacity",function(a){return a.partOfGroup?0:1}),b.exit().transition().ease(l.ease).duration(l.duration).style("opacity",0).remove();var h=b.selectAll("."+l.cn.nodeRect).data(s);h.enter().append("rect").classed(l.cn.nodeRect,!0).call(F),h.style("stroke-width",function(a){return a.nodeLineWidth}).style("stroke",function(a){return n.tinyRGB(m(a.nodeLineColor))}).style("stroke-opacity",function(a){return n.opacity(a.nodeLineColor)}).style("fill",function(a){return a.tinyColorHue}).style("fill-opacity",function(a){return a.tinyColorAlpha}),h.transition().ease(l.ease).duration(l.duration).call(F);var j=b.selectAll("."+l.cn.nodeLabel).data(s);j.enter().append("text").classed(l.cn.nodeLabel,!0).style("cursor","default"),j.attr("data-notex",1).text(function(a){return a.node.label}).each(function(b){var a=i.select(this);o.font(a,b.textFont),u.convertToTspans(a,d)}).style("text-shadow",u.makeTextShadow(d._fullLayout.paper_bgcolor)).attr("text-anchor",function(a){return a.horizontal&&a.left?"end":"start"}).attr("transform",function(a){var d=i.select(this),e=u.lineCount(d),f=a.textFont.size*((e-1)*x-w),b=a.nodeLineWidth/2+3,c=((a.horizontal?a.visibleHeight:a.visibleWidth)-f)/2;a.horizontal&&(a.left?b=-b:b+=a.visibleWidth);var g=a.horizontal?"":"scale(-1,1)"+q(90);return p(a.horizontal?b:c,a.horizontal?c:b)+g}),j.transition().ease(l.ease).duration(l.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(b,a,c){"use strict";a.exports=function(c,d){for(var i=c.cd,e=[],f=i[0].trace,g=f._sankey.graph.nodes,b=0;b<g.length;b++){var a=g[b];if(!a.partOfGroup){var h=[(a.x0+a.x1)/2,(a.y0+a.y1)/2];"v"===f.orientation&&h.reverse(),d&&d.contains(h,!1,b,c)&&e.push({pointNumber:a.pointNumber})}}return e}},{}],935:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(a,b){for(var e=0;e<a.length;e++)a[e].i=e;d.mergeArray(b.text,a,"tx"),d.mergeArray(b.texttemplate,a,"txt"),d.mergeArray(b.hovertext,a,"htx"),d.mergeArray(b.customdata,a,"data"),d.mergeArray(b.textposition,a,"tp"),b.textfont&&(d.mergeArrayCastPositive(b.textfont.size,a,"ts"),d.mergeArray(b.textfont.color,a,"tc"),d.mergeArray(b.textfont.family,a,"tf"));var c=b.marker;if(c){d.mergeArrayCastPositive(c.size,a,"ms"),d.mergeArrayCastPositive(c.opacity,a,"mo"),d.mergeArray(c.symbol,a,"mx"),d.mergeArray(c.angle,a,"ma"),d.mergeArray(c.standoff,a,"mf"),d.mergeArray(c.color,a,"mc");var g=c.line;c.line&&(d.mergeArray(g.color,a,"mlc"),d.mergeArrayCastPositive(g.width,a,"mlw"));var f=c.gradient;f&&"none"!==f.type&&(d.mergeArray(f.type,a,"mgt"),d.mergeArray(f.color,a,"mgc"))}}},{"../../lib":515}],936:[function(a,h,p){"use strict";var c=a("../../plots/cartesian/axis_format_attributes").axisHoverFormat,i=a("../../plots/template_attributes").texttemplateAttrs,j=a("../../plots/template_attributes").hovertemplateAttrs,d=a("../../components/colorscale/attributes"),k=a("../../plots/font_attributes"),l=a("../../components/drawing/attributes").dash,m=a("../../components/drawing/attributes").pattern,n=a("../../components/drawing"),o=a("./constants"),b=a("../../lib/extend").extendFlat;function e(a){return{valType:"any",dflt:0,editType:"calc"}}function f(a){return{valType:"any",editType:"calc"}}function g(a){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}h.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:e("x"),yperiod:e("y"),xperiod0:f("x0"),yperiod0:f("y0"),xperiodalignment:g("x"),yperiodalignment:g("y"),xhoverformat:c("x"),yhoverformat:c("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:i({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:j({},{keys:o.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:b({},l,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:m,marker:b({symbol:{valType:"enumerated",values:n.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:b({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},d("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},d("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:k({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(a,b,g){"use strict";var h=a("fast-isnumeric"),i=a("../../lib"),j=a("../../plots/cartesian/axes"),k=a("../../plots/cartesian/align_period"),l=a("../../constants/numerical").BADNUM,m=a("./subtypes"),n=a("./colorscale_calc"),o=a("./arrays_to_calcdata"),p=a("./calc_selection");function c(u,a,d,e,h,i,l){var k=a._length,n=u._fullLayout,o=d._id,p=e._id,r=n._firstScatter[q(a)]===a.uid,s=(f(a,n,d,e)||{}).orientation,b=a.fill;d._minDtick=0,e._minDtick=0;var c={padded:!0},g={padded:!0};l&&(c.ppad=g.ppad=l);var t=k<2||h[0]!==h[k-1]||i[0]!==i[k-1];t&&("tozerox"===b||"tonextx"===b&&(r||"h"===s))?c.tozero=!0:(a.error_y||{}).visible||"tonexty"!==b&&"tozeroy"!==b&&(m.hasMarkers(a)||m.hasText(a))||(c.padded=!1,c.ppad=0),t&&("tozeroy"===b||"tonexty"===b&&(r||"v"===s))?g.tozero=!0:("tonextx"===b||"tozerox"===b)&&(g.padded=!1),o&&(a._extremes[o]=j.findExtremes(d,h,c)),p&&(a._extremes[p]=j.findExtremes(e,i,g))}function d(a,d){if(m.hasMarkers(a)){var c,e=a.marker,k=1.6*(a.marker.sizeref||1);if(c="area"===a.marker.sizemode?function(a){return Math.max(Math.sqrt((a||0)/k),3)}:function(a){return Math.max((a||0)/k,3)},!i.isArrayOrTypedArray(e.size))return c(e.size);var f={type:"linear"};j.setConvert(f);for(var h=f.makeCalcdata(a.marker,"size"),g=new Array(d),b=0;b<d;b++)g[b]=c(h[b]);return g}}function e(d,a){var b=q(a),c=d._firstScatter;c[b]||(c[b]=a.uid)}function q(a){var b=a.stackgroup;return a.xaxis+a.yaxis+a.type+(b?"-"+b:"")}function f(f,g,a,b){var c=f.stackgroup;if(c){var d=g._scatterStackOpts[a._id+b._id][c],e="v"===d.orientation?b:a;if("linear"===e.type||"log"===e.type)return d}}b.exports={calc:function(u,g){var A,a,q,r,G,v,s,H=u._fullLayout,w=g._xA=j.getFromId(u,g.xaxis||"x","x"),x=g._yA=j.getFromId(u,g.yaxis||"y","y"),I=w.makeCalcdata(g,"x"),J=x.makeCalcdata(g,"y"),B=k(g,w,"x",I),C=k(g,x,"y",J),y=B.vals,z=C.vals,D=g._length,b=new Array(D),K=g.ids,t=f(g,H,w,x),L=!1;e(H,g);var E="x",F="y";if(t)i.pushUnique(t.traceIndices,g._expandedIndex),(A="v"===t.orientation)?(F="s",s="x"):(E="s",s="y"),G="interpolate"===t.stackgaps;else{var Q=d(g,D);c(u,g,w,x,y,z,Q)}var R=!!g.xperiodalignment,S=!!g.yperiodalignment;for(a=0;a<D;a++){var m=b[a]={},M=h(y[a]),N=h(z[a]);M&&N?(m[E]=y[a],m[F]=z[a],R&&(m.orig_x=I[a],m.xEnd=B.ends[a],m.xStart=B.starts[a]),S&&(m.orig_y=J[a],m.yEnd=C.ends[a],m.yStart=C.starts[a])):t&&(A?M:N)?(m[s]=A?y[a]:z[a],m.gap=!0,G?(m.s=l,L=!0):m.s=0):m[E]=m[F]=l,K&&(m.id=String(K[a]))}if(o(b,g),n(u,g),p(b,g),t){for(a=0;a<b.length;)b[a][s]===l?b.splice(a,1):a++;if(i.sort(b,function(a,b){return a[s]-b[s]||a.i-b.i}),L){for(a=0;a<b.length-1&&b[a].gap;)a++;for((v=b[a].s)||(v=b[a].s=0),q=0;q<a;q++)b[q].s=v;for(r=b.length-1;r>a&&b[r].gap;)r--;for(v=b[r].s,q=b.length-1;q>r;q--)b[q].s=v;for(;a<r;)if(a++,b[a].gap){for(q=a+1;b[q].gap;)q++;for(var O=b[a-1][s],P=b[a-1].s,T=(b[q].s-P)/(b[q][s]-O);a<q;)b[a].s=P+(b[a][s]-O)*T,a++}}}return b},calcMarkerSize:d,calcAxisExpansion:c,setFirstScatter:e,getStackOpts:f}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(b,a){d.isArrayOrTypedArray(a.selectedpoints)&&d.tagSelected(b,a)}},{"../../lib":515}],939:[function(a,b,c){"use strict";var d=a("../../components/colorscale/helpers").hasColorscale,e=a("../../components/colorscale/calc"),f=a("./subtypes");b.exports=function(b,a){f.hasLines(a)&&d(a,"line")&&e(b,a,{vals:a.line.color,containerStr:"line",cLetter:"c"}),f.hasMarkers(a)&&(d(a,"marker")&&e(b,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),d(a,"marker.line")&&e(b,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(b,a,c){"use strict";a.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(a,b,c){"use strict";var d=a("./calc");function e(a,b,d,h,i,j,e){i[h]=!0;var c={i:null,gap:!0,s:0};if(c[e]=d,a.splice(b,0,c),b&&d===a[b-1][e]){var g=a[b-1];c.s=g.s,c.i=g.i,c.gap=g.gap}else j&&(c.s=f(a,b,d,e));b||(a[0].t=a[1].t,a[0].trace=a[1].trace,delete a[1].t,delete a[1].trace)}function f(d,e,f,c){var a=d[e-1],b=d[e+1];return b?a?a.s+(b.s-a.s)*(f-a[c])/(b[c]-a[c]):b.s:a.s}b.exports=function(u,A){var a,b,f,o,c,i,p,q,v,r,t,w,j,s,k,B=A.xaxis,C=A.yaxis,H=B._id+C._id,x=u._fullLayout._scatterStackOpts[H];if(x){var l=u.calcdata;for(var I in x){var g=(r=x[I]).traceIndices;if(g.length){for(t="interpolate"===r.stackgaps,w=r.groupnorm,"v"===r.orientation?(j="x",s="y"):(j="y",s="x"),k=new Array(g.length),a=0;a<k.length;a++)k[a]=!1;i=l[g[0]];var h=new Array(i.length);for(a=0;a<i.length;a++)h[a]=i[a][j];for(a=1;a<g.length;a++){for(c=l[g[a]],b=f=0;b<c.length;b++){for(p=c[b][j];p>h[f]&&f<h.length;f++)e(c,b,h[f],a,k,t,j),b++;if(p!==h[f]){for(o=0;o<a;o++)e(l[g[o]],f,p,o,k,t,j);h.splice(f,0,p)}f++}for(;f<h.length;f++)e(c,b,h[f],a,k,t,j),b++}var m=h.length;for(b=0;b<i.length;b++){for(a=1,q=i[b][s]=i[b].s;a<g.length;a++)(c=l[g[a]])[0].trace._rawLength=c[0].trace._length,c[0].trace._length=m,q+=c[b].s,c[b][s]=q;if(w)for(a=0,v=("fraction"===w?q:q/100)||1;a<g.length;a++){var y=l[g[a]][b];y[s]/=v,y.sNorm=y.s/v}}for(a=0;a<g.length;a++){var z=(c=l[g[a]])[0].trace,n=d.calcMarkerSize(z,z._rawLength),D=Array.isArray(n);if(n&&k[a]||D){var E=n;for(b=0,n=new Array(m);b<m;b++)n[b]=c[b].gap?0:D?E[c[b].i]:E}var F=new Array(m),G=new Array(m);for(b=0;b<m;b++)F[b]=c[b].x,G[b]=c[b].y;d.calcAxisExpansion(u,z,B,C,F,G,n),c[0].t.orientation=r.orientation}}}}}},{"./calc":937}],942:[function(b,a,c){"use strict";a.exports=function(e){for(var b=0;b<e.length;b++){var a=e[b];if("scatter"===a.type){var c=a.fill;if("none"!==c&&"toself"!==c&&(a.opacity=void 0,"tonexty"===c||"tonextx"===c))for(var f=b-1;f>=0;f--){var d=e[f];if("scatter"===d.type&&d.xaxis===a.xaxis&&d.yaxis===a.yaxis){d.opacity=void 0;break}}}}}},{}],943:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=a("./attributes"),g=a("./constants"),h=a("./subtypes"),i=a("./xy_defaults"),j=a("./period_defaults"),k=a("./stack_defaults"),l=a("./marker_defaults"),m=a("./line_defaults"),n=a("./line_shape_defaults"),o=a("./text_defaults"),p=a("./fillcolor_defaults"),q=a("../../lib").coercePattern;b.exports=function(c,a,s,r){function b(b,e){return d.coerce(c,a,f,b,e)}var v=i(c,a,r,b);if(v||(a.visible=!1),a.visible){j(c,a,r,b),b("xhoverformat"),b("yhoverformat");var t=k(c,a,r,b),z=!t&&v<g.PTS_LINESONLY?"lines+markers":"lines";b("text"),b("hovertext"),b("mode",z),h.hasLines(a)&&(m(c,a,s,r,b,{backoff:!0}),n(c,a,b),b("connectgaps"),b("line.simplify")),h.hasMarkers(a)&&l(c,a,s,r,b,{gradient:!0}),h.hasText(a)&&(b("texttemplate"),o(c,a,r,b));var u=[];(h.hasMarkers(a)||h.hasText(a))&&(b("cliponaxis"),b("marker.maxdisplayed"),u.push("points")),b("fill",t?t.fillDflt:"none"),"none"!==a.fill&&(p(c,a,s,b),h.hasLines(a)||n(c,a,b),q(b,"fillpattern",a.fillcolor,!1));var w=(a.line||{}).color,x=(a.marker||{}).color;("tonext"===a.fill||"toself"===a.fill)&&u.push("fills"),b("hoveron",u.join("+")||"points"),"fills"!==a.hoveron&&b("hovertemplate");var y=e.getComponentMethod("errorbars","supplyDefaults");y(c,a,w||x||s,{axis:"y"}),y(c,a,w||x||s,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(a,b)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../lib").isArrayOrTypedArray;b.exports=function(i,a,g,h){var b=!1;if(a.marker){var c=a.marker.color,f=(a.marker.line||{}).color;c&&!e(c)?b=c:f&&!e(f)&&(b=f)}h("fillcolor",d.addOpacity((a.line||{}).color||b||g,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes");b.exports=function(b,c,h){var a={},e={_fullLayout:h},f=d.getFromTrace(e,c,"x"),g=d.getFromTrace(e,c,"y");return a.xLabel=d.tickText(f,f.c2l(b.x),!0).text,a.yLabel=d.tickText(g,g.c2l(b.y),!0).text,a}},{"../../plots/cartesian/axes":566}],946:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("./subtypes");b.exports=function(a,c){if("lines"===a.mode)return(f=a.line.color)&&d.opacity(f)?f:a.fillcolor;if("none"===a.mode)return a.fill?a.fillcolor:"";var f,b,g=c.mcc||(a.marker||{}).color,h=c.mlcc||((a.marker||{}).line||{}).color;return(b=g&&d.opacity(g)?g:h&&d.opacity(h)&&(c.mlw||((a.marker||{}).line||{}).width)?h:"")?.3>d.opacity(b)?d.addOpacity(b,.3):b:(f=(a.line||{}).color)&&d.opacity(f)&&e.hasLines(a)&&a.line.width?f:a.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(a,b,d){"use strict";var c=a("../../lib"),e=a("../../components/fx"),f=a("../../registry"),g=a("./get_trace_color"),h=a("../../components/color"),i=c.fillText;b.exports=function(b,L,M,N){var q=b.cd,a=q[0].trace,w=b.xa,x=b.ya,O=w.c2p(L),P=x.c2p(M),Q=[O,P],D=a.hoveron||"",W=-1!==a.mode.indexOf("markers")?3:.5,X=!!a.xperiodalignment,Y=!!a.yperiodalignment;if(-1!==D.indexOf("points")){var R=function(a){if(X){var d=w.c2p(a.xStart),e=w.c2p(a.xEnd);return O>=Math.min(d,e)&&O<=Math.max(d,e)?0:1/0}var b=Math.max(3,a.mrc||0),f=1-1/b,c=Math.abs(w.c2p(a.x)-O);return c<b?f*c/b:c-b+f},S=function(a){if(Y){var d=x.c2p(a.yStart),e=x.c2p(a.yEnd);return P>=Math.min(d,e)&&P<=Math.max(d,e)?0:1/0}var b=Math.max(3,a.mrc||0),f=1-1/b,c=Math.abs(x.c2p(a.y)-P);return c<b?f*c/b:c-b+f},E=function(a){var b=Math.max(W,a.mrc||0),c=w.c2p(a.x)-O,d=x.c2p(a.y)-P;return Math.max(Math.sqrt(c*c+d*d)-b,1-W/b)},T=e.getDistanceFunction(N,R,S,E);if(e.getClosest(q,T,b),!1!==b.index){var d=q[b.index],F=w.c2p(d.x,!0),G=x.c2p(d.y,!0),r=d.mrc||1;b.index=d.i;var y=q[0].t.orientation,H=y&&(d.sNorm||d.s),U="h"===y?H:void 0!==d.orig_x?d.orig_x:d.x,V="v"===y?H:void 0!==d.orig_y?d.orig_y:d.y;return c.extendFlat(b,{color:g(a,d),x0:F-r,x1:F+r,xLabelVal:U,y0:G-r,y1:G+r,yLabelVal:V,spikeDistance:E(d),hovertemplate:a.hovertemplate}),i(d,a,b),f.getComponentMethod("errorbars","hoverInfo")(d,a,b),[b]}}if(-1!==D.indexOf("fills")&&a._polygons){var j,k,s,l,I,z,J,m,t,K=a._polygons,A=[],B=!1,n=1/0,o=-1/0,u=1/0,v=-1/0;for(j=0;j<K.length;j++)(s=K[j]).contains(Q)&&(B=!B,A.push(s),u=Math.min(u,s.ymin),v=Math.max(v,s.ymax));if(B){var p=((u=Math.max(u,0))+(v=Math.min(v,x._length)))/2;for(j=0;j<A.length;j++)for(k=1,l=A[j].pts;k<l.length;k++)m=l[k-1][1],t=l[k][1],m>p!=t>=p&&(z=l[k-1][0],J=l[k][0],t-m&&(n=Math.min(n,I=z+(J-z)*(p-m)/(t-m)),o=Math.max(o,I)));n=Math.max(n,0),o=Math.min(o,w._length);var C=h.defaultLine;return h.opacity(a.fillcolor)?C=a.fillcolor:h.opacity((a.line||{}).color)&&(C=a.line.color),c.extendFlat(b,{distance:b.maxHoverDistance,x0:n,x1:o,y0:p,y1:p,color:C,hovertemplate:!1}),delete b.index,a.text&&!Array.isArray(a.text)?b.text=String(a.text):b.text=a.name,[b]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(a,c,d){"use strict";var b=a("./subtypes");c.exports={hasLines:b.hasLines,hasMarkers:b.hasMarkers,hasText:b.hasText,isBubble:b.isBubble,attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("./cross_trace_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./cross_trace_calc"),arraysToCalcdata:a("./arrays_to_calcdata"),plot:a("./plot"),colorbar:a("./marker_colorbar"),formatLabels:a("./format_labels"),style:a("./style").style,styleOnSelect:a("./style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(a,b,c){"use strict";var d=a("../../lib").isArrayOrTypedArray,e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults");b.exports=function(c,i,g,j,a,b){b||(b={});var h=(c.marker||{}).color;(a("line.color",g),e(c,"line"))?f(c,i,j,a,{prefix:"line.",cLetter:"c"}):a("line.color",!d(h)&&h||g),a("line.width"),b.noDash||a("line.dash"),b.backoff&&a("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(a,e,f){"use strict";var g=a("../../components/drawing"),b=a("../../constants/numerical"),h=b.BADNUM,c=b.LOG_CLIP,i=c+.5,j=c-.5,d=a("../../lib"),k=d.segmentsIntersect,l=d.constrain,m=a("./constants");e.exports=function(N,n){var a,e,r,b,q,c,z,s,A,t,O,P,B,C,D,U,an,ao,ap,aq,ad,ae,E,ar,F,Q=n.trace||{},V=n.xaxis,W=n.yaxis,as="log"===V.type,at="log"===W.type,X=V._length,Y=W._length,af=n.backoff,ag=Q.marker,Z=n.connectGaps,au=n.baseTolerance,f=n.shape,ah="linear"===f,ai=Q.fill&&"none"!==Q.fill,p=[],aj=m.minTolerance,G=N.length,ak=new Array(G),H=0;function I(d){var a=N[d];if(!a)return!1;var b=n.linearized?V.l2p(a.x):V.c2p(a.x),c=n.linearized?W.l2p(a.y):W.c2p(a.y);if(b===h){if(as&&(b=V.c2p(a.x,!0)),b===h)return!1;at&&c===h&&(b*=Math.abs(V._m*Y*(V._m>0?i:j)/(W._m*X*(W._m>0?i:j)))),b*=1e3}if(c===h){if(at&&(c=W.c2p(a.y,!0)),c===h)return!1;c*=1e3}return[b,c]}function av(c,d,j,k){var a=j-c,b=k-d,e=.5-c,f=.5-d,g=a*a+b*b,h=a*e+b*f;if(h>0&&h<g){var i=e*b-f*a;if(i*i<g)return!0}}function $(e,d){var b=e[0]/X,c=e[1]/Y,a=Math.max(0,-b,b-1,-c,c-1);return a&& void 0!==an&&av(b,c,an,ao)&&(a=0),a&&d&&av(b,c,d[0]/X,d[1]/Y)&&(a=0),(1+m.toleranceGrowth*a)*au}function al(a,b){var c=a[0]-b[0],d=a[1]-b[1];return Math.sqrt(c*c+d*d)}var J=m.maxScreensAway,u=-X*J,v=X*(1+J),w=-Y*J,x=Y*(1+J),aw=[[u,w,v,w],[v,w,v,x],[v,x,u,x],[u,x,u,w]];function ax(a){if(a[0]<u||a[0]>v||a[1]<w||a[1]>x)return[l(a[0],u,v),l(a[1],w,x)]}function ay(a,b){return a[0]===b[0]&&(a[0]===u||a[0]===v)||a[1]===b[1]&&(a[1]===w||a[1]===x)||void 0}function _(a,b,c){return function(h,i){var k,e=ax(h),f=ax(i),g=[];if(e&&f&&ay(e,f))return g;e&&g.push(e),f&&g.push(f);var j=2*d.constrain((h[a]+i[a])/2,b,c)-((e||h)[a]+(f||i)[a]);return j&&(k=e&&f?j>0==e[a]>f[a]?e:f:e||f,k[a]+=j),g}}function am(a){var b=a[0],c=a[1],d=b===ak[H-1][0],e=c===ak[H-1][1];if(!d||!e)if(H>1){var f=b===ak[H-2][0],g=c===ak[H-2][1];d&&(b===u||b===v)&&f?g?H--:ak[H-1]=a:e&&(c===w||c===x)&&g?f?H--:ak[H-1]=a:ak[H++]=a}else ak[H++]=a}function az(a){ak[H-1][0]!==a[0]&&ak[H-1][1]!==a[1]&&am([ad,ae]),am(a),E=null,ad=ae=0}"linear"===f||"spline"===f?F=function(c,g){for(var b=[],e=0,f=0;f<4;f++){var d=aw[f],a=k(c[0],c[1],g[0],g[1],d[0],d[1],d[2],d[3]);a&&(!e||Math.abs(a.x-b[0][0])>1||Math.abs(a.y-b[0][1])>1)&&(a=[a.x,a.y],e&&al(a,c)<al(b[0],c)?b.unshift(a):b.push(a),e++)}return b}:"hv"===f||"vh"===f?F=function(d,e){var c=[],a=ax(d),b=ax(e);return a&&b&&ay(a,b)||(a&&c.push(a),b&&c.push(b)),c}:"hvh"===f?F=_(0,u,v):"vhv"===f&&(F=_(1,w,x));var aA=d.isArrayOrTypedArray(ag);function o(b){if(b&&af&&(b.i=a,b.d=N,b.trace=Q,b.marker=aA?ag[b.i]:ag,b.backoff=af),an=b[0]/X,ao=b[1]/Y,ap=b[0]<u?u:b[0]>v?v:0,aq=b[1]<w?w:b[1]>x?x:0,ap||aq){if(H)if(E){var c,d,e,f,g=F(E,b);g.length>1&&(az(g[0]),ak[H++]=g[1])}else ar=F(ak[H-1],b)[0],ak[H++]=ar;else ak[H++]=[ap||b[0],aq||b[1]];var h=ak[H-1];ap&&aq&&(h[0]!==ap||h[1]!==aq)?(E&&(ad!==ap&&ae!==aq?ad&&ae?am((c=E,e=(d=b)[0]-c[0],f=(d[1]-c[1])/e,(c[1]*d[0]-d[1]*c[0])/e>0?[f>0?u:v,x]:[f>0?v:u,w])):am([ad||ap,ae||aq]):ad&&ae&&am([ad,ae])),am([ap,aq])):ad-ap&&ae-aq&&am([ap||ad,aq||ae]),E=b,ad=ap,ae=aq}else E&&az(F(E,b)[0]),ak[H++]=b}for(a=0;a<G;a++)if(e=I(a)){for(H=0,E=null,o(e),a++;a<G;a++){if(!(b=I(a))){if(Z)continue;break}if(!ah||!n.simplify){o(b);continue}var K=I(a+1);if(t=al(b,e),!(!(ai&&(0===H||H===G-1))&&t<$(b,K)*aj)){for(s=[(b[0]-e[0])/t,(b[1]-e[1])/t],q=e,O=t,P=C=D=0,z=!1,r=b,a++;a<N.length;a++){if(c=K,K=I(a+1),!c){if(Z)continue;break}if(C=Math.min(C,U=(A=[c[0]-e[0],c[1]-e[1]])[0]*s[1]-A[1]*s[0]),D=Math.max(D,U),D-C>$(c,K))break;r=c,(B=A[0]*s[0]+A[1]*s[1])>O?(O=B,b=c,z=!1):B<P&&(P=B,q=c,z=!0)}if(z?(o(b),r!==q&&o(q)):(q!==e&&o(q),r!==b&&o(b)),o(r),a>=N.length||!c)break;o(c),e=c}}E&&am([ad||E[0],ae||E[1]]),p.push(ak.slice(0,H))}var aa=f.slice(f.length-1);if(af&&"h"!==aa&&"v"!==aa){for(var ab=!1,R=-1,S=[],y=0;y<p.length;y++)for(var L=0;L<p[y].length-1;L++){var ac=p[y][L],T=p[y][L+1],M=g.applyBackoff(T,ac);(M[0]!==T[0]||M[1]!==T[1])&&(ab=!0),S[R+1]||(R++,S[R]=[ac,[M[0],M[1]]])}return ab?S:p}return p}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(b,a,c){"use strict";a.exports=function(b,c,a){"spline"===a("line.shape")&&a("line.smoothing")}},{}],952:[function(b,a,c){"use strict";var d={tonextx:1,tonexty:1,tonext:1};a.exports=function(o,p,i){var a,b,c,f,e,j={},l=!1,m=-1,g=0,k=-1;for(b=0;b<i.length;b++)(c=(a=i[b][0].trace).stackgroup||"")?c in j?e=j[c]:(e=j[c]=g,g++):a.fill in d&&k>=0?e=k:(e=k=g,g++),e<m&&(l=!0),a._groupIndex=m=e;var h=i.slice();l&&h.sort(function(c,d){var a=c[0].trace,b=d[0].trace;return a._groupIndex-b._groupIndex||a.index-b.index});var n={};for(b=0;b<h.length;b++)c=(a=h[b][0].trace).stackgroup||"",!0===a.visible?(a._nexttrace=null,a.fill in d&&(f=n[c],a._prevtrace=f||null,f&&(f._nexttrace=a)),a._ownfill=a.fill&&("tozero"===a.fill.substr(0,6)||"toself"===a.fill||"to"===a.fill.substr(0,2)&&!a._prevtrace),n[c]=a):a._prevtrace=a._nexttrace=a._ownfill=null;return h}},{}],953:[function(a,b,c){"use strict";var d=a("fast-isnumeric");b.exports=function(c,b){b||(b=2);var a=c.marker,e=a.sizeref||1,f=a.sizemin||0,g="area"===a.sizemode?function(a){return Math.sqrt(a/e)}:function(a){return a/e};return function(c){var a=g(c/b);return d(a)&&a>0?Math.max(a,f):0}}},{"fast-isnumeric":190}],954:[function(b,a,c){"use strict";a.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../components/colorscale/helpers").hasColorscale,f=a("../../components/colorscale/defaults"),g=a("./subtypes");b.exports=function(c,j,k,l,a,b){var i=g.isBubble(c),h=(c.line||{}).color;b=b||{},h&&(k=h),a("marker.symbol"),a("marker.opacity",i?.7:1),a("marker.size"),b.noAngle||(a("marker.angle"),b.noAngleRef||a("marker.angleref"),b.noStandOff||a("marker.standoff")),a("marker.color",k),e(c,"marker")&&f(c,j,l,a,{prefix:"marker.",cLetter:"c"}),b.noSelect||(a("selected.marker.color"),a("unselected.marker.color"),a("selected.marker.size"),a("unselected.marker.size")),b.noLine||(a("marker.line.color",h&&!Array.isArray(h)&&j.marker.color!==h?h:i?d.background:d.defaultLine),e(c,"marker.line")&&f(c,j,l,a,{prefix:"marker.line.",cLetter:"c"}),a("marker.line.width",i?1:0)),i&&(a("marker.sizeref"),a("marker.sizemin"),a("marker.sizemode")),b.gradient&&"none"!==a("marker.gradient.type")&&a("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(a,b,c){"use strict";var d=a("../../lib").dateTick0,e=a("../../constants/numerical").ONEWEEK;function f(b,a){return b%e==0?d(a,1):d(a,0)}b.exports=function(g,c,h,a,b){if(b||(b={x:!0,y:!0}),b.x){var d=a("xperiod");d&&(a("xperiod0",f(d,c.xcalendar)),a("xperiodalignment"))}if(b.y){var e=a("yperiod");e&&(a("yperiod0",f(e,c.ycalendar)),a("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(a,c,d){"use strict";var e=a("@plotly/d3"),f=a("../../registry"),b=a("../../lib"),g=b.ensureSingle,h=b.identity,i=a("../../components/drawing"),j=a("./subtypes"),k=a("./line_points"),l=a("./link_traces"),m=a("../../lib/polygon").tester;function n(d,O,q,l,P,Q,C){o(d,O,q,l,P);var v,r,n,V,W,H,I,R,w,D,x,J,X=!!C&&C.duration>0;function s(a){return X?a.transition():a}var K=q.xaxis,L=q.yaxis,a=l[0].trace,p=a.line,t=e.select(Q),S=g(t,"g","errorbars"),T=g(t,"g","lines"),E=g(t,"g","points"),F=g(t,"g","text");if(f.getComponentMethod("errorbars","plot")(d,S,q,C),!0===a.visible){s(t).style("opacity",a.opacity);var u=a.fill.charAt(a.fill.length-1);"x"!==u&&"y"!==u&&(u=""),l[0][q.isRangePlot?"nodeRangePlot3":"node3"]=t;var z="",M=[],A=a._prevtrace;A&&(z=A._prevRevpath||"",n=A._nextFill,M=A._polygons);var y="",U="",c=[],G=b.noop;if(r=a._ownFill,j.hasLines(a)||"none"!==a.fill){for(n&&n.datum(l),-1!==["hv","vh","hvh","vhv"].indexOf(p.shape)?(H=i.steps(p.shape),I=i.steps(p.shape.split("").reverse().join(""))):H=I="spline"===p.shape?function(a){var b=a[a.length-1];return a.length>1&&a[0][0]===b[0]&&a[0][1]===b[1]?i.smoothclosed(a.slice(1),p.smoothing):i.smoothopen(a,p.smoothing)}:function(a){return"M"+a.join("L")},R=function(a){return I(a.reverse())},c=k(l,{xaxis:K,yaxis:L,trace:a,connectGaps:a.connectgaps,baseTolerance:Math.max(p.width||1,3)/4,shape:p.shape,backoff:p.backoff,simplify:p.simplify,fill:a.fill}),J=a._polygons=new Array(c.length),v=0;v<c.length;v++)a._polygons[v]=m(c[v]);c.length&&(w=c[0][0],D=c[c.length-1],x=D[D.length-1]),G=function(b){return function(c){if(V=H(c),W=R(c),y?u?(y+="L"+V.substr(1),U=W+("L"+U.substr(1))):(y+="Z"+V,U=W+"Z"+U):(y=V,U=W),j.hasLines(a)&&c.length>1){var d=e.select(this);if(d.datum(l),b)s(d.style("opacity",0).attr("d",V).call(i.lineGroupStyle)).style("opacity",1);else{var f=s(d);f.attr("d",V),i.singleLineStyle(l,f)}}}}}var B=T.selectAll(".js-line").data(c);s(B.exit()).style("opacity",0).remove(),B.each(G(!1)),B.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(i.lineGroupStyle).each(G(!0)),i.setClipUrl(B,q.layerClipId,d),c.length?(r?(r.datum(l),w&&x&&(u?("y"===u?w[1]=x[1]=L.c2p(0,!0):"x"===u&&(w[0]=x[0]=K.c2p(0,!0)),s(r).attr("d","M"+x+"L"+w+"L"+y.substr(1)).call(i.singleFillStyle,d)):s(r).attr("d",y+"Z").call(i.singleFillStyle,d))):n&&("tonext"===a.fill.substr(0,6)&&y&&z?("tonext"===a.fill?s(n).attr("d",y+"Z"+z+"Z").call(i.singleFillStyle,d):s(n).attr("d",y+"L"+z.substr(1)+"Z").call(i.singleFillStyle,d),a._polygons=a._polygons.concat(M)):(Y(n),a._polygons=null)),a._prevRevpath=U,a._prevPolygons=J):(r?Y(r):n&&Y(n),a._polygons=a._prevRevpath=a._prevPolygons=null),E.datum(l),F.datum(l),function(p,r,t){var a,w,u,b=t[0].trace,f=j.hasMarkers(b),k=j.hasText(b),l=function(a){if(a.ids)return aa}(b),m=ab,n=ab;if(f||k){var c=h,g=b.stackgroup,o=g&&"infer zero"===d._fullLayout._scatterStackOpts[K._id+L._id][g].stackgaps;b.marker.maxdisplayed||b._needsCull?c=o?$:Z:g&&!o&&(c=_),f&&(m=c),k&&(n=c)}var v=(a=p.selectAll("path.point").data(m,l)).enter().append("path").classed("point",!0);X&&v.call(i.pointStyle,b,d).call(i.translatePoints,K,L).style("opacity",0).transition().style("opacity",1),a.order(),f&&(u=i.makePointStyleFns(b)),a.each(function(a){var f=e.select(this),c=s(f);(w=i.translatePoint(a,c,K,L))?(i.singlePointStyle(a,c,b,u,d),q.layerClipId&&i.hideOutsideRangePoint(a,c,K,L,b.xcalendar,b.ycalendar),b.customdata&&f.classed("plotly-customdata",null!==a.data&& void 0!==a.data)):c.remove()}),X?a.exit().transition().style("opacity",0).remove():a.exit().remove(),(a=r.selectAll("g").data(n,l)).enter().append("g").classed("textpoint",!0).append("text"),a.order(),a.each(function(c){var a=e.select(this),d=s(a.select("text"));(w=i.translatePoint(c,d,K,L))?q.layerClipId&&i.hideOutsideRangePoint(c,a,K,L,b.xcalendar,b.ycalendar):a.remove()}),a.selectAll("text").call(i.textPointStyle,b,d).each(function(a){var b=K.c2p(a.x),c=L.c2p(a.y);e.select(this).selectAll("tspan.line").each(function(){s(e.select(this)).attr({x:b,y:c})})}),a.exit().remove()}(E,F,l);var N=!1===a.cliponaxis?null:q.layerClipId;i.setClipUrl(E,N,d),i.setClipUrl(F,N,d)}function Y(a){s(a).attr("d","M0,0Z")}function Z(a){return a.filter(function(a){return!a.gap&&a.vis})}function $(a){return a.filter(function(a){return a.vis})}function _(a){return a.filter(function(a){return!a.gap})}function aa(a){return a.id}function ab(){return!1}}function o(n,o,c,a,m){var d=c.xaxis,f=c.yaxis,p=e.extent(b.simpleMap(d.range,d.r2c)),q=e.extent(b.simpleMap(f.range,f.r2c)),g=a[0].trace;if(j.hasMarkers(g)){var h=g.marker.maxdisplayed;if(0!==h){var i=a.filter(function(a){return a.x>=p[0]&&a.x<=p[1]&&a.y>=q[0]&&a.y<=q[1]}),k=Math.ceil(i.length/h),l=0;m.forEach(function(b,c){var a=b[0].trace;j.hasMarkers(a)&&a.marker.maxdisplayed>0&&c<o&&l++});var r=Math.round(l*k/3+Math.floor(l/3)*k/7.1);a.forEach(function(a){delete a.vis}),i.forEach(function(a,b){0===Math.round((b+r)%k)&&(a.vis=!0)})}}}c.exports=function(c,d,k,f,a,j){var b,m,o=!!a&&a.duration>0,p=l(c,d,k);((b=f.selectAll("g.trace").data(p,function(a){return a[0].trace.uid})).enter().append("g").attr("class",function(a){return"trace scatter trace"+a[0].trace.uid}).style("stroke-miterlimit",2),b.order(),function(b,a,c){a.each(function(k){var f=g(e.select(this),"g","fills");i.setClipUrl(f,c.layerClipId,b);var j=k[0].trace,a=[];j._ownfill&&a.push("_ownFill"),j._nexttrace&&a.push("_nextFill");var d=f.selectAll("g").data(a,h);d.enter().append("g"),d.exit().each(function(a){j[a]=null}).remove(),d.order().each(function(a){j[a]=g(e.select(this),"path","js-fill")})})}(c,b,d),o)?(j&&(m=j()),e.transition().duration(a.duration).ease(a.easing).each("end",function(){m&&m()}).each("interrupt",function(){m&&m()}).each(function(){f.selectAll("g.trace").each(function(b,e){n(c,e,d,b,p,this,a)})})):b.each(function(b,e){n(c,e,d,b,p,this,a)}),a||b.exit().remove(),f.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(a,b,c){"use strict";var d=a("./subtypes");b.exports=function(e,f){var a,b,g,h,c=e.cd,i=e.xaxis,j=e.yaxis,k=[],l=c[0].trace;if(!d.hasMarkers(l)&&!d.hasText(l))return[];if(!1===f)for(a=0;a<c.length;a++)c[a].selected=0;else for(a=0;a<c.length;a++)b=c[a],g=i.c2p(b.x),h=j.c2p(b.y),null!==b.i&&f.contains([g,h],!1,a,e)?(k.push({pointNumber:b.i,x:i.c2d(b.x),y:j.c2d(b.y)}),b.selected=1):b.selected=0;return k}},{"./subtypes":961}],959:[function(b,a,c){"use strict";var d=["orientation","groupnorm","stackgaps"];a.exports=function(q,c,r,k){var l=r._scatterStackOpts,f=k("stackgroup");if(f){var m=c.xaxis+c.yaxis,e=l[m];e||(e=l[m]={});var a=e[f],g=!1;a?a.traces.push(c):(a=e[f]={traceIndices:[],traces:[c]},g=!0);for(var s={orientation:c.x&&!c.y?"h":"v"},h=0;h<d.length;h++){var b=d[h],n=b+"Found";if(!a[n]){var o=void 0!==q[b],p="orientation"===b;if((o||g)&&(a[b]=k(b,s[b]),p&&(a.fillDflt="h"===a[b]?"tonextx":"tonexty"),o&&(a[n]=!0,!g&&(delete a.traces[0][b],p))))for(var i=0;i<a.traces.length-1;i++){var j=a.traces[i];j._input.fill!==j.fill&&(j.fill=a.fillDflt)}}}return a}}},{}],960:[function(a,b,e){"use strict";var f=a("@plotly/d3"),g=a("../../components/drawing"),h=a("../../registry");function c(a,b,c){g.pointStyle(a.selectAll("path.point"),b,c)}function d(a,b,c){g.textPointStyle(a.selectAll("text"),b,c)}b.exports={style:function(b){var a=f.select(b).selectAll("g.trace.scatter");a.style("opacity",function(a){return a[0].trace.opacity}),a.selectAll("g.points").each(function(a){c(f.select(this),a.trace||a[0].trace,b)}),a.selectAll("g.text").each(function(a){d(f.select(this),a.trace||a[0].trace,b)}),a.selectAll("g.trace path.js-line").call(g.lineGroupStyle),a.selectAll("g.trace path.js-fill").call(g.fillGroupStyle,b),h.getComponentMethod("errorbars","style")(a)},stylePoints:c,styleText:d,styleOnSelect:function(e,f,b){var a=f[0].trace;a.selectedpoints?(g.selectedPointStyle(b.selectAll("path.point"),a),g.selectedTextStyle(b.selectAll("text"),a)):(c(b,a,e),d(b,a,e))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(a,b,c){"use strict";var d=a("../../lib");b.exports={hasLines:function(a){return a.visible&&a.mode&& -1!==a.mode.indexOf("lines")},hasMarkers:function(a){return a.visible&&(a.mode&& -1!==a.mode.indexOf("markers")||"splom"===a.type)},hasText:function(a){return a.visible&&a.mode&& -1!==a.mode.indexOf("text")},isBubble:function(a){return d.isPlainObject(a.marker)&&d.isArrayOrTypedArray(a.marker.size)}}},{"../../lib":515}],962:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(e,f,c,a,b){b=b||{},a("textposition"),d.coerceFont(a,"textfont",c.font),b.noSelect||(a("selected.textfont.color"),a("unselected.textfont.color"))}},{"../../lib":515}],963:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry");b.exports=function(i,f,j,a){var b,g=a("x"),c=a("y");if(e.getComponentMethod("calendars","handleTraceDefaults")(i,f,["x","y"],j),g){var h=d.minRowLength(g);c?b=Math.min(h,d.minRowLength(c)):(b=h,a("y0"),a("dy"))}else{if(!c)return 0;b=d.minRowLength(c),a("x0"),a("dx")}return f._length=b,b}},{"../../lib":515,"../../registry":647}],964:[function(c,k,t){"use strict";var a=c("../scatter/attributes"),e=c("../../components/colorscale/attributes"),f=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=c("../../plots/template_attributes").hovertemplateAttrs,m=c("../../plots/template_attributes").texttemplateAttrs,i=c("../../plots/attributes"),n=c("../../constants/gl3d_dashes"),o=c("../../constants/gl3d_markers"),b=c("../../lib/extend").extendFlat,p=c("../../plot_api/edit_types").overrideAll,j=c("../../lib/sort_object_keys"),q=a.line,d=a.marker,r=d.line,s=b({width:q.width,dash:{valType:"enumerated",values:j(n),dflt:"solid"}},e("line"));function g(a){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var h=k.exports=p({x:a.x,y:a.y,z:{valType:"data_array"},text:b({},a.text,{}),texttemplate:m({},{}),hovertext:b({},a.hovertext,{}),hovertemplate:l(),xhoverformat:f("x"),yhoverformat:f("y"),zhoverformat:f("z"),mode:b({},a.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:g("x"),y:g("y"),z:g("z")},connectgaps:a.connectgaps,line:s,marker:b({symbol:{valType:"enumerated",values:j(o),dflt:"circle",arrayOk:!0},size:b({},d.size,{dflt:8}),sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:b({},d.opacity,{arrayOk:!1}),colorbar:d.colorbar,line:b({width:b({},r.width,{arrayOk:!1})},e("marker.line"))},e("marker")),textposition:b({},a.textposition,{dflt:"top center"}),textfont:{color:a.textfont.color,size:a.textfont.size,family:b({},a.textfont.family,{arrayOk:!1})},opacity:i.opacity,hoverinfo:b({},i.hoverinfo)},"calc","nested");h.x.editType=h.y.editType=h.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(a,b,c){"use strict";var d=a("../scatter/arrays_to_calcdata"),e=a("../scatter/colorscale_calc");b.exports=function(c,a){var b=[{x:!1,y:!1,trace:a,t:{}}];return d(b,a),e(c,a),b}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(a,b,c){"use strict";var d=a("../../registry");function e(c,g,e,a){if(!g||!g.visible)return null;for(var l=d.getComponentMethod("errorbars","makeComputeError")(g),h=new Array(c.length),b=0;b<c.length;b++){var f=l(+c[b],b);if("log"===a.type){var j=a.c2l(c[b]),i=c[b]-f[0],m=c[b]+f[1];if(h[b]=[(a.c2l(i,!0)-j)*e,(a.c2l(m,!0)-j)*e],i>0){var k=a.c2l(i);a._lowerLogErrorBound||(a._lowerLogErrorBound=k),a._lowerErrorBound=Math.min(a._lowerLogErrorBound,k)}}else h[b]=[-f[0]*e,f[1]*e]}return h}b.exports=function(a,f,g){var h=[e(a.x,a.error_x,f[0],g.xaxis),e(a.y,a.error_y,f[1],g.yaxis),e(a.z,a.error_z,f[2],g.zaxis)],i=function(b){for(var a=0;a<b.length;a++)if(b[a])return b[a].length;return 0}(h);if(0===i)return null;for(var j=new Array(i),c=0;c<i;c++){for(var k=[[0,0,0],[0,0,0]],b=0;b<3;b++)if(h[b])for(var d=0;d<2;d++)k[d][b]=h[b][c][d];j[c]=k}return j}},{"../../registry":647}],967:[function(a,c,e){"use strict";var f=a("../../../stackgl_modules").gl_line3d,g=a("../../../stackgl_modules").gl_scatter3d,h=a("../../../stackgl_modules").gl_error3d,i=a("../../../stackgl_modules").gl_mesh3d,j=a("../../../stackgl_modules").delaunay_triangulate,k=a("../../lib"),l=a("../../lib/str2rgbarray"),m=a("../../lib/gl_format_color").formatColor,n=a("../scatter/make_bubble_size_func"),o=a("../../constants/gl3d_dashes"),p=a("../../constants/gl3d_markers"),q=a("../../plots/cartesian/axes"),r=a("../../components/fx/helpers").appendArrayPointValue,s=a("./calc_errors");function d(a,b){this.scene=a,this.uid=b,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var b=d.prototype;function t(a){return null==a?0:a.indexOf("left")> -1?-1:a.indexOf("right")> -1?1:0}function u(a){return null==a?0:a.indexOf("top")> -1?-1:a.indexOf("bottom")> -1?1:0}function v(a,b){return b(4*a)}function w(a){return p[a]}function x(c,e,d,f,g){var b=null;if(k.isArrayOrTypedArray(c)){b=[];for(var a=0;a<e;a++)void 0===c[a]?b[a]=f:b[a]=d(c[a],g)}else b=d(c,k.identity);return b}function y(a){if(k.isArrayOrTypedArray(a)){var b=a[0];return k.isArrayOrTypedArray(b)&&(a=b),"rgb("+a.slice(0,3).map(function(a){return Math.round(255*a)})+")"}return null}function z(a){return k.isArrayOrTypedArray(a)?4===a.length&&"number"==typeof a[0]?y(a):a.map(y):null}b.handlePick=function(a){if(a.object&&(a.object===this.linePlot||a.object===this.delaunayMesh||a.object===this.textMarkers||a.object===this.scatterPlot)){var b=a.index=a.data.index;return a.object.highlight&&a.object.highlight(null),this.scatterPlot&&(a.object=this.scatterPlot,this.scatterPlot.highlight(a.data)),a.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[b]||0===this.textLabels[b])&&(a.textLabel=this.textLabels[b]):a.textLabel=this.textLabels),a.traceCoordinate=[this.data.x[b],this.data.y[b],this.data.z[b]],!0}},b.update=function(b){var d,e,p,y,C=this.scene.glplot.gl,A=o.solid;this.data=b;var a=function X(j,a){var D,E,F,c,b,e,G=[],g=j.fullSceneLayout,h=j.dataScale,K=g.xaxis,L=g.yaxis,M=g.zaxis,f=a.marker,o=a.line,i=a.x||[],p=a.y||[],y=a.z||[],d=i.length,N=a.xcalendar,O=a.ycalendar,P=a.zcalendar;for(b=0;b<d;b++)D=K.d2l(i[b],0,N)*h[0],E=L.d2l(p[b],0,O)*h[1],F=M.d2l(y[b],0,P)*h[2],G[b]=[D,E,F];if(Array.isArray(a.text))e=a.text;else if(void 0!==a.text)for(b=0,e=new Array(d);b<d;b++)e[b]=a.text;function z(b,c){var a=g[b];return q.tickText(a,a.d2l(c),!0).text}var A=a.texttemplate;if(A){var Y,Q=j.fullLayout._d3locale,H=Array.isArray(A),I=H?Math.min(A.length,d):d,R=H?function(a){return A[a]}:function(){return A};for(b=0,e=new Array(I);b<I;b++){var S={x:i[b],y:p[b],z:y[b]},T={xLabel:z("xaxis",i[b]),yLabel:z("yaxis",p[b]),zLabel:z("zaxis",y[b])},J={};r(J,a,b);var U=a._meta||{};e[b]=k.texttemplateString(R(b),T,Q,J,S,U)}}if(c={position:G,mode:a.mode,text:e},"line"in a&&(c.lineColor=m(o,1,d),c.lineWidth=o.width,c.lineDashes=o.dash),"marker"in a){var V=n(a);c.scatterColor=m(f,1,d),c.scatterSize=x(f.size,d,v,20,V),c.scatterMarker=x(f.symbol,d,w,"\u25CF"),c.scatterLineWidth=f.line.width,c.scatterLineColor=m(f.line,1,d),c.scatterAngle=0}"textposition"in a&&(c.textOffset=function d(b){var c=[0,0];if(Array.isArray(b))for(var a=0;a<b.length;a++)c[a]=[0,0],b[a]&&(c[a][0]=t(b[a]),c[a][1]=u(b[a]));else c[0]=t(b),c[1]=u(b);return c}(a.textposition),c.textColor=m(a.textfont,1,d),c.textSize=x(a.textfont.size,d,k.identity,12),c.textFont=a.textfont.family,c.textAngle=0);var W=["x","y","z"];for(b=0,c.project=[!1,!1,!1],c.projectScale=[1,1,1],c.projectOpacity=[1,1,1];b<3;++b){var B=a.projection[W[b]];(c.project[b]=B.show)&&(c.projectOpacity[b]=B.opacity,c.projectScale[b]=B.scale)}c.errorBounds=s(a,h,g);var C=function g(c){for(var d=[0,0,0],e=[[0,0,0],[0,0,0],[0,0,0]],f=[1,1,1],b=0;b<3;b++){var a=c[b];a&& !1!==a.copy_zstyle&& !1!==c[2].visible&&(a=c[2]),a&&a.visible&&(d[b]=a.width/2,e[b]=l(a.color),f[b]=a.thickness)}return{capSize:d,color:e,lineWidth:f}}([a.error_x,a.error_y,a.error_z]);return c.errorColor=C.color,c.errorLineWidth=C.lineWidth,c.errorCapSize=C.capSize,c.delaunayAxis=a.surfaceaxis,c.delaunayColor=l(a.surfacecolor),c}(this.scene,b);"mode"in a&&(this.mode=a.mode),"lineDashes"in a&&a.lineDashes in o&&(A=o[a.lineDashes]),this.color=z(a.scatterColor)||z(a.lineColor),this.dataPoints=a.position,d={gl:this.scene.glplot.gl,position:a.position,color:a.lineColor,lineWidth:a.lineWidth||1,dashes:A[0],dashScale:A[1],opacity:b.opacity,connectGaps:b.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(d):(this.linePlot=f(d),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var B=b.opacity;if(b.marker&&b.marker.opacity&&(B*=b.marker.opacity),e={gl:this.scene.glplot.gl,position:a.position,color:a.scatterColor,size:a.scatterSize,glyph:a.scatterMarker,opacity:B,orthographic:!0,lineWidth:a.scatterLineWidth,lineColor:a.scatterLineColor,project:a.project,projectScale:a.projectScale,projectOpacity:a.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(e):(this.scatterPlot=g(e),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),y={gl:this.scene.glplot.gl,position:a.position,glyph:a.text,color:a.textColor,size:a.textSize,angle:a.textAngle,alignment:a.textOffset,font:a.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:b.opacity},this.textLabels=b.hovertext||b.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(y):(this.textMarkers=g(y),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),p={gl:this.scene.glplot.gl,position:a.position,color:a.errorColor,error:a.errorBounds,lineWidth:a.errorLineWidth,capSize:a.errorCapSize,opacity:b.opacity},this.errorBars?a.errorBounds?this.errorBars.update(p):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):a.errorBounds&&(this.errorBars=h(p),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),a.delaunayAxis>=0){var c=function(d,m,i){var a,e=(i+1)%3,f=(i+2)%3,k=[],l=[];for(a=0;a<d.length;++a){var b=d[a];!(isNaN(b[e])||!isFinite(b[e])||isNaN(b[f]))&&isFinite(b[f])&&(k.push([b[e],b[f]]),l.push(a))}var g=j(k);for(a=0;a<g.length;++a)for(var h=g[a],c=0;c<h.length;++c)h[c]=l[h[c]];return{positions:d,cells:g,meshColor:m}}(a.position,a.delaunayColor,a.delaunayAxis);c.opacity=b.opacity,this.delaunayMesh?this.delaunayMesh.update(c):(c.gl=C,this.delaunayMesh=i(c),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},b.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},c.exports=function(c,a){var b=new d(c,a.uid);return b.update(a),b}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(a,b,c){"use strict";var d=a("../../registry"),e=a("../../lib"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/text_defaults"),j=a("./attributes");b.exports=function(c,b,k,l){function a(a,d){return e.coerce(c,b,j,a,d)}if(s=c,t=b,u=a,v=l,w=0,x=u("x"),y=u("y"),z=u("z"),d.getComponentMethod("calendars","handleTraceDefaults")(s,t,["x","y","z"],v),x&&y&&z&&(w=Math.min(x.length,y.length,z.length),t._length=t._xlength=t._ylength=t._zlength=w),!w){b.visible=!1;return}a("text"),a("hovertext"),a("hovertemplate"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),a("mode"),f.hasLines(b)&&(a("connectgaps"),h(c,b,k,l,a)),f.hasMarkers(b)&&g(c,b,k,l,a,{noSelect:!0,noAngle:!0}),f.hasText(b)&&(a("texttemplate"),i(c,b,l,a,{noSelect:!0}));var s,t,u,v,w,x,y,z,m=(b.line||{}).color,n=(b.marker||{}).color;a("surfaceaxis")>=0&&a("surfacecolor",m||n);for(var r=["x","y","z"],o=0;o<3;++o){var p="projection."+r[o];a(p+".show")&&(a(p+".opacity"),a(p+".scale"))}var q=d.getComponentMethod("errorbars","supplyDefaults");q(c,b,m||n||k,{axis:"z"}),q(c,b,m||n||k,{axis:"y",inherit:"z"}),q(c,b,m||n||k,{axis:"x",inherit:"z"})}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(a,b,c){"use strict";b.exports={plot:a("./convert"),attributes:a("./attributes"),markerSymbols:a("../../constants/gl3d_markers"),supplyDefaults:a("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:a("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(d,g,l){"use strict";var a=d("../scatter/attributes"),h=d("../../plots/attributes"),i=d("../../plots/template_attributes").hovertemplateAttrs,j=d("../../plots/template_attributes").texttemplateAttrs,f=d("../../components/colorscale/attributes"),c=d("../../lib/extend").extendFlat,b=a.marker,e=a.line,k=b.line;g.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:c({},a.mode,{dflt:"markers"}),text:c({},a.text,{}),texttemplate:j({editType:"plot"},{keys:["a","b","text"]}),hovertext:c({},a.hovertext,{}),line:{color:e.color,width:e.width,dash:e.dash,backoff:e.backoff,shape:c({},e.shape,{values:["linear","spline"]}),smoothing:e.smoothing,editType:"calc"},connectgaps:a.connectgaps,fill:c({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:c({symbol:b.symbol,opacity:b.opacity,maxdisplayed:b.maxdisplayed,angle:b.angle,angleref:b.angleref,standoff:b.standoff,size:b.size,sizeref:b.sizeref,sizemin:b.sizemin,sizemode:b.sizemode,line:c({width:k.width,editType:"calc"},f("marker.line")),gradient:b.gradient,editType:"calc"},f("marker")),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:c({},h.hoverinfo,{flags:["a","b","text","name"]}),hoveron:a.hoveron,hovertemplate:i()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../scatter/colorscale_calc"),f=a("../scatter/arrays_to_calcdata"),g=a("../scatter/calc_selection"),h=a("../scatter/calc").calcMarkerSize,i=a("../carpet/lookup_carpetid");b.exports=function(n,a){var c,k,l,b=a._carpetTrace=i(n,a);if(b&&b.visible&&"legendonly"!==b.visible){a.xaxis=b.xaxis,a.yaxis=b.yaxis;var m=a._length,j=new Array(m),o=!1;for(c=0;c<m;c++)if(k=a.a[c],l=a.b[c],d(k)&&d(l)){var p=b.ab2xy(+k,+l,!0),q=b.isVisible(+k,+l);q||(o=!0),j[c]={x:p[0],y:p[1],a:k,b:l,vis:q}}else j[c]={x:!1,y:!1};return a._needsCull=o,j[0].carpet=b,j[0].trace=a,h(a,m),e(n,a),f(j,a),g(j,a),j}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/constants"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/line_shape_defaults"),j=a("../scatter/text_defaults"),k=a("../scatter/fillcolor_defaults"),l=a("./attributes");b.exports=function(c,a,m,n){function b(b,e){return d.coerce(c,a,l,b,e)}b("carpet"),a.xaxis="x",a.yaxis="y";var q=b("a"),r=b("b"),o=Math.min(q.length,r.length);if(!o){a.visible=!1;return}a._length=o,b("text"),b("texttemplate"),b("hovertext"),b("mode",o<e.PTS_LINESONLY?"lines+markers":"lines"),f.hasLines(a)&&(h(c,a,m,n,b,{backoff:!0}),i(c,a,b),b("connectgaps")),f.hasMarkers(a)&&g(c,a,m,n,b,{gradient:!0}),f.hasText(a)&&j(c,a,n,b);var p=[];(f.hasMarkers(a)||f.hasText(a))&&(b("marker.maxdisplayed"),p.push("points")),b("fill"),"none"===a.fill||(k(c,a,m,b),f.hasLines(a)||i(c,a,b)),("tonext"===a.fill||"toself"===a.fill)&&p.push("fills"),"fills"!==b("hoveron",p.join("+")||"points")&&b("hovertemplate"),d.coerceSelectionMarkerOpacity(a,b)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(b,a,c){"use strict";a.exports=function(a,e,f,c,d){var b=c[d];return a.a=b.a,a.b=b.b,a.y=b.y,a}},{}],974:[function(b,a,c){"use strict";a.exports=function(b,g){var c={},d=g._carpet,a=d.ab2ij([b.a,b.b]),e=Math.floor(a[0]),h=a[0]-e,f=Math.floor(a[1]),i=a[1]-f,j=d.evalxy([],e,f,h,i);return c.yLabel=j[1].toFixed(3),c}},{}],975:[function(a,b,c){"use strict";var d=a("../scatter/hover"),e=a("../../lib").fillText;b.exports=function(h,n,o,p){var f=d(h,n,o,p);if(f&& !1!==f[0].index){var a=f[0];if(void 0===a.index){var q=1-a.y0/h.ya._length,k=h.xa._length,i=k*q/2,l=k-i;return a.x0=Math.max(Math.min(a.x0,l),i),a.x1=Math.max(Math.min(a.x1,l),i),f}var b=a.cd[a.index];a.a=b.a,a.b=b.b,a.xLabelVal=void 0,a.yLabelVal=void 0;var c=a.trace,m=c._carpet,r=c._module.formatLabels(b,c);a.yLabel=r.yLabel,delete a.text;var j=[];if(!c.hovertemplate){var g=(b.hi||c.hoverinfo).split("+");-1!==g.indexOf("all")&&(g=["a","b","text"]),-1!==g.indexOf("a")&&s(m.aaxis,b.a),-1!==g.indexOf("b")&&s(m.baxis,b.b),j.push("y: "+a.yLabel),-1!==g.indexOf("text")&&e(b,c,j),a.extraText=j.join("<br>")}return f}function s(a,c){var b;b=a.labelprefix&&a.labelprefix.length>0?a.labelprefix.replace(/ = $/,""):a._hovertitle,j.push(b+": "+c.toFixed(3)+a.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../scatter/select"),eventData:a("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:a("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(a,b,c){"use strict";var d=a("../scatter/plot"),e=a("../../plots/cartesian/axes"),f=a("../../components/drawing");b.exports=function(c,m,b,h){var a,g,i,j=b[0][0].carpet,k=e.getFromId(c,j.xaxis||"x"),l=e.getFromId(c,j.yaxis||"y"),n={xaxis:k,yaxis:l,plot:m.plot};for(a=0;a<b.length;a++)(g=b[a][0].trace)._xA=k,g._yA=l;for(d(c,n,b,h),a=0;a<b.length;a++)g=b[a][0].trace,i=h.selectAll("g.trace"+g.uid+" .js-line"),f.setClipUrl(i,b[a][0].carpet._clipPathId,c)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(c,g,n){"use strict";var h=c("../../plots/template_attributes").hovertemplateAttrs,i=c("../../plots/template_attributes").texttemplateAttrs,b=c("../scatter/attributes"),j=c("../../plots/attributes"),e=c("../../components/colorscale/attributes"),k=c("../../components/drawing/attributes").dash,d=c("../../lib/extend").extendFlat,l=c("../../plot_api/edit_types").overrideAll,a=b.marker,f=b.line,m=a.line;g.exports=l({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:d({},b.mode,{dflt:"markers"}),text:d({},b.text,{}),texttemplate:i({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:d({},b.hovertext,{}),textfont:b.textfont,textposition:b.textposition,line:{color:f.color,width:f.width,dash:k},connectgaps:b.connectgaps,marker:d({symbol:a.symbol,opacity:a.opacity,angle:a.angle,angleref:d({},a.angleref,{values:["previous","up","north"]}),standoff:a.standoff,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,colorbar:a.colorbar,line:d({width:m.width},e("marker.line")),gradient:a.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:b.fillcolor,selected:b.selected,unselected:b.unselected,hoverinfo:d({},j.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:h()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../constants/numerical").BADNUM,f=a("../scatter/colorscale_calc"),g=a("../scatter/arrays_to_calcdata"),h=a("../scatter/calc_selection"),i=a("../../lib")._;function j(a){return a&&"string"==typeof a}b.exports=function(k,a){var n,o=Array.isArray(a.locations),l=o?a.locations.length:a._length,c=new Array(l);n=a.geojson?function(a){return j(a)||d(a)}:j;for(var b=0;b<l;b++){var m=c[b]={};if(o){var p=a.locations[b];m.loc=n(p)?p:null}else{var q=a.lon[b],r=a.lat[b];d(q)&&d(r)?m.lonlat=[+q,+r]:m.lonlat=[e,e]}}return g(c,a),f(k,a),h(c,a),l&&(c[0].t={labels:{lat:i(k,"lat:")+" ",lon:i(k,"lon:")+" "}}),c}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatter/marker_defaults"),g=a("../scatter/line_defaults"),h=a("../scatter/text_defaults"),i=a("../scatter/fillcolor_defaults"),j=a("./attributes");b.exports=function(c,b,l,m){function a(a,e){return d.coerce(c,b,j,a,e)}var n=a("locations");if(n&&n.length){var k,p,o=a("geojson");("string"==typeof o&&""!==o||d.isPlainObject(o))&&(p="geojson-id"),"geojson-id"===a("locationmode",p)&&a("featureidkey"),k=n.length}else{var q=a("lon")||[],r=a("lat")||[];k=Math.min(q.length,r.length)}if(!k){b.visible=!1;return}b._length=k,a("text"),a("hovertext"),a("hovertemplate"),a("mode"),e.hasLines(b)&&(g(c,b,l,m,a),a("connectgaps")),e.hasMarkers(b)&&f(c,b,l,m,a,{gradient:!0}),e.hasText(b)&&(a("texttemplate"),h(c,b,m,a)),a("fill"),"none"!==b.fill&&i(c,b,l,a),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(b,a,c){"use strict";a.exports=function(a,b,f,d,e){a.lon=b.lon,a.lat=b.lat,a.location=b.loc?b.loc:null;var c=d[e];return c.fIn&&c.fIn.properties&&(a.properties=c.fIn.properties),a}},{}],982:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes");b.exports=function(e,f,g){var b={},a=g[f.geo]._subplot.mockAxis,c=e.lonlat;return b.lonLabel=d.tickText(a,a.c2l(c[0]),!0).text,b.latLabel=d.tickText(a,a.c2l(c[1]),!0).text,b}},{"../../plots/cartesian/axes":566}],983:[function(a,b,c){"use strict";var d=a("../../components/fx"),e=a("../../constants/numerical").BADNUM,f=a("../scatter/get_trace_color"),g=a("../../lib").fillText,h=a("./attributes");b.exports=function(a,r,s){var i=a.cd,b=i[0].trace,p=a.xa,q=a.ya,m=a.subplot,t=m.projection.isLonLatOverEdges,u=m.project;if(d.getClosest(i,function(b){var a=b.lonlat;if(a[0]===e)return 1/0;if(t(a))return 1/0;var c=u(a),d=u([r,s]),f=Math.abs(c[0]-d[0]),g=Math.abs(c[1]-d[1]),h=Math.max(3,b.mrc||0);return Math.max(Math.sqrt(f*f+g*g)-h,1-3/h)},a),!1!==a.index){var c=i[a.index],j=c.lonlat,k=[p.c2p(j),q.c2p(j)],l=c.mrc||1;a.x0=k[0]-l,a.x1=k[0]+l,a.y0=k[1]-l,a.y1=k[1]+l,a.loc=c.loc,a.lon=j[0],a.lat=j[1];var n={};n[b.geo]={_subplot:m};var o=b._module.formatLabels(c,b,n);return a.lonLabel=o.lonLabel,a.latLabel=o.latLabel,a.color=f(b,c),a.extraText=function(b,e,c,f){if(!b.hovertemplate){var i=e.hi||b.hoverinfo,d="all"===i?h.hoverinfo.flags:i.split("+"),l=-1!==d.indexOf("location")&&Array.isArray(b.locations),j=-1!==d.indexOf("lon"),k=-1!==d.indexOf("lat"),m=-1!==d.indexOf("text"),a=[];return l?a.push(e.loc):j&&k?a.push("("+n(c.latLabel)+", "+n(c.lonLabel)+")"):j?a.push(f.lon+n(c.lonLabel)):k&&a.push(f.lat+n(c.latLabel)),m&&g(e,b,a),a.join("<br>")}function n(a){return a+"\xb0"}}(b,c,a,i[0].t.labels),a.hovertemplate=b.hovertemplate,[a]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),calcGeoJSON:a("./plot").calcGeoJSON,plot:a("./plot").plot,style:a("./style"),styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:a("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../lib/topojson_utils").getTopojsonFeatures,g=a("../../lib/geojson_utils"),h=a("../../lib/geo_location_utils"),i=a("../../plots/cartesian/autorange").findExtremes,j=a("../../constants/numerical").BADNUM,k=a("../scatter/calc").calcMarkerSize,l=a("../scatter/subtypes"),m=a("./style");b.exports={calcGeoJSON:function(e,r){var a,c,g,l,b=e[0].trace,m=r[b.geo],s=m._subplot,d=b._length;if(Array.isArray(b.locations)){var o=b.locationmode,t="geojson-id"===o?h.extractTraceFeature(e):f(b,s.topojson);for(a=0;a<d;a++){c=e[a];var q="geojson-id"===o?c.fOut:h.locationToFeature(o,c.loc,t);c.lonlat=q?q.properties.ct:[j,j]}}var p={padded:!0};if("geojson"===m.fitbounds&&"geojson-id"===b.locationmode){var n=h.computeBbox(h.getTraceGeojson(b));g=[n[0],n[2]],l=[n[1],n[3]]}else{for(a=0,g=new Array(d),l=new Array(d);a<d;a++)c=e[a],g[a]=c.lonlat[0],l[a]=c.lonlat[1];p.ppad=k(b,d)}b._extremes.lon=i(m.lonaxis._ax,g,p),b._extremes.lat=i(m.lataxis._ax,l,p)},plot:function(h,b,c){var f=b.layers.frontplot.select(".scatterlayer"),a=e.makeTraceGroups(f,c,"trace scattergeo");function i(a,b){a.lonlat[0]===j&&d.select(b).remove()}a.selectAll("*").remove(),a.each(function(b){var c=d.select(this),a=b[0].trace;if(l.hasLines(a)||"none"!==a.fill){var f=g.calcTraceToLineCoords(b),j="none"!==a.fill?g.makePolygon(f):g.makeLine(f);c.selectAll("path.js-line").data([{geojson:j,trace:a}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}l.hasMarkers(a)&&c.selectAll("path.point").data(e.identity).enter().append("path").classed("point",!0).each(function(a){i(a,this)}),l.hasText(a)&&c.selectAll("g").data(e.identity).enter().append("g").append("text").each(function(a){i(a,this)}),m(h,b)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(a,b,c){"use strict";var d=a("../scatter/subtypes"),e=a("../../constants/numerical").BADNUM;b.exports=function(f,h){var g,b,i,j,a,c=f.cd,m=f.xaxis,n=f.yaxis,k=[],l=c[0].trace,o=!d.hasMarkers(l)&&!d.hasText(l);if(o)return[];if(!1===h)for(a=0;a<c.length;a++)c[a].selected=0;else for(a=0;a<c.length;a++)(b=(g=c[a]).lonlat)[0]!==e&&(i=m.c2p(b),j=n.c2p(b),h.contains([i,j],null,a,f)?(k.push({pointNumber:a,lon:b[0],lat:b[1]}),g.selected=1):g.selected=0);return k}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(a,c,d){"use strict";var e=a("@plotly/d3"),f=a("../../components/drawing"),g=a("../../components/color"),b=a("../scatter/style"),h=b.stylePoints,i=b.styleText;c.exports=function(k,j){var b,c,d,a;j&&(b=k,d=(c=j)[0].trace,a=c[0].node3,a.style("opacity",c[0].trace.opacity),h(a,d,b),i(a,d,b),a.selectAll("path.js-line").style("fill","none").each(function(d){var c=e.select(this),a=d.trace,b=a.line||{};c.call(g.stroke,b.color).call(f.dashLine,b.dash||"",b.width||0),"none"!==a.fill&&c.call(g.fill,a.fillcolor)}))}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(c,i,o){"use strict";var j=c("../../plots/attributes"),a=c("../scatter/attributes"),f=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,g=c("../../components/colorscale/attributes"),k=c("../../lib/sort_object_keys"),e=c("../../lib/extend").extendFlat,l=c("../../plot_api/edit_types").overrideAll,m=c("./constants").DASHES,h=a.line,b=a.marker,n=b.line,d=i.exports=l({x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:f("x"),yhoverformat:f("y"),text:a.text,hovertext:a.hovertext,textposition:a.textposition,textfont:a.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:h.color,width:h.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:k(m),dflt:"solid"}},marker:e({},g("marker"),{symbol:b.symbol,angle:b.angle,size:b.size,sizeref:b.sizeref,sizemin:b.sizemin,sizemode:b.sizemode,opacity:b.opacity,colorbar:b.colorbar,line:e({},g("marker.line"),{width:n.width})}),connectgaps:a.connectgaps,fill:e({},a.fill,{dflt:"none"}),fillcolor:a.fillcolor,selected:{marker:a.selected.marker,textfont:a.selected.textfont},unselected:{marker:a.unselected.marker,textfont:a.unselected.textfont},opacity:j.opacity},"calc","nested");d.x.editType=d.y.editType=d.x0.editType=d.y0.editType="calc+clearAxisTypes",d.hovertemplate=a.hovertemplate,d.texttemplate=a.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(a,b,d){"use strict";var c=a("./hover");b.exports={moduleType:"trace",name:"scattergl",basePlotModule:a("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../scatter/cross_trace_defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),hoverPoints:c.hoverPoints,selectPoints:a("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(a,c,d){"use strict";var e=a("@plotly/point-cluster"),f=a("../../lib"),g=a("../../plots/cartesian/axis_ids"),h=a("../../plots/cartesian/autorange").findExtremes,i=a("../../plots/cartesian/align_period"),b=a("../scatter/calc"),j=b.calcMarkerSize,k=b.calcAxisExpansion,l=b.setFirstScatter,m=a("../scatter/colorscale_calc"),n=a("./convert"),o=a("./scene_update"),p=a("../../constants/numerical").BADNUM,q=a("./constants").TOO_MANY_POINTS;function r(d,b,e){var a=d._extremes[b._id],c=h(b,e._bnds,{padded:!0});a.min=a.min.concat(c.min),a.max=a.max.concat(c.max)}c.exports=function(t,a){var d,z,D=t._fullLayout,u=a._xA=g.getFromId(t,a.xaxis,"x"),v=a._yA=g.getFromId(t,a.yaxis,"y"),E=D._plots[a.xaxis+a.yaxis],w=a._length,F=w>=q,A=2*w,s={},G=u.makeCalcdata(a,"x"),H=v.makeCalcdata(a,"y"),B=i(a,u,"x",G),C=i(a,v,"y",H),x=B.vals,y=C.vals;a._x=x,a._y=y,a.xperiodalignment&&(a._origX=G,a._xStarts=B.starts,a._xEnds=B.ends),a.yperiodalignment&&(a._origY=H,a._yStarts=C.starts,a._yEnds=C.ends);var h=new Array(A),I=new Array(w);for(d=0;d<w;d++)h[2*d]=x[d]===p?NaN:x[d],h[2*d+1]=y[d]===p?NaN:y[d],I[d]=d;if("log"===u.type)for(d=0;d<A;d+=2)h[d]=u.c2l(h[d]);if("log"===v.type)for(d=1;d<A;d+=2)h[d]=v.c2l(h[d]);F&&"log"!==u.type&&"log"!==v.type?s.tree=e(h):s.ids=I,m(t,a);var b=function(c,i,d,b,g,h){var a=n.style(c,d);if(a.marker&&(a.marker.positions=b),a.line&&b.length>1&&f.extendFlat(a.line,n.linePositions(c,d,b)),a.errorX||a.errorY){var e=n.errorBarPositions(c,d,b,g,h);a.errorX&&f.extendFlat(a.errorX,e.x),a.errorY&&f.extendFlat(a.errorY,e.y)}return a.text&&(f.extendFlat(a.text,{positions:b},n.textPosition(c,d,a.text,a.marker)),f.extendFlat(a.textSel,{positions:b},n.textPosition(c,d,a.text,a.markerSel)),f.extendFlat(a.textUnsel,{positions:b},n.textPosition(c,d,a.text,a.markerUnsel))),a}(t,E,a,h,x,y),c=o(t,E);return l(D,a),F?b.marker&&(z=b.marker.sizeAvg||Math.max(b.marker.size,3)):z=j(a,w),k(t,a,u,v,x,y,z),b.errorX&&r(a,u,b.errorX),b.errorY&&r(a,v,b.errorY),b.fill&&!c.fill2d&&(c.fill2d=!0),b.marker&&!c.scatter2d&&(c.scatter2d=!0),b.line&&!c.line2d&&(c.line2d=!0),(b.errorX||b.errorY)&&!c.error2d&&(c.error2d=!0),b.text&&!c.glText&&(c.glText=!0),b.marker&&(b.marker.snap=w),c.lineOptions.push(b.line),c.errorXOptions.push(b.errorX),c.errorYOptions.push(b.errorY),c.fillOptions.push(b.fill),c.markerOptions.push(b.marker),c.markerSelectedOptions.push(b.markerSel),c.markerUnselectedOptions.push(b.markerUnsel),c.textOptions.push(b.text),c.textSelectedOptions.push(b.textSel),c.textUnselectedOptions.push(b.textUnsel),c.selectBatch.push([]),c.unselectBatch.push([]),s._scene=c,s.index=c.count,s.x=x,s.y=y,s.positions=h,c.count++,[{x:!1,y:!1,t:s,trace:a}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(b,a,c){"use strict";a.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(a,c,h){"use strict";var i=a("fast-isnumeric"),j=a("svg-path-sdf"),k=a("color-normalize"),l=a("../../registry"),m=a("../../lib"),d=a("../../components/drawing"),n=a("../../plots/cartesian/axis_ids"),o=a("../../lib/gl_format_color").formatColor,p=a("../scatter/subtypes"),q=a("../scatter/make_bubble_size_func"),r=a("./helpers"),b=a("./constants"),s=a("../../constants/interactions").DESELECTDIM,t={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},u=a("../../components/fx/helpers").appendArrayPointValue;function v(n,c){var a,o=n._fullLayout,d=c._length,h=c.textfont,j=c.textposition,p=Array.isArray(j)?j:[j],k=h.color,e=h.size,f=h.family,b={},q=n._context.plotGlPixelRatio,l=c.texttemplate;if(l){b.text=[];var w=o._d3locale,r=Array.isArray(l),x=r?Math.min(l.length,d):d,y=r?function(a){return l[a]}:function(){return l};for(a=0;a<x;a++){var s={i:a},z=c._module.formatLabels(s,c,o),t={};u(t,c,a);var A=c._meta||{};b.text.push(m.texttemplateString(y(a),z,w,t,s,A))}}else Array.isArray(c.text)&&c.text.length<d?b.text=c.text.slice():b.text=c.text;if(Array.isArray(b.text))for(a=b.text.length;a<d;a++)b.text[a]="";for(a=0,b.opacity=c.opacity,b.font={},b.align=[],b.baseline=[];a<p.length;a++){var g=p[a].split(/\s+/);switch(g[1]){case"left":b.align.push("right");break;case"right":b.align.push("left");break;default:b.align.push(g[1])}switch(g[0]){case"top":b.baseline.push("bottom");break;case"bottom":b.baseline.push("top");break;default:b.baseline.push(g[0])}}if(Array.isArray(k))for(a=0,b.color=new Array(d);a<d;a++)b.color[a]=k[a];else b.color=k;if(m.isArrayOrTypedArray(e)||Array.isArray(f))for(a=0,b.font=new Array(d);a<d;a++){var v=b.font[a]={};v.size=(m.isTypedArray(e)?e[a]:Array.isArray(e)?i(e[a])?e[a]:0:e)*q,v.family=Array.isArray(f)?f[a]:f}else b.font={size:e*q,family:f};return b}function e(G,f){var c=f._length,a=f.marker,b={},n=m.isArrayOrTypedArray(a.symbol),x=m.isArrayOrTypedArray(a.angle),y=m.isArrayOrTypedArray(a.color),z=m.isArrayOrTypedArray(a.line.color),A=m.isArrayOrTypedArray(a.opacity),s=m.isArrayOrTypedArray(a.size),t=m.isArrayOrTypedArray(a.line.width);if(n||(H=r.isOpenSymbol(a.symbol)),n||y||z||A||x){b.symbols=new Array(c),b.angles=new Array(c),b.colors=new Array(c),b.borderColors=new Array(c);var h=a.symbol,i=a.angle,e=o(a,a.opacity,c),g=o(a.line,a.opacity,c);if(!Array.isArray(g[0])){var B=g;for(d=0,g=Array(c);d<c;d++)g[d]=B}if(!Array.isArray(e[0])){var D=e;for(d=0,e=Array(c);d<c;d++)e[d]=D}if(!Array.isArray(h)){var E=h;for(d=0,h=Array(c);d<c;d++)h[d]=E}if(!Array.isArray(i)){var F=i;for(d=0,i=Array(c);d<c;d++)i[d]=F}for(d=0,b.symbols=h,b.angles=i,b.colors=e,b.borderColors=g;d<c;d++)n&&(H=r.isOpenSymbol(a.symbol[d])),H&&(g[d]=e[d].slice(),e[d]=e[d].slice(),e[d][3]=0);for(d=0,b.opacity=f.opacity,b.markers=new Array(c);d<c;d++)b.markers[d]=C({mx:b.symbols[d],ma:b.angles[d]},f)}else H?(b.color=k(a.color,"uint8"),b.color[3]=0,b.borderColor=k(a.color,"uint8")):(b.color=k(a.color,"uint8"),b.borderColor=k(a.line.color,"uint8")),b.opacity=f.opacity*a.opacity,b.marker=C({mx:a.symbol,ma:a.angle},f);var j=q(f,1);if(s||t){var d,H,l,u,p=b.sizes=new Array(c),v=b.borderSizes=new Array(c),w=0;if(s){for(d=0;d<c;d++)p[d]=j(a.size[d]),w+=p[d];u=w/c}else for(d=0,l=j(a.size);d<c;d++)p[d]=l;if(t)for(d=0;d<c;d++)v[d]=a.line.width[d];else for(d=0,l=a.line.width;d<c;d++)v[d]=l;b.sizeAvg=u}else b.size=j(a&&a.size||10),b.borderSizes=j(a.line.width);return b}function f(c,d,a){var f=d.marker,b={};return a&&(a.marker&&a.marker.symbol?b=e(c,m.extendFlat({},f,a.marker)):a.marker&&(a.marker.size&&(b.size=a.marker.size),a.marker.color&&(b.colors=a.marker.color),void 0!==a.marker.opacity&&(b.opacity=a.marker.opacity))),b}function w(e,a,b){var c={};if(!b)return c;if(b.textfont){var d={opacity:1,text:a.text,texttemplate:a.texttemplate,textposition:a.textposition,textfont:m.extendFlat({},a.textfont)};b.textfont&&m.extendFlat(d.textfont,b.textfont),c=v(e,d)}return c}function x(d,a,b){var c={capSize:2*a.width*b,lineWidth:a.thickness*b,color:a.color};return a.copy_ystyle&&(c=d.error_y),c}var y=b.SYMBOL_SDF_SIZE,g=b.SYMBOL_SIZE,z=b.SYMBOL_STROKE,A={},B=d.symbolFuncs[0](.05*g);function C(b,i){var c,a=b.mx;if("circle"===a)return null;var e=d.symbolNumber(a),f=d.symbolFuncs[e%100],k=!!d.symbolNoDot[e%100],l=!!d.symbolNoFill[e%100],m=r.isDotSymbol(a);if(b.ma&&(a+="_"+b.ma),A[a])return A[a];var h=d.getMarkerAngle(b,i);return c=j(m&&!k?f(1.1*g,h)+B:f(g,h),{w:y,h:y,viewBox:[-g,-g,g,g],stroke:l?z:-z}),A[a]=c,c||null}c.exports={style:function(g,a){var d,c={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},h=g._context.plotGlPixelRatio;if(!0!==a.visible)return c;if(p.hasText(a)&&(c.text=v(g,a),c.textSel=w(g,a,a.selected),c.textUnsel=w(g,a,a.unselected)),p.hasMarkers(a)&&(c.marker=e(g,a),c.markerSel=f(g,a,a.selected),c.markerUnsel=f(g,a,a.unselected),!a.unselected&&m.isArrayOrTypedArray(a.marker.opacity))){var i=a.marker.opacity;for(d=0,c.markerUnsel.opacity=new Array(i.length);d<i.length;d++)c.markerUnsel.opacity[d]=s*i[d]}if(p.hasLines(a)){c.line={overlay:!0,thickness:a.line.width*h,color:a.line.color,opacity:a.opacity};var j=(b.DASHES[a.line.dash]||[1]).slice();for(d=0;d<j.length;++d)j[d]*=a.line.width*h;c.line.dashes=j}return a.error_x&&a.error_x.visible&&(c.errorX=x(a,a.error_x,h)),a.error_y&&a.error_y.visible&&(c.errorY=x(a,a.error_y,h)),a.fill&&"none"!==a.fill&&(c.fill={closed:!0,fill:a.fillcolor,thickness:0}),c},markerStyle:e,markerSelection:f,linePositions:function(n,f,c){var d,a,e=c.length,g=e/2;if(p.hasLines(f)&&g)if("hv"===f.line.shape){for(a=0,d=[];a<g-1;a++)isNaN(c[2*a])||isNaN(c[2*a+1])?d.push(NaN,NaN,NaN,NaN):(d.push(c[2*a],c[2*a+1]),isNaN(c[2*a+2])||isNaN(c[2*a+3])?d.push(NaN,NaN):d.push(c[2*a+2],c[2*a+1]));d.push(c[e-2],c[e-1])}else if("hvh"===f.line.shape){for(a=0,d=[];a<g-1;a++)if(isNaN(c[2*a])||isNaN(c[2*a+1])||isNaN(c[2*a+2])||isNaN(c[2*a+3]))isNaN(c[2*a])||isNaN(c[2*a+1])?d.push(NaN,NaN):d.push(c[2*a],c[2*a+1]),d.push(NaN,NaN);else{var i=(c[2*a]+c[2*a+2])/2;d.push(c[2*a],c[2*a+1],i,c[2*a+1],i,c[2*a+3])}d.push(c[e-2],c[e-1])}else if("vhv"===f.line.shape){for(a=0,d=[];a<g-1;a++)if(isNaN(c[2*a])||isNaN(c[2*a+1])||isNaN(c[2*a+2])||isNaN(c[2*a+3]))isNaN(c[2*a])||isNaN(c[2*a+1])?d.push(NaN,NaN):d.push(c[2*a],c[2*a+1]),d.push(NaN,NaN);else{var j=(c[2*a+1]+c[2*a+3])/2;d.push(c[2*a],c[2*a+1],c[2*a],j,c[2*a+2],j)}d.push(c[e-2],c[e-1])}else if("vh"===f.line.shape){for(a=0,d=[];a<g-1;a++)isNaN(c[2*a])||isNaN(c[2*a+1])?d.push(NaN,NaN,NaN,NaN):(d.push(c[2*a],c[2*a+1]),isNaN(c[2*a+2])||isNaN(c[2*a+3])?d.push(NaN,NaN):d.push(c[2*a],c[2*a+3]));d.push(c[e-2],c[e-1])}else d=c;var h=!1;for(a=0;a<d.length;a++)if(isNaN(d[a])){h=!0;break}var m=h||d.length>b.TOO_MANY_POINTS?"rect":p.hasMarkers(f)?"rect":"round";if(h&&f.connectgaps){var k=d[0],l=d[1];for(a=0;a<d.length;a+=2)isNaN(d[a])||isNaN(d[a+1])?(d[a]=k,d[a+1]=l):(k=d[a],l=d[a+1])}return{join:m,positions:d}},errorBarPositions:function(a,b,d,e,f){var k=l.getComponentMethod("errorbars","makeComputeError"),g=n.getFromId(a,b.xaxis,"x"),h=n.getFromId(a,b.yaxis,"y"),m=d.length/2,j={};function c(u,c){var h=c._id.charAt(0),n=b["error_"+h];if(n&&n.visible&&("linear"===c.type||"log"===c.type)){for(var v=k(n),w={x:0,y:1}[h],l={x:[0,1,2,3],y:[2,3,0,1]}[h],e=new Float64Array(4*m),o=1/0,p=-1/0,f=0,g=0;f<m;f++,g+=4){var a=u[f];if(i(a)){var s=d[2*f+w],t=v(a,f),q=t[0],r=t[1];if(i(q)&&i(r)){var x=a-q,y=a+r;e[g+l[0]]=s-c.c2l(x),e[g+l[1]]=c.c2l(y)-s,e[g+l[2]]=0,e[g+l[3]]=0,o=Math.min(o,a-q),p=Math.max(p,a+r)}}}j[h]={positions:d,errors:e,_bnds:[o,p]}}}return c(e,g),c(f,h),j},textPosition:function(s,h,d,e){var a,i=h._length,f={};if(p.hasMarkers(h)){var g=d.font,b=d.align,c=d.baseline;for(a=0,f.offset=new Array(i);a<i;a++){var j=e.sizes?e.sizes[a]:e.size,k=Array.isArray(g)?g[a].size:g.size,n=Array.isArray(b)?b.length>1?b[a]:b[0]:b,o=Array.isArray(c)?c.length>1?c[a]:c[0]:c,q=t[n],l=t[o],m=j?j/.8+1:0,r=-l*m-.5*l;f.offset[a]=[q*m/k,r/k]}}return f}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../registry"),f=a("./helpers"),g=a("./attributes"),h=a("../scatter/constants"),i=a("../scatter/subtypes"),j=a("../scatter/xy_defaults"),k=a("../scatter/period_defaults"),l=a("../scatter/marker_defaults"),m=a("../scatter/line_defaults"),n=a("../scatter/fillcolor_defaults"),o=a("../scatter/text_defaults");b.exports=function(c,b,p,q){function a(a,e){return d.coerce(c,b,g,a,e)}var v=!!c.marker&&f.isOpenSymbol(c.marker.symbol),w=i.isBubble(c),r=j(c,b,q,a);if(!r){b.visible=!1;return}k(c,b,q,a),a("xhoverformat"),a("yhoverformat");var x=r<h.PTS_LINESONLY?"lines+markers":"lines";a("text"),a("hovertext"),a("hovertemplate"),a("mode",x),i.hasLines(b)&&(a("connectgaps"),m(c,b,p,q,a),a("line.shape")),i.hasMarkers(b)&&(l(c,b,p,q,a,{noAngleRef:!0,noStandOff:!0}),a("marker.line.width",v||w?1:0)),i.hasText(b)&&(a("texttemplate"),o(c,b,q,a));var s=(b.line||{}).color,t=(b.marker||{}).color;a("fill"),"none"!==b.fill&&n(c,b,p,a);var u=e.getComponentMethod("errorbars","supplyDefaults");u(c,b,s||t||p,{axis:"y"}),u(c,b,s||t||p,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color"),f=a("../../constants/interactions").DESELECTDIM;b.exports={styleTextSelection:function(r){var a,b,l=r[0],s=l.trace,m=l.t,c=m._scene,g=m.index,j=c.selectBatch[g],k=c.unselectBatch[g],n=c.textOptions[g],t=c.textSelectedOptions[g]||{},u=c.textUnselectedOptions[g]||{},i=d.extendFlat({},n);if(j.length||k.length){var o=t.color,v=u.color,h=n.color,p=Array.isArray(h);for(a=0,i.color=new Array(s._length);a<j.length;a++)b=j[a],i.color[b]=o||(p?h[b]:h);for(a=0;a<k.length;a++){b=k[a];var q=p?h[b]:h;i.color[b]=v||(o?q:e.addOpacity(q,f))}}c.glText[g].update(i)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(a,b,c){"use strict";var d=a("../scatter/format_labels");b.exports=function(a,b,e){var c=a.i;return"x"in a||(a.x=b._x[c]),"y"in a||(a.y=b._y[c]),d(a,b,e)}},{"../scatter/format_labels":945}],996:[function(b,c,a){"use strict";var d=b("./constants");a.isOpenSymbol=function(a){return"string"==typeof a?d.OPEN_RE.test(a):a%200>100},a.isDotSymbol=function(a){return"string"==typeof a?d.DOT_RE.test(a):a>200}},{"./constants":991}],997:[function(a,b,d){"use strict";var e=a("../../registry"),f=a("../../lib"),g=a("../scatter/get_trace_color");function c(k,v,w,c){var x=k.xa,y=k.ya,z=k.distance,A=k.dxy,b=k.index,a={pointNumber:b,x:v[b],y:w[b]};a.tx=Array.isArray(c.text)?c.text[b]:c.text,a.htx=Array.isArray(c.hovertext)?c.hovertext[b]:c.hovertext,a.data=Array.isArray(c.customdata)?c.customdata[b]:c.customdata,a.tp=Array.isArray(c.textposition)?c.textposition[b]:c.textposition;var i=c.textfont;i&&(a.ts=f.isArrayOrTypedArray(i.size)?i.size[b]:i.size,a.tc=Array.isArray(i.color)?i.color[b]:i.color,a.tf=Array.isArray(i.family)?i.family[b]:i.family);var d=c.marker;d&&(a.ms=f.isArrayOrTypedArray(d.size)?d.size[b]:d.size,a.mo=f.isArrayOrTypedArray(d.opacity)?d.opacity[b]:d.opacity,a.mx=f.isArrayOrTypedArray(d.symbol)?d.symbol[b]:d.symbol,a.ma=f.isArrayOrTypedArray(d.angle)?d.angle[b]:d.angle,a.mc=f.isArrayOrTypedArray(d.color)?d.color[b]:d.color);var l=d&&d.line;l&&(a.mlc=Array.isArray(l.color)?l.color[b]:l.color,a.mlw=f.isArrayOrTypedArray(l.width)?l.width[b]:l.width);var j=d&&d.gradient;j&&"none"!==j.type&&(a.mgt=Array.isArray(j.type)?j.type[b]:j.type,a.mgc=Array.isArray(j.color)?j.color[b]:j.color);var q=x.c2p(a.x,!0),r=y.c2p(a.y,!0),n=a.mrc||1,h=c.hoverlabel;h&&(a.hbg=Array.isArray(h.bgcolor)?h.bgcolor[b]:h.bgcolor,a.hbc=Array.isArray(h.bordercolor)?h.bordercolor[b]:h.bordercolor,a.hts=f.isArrayOrTypedArray(h.font.size)?h.font.size[b]:h.font.size,a.htc=Array.isArray(h.font.color)?h.font.color[b]:h.font.color,a.htf=Array.isArray(h.font.family)?h.font.family[b]:h.font.family,a.hnl=f.isArrayOrTypedArray(h.namelength)?h.namelength[b]:h.namelength);var o=c.hoverinfo;o&&(a.hi=Array.isArray(o)?o[b]:o);var p=c.hovertemplate;p&&(a.ht=Array.isArray(p)?p[b]:p);var s={};s[k.index]=a;var t=c._origX,u=c._origY,m=f.extendFlat({},k,{color:g(c,a),x0:q-n,x1:q+n,xLabelVal:t?t[b]:a.x,y0:r-n,y1:r+n,yLabelVal:u?u[b]:a.y,cd:s,distance:z,spikeDistance:A,hovertemplate:a.ht});return a.htx?m.text=a.htx:a.tx?m.text=a.tx:c.text&&(m.text=c.text),f.fillText(a,c,m),e.getComponentMethod("errorbars","hoverInfo")(a,c,m),m}b.exports={hoverPoints:function(b,G,H,y){var g,d,p,q,r,e,f,h,u,v,z=b.cd,k=z[0].t,i=z[0].trace,j=b.xa,a=b.ya,w=k.x,x=k.y,l=j.c2p(G),m=a.c2p(H),n=b.distance;if(k.tree){var s=j.p2c(l-n),t=j.p2c(l+n),A=a.p2c(m-n),B=a.p2c(m+n);g="x"===y?k.tree.range(Math.min(s,t),Math.min(a._rl[0],a._rl[1]),Math.max(s,t),Math.max(a._rl[0],a._rl[1])):k.tree.range(Math.min(s,t),Math.min(A,B),Math.max(s,t),Math.max(A,B))}else g=k.ids;var o=n;if("x"===y){var I=!!i.xperiodalignment,J=!!i.yperiodalignment;for(e=0;e<g.length;e++){if(q=w[d=g[e]],f=Math.abs(j.c2p(q)-l),I){var C=j.c2p(i._xStarts[d]),D=j.c2p(i._xEnds[d]);f=l>=Math.min(C,D)&&l<=Math.max(C,D)?0:1/0}if(f<o){if(o=f,r=x[d],h=a.c2p(r)-m,J){var E=a.c2p(i._yStarts[d]),F=a.c2p(i._yEnds[d]);h=m>=Math.min(E,F)&&m<=Math.max(E,F)?0:1/0}v=Math.sqrt(f*f+h*h),p=g[e]}}}else for(e=g.length-1;e> -1;e--)q=w[d=g[e]],r=x[d],f=j.c2p(q)-l,h=a.c2p(r)-m,u=Math.sqrt(f*f+h*h),u<o&&(o=v=u,p=d);return(b.index=p,b.distance=o,b.dxy=v,void 0===p)?[b]:[c(b,w,x,i)]},calcHover:c}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(b,c,a){arguments[4][905][0].apply(a,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(a,c,b){"use strict";var e=a("regl-scatter2d"),f=a("regl-line2d"),g=a("regl-error2d"),h=a("gl-text"),i=a("../../lib"),j=a("../../components/dragelement/helpers").selectMode,k=a("../../lib/prepare_regl"),l=a("../scatter/subtypes"),m=a("../scatter/link_traces"),n=a("./edit_style").styleTextSelection,d={},b=c.exports=function(x,y,z){if(z.length){var b,c,w=x._fullLayout,a=y._scene,s=y.xaxis,t=y.yaxis;if(a){if(!k(x,["ANGLE_instanced_arrays","OES_element_index_uint"],d)){a.init();return}var o=a.count,u=w._glcanvas.data()[0].regl;if(m(x,y,z),a.dirty){if(!0===a.error2d&&(a.error2d=g(u)),!0===a.line2d&&(a.line2d=f(u)),!0===a.scatter2d&&(a.scatter2d=e(u)),!0===a.fill2d&&(a.fill2d=f(u)),!0===a.glText)for(b=0,a.glText=new Array(o);b<o;b++)a.glText[b]=new h(u);if(a.glText){if(o>a.glText.length){var U=o-a.glText.length;for(b=0;b<U;b++)a.glText.push(new h(u))}else if(o<a.glText.length){var V=a.glText.length-o,W=a.glText.splice(o,V);W.forEach(function(a){a.destroy()})}for(b=0;b<o;b++)a.glText[b].update(a.textOptions[b])}if(a.line2d&&(a.line2d.update(a.lineOptions),a.lineOptions=a.lineOptions.map(function(c){if(c&&c.positions){for(var a=c.positions,b=0;b<a.length&&(isNaN(a[b])||isNaN(a[b+1]));)b+=2;for(var d=a.length-2;d>b&&(isNaN(a[d])||isNaN(a[d+1]));)d-=2;c.positions=a.slice(b,d+2)}return c}),a.line2d.update(a.lineOptions)),a.error2d){var X=(a.errorXOptions||[]).concat(a.errorYOptions||[]);a.error2d.update(X)}a.scatter2d&&a.scatter2d.update(a.markerOptions),a.fillOrder=i.repeat(null,o),a.fill2d&&(a.fillOptions=a.fillOptions.map(function(j,h){var i,e,d,f,k=z[h];if(j&&k&&k[0]&&k[0].trace){var o=k[0],g=o.trace,w=o.t,p=a.lineOptions[h],l=[];g._ownfill&&l.push(h),g._nexttrace&&l.push(h+1),l.length&&(a.fillOrder[h]=l);var c=[],b=p&&p.positions||w.positions;if("tozeroy"===g.fill){for(d=0;d<b.length&&isNaN(b[d+1]);)d+=2;for(f=b.length-2;f>d&&isNaN(b[f+1]);)f-=2;0!==b[d+1]&&(c=[b[d],0]),c=c.concat(b.slice(d,f+2)),0!==b[f+1]&&(c=c.concat([b[f],0]))}else if("tozerox"===g.fill){for(d=0;d<b.length&&isNaN(b[d]);)d+=2;for(f=b.length-2;f>d&&isNaN(b[f]);)f-=2;0!==b[d]&&(c=[0,b[d+1]]),c=c.concat(b.slice(d,f+2)),0!==b[f]&&(c=c.concat([0,b[f+1]]))}else if("toself"===g.fill||"tonext"===g.fill){for(e=0,c=[],i=0,j.splitNull=!0;e<b.length;e+=2)(isNaN(b[e])||isNaN(b[e+1]))&&((c=c.concat(b.slice(i,e))).push(b[i],b[i+1]),c.push(null,null),i=e+2);c=c.concat(b.slice(i)),i&&c.push(b[i],b[i+1])}else{var q=g._nexttrace;if(q){var r=a.lineOptions[h+1];if(r){var n=r.positions;if("tonexty"===g.fill){for(c=b.slice(),h=Math.floor(n.length/2);h--;){var s=n[2*h],t=n[2*h+1];isNaN(s)||isNaN(t)||c.push(s,t)}j.fill=q.fillcolor}}}}if(g._prevtrace&&"tonext"===g._prevtrace.fill){var m=a.lineOptions[h-1].positions,u=c.length/2,v=[i=u];for(e=0;e<m.length;e+=2)(isNaN(m[e])||isNaN(m[e+1]))&&(v.push(e/2+u+1),i=e+2);c=c.concat(m),j.hole=v}return j.fillmode=g.fill,j.opacity=g.opacity,j.positions=c,j}}),a.fill2d.update(a.fillOptions))}var A=j(w.dragmode),Y=w.clickmode.indexOf("select")> -1;for(b=0;b<o;b++){var I=z[b][0],B=I.trace,q=I.t,J=q.index,C=B._length,Z=q.x,$=q.y;if(B.selectedpoints||A||Y){if(A||(A=!0),B.selectedpoints){var K=a.selectBatch[J]=i.selIndices2selPoints(B),L={};for(c=0;c<K.length;c++)L[K[c]]=1;var M=[];for(c=0;c<C;c++)L[c]||M.push(c);a.unselectBatch[J]=M}var _=q.xpx=new Array(C),aa=q.ypx=new Array(C);for(c=0;c<C;c++)_[c]=s.c2p(Z[c]),aa[c]=t.c2p($[c])}else q.xpx=q.ypx=null}if(A){if(a.select2d||(a.select2d=e(w._glcanvas.data()[1].regl)),a.scatter2d){var N=new Array(o);for(b=0;b<o;b++)N[b]=a.selectBatch[b].length||a.unselectBatch[b].length?a.markerUnselectedOptions[b]:{};a.scatter2d.update(N)}a.select2d&&(a.select2d.update(a.markerOptions),a.select2d.update(a.markerSelectedOptions)),a.glText&&z.forEach(function(a){var b=((a||[])[0]||{}).trace||{};l.hasText(b)&&n(a)})}else a.scatter2d&&a.scatter2d.update(a.markerOptions);var D,E,F,p,r,O,P,Q,R,S,T,G,H,ab={viewport:(D=w,E=s,F=t,p=x._context.plotGlPixelRatio,r=D._size,O=D.width*p,P=D.height*p,Q=r.l*p,R=r.b*p,S=r.r*p,T=r.t*p,G=r.w*p,H=r.h*p,[Q+E.domain[0]*G,R+F.domain[0]*H,O-S-(1-E.domain[1])*G,P-T-(1-F.domain[1])*H]),range:[(s._rl||s.range)[0],(t._rl||t.range)[0],(s._rl||s.range)[1],(t._rl||t.range)[1]]},v=i.repeat(ab,a.count);a.fill2d&&a.fill2d.update(v),a.line2d&&a.line2d.update(v),a.error2d&&a.error2d.update(v.concat(v)),a.scatter2d&&a.scatter2d.update(v),a.select2d&&a.select2d.update(v),a.glText&&a.glText.forEach(function(a){a.update(ab)})}}};b.reglPrecompiled=d},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(e,b){var a=b._scene,c={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},f={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return b._scene||((a=b._scene={}).init=function(){d.extendFlat(a,f,c)},a.init(),a.update=function(e){var b=d.repeat(e,a.count);if(a.fill2d&&a.fill2d.update(b),a.scatter2d&&a.scatter2d.update(b),a.line2d&&a.line2d.update(b),a.error2d&&a.error2d.update(b.concat(b)),a.select2d&&a.select2d.update(b),a.glText)for(var c=0;c<a.count;c++)a.glText[c].update(e)},a.draw=function(){for(var f=a.count,g=a.fill2d,c=a.error2d,h=a.line2d,e=a.scatter2d,i=a.glText,j=a.select2d,k=a.selectBatch,l=a.unselectBatch,b=0;b<f;b++){if(g&&a.fillOrder[b]&&g.draw(a.fillOrder[b]),h&&a.lineOptions[b]&&h.draw(b),c&&(a.errorXOptions[b]&&c.draw(b),a.errorYOptions[b]&&c.draw(b+f)),e&&a.markerOptions[b])if(l[b].length){var m=d.repeat([],a.count);m[b]=l[b],e.draw(m)}else k[b].length||e.draw(b);i[b]&&a.textOptions[b]&&i[b].render()}j&&j.draw(k),a.dirty=!1},a.destroy=function(){a.fill2d&&a.fill2d.destroy&&a.fill2d.destroy(),a.scatter2d&&a.scatter2d.destroy&&a.scatter2d.destroy(),a.error2d&&a.error2d.destroy&&a.error2d.destroy(),a.line2d&&a.line2d.destroy&&a.line2d.destroy(),a.select2d&&a.select2d.destroy&&a.select2d.destroy(),a.glText&&a.glText.forEach(function(a){a.destroy&&a.destroy()}),a.lineOptions=null,a.fillOptions=null,a.markerOptions=null,a.markerSelectedOptions=null,a.markerUnselectedOptions=null,a.errorXOptions=null,a.errorYOptions=null,a.textOptions=null,a.textSelectedOptions=null,a.textUnselectedOptions=null,a.selectBatch=null,a.unselectBatch=null,b._scene=null}),a.dirty||d.extendFlat(a,c),a}},{"../../lib":515}],1001:[function(a,b,c){"use strict";var d=a("../scatter/subtypes"),e=a("./edit_style").styleTextSelection;b.exports=function(g,k){var l=g.cd,s=g.xaxis,t=g.yaxis,h=[],i=l[0].trace,f=l[0].t,u=i._length,v=f.x,w=f.y,a=f._scene,c=f.index;if(!a)return h;var o=d.hasText(i),p=d.hasMarkers(i),x=!p&&!o;if(!0!==i.visible||x)return h;var m=[],n=[];if(!1!==k&&!k.degenerate)for(var b=0;b<u;b++)k.contains([f.xpx[b],f.ypx[b]],!1,b,g)?(m.push(b),h.push({pointNumber:b,x:s.c2d(v[b]),y:t.c2d(w[b])})):n.push(b);if(p){var j=a.scatter2d;if(m.length||n.length){if(!a.selectBatch[c].length&&!a.unselectBatch[c].length){var q=new Array(a.count);q[c]=a.markerUnselectedOptions[c],j.update.apply(j,q)}}else{var r=new Array(a.count);r[c]=a.markerOptions[c],j.update.apply(j,r)}}return a.selectBatch[c]=m,a.unselectBatch[c]=n,o&&e(l),h}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(a,h,o){"use strict";var i=a("../../plots/template_attributes").hovertemplateAttrs,j=a("../../plots/template_attributes").texttemplateAttrs,e=a("../scattergeo/attributes"),b=a("../scatter/attributes"),f=a("../../plots/mapbox/layout_attributes"),k=a("../../plots/attributes"),l=a("../../components/colorscale/attributes"),c=a("../../lib/extend").extendFlat,m=a("../../plot_api/edit_types").overrideAll,n=a("../../plots/mapbox/layout_attributes"),g=e.line,d=e.marker;h.exports=m({lon:e.lon,lat:e.lat,cluster:{enabled:{valType:"boolean"},maxzoom:c({},n.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:c({},d.opacity,{dflt:1})},mode:c({},b.mode,{dflt:"markers"}),text:c({},b.text,{}),texttemplate:j({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:c({},b.hovertext,{}),line:{color:g.color,width:g.width},connectgaps:b.connectgaps,marker:c({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:d.opacity,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode},l("marker")),fill:e.fill,fillcolor:b.fillcolor,textfont:f.layers.symbol.textfont,textposition:f.layers.symbol.textposition,below:{valType:"string"},selected:{marker:b.selected.marker},unselected:{marker:b.unselected.marker},hoverinfo:c({},k.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:i()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../lib"),f=a("../../constants/numerical").BADNUM,g=a("../../lib/geojson_utils"),h=a("../../components/colorscale"),i=a("../../components/drawing"),j=a("../scatter/make_bubble_size_func"),k=a("../scatter/subtypes"),l=a("../../plots/mapbox/convert_text_opts"),m=a("../../components/fx/helpers").appendArrayPointValue,n=a("../../lib/svg_text_utils").NEWLINES,o=a("../../lib/svg_text_utils").BR_TAG_ALL;function p(a){return{type:a,geojson:g.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function q(a,b){return e.isArrayOrTypedArray(a)?b?function(b){return d(a[b])?+a[b]:0}:function(b){return a[b]}:a?function(){return a}:r}function r(){return""}function s(a){return a[0]===f}function t(a,d){var b;if(e.isArrayOrTypedArray(a)&&e.isArrayOrTypedArray(d)){b=["step",["get","point_count"],a[0]];for(var c=1;c<a.length;c++)b.push(d[c-1],a[c])}else b=a;return b}b.exports=function(H,f){var y,a=f[0].trace,I=!0===a.visible&&0!==a._length,z="none"!==a.fill,A=k.hasLines(a),B=k.hasMarkers(a),C=k.hasText(a),D=B&&"circle"===a.marker.symbol,E=B&&"circle"!==a.marker.symbol,F=a.cluster&&a.cluster.enabled,u=p("fill"),v=p("line"),c=p("circle"),b=p("symbol"),w={fill:u,line:v,circle:c,symbol:b};if(!I)return w;if((z||A)&&(y=g.calcTraceToLineCoords(f)),z&&(u.geojson=g.makePolygon(y),u.layout.visibility="visible",e.extendFlat(u.paint,{"fill-color":a.fillcolor})),A&&(v.geojson=g.makeLine(y),v.layout.visibility="visible",e.extendFlat(v.paint,{"line-width":a.line.width,"line-color":a.line.color,"line-opacity":a.opacity})),D){var x=function(n){var b,o,p,q,a,k=n[0].trace,c=k.marker,r=k.selectedpoints,t=e.isArrayOrTypedArray(c.color),u=e.isArrayOrTypedArray(c.size),v=e.isArrayOrTypedArray(c.opacity);function w(a){return k.opacity*a}t&&(o=h.hasColorscale(k,"marker")?h.makeColorScaleFuncFromTrace(c):e.identity),u&&(p=j(k)),v&&(q=function(a){return w(d(a)?+e.constrain(a,0,1):0)});var m=[];for(b=0;b<n.length;b++){var f=n[b],x=f.lonlat;if(!s(x)){var l={};o&&(l.mcc=f.mcc=o(f.mc)),p&&(l.mrc=f.mrc=p(f.ms)),q&&(l.mo=q(f.mo)),r&&(l.selected=f.selected||0),m.push({type:"Feature",id:b+1,geometry:{type:"Point",coordinates:x},properties:l})}}if(r)for(b=0,a=i.makeSelectedPointStyleFns(k);b<m.length;b++){var g=m[b].properties;a.selectedOpacityFn&&(g.mo=w(a.selectedOpacityFn(g))),a.selectedColorFn&&(g.mcc=a.selectedColorFn(g)),a.selectedSizeFn&&(g.mrc=a.selectedSizeFn(g))}return{geojson:{type:"FeatureCollection",features:m},mcc:t||a&&a.selectedColorFn?{type:"identity",property:"mcc"}:c.color,mrc:u||a&&a.selectedSizeFn?{type:"identity",property:"mrc"}:c.size/2,mo:v||a&&a.selectedOpacityFn?{type:"identity",property:"mo"}:w(c.opacity)}}(f);c.geojson=x.geojson,c.layout.visibility="visible",F&&(c.filter=["!",["has","point_count"]],w.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":t(a.cluster.color,a.cluster.step),"circle-radius":t(a.cluster.size,a.cluster.step),"circle-opacity":t(a.cluster.opacity,a.cluster.step)}},w.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),e.extendFlat(c.paint,{"circle-color":x.mcc,"circle-radius":x.mrc,"circle-opacity":x.mo})}if(D&&F&&(c.filter=["!",["has","point_count"]]),(E||C)&&(b.geojson=function(g,u){for(var h=u._fullLayout,a=g[0].trace,i=a.marker||{},j=i.symbol,l=i.angle,v="circle"!==j?q(j):r,w="auto"!==l?q(l,!0):r,x=k.hasText(a)?q(a.text):r,p=[],b=0;b<g.length;b++){var c,d=g[b];if(!s(d.lonlat)){var f=a.texttemplate;if(f){var y=Array.isArray(f)?f[b]||"":f,z=a._module.formatLabels(d,a,h),t={};m(t,a,d.i);var A=a._meta||{};c=e.texttemplateString(y,z,h._d3locale,t,d,A)}else c=x(b);c&&(c=c.replace(n,"").replace(o,"\n")),p.push({type:"Feature",geometry:{type:"Point",coordinates:d.lonlat},properties:{symbol:v(b),angle:w(b),text:c}})}}return{type:"FeatureCollection",features:p}}(f,H),e.extendFlat(b.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),E&&(e.extendFlat(b.layout,{"icon-size":a.marker.size/10}),"angle"in a.marker&&"auto"!==a.marker.angle&&e.extendFlat(b.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),b.layout["icon-allow-overlap"]=a.marker.allowoverlap,e.extendFlat(b.paint,{"icon-opacity":a.opacity*a.marker.opacity,"icon-color":a.marker.color})),C)){var J=(a.marker||{}).size,G=l(a.textposition,J);e.extendFlat(b.layout,{"text-size":a.textfont.size,"text-anchor":G.anchor,"text-offset":G.offset}),e.extendFlat(b.paint,{"text-color":a.textfont.color,"text-opacity":a.opacity})}return w}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatter/marker_defaults"),g=a("../scatter/line_defaults"),h=a("../scatter/text_defaults"),i=a("../scatter/fillcolor_defaults"),j=a("./attributes");b.exports=function(l,b,m,n){function a(a,c){return d.coerce(l,b,j,a,c)}function k(a,c){return d.coerce2(l,b,j,a,c)}if(t=b,v=(u=a)("lon")||[],w=u("lat")||[],x=Math.min(v.length,w.length),t._length=x,!x){b.visible=!1;return}if(a("text"),a("texttemplate"),a("hovertext"),a("hovertemplate"),a("mode"),a("below"),e.hasLines(b)&&(g(l,b,m,n,a,{noDash:!0}),a("connectgaps")),e.hasMarkers(b)){f(l,b,m,n,a,{noLine:!0,noAngle:!0}),a("marker.allowoverlap"),a("marker.angle");var t,u,v,w,x,c=b.marker;"circle"!==c.symbol&&(d.isArrayOrTypedArray(c.size)&&(c.size=c.size[0]),d.isArrayOrTypedArray(c.color)&&(c.color=c.color[0]))}var o=k("cluster.maxzoom"),p=k("cluster.step"),q=k("cluster.color",b.marker&&b.marker.color||m),r=k("cluster.size"),s=k("cluster.opacity");a("cluster.enabled",!1!==o|| !1!==p|| !1!==q|| !1!==r|| !1!==s),e.hasText(b)&&h(l,b,n,a,{noSelect:!0}),a("fill"),"none"!==b.fill&&i(l,b,m,a),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(b,a,c){"use strict";a.exports=function(a,b){return a.lon=b.lon,a.lat=b.lat,a}},{}],1006:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes");b.exports=function(e,f,g){var b={},a=g[f.subplot]._subplot.mockAxis,c=e.lonlat;return b.lonLabel=d.tickText(a,a.c2l(c[0]),!0).text,b.latLabel=d.tickText(a,a.c2l(c[1]),!0).text,b}},{"../../plots/cartesian/axes":566}],1007:[function(a,b,e){"use strict";var f=a("../../components/fx"),c=a("../../lib"),g=a("../scatter/get_trace_color"),h=c.fillText,i=a("../../constants/numerical").BADNUM,j=a("../../plots/mapbox/constants").traceLayerPrefix;function d(d,e,f){if(!d.hovertemplate){var b=(e.hi||d.hoverinfo).split("+"),g=-1!==b.indexOf("all"),i=-1!==b.indexOf("lon"),j=-1!==b.indexOf("lat"),c=e.lonlat,a=[];return g||i&&j?a.push("("+k(c[1])+", "+k(c[0])+")"):i?a.push(f.lon+k(c[0])):j&&a.push(f.lat+k(c[1])),(g|| -1!==b.indexOf("text"))&&h(e,d,a),a.join("<br>")}function k(a){return a+"\xb0"}}b.exports={hoverPoints:function(a,h,z){var k=a.cd,b=k[0].trace,u=a.xa,v=a.ya,m=a.subplot,w=[],x=j+b.uid+"-circle",y=b.cluster&&b.cluster.enabled;y&&(w=m.map.queryRenderedFeatures(null,{layers:[x]}).map(function(a){return a.id}));var n=360*(h>=0?Math.floor((h+180)/360):Math.ceil((h-180)/360)),A=h-n;if(f.getClosest(k,function(a){var b=a.lonlat;if(b[0]===i)return 1/0;if(y&& -1===w.indexOf(a.i+1))return 1/0;var d=c.modHalf(b[0],360),e=b[1],f=m.project([d,e]),g=f.x-u.c2p([A,e]),h=f.y-v.c2p([d,z]),j=Math.max(3,a.mrc||0);return Math.max(Math.sqrt(g*g+h*h)-j,1-3/j)},a),!1!==a.index){var e=k[a.index],o=e.lonlat,p=[c.modHalf(o[0],360)+n,o[1]],q=u.c2p(p),r=v.c2p(p),l=e.mrc||1;a.x0=q-l,a.x1=q+l,a.y0=r-l,a.y1=r+l;var s={};s[b.subplot]={_subplot:m};var t=b._module.formatLabels(e,b,s);return a.lonLabel=t.lonLabel,a.latLabel=t.latLabel,a.color=g(b,e),a.extraText=d(b,e,k[0].t.labels),a.hovertemplate=b.hovertemplate,[a]}},getExtraText:d}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("../scattergeo/calc"),plot:a("./plot"),hoverPoints:a("./hover").hoverPoints,eventData:a("./event_data"),selectPoints:a("./select"),styleOnSelect:function(b,a){a&&a[0].trace._glTrace.update(a)},moduleType:"trace",name:"scattermapbox",basePlotModule:a("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(b,c,e){"use strict";var f=b("../../lib"),g=b("./convert"),h=b("../../plots/mapbox/constants").traceLayerPrefix,i={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function d(b,a,c){this.type="scattermapbox",this.subplot=b,this.uid=a,this.clusterEnabled=c,this.sourceIds={fill:"source-"+a+"-fill",line:"source-"+a+"-line",circle:"source-"+a+"-circle",symbol:"source-"+a+"-symbol",cluster:"source-"+a+"-circle",clusterCount:"source-"+a+"-circle"},this.layerIds={fill:h+a+"-fill",line:h+a+"-line",circle:h+a+"-circle",symbol:h+a+"-symbol",cluster:h+a+"-cluster",clusterCount:h+a+"-cluster-count"},this.below=null}var a=d.prototype;a.addSource=function(c,d,a){var b={type:"geojson",data:d.geojson};a&&a.enabled&&f.extendFlat(b,{cluster:!0,clusterMaxZoom:a.maxzoom}),this.subplot.map.addSource(this.sourceIds[c],b)},a.setSourceData=function(a,b){this.subplot.map.getSource(this.sourceIds[a]).setData(b.geojson)},a.addLayer=function(b,a,d){var c={type:a.type,id:this.layerIds[b],source:this.sourceIds[b],layout:a.layout,paint:a.paint};a.filter&&(c.filter=a.filter),this.subplot.addLayer(c,d)},a.update=function(l){var a,b,c,f=l[0].trace,m=this.subplot,d=m.map,h=g(m.gd,l),e=m.belowLookup["trace-"+this.uid],j=!!(f.cluster&&f.cluster.enabled),n=!!this.clusterEnabled;if(e!==this.below){var k=i.nonCluster;for(a=k.length-1;a>=0;a--)b=k[a],d.removeLayer(this.layerIds[b]);for(a=0;a<k.length;a++)c=h[b=k[a]],this.addLayer(b,c,e);this.below=e}else if(j&&!n){for(a=i.nonCluster.length-1;a>=0;a--)b=i.nonCluster[a],d.removeLayer(this.layerIds[b]),d.removeSource(this.sourceIds[b]);for(this.addSource("circle",h.circle,f.cluster),a=0;a<i.cluster.length;a++)c=h[b=i.cluster[a]],this.addLayer(b,c,e);this.clusterEnabled=j}else if(!j&&n){for(a=0;a<i.cluster.length;a++)b=i.cluster[a],d.removeLayer(this.layerIds[b]);for(d.removeSource(this.sourceIds.circle),a=0;a<i.nonCluster.length;a++)c=h[b=i.nonCluster[a]],this.addSource(b,c,f.cluster),this.addLayer(b,c,e);this.clusterEnabled=j}l[0].trace._glTrace=this},a.dispose=function(){for(var b=this.subplot.map,c=this.clusterEnabled?i.cluster:i.nonCluster,a=c.length-1;a>=0;a--){var d=c[a];b.removeLayer(this.layerIds[d]),b.removeSource(this.sourceIds[d])}},c.exports=function(h,j){var a,e,f,c=j[0].trace,l=c.cluster&&c.cluster.enabled,b=new d(h,c.uid,l),k=g(h.gd,j),m=b.below=h.belowLookup["trace-"+c.uid];if(l)for(b.addSource("circle",k.circle,c.cluster),a=0;a<i.cluster.length;a++)f=k[e=i.cluster[a]],b.addLayer(e,f,m);else for(a=0;a<i.nonCluster.length;a++)f=k[e=i.nonCluster[a]],b.addSource(e,f,c.cluster),b.addLayer(e,f,m);return j[0].trace._glTrace=b,b}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../../constants/numerical").BADNUM;b.exports=function(g,i){var a,b=g.cd,l=g.xaxis,m=g.yaxis,j=[],n=b[0].trace;if(!e.hasMarkers(n))return[];if(!1===i)for(a=0;a<b.length;a++)b[a].selected=0;else for(a=0;a<b.length;a++){var h=b[a],c=h.lonlat;if(c[0]!==f){var k=[d.modHalf(c[0],360),c[1]],o=[l.c2p(k),m.c2p(k)];i.contains(o,null,a,g)?(j.push({pointNumber:a,lon:c[0],lat:c[1]}),h.selected=1):h.selected=0}}return j}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(c,e,i){"use strict";var f=c("../../plots/template_attributes").hovertemplateAttrs,g=c("../../plots/template_attributes").texttemplateAttrs,d=c("../../lib/extend").extendFlat,a=c("../scatter/attributes"),h=c("../../plots/attributes"),b=a.line;e.exports={mode:a.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:a.text,texttemplate:g({editType:"plot"},{keys:["r","theta","text"]}),hovertext:a.hovertext,line:{color:b.color,width:b.width,dash:b.dash,backoff:b.backoff,shape:d({},b.shape,{values:["linear","spline"]}),smoothing:b.smoothing,editType:"calc"},connectgaps:a.connectgaps,marker:a.marker,cliponaxis:d({},a.cliponaxis,{dflt:!1}),textposition:a.textposition,textfont:a.textfont,fill:d({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,hoverinfo:d({},h.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:a.hoveron,hovertemplate:f(),selected:a.selected,unselected:a.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../constants/numerical").BADNUM,f=a("../../plots/cartesian/axes"),g=a("../scatter/colorscale_calc"),h=a("../scatter/arrays_to_calcdata"),i=a("../scatter/calc_selection"),j=a("../scatter/calc").calcMarkerSize;b.exports=function(m,a){for(var n=m._fullLayout,o=a.subplot,p=n[o].radialaxis,t=n[o].angularaxis,q=p.makeCalcdata(a,"r"),u=t.makeCalcdata(a,"theta"),k=a._length,c=new Array(k),b=0;b<k;b++){var r=q[b],s=u[b],l=c[b]={};d(r)&&d(s)?(l.r=r,l.theta=s):l.r=e}var v=j(a,k);return a._extremes.x=f.findExtremes(p,q,{ppad:v}),g(m,a),h(c,a),i(c,a),c}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(a,b,d){"use strict";var e=a("../../lib"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/line_shape_defaults"),j=a("../scatter/text_defaults"),k=a("../scatter/fillcolor_defaults"),l=a("../scatter/constants").PTS_LINESONLY,m=a("./attributes");function c(f,e,g,a){var b,c=a("r"),d=a("theta");if(c)d?b=Math.min(c.length,d.length):(b=c.length,a("theta0"),a("dtheta"));else{if(!d)return 0;b=e.theta.length,a("r0"),a("dr")}return e._length=b,b}b.exports={handleRThetaDefaults:c,supplyDefaults:function(d,a,o,n){function b(b,c){return e.coerce(d,a,m,b,c)}var q=c(d,a,n,b);if(!q){a.visible=!1;return}b("thetaunit"),b("mode",q<l?"lines+markers":"lines"),b("text"),b("hovertext"),"fills"!==a.hoveron&&b("hovertemplate"),f.hasLines(a)&&(h(d,a,o,n,b,{backoff:!0}),i(d,a,b),b("connectgaps")),f.hasMarkers(a)&&g(d,a,o,n,b,{gradient:!0}),f.hasText(a)&&(b("texttemplate"),j(d,a,n,b));var p=[];(f.hasMarkers(a)||f.hasText(a))&&(b("cliponaxis"),b("marker.maxdisplayed"),p.push("points")),b("fill"),"none"===a.fill||(k(d,a,o,b),f.hasLines(a)||i(d,a,b)),("tonext"===a.fill||"toself"===a.fill)&&p.push("fills"),b("hoveron",p.join("+")||"points"),e.coerceSelectionMarkerOpacity(a,b)}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes");b.exports=function(f,h,i){var b,c,g={},a=i[h.subplot]._subplot;a?(b=a.radialAxis,c=a.angularAxis):(b=(a=i[h.subplot]).radialaxis,c=a.angularaxis);var j=b.c2l(f.r);g.rLabel=e.tickText(b,j,!0).text;var k="degrees"===c.thetaunit?d.rad2deg(f.theta):f.theta;return g.thetaLabel=e.tickText(c,k,!0).text,g}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(a,b,d){"use strict";var e=a("../scatter/hover");function c(e,b,d,a){var f=d.radialAxis,g=d.angularAxis;f._hovertitle="r",g._hovertitle="\u03B8";var h={};h[b.subplot]={_subplot:d};var i=b._module.formatLabels(e,b,h);a.rLabel=i.rLabel,a.thetaLabel=i.thetaLabel;var l=e.hi||b.hoverinfo,j=[];function k(a,b){j.push(a._hovertitle+": "+b)}if(!b.hovertemplate){var c=l.split("+");-1!==c.indexOf("all")&&(c=["r","theta","text"]),-1!==c.indexOf("r")&&k(f,a.rLabel),-1!==c.indexOf("theta")&&k(g,a.thetaLabel),-1!==c.indexOf("text")&&a.text&&(j.push(a.text),delete a.text),a.extraText=j.join("<br>")}}b.exports={hoverPoints:function(d,i,j,k){var b=e(d,i,j,k);if(b&& !1!==b[0].index){var a=b[0];if(void 0===a.index)return b;var f=d.subplot,g=a.cd[a.index],h=a.trace;if(f.isPtInside(g))return a.xLabelVal=void 0,a.yLabelVal=void 0,c(g,h,f,a),a.hovertemplate=h.hovertemplate,b}},makeHoverPointText:c}},{"../scatter/hover":947}],1016:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:a("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,selectPoints:a("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(a,b,c){"use strict";var d=a("../scatter/plot"),e=a("../../constants/numerical").BADNUM;b.exports=function(n,a,g){for(var o=a.layers.frontplot.select("g.scatterlayer"),i=a.xaxis,j=a.yaxis,p={xaxis:i,yaxis:j,plot:a.framework,layerClipId:a._hasClipOnAxisFalse?a.clipIds.forTraces:null},q=a.radialAxis,r=a.angularAxis,h=0;h<g.length;h++)for(var c=g[h],f=0;f<c.length;f++){0===f&&(c[0].trace._xA=i,c[0].trace._yA=j);var b=c[f],k=b.r;if(k===e)b.x=b.y=e;else{var l=q.c2g(k),m=r.c2g(b.theta);b.x=l*Math.cos(m),b.y=l*Math.sin(m)}}d(n,p,g,o)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(c,d,f){"use strict";var a=c("../scatterpolar/attributes"),b=c("../scattergl/attributes"),e=c("../../plots/template_attributes").texttemplateAttrs;d.exports={mode:a.mode,r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,text:a.text,texttemplate:e({editType:"plot"},{keys:["r","theta","text"]}),hovertext:a.hovertext,hovertemplate:a.hovertemplate,line:b.line,connectgaps:b.connectgaps,marker:b.marker,fill:b.fill,fillcolor:b.fillcolor,textposition:b.textposition,textfont:b.textfont,hoverinfo:a.hoverinfo,selected:a.selected,unselected:a.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:a("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),hoverPoints:a("./hover").hoverPoints,selectPoints:a("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(a,b,c){"use strict";var d=a("../scatter/colorscale_calc"),e=a("../scatter/calc").calcMarkerSize,f=a("../scattergl/convert"),g=a("../../plots/cartesian/axes"),h=a("../scattergl/constants").TOO_MANY_POINTS;b.exports=function(k,a){var l,n=k._fullLayout,o=a.subplot,p=n[o].radialaxis,q=n[o].angularaxis,c=a._r=p.makeCalcdata(a,"r"),i=a._theta=q.makeCalcdata(a,"theta"),b=a._length,j={};b<c.length&&(c=c.slice(0,b)),b<i.length&&(i=i.slice(0,b)),j.r=c,j.theta=i,d(k,a);var m=j.opts=f.style(k,a);return b<h?l=e(a,b):m.marker&&(l=2*(m.marker.sizeAvg||Math.max(m.marker.size,3))),a._extremes.x=g.findExtremes(p,c,{ppad:l}),[{x:!1,y:!1,t:j,trace:a}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatterpolar/defaults").handleRThetaDefaults,g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/text_defaults"),j=a("../scatter/fillcolor_defaults"),k=a("../scatter/constants").PTS_LINESONLY,l=a("./attributes");b.exports=function(c,b,n,m){function a(a,e){return d.coerce(c,b,l,a,e)}var o=f(c,b,m,a);if(!o){b.visible=!1;return}a("thetaunit"),a("mode",o<k?"lines+markers":"lines"),a("text"),a("hovertext"),"fills"!==b.hoveron&&a("hovertemplate"),e.hasLines(b)&&(h(c,b,n,m,a),a("connectgaps")),e.hasMarkers(b)&&g(c,b,n,m,a,{noAngleRef:!0,noStandOff:!0}),e.hasText(b)&&(a("texttemplate"),i(c,b,m,a)),a("fill"),"none"!==b.fill&&j(c,b,n,a),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(a,b,c){"use strict";var d=a("../scatterpolar/format_labels");b.exports=function(a,b,e){var c=a.i;return"r"in a||(a.r=b._r[c]),"theta"in a||(a.theta=b._theta[c]),d(a,b,e)}},{"../scatterpolar/format_labels":1014}],1023:[function(a,b,c){"use strict";var d=a("../scattergl/hover"),e=a("../scatterpolar/hover").makeHoverPointText;b.exports={hoverPoints:function(f,i,j,k){var g=f.cd[0].t,l=g.r,m=g.theta,b=d.hoverPoints(f,i,j,k);if(b&& !1!==b[0].index){var a=b[0];if(void 0===a.index)return b;var h=f.subplot,c=a.cd[a.index],n=a.trace;if(c.r=l[a.index],c.theta=m[a.index],h.isPtInside(c))return a.xLabelVal=void 0,a.yLabelVal=void 0,e(c,n,h,a),b}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(b,c,a){arguments[4][905][0].apply(a,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(a,b,c){"use strict";var d=a("@plotly/point-cluster"),e=a("fast-isnumeric"),f=a("../scattergl/plot"),g=a("../scattergl/scene_update"),h=a("../scattergl/convert"),i=a("../../lib"),j=a("../scattergl/constants").TOO_MANY_POINTS;b.exports=function(c,a,b){if(b.length){var k=a.radialAxis,l=a.angularAxis,m=g(c,a);return b.forEach(function(q){if(q&&q[0]&&q[0].trace){var x=q[0],n=x.trace,f=x.t,p=n._length,r=f.r,s=f.theta,b=f.opts,y=r.slice(),z=s.slice();for(o=0;o<r.length;o++)a.isPtInside({r:r[o],theta:s[o]})||(y[o]=NaN,z[o]=NaN);var g=new Array(2*p),t=Array(p),u=Array(p);for(o=0;o<p;o++){var o,v,w,A=y[o];if(e(A)){var B=k.c2g(A),C=l.c2g(z[o],n.thetaunit);v=B*Math.cos(C),w=B*Math.sin(C)}else v=w=NaN;t[o]=g[2*o]=v,u[o]=g[2*o+1]=w}f.tree=d(g),b.marker&&p>=j&&(b.marker.cluster=f.tree),b.marker&&(b.markerSel.positions=b.markerUnsel.positions=b.marker.positions=g),b.line&&g.length>1&&i.extendFlat(b.line,h.linePositions(c,n,g)),b.text&&(i.extendFlat(b.text,{positions:g},h.textPosition(c,n,b.text,b.marker)),i.extendFlat(b.textSel,{positions:g},h.textPosition(c,n,b.text,b.markerSel)),i.extendFlat(b.textUnsel,{positions:g},h.textPosition(c,n,b.text,b.markerUnsel))),b.fill&&!m.fill2d&&(m.fill2d=!0),b.marker&&!m.scatter2d&&(m.scatter2d=!0),b.line&&!m.line2d&&(m.line2d=!0),b.text&&!m.glText&&(m.glText=!0),m.lineOptions.push(b.line),m.fillOptions.push(b.fill),m.markerOptions.push(b.marker),m.markerSelectedOptions.push(b.markerSel),m.markerUnselectedOptions.push(b.markerUnsel),m.textOptions.push(b.text),m.textSelectedOptions.push(b.textSel),m.textUnselectedOptions.push(b.textUnsel),m.selectBatch.push([]),m.unselectBatch.push([]),f.x=t,f.y=u,f.rawx=t,f.rawy=u,f.r=r,f.theta=s,f.positions=g,f._scene=m,f.index=m.count,m.count++}}),f(c,a,b)}},b.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(c,e,i){"use strict";var f=c("../../plots/template_attributes").hovertemplateAttrs,g=c("../../plots/template_attributes").texttemplateAttrs,d=c("../../lib/extend").extendFlat,a=c("../scatter/attributes"),h=c("../../plots/attributes"),b=a.line;e.exports={mode:a.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:a.text,texttemplate:g({editType:"plot"},{keys:["real","imag","text"]}),hovertext:a.hovertext,line:{color:b.color,width:b.width,dash:b.dash,backoff:b.backoff,shape:d({},b.shape,{values:["linear","spline"]}),smoothing:b.smoothing,editType:"calc"},connectgaps:a.connectgaps,marker:a.marker,cliponaxis:d({},a.cliponaxis,{dflt:!1}),textposition:a.textposition,textfont:a.textfont,fill:d({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,hoverinfo:d({},h.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:a.hoveron,hovertemplate:f(),selected:a.selected,unselected:a.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../../constants/numerical").BADNUM,f=a("../scatter/colorscale_calc"),g=a("../scatter/arrays_to_calcdata"),h=a("../scatter/calc_selection"),i=a("../scatter/calc").calcMarkerSize;b.exports=function(l,a){for(var m=l._fullLayout,n=a.subplot,q=m[n].realaxis,r=m[n].imaginaryaxis,s=q.makeCalcdata(a,"real"),t=r.makeCalcdata(a,"imag"),j=a._length,c=new Array(j),b=0;b<j;b++){var o=s[b],p=t[b],k=c[b]={};d(o)&&d(p)?(k.real=o,k.imag=p):k.real=e}return i(a,j),f(l,a),g(c,a),h(c,a),c}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/subtypes"),f=a("../scatter/marker_defaults"),g=a("../scatter/line_defaults"),h=a("../scatter/line_shape_defaults"),i=a("../scatter/text_defaults"),j=a("../scatter/fillcolor_defaults"),k=a("../scatter/constants").PTS_LINESONLY,l=a("./attributes");b.exports=function(c,a,m,n){function b(b,e){return d.coerce(c,a,l,b,e)}var s,t,o,p,q,u=(s=a,p=(t=b)("real"),q=t("imag"),p&&q&&(o=Math.min(p.length,q.length)),s._length=o,o);if(!u){a.visible=!1;return}b("mode",u<k?"lines+markers":"lines"),b("text"),b("hovertext"),"fills"!==a.hoveron&&b("hovertemplate"),e.hasLines(a)&&(g(c,a,m,n,b,{backoff:!0}),h(c,a,b),b("connectgaps")),e.hasMarkers(a)&&f(c,a,m,n,b,{gradient:!0}),e.hasText(a)&&(b("texttemplate"),i(c,a,n,b));var r=[];(e.hasMarkers(a)||e.hasText(a))&&(b("cliponaxis"),b("marker.maxdisplayed"),r.push("points")),b("fill"),"none"===a.fill||(j(c,a,m,b),e.hasLines(a)||h(c,a,b)),("tonext"===a.fill||"toself"===a.fill)&&r.push("fills"),b("hoveron",r.join("+")||"points"),d.coerceSelectionMarkerOpacity(a,b)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes");b.exports=function(b,e,f){var a={},c=f[e.subplot]._subplot;return a.realLabel=d.tickText(c.radialAxis,b.real,!0).text,a.imagLabel=d.tickText(c.angularAxis,b.imag,!0).text,a}},{"../../plots/cartesian/axes":566}],1030:[function(a,b,d){"use strict";var e=a("../scatter/hover");function c(e,b,d,a){var f=d.radialAxis,g=d.angularAxis;f._hovertitle="real",g._hovertitle="imag";var h={};h[b.subplot]={_subplot:d};var i=b._module.formatLabels(e,b,h);a.realLabel=i.realLabel,a.imagLabel=i.imagLabel;var l=e.hi||b.hoverinfo,j=[];function k(a,b){j.push(a._hovertitle+": "+b)}if(!b.hovertemplate){var c=l.split("+");-1!==c.indexOf("all")&&(c=["real","imag","text"]),-1!==c.indexOf("real")&&k(f,a.realLabel),-1!==c.indexOf("imag")&&k(g,a.imagLabel),-1!==c.indexOf("text")&&a.text&&(j.push(a.text),delete a.text),a.extraText=j.join("<br>")}}b.exports={hoverPoints:function(d,i,j,k){var b=e(d,i,j,k);if(b&& !1!==b[0].index){var a=b[0];if(void 0===a.index)return b;var f=d.subplot,g=a.cd[a.index],h=a.trace;if(f.isPtInside(g))return a.xLabelVal=void 0,a.yLabelVal=void 0,c(g,h,f,a),a.hovertemplate=h.hovertemplate,b}},makeHoverPointText:c}},{"../scatter/hover":947}],1031:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"scattersmith",basePlotModule:a("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover").hoverPoints,selectPoints:a("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(a,b,c){"use strict";var d=a("../scatter/plot"),e=a("../../constants/numerical").BADNUM,f=a("../../plots/smith/helpers").smith;b.exports=function(n,a,h){for(var o=a.layers.frontplot.select("g.scatterlayer"),j=a.xaxis,k=a.yaxis,p={xaxis:j,yaxis:k,plot:a.framework,layerClipId:a._hasClipOnAxisFalse?a.clipIds.forTraces:null},i=0;i<h.length;i++)for(var c=h[i],g=0;g<c.length;g++){0===g&&(c[0].trace._xA=j,c[0].trace._yA=k);var b=c[g],l=b.real;if(l===e)b.x=b.y=e;else{var m=f([l,b.imag]);b.x=m[0],b.y=m[1]}}d(n,p,h,o)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(d,g,m){"use strict";var h=d("../../plots/template_attributes").hovertemplateAttrs,i=d("../../plots/template_attributes").texttemplateAttrs,a=d("../scatter/attributes"),j=d("../../plots/attributes"),f=d("../../components/colorscale/attributes"),k=d("../../components/drawing/attributes").dash,c=d("../../lib/extend").extendFlat,b=a.marker,e=a.line,l=b.line;g.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:c({},a.mode,{dflt:"markers"}),text:c({},a.text,{}),texttemplate:i({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:c({},a.hovertext,{}),line:{color:e.color,width:e.width,dash:k,backoff:e.backoff,shape:c({},e.shape,{values:["linear","spline"]}),smoothing:e.smoothing,editType:"calc"},connectgaps:a.connectgaps,cliponaxis:a.cliponaxis,fill:c({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:c({symbol:b.symbol,opacity:b.opacity,angle:b.angle,angleref:b.angleref,standoff:b.standoff,maxdisplayed:b.maxdisplayed,size:b.size,sizeref:b.sizeref,sizemin:b.sizemin,sizemode:b.sizemode,line:c({width:l.width,editType:"calc"},f("marker.line")),gradient:b.gradient,editType:"calc"},f("marker")),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:c({},j.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:a.hoveron,hovertemplate:h()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(a,b,c){"use strict";var d=a("fast-isnumeric"),e=a("../scatter/colorscale_calc"),f=a("../scatter/arrays_to_calcdata"),g=a("../scatter/calc_selection"),h=a("../scatter/calc").calcMarkerSize,i=["a","b","c"],j={a:["b","c"],b:["a","c"],c:["a","b"]};b.exports=function(u,b){var a,n,p,s,q,v,c,k,l,r,w,x,y=u._fullLayout[b.subplot].sum,z=b.sum||y,m={a:b.a,b:b.b,c:b.c};for(a=0;a<i.length;a++)if(!m[p=i[a]]){for(n=0,q=m[j[p][0]],v=m[j[p][1]],s=new Array(q.length);n<q.length;n++)s[n]=z-q[n]-v[n];m[p]=s}var t=b._length,o=new Array(t);for(a=0;a<t;a++)c=m.a[a],k=m.b[a],l=m.c[a],d(c)&&d(k)&&d(l)?(1!=(r=y/((c=+c)+(k=+k)+(l=+l)))&&(c*=r,k*=r,l*=r),x=c,w=l-k,o[a]={x:w,y:x,a:c,b:k,c:l}):o[a]={x:!1,y:!1};return h(b,t),e(u,b),f(o,b),g(o,b),o}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/constants"),f=a("../scatter/subtypes"),g=a("../scatter/marker_defaults"),h=a("../scatter/line_defaults"),i=a("../scatter/line_shape_defaults"),j=a("../scatter/text_defaults"),k=a("../scatter/fillcolor_defaults"),l=a("./attributes");b.exports=function(m,b,p,q){function a(a,c){return d.coerce(m,b,l,a,c)}var c,s=a("a"),o=a("b"),n=a("c");if(s?(c=s.length,o?(c=Math.min(c,o.length),n&&(c=Math.min(c,n.length))):c=n?Math.min(c,n.length):0):o&&n&&(c=Math.min(o.length,n.length)),!c){b.visible=!1;return}b._length=c,a("sum"),a("text"),a("hovertext"),"fills"!==b.hoveron&&a("hovertemplate"),a("mode",c<e.PTS_LINESONLY?"lines+markers":"lines"),f.hasLines(b)&&(h(m,b,p,q,a,{backoff:!0}),i(m,b,a),a("connectgaps")),f.hasMarkers(b)&&g(m,b,p,q,a,{gradient:!0}),f.hasText(b)&&(a("texttemplate"),j(m,b,q,a));var r=[];(f.hasMarkers(b)||f.hasText(b))&&(a("cliponaxis"),a("marker.maxdisplayed"),r.push("points")),a("fill"),"none"===b.fill||(k(m,b,p,a),f.hasLines(b)||i(m,b,a)),("tonext"===b.fill||"toself"===b.fill)&&r.push("fills"),a("hoveron",r.join("+")||"points"),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(b,a,c){"use strict";a.exports=function(a,b,f,d,e){if(b.xa&&(a.xaxis=b.xa),b.ya&&(a.yaxis=b.ya),d[e]){var c=d[e];a.a=c.a,a.b=c.b,a.c=c.c}else a.a=b.a,a.b=b.b,a.c=b.c;return a}},{}],1037:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes");b.exports=function(b,e,f){var a={},c=f[e.subplot]._subplot;return a.aLabel=d.tickText(c.aaxis,b.a,!0).text,a.bLabel=d.tickText(c.baxis,b.b,!0).text,a.cLabel=d.tickText(c.caxis,b.c,!0).text,a}},{"../../plots/cartesian/axes":566}],1038:[function(a,b,c){"use strict";var d=a("../scatter/hover");b.exports=function(h,n,o,p){var c=d(h,n,o,p);if(c&& !1!==c[0].index){var a=c[0];if(void 0===a.index){var q=1-a.y0/h.ya._length,k=h.xa._length,i=k*q/2,l=k-i;return a.x0=Math.max(Math.min(a.x0,l),i),a.x1=Math.max(Math.min(a.x1,l),i),c}var e=a.cd[a.index],b=a.trace,g=a.subplot;a.a=e.a,a.b=e.b,a.c=e.c,a.xLabelVal=void 0,a.yLabelVal=void 0;var m={};m[b.subplot]={_subplot:g};var j=b._module.formatLabels(e,b,m);a.aLabel=j.aLabel,a.bLabel=j.bLabel,a.cLabel=j.cLabel;var r=e.hi||b.hoverinfo,s=[];if(!b.hovertemplate){var f=r.split("+");-1!==f.indexOf("all")&&(f=["a","b","c"]),-1!==f.indexOf("a")&&t(g.aaxis,a.aLabel),-1!==f.indexOf("b")&&t(g.baxis,a.bLabel),-1!==f.indexOf("c")&&t(g.caxis,a.cLabel)}return a.extraText=s.join("<br>"),a.hovertemplate=b.hovertemplate,c}function t(a,b){s.push(a._hovertitle+": "+b)}}},{"../scatter/hover":947}],1039:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),formatLabels:a("./format_labels"),calc:a("./calc"),plot:a("./plot"),style:a("../scatter/style").style,styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../scatter/select"),eventData:a("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:a("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(a,b,c){"use strict";var d=a("../scatter/plot");b.exports=function(i,a,b){var f=a.plotContainer;f.select(".scatterlayer").selectAll("*").remove();for(var g=a.xaxis,h=a.yaxis,j={xaxis:g,yaxis:h,plot:f,layerClipId:a._hasClipOnAxisFalse?a.clipIdRelative:null},k=a.layers.frontplot.select("g.scatterlayer"),c=0;c<b.length;c++){var e=b[c];e.length&&(e[0].trace._xA=g,e[0].trace._yA=h)}d(i,j,b,k)}},{"../scatter/plot":957}],1041:[function(b,i,o){"use strict";var j=b("../scatter/attributes"),f=b("../../components/colorscale/attributes"),g=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=b("../../plots/template_attributes").hovertemplateAttrs,d=b("../scattergl/attributes"),p=b("../../plots/cartesian/constants").idRegex,l=b("../../plot_api/plot_template").templatedArray,c=b("../../lib/extend").extendFlat,a=j.marker,m=a.line,n=c(f("marker.line",{editTypeOverride:"calc"}),{width:c({},m.width,{editType:"calc"}),editType:"calc"}),e=c(f("marker"),{symbol:a.symbol,angle:a.angle,size:c({},a.size,{editType:"markerSize"}),sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,opacity:a.opacity,colorbar:a.colorbar,line:n,editType:"calc"});function h(a){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:p[a],editType:"plot"}}}e.color.editType=e.cmin.editType=e.cmax.editType="style",i.exports={dimensions:l("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:c({},d.text,{}),hovertext:c({},d.hovertext,{}),hovertemplate:k(),xhoverformat:g("x"),yhoverformat:g("y"),marker:e,xaxes:h("x"),yaxes:h("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:d.selected.marker,editType:"calc"},unselected:{marker:d.unselected.marker,editType:"calc"},opacity:d.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(a,b,e){"use strict";var c=a("../../registry"),d=a("../../components/grid");b.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:a("../scatter/marker_colorbar"),calc:a("./calc"),plot:a("./plot"),hoverPoints:a("./hover").hoverPoints,selectPoints:a("./select"),editStyle:a("./edit_style"),meta:{}},c.register(d)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(a,c,g){"use strict";var h=a("regl-line2d"),i=a("../../registry"),j=a("../../lib/prepare_regl"),k=a("../../plots/get_data").getModuleCalcData,b=a("../../plots/cartesian"),l=a("../../plots/cartesian/axis_ids").getFromId,m=a("../../plots/cartesian/axes").shouldShowZeroLine,d="splom",e={};function n(h,g,a){for(var k=a.matrixOptions.data.length,i=g._visibleDims,d=a.viewOpts.ranges=new Array(k),e=0;e<i.length;e++){var j=i[e],f=d[e]=new Array(4),b=l(h,g._diag[j][0]);b&&(f[0]=b.r2l(b.range[0]),f[2]=b.r2l(b.range[1]));var c=l(h,g._diag[j][1]);c&&(f[1]=c.r2l(c.range[0]),f[3]=c.r2l(c.range[1]))}a.selectBatch.length||a.unselectBatch.length?a.matrix.update({ranges:d},{ranges:d}):a.matrix.update({ranges:d})}function f(c){var a=c._fullLayout,d=a._glcanvas.data()[0].regl,b=a._splomGrid;b||(b=a._splomGrid=h(d)),b.update(o(c))}function o(h){var k=h._context.plotGlPixelRatio,g=h._fullLayout,l=g._size,w=[0,0,g.width*k,g.height*k],n={};function i(f,g,a,b,c,d){a*=k,b*=k,c*=k,d*=k;var h=g[f+"color"],i=g[f+"width"],e=String(h+i);e in n?n[e].data.push(NaN,NaN,a,b,c,d):n[e]={data:[a,b,c,d],join:"rect",thickness:i*k,color:h,viewport:w,range:w,overlay:!1}}for(b in g._splomSubplots){var b,d,j,o=g._plots[b],c=o.xaxis,a=o.yaxis,p=c._gridVals,q=a._gridVals,e=c._offset,r=c._length,s=a._length,f=l.b+a.domain[0]*l.h,t=-a._m,u=-t*a.r2l(a.range[0],a.calendar);if(c.showgrid)for(b=0;b<p.length;b++)d=e+c.l2p(p[b].x),i("grid",c,d,f,d,f+s);if(a.showgrid)for(b=0;b<q.length;b++)i("grid",a,e,j=f+u+t*q[b].x,e+r,j);m(h,c,a)&&(d=e+c.l2p(0),i("zeroline",c,d,f,d,f+s)),m(h,a,c)&&i("zeroline",a,e,j=f+u+0,e+r,j)}var v=[];for(b in n)v.push(n[b]);return v}c.exports={name:d,attr:b.attr,attrRegex:b.attrRegex,layoutAttributes:b.layoutAttributes,supplyLayoutDefaults:b.supplyLayoutDefaults,drawFramework:b.drawFramework,plot:function(a){var c=a._fullLayout,b=i.getModule(d),g=k(a.calcdata,b)[0],h=j(a,["ANGLE_instanced_arrays","OES_element_index_uint"],e);h&&(c._hasOnlyLargeSploms&&f(a),b.plot(a,{},g))},drag:function(a){var e=a.calcdata,g=a._fullLayout;g._hasOnlyLargeSploms&&f(a);for(var b=0;b<e.length;b++){var c=e[b][0].trace,d=g._splomScenes[c.uid];"splom"===c.type&&d&&d.matrix&&n(a,c,d)}},updateGrid:f,clean:function(e,h,f,a){var c,i={};if(a._splomScenes){for(c=0;c<e.length;c++){var j=e[c];"splom"===j.type&&(i[j.uid]=1)}for(c=0;c<f.length;c++){var d=f[c];if(!i[d.uid]){var g=a._splomScenes[d.uid];g&&g.destroy&&g.destroy(),a._splomScenes[d.uid]=null,delete a._splomScenes[d.uid]}}}0===Object.keys(a._splomScenes||{}).length&&delete a._splomScenes,a._splomGrid&& !h._hasOnlyLargeSploms&&a._hasOnlyLargeSploms&&(a._splomGrid.destroy(),a._splomGrid=null,delete a._splomGrid),b.clean(e,h,f,a)},updateFx:b.updateFx,toSVG:b.toSVG,reglPrecompiled:e}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axis_ids"),f=a("../scatter/calc").calcMarkerSize,g=a("../scatter/calc").calcAxisExpansion,h=a("../scatter/colorscale_calc"),i=a("../scattergl/convert").markerSelection,j=a("../scattergl/convert").markerStyle,k=a("./scene_update"),l=a("../../constants/numerical").BADNUM,m=a("../scattergl/constants").TOO_MANY_POINTS;b.exports=function(c,a){var b,p,s,o,n,w,t=a.dimensions,x=a._length,q={},u=q.cdata=[],A=q.data=[],v=a._visibleDims=[];function y(e,f){for(var b=e.makeCalcdata({v:f.values,vcalendar:a.calendar},"v"),c=0;c<b.length;c++)b[c]=b[c]===l?NaN:b[c];u.push(b),A.push("log"===e.type?d.simpleMap(b,e.c2l):b)}for(b=0;b<t.length;b++)if((s=t[b]).visible){if(o=e.getFromId(c,a._diag[b][0]),n=e.getFromId(c,a._diag[b][1]),o&&n&&o.type!==n.type){d.log("Skipping splom dimension "+b+" with conflicting axis types");continue}o?(y(o,s),n&&"category"===n.type&&(n._categories=o._categories.slice())):y(n,s),v.push(b)}h(c,a),d.extendFlat(q,j(c,a));var z=u.length;for(p=0,w=z*x>m?q.sizeAvg||Math.max(q.size,3):f(a,x);p<v.length;p++)s=t[b=v[p]],o=e.getFromId(c,a._diag[b][0])||{},n=e.getFromId(c,a._diag[b][1])||{},g(c,a,o,n,u[p],u[p],w);var r=k(c,a);return r.matrix||(r.matrix=!0),r.matrixOptions=q,r.selectedOptions=i(c,a,a.selected),r.unselectedOptions=i(c,a,a.unselected),[{x:!1,y:!1,t:{},trace:a}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/array_container_defaults"),f=a("./attributes"),g=a("../scatter/subtypes"),h=a("../scatter/marker_defaults"),i=a("../parcoords/merge_length"),j=a("../scattergl/helpers").isOpenSymbol;function k(e,c){function a(a,b){return d.coerce(e,c,f.dimensions,a,b)}a("label");var b=a("values");b&&b.length?a("visible"):c.visible=!1,a("axis.type"),a("axis.matches")}b.exports=function(c,b,m,l){function a(a,e){return d.coerce(c,b,f,a,e)}var n=e(c,b,{name:"dimensions",handleItemDefaults:k}),o=a("diagonal.visible"),p=a("showupperhalf"),q=a("showlowerhalf"),r=i(b,n,"values");if(!r|| !o&&!p&&!q){b.visible=!1;return}a("text"),a("hovertext"),a("hovertemplate"),a("xhoverformat"),a("yhoverformat"),h(c,b,m,l,a,{noAngleRef:!0,noStandOff:!0});var s=j(b.marker.symbol),t=g.isBubble(b);a("marker.line.width",s||t?1:0),function(B,b,e,n){var a,c,o=b.dimensions,d=o.length,g=b.showupperhalf,f=b.showlowerhalf,h=b.diagonal.visible,p=new Array(d),q=new Array(d);for(a=0;a<d;a++){var r=a?a+1:"";p[a]="x"+r,q[a]="y"+r}var y=n("xaxes",p),z=n("yaxes",q),A=b._diag=new Array(d);b._xaxes={},b._yaxes={};var k=[],l=[];function s(c,h,a,i){if(c){var f=c.charAt(0),g=e._splomAxes[f];if(b["_"+f+"axes"][c]=1,i.push(c),!(c in g)){var d=g[c]={};a&&(d.label=a.label||"",a.visible&&a.axis&&(a.axis.type&&(d.type=a.axis.type),a.axis.matches&&(d.matches=h)))}}}var t=!h&&!f,u=!h&&!g;for(a=0,b._axesDim={};a<d;a++){var v=o[a],w=0===a,x=a===d-1,i=w&&t||x&&u?void 0:y[a],j=w&&u||x&&t?void 0:z[a];s(i,j,v,k),s(j,i,v,l),A[a]=[i,j],b._axesDim[i]=a,b._axesDim[j]=a}for(a=0;a<k.length;a++)for(c=0;c<l.length;c++){var m=k[a]+l[c];a>c&&g?e._splomSubplots[m]=1:a<c&&f?e._splomSubplots[m]=1:a!==c|| !h&&f&&g||(e._splomSubplots[m]=1)}(!f|| !h&&g&&f)&&(e._splomGridDflt.xside="bottom",e._splomGridDflt.yside="left")}(c,b,l,a),d.coerceSelectionMarkerOpacity(b,a)}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../scatter/colorscale_calc"),f=a("../scattergl/convert").markerStyle;b.exports=function(b,g){var c=g.trace,a=b._fullLayout._splomScenes[c.uid];if(a){e(b,c),d.extendFlat(a.matrixOptions,f(b,c));var h=d.extendFlat({},a.matrixOptions,a.viewOpts);a.matrix.update(h,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(b,c,a){"use strict";a.getDimIndex=function(b,e){for(var c=e._id,f={x:0,y:1}[c.charAt(0)],d=b._visibleDims,a=0;a<d.length;a++){var g=d[a];if(b._diag[g][f]===c)return a}return!1}},{}],1048:[function(a,b,c){"use strict";var d=a("./helpers"),e=a("../scattergl/hover").calcHover;b.exports={hoverPoints:function(a,s,t){var c,k,f=a.cd[0].trace,l=a.scene.matrixOptions.cdata,g=a.xa,h=a.ya,u=g.c2p(s),v=h.c2p(t),w=a.distance,m=d.getDimIndex(f,g),n=d.getDimIndex(f,h);if(!1===m|| !1===n)return[a];for(var i=l[m],o=l[n],j=w,b=0;b<i.length;b++){var x=i[b],y=o[b],p=g.c2p(x)-u,q=h.c2p(y)-v,r=Math.sqrt(p*p+q*q);r<j&&(j=k=r,c=b)}return(a.index=c,a.distance=j,a.dxy=k,void 0===c)?[a]:[e(a,i,o,f)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(a,c,d){"use strict";var b=a("./base_index");b.basePlotModule=a("./base_plot"),c.exports=b},{"./base_index":1042,"./base_plot":1043}],1050:[function(a,b,c){"use strict";var d=a("regl-splom"),e=a("../../lib"),f=a("../../plots/cartesian/axis_ids"),g=a("../../components/dragelement/helpers").selectMode;function h(n,y){var k,l,b,i,a,o=n._fullLayout,q=o._size,c=y.trace,r=y.t,h=o._splomScenes[c.uid],m=h.matrixOptions,s=m.cdata,H=o._glcanvas.data()[0].regl,I=o.dragmode;if(0!==s.length){m.lower=c.showupperhalf,m.upper=c.showlowerhalf,m.diagonal=c.diagonal.visible;var t=c._visibleDims,u=s.length,j=h.viewOpts={};for(a=0,j.ranges=new Array(u),j.domains=new Array(u);a<t.length;a++){b=t[a];var v=j.ranges[a]=new Array(4),w=j.domains[a]=new Array(4);(k=f.getFromId(n,c._diag[b][0]))&&(v[0]=k._rl[0],v[2]=k._rl[1],w[0]=k.domain[0],w[2]=k.domain[1]),(l=f.getFromId(n,c._diag[b][1]))&&(v[1]=l._rl[0],v[3]=l._rl[1],w[1]=l.domain[0],w[3]=l.domain[1])}var x=n._context.plotGlPixelRatio,z=q.l*x,A=q.b*x,J=q.w*x,K=q.h*x;j.viewport=[z,A,J+z,K+A],!0===h.matrix&&(h.matrix=d(H));var L=o.clickmode.indexOf("select")> -1,M=g(I)||!!c.selectedpoints||L,B=!0;if(M){var p=c._length;if(c.selectedpoints){h.selectBatch=c.selectedpoints;var C=c.selectedpoints,D={};for(b=0;b<C.length;b++)D[C[b]]=!0;var E=[];for(b=0;b<p;b++)D[b]||E.push(b);h.unselectBatch=E}var F=r.xpx=new Array(u),G=r.ypx=new Array(u);for(a=0;a<t.length;a++){if(b=t[a],k=f.getFromId(n,c._diag[b][0]))for(i=0,F[a]=new Array(p);i<p;i++)F[a][i]=k.c2p(s[a][i]);if(l=f.getFromId(n,c._diag[b][1]))for(i=0,G[a]=new Array(p);i<p;i++)G[a][i]=l.c2p(s[a][i])}if(h.selectBatch.length||h.unselectBatch.length){var N=e.extendFlat({},m,h.unselectedOptions,j),O=e.extendFlat({},m,h.selectedOptions,j);h.matrix.update(N,O),B=!1}}else r.xpx=r.ypx=null;if(B){var P=e.extendFlat({},m,j);h.matrix.update(P,null)}}}b.exports=function(c,d,a){if(a.length)for(var b=0;b<a.length;b++)h(c,a[b][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(a,b,c){"use strict";var d=a("../../lib");b.exports=function(g,c){var e=g._fullLayout,h=c.uid,b=e._splomScenes;b||(b=e._splomScenes={});var f={dirty:!0,selectBatch:[],unselectBatch:[]},a=b[c.uid];return a||((a=b[h]=d.extendFlat({},f,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){a.matrix&&a.matrix.draw&&(a.selectBatch.length||a.unselectBatch.length?a.matrix.draw(a.unselectBatch,a.selectBatch):a.matrix.draw()),a.dirty=!1},a.destroy=function(){a.matrix&&a.matrix.destroy&&a.matrix.destroy(),a.matrixOptions=null,a.selectBatch=null,a.unselectBatch=null,a=null}),a.dirty||d.extendFlat(a,f),a}},{"../../lib":515}],1052:[function(a,b,d){"use strict";var c=a("../../lib"),e=c.pushUnique,f=a("../scatter/subtypes"),g=a("./helpers");b.exports=function(d,k){var o=d.cd,h=o[0].trace,p=o[0].t,a=d.scene,q=a.matrixOptions.cdata,t=d.xaxis,u=d.yaxis,i=[];if(!a)return i;var v=!f.hasMarkers(h)&&!f.hasText(h);if(!0!==h.visible||v)return i;var l=g.getDimIndex(h,t),m=g.getDimIndex(h,u);if(!1===l|| !1===m)return i;var w=p.xpx[l],x=p.ypx[m],r=q[l],y=q[m],j=(d.scene.selectBatch||[]).slice(),n=[];if(!1!==k&&!k.degenerate)for(var b=0;b<r.length;b++)k.contains([w[b],x[b]],null,b,d)?(i.push({pointNumber:b,x:r[b],y:y[b]}),e(j,b)):-1!==j.indexOf(b)?e(j,b):n.push(b);var s=a.matrixOptions;return j.length||n.length?a.selectBatch.length||a.unselectBatch.length||a.matrix.update(a.unselectedOptions,c.extendFlat({},s,a.selectedOptions,a.viewOpts)):a.matrix.update(s,null),a.selectBatch=j,a.unselectBatch=n,i}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(a,f,i){"use strict";var g=a("../../components/colorscale/attributes"),b=a("../../plots/cartesian/axis_format_attributes").axisHoverFormat,h=a("../../plots/template_attributes").hovertemplateAttrs,j=a("../mesh3d/attributes"),e=a("../../plots/attributes"),d=a("../../lib/extend").extendFlat,c={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:h({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:b("u",1),vhoverformat:b("v",1),whoverformat:b("w",1),xhoverformat:b("x"),yhoverformat:b("y"),zhoverformat:b("z"),showlegend:d({},e.showlegend,{dflt:!1})};d(c,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(a){c[a]=j[a]}),c.hoverinfo=d({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),c.transforms=void 0,f.exports=c},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(a,b,e){"use strict";var f=a("../../lib"),g=a("../../components/colorscale/calc");function c(d){var b,e,g,o,p,q,r,D,s,E,t,F,j=d._x,k=d._y,l=d._z,c=d._len,u=-1/0,v=1/0,w=-1/0,x=1/0,y=-1/0,z=1/0,a="";for(c&&(r=j[0],s=k[0],t=l[0]),c>1&&(D=j[c-1],E=k[c-1],F=l[c-1]),b=0;b<c;b++)u=Math.max(u,j[b]),v=Math.min(v,j[b]),w=Math.max(w,k[b]),x=Math.min(x,k[b]),y=Math.max(y,l[b]),z=Math.min(z,l[b]),o||j[b]===r||(o=!0,a+="x"),p||k[b]===s||(p=!0,a+="y"),q||l[b]===t||(q=!0,a+="z");o||(a+="x"),p||(a+="y"),q||(a+="z");var G=h(d._x),H=h(d._y),I=h(d._z);a=(a=(a=a.replace("x",(r>D?"-":"+")+"x")).replace("y",(s>E?"-":"+")+"y")).replace("z",(t>F?"-":"+")+"z");var J=function(){c=0,G=[],H=[],I=[]};(!c||c<G.length*H.length*I.length)&&J();var i=function(a){return"x"===a?j:"y"===a?k:l},A=function(a){return"x"===a?G:"y"===a?H:I},B=function(a){return a[c-1]<a[0]?-1:1},K=i(a[1]),L=i(a[3]),M=i(a[5]),Q=A(a[1]).length,R=A(a[3]).length,S=A(a[5]).length,m=!1,n=function(a,b,c){return Q*(R*a+b)+c},N=B(i(a[1])),O=B(i(a[3])),P=B(i(a[5]));for(b=0;b<S-1;b++){for(e=0;e<R-1;e++){for(g=0;g<Q-1;g++){var C=n(b,e,g),T=n(b,e,g+1),U=n(b,e+1,g),V=n(b+1,e,g);if(K[C]*N<K[T]*N&&L[C]*O<L[U]*O&&M[C]*P<M[V]*P||(m=!0),m)break}if(m)break}if(m)break}return m&&(f.warn("Encountered arbitrary coordinates! Unable to input data grid."),J()),{xMin:v,yMin:x,zMin:z,xMax:u,yMax:w,zMax:y,Xs:G,Ys:H,Zs:I,len:c,fill:a}}function h(a){return f.distinctVals(a).vals}function d(a,b){if(void 0===b&&(b=a.length),f.isTypedArray(a))return a.subarray(0,b);for(var d=[],c=0;c<b;c++)d[c]=+a[c];return d}b.exports={calc:function(t,a){a._len=Math.min(a.u.length,a.v.length,a.w.length,a.x.length,a.y.length,a.z.length),a._u=d(a.u,a._len),a._v=d(a.v,a._len),a._w=d(a.w,a._len),a._x=d(a.x,a._len),a._y=d(a.y,a._len),a._z=d(a.z,a._len);var f,h,i,e,b=c(a);a._gridFill=b.fill,a._Xs=b.Xs,a._Ys=b.Ys,a._Zs=b.Zs,a._len=b.len;var k=0;a.starts&&(f=d(a.starts.x||[]),h=d(a.starts.y||[]),i=d(a.starts.z||[]),k=Math.min(f.length,h.length,i.length)),a._startsX=f||[],a._startsY=h||[],a._startsZ=i||[];var j=0,l=1/0;for(e=0;e<a._len;e++){var m=a._u[e],n=a._v[e],o=a._w[e],p=Math.sqrt(m*m+n*n+o*o);j=Math.max(j,p),l=Math.min(l,p)}for(g(t,a,{vals:[l,j],containerStr:"",cLetter:"c"}),e=0;e<k;e++){var q=f[e];b.xMax=Math.max(b.xMax,q),b.xMin=Math.min(b.xMin,q);var r=h[e];b.yMax=Math.max(b.yMax,r),b.yMin=Math.min(b.yMin,r);var s=i[e];b.zMax=Math.max(b.zMax,s),b.zMin=Math.min(b.zMin,s)}a._slen=k,a._normMax=j,a._xbnds=[b.xMin,b.xMax],a._ybnds=[b.yMin,b.yMax],a._zbnds=[b.zMin,b.zMax]},filter:d,processGrid:c}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(a,c,f){"use strict";var d=a("../../../stackgl_modules").gl_streamtube3d,g=d.createTubeMesh,h=a("../../lib"),i=a("../../lib/gl_format_color").parseColorScale,j=a("../../components/colorscale").extractOpts,k=a("../../plots/gl3d/zip3"),l={xaxis:0,yaxis:1,zaxis:2};function e(a,b){this.scene=a,this.uid=b,this.mesh=null,this.data=null}var b=e.prototype;function m(a){var b=a.length;return b>2?a.slice(1,b-1):2===b?[(a[0]+a[1])/2]:a}function n(a){var b=a.length;return 1===b?[.5,.5]:[a[1]-a[0],a[b-1]-a[b-2]]}function o(u,a){var G=u.fullSceneLayout,H=u.dataScale,v=a._len,e={};function b(b,a){var c=G[a],d=H[l[a]];return h.simpleMap(b,function(a){return c.d2l(a)*d})}if(e.vectors=k(b(a._u,"xaxis"),b(a._v,"yaxis"),b(a._w,"zaxis"),v),!v)return{positions:[],cells:[]};var f=b(a._Xs,"xaxis"),g=b(a._Ys,"yaxis"),o=b(a._Zs,"zaxis");if(e.meshgrid=[f,g,o],e.gridFill=a._gridFill,a._slen)e.startingPositions=k(b(a._startsX,"xaxis"),b(a._startsY,"yaxis"),b(a._startsZ,"zaxis"));else{for(var E=g[0],p=m(f),q=m(o),w=new Array(p.length*q.length),F=0,r=0;r<p.length;r++)for(var s=0;s<q.length;s++)w[F++]=[p[r],E,q[s]];e.startingPositions=w}e.colormap=i(a),e.tubeSize=a.sizeref,e.maxLength=a.maxdisplayed;var x=b(a._xbnds,"xaxis"),y=b(a._ybnds,"yaxis"),z=b(a._zbnds,"zaxis"),A=n(f),B=n(g),C=n(o),c=d(e,[[x[0]-A[0],y[0]-B[0],z[0]-C[0]],[x[1]+A[1],y[1]+B[1],z[1]+C[1]]]),D=j(a);c.vertexIntensityBounds=[D.min/a._normMax,D.max/a._normMax];var t=a.lightposition;return c.lightPosition=[t.x,t.y,t.z],c.ambient=a.lighting.ambient,c.diffuse=a.lighting.diffuse,c.specular=a.lighting.specular,c.roughness=a.lighting.roughness,c.fresnel=a.lighting.fresnel,c.opacity=a.opacity,a._pad=c.tubeScale*a.sizeref*2,c}b.handlePick=function(a){var e=this.scene.fullSceneLayout,f=this.scene.dataScale;function b(b,a){var c=e[a],d=f[l[a]];return c.l2c(b)/d}if(a.object===this.mesh){var c=a.data.position,d=a.data.velocity;return a.traceCoordinate=[b(c[0],"xaxis"),b(c[1],"yaxis"),b(c[2],"zaxis"),b(d[0],"xaxis"),b(d[1],"yaxis"),b(d[2],"zaxis"),a.data.intensity*this.data._normMax,a.data.divergence],a.textLabel=this.data.hovertext||this.data.text,!0}},b.update=function(a){this.data=a;var b=o(this.scene,a);this.mesh.update(b)},b.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},c.exports=function(a,c){var f=a.glplot.gl,h=o(a,c),d=g(f,h),b=new e(a,c.uid);return b.mesh=d,b.data=c,d._trace=b,a.glplot.add(d),b}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/colorscale/defaults"),f=a("./attributes");b.exports=function(l,b,n,m){function a(a,c){return d.coerce(l,b,f,a,c)}var c=a("u"),g=a("v"),h=a("w"),i=a("x"),j=a("y"),k=a("z");if(!c||!c.length||!g||!g.length||!h||!h.length||!i||!i.length||!j||!j.length||!k||!k.length){b.visible=!1;return}a("starts.x"),a("starts.y"),a("starts.z"),a("maxdisplayed"),a("sizeref"),a("lighting.ambient"),a("lighting.diffuse"),a("lighting.specular"),a("lighting.roughness"),a("lighting.fresnel"),a("lightposition.x"),a("lightposition.y"),a("lightposition.z"),e(l,b,m,a,{prefix:"",cLetter:"c"}),a("text"),a("hovertext"),a("hovertemplate"),a("uhoverformat"),a("vhoverformat"),a("whoverformat"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),b._length=null}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"streamtube",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:a("./attributes"),supplyDefaults:a("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:a("./calc").calc,plot:a("./convert"),eventData:function(a,b){return a.tubex=a.x,a.tubey=a.y,a.tubez=a.z,a.tubeu=b.traceCoordinate[3],a.tubev=b.traceCoordinate[4],a.tubew=b.traceCoordinate[5],a.norm=b.traceCoordinate[6],a.divergence=b.traceCoordinate[7],delete a.x,delete a.y,delete a.z,a},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(b,e,k){"use strict";var f=b("../../plots/attributes"),g=b("../../plots/template_attributes").hovertemplateAttrs,h=b("../../plots/template_attributes").texttemplateAttrs,i=b("../../components/colorscale/attributes"),j=b("../../plots/domain").attributes,a=b("../pie/attributes"),d=b("./constants"),c=b("../../lib/extend").extendFlat;e.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:c({colors:{valType:"data_array",editType:"calc"},line:{color:c({},a.marker.line.color,{dflt:null}),width:c({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},i("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:a.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:h({editType:"plot"},{keys:d.eventDataKeys.concat(["label","value"])}),hovertext:a.hovertext,hoverinfo:c({},f.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:g({},{keys:d.eventDataKeys}),textfont:a.textfont,insidetextorientation:a.insidetextorientation,insidetextfont:a.insidetextfont,outsidetextfont:c({},a.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:a.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:j({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(b,c,a){"use strict";var d=b("../../plots/plots");a.name="sunburst",a.plot=function(b,c,e,f){d.plotBasePlot(a.name,b,c,e,f)},a.clean=function(b,c,e,f){d.cleanBasePlot(a.name,b,c,e,f)}},{"../../plots/plots":628}],1060:[function(a,c,b){"use strict";var d=a("d3-hierarchy"),e=a("fast-isnumeric"),f=a("../../lib"),g=a("../../components/colorscale").makeColorScaleFuncFromTrace,h=a("../pie/calc").makePullColorFn,i=a("../pie/calc").generateExtendedColors,j=a("../../components/colorscale").calc,k=a("../../constants/numerical").ALMOST_EQUAL,l={},m={},n={};function o(b,c,d){var a=0,e=b.children;if(e){for(var g=e.length,f=0;f<g;f++)a+=o(e[f],c,d);d.branches&&a++}else d.leaves&&a++;return b.value=b.data.data.value=a,c._values||(c._values=[]),c._values[b.data.data.i]=a,a}b.calc=function(x,a){var y,G,H,I=x._fullLayout,z=a.ids,J=f.isArrayOrTypedArray(z),u=a.labels,n=a.parents,v=a.values,p=f.isArrayOrTypedArray(v),c=[],i={},A={},B=function(a){return a||"number"==typeof a},N=function(a){return!p||e(v[a])&&v[a]>=0};J?(O=Math.min(z.length,n.length),P=function(a){return B(z[a])&&N(a)},Q=function(a){return String(z[a])}):(O=Math.min(u.length,n.length),P=function(a){return B(u[a])&&N(a)},Q=function(a){return String(u[a])}),p&&(O=Math.min(O,v.length));for(var b=0;b<O;b++)if(P(b)){var q,r,C=Q(b),D=B(n[b])?String(n[b]):"",E={i:b,id:C,pid:D,label:B(u[b])?String(u[b]):""};p&&(E.v=+v[b]),c.push(E),q=D,r=C,i[q]?i[q].push(r):i[q]=[r],A[r]=1}if(i[""]){if(i[""].length>1){for(var F=f.randstr(),s=0;s<c.length;s++)""===c[s].pid&&(c[s].pid=F);c.unshift({hasMultipleRoots:!0,id:F,pid:"",label:""})}}else{var O,P,Q,l,t=[];for(l in i)A[l]||t.push(l);if(1!==t.length)return f.warn(["Multiple implied roots, cannot build",a.type,"hierarchy of",a.name+".","These roots include:",t.join(", ")].join(" "));l=t[0],c.unshift({hasImpliedRoot:!0,id:l,pid:"",label:l})}try{y=d.stratify().id(function(a){return a.id}).parentId(function(a){return a.pid})(c)}catch(K){return f.warn(["Failed to build",a.type,"hierarchy of",a.name+".","Error:",K.message].join(" "))}var m=d.hierarchy(y),L=!1;if(p)switch(a.branchvalues){case"remainder":m.sum(function(a){return a.data.v});break;case"total":m.each(function(b){var d=b.data.data,c=d.v;if(b.children){var e=b.children.reduce(function(a,b){return a+b.data.data.v},0);if((d.hasImpliedRoot||d.hasMultipleRoots)&&(c=e),c<e*k)return L=!0,f.warn(["Total value for node",b.data.data.id,"of",a.name,"is smaller than the sum of its children.","\nparent value =",c,"\nchildren sum =",e].join(" "))}b.value=c});break}else o(m,a,{branches:-1!==a.count.indexOf("branches"),leaves:-1!==a.count.indexOf("leaves")});if(!L){a.sort&&m.sort(function(a,b){return b.value-a.value});var w=a.marker.colors||[],M=!!w.length;return a._hasColorscale?(M||(w=p?a.values:a._values),j(x,a,{vals:w,containerStr:"marker",cLetter:"c"}),H=g(a.marker)):G=h(I["_"+a.type+"colormap"]),m.each(function(c){var b=c.data.data;b.color=a._hasColorscale?H(w[b.i]):G(w[b.i],b.id)}),c[0].hierarchy=m,c}},b._runCrossTraceCalc=function(a,e){var h,c=e._fullLayout,f=e.calcdata,g=c[a+"colorway"],k=c["_"+a+"colormap"];c["extend"+a+"colors"]&&(g=i(g,"icicle"===a?n:"treemap"===a?m:l));var o=0;function j(b){var a=b.data.data,c=a.id;!1===a.color&&(k[c]?a.color=k[c]:b.parent?b.parent.parent?a.color=b.parent.data.data.color:(k[c]=a.color=g[o%g.length],o++):a.color=h)}for(var d=0;d<f.length;d++){var b=f[d][0];b.trace.type===a&&b.hierarchy&&(h=b.trace.root.color,b.hierarchy.each(j))}},b.crossTraceCalc=function(a){return b._runCrossTraceCalc("sunburst",a)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(b,a,c){"use strict";a.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(a,c,d){"use strict";var e=a("../../lib"),f=a("./attributes"),g=a("../../plots/domain").defaults,h=a("../bar/defaults").handleText,b=a("../../components/colorscale"),i=b.hasColorscale,j=b.handleDefaults;c.exports=function(c,b,p,d){function a(a,d){return e.coerce(c,b,f,a,d)}var k=a("labels"),l=a("parents");if(!k||!k.length||!l||!l.length){b.visible=!1;return}var m=a("values");a(m&&m.length?"branchvalues":"count"),a("level"),a("maxdepth"),a("marker.line.width")&&a("marker.line.color",d.paper_bgcolor),a("marker.colors");var n=b._hasColorscale=i(c,"marker","colors")||(c.marker||{}).coloraxis;n&&j(c,b,d,a,{prefix:"marker.",cLetter:"c"}),a("leaf.opacity",n?1:.7);var o=a("text");a("texttemplate"),b.texttemplate||a("textinfo",Array.isArray(o)?"text+label":"label"),a("hovertext"),a("hovertemplate"),h(c,b,d,a,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("insidetextorientation"),a("sort"),a("rotation"),a("root.color"),g(b,d,a),b._length=null}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../registry"),f=a("../../components/fx/helpers").appendArrayPointValue,g=a("../../components/fx"),h=a("../../lib"),i=a("../../lib/events"),j=a("./helpers"),k=a("../pie/helpers").formatPieValue;function l(a,b,g){for(var h=a.data.data,c={curveNumber:b.index,pointNumber:h.i,data:b._input,fullData:b},d=0;d<g.length;d++){var e=g[d];e in a&&(c[e]=a[e])}return"parentString"in a&&!j.isHierarchyRoot(a)&&(c.parent=a.parentString),f(c,b,h.i),c}b.exports=function(b,m,n,f,o){var c=f[0],a=c.trace,p=c.hierarchy,q="sunburst"===a.type,r="treemap"===a.type||"icicle"===a.type;"_hasHoverLabel"in a||(a._hasHoverLabel=!1),"_hasHoverEvent"in a||(a._hasHoverEvent=!1),b.on("mouseover",function(e){var x=n._fullLayout;if(!n._dragging&& !1!==x.hovermode){var t=n._fullData[a.index],y=e.data.data,J=y.i,D=j.isHierarchyRoot(e),H=j.getParent(p,e),E=j.getValue(e),i=function(a){return h.castOption(t,J,a)},F=i("hovertemplate"),u=g.castHoverinfo(t,x,J),A=x.separators;if(F||u&&"none"!==u&&"skip"!==u){q&&(C=c.cx+e.pxmid[0]*(1-e.rInscribed),K=c.cy+e.pxmid[1]*(1-e.rInscribed)),r&&(C=e._hoverX,K=e._hoverY);var B,C,K,v,f={},L=[],z=[],s=function(a){return -1!==L.indexOf(a)};u&&(L="all"===u?t._module.attributes.hoverinfo.flags:u.split("+")),f.label=y.label,s("label")&&f.label&&z.push(f.label),y.hasOwnProperty("v")&&(f.value=y.v,f.valueLabel=k(f.value,A),s("value")&&z.push(f.valueLabel)),f.currentPath=e.currentPath=j.getPath(e.data),s("current path")&&!D&&z.push(f.currentPath);var N=[],G=function(){-1===N.indexOf(v)&&(z.push(v),N.push(v))};f.percentParent=e.percentParent=E/j.getValue(H),f.parent=e.parentString=j.getPtLabel(H),s("percent parent")&&(v=j.formatPercent(f.percentParent,A)+" of "+f.parent,G()),f.percentEntry=e.percentEntry=E/j.getValue(m),f.entry=e.entry=j.getPtLabel(m),!s("percent entry")||D||e.onPathbar||(v=j.formatPercent(f.percentEntry,A)+" of "+f.entry,G()),f.percentRoot=e.percentRoot=E/j.getValue(p),f.root=e.root=j.getPtLabel(p),s("percent root")&&!D&&(v=j.formatPercent(f.percentRoot,A)+" of "+f.root,G()),f.text=i("hovertext")||i("text"),s("text")&&(v=f.text,h.isValidTextValue(v)&&z.push(v)),B=[l(e,t,o.eventDataKeys)];var w={trace:t,y:K,_x0:e._x0,_x1:e._x1,_y0:e._y0,_y1:e._y1,text:z.join("<br>"),name:F||s("name")?t.name:void 0,color:i("hoverlabel.bgcolor")||y.color,borderColor:i("hoverlabel.bordercolor"),fontFamily:i("hoverlabel.font.family"),fontSize:i("hoverlabel.font.size"),fontColor:i("hoverlabel.font.color"),nameLength:i("hoverlabel.namelength"),textAlign:i("hoverlabel.align"),hovertemplate:F,hovertemplateLabels:f,eventData:B};q&&(w.x0=C-e.rInscribed*e.rpx1,w.x1=C+e.rInscribed*e.rpx1,w.idealAlign=e.pxmid[0]<0?"left":"right"),r&&(w.x=C,w.idealAlign=C<0?"left":"right");var I=[];g.loneHover(w,{container:x._hoverlayer.node(),outerContainer:x._paper.node(),gd:n,inOut_bbox:I}),B[0].bbox=I[0],a._hasHoverLabel=!0}if(r){var M=b.select("path.surface");o.styleOne(M,e,t,{hovered:!0})}a._hasHoverEvent=!0,n.emit("plotly_hover",{points:B||[l(e,t,o.eventDataKeys)],event:d.event})}}),b.on("mouseout",function(f){var h=n._fullLayout,c=n._fullData[a.index],e=d.select(this).datum();if(a._hasHoverEvent&&(f.originalEvent=d.event,n.emit("plotly_unhover",{points:[l(e,c,o.eventDataKeys)],event:d.event}),a._hasHoverEvent=!1),a._hasHoverLabel&&(g.loneUnhover(h._hoverlayer.node()),a._hasHoverLabel=!1),r){var i=b.select("path.surface");o.styleOne(i,e,c,{hovered:!1})}}),b.on("click",function(b){var f=n._fullLayout,c=n._fullData[a.index],h=q&&(j.isHierarchyRoot(b)||j.isLeaf(b)),k=j.getPtId(b),t=j.isEntry(b)?j.findEntryWithChild(p,k):j.findEntryWithLevel(p,k),m=j.getPtId(t),r={points:[l(b,c,o.eventDataKeys)],event:d.event};h||(r.nextLevel=m);var s=i.triggerHandler(n,"plotly_"+a.type+"click",r);if(!1!==s&&f.hovermode&&(n._hoverdata=[l(b,c,o.eventDataKeys)],g.click(n,d.event)),!h&& !1!==s&& !n._dragging&&!n._transitioning){e.call("_storeDirectGUIEdit",c,f._tracePreGUI[c.uid],{level:c.level});var u={data:[{level:m}],traces:[a.index]},v={frame:{redraw:!1,duration:o.transitionTime},transition:{duration:o.transitionTime,easing:o.transitionEasing},mode:"immediate",fromcurrent:!0};g.loneUnhover(f._hoverlayer.node()),e.call("animate",n,u,v)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(b,d,a){"use strict";var e=b("../../lib"),f=b("../../components/color"),g=b("../../lib/setcursor"),c=b("../pie/helpers");function h(a){return a.data.data.pid}a.findEntryWithLevel=function(b,c){var d;return c&&b.eachAfter(function(b){if(a.getPtId(b)===c)return d=b.copy()}),d||b},a.findEntryWithChild=function(b,d){var c;return b.eachAfter(function(e){for(var f=e.children||[],b=0;b<f.length;b++){var g=f[b];if(a.getPtId(g)===d)return c=e.copy()}}),c||b},a.isEntry=function(a){return!a.parent},a.isLeaf=function(a){return!a.children},a.getPtId=function(a){return a.data.data.id},a.getPtLabel=function(a){return a.data.data.label},a.getValue=function(a){return a.value},a.isHierarchyRoot=function(a){return""===h(a)},a.setSliceCursor=function(d,f,b){var c=b.isTransitioning;if(!c){var e=d.datum();c=b.hideOnRoot&&a.isHierarchyRoot(e)||b.hideOnLeaves&&a.isLeaf(e)}g(d,c?null:"pointer")},a.getInsideTextFontKey=function(a,b,d,f,g){var h=(g||{}).onPathbar,c=d.data.data.i;return e.castOption(b,c,(h?"pathbar.textfont":"insidetextfont")+"."+a)||e.castOption(b,c,"textfont."+a)||f.size},a.getOutsideTextFontKey=function(a,b,d,f){var c=d.data.data.i;return e.castOption(b,c,"outsidetextfont."+a)||e.castOption(b,c,"textfont."+a)||f.size},a.isOutsideText=function(b,c){return!b._hasColorscale&&a.isHierarchyRoot(c)},a.determineTextFont=function(i,j,o,r){var c,d,g,b,h,k,l,p,q,m,n;return a.isOutsideText(i,j)?(c=i,d=j,g=o,{color:a.getOutsideTextFontKey("color",c,d,g),family:a.getOutsideTextFontKey("family",c,d,g),size:a.getOutsideTextFontKey("size",c,d,g)}):(b=i,h=j,k=o,p=((l=r)||{}).onPathbar,m=(q=h.data.data).i,(n=e.castOption(b,m,(p?"pathbar.textfont":"insidetextfont")+".color"))||!b._input.textfont||(n=e.castOption(b._input,m,"textfont.color")),{color:n||f.contrast(q.color),family:a.getInsideTextFontKey("family",b,h,k,l),size:a.getInsideTextFontKey("size",b,h,k,l)})},a.hasTransition=function(a){return!!(a&&a.duration>0)},a.getMaxDepth=function(a){return a.maxdepth>=0?a.maxdepth:1/0},a.isHeader=function(b,c){return!(a.isLeaf(b)||b.depth===c._maxDepth-1)},a.getParent=function(b,c){return a.findEntryWithLevel(b,h(c))},a.listPath=function(d,c){var b=d.parent;if(!b)return[];var e=c?[b.data[c]]:[b];return a.listPath(b,c).concat(e)},a.getPath=function(b){return a.listPath(b,"label").join("/")+"/"},a.formatValue=c.formatPieValue,a.formatPercent=function(b,d){var a=e.formatPercent(b,0);return"0%"===a&&(a=c.formatPiePercent(b,d)),a}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"sunburst",basePlotModule:a("./base_plot"),categories:[],animatable:!0,attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot").plot,style:a("./style").style,colorbar:a("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(b,a,c){"use strict";a.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(c,b){function a(a,f){return d.coerce(c,b,e,a,f)}a("sunburstcolorway",b.colorway),a("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(a,e,b){"use strict";var f=a("@plotly/d3"),g=a("d3-hierarchy"),h=a("d3-interpolate").interpolate,i=a("../../components/drawing"),j=a("../../lib"),k=a("../../lib/svg_text_utils"),c=a("../bar/uniform_text"),l=c.recordMinTextSize,m=c.clearMinTextSize,d=a("../pie/plot"),n=a("../pie/helpers").getRotationAngle,o=d.computeTransform,p=d.transformInsideText,q=a("./style").styleOne,r=a("../bar/style").resizeText,s=a("./fx"),t=a("./constants"),u=a("./helpers");function v(A,G,H,I){var O=A._context.staticPlot,B=A._fullLayout,m=!B.uniformtext.mode&&u.hasTransition(I),a=f.select(H).selectAll("g.slice"),g=G[0],r=g.trace,J=g.hierarchy,v=u.findEntryWithLevel(J,r.level),C=u.getMaxDepth(r),d=B._size,c=r.domain,K=d.w*(c.x[1]-c.x[0]),D=d.h*(c.y[1]-c.y[0]),P=.5*Math.min(K,D),Q=g.cx=d.l+d.w*(c.x[1]+c.x[0])/2,R=g.cy=d.t+d.h*(1-c.y[0])-D/2;if(!v)return a.remove();var E=null,S={};m&&a.each(function(a){S[u.getPtId(a)]={rpx0:a.rpx0,rpx1:a.rpx1,x0:a.x0,x1:a.x1,transform:a.transform},!E&&u.isEntry(a)&&(E=a)});var e=w(v).descendants(),F=v.height+1,L=0,M=C;g.hasMultipleRoots&&u.isHierarchyRoot(v)&&(e=e.slice(1),F-=1,L=1,M+=1),e=e.filter(function(a){return a.y1<=M});var N=n(r.rotation);N&&e.forEach(function(a){a.x0+=N,a.x1+=N});var T=Math.min(F,C),U=function(a){return(a-L)/T*P},V=function(a,b){return[a*Math.cos(b),-a*Math.sin(b)]},W=function(a){return j.pathAnnulus(a.rpx0,a.rpx1,a.x0,a.x1,Q,R)},X=function(a){return Q+y(a)[0]*(a.transform.rCenter||0)+(a.transform.x||0)},Y=function(a){return R+y(a)[1]*(a.transform.rCenter||0)+(a.transform.y||0)};(a=a.data(e,u.getPtId)).enter().append("g").classed("slice",!0),m?a.exit().transition().each(function(){var a=f.select(this);a.select("path.surface").transition().attrTween("d",function(a){var b=_(a);return function(a){return W(b(a))}}),a.select("g.slicetext").attr("opacity",0)}).remove():a.exit().remove(),a.order();var Z=null;if(m&&E){var $=u.getPtId(E);a.each(function(a){null===Z&&u.getPtId(a)===$&&(Z=a.x1)})}var z=a;function _(b){var l=u.getPtId(b),m=S[l],c=S[u.getPtId(v)];if(c){var e=(b.x1>c.x1?2*Math.PI:0)+N;f=b.rpx1<c.rpx1?{x0:b.x0,x1:b.x1,rpx0:0,rpx1:0}:{x0:e,x1:e,rpx0:b.rpx0,rpx1:b.rpx1}}else{var f,d,g,n=u.getPtId(b.parent);a.each(function(a){if(u.getPtId(a)===n)return d=a});var i=d.children;i.forEach(function(a,b){if(u.getPtId(a)===l)return g=b});var j=i.length,k=h(d.x0,d.x1);f={rpx0:P,rpx1:P,x0:k(g/j),x1:k((g+1)/j)}}return h(m,f)}function aa(c){var d=c.parent,b=S[u.getPtId(d)],a={};if(b){var e=d.children,f=e.indexOf(c),g=e.length,i=h(b.x0,b.x1);a.x0=i(f/g),a.x1=i(f/g)}else a.x0=a.x1=0;return a}m&&(z=z.transition().each("end",function(){var a=f.select(this);u.setSliceCursor(a,A,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),z.each(function(a){var d=f.select(this),e=j.ensureSingle(d,"path","surface",function(a){a.style("pointer-events",O?"none":"all")});a.rpx0=U(a.y0),a.rpx1=U(a.y1),a.xmid=(a.x0+a.x1)/2,a.pxmid=V(a.rpx1,a.xmid),a.midangle=-(a.xmid-Math.PI/2),a.startangle=-(a.x0-Math.PI/2),a.stopangle=-(a.x1-Math.PI/2),a.halfangle=.5*Math.min(j.angleDelta(a.x0,a.x1)||Math.PI,Math.PI),a.ring=1-a.rpx0/a.rpx1,a.rInscribed=x(a,r),m?e.transition().attrTween("d",function(a){var b=function(a){var b,c=S[u.getPtId(a)],e={x0:a.x0,x1:a.x1,rpx0:a.rpx0,rpx1:a.rpx1};if(c)b=c;else if(E)if(a.parent)if(Z){var d=(a.x1>Z?2*Math.PI:0)+N;b={x0:d,x1:d}}else b={rpx0:P,rpx1:P},j.extendFlat(b,aa(a));else b={rpx0:0,rpx1:0};else b={x0:N,x1:N};return h(b,e)}(a);return function(a){return W(b(a))}}):e.attr("d",W),d.call(s,v,A,G,{eventDataKeys:t.eventDataKeys,transitionTime:t.CLICK_TRANSITION_TIME,transitionEasing:t.CLICK_TRANSITION_EASING}).call(u.setSliceCursor,A,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:A._transitioning}),e.call(q,a,r);var w=j.ensureSingle(d,"g","slicetext"),c=j.ensureSingle(w,"text","",function(a){a.attr("data-notex",1)}),y=j.ensureUniformFontSize(A,u.determineTextFont(r,a,B.font));c.text(b.formatSliceLabel(a,v,r,G,B)).classed("slicetext",!0).attr("text-anchor","middle").call(i.font,y).call(k.convertToTspans,A);var n=i.bBox(c.node());a.transform=p(n,a,g),a.transform.targetX=X(a),a.transform.targetY=Y(a);var z=function(b,c){var a=b.transform;return o(a,c),a.fontSize=y.size,l(r.type,a,B),j.getTextTransform(a)};m?c.transition().attrTween("transform",function(a){var b=function(b){var a,d=S[u.getPtId(b)],c=b.transform;if(d)a=d;else if(a={rpx1:b.rpx1,transform:{textPosAngle:c.textPosAngle,scale:0,rotate:c.rotate,rCenter:c.rCenter,x:c.x,y:c.y}},E)if(b.parent)if(Z){var e=b.x1>Z?2*Math.PI:0;a.x0=a.x1=e}else j.extendFlat(a,aa(b));else a.x0=a.x1=N;else a.x0=a.x1=N;var f=h(a.transform.textPosAngle,b.transform.textPosAngle),g=h(a.rpx1,b.rpx1),i=h(a.x0,b.x0),k=h(a.x1,b.x1),m=h(a.transform.scale,c.scale),n=h(a.transform.rotate,c.rotate),o=0===c.rCenter?3:0===a.transform.rCenter?1/3:1,p=h(a.transform.rCenter,c.rCenter);return function(a){var b=g(a),h=i(a),j=k(a),d=p(Math.pow(a,o)),q=V(b,(h+j)/2),s=f(a),e={pxmid:q,rpx1:b,transform:{textPosAngle:s,rCenter:d,x:c.x,y:c.y}};return l(r.type,c,B),{transform:{targetX:X(e),targetY:Y(e),scale:m(a),rotate:n(a),rCenter:d}}}}(a);return function(a){return z(b(a),n)}}):c.attr("transform",z(a,n))})}function w(a){return g.partition().size([2*Math.PI,a.height+1])(a)}function x(a){return 0===a.rpx0&&j.isFullCircle([a.x0,a.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(a.halfangle)),a.ring/2))}function y(a){return z(a.rpx1,a.transform.textPosAngle)}function z(a,b){return[a*Math.sin(b),-a*Math.cos(b)]}b.plot=function(d,g,b,e){var c,h,a=d._fullLayout,i=a._sunburstlayer,j=!a.uniformtext.mode&&u.hasTransition(b);(m("sunburst",a),(c=i.selectAll("g.trace.sunburst").data(g,function(a){return a[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),c.order(),j)?(e&&(h=e()),f.transition().duration(b.duration).ease(b.easing).each("end",function(){h&&h()}).each("interrupt",function(){h&&h()}).each(function(){i.selectAll("g.trace").each(function(a){v(d,a,this,b)})})):(c.each(function(a){v(d,a,this,b)}),a.uniformtext.mode&&r(d,a._sunburstlayer.selectAll(".trace"),"sunburst")),b||c.exit().remove()},b.formatSliceLabel=function(e,l,d,x,t){var v=d.texttemplate,m=d.textinfo;if(!v&&(!m||"none"===m))return"";var g=t.separators,y=x[0],b=e.data.data,k=y.hierarchy,n=u.isHierarchyRoot(e),o=u.getParent(k,e),f=u.getValue(e);if(!v){var z=m.split("+"),c=function(a){return -1!==z.indexOf(a)},h=[];if(c("label")&&b.label&&h.push(b.label),b.hasOwnProperty("v")&&c("value")&&h.push(u.formatValue(b.v,g)),!n){c("current path")&&h.push(u.getPath(e.data));var i=0;c("percent parent")&&i++,c("percent entry")&&i++,c("percent root")&&i++;var A=i>1;if(i){var p,q,r=function(a){p=u.formatPercent(q,g),A&&(p+=" of "+a),h.push(p)};c("percent parent")&&!n&&(q=f/u.getValue(o),r("parent")),c("percent entry")&&(q=f/u.getValue(l),r("entry")),c("percent root")&&(q=f/u.getValue(k),r("root"))}}return c("text")&&(p=j.castOption(d,b.i,"text"),j.isValidTextValue(p)&&h.push(p)),h.join("<br>")}var w=j.castOption(d,b.i,"texttemplate");if(!w)return"";var a={};b.label&&(a.label=b.label),b.hasOwnProperty("v")&&(a.value=b.v,a.valueLabel=u.formatValue(b.v,g)),a.currentPath=u.getPath(e.data),n||(a.percentParent=f/u.getValue(o),a.percentParentLabel=u.formatPercent(a.percentParent,g),a.parent=u.getPtLabel(o)),a.percentEntry=f/u.getValue(l),a.percentEntryLabel=u.formatPercent(a.percentEntry,g),a.entry=u.getPtLabel(l),a.percentRoot=f/u.getValue(k),a.percentRootLabel=u.formatPercent(a.percentRoot,g),a.root=u.getPtLabel(k),b.hasOwnProperty("color")&&(a.color=b.color);var s=j.castOption(d,b.i,"text");return(j.isValidTextValue(s)||""===s)&&(a.text=s),a.customdata=j.castOption(d,b.i,"customdata"),j.texttemplateString(w,a,t._d3locale,a,d._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../components/color"),g=a("../../lib"),h=a("../bar/uniform_text").resizeText;function c(e,b,a){var c=b.data.data,h=!b.children,d=c.i,i=g.castOption(a,d,"marker.line.color")||f.defaultLine,j=g.castOption(a,d,"marker.line.width")||0;e.style("stroke-width",j).call(f.fill,c.color).call(f.stroke,i).style("opacity",h?a.leaf.opacity:null)}b.exports={style:function(a){var b=a._fullLayout._sunburstlayer.selectAll(".trace");h(a,b,"sunburst"),b.each(function(b){var a=e.select(this),d=b[0].trace;a.style("opacity",d.opacity),a.selectAll("path.surface").each(function(a){e.select(this).call(c,a,d)})})},styleOne:c}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(a,h,k){"use strict";var l=a("../../components/color"),c=a("../../components/colorscale/attributes"),e=a("../../plots/cartesian/axis_format_attributes").axisHoverFormat,i=a("../../plots/template_attributes").hovertemplateAttrs,g=a("../../plots/attributes"),b=a("../../lib/extend").extendFlat,j=a("../../plot_api/edit_types").overrideAll;function m(a){return{valType:"boolean",dflt:!1}}function f(a){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:m("x"),y:m("y"),z:m("z")},color:{valType:"color",dflt:l.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:l.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var d=h.exports=j(b({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:i(),xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},c("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:f("x"),y:f("y"),z:f("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:b({},c.zauto,{}),zmin:b({},c.zmin,{}),zmax:b({},c.zmax,{})},hoverinfo:b({},g.hoverinfo),showlegend:b({},g.showlegend,{dflt:!1})}),"calc","nested");d.x.editType=d.y.editType=d.z.editType="calc+clearAxisTypes",d.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(a,b,c){"use strict";var d=a("../../components/colorscale/calc");b.exports=function(b,a){a.surfacecolor?d(b,a,{vals:a.surfacecolor,containerStr:"",cLetter:"c"}):d(b,a,{vals:a.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(b,d,f){"use strict";var g=b("../../../stackgl_modules").gl_surface3d,h=b("../../../stackgl_modules").ndarray,i=b("../../../stackgl_modules").ndarray_linear_interpolate.d2,j=b("../heatmap/interp2d"),k=b("../heatmap/find_empties"),l=b("../../lib").isArrayOrTypedArray,m=b("../../lib/gl_format_color").parseColorScale,n=b("../../lib/str2rgbarray"),o=b("../../components/colorscale").extractOpts;function e(a,b,c){this.scene=a,this.uid=c,this.surface=b,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var a=e.prototype;a.getXat=function(a,d,b,e){var c=l(this.data.x)?l(this.data.x[0])?this.data.x[d][a]:this.data.x[a]:a;return void 0===b?c:e.d2l(c,0,b)},a.getYat=function(d,a,b,e){var c=l(this.data.y)?l(this.data.y[0])?this.data.y[a][d]:this.data.y[a]:a;return void 0===b?c:e.d2l(c,0,b)},a.getZat=function(b,c,d,e){var a=this.data.z[c][b];return null===a&&this.data.connectgaps&&this.data._interpolatedZ&&(a=this.data._interpolatedZ[c][b]),void 0===d?a:e.d2l(a,0,d)},a.handlePick=function(a){if(a.object===this.surface){var f=(a.data.index[0]-1)/this.dataScaleX-1,g=(a.data.index[1]-1)/this.dataScaleY-1,c=Math.max(Math.min(Math.round(f),this.data.z[0].length-1),0),b=Math.max(Math.min(Math.round(g),this.data._ylength-1),0);a.index=[c,b],a.traceCoordinate=[this.getXat(c,b),this.getYat(c,b),this.getZat(c,b)],a.dataCoordinate=[this.getXat(c,b,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(c,b,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(c,b,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var e=0;e<3;e++)null!=a.dataCoordinate[e]&&(a.dataCoordinate[e]*=this.scene.dataScale[e]);var d=this.data.hovertext||this.data.text;return Array.isArray(d)&&d[b]&& void 0!==d[b][c]?a.textLabel=d[b][c]:d?a.textLabel=d:a.textLabel="",a.data.dataCoordinate=a.dataCoordinate.slice(),this.surface.highlight(a.data),this.scene.glplot.spikes.position=a.dataCoordinate,!0}};var p=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function q(a,b){if(a<b)return 0;for(var c=0;0===Math.floor(a%b);)a/=b,c++;return c}function r(c){for(var b=[],a=0;a<p.length;a++){var d=p[a];b.push(q(c,d))}return b}function s(b){for(var d=r(b),c=b,a=0;a<p.length;a++)if(d[a]>0){c=p[a];break}return c}function t(b,c){if(!(b<1)&&!(c<1)){for(var e=r(b),f=r(c),d=1,a=0;a<p.length;a++)d*=Math.pow(p[a],Math.max(e[a],f[a]));return d}}a.calcXnums=function(c){var a,b=[];for(a=1;a<c;a++){var d=this.getXat(a-1,0),e=this.getXat(a,0);e!==d&&null!=d&&null!=e?b[a-1]=Math.abs(e-d):b[a-1]=0}var f=0;for(a=1;a<c;a++)f+=b[a-1];for(a=1;a<c;a++)0===b[a-1]?b[a-1]=1:b[a-1]=Math.round(f/b[a-1]);return b},a.calcYnums=function(c){var a,b=[];for(a=1;a<c;a++){var d=this.getYat(0,a-1),e=this.getYat(0,a);e!==d&&null!=d&&null!=e?b[a-1]=Math.abs(e-d):b[a-1]=0}var f=0;for(a=1;a<c;a++)f+=b[a-1];for(a=1;a<c;a++)0===b[a-1]?b[a-1]=1:b[a-1]=Math.round(f/b[a-1]);return b};var c=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],u=c[9],v=c[13];function w(c,b,a){var d=a[8]+a[2]*b[0]+a[5]*b[1];return c[0]=(a[6]+a[0]*b[0]+a[3]*b[1])/d,c[1]=(a[7]+a[1]*b[0]+a[4]*b[1])/d,c}function x(a,b,c){return y(a,b,w,c),a}function y(a,e,f,g){for(var d=[0,0],h=a.shape[0],j=a.shape[1],b=0;b<h;b++)for(var c=0;c<j;c++)f(d,[b,c],g),a.set(b,c,i(e,d[0],d[1]));return a}function z(a,c){for(var d=!1,b=0;b<a.length;b++)if(c===a[b]){d=!0;break}!1===d&&a.push(c)}a.estimateScale=function(b,d){for(var a=1+function d(a){if(0!==a.length){for(var b=1,c=0;c<a.length;c++)b=t(b,a[c]);return b}}(0===d?this.calcXnums(b):this.calcYnums(b));a<u;)a*=2;for(;a>v;)a--,a/=s(a),a++,a<u&&(a=v);var c=Math.round(a/b);return c>1?c:1},a.refineCoords=function(a){for(var c=this.dataScaleX,d=this.dataScaleY,l=a[0].shape[0],m=a[0].shape[1],e=0|Math.floor(a[0].shape[0]*c+1),f=0|Math.floor(a[0].shape[1]*d+1),g=1+l+1,i=1+m+1,j=h(new Float32Array(g*i),[g,i]),n=[1/c,0,0,0,1/d,0,0,0,1],b=0;b<a.length;++b){this.surface.padField(j,a[b]);var k=h(new Float32Array(e*f),[e,f]);x(k,j,n),a[b]=k}},a.setContourLevels=function(){var a,b,c,d=[[],[],[]],e=[!1,!1,!1],f=!1;for(a=0;a<3;++a)if(this.showContour[a]&&(f=!0,this.contourSize[a]>0&&null!==this.contourStart[a]&&null!==this.contourEnd[a]&&this.contourEnd[a]>this.contourStart[a]))for(e[a]=!0,b=this.contourStart[a];b<this.contourEnd[a];b+=this.contourSize[a])c=b*this.scene.dataScale[a],z(d[a],c);if(f){var g=[[],[],[]];for(a=0;a<3;++a)this.showContour[a]&&(g[a]=e[a]?d[a]:this.scene.contourLevels[a]);this.surface.update({levels:g})}},a.update=function(d){var u,s,t,a,b,c,q,w=this.scene,x=w.fullSceneLayout,p=this.surface,A=m(d),y=w.dataScale,f=d.z[0].length,l=d._ylength,D=w.contourLevels;this.data=d;var g=[];for(a=0;a<3;a++)for(b=0,g[a]=[];b<f;b++)g[a][b]=[];for(b=0;b<f;b++)for(c=0;c<l;c++)g[0][b][c]=this.getXat(b,c,d.xcalendar,x.xaxis),g[1][b][c]=this.getYat(b,c,d.ycalendar,x.yaxis),g[2][b][c]=this.getZat(b,c,d.zcalendar,x.zaxis);if(d.connectgaps)for(d._emptypoints=k(g[2]),j(g[2],d._emptypoints),d._interpolatedZ=[],b=0;b<f;b++)for(c=0,d._interpolatedZ[b]=[];c<l;c++)d._interpolatedZ[b][c]=g[2][b][c];for(a=0;a<3;a++)for(b=0;b<f;b++)for(c=0;c<l;c++)null===(q=g[a][b][c])|| void 0===q?g[a][b][c]=NaN:q=g[a][b][c]*=y[a];for(a=0;a<3;a++)for(b=0;b<f;b++)for(c=0;c<l;c++)null!==(q=g[a][b][c])&& void 0!==q&&(this.minValues[a]>q&&(this.minValues[a]=q),this.maxValues[a]<q&&(this.maxValues[a]=q));for(a=0;a<3;a++)this.objectOffset[a]=.5*(this.minValues[a]+this.maxValues[a]);for(a=0;a<3;a++)for(b=0;b<f;b++)for(c=0;c<l;c++)null!==(q=g[a][b][c])&& void 0!==q&&(g[a][b][c]-=this.objectOffset[a]);var r=[h(new Float32Array(f*l),[f,l]),h(new Float32Array(f*l),[f,l]),h(new Float32Array(f*l),[f,l])];for(a=0;a<3;a++)for(b=0;b<f;b++)for(c=0;c<l;c++)r[a].set(b,c,g[a][b][c]);g=[];var e={colormap:A,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!d.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:d.opacityscale,opacity:d.opacity},B=o(d);if(e.intensityBounds=[B.min,B.max],d.surfacecolor){var C=h(new Float32Array(f*l),[f,l]);for(b=0;b<f;b++)for(c=0;c<l;c++)C.set(b,c,d.surfacecolor[c][b]);r.push(C)}else e.intensityBounds[0]*=y[2],e.intensityBounds[1]*=y[2];(v<r[0].shape[0]||v<r[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(r[0].shape[0],0),this.dataScaleY=this.estimateScale(r[0].shape[1],1),(1!==this.dataScaleX||1!==this.dataScaleY)&&this.refineCoords(r)),d.surfacecolor&&(e.intensity=r.pop());var z=[!0,!0,!0],E=["x","y","z"];for(a=0;a<3;++a){var i=d.contours[E[a]];z[a]=i.highlight,e.showContour[a]=i.show||i.highlight,e.showContour[a]&&(e.contourProject[a]=[i.project.x,i.project.y,i.project.z],i.show?(this.showContour[a]=!0,e.levels[a]=D[a],p.highlightColor[a]=e.contourColor[a]=n(i.color),i.usecolormap?p.highlightTint[a]=e.contourTint[a]=0:p.highlightTint[a]=e.contourTint[a]=1,e.contourWidth[a]=i.width,this.contourStart[a]=i.start,this.contourEnd[a]=i.end,this.contourSize[a]=i.size):(this.showContour[a]=!1,this.contourStart[a]=null,this.contourEnd[a]=null,this.contourSize[a]=0),i.highlight&&(e.dynamicColor[a]=n(i.highlightcolor),e.dynamicWidth[a]=i.highlightwidth))}s=(u=A)[0].rgb,t=u[u.length-1].rgb,s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]&&(e.vertexColor=!0),e.objectOffset=this.objectOffset,e.coords=r,p.update(e),p.visible=d.visible,p.enableDynamic=z,p.enableHighlight=z,p.snapToData=!0,"lighting"in d&&(p.ambientLight=d.lighting.ambient,p.diffuseLight=d.lighting.diffuse,p.specularLight=d.lighting.specular,p.roughness=d.lighting.roughness,p.fresnel=d.lighting.fresnel),"lightposition"in d&&(p.lightPosition=[d.lightposition.x,d.lightposition.y,d.lightposition.z])},a.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},d.exports=function(a,d){var b=g({gl:a.glplot.gl}),c=new e(a,b,d.uid);return b._trace=c,c.update(d),a.glplot.add(b),c}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(a,b,d){"use strict";var e=a("../../registry"),f=a("../../lib"),g=a("../../components/colorscale/defaults"),h=a("./attributes");function c(d,a,e,c){var b=c("opacityscale");"max"===b?a.opacityscale=[[0,.1],[1,1]]:"min"===b?a.opacityscale=[[0,1],[1,.1]]:"extremes"===b?a.opacityscale=function(f,b){for(var c=[],a=0;a<32;a++){var d=a/31,e=b+(1-b)*(1-Math.pow(Math.sin(1*d*Math.PI),2));c.push([d,Math.max(0,Math.min(1,e))])}return c}(1,.1):!function(a){var d=0;if(!Array.isArray(a)||a.length<2)return!1;if(!a[0]||!a[a.length-1])return!1;if(0!= +a[0][0]||1!= +a[a.length-1][0])return!1;for(var b=0;b<a.length;b++){var c=a[b];if(2!==c.length|| +c[0]<d)return!1;d=+c[0]}return!0}(b)&&(a.opacityscale=void 0)}function i(a,b,c){b in a&&!(c in a)&&(a[c]=a[b])}b.exports={supplyDefaults:function(j,d,u,o){function a(a,b){return f.coerce(j,d,h,a,b)}var l,m,n=a("x"),p=a("y"),k=a("z");if(!k||!k.length||n&&n.length<1||p&&p.length<1){d.visible=!1;return}d._xlength=Array.isArray(n)&&f.isArrayOrTypedArray(n[0])?k.length:k[0].length,d._ylength=k.length,e.getComponentMethod("calendars","handleTraceDefaults")(j,d,["x","y","z"],o),a("text"),a("hovertext"),a("hovertemplate"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(b){a(b)});var t=a("surfacecolor"),q=["x","y","z"];for(l=0;l<3;++l){var b="contours."+q[l],r=a(b+".show"),s=a(b+".highlight");if(r||s)for(m=0;m<3;++m)a(b+".project."+q[m]);r&&(a(b+".color"),a(b+".width"),a(b+".usecolormap")),s&&(a(b+".highlightcolor"),a(b+".highlightwidth")),a(b+".start"),a(b+".end"),a(b+".size")}t||(i(j,"zmin","cmin"),i(j,"zmax","cmax"),i(j,"zauto","cauto")),g(j,d,o,a,{prefix:"",cLetter:"c"}),c(j,d,o,a),d._length=null},opacityscaleDefaults:c}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:a("./calc"),plot:a("./convert"),moduleType:"trace",name:"surface",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(a,f,j){"use strict";var c=a("../../components/annotations/attributes"),b=a("../../lib/extend").extendFlat,g=a("../../plot_api/edit_types").overrideAll,d=a("../../plots/font_attributes"),h=a("../../plots/domain").attributes,e=a("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,i=f.exports=g({domain:h({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:e("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:b({},c.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:b({},d({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:e("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:b({},c.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:b({},d({arrayOk:!0}))}},"calc","from-root");i.transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(b,d,a){"use strict";var e=b("../../plots/get_data").getModuleCalcData,f=b("./plot"),c="table";a.name=c,a.plot=function(a){var b=e(a.calcdata,c)[0];b.length&&f(a,b)},a.clean=function(f,b,g,a){var d=a._has&&a._has(c),e=b._has&&b._has(c);d&&!e&&a._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(a,b,c){"use strict";var d=a("../../lib/gup").wrap;b.exports=function(){return d({})}},{"../../lib/gup":512}],1078:[function(b,a,c){"use strict";a.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(a,b,c){"use strict";var d=a("./constants"),e=a("../../lib/extend").extendFlat,f=a("fast-isnumeric");function g(a){if(Array.isArray(a)){for(var b=0,c=0;c<a.length;c++)b=Math.max(b,g(a[c]));return b}return a}function h(a,b){return a+b}function i(f){var a,b=f.slice(),d=1/0,c=0;for(a=0;a<b.length;a++)Array.isArray(b[a])||(b[a]=[b[a]]),d=Math.min(d,b[a].length),c=Math.max(c,b[a].length);if(d!==c)for(a=0;a<b.length;a++){var e=c-b[a].length;e&&(b[a]=b[a].concat(j(e)))}return b}function j(b){for(var c=new Array(b),a=0;a<b;a++)c[a]="";return c}function k(a){return a.calcdata.columns.reduce(function(b,c){return c.xIndex<a.xIndex?b+c.columnWidth:b},0)}function l(a,b){return Object.keys(a).map(function(c){return e({},a[c],{auxiliaryBlocks:b})})}function m(c,i){for(var d,f={},g=0,e=0,b=n(),h=0,j=0,a=0;a<c.length;a++)d=c[a],b.rows.push({rowIndex:a,rowHeight:d}),((e+=d)>=i||a===c.length-1)&&(f[g]=b,b.key=j++,b.firstRowIndex=h,b.lastRowIndex=a,b=n(),g+=e,h=a+1,e=0);return f}function n(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}b.exports=function(b,a){var p=i(a.cells.values),s=function(b){return b.slice(a.header.values.length,b.length)},c=i(a.header.values);c.length&&!c[0].length&&(c[0]=[""],c=i(c));var n=c.concat(s(p).map(function(){return j((c[0]||[""]).length)})),o=a.domain,x=Math.floor(b._fullLayout._size.w*(o.x[1]-o.x[0])),q=Math.floor(b._fullLayout._size.h*(o.y[1]-o.y[0])),t=a.header.values.length?n[0].map(function(){return a.header.height}):[d.emptyHeaderHeight],y=p.length?p[0].map(function(){return a.cells.height}):[],u=t.reduce(h,0),z=m(y,q-u+d.uplift),A=m(t,u),v=l(A,[]),B=l(z,v),E={},C=a._fullInput.columnorder.concat(s(p.map(function(b,a){return a}))),r=n.map(function(d,c){var b=Array.isArray(a.columnwidth)?a.columnwidth[Math.min(c,a.columnwidth.length-1)]:a.columnwidth;return f(b)?Number(b):1}),F=r.reduce(h,0);r=r.map(function(a){return a/F*x});var D=Math.max(g(a.header.line.width),g(a.cells.line.width)),w={key:a.uid+b._context.staticPlot,translateX:o.x[0]*b._fullLayout._size.w,translateY:b._fullLayout._size.h*(1-o.y[1]),size:b._fullLayout._size,width:x,maxLineWidth:D,height:q,columnOrder:C,groupHeight:q,rowBlocks:B,headerRowBlocks:v,scrollY:0,cells:e({},a.cells,{values:p}),headerCells:e({},a.header,{values:n}),gdColumns:n.map(function(a){return a[0]}),gdColumnsOriginalOrder:n.map(function(a){return a[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:n.map(function(a,b){var c=E[a];E[a]=(c||0)+1;var d=a+"__"+E[a];return{key:d,label:a,specIndex:b,xIndex:C[b],xScale:k,x:void 0,calcdata:void 0,columnWidth:r[b]}})};return w.columns.forEach(function(a){a.calcdata=w,a.x=k(a)}),w}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(b,c,a){"use strict";var d=b("../../lib/extend").extendFlat;a.splitToPanels=function(a){var b=[0,0],c=d({},a,{key:"header",type:"header",page:0,prevPages:b,currentRepaint:[null,null],dragHandle:!0,values:a.calcdata.headerCells.values[a.specIndex],rowBlocks:a.calcdata.headerRowBlocks,calcdata:d({},a.calcdata,{cells:a.calcdata.headerCells})}),e=d({},a,{key:"cells1",type:"cells",page:0,prevPages:b,currentRepaint:[null,null],dragHandle:!1,values:a.calcdata.cells.values[a.specIndex],rowBlocks:a.calcdata.rowBlocks}),f=d({},a,{key:"cells2",type:"cells",page:1,prevPages:b,currentRepaint:[null,null],dragHandle:!1,values:a.calcdata.cells.values[a.specIndex],rowBlocks:a.calcdata.rowBlocks});return[e,f,c]},a.splitToCells=function(c){var d,a,b,e,f=(b=(a=(d=c).rowBlocks[d.page])?a.rows[0].rowIndex:0,e=a?b+a.rows.length:0,[b,e]);return(c.values||[]).slice(f[0],f[1]).map(function(a,b){return{keyWithinBlock:b+("string"==typeof a&&a.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:f[0]+b,column:c,calcdata:c.calcdata,page:c.page,rowBlocks:c.rowBlocks,value:a}})}},{"../../lib/extend":505}],1081:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../../plots/domain").defaults;b.exports=function(g,b,h,c){function a(a,c){return d.coerce(g,b,e,a,c)}f(b,c,a),a("columnwidth"),a("header.values"),a("header.format"),a("header.align"),a("header.prefix"),a("header.suffix"),a("header.height"),a("header.line.width"),a("header.line.color"),a("header.fill.color"),d.coerceFont(a,"header.font",d.extendFlat({},c.font)),function(c,f){for(var g=c.columnorder||[],d=c.header.values.length,e=g.slice(0,d),h=e.slice().sort(function(a,b){return a-b}),a=e.map(function(a){return h.indexOf(a)}),b=a.length;b<d;b++)a.push(b);f("columnorder",a)}(b,a),a("cells.values"),a("cells.format"),a("cells.align"),a("cells.prefix"),a("cells.suffix"),a("cells.height"),a("cells.line.width"),a("cells.line.color"),a("cells.fill.color"),d.coerceFont(a,"cells.font",d.extendFlat({},c.font)),b._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("./calc"),plot:a("./plot"),moduleType:"trace",name:"table",basePlotModule:a("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(a,b,c){"use strict";var d=a("./constants"),e=a("@plotly/d3"),f=a("../../lib").numberFormat,g=a("../../lib/gup"),h=a("../../components/drawing"),i=a("../../lib/svg_text_utils"),j=a("../../lib").raiseToTop,k=a("../../lib").strTranslate,l=a("../../lib").cancelTransition,m=a("./data_preparation_helper"),n=a("./data_split_helpers"),o=a("../../components/color");function p(a){return Math.ceil(a.calcdata.maxLineWidth/2)}function q(a,b){return"clip"+a._fullLayout._uid+"_scrollAreaBottomClip_"+b.key}function r(b,a){return"clip"+b._fullLayout._uid+"_columnBoundaryClippath_"+a.calcdata.key+"_"+a.specIndex}function s(a){return[].concat.apply([],a.map(function(a){return a})).map(function(a){return a.__data__})}function t(i,j,l){var b=i.selectAll("."+d.cn.scrollbarKit).data(g.repeat,g.keyFun);b.enter().append("g").classed(d.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),b.each(function(b){var c,a=b.scrollbarState;a.totalHeight=S(c=b.rowBlocks,c.length-1)+(c.length?T(c[c.length-1],1/0):1),a.scrollableAreaHeight=b.groupHeight-K(b),a.currentlyVisibleHeight=Math.min(a.totalHeight,a.scrollableAreaHeight),a.ratio=a.currentlyVisibleHeight/a.totalHeight,a.barLength=Math.max(a.ratio*a.currentlyVisibleHeight,d.goldenRatio*d.scrollbarWidth),a.barWiggleRoom=a.currentlyVisibleHeight-a.barLength,a.wiggleRoom=Math.max(0,a.totalHeight-a.scrollableAreaHeight),a.topY=0===a.barWiggleRoom?0:b.scrollY/a.wiggleRoom*a.barWiggleRoom,a.bottomY=a.topY+a.barLength,a.dragMultiplier=a.wiggleRoom/a.barWiggleRoom}).attr("transform",function(a){return k(a.width+d.scrollbarWidth/2+d.scrollbarOffset,K(a))});var c=b.selectAll("."+d.cn.scrollbar).data(g.repeat,g.keyFun);c.enter().append("g").classed(d.cn.scrollbar,!0);var f=c.selectAll("."+d.cn.scrollbarSlider).data(g.repeat,g.keyFun);f.enter().append("g").classed(d.cn.scrollbarSlider,!0),f.attr("transform",function(a){return k(0,a.scrollbarState.topY||0)});var a=f.selectAll("."+d.cn.scrollbarGlyph).data(g.repeat,g.keyFun);a.enter().append("line").classed(d.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",d.scrollbarWidth).attr("stroke-linecap","round").attr("y1",d.scrollbarWidth/2),a.attr("y2",function(a){return a.scrollbarState.barLength-d.scrollbarWidth/2}).attr("stroke-opacity",function(a){return a.columnDragInProgress||!a.scrollbarState.barWiggleRoom||l?0:.4}),a.transition().delay(0).duration(0),a.transition().delay(d.scrollbarHideDelay).duration(d.scrollbarHideDuration).attr("stroke-opacity",0);var h=c.selectAll("."+d.cn.scrollbarCaptureZone).data(g.repeat,g.keyFun);h.enter().append("line").classed(d.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",d.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(c){var d=e.event.y,f=this.getBoundingClientRect(),a=c.scrollbarState,b=d-f.top,g=e.scale.linear().domain([0,a.scrollableAreaHeight]).range([0,a.totalHeight]).clamp(!0);a.topY<=b&&b<=a.bottomY||M(j,i,null,g(b-a.barLength/2))(c)}).call(e.behavior.drag().origin(function(a){return e.event.stopPropagation(),a.scrollbarState.scrollbarScrollInProgress=!0,a}).on("drag",M(j,i)).on("dragend",function(){})),h.attr("y2",function(a){return a.scrollbarState.scrollableAreaHeight}),j._context.staticPlot&&(a.remove(),h.remove())}function u(c,d,e,f){var a=w(v(e));A(a),C(x(a));var b=y(z(a));B(b),D(b,d,f,c),R(a)}function v(b){var a=b.selectAll("."+d.cn.columnCells).data(g.repeat,g.keyFun);return a.enter().append("g").classed(d.cn.columnCells,!0),a.exit().remove(),a}function w(b){var a=b.selectAll("."+d.cn.columnCell).data(n.splitToCells,function(a){return a.keyWithinBlock});return a.enter().append("g").classed(d.cn.columnCell,!0),a.exit().remove(),a}function x(b){var a=b.selectAll("."+d.cn.cellRect).data(g.repeat,function(a){return a.keyWithinBlock});return a.enter().append("rect").classed(d.cn.cellRect,!0),a}function y(b){var a=b.selectAll("."+d.cn.cellText).data(g.repeat,function(a){return a.keyWithinBlock});return a.enter().append("text").classed(d.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){e.event.stopPropagation()}),a}function z(b){var a=b.selectAll("."+d.cn.cellTextHolder).data(g.repeat,function(a){return a.keyWithinBlock});return a.enter().append("g").classed(d.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),a}function A(a){a.each(function(a,b){var d=a.calcdata.cells.font,c=a.column.specIndex,e={size:G(d.size,c,b),color:G(d.color,c,b),family:G(d.family,c,b)};a.rowNumber=a.key,a.align=G(a.calcdata.cells.align,c,b),a.cellBorderWidth=G(a.calcdata.cells.line.width,c,b),a.font=e})}function B(a){a.each(function(a){h.font(e.select(this),a.font)})}function C(a){a.attr("width",function(a){return a.column.columnWidth}).attr("stroke-width",function(a){return a.cellBorderWidth}).each(function(a){var b=e.select(this);o.stroke(b,G(a.calcdata.cells.line.color,a.column.specIndex,a.rowNumber)),o.fill(b,G(a.calcdata.cells.fill.color,a.column.specIndex,a.rowNumber))})}function D(a,b,c,g){a.text(function(a){var g,h,i=a.column.specIndex,j=a.rowNumber,e=a.value,k="string"==typeof e,l=k&&e.match(/<br>/i);a.mayHaveMarkup=k&&e.match(/[<&>]/);var b=E(e);a.latex=b;var p=b?"":G(a.calcdata.cells.prefix,i,j)||"",q=b?"":G(a.calcdata.cells.suffix,i,j)||"",m=b?null:G(a.calcdata.cells.format,i,j)||null,c=p+(m?f(m)(a.value):a.value)+q;if(a.wrappingNeeded=!a.wrapped&&!(!k||l)&&!b&&(g=F(c)),a.cellHeightMayIncrease=l||b||a.mayHaveMarkup||(void 0===g?F(c):g),a.needsConvertToTspans=a.mayHaveMarkup||a.wrappingNeeded||a.latex,a.wrappingNeeded){var n=(" "===d.wrapSplitCharacter?c.replace(/<a href=/ig,"<a_href="):c).split(d.wrapSplitCharacter),o=" "===d.wrapSplitCharacter?n.map(function(a){return a.replace(/<a_href=/ig,"<a href=")}):n;a.fragments=o.map(function(a){return{text:a,width:null}}),a.fragments.push({fragment:d.wrapSpacer,width:null}),h=o.join(d.lineBreaker)+d.lineBreaker+d.wrapSpacer}else delete a.fragments,h=c;return h}).attr("dy",function(a){return a.needsConvertToTspans?0:"0.75em"}).each(function(a){var f=e.select(this),h=a.wrappingNeeded?O:P;a.needsConvertToTspans?i.convertToTspans(f,g,h(c,this,b,g,a)):e.select(this.parentNode).attr("transform",function(a){return k(Q(a),d.cellPad)}).attr("text-anchor",function(a){return({left:"start",center:"middle",right:"end"})[a.align]})})}function E(a){return"string"==typeof a&&a.match(d.latexCheck)}function F(a){return -1!==a.indexOf(d.wrapSplitCharacter)}function G(a,c,d){if(!Array.isArray(a))return a;var b=a[Math.min(c,a.length-1)];return Array.isArray(b)?b[Math.min(d,b.length-1)]:b}function H(a,b,c){a.transition().ease(d.releaseTransitionEase).duration(d.releaseTransitionDuration).attr("transform",k(b.x,c))}function I(a){return"cells"===a.type}function J(a){return"header"===a.type}function K(a){return(a.rowBlocks.length?a.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(a,b){return a+T(b,1/0)},0)}function L(d,c,f){var b=s(c)[0];if(void 0!==b){var e=b.rowBlocks,g=b.calcdata,i=S(e,e.length),h=b.calcdata.groupHeight-K(b),j=g.scrollY=Math.max(0,Math.min(i-h,g.scrollY)),a=function(e,j,k){for(var f=[],c=0,a=0;a<e.length;a++){for(var g=e[a],h=g.rows,b=0,d=0;d<h.length;d++)b+=h[d].rowHeight;g.allRowsHeight=b;var i=j,l=i+k;i<c+b&&l>c&&f.push(a),c+=b}return f}(e,j,h);1===a.length&&(a[0]===e.length-1?a.unshift(a[0]-1):a.push(a[0]+1)),a[0]%2&&a.reverse(),c.each(function(b,c){b.page=a[c],b.scrollY=j}),c.attr("transform",function(a){return k(0,S(a.rowBlocks,a.page)-a.scrollY)}),d&&(N(d,f,c,a,b.prevPages,b,0),N(d,f,c,a,b.prevPages,b,1),t(f,d))}}function M(a,b,c,f){return function(h){var g=h.calcdata?h.calcdata:h,i=b.filter(function(a){return g.key===a.key}),j=c||g.scrollbarState.dragMultiplier,k=g.scrollY;g.scrollY=void 0===f?g.scrollY+j*e.event.dy:f;var l=i.selectAll("."+d.cn.yColumn).selectAll("."+d.cn.columnBlock).filter(I);return L(a,l,i),g.scrollY===k}}function N(e,f,g,c,d,b,a){c[a]!==d[a]&&(clearTimeout(b.currentRepaint[a]),b.currentRepaint[a]=setTimeout(function(){u(e,f,g.filter(function(e,b){return b===a&&c[b]!==d[b]}),g),d[a]=c[a]}))}function O(a,b,c,f){return function(){var g=e.select(b.parentNode);g.each(function(a){var f,h,e=a.fragments;g.selectAll("tspan.line").each(function(b,a){e[a].width=this.getComputedTextLength()});var j=e[e.length-1].width,i=e.slice(0,-1),b=[],c=0,k=a.column.columnWidth-2*d.cellPad;for(a.value="";i.length;)c+(h=(f=i.shift()).width+j)>k&&(a.value+=b.join(d.wrapSpacer)+d.lineBreaker,b=[],c=0),b.push(f.text),c+=h;c&&(a.value+=b.join(d.wrapSpacer)),a.wrapped=!0}),g.selectAll("tspan.line").remove(),D(g.select("."+d.cn.cellText),c,a,f),e.select(b.parentNode.parentNode).call(R)}}function P(a,b,c,f,g){return function(){if(!g.settledY){var m=e.select(b.parentNode),h=V(g),i=g.key-h.firstRowIndex,j=h.rows[i].rowHeight,l=Math.max(g.cellHeightMayIncrease?b.parentNode.getBoundingClientRect().height+2*d.cellPad:j,j);l-h.rows[i].rowHeight&&(h.rows[i].rowHeight=l,a.selectAll("."+d.cn.columnCell).call(R),L(null,a.filter(I),0),t(c,f,!0)),m.attr("transform",function(){var a=this,c=a.parentNode.getBoundingClientRect(),f=e.select(a.parentNode).select("."+d.cn.cellRect).node().getBoundingClientRect(),b=a.transform.baseVal.consolidate(),h=f.top-c.top+(b?b.matrix.f:d.cellPad);return k(Q(g,e.select(a.parentNode).select("."+d.cn.cellTextHolder).node().getBoundingClientRect().width),h)}),g.settledY=!0}}}function Q(a,b){switch(a.align){case"left":return d.cellPad;case"right":return a.column.columnWidth-(b||0)-d.cellPad;case"center":return(a.column.columnWidth-(b||0))/2;default:return d.cellPad}}function R(a){a.attr("transform",function(a){var b=a.rowBlocks[0].auxiliaryBlocks.reduce(function(a,b){return a+T(b,1/0)},0),c=V(a),d=T(c,a.key);return k(0,d+b)}).selectAll("."+d.cn.cellRect).attr("height",function(a){return W(V(a),a.key).rowHeight})}function S(c,d){for(var b=0,a=d-1;a>=0;a--)b+=U(c[a]);return b}function T(b,d){for(var c=0,a=0;a<b.rows.length&&b.rows[a].rowIndex<d;a++)c+=b.rows[a].rowHeight;return c}function U(a){var d=a.allRowsHeight;if(void 0!==d)return d;for(var b=0,c=0;c<a.rows.length;c++)b+=a.rows[c].rowHeight;return a.allRowsHeight=b,b}function V(a){return a.rowBlocks[a.page]}function W(a,b){return a.rows[b-a.firstRowIndex]}b.exports=function(c,B){var o=!c._context.staticPlot,i=c._fullLayout._paper.selectAll("."+d.cn.table).data(B.map(function(a){return m(c,g.unwrap(a).trace)}),g.keyFun);i.exit().remove(),i.enter().append("g").classed(d.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),i.attr("width",function(a){return a.width+a.size.l+a.size.r}).attr("height",function(a){return a.height+a.size.t+a.size.b}).attr("transform",function(a){return k(a.translateX,a.translateY)});var a=i.selectAll("."+d.cn.tableControlView).data(g.repeat,g.keyFun),C=a.enter().append("g").classed(d.cn.tableControlView,!0).style("box-sizing","content-box");if(o){var D="onwheel"in document?"wheel":"mousewheel";C.on("mousemove",function(b){a.filter(function(a){return b===a}).call(t,c)}).on(D,function(b){b.scrollbarState.wheeling||(b.scrollbarState.wheeling=!0,M(c,a,null,b.scrollY+e.event.deltaY)(b)||(e.event.stopPropagation(),e.event.preventDefault()),b.scrollbarState.wheeling=!1)}).call(t,c,!0)}a.attr("transform",function(a){return k(a.size.l,a.size.t)});var x=a.selectAll("."+d.cn.scrollBackground).data(g.repeat,g.keyFun);x.enter().append("rect").classed(d.cn.scrollBackground,!0).attr("fill","none"),x.attr("width",function(a){return a.width}).attr("height",function(a){return a.height}),a.each(function(a){h.setClipUrl(e.select(this),q(c,a),c)});var b=a.selectAll("."+d.cn.yColumn).data(function(a){return a.columns},g.keyFun);b.enter().append("g").classed(d.cn.yColumn,!0),b.exit().remove(),b.attr("transform",function(a){return k(a.x,0)}),o&&b.call(e.behavior.drag().origin(function(b){return H(e.select(this),b,-d.uplift),j(this),b.calcdata.columnDragInProgress=!0,t(a.filter(function(a){return b.calcdata.key===a.key}),c),b}).on("drag",function(a){var c=e.select(this),f=function(b){return(a===b?e.event.x:b.x)+b.columnWidth/2};a.x=Math.max(-d.overdrag,Math.min(a.calcdata.width+d.overdrag-a.columnWidth,e.event.x)),s(b).filter(function(b){return b.calcdata.key===a.calcdata.key}).sort(function(a,b){return f(a)-f(b)}).forEach(function(b,c){b.xIndex=c,b.x=a===b?b.x:b.xScale(b)}),b.filter(function(b){return a!==b}).transition().ease(d.transitionEase).duration(d.transitionDuration).attr("transform",function(a){return k(a.x,0)}),c.call(l).attr("transform",k(a.x,-d.uplift))}).on("dragend",function(a){var d,b,f,h,i=e.select(this),g=a.calcdata;a.x=a.xScale(a),a.calcdata.columnDragInProgress=!1,H(i,a,0),d=c,b=g,f=g.columns.map(function(a){return a.xIndex}),h=b.gdColumnsOriginalOrder,b.gdColumns.sort(function(a,b){return f[h.indexOf(a)]-f[h.indexOf(b)]}),b.columnorder=f,d.emit("plotly_restyle")})),b.each(function(a){h.setClipUrl(e.select(this),r(c,a),c)});var f=b.selectAll("."+d.cn.columnBlock).data(n.splitToPanels,g.keyFun);f.enter().append("g").classed(d.cn.columnBlock,!0).attr("id",function(a){return a.key}),f.style("cursor",function(a){return a.dragHandle?"ew-resize":a.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var E=f.filter(J),v=f.filter(I);o&&v.call(e.behavior.drag().origin(function(a){return e.event.stopPropagation(),a}).on("drag",M(c,a,-1)).on("dragend",function(){})),u(c,a,E,f),u(c,a,v,f);var y=a.selectAll("."+d.cn.scrollAreaClip).data(g.repeat,g.keyFun);y.enter().append("clipPath").classed(d.cn.scrollAreaClip,!0).attr("id",function(a){return q(c,a)});var z=y.selectAll("."+d.cn.scrollAreaClipRect).data(g.repeat,g.keyFun);z.enter().append("rect").classed(d.cn.scrollAreaClipRect,!0).attr("x",-d.overdrag).attr("y",-d.uplift).attr("fill","none"),z.attr("width",function(a){return a.width+2*d.overdrag}).attr("height",function(a){return a.height+d.uplift});var F=b.selectAll("."+d.cn.columnBoundary).data(g.repeat,g.keyFun);F.enter().append("g").classed(d.cn.columnBoundary,!0);var w=b.selectAll("."+d.cn.columnBoundaryClippath).data(g.repeat,g.keyFun);w.enter().append("clipPath").classed(d.cn.columnBoundaryClippath,!0),w.attr("id",function(a){return r(c,a)});var A=w.selectAll("."+d.cn.columnBoundaryRect).data(g.repeat,g.keyFun);A.enter().append("rect").classed(d.cn.columnBoundaryRect,!0).attr("fill","none"),A.attr("width",function(a){return a.columnWidth+2*p(a)}).attr("height",function(a){return a.calcdata.height+2*p(a)+d.uplift}).attr("x",function(a){return-p(a)}).attr("y",function(a){return-p(a)}),L(null,v,a)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(b,f,k){"use strict";var g=b("../../plots/template_attributes").hovertemplateAttrs,h=b("../../plots/template_attributes").texttemplateAttrs,i=b("../../components/colorscale/attributes"),j=b("../../plots/domain").attributes,c=b("../pie/attributes"),a=b("../sunburst/attributes"),e=b("./constants"),d=b("../../lib/extend").extendFlat;f.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:d({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:a.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:a.marker.line,editType:"calc"},i("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:d({},c.textfont,{}),editType:"calc"},text:c.text,textinfo:a.textinfo,texttemplate:h({editType:"plot"},{keys:e.eventDataKeys.concat(["label","value"])}),hovertext:c.hovertext,hoverinfo:a.hoverinfo,hovertemplate:g({},{keys:e.eventDataKeys}),textfont:c.textfont,insidetextfont:c.insidetextfont,outsidetextfont:d({},c.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:c.sort,root:a.root,domain:j({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(b,c,a){"use strict";var d=b("../../plots/plots");a.name="treemap",a.plot=function(b,c,e,f){d.plotBasePlot(a.name,b,c,e,f)},a.clean=function(b,c,e,f){d.cleanBasePlot(a.name,b,c,e,f)}},{"../../plots/plots":628}],1086:[function(b,c,a){"use strict";var d=b("../sunburst/calc");a.calc=function(a,b){return d.calc(a,b)},a.crossTraceCalc=function(a){return d._runCrossTraceCalc("treemap",a)}},{"../sunburst/calc":1060}],1087:[function(b,a,c){"use strict";a.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(a,c,d){"use strict";var e=a("../../lib"),f=a("./attributes"),g=a("../../components/color"),h=a("../../plots/domain").defaults,i=a("../bar/defaults").handleText,j=a("../bar/constants").TEXTPAD,b=a("../../components/colorscale"),k=b.hasColorscale,l=b.handleDefaults;c.exports=function(m,b,u,d){function a(a,c){return e.coerce(m,b,f,a,c)}var n=a("labels"),o=a("parents");if(!n||!n.length||!o||!o.length){b.visible=!1;return}var p=a("values");a(p&&p.length?"branchvalues":"count"),a("level"),a("maxdepth"),"squarify"===a("tiling.packing")&&a("tiling.squarifyratio"),a("tiling.flip"),a("tiling.pad");var s=a("text");a("texttemplate"),b.texttemplate||a("textinfo",Array.isArray(s)?"text+label":"label"),a("hovertext"),a("hovertemplate");var q=a("pathbar.visible");i(m,b,d,a,"auto",{hasPathbar:q,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("textposition");var r=-1!==b.textposition.indexOf("bottom");a("marker.line.width")&&a("marker.line.color",d.paper_bgcolor);var t=a("marker.colors");(b._hasColorscale=k(m,"marker","colors")||(m.marker||{}).coloraxis)?l(m,b,d,a,{prefix:"marker.",cLetter:"c"}):a("marker.depthfade",!(t||[]).length);var c=2*b.textfont.size;a("marker.pad.t",r?c/4:c),a("marker.pad.l",c/4),a("marker.pad.r",c/4),a("marker.pad.b",r?c:c/4),b._hovered={marker:{line:{width:2,color:g.contrast(d.paper_bgcolor)}}},q&&(a("pathbar.thickness",b.pathbar.textfont.size+2*j),a("pathbar.side"),a("pathbar.edgeshape")),a("sort"),a("root.color"),h(b,d,a),b._length=null}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../sunburst/helpers"),f=a("../bar/uniform_text").clearMinTextSize,g=a("../bar/style").resizeText,h=a("./plot_one");b.exports=function(j,n,b,k,l){var c,o,a=l.type,p=l.drawDescendants,i=j._fullLayout,m=i["_"+a+"layer"];(f(a,i),(c=m.selectAll("g.trace."+a).data(n,function(a){return a[0].trace.uid})).enter().append("g").classed("trace",!0).classed(a,!0),c.order(),!i.uniformtext.mode&&e.hasTransition(b))?(k&&(o=k()),d.transition().duration(b.duration).ease(b.easing).each("end",function(){o&&o()}).each("interrupt",function(){o&&o()}).each(function(){m.selectAll("g.trace").each(function(a){h(j,a,this,b,p)})})):(c.each(function(a){h(j,a,this,b,p)}),i.uniformtext.mode&&g(j,m.selectAll(".trace"),a)),b||c.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../lib/svg_text_utils"),h=a("./partition"),i=a("./style").styleOne,j=a("./constants"),k=a("../sunburst/helpers"),l=a("../sunburst/fx");b.exports=function(o,r,s,b,a){var z=a.barDifY,c=a.width,p=a.height,A=a.viewX,B=a.viewY,t=a.pathSlice,C=a.toMoveInsideSlice,D=a.strTransform,u=a.hasTransition,v=a.handleSlicesExit,E=a.makeUpdateSliceInterpolator,F=a.makeUpdateTextInterpolator,w={},G=o._context.staticPlot,H=o._fullLayout,q=r[0],x=q.trace,y=q.hierarchy,I=c/x._entryDepth,J=k.listPath(s.data,"id"),m=h(y.copy(),[c,p],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(m=m.filter(function(a){var b=J.indexOf(a.data.id);return -1!==b&&(a.x0=I*b,a.x1=I*(b+1),a.y0=z,a.y1=z+p,a.onPathbar=!0,!0)})).reverse(),(b=b.data(m,k.getPtId)).enter().append("g").classed("pathbar",!0),v(b,!0,w,[c,p],t),b.order();var n=b;u&&(n=n.transition().each("end",function(){var a=d.select(this);k.setSliceCursor(a,o,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),n.each(function(a){a._x0=A(a.x0),a._x1=A(a.x1),a._y0=B(a.y0),a._y1=B(a.y1),a._hoverX=A(a.x1-Math.min(c,p)/2),a._hoverY=B(a.y1-p/2);var h=d.select(this),m=e.ensureSingle(h,"path","surface",function(a){a.style("pointer-events",G?"none":"all")});u?m.transition().attrTween("d",function(a){var b=E(a,!0,w,[c,p]);return function(a){return t(b(a))}}):m.attr("d",t),h.call(l,s,o,r,{styleOne:i,eventDataKeys:j.eventDataKeys,transitionTime:j.CLICK_TRANSITION_TIME,transitionEasing:j.CLICK_TRANSITION_EASING}).call(k.setSliceCursor,o,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:o._transitioning}),m.call(i,a,x,{hovered:!1}),a._text=(k.getPtLabel(a)||"").split("<br>").join(" ")||"";var q=e.ensureSingle(h,"g","slicetext"),b=e.ensureSingle(q,"text","",function(a){a.attr("data-notex",1)}),n=e.ensureUniformFontSize(o,k.determineTextFont(x,a,H.font,{onPathbar:!0}));b.text(a._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(f.font,n).call(g.convertToTspans,o),a.textBB=f.bBox(b.node()),a.transform=C(a,{fontSize:n.size,onPathbar:!0}),a.transform.fontSize=n.size,u?b.transition().attrTween("transform",function(a){var b=F(a,!0,w,[c,p]);return function(a){return D(b(a))}}):b.attr("transform",D(a))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../lib/svg_text_utils"),h=a("./partition"),i=a("./style").styleOne,j=a("./constants"),k=a("../sunburst/helpers"),l=a("../sunburst/fx"),m=a("../sunburst/plot").formatSliceLabel;b.exports=function(o,w,x,c,b){var p=b.width,q=b.height,C=b.viewX,D=b.viewY,y=b.pathSlice,E=b.toMoveInsideSlice,F=b.strTransform,r=b.hasTransition,z=b.handleSlicesExit,G=b.makeUpdateSliceInterpolator,H=b.makeUpdateTextInterpolator,s=b.prevEntry,I=o._context.staticPlot,J=o._fullLayout,a=w[0].trace,K=-1!==a.textposition.indexOf("left"),L=-1!==a.textposition.indexOf("right"),t=-1!==a.textposition.indexOf("bottom"),M=!t&&!a.marker.pad.t||t&&!a.marker.pad.b,u=h(x,[p,q],{packing:a.tiling.packing,squarifyratio:a.tiling.squarifyratio,flipX:a.tiling.flip.indexOf("x")> -1,flipY:a.tiling.flip.indexOf("y")> -1,pad:{inner:a.tiling.pad,top:a.marker.pad.t,left:a.marker.pad.l,right:a.marker.pad.r,bottom:a.marker.pad.b}}).descendants(),A=1/0,v=-1/0;u.forEach(function(b){var c=b.depth;c>=a._maxDepth?(b.x0=b.x1=(b.x0+b.x1)/2,b.y0=b.y1=(b.y0+b.y1)/2):(A=Math.min(A,c),v=Math.max(v,c))}),c=c.data(u,k.getPtId),a._maxVisibleLayers=isFinite(v)?v-A+1:0,c.enter().append("g").classed("slice",!0),z(c,!1,{},[p,q],y),c.order();var B=null;if(r&&s){var N=k.getPtId(s);c.each(function(a){null===B&&k.getPtId(a)===N&&(B={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1})})}var O=function(){return B||{x0:0,x1:p,y0:0,y1:q}},n=c;return r&&(n=n.transition().each("end",function(){var a=d.select(this);k.setSliceCursor(a,o,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),n.each(function(b){var h=k.isHeader(b,a);b._x0=C(b.x0),b._x1=C(b.x1),b._y0=D(b.y0),b._y1=D(b.y1),b._hoverX=C(b.x1-a.marker.pad.r),b._hoverY=t?D(b.y1-a.marker.pad.b/2):D(b.y0+a.marker.pad.t/2);var n=d.select(this),s=e.ensureSingle(n,"path","surface",function(a){a.style("pointer-events",I?"none":"all")});r?s.transition().attrTween("d",function(a){var b=G(a,!1,O(),[p,q]);return function(a){return y(b(a))}}):s.attr("d",y),n.call(l,x,o,w,{styleOne:i,eventDataKeys:j.eventDataKeys,transitionTime:j.CLICK_TRANSITION_TIME,transitionEasing:j.CLICK_TRANSITION_EASING}).call(k.setSliceCursor,o,{isTransitioning:o._transitioning}),s.call(i,b,a,{hovered:!1}),b.x0===b.x1||b.y0===b.y1?b._text="":h?b._text=M?"":k.getPtLabel(b)||"":b._text=m(b,x,a,w,J)||"";var v=e.ensureSingle(n,"g","slicetext"),c=e.ensureSingle(v,"text","",function(a){a.attr("data-notex",1)}),u=e.ensureUniformFontSize(o,k.determineTextFont(a,b,J.font));c.text(b._text||" ").classed("slicetext",!0).attr("text-anchor",L?"end":K||h?"start":"middle").call(f.font,u).call(g.convertToTspans,o),b.textBB=f.bBox(c.node()),b.transform=E(b,{fontSize:u.size,isHeader:h}),b.transform.fontSize=u.size,r?c.transition().attrTween("transform",function(a){var b=H(a,!1,O(),[p,q]);return function(a){return F(b(a))}}):c.attr("transform",F(b))}),B}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(b,a,c){"use strict";a.exports=function f(a,b,c){c.swapXY&&(g=a.x0,a.x0=a.y0,a.y0=g,g=a.x1,a.x1=a.y1,a.y1=g),c.flipX&&(g=a.x0,a.x0=b[0]-a.x1,a.x1=b[0]-g),c.flipY&&(g=a.y0,a.y0=b[1]-a.y1,a.y1=b[1]-g);var g,d=a.children;if(d)for(var e=0;e<d.length;e++)f(d[e],b,c)}},{}],1093:[function(a,b,c){"use strict";b.exports={moduleType:"trace",name:"treemap",basePlotModule:a("./base_plot"),categories:[],animatable:!0,attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc").calc,crossTraceCalc:a("./calc").crossTraceCalc,plot:a("./plot"),style:a("./style").style,colorbar:a("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(b,a,c){"use strict";a.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(c,b){function a(a,f){return d.coerce(c,b,e,a,f)}a("treemapcolorway",b.colorway),a("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(a,b,c){"use strict";var d=a("d3-hierarchy"),e=a("./flip_tree");b.exports=function(n,b,a){var c,f=a.flipX,g=a.flipY,h="dice-slice"===a.packing,i=a.pad[g?"bottom":"top"],j=a.pad[f?"right":"left"],k=a.pad[f?"left":"right"],l=a.pad[g?"top":"bottom"];h&&(c=j,j=i,i=c,c=k,k=l,l=c);var m=d.treemap().tile(function(a,b){switch(a){case"squarify":return d.treemapSquarify.ratio(b);case"binary":return d.treemapBinary;case"dice":return d.treemapDice;case"slice":return d.treemapSlice;default:return d.treemapSliceDice}}(a.packing,a.squarifyratio)).paddingInner(a.pad.inner).paddingLeft(j).paddingRight(k).paddingTop(i).paddingBottom(l).size(h?[b[1],b[0]]:b)(n);return(h||f||g)&&e(m,b,{swapXY:h,flipX:f,flipY:g}),m}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(a,b,c){"use strict";var d=a("./draw"),e=a("./draw_descendants");b.exports=function(a,b,c,f){return d(a,b,c,f,{type:"treemap",drawDescendants:e})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("d3-interpolate").interpolate,f=a("../sunburst/helpers"),g=a("../../lib"),h=a("../bar/constants").TEXTPAD,i=a("../bar/plot").toMoveInsideBar,j=a("../bar/uniform_text").recordMinTextSize,k=a("./constants"),l=a("./draw_ancestors");function m(a){return f.isHierarchyRoot(a)?"":f.getPtId(a)}b.exports=function(p,q,M,N,O){var r=p._fullLayout,s=q[0],a=s.trace,V="icicle"===a.type,P=s.hierarchy,n=f.findEntryWithLevel(P,a.level),A=d.select(M),o=A.selectAll("g.pathbar"),t=A.selectAll("g.slice");if(!n){o.remove(),t.remove();return}var B=f.isHierarchyRoot(n),u=!r.uniformtext.mode&&f.hasTransition(N),C=f.getMaxDepth(a),W=function(a){return a.data.depth-n.data.depth<C},c=r._size,b=a.domain,v=c.w*(b.x[1]-b.x[0]),w=c.h*(b.y[1]-b.y[0]),x=v,y=a.pathbar.thickness,D=a.marker.line.width+k.gapWithPathbar,z=a.pathbar.visible?a.pathbar.side.indexOf("bottom")> -1?w+D:-(y+D):0,X={x0:x,x1:x,y0:z,y1:z+y},Y=function(b,d,e){var c=a.tiling.pad,f=function(a){return a-c<=d.x0},g=function(a){return a+c>=d.x1},h=function(a){return a-c<=d.y0},i=function(a){return a+c>=d.y1};return b.x0===d.x0&&b.x1===d.x1&&b.y0===d.y0&&b.y1===d.y1?{x0:b.x0,x1:b.x1,y0:b.y0,y1:b.y1}:{x0:f(b.x0-c)?0:g(b.x0-c)?e[0]:b.x0,x1:f(b.x1+c)?0:g(b.x1+c)?e[0]:b.x1,y0:h(b.y0-c)?0:i(b.y0-c)?e[1]:b.y0,y1:h(b.y1+c)?0:i(b.y1+c)?e[1]:b.y1}},Q=null,Z={},$={},R=null,_=function(a,b){return b?Z[m(a)]:$[m(a)]},aa=function(b,c,d,e){if(c)return Z[m(P)]||X;var f=$[a.level]||d;return W(b)?Y(b,f,e):{}};s.hasMultipleRoots&&B&&C++,a._maxDepth=C,a._backgroundColor=r.paper_bgcolor,a._entryDepth=n.data.depth,a._atRootLevel=B;var ab=-v/2+c.l+c.w*(b.x[1]+b.x[0])/2,ac=-w/2+c.t+c.h*(1-(b.y[1]+b.y[0])/2),E=function(a){return ab+a},F=function(a){return ac+a},ad=F(0),ae=E(0),G=function(a){return ae+a},S=function(a){return ad+a};function af(a,b){return a+","+b}var ag=G(0),ah=function(a){a.x=Math.max(ag,a.x)},ai=a.pathbar.edgeshape,T=function(d){var i=G(Math.max(Math.min(d.x0,d.x0),0)),j=G(Math.min(Math.max(d.x1,d.x1),x)),k=S(d.y0),l=S(d.y1),a=y/2,b={},c={};b.x=i,c.x=j,b.y=c.y=(k+l)/2;var e={x:i,y:k},f={x:j,y:k},g={x:j,y:l},h={x:i,y:l};return">"===ai?(e.x-=a,f.x-=a,g.x-=a,h.x-=a):"/"===ai?(g.x-=a,h.x-=a,b.x-=a/2,c.x-=a/2):"\\"===ai?(e.x-=a,f.x-=a,b.x-=a/2,c.x-=a/2):"<"===ai&&(b.x-=a,c.x-=a),ah(e),ah(h),ah(b),ah(f),ah(g),ah(c),"M"+af(e.x,e.y)+"L"+af(f.x,f.y)+"L"+af(c.x,c.y)+"L"+af(g.x,g.y)+"L"+af(h.x,h.y)+"L"+af(b.x,b.y)+"Z"},U=function(b){var d=E(b.x0),e=E(b.x1),f=F(b.y0),g=F(b.y1),i=e-d,j=g-f;if(!i||!j)return"";var h=0,a=i>2*h&&j>2*h?h:0,c=function(b,c){return a?"a"+af(a,a)+" 0 0 1 "+af(b,c):""};return"M"+af(d,f+a)+c(a,-a)+"L"+af(e-a,f)+c(a,a)+"L"+af(e,g-a)+c(-a,a)+"L"+af(d+a,g)+c(-a,-a)+"Z"},H=function(l,m){var e=l.x0,f=l.x1,g=l.y0,k=l.y1,q=l.textBB,n=function(b){return -1!==a.textposition.indexOf(b)},o=n("bottom"),s=n("top")||m.isHeader&&!o?"start":o?"end":"middle",t=n("right"),u=n("left")||m.onPathbar,v=u?-1:t?1:0,c=a[V?"tiling":"marker"].pad;if(m.isHeader){if(e+=(V?c:c.l)-h,f-=(V?c:c.r)-h,e>=f){var d,p=(e+f)/2;e=p,f=p}o?g<(d=k-(V?c:c.b))&&d<k&&(g=d):(d=g+(V?c:c.t),g<d&&d<k&&(k=d))}var b=i(e,f,g,k,q,{isHorizontal:!1,constrained:!0,angle:0,anchor:s,leftToRight:v});return(b.fontSize=m.fontSize,b.targetX=E(b.targetX),b.targetY=F(b.targetY),isNaN(b.targetX)||isNaN(b.targetY))?{}:(e!==f&&g!==k&&j(a.type,b,r),{scale:b.scale,rotate:b.rotate,textX:b.textX,textY:b.textY,anchorX:b.anchorX,anchorY:b.anchorY,targetX:b.targetX,targetY:b.targetY})},aj=function(d,e){for(var a,b=0,c=d;!a&&b<C;)b++,(c=c.parent)?a=_(c,e):b=C;return a||{}},ak=function(c,a,h,f){var b,g=_(c,a);if(a)b=X;else{var d=_(n,a);b=d?Y(c,d,f):{}}return e(g,b)},I=function(b,c,i,j,d){var a,f=_(b,c);if(f)a=f;else if(c)a=X;else if(Q)if(b.parent){var h=R||i;h&&!c?a=Y(b,h,j):(a={},g.extendFlat(a,aj(b,c)))}else a=g.extendFlat({},b),V&&("h"===d.orientation?d.flipX?a.x0=b.x1:a.x1=0:d.flipY?a.y0=b.y1:a.y1=0);else a={};return e(a,{x0:b.x0,x1:b.x1,y0:b.y0,y1:b.y1})},J=function(b,i,l,m){var k=_(b,i),d={},h=aa(b,i,l,m);g.extendFlat(d,{transform:H({x0:h.x0,x1:h.x1,y0:h.y0,y1:h.y1,textBB:b.textBB,_text:b._text},{isHeader:f.isHeader(b,a)})}),k?d=k:b.parent&&g.extendFlat(d,aj(b,i));var c=b.transform;return b.x0!==b.x1&&b.y0!==b.y1&&j(a.type,c,r),e(d,{transform:{scale:c.scale,rotate:c.rotate,textX:c.textX,textY:c.textY,anchorX:c.anchorX,anchorY:c.anchorY,targetX:c.targetX,targetY:c.targetY}})},K=function(a,c,e,b,f){var g=b[0],h=b[1];u?a.exit().transition().each(function(){var a=d.select(this);a.select("path.surface").transition().attrTween("d",function(a){var b=ak(a,c,e,[g,h]);return function(a){return f(b(a))}}),a.select("g.slicetext").attr("opacity",0)}).remove():a.exit().remove()},L=function(c){var b=c.transform;return c.x0!==c.x1&&c.y0!==c.y1&&j(a.type,b,r),g.getTextTransform({textX:b.textX,textY:b.textY,anchorX:b.anchorX,anchorY:b.anchorY,targetX:b.targetX,targetY:b.targetY,scale:b.scale,rotate:b.rotate})};u&&(o.each(function(a){Z[m(a)]={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1},a.transform&&(Z[m(a)].transform={textX:a.transform.textX,textY:a.transform.textY,anchorX:a.transform.anchorX,anchorY:a.transform.anchorY,targetX:a.transform.targetX,targetY:a.transform.targetY,scale:a.transform.scale,rotate:a.transform.rotate})}),t.each(function(a){$[m(a)]={x0:a.x0,x1:a.x1,y0:a.y0,y1:a.y1},a.transform&&($[m(a)].transform={textX:a.transform.textX,textY:a.transform.textY,anchorX:a.transform.anchorX,anchorY:a.transform.anchorY,targetX:a.transform.targetX,targetY:a.transform.targetY,scale:a.transform.scale,rotate:a.transform.rotate}),!Q&&f.isEntry(a)&&(Q=a)})),R=O(p,q,n,t,{width:v,height:w,viewX:E,viewY:F,pathSlice:U,toMoveInsideSlice:H,prevEntry:Q,makeUpdateSliceInterpolator:I,makeUpdateTextInterpolator:J,handleSlicesExit:K,hasTransition:u,strTransform:L}),a.pathbar.visible?l(p,q,n,o,{barDifY:z,width:x,height:y,viewX:G,viewY:S,pathSlice:T,toMoveInsideSlice:H,makeUpdateSliceInterpolator:I,makeUpdateTextInterpolator:J,handleSlicesExit:K,hasTransition:u,strTransform:L}):o.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../components/color"),g=a("../../lib"),h=a("../sunburst/helpers"),i=a("../bar/uniform_text").resizeText;function c(m,b,a,n){var o=(n||{}).hovered,i=b.data.data,j=i.i,d=i.color,p=h.isHierarchyRoot(b),k=1;if(o)q=a._hovered.marker.line.color,r=a._hovered.marker.line.width;else if(p&&d===a.root.color)k=100,q="rgba(0,0,0,0)",r=0;else if(q=g.castOption(a,j,"marker.line.color")||f.defaultLine,r=g.castOption(a,j,"marker.line.width")||0,!a._hasColorscale&&!b.onPathbar){var l=a.marker.depthfade;if(l){var q,r,c,s=f.combine(f.addOpacity(a._backgroundColor,.75),d);if(!0===l?c=isFinite(h.getMaxDepth(a))?h.isLeaf(b)?0:a._maxVisibleLayers-(b.data.depth-a._entryDepth):b.data.height+1:(c=b.data.depth-a._entryDepth,!a._atRootLevel&&c++),c>0)for(var e=0;e<c;e++){var t=.5*e/c;d=f.combine(f.addOpacity(s,t),d)}}}m.style("stroke-width",r).call(f.fill,d).call(f.stroke,q).style("opacity",k)}b.exports={style:function(a){var b=a._fullLayout._treemaplayer.selectAll(".trace");i(a,b,"treemap"),b.each(function(b){var a=e.select(this),d=b[0].trace;a.style("opacity",d.opacity),a.selectAll("path.surface").each(function(a){e.select(this).call(c,a,d,{hovered:!1})})})},styleOne:c}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(c,e,f){"use strict";var a=c("../box/attributes"),b=c("../../lib/extend").extendFlat,d=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat;e.exports={y:a.y,x:a.x,x0:a.x0,y0:a.y0,xhoverformat:d("x"),yhoverformat:d("y"),name:b({},a.name,{}),orientation:b({},a.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,points:b({},a.boxpoints,{}),jitter:b({},a.jitter,{}),pointpos:b({},a.pointpos,{}),width:b({},a.width,{}),marker:a.marker,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate,quartilemethod:a.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../plots/cartesian/axes"),f=a("../box/calc"),g=a("./helpers"),h=a("../../constants/numerical").BADNUM;function i(b,a,e){var c=a.max-a.min;if(!c)return b.bandwidth?b.bandwidth:0;if(b.bandwidth)return Math.max(b.bandwidth,c/1e4);var f,g=e.length,h=d.stdev(e,g-1,a.mean);return Math.max((f=g,1.059*Math.min(h,(a.q3-a.q1)/1.349)*Math.pow(f,-0.2)),c/100)}function j(b,a,l,c){var d,f=b.spanmode,m=b.span||[],j=[a.min,a.max],k=[a.min-2*c,a.max+2*c];function g(c){var d=m[c],e="multicategory"===l.type?l.r2c(d):l.d2c(d,0,b[a.valLetter+"calendar"]);return e===h?k[c]:e}var i={type:"linear",range:d="soft"===f?k:"hard"===f?j:[g(0),g(1)]};return e.setConvert(i),i.cleanRange(),d}b.exports=function(m,b){var c=f(m,b);if(c[0].t.empty)return c;for(var C=m._fullLayout,q=e.getFromId(m,b["h"===b.orientation?"xaxis":"yaxis"]),r=1/0,s=-1/0,k=0,n=0,t=0;t<c.length;t++){var a=c[t],u=a.pts.map(g.extractVal),o=a.bandwidth=i(b,a,u),h=a.span=j(b,a,q,o);if(a.min===a.max&&0===o)h=a.span=[a.min,a.max],a.density=[{v:1,t:h[0]}],a.bandwidth=o,k=Math.max(k,1);else{var x=h[1]-h[0],v=Math.ceil(x/(o/3)),w=x/v;if(!isFinite(w)||!isFinite(v))return d.error("Something went wrong with computing the violin span"),c[0].t.empty=!0,c;var D=g.makeKDE(a,b,u);a.density=new Array(v);for(var y=0,p=h[0];p<h[1]+w/2;y++,p+=w){var z=D(p);a.density[y]={v:z,t:p},k=Math.max(k,z)}}n=Math.max(n,u.length),r=Math.min(r,h[0]),s=Math.max(s,h[1])}var E=e.findExtremes(q,[r,s],{padded:!0});if(b._extremes[q._id]=E,b.width)c[0].t.maxKDE=k;else{var A=C._violinScaleGroupStats,B=b.scalegroup,l=A[B];l?(l.maxKDE=Math.max(l.maxKDE,k),l.maxCount=Math.max(l.maxCount,n)):A[B]={maxKDE:k,maxCount:n}}return c[0].t.labels.kde=d._(m,"kde:"),c}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(a,b,c){"use strict";var d=a("../box/cross_trace_calc").setPositionOffset,e=["v","h"];b.exports=function(f,g){for(var h=f.calcdata,i=g.xaxis,j=g.yaxis,c=0;c<e.length;c++){for(var k=e[c],n="h"===k?j:i,l=[],b=0;b<h.length;b++){var m=h[b],o=m[0].t,a=m[0].trace;!0!==a.visible||"violin"!==a.type||o.empty||a.orientation!==k||a.xaxis!==i._id||a.yaxis!==j._id||l.push(b)}d("violin",f,l,n)}}},{"../box/cross_trace_calc":684}],1103:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("../../components/color"),f=a("../box/defaults"),g=a("./attributes");b.exports=function(h,b,l,m){function a(a,c){return d.coerce(h,b,g,a,c)}function c(a,c){return d.coerce2(h,b,g,a,c)}if(f.handleSampleDefaults(h,b,a,m),!1!==b.visible){a("bandwidth"),a("side"),a("width")||(a("scalegroup",b.name),a("scalemode"));var i,n=a("span");Array.isArray(n)&&(i="manual"),a("spanmode",i);var j=a("line.color",(h.marker||{}).color||l),k=a("line.width"),o=a("fillcolor",e.addOpacity(b.line.color,.5));f.handlePointsDefaults(h,b,a,{prefix:""});var p=c("box.width"),q=c("box.fillcolor",o),r=c("box.line.color",j),s=c("box.line.width",k),t=a("box.visible",Boolean(p||q||r||s));t||(b.box={visible:!1});var u=c("meanline.color",j),v=c("meanline.width",k),w=a("meanline.visible",Boolean(u||v));w||(b.meanline={visible:!1}),a("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(b,c,a){"use strict";var d=b("../../lib"),e={gaussian:function(a){return 1/Math.sqrt(2*Math.PI)*Math.exp(-0.5*a*a)}};a.makeKDE=function(a,f,b){var c=b.length,g=e.gaussian,d=a.bandwidth,h=1/(c*d);return function(f){for(var e=0,a=0;a<c;a++)e+=g((f-b[a])/d);return h*e}},a.getPositionOnKdePath=function(a,b,f){"h"===b.orientation?(g="y",h="x"):(g="x",h="y");var g,h,i=d.findPointOnPath(a.path,f,h,{pathLength:a.pathLength}),c=a.posCenterPx,e=i[g],j="both"===b.side?2*c-e:c;return[e,j]},a.getKdeValue=function(b,c,d){var e=b.pts.map(a.extractVal),f=a.makeKDE(b,c,e);return f(d)/b.posDensityScale},a.extractVal=function(a){return a.v}},{"../../lib":515}],1105:[function(a,b,c){"use strict";var d=a("../../components/color"),e=a("../../lib"),f=a("../../plots/cartesian/axes"),g=a("../box/hover"),h=a("./helpers");b.exports=function(c,w,x,E,y){y||(y={});var K=y.hoverLayer,z=c.cd,j=z[0].trace,A=j.hoveron,F=-1!==A.indexOf("violins"),G=-1!==A.indexOf("kde"),m=[];if(F||G){var i=g.hoverOnBoxes(c,w,x,E);if(G&&i.length>0){var p,n,k,a,s,q,l,H=c.xa,I=c.ya;"h"===j.orientation?(l=w,k="y",s=I,a="x",q=H):(l=x,k="x",s=H,a="y",q=I);var t=z[c.index];if(l>=t.span[0]&&l<=t.span[1]){var b=e.extendFlat({},c),B=q.c2p(l,!0),L=h.getKdeValue(t,j,l),u=h.getPositionOnKdePath(t,j,B),o=s._offset,J=s._length;b[k+"0"]=u[0],b[k+"1"]=u[1],b[a+"0"]=b[a+"1"]=B,b[a+"Label"]=a+": "+f.hoverLabelText(q,l,j[a+"hoverformat"])+", "+z[0].t.labels.kde+" "+L.toFixed(3);for(var r=0,v=0;v<i.length;v++)if("med"===i[v].attr){r=v;break}b.spikeDistance=i[r].spikeDistance;var C=k+"Spike";b[C]=i[r][C],i[r].spikeDistance=void 0,i[r][C]=void 0,b.hovertemplate=!1,m.push(b),(n={})[k+"1"]=e.constrain(o+u[0],o,o+J),n[k+"2"]=e.constrain(o+u[1],o,o+J),n[a+"1"]=n[a+"2"]=q._offset+B}}F&&(m=m.concat(i))}-1!==A.indexOf("points")&&(p=g.hoverOnPoints(c,w,x));var D=K.selectAll(".violinline-"+j.uid).data(n?[0]:[]);return(D.enter().append("line").classed("violinline-"+j.uid,!0).attr("stroke-width",1.5),D.exit().remove(),D.attr(n).call(d.stroke,c.color),"closest"===E)?p?[p]:m:(p&&m.push(p),m)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults"),crossTraceDefaults:a("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc"),plot:a("./plot"),style:a("./style"),styleOnSelect:a("../scatter/style").styleOnSelect,hoverPoints:a("./hover"),selectPoints:a("../box/select"),moduleType:"trace",name:"violin",basePlotModule:a("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(c,d,e){"use strict";var a=c("../box/layout_attributes"),b=c("../../lib").extendFlat;d.exports={violinmode:b({},a.boxmode,{}),violingap:b({},a.boxgap,{}),violingroupgap:b({},a.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes"),f=a("../box/layout_defaults");b.exports=function(a,b,c){f._supply(a,b,c,function(c,f){return d.coerce(a,b,e,c,f)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../box/plot"),h=a("../scatter/line_points"),i=a("./helpers");b.exports=function(b,a,c,j){var k=b._fullLayout,l=a.xaxis,m=a.yaxis;function n(a,b){var c=h(a,{xaxis:l,yaxis:m,trace:b,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return f.smoothopen(c[0],1)}e.makeTraceGroups(j,c,"trace violins").each(function(A){var h,j,t,f=d.select(this),u=A[0],c=u.t,b=u.trace;if(!0!==b.visible||c.empty){f.remove();return}var v=c.bPos,o=c.bdPos,w=a[c.valLetter+"axis"],x=a[c.posLetter+"axis"],p="both"===b.side,B=p||"positive"===b.side,C=p||"negative"===b.side,q=f.selectAll("path.violin").data(e.identity);q.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),q.exit().remove(),q.each(function(e){var i,m,q,r,a,j,g,l,A=d.select(this),f=e.density,h=f.length,s=x.c2l(e.pos+v,!0),t=x.l2p(s);if(b.width)i=c.maxKDE/o;else{var u=k._violinScaleGroupStats[b.scalegroup];i="count"===b.scalemode?u.maxKDE/o*(u.maxCount/e.pts.length):u.maxKDE/o}if(B){for(a=0,g=new Array(h);a<h;a++)(l=g[a]={})[c.posLetter]=s+f[a].v/i,l[c.valLetter]=w.c2l(f[a].t,!0);m=n(g,b)}if(C){for(j=0,g=new Array(h),a=h-1;j<h;j++,a--)(l=g[j]={})[c.posLetter]=s-f[a].v/i,l[c.valLetter]=w.c2l(f[a].t,!0);q=n(g,b)}if(p)r=m+"L"+q.substr(1)+"Z";else{var y=[t,w.c2p(f[0].t)],z=[t,w.c2p(f[h-1].t)];"h"===b.orientation&&(y.reverse(),z.reverse()),r=B?"M"+y+"L"+m.substr(1)+"L"+z:"M"+z+"L"+q.substr(1)+"L"+y}A.attr("d",r),e.posCenterPx=t,e.posDensityScale=i*o,e.path=A.node(),e.pathLength=e.path.getTotalLength()/(p?2:1)});var y=b.box,r=y.width,z=(y.line||{}).width;p?(h=o*r,j=0):B?(h=[0,o*r/2],j=z*({x:1,y:-1})[c.posLetter]):(h=[o*r/2,0],j=z*({x:-1,y:1})[c.posLetter]),g.plotBoxAndWhiskers(f,{pos:x,val:w},b,{bPos:v,bdPos:h,bPosPxOffset:j}),g.plotBoxMean(f,{pos:x,val:w},b,{bPos:v,bdPos:h,bPosPxOffset:j}),!b.box.visible&&b.meanline.visible&&(t=e.identity);var s=f.selectAll("path.meanline").data(t||[]);s.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),s.exit().remove(),s.each(function(e){var c=w.c2p(e.mean,!0),a=i.getPositionOnKdePath(e,b,c);d.select(this).attr("d","h"===b.orientation?"M"+c+","+a[0]+"V"+a[1]:"M"+a[0]+","+c+"H"+a[1])}),g.plotPoints(f,{x:l,y:m},b,c)})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../components/color"),f=a("../scatter/style").stylePoints;b.exports=function(b){var a=d.select(b).selectAll("g.trace.violins");a.style("opacity",function(a){return a[0].trace.opacity}),a.each(function(l){var a=l[0].trace,c=d.select(this),i=a.box||{},j=i.line||{},g=a.meanline||{},h=g.width;c.selectAll("path.violin").style("stroke-width",a.line.width+"px").call(e.stroke,a.line.color).call(e.fill,a.fillcolor),c.selectAll("path.box").style("stroke-width",j.width+"px").call(e.stroke,j.color).call(e.fill,i.fillcolor);var k={"stroke-width":h+"px","stroke-dasharray":2*h+"px,"+h+"px"};c.selectAll("path.mean").style(k).call(e.stroke,g.color),c.selectAll("path.meanline").style(k).call(e.stroke,g.color),f(c,a,b)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(b,f,j){"use strict";var g=b("../../components/colorscale/attributes"),a=b("../isosurface/attributes"),h=b("../surface/attributes"),e=b("../../plots/attributes"),d=b("../../lib/extend").extendFlat,i=b("../../plot_api/edit_types").overrideAll,c=f.exports=i(d({x:a.x,y:a.y,z:a.z,value:a.value,isomin:a.isomin,isomax:a.isomax,surface:a.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:a.slices,caps:a.caps,text:a.text,hovertext:a.hovertext,xhoverformat:a.xhoverformat,yhoverformat:a.yhoverformat,zhoverformat:a.zhoverformat,valuehoverformat:a.valuehoverformat,hovertemplate:a.hovertemplate},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:a.colorbar,opacity:a.opacity,opacityscale:h.opacityscale,lightposition:a.lightposition,lighting:a.lighting,flatshading:a.flatshading,contour:a.contour,hoverinfo:d({},e.hoverinfo),showlegend:d({},e.showlegend,{dflt:!1})}),"calc","nested");c.x.editType=c.y.editType=c.z.editType=c.value.editType="calc+clearAxisTypes",c.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(a,c,e){"use strict";var f=a("../../../stackgl_modules").gl_mesh3d,g=a("../../lib/gl_format_color").parseColorScale,h=a("../../lib/str2rgbarray"),i=a("../../components/colorscale").extractOpts,j=a("../../plots/gl3d/zip3"),k=a("../isosurface/convert").findNearestOnAxis,l=a("../isosurface/convert").generateIsoMeshes;function d(a,b,c){this.scene=a,this.uid=c,this.mesh=b,this.name="",this.data=null,this.showContour=!1}var b=d.prototype;b.handlePick=function(a){if(a.object===this.mesh){var d=a.data.index,f=this.data._meshX[d],g=this.data._meshY[d],h=this.data._meshZ[d],i=this.data._Ys.length,e=this.data._Zs.length,j=k(f,this.data._Xs).id,l=k(g,this.data._Ys).id,m=k(h,this.data._Zs).id,b=a.index=m+e*l+e*i*j;a.traceCoordinate=[this.data._meshX[b],this.data._meshY[b],this.data._meshZ[b],this.data._value[b]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&& void 0!==c[b]?a.textLabel=c[b]:c&&(a.textLabel=c),!0}},b.update=function(a){var b=this.scene,d=b.fullSceneLayout;function e(b,a,c,d){return a.map(function(a){return b.d2l(a,0,d)*c})}this.data=l(a);var k=j(e(d.xaxis,a._meshX,b.dataScale[0],a.xcalendar),e(d.yaxis,a._meshY,b.dataScale[1],a.ycalendar),e(d.zaxis,a._meshZ,b.dataScale[2],a.zcalendar)),m=j(a._meshI,a._meshJ,a._meshK),c={positions:k,cells:m,lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,opacityscale:a.opacityscale,contourEnable:a.contour.show,contourColor:h(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading},f=i(a);c.vertexIntensity=a._meshIntensity,c.vertexIntensityBounds=[f.min,f.max],c.colormap=g(a),this.mesh.update(c)},b.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},c.exports=function(a,e){var b=f({gl:a.glplot.gl}),c=new d(a,b,e.uid);return b._trace=c,c.update(e),a.glplot.add(b),c}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./attributes"),f=a("../isosurface/defaults").supplyIsoDefaults,g=a("../surface/defaults").opacityscaleDefaults;b.exports=function(a,b,i,c){function h(c,f){return d.coerce(a,b,e,c,f)}f(a,b,i,c,h),g(a,b,c,h)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),supplyDefaults:a("./defaults"),calc:a("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:a("./convert"),moduleType:"trace",name:"volume",basePlotModule:a("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(b,h,m){"use strict";var a=b("../bar/attributes"),c=b("../scatter/attributes").line,i=b("../../plots/attributes"),f=b("../../plots/cartesian/axis_format_attributes").axisHoverFormat,j=b("../../plots/template_attributes").hovertemplateAttrs,k=b("../../plots/template_attributes").texttemplateAttrs,g=b("./constants"),d=b("../../lib/extend").extendFlat,l=b("../../components/color");function e(b){return{marker:{color:d({},a.marker.color,{arrayOk:!1,editType:"style"}),line:{color:d({},a.marker.line.color,{arrayOk:!1,editType:"style"}),width:d({},a.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}h.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:f("x"),yhoverformat:f("y"),hovertext:a.hovertext,hovertemplate:j({},{keys:g.eventDataKeys}),hoverinfo:d({},i.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:k({editType:"plot"},{keys:g.eventDataKeys.concat(["label"])}),text:a.text,textposition:a.textposition,insidetextanchor:a.insidetextanchor,textangle:a.textangle,textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:a.orientation,offset:a.offset,width:a.width,increasing:e("increasing"),decreasing:e("decreasing"),totals:e("intermediate sums and total"),connector:{line:{color:d({},c.color,{dflt:l.defaultLine}),width:d({},c.width,{editType:"plot"}),dash:c.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(a,b,c){"use strict";var d=a("../../plots/cartesian/axes"),e=a("../../plots/cartesian/align_period"),f=a("../../lib").mergeArray,g=a("../scatter/calc_selection"),h=a("../../constants/numerical").BADNUM;function i(a){return"a"===a||"absolute"===a}function j(a){return"t"===a||"total"===a}b.exports=function(v,a){var l,w,n,o,q,p,r,s=d.getFromId(v,a.xaxis||"x"),t=d.getFromId(v,a.yaxis||"y");"h"===a.orientation?(l=s.makeCalcdata(a,"x"),n=t.makeCalcdata(a,"y"),o=e(a,t,"y",n),q=!!a.yperiodalignment,p="y"):(l=t.makeCalcdata(a,"y"),n=s.makeCalcdata(a,"x"),o=e(a,s,"x",n),q=!!a.xperiodalignment,p="x");for(var u=Math.min((w=o.vals).length,l.length),k=new Array(u),m=0,x=!1,b=0;b<u;b++){var y=l[b]||0,z=!1;(l[b]!==h||j(a.measure[b])||i(a.measure[b]))&&b+1<u&&(l[b+1]!==h||j(a.measure[b+1])||i(a.measure[b+1]))&&(z=!0);var c=k[b]={i:b,p:w[b],s:y,rawS:y,cNext:z};i(a.measure[b])?(m=c.s,c.isSum=!0,c.dir="totals",c.s=m):j(a.measure[b])?(c.isSum=!0,c.dir="totals",c.s=m):(c.isSum=!1,c.dir=c.rawS<0?"decreasing":"increasing",r=c.s,c.s=m+r,m+=r),"totals"===c.dir&&(x=!0),q&&(k[b].orig_p=n[b],k[b][p+"End"]=o.ends[b],k[b][p+"Start"]=o.starts[b]),a.ids&&(c.id=String(a.ids[b])),c.v=(a.base||0)+m}return k.length&&(k[0].hasTotals=x),f(a.text,k,"tx"),f(a.hovertext,k,"htx"),g(k,a),k}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(b,a,c){"use strict";a.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(a,b,c){"use strict";var d=a("../bar/cross_trace_calc").setGroupPositions;b.exports=function(e,k){var a,c,g=e._fullLayout,l=e._fullData,q=e.calcdata,h=k.xaxis,i=k.yaxis,j=[],m=[],n=[];for(c=0;c<l.length;c++){var f=l[c];!0===f.visible&&f.xaxis===h._id&&f.yaxis===i._id&&"waterfall"===f.type&&(a=q[c],"h"===f.orientation?n.push(a):m.push(a),j.push(a))}var o={mode:g.waterfallmode,norm:g.waterfallnorm,gap:g.waterfallgap,groupgap:g.waterfallgroupgap};for(d(e,h,i,m,o),d(e,i,h,n,o),c=0;c<j.length;c++){a=j[c];for(var b=0;b<a.length;b++){var p=a[b];!1===p.isSum&&(p.s0+=0===b?0:a[b-1].s),b+1<a.length&&(a[b].nextP0=a[b+1].p0,a[b].nextS0=a[b+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(a,c,d){"use strict";var e=a("../../lib"),f=a("../bar/defaults").handleGroupingDefaults,g=a("../bar/defaults").handleText,h=a("../scatter/xy_defaults"),i=a("../scatter/period_defaults"),j=a("./attributes"),k=a("../../components/color"),b=a("../../constants/delta.js"),l=b.INCREASING.COLOR,m=b.DECREASING.COLOR;function n(a,b,c){a(b+".marker.color",c),a(b+".marker.line.color",k.defaultLine),a(b+".marker.line.width")}c.exports={supplyDefaults:function(c,b,o,d){function a(a,d){return e.coerce(c,b,j,a,d)}if(!h(c,b,d,a)){b.visible=!1;return}i(c,b,d,a),a("xhoverformat"),a("yhoverformat"),a("measure"),a("orientation",b.x&&!b.y?"h":"v"),a("base"),a("offset"),a("width"),a("text"),a("hovertext"),a("hovertemplate");var f=a("textposition");g(c,b,d,a,f,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===b.textposition||(a("texttemplate"),b.texttemplate||a("textinfo")),n(a,"increasing",l),n(a,"decreasing",m),n(a,"totals","#4499FF");var k=a("connector.visible");k&&(a("connector.mode"),a("connector.line.width")&&(a("connector.line.color"),a("connector.line.dash")))},crossTraceDefaults:function(b,c){var d;function g(a){return e.coerce(d._input,d,j,a)}if("group"===c.waterfallmode)for(var a=0;a<b.length;a++)f((d=b[a])._input,d,c,g)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(b,a,c){"use strict";a.exports=function(b,a){return b.x="xVal"in a?a.xVal:a.x,b.y="yVal"in a?a.yVal:a.y,"initial"in a&&(b.initial=a.initial),"delta"in a&&(b.delta=a.delta),"final"in a&&(b.final=a.final),a.xa&&(b.xaxis=a.xa),a.ya&&(b.yaxis=a.ya),b}},{}],1121:[function(a,c,d){"use strict";var e=a("../../plots/cartesian/axes").hoverLabelText,f=a("../../components/color").opacity,g=a("../bar/hover").hoverOnBars,b=a("../../constants/delta.js"),h={increasing:b.INCREASING.SYMBOL,decreasing:b.DECREASING.SYMBOL};c.exports=function(k,t,u,v,w){var a=g(k,t,u,v,w);if(a){var l,m,n,q,r=a.cd,o=r[0].trace,p="h"===o.orientation,x=p?"x":"y",y=p?k.xa:k.ya,b=r[a.index],i=b.isSum?b.b+b.s:b.rawS;if(!b.isSum){a.initial=b.b+b.s-i,a.delta=i,a.final=a.initial+a.delta;var s=B(Math.abs(a.delta));a.deltaLabel=i<0?"("+s+")":s,a.finalLabel=B(a.final),a.initialLabel=B(a.initial)}var d=b.hi||o.hoverinfo,c=[];if(d&&"none"!==d&&"skip"!==d){var z="all"===d,A=d.split("+"),j=function(a){return z|| -1!==A.indexOf(a)};!b.isSum&&(!j("final")||j(p?"x":"y")||c.push(a.finalLabel),j("delta")&&(i<0?c.push(a.deltaLabel+" "+h.decreasing):c.push(a.deltaLabel+" "+h.increasing)),j("initial")&&c.push("Initial: "+a.initialLabel))}return c.length&&(a.extraText=c.join("<br>")),a.color=(m=(l=o[b.dir].marker).color,n=l.line.color,q=l.line.width,f(m)?m:f(n)&&q?n:void 0),[a]}function B(a){return e(y,a,o[x+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(a,b,c){"use strict";b.exports={attributes:a("./attributes"),layoutAttributes:a("./layout_attributes"),supplyDefaults:a("./defaults").supplyDefaults,crossTraceDefaults:a("./defaults").crossTraceDefaults,supplyLayoutDefaults:a("./layout_defaults"),calc:a("./calc"),crossTraceCalc:a("./cross_trace_calc"),plot:a("./plot"),style:a("./style").style,hoverPoints:a("./hover"),eventData:a("./event_data"),selectPoints:a("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:a("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(b,a,c){"use strict";a.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(a,b,c){"use strict";var d=a("../../lib"),e=a("./layout_attributes");b.exports=function(h,i,c){var f=!1;function a(a,b){return d.coerce(h,i,e,a,b)}for(var b=0;b<c.length;b++){var g=c[b];if(g.visible&&"waterfall"===g.type){f=!0;break}}f&&(a("waterfallmode"),a("waterfallgap",.2),a("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(a,b,c){"use strict";var d=a("@plotly/d3"),e=a("../../lib"),f=a("../../components/drawing"),g=a("../../constants/numerical").BADNUM,h=a("../bar/plot"),i=a("../bar/uniform_text").clearMinTextSize;b.exports=function(b,c,j,k){var a=b._fullLayout;i("waterfall",a),h.plot(b,c,j,k,{mode:a.waterfallmode,norm:a.waterfallmode,gap:a.waterfallgap,groupgap:a.waterfallgroupgap}),function(h,a,b,c){var i=a.xaxis,j=a.yaxis;e.makeTraceGroups(c,b,"trace bars").each(function(l){var m=d.select(this),b=l[0].trace,k=e.ensureSingle(m,"g","lines");if(!b.connector||!b.connector.visible){k.remove();return}var n="h"===b.orientation,o=b.connector.mode,c=k.selectAll("g.line").data(e.identity);c.enter().append("g").classed("line",!0),c.exit().remove();var p=c.size();c.each(function(r,u){if(u===p-1||r.cNext){var l,v,w,x,m,q,s,t,y=(l=r,v=i,w=j,m=[],q=[],s=(x=n)?v:w,t=x?w:v,m[0]=s.c2p(l.s0,!0),q[0]=t.c2p(l.p0,!0),m[1]=s.c2p(l.s1,!0),q[1]=t.c2p(l.p1,!0),m[2]=s.c2p(l.nextS0,!0),q[2]=t.c2p(l.nextP0,!0),x?[m,q]:[q,m]),b=y[0],c=y[1],k="";b[0]!==g&&c[0]!==g&&b[1]!==g&&c[1]!==g&&("spanning"===o&& !r.isSum&&u>0&&(n?k+="M"+b[0]+","+c[1]+"V"+c[0]:k+="M"+b[1]+","+c[0]+"H"+b[0]),"between"!==o&&(r.isSum||u<p-1)&&(n?k+="M"+b[1]+","+c[0]+"V"+c[1]:k+="M"+b[0]+","+c[1]+"H"+b[1]),b[2]!==g&&c[2]!==g&&(n?k+="M"+b[1]+","+c[1]+"V"+c[2]:k+="M"+b[1]+","+c[1]+"H"+b[2])),""===k&&(k="M0,0Z"),e.ensureSingle(d.select(this),"path").attr("d",k).call(f.setClipUrl,a.layerClipId,h)}})})}(b,c,j,k)}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(a,b,d){"use strict";var e=a("@plotly/d3"),f=a("../../components/drawing"),g=a("../../components/color"),h=a("../../constants/interactions").DESELECTDIM,c=a("../bar/style"),i=a("../bar/uniform_text").resizeText,j=c.styleTextPoints;b.exports={style:function(b,d,c){var a=c||e.select(b).selectAll("g.waterfalllayer").selectAll("g.trace");i(b,a,"waterfall"),a.style("opacity",function(a){return a[0].trace.opacity}),a.each(function(c){var a=e.select(this),d=c[0].trace;a.selectAll(".point > path").each(function(b){if(!b.isBlank){var a=d[b.dir].marker;e.select(this).call(g.fill,a.color).call(g.stroke,a.line.color).call(f.dashLine,a.line.dash,a.line.width).style("opacity",d.selectedpoints&&!b.selected?h:1)}}),j(a,d,b),a.selectAll(".lines").each(function(){var a=d.connector.line;f.lineGroupStyle(e.select(this).selectAll("path"),a.width,a.color,a.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(a,d,b){"use strict";var e=a("../plots/cartesian/axes"),f=a("../lib"),g=a("../plot_api/plot_schema"),h=a("./helpers").pointsAccessorFunction,i=a("../constants/numerical").BADNUM;b.moduleType="transform",b.name="aggregate";var c=b.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},j=c.aggregations;function k(k,c,d,a){if(a.enabled){for(var g=a.target,h=f.nestedProperty(c,g),i=h.get(),m=l(a,e.getDataConversions(k,c,g,i)),j=new Array(d.length),b=0;b<d.length;b++)j[b]=m(i,d[b]);h.set(j),"count"===a.func&&f.pushUnique(c._arrayAttrs,g)}}function l(b,a){var c=b.func,d=a.d2c,e=a.c2d;switch(c){case"count":return m;case"first":return n;case"last":return o;case"sum":return function(g,b){for(var c=0,a=0;a<b.length;a++){var f=d(g[b[a]]);f!==i&&(c+=f)}return e(c)};case"avg":return function(h,c){for(var f=0,a=0,b=0;b<c.length;b++){var g=d(h[c[b]]);g!==i&&(f+=g,a++)}return a?e(f/a):i};case"min":return function(g,c){for(var a=1/0,b=0;b<c.length;b++){var f=d(g[c[b]]);f!==i&&(a=Math.min(a,f))}return a===1/0?i:e(a)};case"max":return function(g,c){for(var a=-1/0,b=0;b<c.length;b++){var f=d(g[c[b]]);f!==i&&(a=Math.max(a,f))}return a=== -1/0?i:e(a)};case"range":return function(h,g){for(var a=1/0,b=-1/0,c=0;c<g.length;c++){var f=d(h[g[c]]);f!==i&&(a=Math.min(a,f),b=Math.max(b,f))}return b=== -1/0||a===1/0?i:e(b-a)};case"change":return function(b,a){var c=d(b[a[0]]),f=d(b[a[a.length-1]]);return c===i||f===i?i:e(f-c)};case"median":return function(j,c){for(var a=[],b=0;b<c.length;b++){var g=d(j[c[b]]);g!==i&&a.push(g)}if(!a.length)return i;a.sort(f.sorterAsc);var h=(a.length-1)/2;return e((a[Math.floor(h)]+a[Math.ceil(h)])/2)};case"mode":return function(k,f){for(var g={},b=0,h=i,c=0;c<f.length;c++){var a=d(k[f[c]]);if(a!==i){var j=g[a]=(g[a]||0)+1;j>b&&(b=j,h=a)}}return b?e(h):i};case"rms":return function(h,f){for(var g=0,a=0,b=0;b<f.length;b++){var c=d(h[f[b]]);c!==i&&(g+=c*c,a++)}return a?e(Math.sqrt(g/a)):i};case"stddev":return function(j,c){var a,g=0,k=0,e=1,f=i;for(a=0;a<c.length&&f===i;a++)f=d(j[c[a]]);if(f===i)return i;for(;a<c.length;a++){var l=d(j[c[a]]);if(l!==i){var h=l-f;g+=h,k+=h*h,e++}}var m="sample"===b.funcmode?e-1:e;return m?Math.sqrt((k-g*g/e)/m):0}}}function m(b,a){return a.length}function n(a,b){return a[b[0]]}function o(b,a){return b[a[a.length-1]]}b.supplyDefaults=function(q,r){var a,m,d={};function n(a,b){return f.coerce(q,d,c,a,b)}if(!n("enabled"))return d;var e=g.findArrayAttributes(r),b={};for(a=0;a<e.length;a++)b[e[a]]=1;var k=n("groups");if(!Array.isArray(k)){if(!b[k])return d.enabled=!1,d;b[k]=0}var o=q.aggregations||[],l=d.aggregations=new Array(o.length);function h(b,c){return f.coerce(o[a],m,j,b,c)}for(a=0;a<o.length;a++){m={_index:a};var i=h("target"),p=h("func");h("enabled")&&i&&(b[i]||"count"===p&& void 0===b[i])?("stddev"===p&&h("funcmode"),b[i]=0,l[a]=m):l[a]={enabled:!1,_index:a}}for(a=0;a<e.length;a++)b[e[a]]&&l.push({target:e[a],func:j.func.dflt,enabled:!0,_index:-1});return d},b.calcTransform=function(n,b,d){if(d.enabled){var a,e,o,p,j=d.groups,l=f.getTargetArray(b,{target:j});if(l){var g={},i={},c=[],q=h(b.transforms,d),m=l.length;for(b._length&&(m=Math.min(m,b._length)),a=0;a<m;a++)void 0===(o=g[e=l[a]])?(g[e]=c.length,p=[a],c.push(p),i[g[e]]=q(a)):(c[o].push(a),i[g[e]]=(i[g[e]]||[]).concat(q(a)));d._indexToPoints=i;var r=d.aggregations;for(a=0;a<r.length;a++)k(n,b,c,r[a]);"string"==typeof j&&k(n,b,c,{target:j,func:"first",enabled:!0}),b._length=c.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(a,g,b){"use strict";var h=a("../lib"),i=a("../registry"),j=a("../plots/cartesian/axes"),k=a("./helpers").pointsAccessorFunction,c=a("../constants/filter_ops"),d=c.COMPARISON_OPS,e=c.INTERVAL_OPS,f=c.SET_OPS;b.moduleType="transform",b.name="filter",b.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(d).concat(e).concat(f),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},b.supplyDefaults=function(d){var a={};function c(c,e){return h.coerce(d,a,b.attributes,c,e)}if(c("enabled")){var e=c("target");if(h.isArrayOrTypedArray(e)&&0===e.length)return a.enabled=!1,a;c("preservegaps"),c("operation"),c("value");var f=i.getComponentMethod("calendars","handleDefaults");f(d,a,"valuecalendar",null),f(d,a,"targetcalendar",null)}return a},b.calcTransform=function(t,a,b){if(b.enabled){var i,l,g=h.getTargetArray(a,b);if(g){var m=b.target,n=g.length;a._length&&(n=Math.min(n,a._length));var p=b.targetcalendar,w=a._arrayAttrs,q=b.preservegaps;if("string"==typeof m){var r=h.nestedProperty(a,m+"calendar").get();r&&(p=r)}var u=function(i,k,l){var c,j=i.operation,a=i.value,g=Array.isArray(a);function h(a){return -1!==a.indexOf(j)}var b=function(a){return k(a,0,i.valuecalendar)},m=function(a){return k(a,0,l)};switch(h(d)?c=b(g?a[0]:a):h(e)?c=g?[b(a[0]),b(a[1])]:[b(a),b(a)]:h(f)&&(c=g?a.map(b):[b(a)]),j){case"=":return function(a){return m(a)===c};case"!=":return function(a){return m(a)!==c};case"<":return function(a){return m(a)<c};case"<=":return function(a){return m(a)<=c};case">":return function(a){return m(a)>c};case">=":return function(a){return m(a)>=c};case"[]":return function(b){var a=m(b);return a>=c[0]&&a<=c[1]};case"()":return function(b){var a=m(b);return a>c[0]&&a<c[1]};case"[)":return function(b){var a=m(b);return a>=c[0]&&a<c[1]};case"(]":return function(b){var a=m(b);return a>c[0]&&a<=c[1]};case"][":return function(b){var a=m(b);return a<=c[0]||a>=c[1]};case")(":return function(b){var a=m(b);return a<c[0]||a>c[1]};case"](":return function(b){var a=m(b);return a<=c[0]||a>c[1]};case")[":return function(b){var a=m(b);return a<c[0]||a>=c[1]};case"{}":return function(a){return -1!==c.indexOf(m(a))};case"}{":return function(a){return -1===c.indexOf(m(a))}}}(b,j.getDataToCoordFunc(t,a,m,g),p),x={},s={},o=0;q?(i=function(a){x[a.astr]=h.extendDeep([],a.get()),a.set(new Array(n))},l=function(a,b){var c=x[a.astr][b];a.get()[b]=c}):(i=function(a){x[a.astr]=h.extendDeep([],a.get()),a.set([])},l=function(a,b){var c=x[a.astr][b];a.get().push(c)}),y(i);for(var v=k(a.transforms,b),c=0;c<n;c++)u(g[c])?(y(l,c),s[o++]=v(c)):q&&o++;b._indexToPoints=s,a._length=o}}function y(c,d){for(var b=0;b<w.length;b++)c(h.nestedProperty(a,w[b]),d)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(b,c,a){"use strict";var d=b("../lib"),e=b("../plot_api/plot_schema"),f=b("../plots/plots"),g=b("./helpers").pointsAccessorFunction;function h(i,y){var b,a,n,q,z,j,c,r,s,t,l=y.transform,u=y.transformIndex,h=i.transforms[u].groups,C=g(i.transforms,l);if(!d.isArrayOrTypedArray(h)||0===h.length)return[i];var k=d.filterUnique(h),m=new Array(k.length),A=h.length,o=e.findArrayAttributes(i),v=l.styles||[],B={};for(b=0;b<v.length;b++)B[v[b].target]=v[b].value;l.styles&&(t=d.keyedContainer(l,"styles","target","value.name"));var w={},x={};for(b=0;b<k.length;b++){w[j=k[b]]=b,x[j]=0,(c=m[b]=d.extendDeepNoArrays({},i))._group=j,c.transforms[u]._indexToPoints={};var p=null;for(t&&(p=t.get(j)),p||""===p?c.name=p:c.name=d.templateString(l.nameformat,{trace:i.name,group:j}),r=c.transforms,c.transforms=[],a=0;a<r.length;a++)c.transforms[a]=d.extendDeepNoArrays({},r[a]);for(a=0;a<o.length;a++)d.nestedProperty(c,o[a]).set([])}for(n=0;n<o.length;n++){for(a=0,q=o[n],s=[];a<k.length;a++)s[a]=d.nestedProperty(m[a],q).get();for(a=0,z=d.nestedProperty(i,q).get();a<A;a++)s[w[h[a]]].push(z[a])}for(a=0;a<A;a++)(c=m[w[h[a]]]).transforms[u]._indexToPoints[x[h[a]]]=C(a),x[h[a]]++;for(b=0;b<k.length;b++)j=k[b],c=m[b],f.clearExpandedTraceDefaultColors(c),c=d.extendDeepNoArrays(c,B[j]||{});return m}a.moduleType="transform",a.name="groupby",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},a.supplyDefaults=function(j,l,k){var b,e={};function f(b,c){return d.coerce(j,e,a.attributes,b,c)}if(!f("enabled"))return e;f("groups"),f("nameformat",k._dataLength>1?"%{group} (%{trace})":"%{group}");var c=j.styles,g=e.styles=[];if(c)for(b=0;b<c.length;b++){var i=g[b]={};d.coerce(c[b],g[b],a.attributes.styles,"target");var h=d.coerce(c[b],g[b],a.attributes.styles,"value");d.isPlainObject(h)?i.value=d.extendDeep({},h):h&&delete i.value}return e},a.transform=function(d,f){var c,a,b,e=[];for(a=0;a<d.length;a++)for(b=0,c=h(d[a],f);b<c.length;b++)e.push(c[b]);return e}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(b,c,a){"use strict";a.pointsAccessorFunction=function(c,e){for(var a,d,b=0;b<c.length&&(a=c[b])!==e;b++)a._indexToPoints&& !1!==a.enabled&&(d=a._indexToPoints);return d?function(a){return d[a]}:function(a){return[a]}}},{}],1131:[function(b,c,a){"use strict";var d=b("../lib"),e=b("../plots/cartesian/axes"),f=b("./helpers").pointsAccessorFunction,g=b("../constants/numerical").BADNUM;a.moduleType="transform",a.name="sort",a.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},a.supplyDefaults=function(e){var c={};function b(b,f){return d.coerce(e,c,a.attributes,b,f)}return b("enabled")&&(b("target"),b("order")),c},a.calcTransform=function(p,b,h){if(h.enabled){var i,a,j=d.getTargetArray(b,h);if(j){var q=h.target,c=j.length;b._length&&(c=Math.min(c,b._length));var k=b._arrayAttrs,r=e.getDataToCoordFunc(p,b,q,j),l=function(e,f,h,b){var a,c=new Array(b),d=new Array(b);for(a=0;a<b;a++)c[a]={v:f[a],i:a};for(c.sort(function(a,b){switch(a.order){case"ascending":return function(d,e){var a=b(d.v),c=b(e.v);return a===g?1:c===g?-1:a-c};case"descending":return function(d,e){var a=b(d.v),c=b(e.v);return a===g?1:c===g?-1:c-a}}}(e,h)),a=0;a<b;a++)d[a]=c[a].i;return d}(h,j,r,c),s=f(b.transforms,h),m={};for(i=0;i<k.length;i++){var n=d.nestedProperty(b,k[i]),t=n.get(),o=new Array(c);for(a=0;a<c;a++)o[a]=t[l[a]];n.set(o)}for(a=0;a<c;a++)m[a]=s(l[a]);h._indexToPoints=m,b._length=c}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(b,c,a){"use strict";a.version="2.16.3"},{}],1133:[function(b,d,e){(function(c){(function(){!function(b){"object"==typeof e&& void 0!==d?d.exports=b():"function"==typeof a&&a.amd?a([],b):("undefined"!=typeof window?window:void 0!==c?c:"undefined"!=typeof self?self:this).stackgl=b()}(function(){var a;return(function(){function a(f,g,d){function e(c,l){if(!g[c]){if(!f[c]){var j="function"==typeof b&&b;if(!l&&j)return j(c,!0);if(h)return h(c,!0);var k=new Error("Cannot find module '"+c+"'");throw k.code="MODULE_NOT_FOUND",k}var i=g[c]={exports:{}};f[c][0].call(i.exports,function(a){return e(f[c][1][a]||a)},i,i.exports,a,f,g,d)}return g[c].exports}for(var h="function"==typeof b&&b,c=0;c<d.length;c++)e(d[c]);return e}return a})()({1:[function(g,h,b){"use strict";b.byteLength=function(c){var a=j(c),d=a[0],b=a[1];return(d+b)*3/4-b},b.toByteArray=function(b){var d,a,k,l=j(b),h=l[0],g=l[1],e=new i((h+(k=g))*3/4-k),f=0,m=g>0?h-4:h;for(a=0;a<m;a+=4)d=c[b.charCodeAt(a)]<<18|c[b.charCodeAt(a+1)]<<12|c[b.charCodeAt(a+2)]<<6|c[b.charCodeAt(a+3)],e[f++]=d>>16&255,e[f++]=d>>8&255,e[f++]=255&d;return 2===g&&(d=c[b.charCodeAt(a)]<<2|c[b.charCodeAt(a+1)]>>4,e[f++]=255&d),1===g&&(d=c[b.charCodeAt(a)]<<10|c[b.charCodeAt(a+1)]<<4|c[b.charCodeAt(a+2)]>>2,e[f++]=d>>8&255,e[f++]=255&d),e},b.fromByteArray=function(b){for(var a,c=b.length,g=c%3,f=[],d=0,h=c-g;d<h;d+=16383)f.push(l(b,d,d+16383>h?h:d+16383));return 1===g?(a=b[c-1],f.push(e[a>>2]+e[a<<4&63]+"==")):2===g&&(a=(b[c-2]<<8)+b[c-1],f.push(e[a>>10]+e[a>>4&63]+e[a<<2&63]+"=")),f.join("")};for(var e=[],c=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,f=d.length;a<f;++a)e[a]=d[a],c[d.charCodeAt(a)]=a;function j(c){var b=c.length;if(b%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=c.indexOf("=");return -1===a&&(a=b),[a,a===b?0:4-a%4]}function k(a){return e[a>>18&63]+e[a>>12&63]+e[a>>6&63]+e[63&a]}function l(b,e,f){for(var c,d=[],a=e;a<f;a+=3)c=(b[a]<<16&16711680)+(b[a+1]<<8&65280)+(255&b[a+2]),d.push(k(c));return d.join("")}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],2:[function(a,b,c){},{}],3:[function(a,b,c){(function(b){(function(){"use strict";var e=a("base64-js"),f=a("ieee754");function g(a){if(a>2147483647)throw new RangeError('The value "'+a+'" is invalid for option "size"');var c=new Uint8Array(a);return c.__proto__=b.prototype,c}function b(a,b,c){if("number"==typeof a){if("string"==typeof b)throw new TypeError('The "string" argument must be of type string. Received type number');return j(a)}return h(a,b,c)}function h(a,c,d){if("string"==typeof a)return k(a,c);if(ArrayBuffer.isView(a))return l(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(S(a,ArrayBuffer)||a&&S(a.buffer,ArrayBuffer))return m(a,c,d);if("number"==typeof a)throw new TypeError('The "value" argument must not be of type number. Received type number');var e=a.valueOf&&a.valueOf();if(null!=e&&e!==a)return b.from(e,c,d);var f=n(a);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return b.from(a[Symbol.toPrimitive]("string"),c,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function i(a){if("number"!=typeof a)throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function j(a){return i(a),g(a<0?0:0|o(a))}function k(e,a){if(("string"!=typeof a||""===a)&&(a="utf8"),!b.isEncoding(a))throw new TypeError("Unknown encoding: "+a);var f=0|d(e,a),c=g(f),h=c.write(e,a);return h!==f&&(c=c.slice(0,h)),c}function l(b){for(var c=b.length<0?0:0|o(b.length),d=g(c),a=0;a<c;a+=1)d[a]=255&b[a];return d}function m(c,a,d){var e;if(a<0||c.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(c.byteLength<a+(d||0))throw new RangeError('"length" is outside of buffer bounds');return(e=void 0===a&& void 0===d?new Uint8Array(c):void 0===d?new Uint8Array(c,a):new Uint8Array(c,a,d)).__proto__=b.prototype,e}function n(a){if(b.isBuffer(a)){var d=0|o(a.length),c=g(d);return 0===c.length||a.copy(c,0,0,d),c}return void 0!==a.length?"number"!=typeof a.length||T(a.length)?g(0):l(a):"Buffer"===a.type&&Array.isArray(a.data)?l(a.data):void 0}function o(a){if(a>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|a}function d(a,d){if(b.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||S(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var c=a.length,e=arguments.length>2&& !0===arguments[2];if(!e&&0===c)return 0;for(var f=!1;;)switch(d){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return N(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return Q(a).length;default:if(f)return e?-1:N(a).length;d=(""+d).toLowerCase(),f=!0}}function p(c,a,b){var d=!1;if((void 0===a||a<0)&&(a=0),a>this.length)return"";if((void 0===b||b>this.length)&&(b=this.length),b<=0)return"";if((b>>>=0)<=(a>>>=0))return"";for(c||(c="utf8");;)switch(c){case"hex":return E(this,a,b);case"utf8":case"utf-8":return A(this,a,b);case"ascii":return C(this,a,b);case"latin1":case"binary":return D(this,a,b);case"base64":return z(this,a,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,a,b);default:if(d)throw new TypeError("Unknown encoding: "+c);c=(c+"").toLowerCase(),d=!0}}function q(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function r(d,c,a,f,e){if(0===d.length)return -1;if("string"==typeof a?(f=a,a=0):a>2147483647?a=2147483647:a< -2147483648&&(a=-2147483648),T(a=+a)&&(a=e?0:d.length-1),a<0&&(a=d.length+a),a>=d.length){if(e)return -1;a=d.length-1}else if(a<0){if(!e)return -1;a=0}if("string"==typeof c&&(c=b.from(c,f)),b.isBuffer(c))return 0===c.length?-1:s(d,c,a,f,e);if("number"==typeof c)return(c&=255,"function"==typeof Uint8Array.prototype.indexOf)?e?Uint8Array.prototype.indexOf.call(d,c,a):Uint8Array.prototype.lastIndexOf.call(d,c,a):s(d,[c],a,f,e);throw new TypeError("val must be string, number or Buffer")}function s(f,g,d,c,m){var a,k=1,h=f.length,e=g.length;if(void 0!==c&&("ucs2"===(c=String(c).toLowerCase())||"ucs-2"===c||"utf16le"===c||"utf-16le"===c)){if(f.length<2||g.length<2)return -1;k=2,h/=2,e/=2,d/=2}function i(a,b){return 1===k?a[b]:a.readUInt16BE(b*k)}if(m){var b=-1;for(a=d;a<h;a++)if(i(f,a)===i(g,-1===b?0:a-b)){if(-1===b&&(b=a),a-b+1===e)return b*k}else -1!==b&&(a-=a-b),b=-1}else for(d+e>h&&(d=h-e),a=d;a>=0;a--){for(var l=!0,j=0;j<e;j++)if(i(f,a+j)!==i(g,j)){l=!1;break}if(l)return a}return -1}function t(e,f,c,a){c=Number(c)||0;var d=e.length-c;a?(a=Number(a))>d&&(a=d):a=d;var g=f.length;a>g/2&&(a=g/2);for(var b=0;b<a;++b){var h=parseInt(f.substr(2*b,2),16);if(T(h))return b;e[c+b]=h}return b}function u(a,c,b,d){return R(N(c,a.length-b),a,b,d)}function v(a,b,c,d){return R(O(b),a,c,d)}function w(a,b,c,d){return v(a,b,c,d)}function x(a,b,c,d){return R(Q(b),a,c,d)}function y(a,c,b,d){return R(P(c,a.length-b),a,b,d)}function z(a,b,c){return 0===b&&c===a.length?e.fromByteArray(a):e.fromByteArray(a.slice(b,c))}function A(d,l,h){h=Math.min(d.length,h);for(var j=[],b=l;b<h;){var e,g,k,c,f=d[b],a=null,i=f>239?4:f>223?3:f>191?2:1;if(b+i<=h)switch(i){case 1:f<128&&(a=f);break;case 2:(192&(e=d[b+1]))==128&&(c=(31&f)<<6|63&e)>127&&(a=c);break;case 3:e=d[b+1],g=d[b+2],(192&e)==128&&(192&g)==128&&(c=(15&f)<<12|(63&e)<<6|63&g)>2047&&(c<55296||c>57343)&&(a=c);break;case 4:e=d[b+1],g=d[b+2],k=d[b+3],(192&e)==128&&(192&g)==128&&(192&k)==128&&(c=(15&f)<<18|(63&e)<<12|(63&g)<<6|63&k)>65535&&c<1114112&&(a=c)}null===a?(a=65533,i=1):a>65535&&(a-=65536,j.push(a>>>10&1023|55296),a=56320|1023&a),j.push(a),b+=i}return B(j)}function B(a){var c=a.length;if(c<=4096)return String.fromCharCode.apply(String,a);for(var d="",b=0;b<c;)d+=String.fromCharCode.apply(String,a.slice(b,b+=4096));return d}function C(c,e,a){var d="";a=Math.min(c.length,a);for(var b=e;b<a;++b)d+=String.fromCharCode(127&c[b]);return d}function D(c,e,a){var d="";a=Math.min(c.length,a);for(var b=e;b<a;++b)d+=String.fromCharCode(c[b]);return d}function E(d,b,a){var e=d.length;(!b||b<0)&&(b=0),(!a||a<0||a>e)&&(a=e);for(var f="",c=b;c<a;++c)f+=M(d[c]);return f}function F(d,e,f){for(var b=d.slice(e,f),c="",a=0;a<b.length;a+=2)c+=String.fromCharCode(b[a]+256*b[a+1]);return c}function G(a,b,c){if(a%1!=0||a<0)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function H(a,c,d,e,f,g){if(!b.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>f||c<g)throw new RangeError('"value" argument is out of bounds');if(d+e>a.length)throw new RangeError("Index out of range")}function I(b,d,a,c,e,f){if(a+c>b.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function J(c,a,b,d,e){return a=+a,b>>>=0,e||I(c,a,b,4,0x7fffffffffffffff,0x8000000000000000),f.write(c,a,b,d,23,4),b+4}function K(c,a,b,d,e){return a=+a,b>>>=0,e||I(c,a,b,8,0x7fffffffffffffff,0x8000000000000000),f.write(c,a,b,d,52,8),b+8}c.Buffer=b,c.SlowBuffer=function(a){return+a!=a&&(a=0),b.alloc(+a)},c.INSPECT_MAX_BYTES=50,c.kMaxLength=2147483647,b.TYPED_ARRAY_SUPPORT=function(){try{var a=new Uint8Array(1);return a.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===a.foo()}catch(b){return!1}}(),b.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(b.prototype,"parent",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.buffer}}),Object.defineProperty(b.prototype,"offset",{enumerable:!0,get:function(){if(b.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&b[Symbol.species]===b&&Object.defineProperty(b,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),b.poolSize=8192,b.from=function(a,b,c){return h(a,b,c)},b.prototype.__proto__=Uint8Array.prototype,b.__proto__=Uint8Array,b.alloc=function(d,e,f){var a,b,c;return a=d,b=e,c=f,(i(a),a<=0)?g(a):void 0!==b?"string"==typeof c?g(a).fill(b,c):g(a).fill(b):g(a)},b.allocUnsafe=function(a){return j(a)},b.allocUnsafeSlow=function(a){return j(a)},b.isBuffer=function(a){return null!=a&& !0===a._isBuffer&&a!==b.prototype},b.compare=function(a,c){if(S(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),S(c,Uint8Array)&&(c=b.from(c,c.offset,c.byteLength)),!b.isBuffer(a)||!b.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===c)return 0;for(var e=a.length,f=c.length,d=0,g=Math.min(e,f);d<g;++d)if(a[d]!==c[d]){e=a[d],f=c[d];break}return e<f?-1:f<e?1:0},b.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.concat=function(a,d){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return b.alloc(0);if(void 0===d)for(e=0,d=0;e<a.length;++e)d+=a[e].length;var e,f=b.allocUnsafe(d),g=0;for(e=0;e<a.length;++e){var c=a[e];if(S(c,Uint8Array)&&(c=b.from(c)),!b.isBuffer(c))throw new TypeError('"list" argument must be an Array of Buffers');c.copy(f,g),g+=c.length}return f},b.byteLength=d,b.prototype._isBuffer=!0,b.prototype.swap16=function(){var b=this.length;if(b%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<b;a+=2)q(this,a,a+1);return this},b.prototype.swap32=function(){var b=this.length;if(b%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<b;a+=4)q(this,a,a+3),q(this,a+1,a+2);return this},b.prototype.swap64=function(){var b=this.length;if(b%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<b;a+=8)q(this,a,a+7),q(this,a+1,a+6),q(this,a+2,a+5),q(this,a+3,a+4);return this},b.prototype.toString=function(){var a=this.length;return 0===a?"":0===arguments.length?A(this,0,a):p.apply(this,arguments)},b.prototype.toLocaleString=b.prototype.toString,b.prototype.equals=function(a){if(!b.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a||0===b.compare(this,a)},b.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return a=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(a+=" ... "),"<Buffer "+a+">"},b.prototype.compare=function(a,c,d,e,f){if(S(a,Uint8Array)&&(a=b.from(a,a.offset,a.byteLength)),!b.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===c&&(c=0),void 0===d&&(d=a?a.length:0),void 0===e&&(e=0),void 0===f&&(f=this.length),c<0||d>a.length||e<0||f>this.length)throw new RangeError("out of range index");if(e>=f&&c>=d)return 0;if(e>=f)return -1;if(c>=d)return 1;if(c>>>=0,d>>>=0,e>>>=0,f>>>=0,this===a)return 0;for(var h=f-e,i=d-c,l=Math.min(h,i),j=this.slice(e,f),k=a.slice(c,d),g=0;g<l;++g)if(j[g]!==k[g]){h=j[g],i=k[g];break}return h<i?-1:i<h?1:0},b.prototype.includes=function(a,b,c){return -1!==this.indexOf(a,b,c)},b.prototype.indexOf=function(a,b,c){return r(this,a,b,c,!0)},b.prototype.lastIndexOf=function(a,b,c){return r(this,a,b,c,!1)},b.prototype.write=function(d,b,a,c){if(void 0===b)c="utf8",a=this.length,b=0;else if(void 0===a&&"string"==typeof b)c=b,a=this.length,b=0;else if(isFinite(b))b>>>=0,isFinite(a)?(a>>>=0,void 0===c&&(c="utf8")):(c=a,a=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var e=this.length-b;if((void 0===a||a>e)&&(a=e),d.length>0&&(a<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");c||(c="utf8");for(var f=!1;;)switch(c){case"hex":return t(this,d,b,a);case"utf8":case"utf-8":return u(this,d,b,a);case"ascii":return v(this,d,b,a);case"latin1":case"binary":return w(this,d,b,a);case"base64":return x(this,d,b,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,d,b,a);default:if(f)throw new TypeError("Unknown encoding: "+c);c=(""+c).toLowerCase(),f=!0}},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},b.prototype.slice=function(c,a){var d=this.length;c=~~c,a=void 0===a?d:~~a,c<0?(c+=d)<0&&(c=0):c>d&&(c=d),a<0?(a+=d)<0&&(a=0):a>d&&(a=d),a<c&&(a=c);var e=this.subarray(c,a);return e.__proto__=b.prototype,e},b.prototype.readUIntLE=function(a,b,f){a>>>=0,b>>>=0,f||G(a,b,this.length);for(var c=this[a],d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;return c},b.prototype.readUIntBE=function(b,a,e){b>>>=0,a>>>=0,e||G(b,a,this.length);for(var c=this[b+ --a],d=1;a>0&&(d*=256);)c+=this[b+ --a]*d;return c},b.prototype.readUInt8=function(a,b){return a>>>=0,b||G(a,1,this.length),this[a]},b.prototype.readUInt16LE=function(a,b){return a>>>=0,b||G(a,2,this.length),this[a]|this[a+1]<<8},b.prototype.readUInt16BE=function(a,b){return a>>>=0,b||G(a,2,this.length),this[a]<<8|this[a+1]},b.prototype.readUInt32LE=function(a,b){return a>>>=0,b||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},b.prototype.readUInt32BE=function(a,b){return a>>>=0,b||G(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},b.prototype.readIntLE=function(a,b,f){a>>>=0,b>>>=0,f||G(a,b,this.length);for(var c=this[a],d=1,e=0;++e<b&&(d*=256);)c+=this[a+e]*d;return c>=(d*=128)&&(c-=Math.pow(2,8*b)),c},b.prototype.readIntBE=function(a,b,f){a>>>=0,b>>>=0,f||G(a,b,this.length);for(var d=b,e=1,c=this[a+ --d];d>0&&(e*=256);)c+=this[a+ --d]*e;return c>=(e*=128)&&(c-=Math.pow(2,8*b)),c},b.prototype.readInt8=function(a,b){return(a>>>=0,b||G(a,1,this.length),128&this[a])?-((255-this[a]+1)*1):this[a]},b.prototype.readInt16LE=function(a,c){a>>>=0,c||G(a,2,this.length);var b=this[a]|this[a+1]<<8;return 32768&b?4294901760|b:b},b.prototype.readInt16BE=function(a,c){a>>>=0,c||G(a,2,this.length);var b=this[a+1]|this[a]<<8;return 32768&b?4294901760|b:b},b.prototype.readInt32LE=function(a,b){return a>>>=0,b||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},b.prototype.readInt32BE=function(a,b){return a>>>=0,b||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},b.prototype.readFloatLE=function(a,b){return a>>>=0,b||G(a,4,this.length),f.read(this,a,!0,23,4)},b.prototype.readFloatBE=function(a,b){return a>>>=0,b||G(a,4,this.length),f.read(this,a,!1,23,4)},b.prototype.readDoubleLE=function(a,b){return a>>>=0,b||G(a,8,this.length),f.read(this,a,!0,52,8)},b.prototype.readDoubleBE=function(a,b){return a>>>=0,b||G(a,8,this.length),f.read(this,a,!1,52,8)},b.prototype.writeUIntLE=function(a,b,c,f){if(a=+a,b>>>=0,c>>>=0,!f){var g=Math.pow(2,8*c)-1;H(this,a,b,c,g,0)}var d=1,e=0;for(this[b]=255&a;++e<c&&(d*=256);)this[b+e]=a/d&255;return b+c},b.prototype.writeUIntBE=function(a,b,c,f){if(a=+a,b>>>=0,c>>>=0,!f){var g=Math.pow(2,8*c)-1;H(this,a,b,c,g,0)}var d=c-1,e=1;for(this[b+d]=255&a;--d>=0&&(e*=256);)this[b+d]=a/e&255;return b+c},b.prototype.writeUInt8=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,1,255,0),this[b]=255&a,b+1},b.prototype.writeUInt16LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,65535,0),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeUInt16BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,65535,0),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeUInt32LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,4294967295,0),this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=255&a,b+4},b.prototype.writeUInt32BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,4294967295,0),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeIntLE=function(a,b,c,h){if(a=+a,b>>>=0,!h){var f=Math.pow(2,8*c-1);H(this,a,b,c,f-1,-f)}var d=0,g=1,e=0;for(this[b]=255&a;++d<c&&(g*=256);)a<0&&0===e&&0!==this[b+d-1]&&(e=1),this[b+d]=(a/g>>0)-e&255;return b+c},b.prototype.writeIntBE=function(a,b,c,h){if(a=+a,b>>>=0,!h){var f=Math.pow(2,8*c-1);H(this,a,b,c,f-1,-f)}var d=c-1,g=1,e=0;for(this[b+d]=255&a;--d>=0&&(g*=256);)a<0&&0===e&&0!==this[b+d+1]&&(e=1),this[b+d]=(a/g>>0)-e&255;return b+c},b.prototype.writeInt8=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,1,127,-128),a<0&&(a=255+a+1),this[b]=255&a,b+1},b.prototype.writeInt16LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,32767,-32768),this[b]=255&a,this[b+1]=a>>>8,b+2},b.prototype.writeInt16BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,2,32767,-32768),this[b]=a>>>8,this[b+1]=255&a,b+2},b.prototype.writeInt32LE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,2147483647,-2147483648),this[b]=255&a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24,b+4},b.prototype.writeInt32BE=function(a,b,c){return a=+a,b>>>=0,c||H(this,a,b,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=255&a,b+4},b.prototype.writeFloatLE=function(a,b,c){return J(this,a,b,!0,c)},b.prototype.writeFloatBE=function(a,b,c){return J(this,a,b,!1,c)},b.prototype.writeDoubleLE=function(a,b,c){return K(this,a,b,!0,c)},b.prototype.writeDoubleBE=function(a,b,c){return K(this,a,b,!1,c)},b.prototype.copy=function(e,d,c,a){if(!b.isBuffer(e))throw new TypeError("argument should be a Buffer");if(c||(c=0),a||0===a||(a=this.length),d>=e.length&&(d=e.length),d||(d=0),a>0&&a<c&&(a=c),a===c)return 0;if(0===e.length||0===this.length)return 0;if(d<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-d<a-c&&(a=e.length-d+c);var g=a-c;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(d,c,a);else if(this===e&&c<d&&d<a)for(var f=g-1;f>=0;--f)e[f+d]=this[f+c];else Uint8Array.prototype.set.call(e,this.subarray(c,a),d);return g},b.prototype.fill=function(a,d,c,e){if("string"==typeof a){if("string"==typeof d?(e=d,d=0,c=this.length):"string"==typeof c&&(e=c,c=this.length),void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!b.isEncoding(e))throw new TypeError("Unknown encoding: "+e);if(1===a.length){var f,g=a.charCodeAt(0);("utf8"===e&&g<128||"latin1"===e)&&(a=g)}}else"number"==typeof a&&(a&=255);if(d<0||this.length<d||this.length<c)throw new RangeError("Out of range index");if(c<=d)return this;if(d>>>=0,c=void 0===c?this.length:c>>>0,a||(a=0),"number"==typeof a)for(f=d;f<c;++f)this[f]=a;else{var h=b.isBuffer(a)?a:b.from(a,e),i=h.length;if(0===i)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(f=0;f<c-d;++f)this[f+d]=h[f%i]}return this};var L=/[^+/0-9A-Za-z-_]/g;function M(a){return a<16?"0"+a.toString(16):a.toString(16)}function N(f,b){b=b||1/0;for(var a,g=f.length,d=null,c=[],e=0;e<g;++e){if((a=f.charCodeAt(e))>55295&&a<57344){if(!d){if(a>56319){(b-=3)> -1&&c.push(239,191,189);continue}if(e+1===g){(b-=3)> -1&&c.push(239,191,189);continue}d=a;continue}if(a<56320){(b-=3)> -1&&c.push(239,191,189),d=a;continue}a=(d-55296<<10|a-56320)+65536}else d&&(b-=3)> -1&&c.push(239,191,189);if(d=null,a<128){if((b-=1)<0)break;c.push(a)}else if(a<2048){if((b-=2)<0)break;c.push(a>>6|192,63&a|128)}else if(a<65536){if((b-=3)<0)break;c.push(a>>12|224,a>>6&63|128,63&a|128)}else if(a<1114112){if((b-=4)<0)break;c.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}else throw new Error("Invalid code point")}return c}function O(b){for(var c=[],a=0;a<b.length;++a)c.push(255&b.charCodeAt(a));return c}function P(c,g){for(var d,e,f,a=[],b=0;b<c.length&&!((g-=2)<0);++b)e=(d=c.charCodeAt(b))>>8,f=d%256,a.push(f),a.push(e);return a}function Q(a){return e.toByteArray(function(a){if((a=(a=a.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}(a))}function R(b,c,d,e){for(var a=0;a<e&& !(a+d>=c.length)&&!(a>=b.length);++a)c[a+d]=b[a];return a}function S(a,b){return a instanceof b||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===b.name}function T(a){return a!=a}}).call(this)}).call(this,a("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(b,c,a){a.read=function(g,h,j,e,k){var a,c,l=8*k-e-1,m=(1<<l)-1,n=m>>1,b=-7,d=j?k-1:0,i=j?-1:1,f=g[h+d];for(d+=i,a=f&(1<< -b)-1,f>>=-b,b+=l;b>0;a=256*a+g[h+d],d+=i,b-=8);for(c=a&(1<< -b)-1,a>>=-b,b+=e;b>0;c=256*c+g[h+d],d+=i,b-=8);if(0===a)a=1-n;else{if(a===m)return c?NaN:(f?-1:1)*(1/0);c+=Math.pow(2,e),a-=n}return(f?-1:1)*c*Math.pow(2,a-e)},a.write=function(j,b,k,m,c,n){var a,d,e,h=8*n-c-1,i=(1<<h)-1,f=i>>1,o=23===c?5960464477539062e-23:0,g=m?0:n-1,l=m?1:-1,p=b<0||0===b&&1/b<0?1:0;for(isNaN(b=Math.abs(b))||b===1/0?(d=isNaN(b)?1:0,a=i):(a=Math.floor(Math.log(b)/Math.LN2),b*(e=Math.pow(2,-a))<1&&(a--,e*=2),a+f>=1?b+=o/e:b+=o*Math.pow(2,1-f),b*e>=2&&(a++,e/=2),a+f>=i?(d=0,a=i):a+f>=1?(d=(b*e-1)*Math.pow(2,c),a+=f):(d=b*Math.pow(2,f-1)*Math.pow(2,c),a=0));c>=8;j[k+g]=255&d,g+=l,d/=256,c-=8);for(a=a<<c|d,h+=c;h>0;j[k+g]=255&a,g+=l,a/=256,h-=8);j[k+g-l]|=128*p}},{}],5:[function(e,c,f){var g,h,i,a=c.exports={};function j(){throw new Error("setTimeout has not been defined")}function k(){throw new Error("clearTimeout has not been defined")}function l(a){if(g===setTimeout)return setTimeout(a,0);if((g===j||!g)&&setTimeout)return g=setTimeout,setTimeout(a,0);try{return g(a,0)}catch(b){try{return g.call(null,a,0)}catch(c){return g.call(this,a,0)}}}!function(){try{g="function"==typeof setTimeout?setTimeout:j}catch(a){g=j}try{h="function"==typeof clearTimeout?clearTimeout:k}catch(b){h=k}}();var m=[],n=!1,o=-1;function p(){n&&i&&(n=!1,i.length?m=i.concat(m):o=-1,m.length&&q())}function q(){if(!n){var b=l(p);n=!0;for(var a=m.length;a;){for(i=m,m=[];++o<a;)i&&i[o].run();o=-1,a=m.length}i=null,n=!1,function(a){if(h===clearTimeout)return clearTimeout(a);if((h===k||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(a);try{h(a)}catch(b){try{return h.call(null,a)}catch(c){return h.call(this,a)}}}(b)}}function d(a,b){this.fun=a,this.array=b}function b(){}a.nextTick=function(c){var b=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];m.push(new d(c,b)),1!==m.length||n||l(q)},d.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=b,a.addListener=b,a.once=b,a.off=b,a.removeListener=b,a.removeAllListeners=b,a.emit=b,a.prependListener=b,a.prependOnceListener=b,a.listeners=function(a){return[]},a.binding=function(a){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(a){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],6:[function(a,b,c){b.exports={alpha_shape:a("alpha-shape"),convex_hull:a("convex-hull"),delaunay_triangulate:a("delaunay-triangulate"),gl_cone3d:a("gl-cone3d"),gl_error3d:a("gl-error3d"),gl_heatmap2d:a("gl-heatmap2d"),gl_line3d:a("gl-line3d"),gl_mesh3d:a("gl-mesh3d"),gl_plot2d:a("gl-plot2d"),gl_plot3d:a("gl-plot3d"),gl_pointcloud2d:a("gl-pointcloud2d"),gl_scatter3d:a("gl-scatter3d"),gl_select_box:a("gl-select-box"),gl_spikes2d:a("gl-spikes2d"),gl_streamtube3d:a("gl-streamtube3d"),gl_surface3d:a("gl-surface3d"),ndarray:a("ndarray"),ndarray_linear_interpolate:a("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(b,c,e){"use strict";c.exports=function(a){var c=(a=a||{}).eye||[0,0,1],e=a.center||[0,0,0],i=a.up||[0,1,0],b=a.distanceLimits||[0,1/0],m=a.mode||"turntable",j=f(),k=g(),l=h();return j.setDistanceLimits(b[0],b[1]),j.lookAt(0,c,e,i),k.setDistanceLimits(b[0],b[1]),k.lookAt(0,c,e,i),l.setDistanceLimits(b[0],b[1]),l.lookAt(0,c,e,i),new d({turntable:j,orbit:k,matrix:l},m)};var f=b("turntable-camera-controller"),g=b("orbit-camera-controller"),h=b("matrix-camera-controller");function d(a,b){this._controllerNames=Object.keys(a),this._controllerList=this._controllerNames.map(function(b){return a[b]}),this._mode=b,this._active=a[b],this._active||(this._mode="turntable",this._active=a.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var a=d.prototype;a.flush=function(c){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].flush(c)},a.idle=function(c){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].idle(c)},a.lookAt=function(c,d,e,f){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].lookAt(c,d,e,f)},a.rotate=function(c,d,e,f){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].rotate(c,d,e,f)},a.pan=function(c,d,e,f){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].pan(c,d,e,f)},a.translate=function(c,d,e,f){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].translate(c,d,e,f)},a.setMatrix=function(c,d){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].setMatrix(c,d)},a.setDistanceLimits=function(c,d){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].setDistanceLimits(c,d)},a.setDistance=function(c,d){for(var b=this._controllerList,a=0;a<b.length;++a)b[a].setDistance(c,d)},a.recalcMatrix=function(a){this._active.recalcMatrix(a)},a.getDistance=function(a){return this._active.getDistance(a)},a.getDistanceLimits=function(a){return this._active.getDistanceLimits(a)},a.lastT=function(){return this._active.lastT()},a.setMode=function(a){if(a!==this._mode){var d=this._controllerNames.indexOf(a);if(!(d<0)){var b=this._active,c=this._controllerList[d],e=Math.max(b.lastT(),c.lastT());b.recalcMatrix(e),c.setMatrix(e,b.computedMatrix),this._active=c,this._mode=a,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},a.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(a,b,d){"use strict";var c="undefined"==typeof WeakMap?a("weak-map"):WeakMap,e=a("gl-buffer"),f=a("gl-vao"),g=new c;b.exports=function(a){var b=g.get(a),c=b&&(b._triangleBuffer.handle||b._triangleBuffer.buffer);if(!c||!a.isBuffer(c)){var d=e(a,new Float32Array([-1,-1,-1,4,4,-1]));(b=f(a,[{buffer:d,type:a.FLOAT,size:2}]))._triangleBuffer=d,g.set(a,b)}b.bind(),a.drawArrays(a.TRIANGLES,0,3),b.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(a,b,c){var d=a("pad-left");b.exports=function(e,a,b){a="number"==typeof a?a:1,b=b||": ";var c=e.split(/\r?\n/),f=String(c.length+a-1).length;return c.map(function(e,g){var c=g+a,h=String(c).length,i=d(c,f-h);return i+b+e}).join("\n")}},{"pad-left":264}],10:[function(a,b,c){"use strict";b.exports=function(a){var d=a.length;if(0===d)return[];if(1===d)return[0];for(var g=a[0].length,f=[a[0]],b=[0],c=1;c<d;++c){if(f.push(a[c]),!e(f,g)){f.pop();continue}if(b.push(c),b.length===g+1)return b}return b};var d=a("robust-orientation");function e(b,c){for(var g=new Array(c+1),a=0;a<b.length;++a)g[a]=b[a];for(var a=0;a<=b.length;++a){for(var e=b.length;e<=c;++e){for(var h=new Array(c),f=0;f<c;++f)h[f]=Math.pow(e+1-a,f);g[e]=h}if(d.apply(void 0,g))return!0}return!1}},{"robust-orientation":284}],11:[function(a,b,c){"use strict";b.exports=function(b,a){return d(a).filter(function(d){for(var f=new Array(d.length),c=0;c<d.length;++c)f[c]=a[d[c]];return e(f)*b<1})};var d=a("delaunay-triangulate"),e=a("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(a,b,c){b.exports=function(a,b){return e(d(a,b))};var d=a("alpha-complex"),e=a("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(b,a,c){a.exports=function(a){return atob(a)}},{}],14:[function(a,b,c){"use strict";b.exports=function(m,i){for(var b=i.length,c=new Array(b+1),a=0;a<b;++a){for(var j=new Array(b+1),f=0;f<=b;++f)j[f]=m[f][a];c[a]=j}c[b]=new Array(b+1);for(var a=0;a<=b;++a)c[b][a]=1;for(var g=new Array(b+1),a=0;a<b;++a)g[a]=i[a];g[b]=1;var k=d(c,g),h=e(k[b+1]);0===h&&(h=1);for(var l=new Array(b+1),a=0;a<=b;++a)l[a]=e(k[a])/h;return l};var d=a("robust-linear-solve");function e(b){for(var c=0,a=0;a<b.length;++a)c+=b[a];return c}},{"robust-linear-solve":283}],15:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[1]).add(b[0].mul(a[1])),a[1].mul(b[1]))}},{"./lib/rationalize":25}],16:[function(b,a,c){"use strict";a.exports=function(a,b){return a[0].mul(b[1]).cmp(b[0].mul(a[1]))}},{}],17:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[1]),a[1].mul(b[0]))}},{"./lib/rationalize":25}],18:[function(a,b,d){"use strict";var e=a("./is-rat"),f=a("./lib/is-bn"),g=a("./lib/num-to-bn"),h=a("./lib/str-to-bn"),i=a("./lib/rationalize"),j=a("./div");function c(b,a){if(e(b))return a?j(b,c(a)):[b[0].clone(),b[1].clone()];var k,d,l=0;if(f(b))k=b.clone();else if("string"==typeof b)k=h(b);else if(0===b)return[g(0),g(1)];else if(b===Math.floor(b))k=g(b);else{for(;b!==Math.floor(b);)b*=0x7fffffffffffffff,l-=256;k=g(b)}if(e(a))k.mul(a[1]),d=a[0].clone();else if(f(a))d=a.clone();else if("string"==typeof a)d=h(a);else if(a)if(a===Math.floor(a))d=g(a);else{for(;a!==Math.floor(a);)a*=0x7fffffffffffffff,l+=256;d=g(a)}else d=g(1);return l>0?k=k.ushln(l):l<0&&(d=d.ushln(-l)),i(k,d)}b.exports=c},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(a,b,c){"use strict";var d=a("./lib/is-bn");b.exports=function(a){return Array.isArray(a)&&2===a.length&&d(a[0])&&d(a[1])}},{"./lib/is-bn":23}],20:[function(a,b,c){"use strict";var d=a("bn.js");b.exports=function(a){return a.cmp(new d(0))}},{"bn.js":33}],21:[function(a,b,c){"use strict";var d=a("./bn-sign");b.exports=function(e){var f=e.length,a=e.words,b=0;if(1===f)b=a[0];else if(2===f)b=a[0]+67108864*a[1];else for(var c=0;c<f;c++)b+=a[c]*Math.pow(67108864,c);return d(e)*b}},{"./bn-sign":20}],22:[function(a,b,c){"use strict";var d=a("double-bits"),e=a("bit-twiddle").countTrailingZeros;b.exports=function(a){var b=e(d.lo(a));if(b<32)return b;var c=e(d.hi(a));return c>20?52:c+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(a,b,c){"use strict";a("bn.js"),b.exports=function(a){return a&&"object"==typeof a&&Boolean(a.words)}},{"bn.js":33}],24:[function(a,b,c){"use strict";var d=a("bn.js"),e=a("double-bits");b.exports=function(a){var b=e.exponent(a);return b<52?new d(a):new d(a*Math.pow(2,52-b)).ushln(b-52)}},{"bn.js":33,"double-bits":64}],25:[function(a,b,c){"use strict";var d=a("./num-to-bn"),e=a("./bn-sign");b.exports=function(a,b){var g=e(a),f=e(b);if(0===g)return[d(0),d(1)];if(0===f)return[d(0),d(0)];f<0&&(a=a.neg(),b=b.neg());var c=a.gcd(b);return c.cmpn(1)?[a.div(c),b.div(c)]:[a,b]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(a,b,c){"use strict";var d=a("bn.js");b.exports=function(a){return new d(a)}},{"bn.js":33}],27:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[0]),a[1].mul(b[1]))}},{"./lib/rationalize":25}],28:[function(a,b,c){"use strict";var d=a("./lib/bn-sign");b.exports=function(a){return d(a[0])*d(a[1])}},{"./lib/bn-sign":20}],29:[function(a,b,c){"use strict";var d=a("./lib/rationalize");b.exports=function(a,b){return d(a[0].mul(b[1]).sub(a[1].mul(b[0])),a[1].mul(b[1]))}},{"./lib/rationalize":25}],30:[function(a,b,c){"use strict";var d=a("./lib/bn-to-num"),e=a("./lib/ctz");b.exports=function(j){var i=j[0],a=j[1];if(0===i.cmpn(0))return 0;var k=i.abs().divmod(a.abs()),b=d(k.div),c=k.mod,f=i.negative!==a.negative?-1:1;if(0===c.cmpn(0))return f*b;if(b){var l=e(b)+4,g=d(c.ushln(l).divRound(a));return f*(b+g*Math.pow(2,-l))}var h=a.bitLength()-c.bitLength()+53,g=d(c.ushln(h).divRound(a));return h<1023?f*g*Math.pow(2,-h):f*(g*=11125369292536007e-324)*Math.pow(2,1023-h)}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(b,a,c){"use strict";function d(h,d,e,c,a){for(var f=a+1;c<=a;){var b=c+a>>>1,g=h[b];(void 0!==e?e(g,d):g-d)>=0?(f=b,a=b-1):c=b+1}return f}function e(h,d,e,c,a){for(var f=a+1;c<=a;){var b=c+a>>>1,g=h[b];(void 0!==e?e(g,d):g-d)>0?(f=b,a=b-1):c=b+1}return f}function f(h,d,e,a,c){for(var f=a-1;a<=c;){var b=a+c>>>1,g=h[b];(void 0!==e?e(g,d):g-d)<0?(f=b,a=b+1):c=b-1}return f}function g(h,d,e,a,c){for(var f=a-1;a<=c;){var b=a+c>>>1,g=h[b];(void 0!==e?e(g,d):g-d)<=0?(f=b,a=b+1):c=b-1}return f}function h(h,d,e,b,c){for(;b<=c;){var a=b+c>>>1,f=h[a],g=void 0!==e?e(f,d):f-d;if(0===g)return a;g<=0?b=a+1:c=a-1}return -1}function i(a,d,b,c,e,f){return"function"==typeof b?f(a,d,b,void 0===c?0:0|c,void 0===e?a.length-1:0|e):f(a,d,void 0,void 0===b?0:0|b,void 0===c?a.length-1:0|c)}a.exports={ge:function(a,b,c,e,f){return i(a,b,c,e,f,d)},gt:function(a,b,c,d,f){return i(a,b,c,d,f,e)},lt:function(a,b,c,d,e){return i(a,b,c,d,e,f)},le:function(a,b,c,d,e){return i(a,b,c,d,e,g)},eq:function(a,b,c,d,e){return i(a,b,c,d,e,h)}}},{}],32:[function(d,e,a){"use strict";"use restrict";function b(a){var b=32;return(a&=-a)&&b--,65535&a&&(b-=16),16711935&a&&(b-=8),252645135&a&&(b-=4),858993459&a&&(b-=2),1431655765&a&&(b-=1),b}a.INT_BITS=32,a.INT_MAX=2147483647,a.INT_MIN=-2147483648,a.sign=function(a){return(a>0)-(a<0)},a.abs=function(a){var b=a>>31;return(a^b)-b},a.min=function(b,a){return a^(b^a)& -(b<a)},a.max=function(a,b){return a^(a^b)& -(a<b)},a.isPow2=function(a){return!(a&a-1)&&!!a},a.log2=function(a){var c,b;return a>>>=c=(a>65535)<<4,a>>>=b=(a>255)<<3,c|=b,b=(a>15)<<2,a>>>=b,c|=b,b=(a>3)<<1,a>>>=b,c|=b,c|a>>1},a.log10=function(a){return a>=1e9?9:a>=1e8?8:a>=1e7?7:a>=1e6?6:a>=1e5?5:a>=1e4?4:a>=1e3?3:a>=100?2:a>=10?1:0},a.popCount=function(a){return a-=a>>>1&1431655765,((a=(858993459&a)+(a>>>2&858993459))+(a>>>4)&252645135)*16843009>>>24},a.countTrailingZeros=b,a.nextPow2=function(a){return a+=0===a,--a,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a+1},a.prevPow2=function(a){return a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,(a|=a>>>16)-(a>>>1)},a.parity=function(a){return a^=a>>>16,a^=a>>>8,a^=a>>>4,27030>>>(a&=15)&1};var c=new Array(256);!function(e){for(var a=0;a<256;++a){var b=a,c=a,d=7;for(b>>>=1;b;b>>>=1)c<<=1,c|=1&b,--d;e[a]=c<<d&255}}(c),a.reverse=function(a){return c[255&a]<<24|c[a>>>8&255]<<16|c[a>>>16&255]<<8|c[a>>>24&255]},a.interleave2=function(a,b){return a&=65535,b&=65535,(a=((a=((a=((a=(a|a<<8)&16711935)|a<<4)&252645135)|a<<2)&858993459)|a<<1)&1431655765)|(b=((b=((b=((b=(b|b<<8)&16711935)|b<<4)&252645135)|b<<2)&858993459)|b<<1)&1431655765)<<1},a.deinterleave2=function(a,b){return(a=((a=((a=((a=((a=a>>>b&1431655765)|a>>>1)&858993459)|a>>>2)&252645135)|a>>>4)&16711935)|a>>>16)&65535)<<16>>16},a.interleave3=function(a,c,b){return a&=1023,a=((a=((a=((a=(a|a<<16)&4278190335)|a<<8)&251719695)|a<<4)&3272356035)|a<<2)&1227133513,c&=1023,b&=1023,b=((b=((b=((b=(b|b<<16)&4278190335)|b<<8)&251719695)|b<<4)&3272356035)|b<<2)&1227133513,(a|=(c=((c=((c=((c=(c|c<<16)&4278190335)|c<<8)&251719695)|c<<4)&3272356035)|c<<2)&1227133513)<<1)|b<<2},a.deinterleave3=function(a,b){return(a=((a=((a=((a=((a=a>>>b&1227133513)|a>>>2)&3272356035)|a>>>4)&251719695)|a>>>8)&4278190335)|a>>>16)&1023)<<22>>22},a.nextCombination=function(a){var c=a|a-1;return c+1|(~c& -~c)-1>>>b(a)+1}},{}],33:[function(b,a,c){!function(i,k){"use strict";function p(a,b){if(!a)throw new Error(b||"Assertion failed")}function g(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}function a(c,b,d){if(a.isBN(c))return c;this.negative=0,this.words=null,this.length=0,this.red=null,null!==c&&(("le"===b||"be"===b)&&(d=b,b=10),this._init(c||0,b||10,d||"be"))}"object"==typeof i?i.exports=a:k.BN=a,a.BN=a,a.wordSize=26;try{u="undefined"!=typeof window&& void 0!==window.Buffer?window.Buffer:b("buffer").Buffer}catch(q){}function r(b,c){var a=b.charCodeAt(c);return a>=65&&a<=70?a-55:a>=97&&a<=102?a-87:a-48&15}function s(b,d,a){var c=r(b,a);return a-1>=d&&(c|=r(b,a-1)<<4),c}function t(d,e,f,g){for(var a=0,h=Math.min(d.length,f),c=e;c<h;c++){var b=d.charCodeAt(c)-48;a*=g,b>=49?a+=b-49+10:b>=17?a+=b-17+10:a+=b}return a}a.isBN=function(b){return b instanceof a||null!==b&&"object"==typeof b&&b.constructor.wordSize===a.wordSize&&Array.isArray(b.words)},a.max=function(a,b){return a.cmp(b)>0?a:b},a.min=function(a,b){return 0>a.cmp(b)?a:b},a.prototype._init=function(b,a,c){if("number"==typeof b)return this._initNumber(b,a,c);if("object"==typeof b)return this._initArray(b,a,c);"hex"===a&&(a=16),p(a===(0|a)&&a>=2&&a<=36);var d=0;"-"===(b=b.toString().replace(/\s+/g,""))[0]&&(d++,this.negative=1),d<b.length&&(16===a?this._parseHex(b,d,c):(this._parseBase(b,a,d),"le"===c&&this._initArray(this.toArray(),a,c)))},a.prototype._initNumber=function(a,c,b){a<0&&(this.negative=1,a=-a),a<67108864?(this.words=[67108863&a],this.length=1):a<4503599627370496?(this.words=[67108863&a,a/67108864&67108863],this.length=2):(p(a<9007199254740992),this.words=[67108863&a,a/67108864&67108863,1],this.length=3),"le"===b&&this._initArray(this.toArray(),c,b)},a.prototype._initArray=function(b,g,f){if(p("number"==typeof b.length),b.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(b.length/3),this.words=new Array(this.length);for(var c,e,a=0;a<this.length;a++)this.words[a]=0;var d=0;if("be"===f)for(a=b.length-1,c=0;a>=0;a-=3)e=b[a]|b[a-1]<<8|b[a-2]<<16,this.words[c]|=e<<d&67108863,this.words[c+1]=e>>>26-d&67108863,(d+=24)>=26&&(d-=26,c++);else if("le"===f)for(a=0,c=0;a<b.length;a+=3)e=b[a]|b[a+1]<<8|b[a+2]<<16,this.words[c]|=e<<d&67108863,this.words[c+1]=e>>>26-d&67108863,(d+=24)>=26&&(d-=26,c++);return this.strip()},a.prototype._parseHex=function(d,c,g){this.length=Math.ceil((d.length-c)/6),this.words=new Array(this.length);for(var e,a=0;a<this.length;a++)this.words[a]=0;var b=0,f=0;if("be"===g)for(a=d.length-1;a>=c;a-=2)e=s(d,c,a)<<b,this.words[f]|=67108863&e,b>=18?(b-=18,f+=1,this.words[f]|=e>>>26):b+=8;else{var h=d.length-c;for(a=h%2==0?c+1:c;a<d.length;a+=2)e=s(d,c,a)<<b,this.words[f]|=67108863&e,b>=18?(b-=18,f+=1,this.words[f]|=e>>>26):b+=8}this.strip()},a.prototype._parseBase=function(f,c,g){this.words=[0],this.length=1;for(var d=0,e=1;e<=67108863;e*=c)d++;d--,e=e/c|0;for(var h=f.length-g,i=h%d,k=Math.min(h,h-i)+g,a=0,b=g;b<k;b+=d)a=t(f,b,b+d,c),this.imuln(e),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==i){var j=1;for(a=t(f,b,f.length,c),b=0;b<i;b++)j*=c;this.imuln(j),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}this.strip()},a.prototype.copy=function(a){a.words=new Array(this.length);for(var b=0;b<this.length;b++)a.words[b]=this.words[b];a.length=this.length,a.negative=this.negative,a.red=this.red},a.prototype.clone=function(){var b=new a(null);return this.copy(b),b},a.prototype._expand=function(a){for(;this.length<a;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u,v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],x=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function l(c,d,a){a.negative=d.negative^c.negative;var f=c.length+d.length|0;a.length=f,f=f-1|0;var j=0|c.words[0],k=0|d.words[0],g=j*k,e=g/67108864|0;a.words[0]=67108863&g;for(var b=1;b<f;b++){for(var l=e>>>26,i=67108863&e,m=Math.min(b,d.length-1),h=Math.max(0,b-c.length+1);h<=m;h++){var n=b-h|0;l+=(g=(j=0|c.words[n])*(k=0|d.words[h])+i)/67108864|0,i=67108863&g}a.words[b]=0|i,e=0|l}return 0!==e?a.words[b]=0|e:a.length--,a.strip()}a.prototype.toString=function(b,e){if(e=0|e||1,16===(b=b||10)||"hex"===b){a="";for(var a,f=0,g=0,c=0;c<this.length;c++){var j=this.words[c],h=((j<<f|g)&16777215).toString(16);a=0!=(g=j>>>24-f&16777215)||c!==this.length-1?v[6-h.length]+h+a:h+a,(f+=2)>=26&&(f-=26,c--)}for(0!==g&&(a=g.toString(16)+a);a.length%e!=0;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}if(b===(0|b)&&b>=2&&b<=36){var l=w[b],k=x[b];a="";var d=this.clone();for(d.negative=0;!d.isZero();){var i=d.modn(k).toString(b);a=(d=d.idivn(k)).isZero()?i+a:v[l-i.length]+i+a}for(this.isZero()&&(a="0"+a);a.length%e!=0;)a="0"+a;return 0!==this.negative&&(a="-"+a),a}p(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var a=this.words[0];return 2===this.length?a+=67108864*this.words[1]:3===this.length&&1===this.words[2]?a+=4503599627370496+67108864*this.words[1]:this.length>2&&p(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-a:a},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(a,b){return p(void 0!==u),this.toArrayLike(u,a,b)},a.prototype.toArray=function(a,b){return this.toArrayLike(Array,a,b)},a.prototype.toArrayLike=function(g,h,i){var e,a,f=this.byteLength(),b=i||Math.max(1,f);p(f<=b,"byte array longer than desired length"),p(b>0,"Requested array length <= 0"),this.strip();var d=new g(b),c=this.clone();if("le"!==h){for(a=0;a<b-f;a++)d[a]=0;for(a=0;!c.isZero();a++)e=c.andln(255),c.iushrn(8),d[b-a-1]=e}else{for(a=0;!c.isZero();a++)e=c.andln(255),c.iushrn(8),d[a]=e;for(;a<b;a++)d[a]=0}return d},Math.clz32?a.prototype._countBits=function(a){return 32-Math.clz32(a)}:a.prototype._countBits=function(c){var a=c,b=0;return a>=4096&&(b+=13,a>>>=13),a>=64&&(b+=7,a>>>=7),a>=8&&(b+=4,a>>>=4),a>=2&&(b+=2,a>>>=2),b+a},a.prototype._zeroBits=function(c){if(0===c)return 26;var a=c,b=0;return(8191&a)==0&&(b+=13,a>>>=13),(127&a)==0&&(b+=7,a>>>=7),(15&a)==0&&(b+=4,a>>>=4),(3&a)==0&&(b+=2,a>>>=2),(1&a)==0&&b++,b},a.prototype.bitLength=function(){var a=this.words[this.length-1],b=this._countBits(a);return(this.length-1)*26+b},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var b=0,a=0;a<this.length;a++){var c=this._zeroBits(this.words[a]);if(b+=c,26!==c)break}return b},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(a){return 0!==this.negative?this.abs().inotn(a).iaddn(1):this.clone()},a.prototype.fromTwos=function(a){return this.testn(a-1)?this.notn(a).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(b){for(;this.length<b.length;)this.words[this.length++]=0;for(var a=0;a<b.length;a++)this.words[a]=this.words[a]|b.words[a];return this.strip()},a.prototype.ior=function(a){return p((this.negative|a.negative)==0),this.iuor(a)},a.prototype.or=function(a){return this.length>a.length?this.clone().ior(a):a.clone().ior(this)},a.prototype.uor=function(a){return this.length>a.length?this.clone().iuor(a):a.clone().iuor(this)},a.prototype.iuand=function(b){var c;c=this.length>b.length?b:this;for(var a=0;a<c.length;a++)this.words[a]=this.words[a]&b.words[a];return this.length=c.length,this.strip()},a.prototype.iand=function(a){return p((this.negative|a.negative)==0),this.iuand(a)},a.prototype.and=function(a){return this.length>a.length?this.clone().iand(a):a.clone().iand(this)},a.prototype.uand=function(a){return this.length>a.length?this.clone().iuand(a):a.clone().iuand(this)},a.prototype.iuxor=function(c){this.length>c.length?(b=this,d=c):(b=c,d=this);for(var b,d,a=0;a<d.length;a++)this.words[a]=b.words[a]^d.words[a];if(this!==b)for(;a<b.length;a++)this.words[a]=b.words[a];return this.length=b.length,this.strip()},a.prototype.ixor=function(a){return p((this.negative|a.negative)==0),this.iuxor(a)},a.prototype.xor=function(a){return this.length>a.length?this.clone().ixor(a):a.clone().ixor(this)},a.prototype.uxor=function(a){return this.length>a.length?this.clone().iuxor(a):a.clone().iuxor(this)},a.prototype.inotn=function(b){p("number"==typeof b&&b>=0);var c=0|Math.ceil(b/26),d=b%26;this._expand(c),d>0&&c--;for(var a=0;a<c;a++)this.words[a]=67108863& ~this.words[a];return d>0&&(this.words[a]=~this.words[a]&67108863>>26-d),this.strip()},a.prototype.notn=function(a){return this.clone().inotn(a)},a.prototype.setn=function(b,d){p("number"==typeof b&&b>=0);var a=b/26|0,c=b%26;return this._expand(a+1),d?this.words[a]=this.words[a]|1<<c:this.words[a]=this.words[a]& ~(1<<c),this.strip()},a.prototype.iadd=function(b){if(0!==this.negative&&0===b.negative)return this.negative=0,e=this.isub(b),this.negative^=1,this._normSign();if(0===this.negative&&0!==b.negative)return b.negative=0,e=this.isub(b),b.negative=1,e._normSign();this.length>b.length?(c=this,f=b):(c=b,f=this);for(var e,c,f,d=0,a=0;a<f.length;a++)e=(0|c.words[a])+(0|f.words[a])+d,this.words[a]=67108863&e,d=e>>>26;for(;0!==d&&a<c.length;a++)e=(0|c.words[a])+d,this.words[a]=67108863&e,d=e>>>26;if(this.length=c.length,0!==d)this.words[this.length]=d,this.length++;else if(c!==this)for(;a<c.length;a++)this.words[a]=c.words[a];return this},a.prototype.add=function(a){var b;return 0!==a.negative&&0===this.negative?(a.negative=0,b=this.sub(a),a.negative^=1,b):0===a.negative&&0!==this.negative?(this.negative=0,b=a.sub(this),this.negative=1,b):this.length>a.length?this.clone().iadd(a):a.clone().iadd(this)},a.prototype.isub=function(c){if(0!==c.negative){c.negative=0;var b,f,e=this.iadd(c);return c.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var g=this.cmp(c);if(0===g)return this.negative=0,this.length=1,this.words[0]=0,this;g>0?(b=this,f=c):(b=c,f=this);for(var d=0,a=0;a<f.length;a++)d=(e=(0|b.words[a])-(0|f.words[a])+d)>>26,this.words[a]=67108863&e;for(;0!==d&&a<b.length;a++)d=(e=(0|b.words[a])+d)>>26,this.words[a]=67108863&e;if(0===d&&a<b.length&&b!==this)for(;a<b.length;a++)this.words[a]=b.words[a];return this.length=Math.max(this.length,a),b!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(a){return this.clone().isub(a)};var m=function(an,ao,V){var b,a,c,T=an.words,U=ao.words,e=V.words,d=0,ap=0|T[0],f=8191&ap,g=ap>>>13,aq=0|T[1],h=8191&aq,i=aq>>>13,ar=0|T[2],j=8191&ar,k=ar>>>13,as=0|T[3],l=8191&as,m=as>>>13,at=0|T[4],n=8191&at,o=at>>>13,au=0|T[5],p=8191&au,q=au>>>13,av=0|T[6],r=8191&av,s=av>>>13,aw=0|T[7],t=8191&aw,u=aw>>>13,ax=0|T[8],v=8191&ax,w=ax>>>13,ay=0|T[9],x=8191&ay,y=ay>>>13,az=0|U[0],z=8191&az,A=az>>>13,aA=0|U[1],B=8191&aA,C=aA>>>13,aB=0|U[2],D=8191&aB,E=aB>>>13,aC=0|U[3],F=8191&aC,G=aC>>>13,aD=0|U[4],H=8191&aD,I=aD>>>13,aE=0|U[5],J=8191&aE,K=aE>>>13,aF=0|U[6],L=8191&aF,M=aF>>>13,aG=0|U[7],N=8191&aG,O=aG>>>13,aH=0|U[8],P=8191&aH,Q=aH>>>13,aI=0|U[9],R=8191&aI,S=aI>>>13;V.negative=an.negative^ao.negative,V.length=19;var W=(d+(b=Math.imul(f,z))|0)+((8191&(a=(a=Math.imul(f,A))+Math.imul(g,z)|0))<<13)|0;d=((c=Math.imul(g,A))+(a>>>13)|0)+(W>>>26)|0,W&=67108863,b=Math.imul(h,z),a=Math.imul(h,A),a=a+Math.imul(i,z)|0,c=Math.imul(i,A);var X=(d+(b=b+Math.imul(f,B)|0)|0)+((8191&(a=(a=a+Math.imul(f,C)|0)+Math.imul(g,B)|0))<<13)|0;d=((c=c+Math.imul(g,C)|0)+(a>>>13)|0)+(X>>>26)|0,X&=67108863,b=Math.imul(j,z),a=Math.imul(j,A),a=a+Math.imul(k,z)|0,c=Math.imul(k,A),b=b+Math.imul(h,B)|0,a=a+Math.imul(h,C)|0,a=a+Math.imul(i,B)|0,c=c+Math.imul(i,C)|0;var Y=(d+(b=b+Math.imul(f,D)|0)|0)+((8191&(a=(a=a+Math.imul(f,E)|0)+Math.imul(g,D)|0))<<13)|0;d=((c=c+Math.imul(g,E)|0)+(a>>>13)|0)+(Y>>>26)|0,Y&=67108863,b=Math.imul(l,z),a=Math.imul(l,A),a=a+Math.imul(m,z)|0,c=Math.imul(m,A),b=b+Math.imul(j,B)|0,a=a+Math.imul(j,C)|0,a=a+Math.imul(k,B)|0,c=c+Math.imul(k,C)|0,b=b+Math.imul(h,D)|0,a=a+Math.imul(h,E)|0,a=a+Math.imul(i,D)|0,c=c+Math.imul(i,E)|0;var Z=(d+(b=b+Math.imul(f,F)|0)|0)+((8191&(a=(a=a+Math.imul(f,G)|0)+Math.imul(g,F)|0))<<13)|0;d=((c=c+Math.imul(g,G)|0)+(a>>>13)|0)+(Z>>>26)|0,Z&=67108863,b=Math.imul(n,z),a=Math.imul(n,A),a=a+Math.imul(o,z)|0,c=Math.imul(o,A),b=b+Math.imul(l,B)|0,a=a+Math.imul(l,C)|0,a=a+Math.imul(m,B)|0,c=c+Math.imul(m,C)|0,b=b+Math.imul(j,D)|0,a=a+Math.imul(j,E)|0,a=a+Math.imul(k,D)|0,c=c+Math.imul(k,E)|0,b=b+Math.imul(h,F)|0,a=a+Math.imul(h,G)|0,a=a+Math.imul(i,F)|0,c=c+Math.imul(i,G)|0;var $=(d+(b=b+Math.imul(f,H)|0)|0)+((8191&(a=(a=a+Math.imul(f,I)|0)+Math.imul(g,H)|0))<<13)|0;d=((c=c+Math.imul(g,I)|0)+(a>>>13)|0)+($>>>26)|0,$&=67108863,b=Math.imul(p,z),a=Math.imul(p,A),a=a+Math.imul(q,z)|0,c=Math.imul(q,A),b=b+Math.imul(n,B)|0,a=a+Math.imul(n,C)|0,a=a+Math.imul(o,B)|0,c=c+Math.imul(o,C)|0,b=b+Math.imul(l,D)|0,a=a+Math.imul(l,E)|0,a=a+Math.imul(m,D)|0,c=c+Math.imul(m,E)|0,b=b+Math.imul(j,F)|0,a=a+Math.imul(j,G)|0,a=a+Math.imul(k,F)|0,c=c+Math.imul(k,G)|0,b=b+Math.imul(h,H)|0,a=a+Math.imul(h,I)|0,a=a+Math.imul(i,H)|0,c=c+Math.imul(i,I)|0;var _=(d+(b=b+Math.imul(f,J)|0)|0)+((8191&(a=(a=a+Math.imul(f,K)|0)+Math.imul(g,J)|0))<<13)|0;d=((c=c+Math.imul(g,K)|0)+(a>>>13)|0)+(_>>>26)|0,_&=67108863,b=Math.imul(r,z),a=Math.imul(r,A),a=a+Math.imul(s,z)|0,c=Math.imul(s,A),b=b+Math.imul(p,B)|0,a=a+Math.imul(p,C)|0,a=a+Math.imul(q,B)|0,c=c+Math.imul(q,C)|0,b=b+Math.imul(n,D)|0,a=a+Math.imul(n,E)|0,a=a+Math.imul(o,D)|0,c=c+Math.imul(o,E)|0,b=b+Math.imul(l,F)|0,a=a+Math.imul(l,G)|0,a=a+Math.imul(m,F)|0,c=c+Math.imul(m,G)|0,b=b+Math.imul(j,H)|0,a=a+Math.imul(j,I)|0,a=a+Math.imul(k,H)|0,c=c+Math.imul(k,I)|0,b=b+Math.imul(h,J)|0,a=a+Math.imul(h,K)|0,a=a+Math.imul(i,J)|0,c=c+Math.imul(i,K)|0;var aa=(d+(b=b+Math.imul(f,L)|0)|0)+((8191&(a=(a=a+Math.imul(f,M)|0)+Math.imul(g,L)|0))<<13)|0;d=((c=c+Math.imul(g,M)|0)+(a>>>13)|0)+(aa>>>26)|0,aa&=67108863,b=Math.imul(t,z),a=Math.imul(t,A),a=a+Math.imul(u,z)|0,c=Math.imul(u,A),b=b+Math.imul(r,B)|0,a=a+Math.imul(r,C)|0,a=a+Math.imul(s,B)|0,c=c+Math.imul(s,C)|0,b=b+Math.imul(p,D)|0,a=a+Math.imul(p,E)|0,a=a+Math.imul(q,D)|0,c=c+Math.imul(q,E)|0,b=b+Math.imul(n,F)|0,a=a+Math.imul(n,G)|0,a=a+Math.imul(o,F)|0,c=c+Math.imul(o,G)|0,b=b+Math.imul(l,H)|0,a=a+Math.imul(l,I)|0,a=a+Math.imul(m,H)|0,c=c+Math.imul(m,I)|0,b=b+Math.imul(j,J)|0,a=a+Math.imul(j,K)|0,a=a+Math.imul(k,J)|0,c=c+Math.imul(k,K)|0,b=b+Math.imul(h,L)|0,a=a+Math.imul(h,M)|0,a=a+Math.imul(i,L)|0,c=c+Math.imul(i,M)|0;var ab=(d+(b=b+Math.imul(f,N)|0)|0)+((8191&(a=(a=a+Math.imul(f,O)|0)+Math.imul(g,N)|0))<<13)|0;d=((c=c+Math.imul(g,O)|0)+(a>>>13)|0)+(ab>>>26)|0,ab&=67108863,b=Math.imul(v,z),a=Math.imul(v,A),a=a+Math.imul(w,z)|0,c=Math.imul(w,A),b=b+Math.imul(t,B)|0,a=a+Math.imul(t,C)|0,a=a+Math.imul(u,B)|0,c=c+Math.imul(u,C)|0,b=b+Math.imul(r,D)|0,a=a+Math.imul(r,E)|0,a=a+Math.imul(s,D)|0,c=c+Math.imul(s,E)|0,b=b+Math.imul(p,F)|0,a=a+Math.imul(p,G)|0,a=a+Math.imul(q,F)|0,c=c+Math.imul(q,G)|0,b=b+Math.imul(n,H)|0,a=a+Math.imul(n,I)|0,a=a+Math.imul(o,H)|0,c=c+Math.imul(o,I)|0,b=b+Math.imul(l,J)|0,a=a+Math.imul(l,K)|0,a=a+Math.imul(m,J)|0,c=c+Math.imul(m,K)|0,b=b+Math.imul(j,L)|0,a=a+Math.imul(j,M)|0,a=a+Math.imul(k,L)|0,c=c+Math.imul(k,M)|0,b=b+Math.imul(h,N)|0,a=a+Math.imul(h,O)|0,a=a+Math.imul(i,N)|0,c=c+Math.imul(i,O)|0;var ac=(d+(b=b+Math.imul(f,P)|0)|0)+((8191&(a=(a=a+Math.imul(f,Q)|0)+Math.imul(g,P)|0))<<13)|0;d=((c=c+Math.imul(g,Q)|0)+(a>>>13)|0)+(ac>>>26)|0,ac&=67108863,b=Math.imul(x,z),a=Math.imul(x,A),a=a+Math.imul(y,z)|0,c=Math.imul(y,A),b=b+Math.imul(v,B)|0,a=a+Math.imul(v,C)|0,a=a+Math.imul(w,B)|0,c=c+Math.imul(w,C)|0,b=b+Math.imul(t,D)|0,a=a+Math.imul(t,E)|0,a=a+Math.imul(u,D)|0,c=c+Math.imul(u,E)|0,b=b+Math.imul(r,F)|0,a=a+Math.imul(r,G)|0,a=a+Math.imul(s,F)|0,c=c+Math.imul(s,G)|0,b=b+Math.imul(p,H)|0,a=a+Math.imul(p,I)|0,a=a+Math.imul(q,H)|0,c=c+Math.imul(q,I)|0,b=b+Math.imul(n,J)|0,a=a+Math.imul(n,K)|0,a=a+Math.imul(o,J)|0,c=c+Math.imul(o,K)|0,b=b+Math.imul(l,L)|0,a=a+Math.imul(l,M)|0,a=a+Math.imul(m,L)|0,c=c+Math.imul(m,M)|0,b=b+Math.imul(j,N)|0,a=a+Math.imul(j,O)|0,a=a+Math.imul(k,N)|0,c=c+Math.imul(k,O)|0,b=b+Math.imul(h,P)|0,a=a+Math.imul(h,Q)|0,a=a+Math.imul(i,P)|0,c=c+Math.imul(i,Q)|0;var ad=(d+(b=b+Math.imul(f,R)|0)|0)+((8191&(a=(a=a+Math.imul(f,S)|0)+Math.imul(g,R)|0))<<13)|0;d=((c=c+Math.imul(g,S)|0)+(a>>>13)|0)+(ad>>>26)|0,ad&=67108863,b=Math.imul(x,B),a=Math.imul(x,C),a=a+Math.imul(y,B)|0,c=Math.imul(y,C),b=b+Math.imul(v,D)|0,a=a+Math.imul(v,E)|0,a=a+Math.imul(w,D)|0,c=c+Math.imul(w,E)|0,b=b+Math.imul(t,F)|0,a=a+Math.imul(t,G)|0,a=a+Math.imul(u,F)|0,c=c+Math.imul(u,G)|0,b=b+Math.imul(r,H)|0,a=a+Math.imul(r,I)|0,a=a+Math.imul(s,H)|0,c=c+Math.imul(s,I)|0,b=b+Math.imul(p,J)|0,a=a+Math.imul(p,K)|0,a=a+Math.imul(q,J)|0,c=c+Math.imul(q,K)|0,b=b+Math.imul(n,L)|0,a=a+Math.imul(n,M)|0,a=a+Math.imul(o,L)|0,c=c+Math.imul(o,M)|0,b=b+Math.imul(l,N)|0,a=a+Math.imul(l,O)|0,a=a+Math.imul(m,N)|0,c=c+Math.imul(m,O)|0,b=b+Math.imul(j,P)|0,a=a+Math.imul(j,Q)|0,a=a+Math.imul(k,P)|0,c=c+Math.imul(k,Q)|0;var ae=(d+(b=b+Math.imul(h,R)|0)|0)+((8191&(a=(a=a+Math.imul(h,S)|0)+Math.imul(i,R)|0))<<13)|0;d=((c=c+Math.imul(i,S)|0)+(a>>>13)|0)+(ae>>>26)|0,ae&=67108863,b=Math.imul(x,D),a=Math.imul(x,E),a=a+Math.imul(y,D)|0,c=Math.imul(y,E),b=b+Math.imul(v,F)|0,a=a+Math.imul(v,G)|0,a=a+Math.imul(w,F)|0,c=c+Math.imul(w,G)|0,b=b+Math.imul(t,H)|0,a=a+Math.imul(t,I)|0,a=a+Math.imul(u,H)|0,c=c+Math.imul(u,I)|0,b=b+Math.imul(r,J)|0,a=a+Math.imul(r,K)|0,a=a+Math.imul(s,J)|0,c=c+Math.imul(s,K)|0,b=b+Math.imul(p,L)|0,a=a+Math.imul(p,M)|0,a=a+Math.imul(q,L)|0,c=c+Math.imul(q,M)|0,b=b+Math.imul(n,N)|0,a=a+Math.imul(n,O)|0,a=a+Math.imul(o,N)|0,c=c+Math.imul(o,O)|0,b=b+Math.imul(l,P)|0,a=a+Math.imul(l,Q)|0,a=a+Math.imul(m,P)|0,c=c+Math.imul(m,Q)|0;var af=(d+(b=b+Math.imul(j,R)|0)|0)+((8191&(a=(a=a+Math.imul(j,S)|0)+Math.imul(k,R)|0))<<13)|0;d=((c=c+Math.imul(k,S)|0)+(a>>>13)|0)+(af>>>26)|0,af&=67108863,b=Math.imul(x,F),a=Math.imul(x,G),a=a+Math.imul(y,F)|0,c=Math.imul(y,G),b=b+Math.imul(v,H)|0,a=a+Math.imul(v,I)|0,a=a+Math.imul(w,H)|0,c=c+Math.imul(w,I)|0,b=b+Math.imul(t,J)|0,a=a+Math.imul(t,K)|0,a=a+Math.imul(u,J)|0,c=c+Math.imul(u,K)|0,b=b+Math.imul(r,L)|0,a=a+Math.imul(r,M)|0,a=a+Math.imul(s,L)|0,c=c+Math.imul(s,M)|0,b=b+Math.imul(p,N)|0,a=a+Math.imul(p,O)|0,a=a+Math.imul(q,N)|0,c=c+Math.imul(q,O)|0,b=b+Math.imul(n,P)|0,a=a+Math.imul(n,Q)|0,a=a+Math.imul(o,P)|0,c=c+Math.imul(o,Q)|0;var ag=(d+(b=b+Math.imul(l,R)|0)|0)+((8191&(a=(a=a+Math.imul(l,S)|0)+Math.imul(m,R)|0))<<13)|0;d=((c=c+Math.imul(m,S)|0)+(a>>>13)|0)+(ag>>>26)|0,ag&=67108863,b=Math.imul(x,H),a=Math.imul(x,I),a=a+Math.imul(y,H)|0,c=Math.imul(y,I),b=b+Math.imul(v,J)|0,a=a+Math.imul(v,K)|0,a=a+Math.imul(w,J)|0,c=c+Math.imul(w,K)|0,b=b+Math.imul(t,L)|0,a=a+Math.imul(t,M)|0,a=a+Math.imul(u,L)|0,c=c+Math.imul(u,M)|0,b=b+Math.imul(r,N)|0,a=a+Math.imul(r,O)|0,a=a+Math.imul(s,N)|0,c=c+Math.imul(s,O)|0,b=b+Math.imul(p,P)|0,a=a+Math.imul(p,Q)|0,a=a+Math.imul(q,P)|0,c=c+Math.imul(q,Q)|0;var ah=(d+(b=b+Math.imul(n,R)|0)|0)+((8191&(a=(a=a+Math.imul(n,S)|0)+Math.imul(o,R)|0))<<13)|0;d=((c=c+Math.imul(o,S)|0)+(a>>>13)|0)+(ah>>>26)|0,ah&=67108863,b=Math.imul(x,J),a=Math.imul(x,K),a=a+Math.imul(y,J)|0,c=Math.imul(y,K),b=b+Math.imul(v,L)|0,a=a+Math.imul(v,M)|0,a=a+Math.imul(w,L)|0,c=c+Math.imul(w,M)|0,b=b+Math.imul(t,N)|0,a=a+Math.imul(t,O)|0,a=a+Math.imul(u,N)|0,c=c+Math.imul(u,O)|0,b=b+Math.imul(r,P)|0,a=a+Math.imul(r,Q)|0,a=a+Math.imul(s,P)|0,c=c+Math.imul(s,Q)|0;var ai=(d+(b=b+Math.imul(p,R)|0)|0)+((8191&(a=(a=a+Math.imul(p,S)|0)+Math.imul(q,R)|0))<<13)|0;d=((c=c+Math.imul(q,S)|0)+(a>>>13)|0)+(ai>>>26)|0,ai&=67108863,b=Math.imul(x,L),a=Math.imul(x,M),a=a+Math.imul(y,L)|0,c=Math.imul(y,M),b=b+Math.imul(v,N)|0,a=a+Math.imul(v,O)|0,a=a+Math.imul(w,N)|0,c=c+Math.imul(w,O)|0,b=b+Math.imul(t,P)|0,a=a+Math.imul(t,Q)|0,a=a+Math.imul(u,P)|0,c=c+Math.imul(u,Q)|0;var aj=(d+(b=b+Math.imul(r,R)|0)|0)+((8191&(a=(a=a+Math.imul(r,S)|0)+Math.imul(s,R)|0))<<13)|0;d=((c=c+Math.imul(s,S)|0)+(a>>>13)|0)+(aj>>>26)|0,aj&=67108863,b=Math.imul(x,N),a=Math.imul(x,O),a=a+Math.imul(y,N)|0,c=Math.imul(y,O),b=b+Math.imul(v,P)|0,a=a+Math.imul(v,Q)|0,a=a+Math.imul(w,P)|0,c=c+Math.imul(w,Q)|0;var ak=(d+(b=b+Math.imul(t,R)|0)|0)+((8191&(a=(a=a+Math.imul(t,S)|0)+Math.imul(u,R)|0))<<13)|0;d=((c=c+Math.imul(u,S)|0)+(a>>>13)|0)+(ak>>>26)|0,ak&=67108863,b=Math.imul(x,P),a=Math.imul(x,Q),a=a+Math.imul(y,P)|0,c=Math.imul(y,Q);var al=(d+(b=b+Math.imul(v,R)|0)|0)+((8191&(a=(a=a+Math.imul(v,S)|0)+Math.imul(w,R)|0))<<13)|0;d=((c=c+Math.imul(w,S)|0)+(a>>>13)|0)+(al>>>26)|0,al&=67108863;var am=(d+(b=Math.imul(x,R))|0)+((8191&(a=(a=Math.imul(x,S))+Math.imul(y,R)|0))<<13)|0;return d=((c=Math.imul(y,S))+(a>>>13)|0)+(am>>>26)|0,am&=67108863,e[0]=W,e[1]=X,e[2]=Y,e[3]=Z,e[4]=$,e[5]=_,e[6]=aa,e[7]=ab,e[8]=ac,e[9]=ad,e[10]=ae,e[11]=af,e[12]=ag,e[13]=ah,e[14]=ai,e[15]=aj,e[16]=ak,e[17]=al,e[18]=am,0!==d&&(e[19]=d,V.length++),V};function y(a,b,c){return new d().mulp(a,b,c)}function d(a,b){this.x=a,this.y=b}Math.imul||(m=l),a.prototype.mulTo=function(a,b){var c=this.length+a.length;return 10===this.length&&10===a.length?m(this,a,b):c<63?l(this,a,b):c<1024?function(d,e,b){b.negative=e.negative^d.negative,b.length=d.length+e.length;for(var f=0,g=0,c=0;c<b.length-1;c++){var a=g;g=0;for(var i=67108863&f,l=Math.min(c,e.length-1),h=Math.max(0,c-d.length+1);h<=l;h++){var m=c-h,k=(0|d.words[m])*(0|e.words[h]),j=67108863&k;a=a+(k/67108864|0)|0,i=67108863&(j=j+i|0),a=a+(j>>>26)|0,g+=a>>>26,a&=67108863}b.words[c]=i,f=a,a=g}return 0!==f?b.words[c]=f:b.length--,b.strip()}(this,a,b):y(this,a,b)},d.prototype.makeRBT=function(b){for(var d=new Array(b),e=a.prototype._countBits(b)-1,c=0;c<b;c++)d[c]=this.revBin(c,e,b);return d},d.prototype.revBin=function(a,c,e){if(0===a||a===e-1)return a;for(var d=0,b=0;b<c;b++)d|=(1&a)<<c-b-1,a>>=1;return d},d.prototype.permute=function(b,c,d,e,f,g){for(var a=0;a<g;a++)e[a]=c[b[a]],f[a]=d[b[a]]},d.prototype.transform=function(q,r,d,e,k,s){this.permute(s,q,r,d,e,k);for(var c=1;c<k;c<<=1)for(var j=c<<1,l=Math.cos(2*Math.PI/j),m=Math.sin(2*Math.PI/j),b=0;b<k;b+=j)for(var f=l,g=m,a=0;a<c;a++){var o=d[b+a],p=e[b+a],h=d[b+a+c],i=e[b+a+c],n=f*h-g*i;i=f*i+g*h,h=n,d[b+a]=o+h,e[b+a]=p+i,d[b+a+c]=o-h,e[b+a+c]=p-i,a!==j&&(n=l*f-m*g,g=l*g+m*f,f=n)}},d.prototype.guessLen13b=function(c,d){var a=1|Math.max(d,c),e=1&a,b=0;for(a=a/2|0;a;a>>>=1)b++;return 1<<b+1+e},d.prototype.conjugate=function(c,d,b){if(!(b<=1))for(var a=0;a<b/2;a++){var e=c[a];c[a]=c[b-a-1],c[b-a-1]=e,e=d[a],d[a]=-d[b-a-1],d[b-a-1]=-e}},d.prototype.normalize13b=function(b,c){for(var e=0,a=0;a<c/2;a++){var d=8192*Math.round(b[2*a+1]/c)+Math.round(b[2*a]/c)+e;b[a]=67108863&d,e=d<67108864?0:d/67108864|0}return b},d.prototype.convert13b=function(e,d,c,f){for(var b=0,a=0;a<d;a++)b+=0|e[a],c[2*a]=8191&b,b>>>=13,c[2*a+1]=8191&b,b>>>=13;for(a=2*d;a<f;++a)c[a]=0;p(0===b),p((-8192&b)==0)},d.prototype.stub=function(b){for(var c=new Array(b),a=0;a<b;a++)c[a]=0;return c},d.prototype.mulp=function(e,f,g){var a=2*this.guessLen13b(e.length,f.length),j=this.makeRBT(a),h=this.stub(a),m=new Array(a),c=new Array(a),d=new Array(a),n=new Array(a),k=new Array(a),l=new Array(a),i=g.words;i.length=a,this.convert13b(e.words,e.length,m,a),this.convert13b(f.words,f.length,n,a),this.transform(m,h,c,d,a,j),this.transform(n,h,k,l,a,j);for(var b=0;b<a;b++){var o=c[b]*k[b]-d[b]*l[b];d[b]=c[b]*l[b]+d[b]*k[b],c[b]=o}return this.conjugate(c,d,a),this.transform(c,d,i,h,a,j),this.conjugate(i,h,a),this.normalize13b(i,a),g.negative=e.negative^f.negative,g.length=e.length+f.length,g.strip()},a.prototype.mul=function(b){var c=new a(null);return c.words=new Array(this.length+b.length),this.mulTo(b,c)},a.prototype.mulf=function(b){var c=new a(null);return c.words=new Array(this.length+b.length),y(this,b,c)},a.prototype.imul=function(a){return this.clone().mulTo(a,this)},a.prototype.imuln=function(c){p("number"==typeof c),p(c<67108864);for(var a=0,b=0;b<this.length;b++){var d=(0|this.words[b])*c,e=(67108863&d)+(67108863&a);a>>=26,a+=d/67108864|0,a+=e>>>26,this.words[b]=67108863&e}return 0!==a&&(this.words[b]=a,this.length++),this},a.prototype.muln=function(a){return this.clone().imuln(a)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(f){var c=function(c){for(var b=new Array(c.bitLength()),a=0;a<b.length;a++){var e=a/26|0,d=a%26;b[a]=(c.words[e]&1<<d)>>>d}return b}(f);if(0===c.length)return new a(1);for(var d=this,b=0;b<c.length&&0===c[b];b++,d=d.sqr());if(++b<c.length)for(var e=d.sqr();b<c.length;b++,e=e.sqr())0!==c[b]&&(d=d.mul(e));return d},a.prototype.iushln=function(c){p("number"==typeof c&&c>=0);var a,b=c%26,d=(c-b)/26,g=67108863>>>26-b<<26-b;if(0!==b){var e=0;for(a=0;a<this.length;a++){var f=this.words[a]&g,h=(0|this.words[a])-f<<b;this.words[a]=h|e,e=f>>>26-b}e&&(this.words[a]=e,this.length++)}if(0!==d){for(a=this.length-1;a>=0;a--)this.words[a+d]=this.words[a];for(a=0;a<d;a++)this.words[a]=0;this.length+=d}return this.strip()},a.prototype.ishln=function(a){return p(0===this.negative),this.iushln(a)},a.prototype.iushrn=function(f,h,j){p("number"==typeof f&&f>=0),g=h?(h-h%26)/26:0;var g,d=f%26,b=Math.min((f-d)/26,this.length),k=67108863^67108863>>>d<<d,c=j;if(g-=b,g=Math.max(0,g),c){for(var a=0;a<b;a++)c.words[a]=this.words[a];c.length=b}if(0===b);else if(this.length>b)for(this.length-=b,a=0;a<this.length;a++)this.words[a]=this.words[a+b];else this.words[0]=0,this.length=1;var e=0;for(a=this.length-1;a>=0&&(0!==e||a>=g);a--){var i=0|this.words[a];this.words[a]=e<<26-d|i>>>d,e=i&k}return c&&0!==e&&(c.words[c.length++]=e),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(a,b,c){return p(0===this.negative),this.iushrn(a,b,c)},a.prototype.shln=function(a){return this.clone().ishln(a)},a.prototype.ushln=function(a){return this.clone().iushln(a)},a.prototype.shrn=function(a){return this.clone().ishrn(a)},a.prototype.ushrn=function(a){return this.clone().iushrn(a)},a.prototype.testn=function(a){p("number"==typeof a&&a>=0);var b=a%26,c=(a-b)/26;return!(this.length<=c)&&!!(this.words[c]&1<<b)},a.prototype.imaskn=function(b){p("number"==typeof b&&b>=0);var a=b%26,c=(b-a)/26;if(p(0===this.negative,"imaskn works only with positive numbers"),this.length<=c)return this;if(0!==a&&c++,this.length=Math.min(c,this.length),0!==a){var d=67108863^67108863>>>a<<a;this.words[this.length-1]&=d}return this.strip()},a.prototype.maskn=function(a){return this.clone().imaskn(a)},a.prototype.iaddn=function(a){return(p("number"==typeof a),p(a<67108864),a<0)?this.isubn(-a):0!==this.negative?1===this.length&&(0|this.words[0])<a?(this.words[0]=a-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(a),this.negative=1,this):this._iaddn(a)},a.prototype._iaddn=function(b){this.words[0]+=b;for(var a=0;a<this.length&&this.words[a]>=67108864;a++)this.words[a]-=67108864,a===this.length-1?this.words[a+1]=1:this.words[a+1]++;return this.length=Math.max(this.length,a+1),this},a.prototype.isubn=function(a){if(p("number"==typeof a),p(a<67108864),a<0)return this.iaddn(-a);if(0!==this.negative)return this.negative=0,this.iaddn(a),this.negative=1,this;if(this.words[0]-=a,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var b=0;b<this.length&&this.words[b]<0;b++)this.words[b]+=67108864,this.words[b+1]-=1;return this.strip()},a.prototype.addn=function(a){return this.clone().iaddn(a)},a.prototype.subn=function(a){return this.clone().isubn(a)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,g,d){var a,c,h=e.length+d;this._expand(h);var b=0;for(a=0;a<e.length;a++){c=(0|this.words[a+d])+b;var f=(0|e.words[a])*g;c-=67108863&f,b=(c>>26)-(f/67108864|0),this.words[a+d]=67108863&c}for(;a<this.length-d;a++)b=(c=(0|this.words[a+d])+b)>>26,this.words[a+d]=67108863&c;if(0===b)return this.strip();for(p(-1===b),b=0,a=0;a<this.length;a++)b=(c=-(0|this.words[a])+b)>>26,this.words[a]=67108863&c;return this.negative=1,this.strip()},a.prototype._wordDiv=function(k,l){var c,f=this.length-k.length,b=this.clone(),d=k,i=0|d.words[d.length-1];0!=(f=26-this._countBits(i))&&(d=d.ushln(f),b.iushln(f),i=0|d.words[d.length-1]);var h=b.length-d.length;if("mod"!==l){(c=new a(null)).length=h+1,c.words=new Array(c.length);for(var j=0;j<c.length;j++)c.words[j]=0}var m=b.clone()._ishlnsubmul(d,1,h);0===m.negative&&(b=m,c&&(c.words[h]=1));for(var e=h-1;e>=0;e--){var g=(0|b.words[d.length+e])*67108864+(0|b.words[d.length+e-1]);for(g=Math.min(g/i|0,67108863),b._ishlnsubmul(d,g,e);0!==b.negative;)g--,b.negative=0,b._ishlnsubmul(d,1,e),b.isZero()||(b.negative^=1);c&&(c.words[e]=g)}return c&&c.strip(),b.strip(),"div"!==l&&0!==f&&b.iushrn(f),{div:c||null,mod:b}},a.prototype.divmod=function(b,c,g){var f,e,d;return(p(!b.isZero()),this.isZero())?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===b.negative?(d=this.neg().divmod(b,c),"mod"!==c&&(f=d.div.neg()),"div"!==c&&(e=d.mod.neg(),g&&0!==e.negative&&e.iadd(b)),{div:f,mod:e}):0===this.negative&&0!==b.negative?(d=this.divmod(b.neg(),c),"mod"!==c&&(f=d.div.neg()),{div:f,mod:d.mod}):(this.negative&b.negative)!=0?(d=this.neg().divmod(b.neg(),c),"div"!==c&&(e=d.mod.neg(),g&&0!==e.negative&&e.isub(b)),{div:d.div,mod:e}):b.length>this.length||0>this.cmp(b)?{div:new a(0),mod:this}:1===b.length?"div"===c?{div:this.divn(b.words[0]),mod:null}:"mod"===c?{div:null,mod:new a(this.modn(b.words[0]))}:{div:this.divn(b.words[0]),mod:new a(this.modn(b.words[0]))}:this._wordDiv(b,c)},a.prototype.div=function(a){return this.divmod(a,"div",!1).div},a.prototype.mod=function(a){return this.divmod(a,"mod",!1).mod},a.prototype.umod=function(a){return this.divmod(a,"mod",!0).mod},a.prototype.divRound=function(b){var a=this.divmod(b);if(a.mod.isZero())return a.div;var d=0!==a.div.negative?a.mod.isub(b):a.mod,e=b.ushrn(1),f=b.andln(1),c=d.cmp(e);return c<0||1===f&&0===c?a.div:0!==a.div.negative?a.div.isubn(1):a.div.iaddn(1)},a.prototype.modn=function(a){p(a<=67108863);for(var d=67108864%a,b=0,c=this.length-1;c>=0;c--)b=(d*b+(0|this.words[c]))%a;return b},a.prototype.idivn=function(b){p(b<=67108863);for(var c=0,a=this.length-1;a>=0;a--){var d=(0|this.words[a])+67108864*c;this.words[a]=d/b|0,c=d%b}return this.strip()},a.prototype.divn=function(a){return this.clone().idivn(a)},a.prototype.egcd=function(j){p(0===j.negative),p(!j.isZero());var b=this,c=j.clone();b=0!==b.negative?b.umod(j):b.clone();for(var f=new a(1),g=new a(0),d=new a(0),e=new a(1),k=0;b.isEven()&&c.isEven();)b.iushrn(1),c.iushrn(1),++k;for(var l=c.clone(),m=b.clone();!b.isZero();){for(var h=0,n=1;(b.words[0]&n)==0&&h<26;++h,n<<=1);if(h>0)for(b.iushrn(h);h-- >0;)(f.isOdd()||g.isOdd())&&(f.iadd(l),g.isub(m)),f.iushrn(1),g.iushrn(1);for(var i=0,o=1;(c.words[0]&o)==0&&i<26;++i,o<<=1);if(i>0)for(c.iushrn(i);i-- >0;)(d.isOdd()||e.isOdd())&&(d.iadd(l),e.isub(m)),d.iushrn(1),e.iushrn(1);b.cmp(c)>=0?(b.isub(c),f.isub(d),g.isub(e)):(c.isub(b),d.isub(f),e.isub(g))}return{a:d,b:e,gcd:c.iushln(k)}},a.prototype._invmp=function(f){p(0===f.negative),p(!f.isZero());var i,b=this,c=f.clone();b=0!==b.negative?b.umod(f):b.clone();for(var d=new a(1),e=new a(0),j=c.clone();b.cmpn(1)>0&&c.cmpn(1)>0;){for(var g=0,k=1;(b.words[0]&k)==0&&g<26;++g,k<<=1);if(g>0)for(b.iushrn(g);g-- >0;)d.isOdd()&&d.iadd(j),d.iushrn(1);for(var h=0,l=1;(c.words[0]&l)==0&&h<26;++h,l<<=1);if(h>0)for(c.iushrn(h);h-- >0;)e.isOdd()&&e.iadd(j),e.iushrn(1);b.cmp(c)>=0?(b.isub(c),d.isub(e)):(c.isub(b),e.isub(d))}return 0>(i=0===b.cmpn(1)?d:e).cmpn(0)&&i.iadd(f),i},a.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var b=this.clone(),a=c.clone();b.negative=0,a.negative=0;for(var d=0;b.isEven()&&a.isEven();d++)b.iushrn(1),a.iushrn(1);for(;;){for(;b.isEven();)b.iushrn(1);for(;a.isEven();)a.iushrn(1);var e=b.cmp(a);if(e<0){var f=b;b=a,a=f}else if(0===e||0===a.cmpn(1))break;b.isub(a)}return a.iushln(d)},a.prototype.invm=function(a){return this.egcd(a).a.umod(a)},a.prototype.isEven=function(){return(1&this.words[0])==0},a.prototype.isOdd=function(){return(1&this.words[0])==1},a.prototype.andln=function(a){return this.words[0]&a},a.prototype.bincn=function(e){p("number"==typeof e);var f=e%26,c=(e-f)/26,g=1<<f;if(this.length<=c)return this._expand(c+1),this.words[c]|=g,this;for(var a=g,b=c;0!==a&&b<this.length;b++){var d=0|this.words[b];d+=a,a=d>>>26,d&=67108863,this.words[b]=d}return 0!==a&&(this.words[b]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(a){var b,c=a<0;if(0!==this.negative&&!c)return -1;if(0===this.negative&&c)return 1;if(this.strip(),this.length>1)b=1;else{c&&(a=-a),p(a<=67108863,"Number is too big");var d=0|this.words[0];b=d===a?0:d<a?-1:1}return 0!==this.negative?0| -b:b},a.prototype.cmp=function(a){if(0!==this.negative&&0===a.negative)return -1;if(0===this.negative&&0!==a.negative)return 1;var b=this.ucmp(a);return 0!==this.negative?0| -b:b},a.prototype.ucmp=function(b){if(this.length>b.length)return 1;if(this.length<b.length)return -1;for(var c=0,a=this.length-1;a>=0;a--){var d=0|this.words[a],e=0|b.words[a];if(d!==e){d<e?c=-1:d>e&&(c=1);break}}return c},a.prototype.gtn=function(a){return 1===this.cmpn(a)},a.prototype.gt=function(a){return 1===this.cmp(a)},a.prototype.gten=function(a){return this.cmpn(a)>=0},a.prototype.gte=function(a){return this.cmp(a)>=0},a.prototype.ltn=function(a){return -1===this.cmpn(a)},a.prototype.lt=function(a){return -1===this.cmp(a)},a.prototype.lten=function(a){return 0>=this.cmpn(a)},a.prototype.lte=function(a){return 0>=this.cmp(a)},a.prototype.eqn=function(a){return 0===this.cmpn(a)},a.prototype.eq=function(a){return 0===this.cmp(a)},a.red=function(a){return new c(a)},a.prototype.toRed=function(a){return p(!this.red,"Already a number in reduction context"),p(0===this.negative,"red works only with positives"),a.convertTo(this)._forceRed(a)},a.prototype.fromRed=function(){return p(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(a){return this.red=a,this},a.prototype.forceRed=function(a){return p(!this.red,"Already a number in reduction context"),this._forceRed(a)},a.prototype.redAdd=function(a){return p(this.red,"redAdd works only with red numbers"),this.red.add(this,a)},a.prototype.redIAdd=function(a){return p(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,a)},a.prototype.redSub=function(a){return p(this.red,"redSub works only with red numbers"),this.red.sub(this,a)},a.prototype.redISub=function(a){return p(this.red,"redISub works only with red numbers"),this.red.isub(this,a)},a.prototype.redShl=function(a){return p(this.red,"redShl works only with red numbers"),this.red.shl(this,a)},a.prototype.redMul=function(a){return p(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.mul(this,a)},a.prototype.redIMul=function(a){return p(this.red,"redMul works only with red numbers"),this.red._verify2(this,a),this.red.imul(this,a)},a.prototype.redSqr=function(){return p(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return p(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return p(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return p(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return p(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(a){return p(this.red&&!a.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,a)};var z={k256:null,p224:null,p192:null,p25519:null};function e(b,c){this.name=b,this.p=new a(c,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function h(){e.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function n(){e.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function o(){e.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function j(){e.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function c(b){if("string"==typeof b){var c=a._prime(b);this.m=c.p,this.prime=c}else p(b.gtn(1),"modulus must be greater than 1"),this.m=b,this.prime=null}function f(b){c.call(this,b),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}e.prototype._tmp=function(){var b=new a(null);return b.words=new Array(Math.ceil(this.n/13)),b},e.prototype.ireduce=function(d){var b,a=d;do this.split(a,this.tmp),b=(a=(a=this.imulK(a)).iadd(this.tmp)).bitLength();while(b>this.n)var c=b<this.n?-1:a.ucmp(this.p);return 0===c?(a.words[0]=0,a.length=1):c>0?a.isub(this.p):void 0!==a.strip?a.strip():a._strip(),a},e.prototype.split=function(a,b){a.iushrn(this.n,0,b)},e.prototype.imulK=function(a){return a.imul(this.k)},g(h,e),h.prototype.split=function(a,d){for(var e=Math.min(a.length,9),b=0;b<e;b++)d.words[b]=a.words[b];if(d.length=e,a.length<=9){a.words[0]=0,a.length=1;return}var c=a.words[9];for(b=10,d.words[d.length++]=4194303&c;b<a.length;b++){var f=0|a.words[b];a.words[b-10]=(4194303&f)<<4|c>>>22,c=f}c>>>=22,a.words[b-10]=c,0===c&&a.length>10?a.length-=10:a.length-=9},h.prototype.imulK=function(a){a.words[a.length]=0,a.words[a.length+1]=0,a.length+=2;for(var b=0,c=0;c<a.length;c++){var d=0|a.words[c];b+=977*d,a.words[c]=67108863&b,b=64*d+(b/67108864|0)}return 0===a.words[a.length-1]&&(a.length--,0===a.words[a.length-1]&&a.length--),a},g(n,e),g(o,e),g(j,e),j.prototype.imulK=function(a){for(var b=0,c=0;c<a.length;c++){var d=(0|a.words[c])*19+b,e=67108863&d;d>>>=26,a.words[c]=e,b=d}return 0!==b&&(a.words[a.length++]=b),a},a._prime=function(a){var b;if(z[a])return z[a];if("k256"===a)b=new h;else if("p224"===a)b=new n;else if("p192"===a)b=new o;else if("p25519"===a)b=new j;else throw new Error("Unknown prime "+a);return z[a]=b,b},c.prototype._verify1=function(a){p(0===a.negative,"red works only with positives"),p(a.red,"red works only with red numbers")},c.prototype._verify2=function(a,b){p((a.negative|b.negative)==0,"red works only with positives"),p(a.red&&a.red===b.red,"red works only with red numbers")},c.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):a.umod(this.m)._forceRed(this)},c.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},c.prototype.add=function(b,c){this._verify2(b,c);var a=b.add(c);return a.cmp(this.m)>=0&&a.isub(this.m),a._forceRed(this)},c.prototype.iadd=function(b,c){this._verify2(b,c);var a=b.iadd(c);return a.cmp(this.m)>=0&&a.isub(this.m),a},c.prototype.sub=function(b,c){this._verify2(b,c);var a=b.sub(c);return 0>a.cmpn(0)&&a.iadd(this.m),a._forceRed(this)},c.prototype.isub=function(b,c){this._verify2(b,c);var a=b.isub(c);return 0>a.cmpn(0)&&a.iadd(this.m),a},c.prototype.shl=function(a,b){return this._verify1(a),this.imod(a.ushln(b))},c.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},c.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},c.prototype.isqr=function(a){return this.imul(a,a.clone())},c.prototype.sqr=function(a){return this.mul(a,a)},c.prototype.sqrt=function(d){if(d.isZero())return d.clone();var l=this.m.andln(3);if(p(l%2==1),3===l){var q=this.m.add(new a(1)).iushrn(2);return this.pow(d,q)}for(var b=this.m.subn(1),m=0;!b.isZero()&&0===b.andln(1);)m++,b.iushrn(1);p(!b.isZero());var g=new a(1).toRed(this),n=g.redNeg(),r=this.m.subn(1).iushrn(1),c=this.m.bitLength();for(c=new a(2*c*c).toRed(this);0!==this.pow(c,r).cmp(n);)c.redIAdd(n);for(var h=this.pow(c,b),i=this.pow(d,b.addn(1).iushrn(1)),e=this.pow(d,b),j=m;0!==e.cmp(g);){for(var k=e,f=0;0!==k.cmp(g);f++)k=k.redSqr();p(f<j);var o=this.pow(h,new a(1).iushln(j-f-1));i=i.redMul(o),h=o.redSqr(),e=e.redMul(h),j=f}return i},c.prototype.invm=function(b){var a=b._invmp(this.m);return 0!==a.negative?(a.negative=0,this.imod(a).redNeg()):this.imod(a)},c.prototype.pow=function(j,e){if(e.isZero())return new a(1).toRed(this);if(0===e.cmpn(1))return j.clone();var k=4,c=new Array(1<<k);c[0]=new a(1).toRed(this),c[1]=j;for(var b=2;b<c.length;b++)c[b]=this.mul(c[b-1],j);var d=c[0],f=0,g=0,h=e.bitLength()%26;for(0===h&&(h=26),b=e.length-1;b>=0;b--){for(var m=e.words[b],i=h-1;i>=0;i--){var l=m>>i&1;if(d!==c[0]&&(d=this.sqr(d)),0===l&&0===f){g=0;continue}f<<=1,f|=l,g++,(g===k||0===b&&0===i)&&(d=this.mul(d,c[f]),g=0,f=0)}h=26}return d},c.prototype.convertTo=function(b){var a=b.umod(this.m);return a===b?a.clone():a},c.prototype.convertFrom=function(b){var a=b.clone();return a.red=null,a},a.mont=function(a){return new f(a)},g(f,c),f.prototype.convertTo=function(a){return this.imod(a.ushln(this.shift))},f.prototype.convertFrom=function(b){var a=this.imod(b.mul(this.rinv));return a.red=null,a},f.prototype.imul=function(a,d){if(a.isZero()||d.isZero())return a.words[0]=0,a.length=1,a;var e=a.imul(d),f=e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=e.isub(f).iushrn(this.shift),c=b;return b.cmp(this.m)>=0?c=b.isub(this.m):0>b.cmpn(0)&&(c=b.iadd(this.m)),c._forceRed(this)},f.prototype.mul=function(d,e){if(d.isZero()||e.isZero())return new a(0)._forceRed(this);var f=d.mul(e),g=f.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=f.isub(g).iushrn(this.shift),c=b;return b.cmp(this.m)>=0?c=b.isub(this.m):0>b.cmpn(0)&&(c=b.iadd(this.m)),c._forceRed(this)},f.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===a||a,this)},{buffer:2}],34:[function(b,a,c){"use strict";a.exports=function(e){var a,b,c,g=e.length,h=0;for(a=0;a<g;++a)h+=e[a].length;var i=new Array(h),k=0;for(a=0;a<g;++a){var j=e[a],f=j.length;for(b=0;b<f;++b){var d=i[k++]=new Array(f-1),l=0;for(c=0;c<f;++c)c!==b&&(d[l++]=j[c]);if(1&b){var m=d[1];d[1]=d[0],d[0]=m}}}return i}},{}],35:[function(a,b,c){"use strict";b.exports=function(a,b,e){var c;switch(arguments.length){case 1:return d=[],j(c=a,c,k,!0),d;case 2:if("function"==typeof b)return j(a,a,b,!0);return d=[],j(a,b,k,!1),d;case 3:return j(a,b,e,!1);default:throw new Error("box-intersect: Invalid arguments")}};var d,e=a("typedarray-pool"),f=a("./lib/sweep"),g=a("./lib/intersect");function h(b,c){for(var a=0;a<b;++a)if(!(c[a]<=c[a+b]))return!0;return!1}function i(c,d,g,i){for(var j=0,e=0,a=0,k=c.length;a<k;++a){var f=c[a];if(!h(d,f)){for(var b=0;b<2*d;++b)g[j++]=f[b];i[e++]=a}}return e}function j(l,o,m,p){var n,a=l.length,c=o.length;if(!(a<=0)&&!(c<=0)){var b=l[0].length>>>1;if(!(b<=0)){var d=e.mallocDouble(2*b*a),h=e.mallocInt32(a);if((a=i(l,b,d,h))>0){if(1===b&&p)f.init(a),n=f.sweepComplete(b,m,0,a,d,h,0,a,d,h);else{var j=e.mallocDouble(2*b*c),k=e.mallocInt32(c);(c=i(o,b,j,k))>0&&(f.init(a+c),n=1===b?f.sweepBipartite(b,m,0,a,d,h,0,c,j,k):g(b,m,p,a,d,h,c,j,k),e.free(j),e.free(k))}e.free(d),e.free(h)}return n}}}function k(a,b){d.push([a,b])}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(c,d,a){"use strict";function b(a){return a?function(e,f,g,a,b,h,i,c,d,j,k){return b-a>d-c?function(a,c,n,k,o,f,p,l,q,g,r){for(var h=2*a,i=k,d=h*k;i<o;++i,d+=h){var s=f[c+d],t=f[c+d+a],u=p[i];Q:for(var j=l,e=h*l;j<q;++j,e+=h){var v=g[c+e],w=g[c+e+a],x=r[j];if(!(w<s)&&!(t<v)){for(var b=c+1;b<a;++b){var y=f[b+d],z=f[b+a+d],A=g[b+e],B=g[b+a+e];if(z<A||B<y)continue Q}var m=n(u,x);if(void 0!==m)return m}}}}(e,f,g,a,b,h,i,c,d,j,k):function(a,c,n,k,o,f,p,l,q,g,r){for(var h=2*a,i=l,d=h*l;i<q;++i,d+=h){var s=g[c+d],t=g[c+d+a],u=r[i];Q:for(var j=k,e=h*k;j<o;++j,e+=h){var v=f[c+e],w=f[c+e+a],x=p[j];if(!(t<v)&&!(w<s)){for(var b=c+1;b<a;++b){var y=f[b+e],z=f[b+a+e],A=g[b+d],B=g[b+a+d];if(z<A||B<y)continue Q}var m=n(x,u);if(void 0!==m)return m}}}}(e,f,g,a,b,h,i,c,d,j,k)}:function(e,f,g,l,a,b,h,i,c,d,j,k){return b-a>d-c?l?function(b,d,o,k,p,e,q,l,r,h,s){for(var f=2*b,i=k,c=f*k;i<p;++i,c+=f){var t=e[d+c],u=e[d+c+b],v=q[i];Q:for(var j=l,g=f*l;j<r;++j,g+=f){var m=h[d+g],w=s[j];if(!(m<=t)&&!(u<m)){for(var a=d+1;a<b;++a){var x=e[a+c],y=e[a+b+c],z=h[a+g],A=h[a+b+g];if(y<z||A<x)continue Q}var n=o(w,v);if(void 0!==n)return n}}}}(e,f,g,a,b,h,i,c,d,j,k):function(b,d,o,k,p,e,q,l,r,h,s){for(var f=2*b,i=k,c=f*k;i<p;++i,c+=f){var t=e[d+c],u=e[d+c+b],v=q[i];Q:for(var j=l,g=f*l;j<r;++j,g+=f){var m=h[d+g],w=s[j];if(!(m<t)&&!(u<m)){for(var a=d+1;a<b;++a){var x=e[a+c],y=e[a+b+c],z=h[a+g],A=h[a+b+g];if(y<z||A<x)continue Q}var n=o(v,w);if(void 0!==n)return n}}}}(e,f,g,a,b,h,i,c,d,j,k):l?function(b,d,o,k,p,e,q,l,r,h,s){for(var f=2*b,i=l,g=f*l;i<r;++i,g+=f){var m=h[d+g],t=s[i];Q:for(var j=k,c=f*k;j<p;++j,c+=f){var u=e[d+c],v=e[d+c+b],w=q[j];if(!(m<=u)&&!(v<m)){for(var a=d+1;a<b;++a){var x=e[a+c],y=e[a+b+c],z=h[a+g],A=h[a+b+g];if(y<z||A<x)continue Q}var n=o(t,w);if(void 0!==n)return n}}}}(e,f,g,a,b,h,i,c,d,j,k):function(b,d,o,k,p,e,q,l,r,h,s){for(var f=2*b,i=l,g=f*l;i<r;++i,g+=f){var m=h[d+g],t=s[i];Q:for(var j=k,c=f*k;j<p;++j,c+=f){var u=e[d+c],v=e[d+c+b],w=q[j];if(!(m<u)&&!(v<m)){for(var a=d+1;a<b;++a){var x=e[a+c],y=e[a+b+c],z=h[a+g],A=h[a+b+g];if(y<z||A<x)continue Q}var n=o(w,t);if(void 0!==n)return n}}}}(e,f,g,a,b,h,i,c,d,j,k)}}a.partial=b(!1),a.full=b(!0)},{}],37:[function(a,e,f){"use strict";e.exports=function(a,G,U,P,V,W,Q,X,Y){_=a,aa=P+Q,ab=8*g.log2(aa+1)*(_+1)|0,ac=g.nextPow2(6*ab),r.length<ac&&(c.free(r),r=c.mallocInt32(ac)),ad=g.nextPow2(2*ab),s.length<ad&&(c.free(s),s=c.mallocDouble(ad));var B=0,$=2*a;for(t(B++,0,0,P,0,Q,U?16:0,-1/0,1/0),U||t(B++,0,0,Q,0,P,1,-1/0,1/0);B>0;){var L=6*(B-=1),b=r[L],y=r[L+1],x=r[L+2],H=r[L+3],D=r[L+4],N=r[L+5],Z=2*B,R=s[Z],S=s[Z+1],E=1&N,M=!!(16&N),e=V,f=W,z=X,A=Y;if(E&&(e=X,f=Y,z=V,A=W),(!(2&N)||(x=n(a,b,y,x,e,f,S),!(y>=x)))&&!(4&N&&(y=o(a,b,y,x,e,f,R))>=x)){var O=x-y,T=D-H;if(M){if(a*O*(O+T)<4194304){if(void 0!==(J=j.scanComplete(a,b,G,y,x,e,f,H,D,z,A)))return J;continue}}else{if(a*Math.min(O,T)<128){if(void 0!==(J=h(a,b,G,E,y,x,e,f,H,D,z,A)))return J;continue}if(a*O*T<4194304){if(void 0!==(J=j.scanBipartite(a,b,G,E,y,x,e,f,H,D,z,A)))return J;continue}}var d=l(a,b,y,x,e,f,R,S);if(y<d)if(a*(d-y)<128){if(void 0!==(J=i(a,b+1,G,y,d,e,f,H,D,z,A)))return J}else if(b===a-2){if(void 0!==(J=E?j.sweepBipartite(a,G,H,D,z,A,y,d,e,f):j.sweepBipartite(a,G,y,d,e,f,H,D,z,A)))return J}else t(B++,b+1,y,d,H,D,E,-1/0,1/0),t(B++,b+1,H,D,y,d,1^E,-1/0,1/0);if(d<x){var _,aa,ab,ac,ad,J,C,w=k(a,b,H,D,z,A),K=z[$*w+b],F=m(a,b,w,D,z,A,K);if(F<D&&t(B++,b,d,x,F,D,(4|E)+(M?16:0),K,S),H<w&&t(B++,b,d,x,H,w,(2|E)+(M?16:0),R,K),w+1===F){if(void 0!==(J=M?v(a,b,G,d,x,e,f,w,z,A[w]):u(a,b,G,E,d,x,e,f,w,z,A[w])))return J}else if(w<F)if(M){if(C=p(a,b,d,x,e,f,K),d<C){var I=m(a,b,d,C,e,f,K);if(b===a-2){if(d<I&& void 0!==(J=j.sweepComplete(a,G,d,I,e,f,w,F,z,A)))return J;if(I<C&& void 0!==(J=j.sweepBipartite(a,G,I,C,e,f,w,F,z,A)))return J}else d<I&&t(B++,b+1,d,I,w,F,16,-1/0,1/0),I<C&&(t(B++,b+1,I,C,w,F,0,-1/0,1/0),t(B++,b+1,w,F,I,C,1,-1/0,1/0))}}else C=E?q(a,b,d,x,e,f,K):p(a,b,d,x,e,f,K),d<C&&(b===a-2?J=E?j.sweepBipartite(a,G,w,F,z,A,d,C,e,f):j.sweepBipartite(a,G,d,C,e,f,w,F,z,A):(t(B++,b+1,d,C,w,F,E,-1/0,1/0),t(B++,b+1,w,F,d,C,1^E,-1/0,1/0)))}}}};var c=a("typedarray-pool"),g=a("bit-twiddle"),d=a("./brute"),h=d.partial,i=d.full,j=a("./sweep"),k=a("./median"),b=a("./partition"),l=b("!(lo>=p0)&&!(p1>=hi)"),m=b("lo===p0"),n=b("lo<p0"),o=b("hi<=p0"),p=b("lo<=p0&&p0<=hi"),q=b("lo<p0&&p0<=hi"),r=c.mallocInt32(1024),s=c.mallocDouble(1024);function t(b,d,e,f,g,h,i,j,k){var a=6*b;r[a]=d,r[a+1]=e,r[a+2]=f,r[a+3]=g,r[a+4]=h,r[a+5]=i;var c=2*b;s[c]=j,s[c+1]=k}function u(b,d,m,n,o,s,e,t,u,g,p){var h=2*b,i=u*h,j=g[i+d];red_loop:for(var k=o,c=o*h;k<s;++k,c+=h){var q,f=e[c+d],l=e[c+d+b];if(!(j<f)&&!(l<j)&&(!n||j!==f)){for(var r=t[k],a=d+1;a<b;++a){var f=e[c+a],l=e[c+a+b],v=g[i+a],w=g[i+a+b];if(l<v||w<f)continue red_loop}if(void 0!==(q=n?m(p,r):m(r,p)))return q}}}function v(b,d,q,l,r,e,s,t,f,m){var g=2*b,h=t*g,n=f[h+d];red_loop:for(var i=l,c=l*g;i<r;++i,c+=g){var o=s[i];if(o!==m){var j=e[c+d],k=e[c+d+b];if(!(n<j)&&!(k<n)){for(var a=d+1;a<b;++a){var j=e[c+a],k=e[c+a+b],u=f[h+a],v=f[h+a+b];if(k<u||v<j)continue red_loop}var p=q(o,m);if(void 0!==p)return p}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(a,b,c){"use strict";b.exports=function(s,h,o,t,a,i){if(t<=o+1)return o;for(var g=o,b=t,k=t+o>>>1,f=2*s,c=k,j=a[f*k+h];g<b;){if(b-g<8){e(s,h,g,b,a,i),j=a[f*k+h];break}var u=b-g,v=Math.random()*u+g|0,p=a[f*v+h],w=Math.random()*u+g|0,q=a[f*w+h],x=Math.random()*u+g|0,n=a[f*x+h];p<=q?n>=q?(c=w,j=q):p>=n?(c=v,j=p):(c=x,j=n):q>=n?(c=w,j=q):n>=p?(c=v,j=p):(c=x,j=n);for(var l=f*(b-1),m=f*c,r=0;r<f;++r,++l,++m){var y=a[l];a[l]=a[m],a[m]=y}var z=i[b-1];i[b-1]=i[c],i[c]=z,c=d(s,h,g,b-1,a,i,j);for(var l=f*(b-1),m=f*c,r=0;r<f;++r,++l,++m){var y=a[l];a[l]=a[m],a[m]=y}var z=i[b-1];if(i[b-1]=i[c],i[c]=z,k<c){for(b=c-1;g<b&&a[f*(b-1)+h]===j;)b-=1;b+=1}else if(c<k)for(g=c+1;g<b&&a[f*g+h]===j;)g+=1;else break}return d(s,h,o,k,a,i,a[f*k+h])};var d=a("./partition")("lo<p0");function e(m,j,g,n,a,d){for(var b=2*m,k=b*(g+1)+j,e=g+1;e<n;++e,k+=b)for(var o=a[k],c=e,f=b*(e-1);c>g&&a[f+j]>o;--c,f-=b){for(var h=f,i=f+b,l=0;l<b;++l,++h,++i){var p=a[h];a[h]=a[i],a[i]=p}var q=d[c];d[c]=d[c-1],d[c-1]=q}}},{"./partition":39}],39:[function(b,a,c){"use strict";a.exports=function(a){return d[a]};var d={"lo===p0":function(j,k,h,l,a,e,m){for(var f=2*j,b=f*h,i=b,c=h,n=k,q=j+k,d=h;l>d;++d,b+=f)if(a[b+n]===m)if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var o=a[b+g];a[b+g]=a[i],a[i++]=o}var p=e[d];e[d]=e[c],e[c++]=p}return c},"lo<p0":function(j,k,h,l,a,e,m){for(var f=2*j,b=f*h,i=b,c=h,n=k,q=j+k,d=h;l>d;++d,b+=f)if(a[b+n]<m)if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var o=a[b+g];a[b+g]=a[i],a[i++]=o}var p=e[d];e[d]=e[c],e[c++]=p}return c},"lo<=p0":function(j,k,h,l,a,e,m){for(var f=2*j,b=f*h,i=b,c=h,q=k,n=j+k,d=h;l>d;++d,b+=f)if(a[b+n]<=m)if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var o=a[b+g];a[b+g]=a[i],a[i++]=o}var p=e[d];e[d]=e[c],e[c++]=p}return c},"hi<=p0":function(j,k,h,l,a,e,m){for(var f=2*j,b=f*h,i=b,c=h,q=k,n=j+k,d=h;l>d;++d,b+=f)if(a[b+n]<=m)if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var o=a[b+g];a[b+g]=a[i],a[i++]=o}var p=e[d];e[d]=e[c],e[c++]=p}return c},"lo<p0&&p0<=hi":function(j,k,h,m,a,e,l){for(var f=2*j,b=f*h,i=b,c=h,n=k,o=j+k,d=h;m>d;++d,b+=f){var p=a[b+n],q=a[b+o];if(p<l&&l<=q)if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var r=a[b+g];a[b+g]=a[i],a[i++]=r}var s=e[d];e[d]=e[c],e[c++]=s}}return c},"lo<=p0&&p0<=hi":function(j,k,h,m,a,e,l){for(var f=2*j,b=f*h,i=b,c=h,n=k,o=j+k,d=h;m>d;++d,b+=f){var p=a[b+n],q=a[b+o];if(p<=l&&l<=q)if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var r=a[b+g];a[b+g]=a[i],a[i++]=r}var s=e[d];e[d]=e[c],e[c++]=s}}return c},"!(lo>=p0)&&!(p1>=hi)":function(j,k,h,l,a,e,m,n){for(var f=2*j,b=f*h,i=b,c=h,o=k,p=j+k,d=h;l>d;++d,b+=f){var q=a[b+o],r=a[b+p];if(!(q>=m)&&!(n>=r))if(c===d)c+=1,i+=f;else{for(var g=0;f>g;++g){var s=a[b+g];a[b+g]=a[i],a[i++]=s}var t=e[d];e[d]=e[c],e[c++]=t}}return c}}},{}],40:[function(b,a,c){"use strict";function d(c,j,a){for(var d=2*(c+1),e=c+1;e<=j;++e){for(var f=a[d++],h=a[d++],k=e,b=d-2;(k--)>c;){var g=a[b-2],i=a[b-1];if(g<f)break;if(g===f&&i<h)break;a[b]=g,a[b+1]=i,b-=2}a[b]=f,a[b+1]=h}}function e(c,b,a){b*=2;var d=a[c*=2],e=a[c+1];a[c]=a[b],a[c+1]=a[b+1],a[b]=d,a[b+1]=e}function f(c,b,a){b*=2,a[c*=2]=a[b],a[c+1]=a[b+1]}function g(d,b,c,a){b*=2,c*=2;var e=a[d*=2],f=a[d+1];a[d]=a[b],a[d+1]=a[b+1],a[b]=a[c],a[b+1]=a[c+1],a[c]=e,a[c+1]=f}function h(c,b,d,e,a){b*=2,a[c*=2]=a[b],a[b]=d,a[c+1]=a[b+1],a[b+1]=e}function i(c,b,a){b*=2;var d=a[c*=2],e=a[b];return!(d<e)&&(d!==e||a[c+1]>a[b+1])}function j(a,b,e,c){var d=c[a*=2];return d<b||d===b&&c[a+1]<e}function k(r,s,a){var v=(s-r+1)/6|0,B=r+v,C=s-v,w=r+s>>1,D=w-v,E=w+v,p=B,l=D,n=w,m=E,q=C,o=r+1,c=s-1,b=0;i(p,l,a)&&(b=p,p=l,l=b),i(m,q,a)&&(b=m,m=q,q=b),i(p,n,a)&&(b=p,p=n,n=b),i(l,n,a)&&(b=l,l=n,n=b),i(p,m,a)&&(b=p,p=m,m=b),i(n,m,a)&&(b=n,n=m,m=b),i(l,q,a)&&(b=l,l=q,q=b),i(l,n,a)&&(b=l,l=n,n=b),i(m,q,a)&&(b=m,m=q,q=b);for(var x=a[2*l],y=a[2*l+1],z=a[2*m],A=a[2*m+1],F=2*p,G=2*n,H=2*q,I=2*B,J=2*w,K=2*C,u=0;u<2;++u){var L=a[F+u],M=a[G+u],N=a[H+u];a[I+u]=L,a[J+u]=M,a[K+u]=N}f(D,r,a),f(E,s,a);for(var t=o;t<=c;++t)if(j(t,x,y,a))t!==o&&e(t,o,a),++o;else if(!j(t,z,A,a))for(;;){if(j(c,z,A,a)){j(c,x,y,a)?(g(t,o,c,a),++o,--c):(e(t,c,a),--c);break}if(--c<t)break}h(r,o-1,x,y,a),h(s,c+1,z,A,a),o-2-r<=32?d(r,o-2,a):k(r,o-2,a),s-(c+2)<=32?d(c+2,s,a):k(c+2,s,a),c-o<=32?d(o,c,a):k(o,c,a)}a.exports=function(b,a){a<=128?d(0,a-1,b):k(0,a-1,b)}},{}],41:[function(b,c,d){"use strict";c.exports={init:function(d){var b=e.nextPow2(d);h.length<b&&(a.free(h),h=a.mallocInt32(b)),i.length<b&&(a.free(i),i=a.mallocInt32(b)),j.length<b&&(a.free(j),j=a.mallocInt32(b)),k.length<b&&(a.free(k),k=a.mallocInt32(b)),l.length<b&&(a.free(l),l=a.mallocInt32(b)),m.length<b&&(a.free(m),m=a.mallocInt32(b));var c=8*b;n.length<c&&(a.free(n),n=a.mallocDouble(c))},sweepBipartite:function(s,t,B,C,u,D,E,F,v,G){for(var c=0,m=2*s,w=s-1,x=m-1,b=B;b<C;++b){var e=D[b],y=m*b;n[c++]=u[y+w],n[c++]=-(e+1),n[c++]=u[y+x],n[c++]=e}for(var b=E;b<F;++b){var e=G[b]+g,z=m*b;n[c++]=v[z+w],n[c++]=-e,n[c++]=v[z+x],n[c++]=e}var A=c>>>1;f(n,A);for(var q=0,r=0,b=0;b<A;++b){var a=0|n[2*b+1];if(a>=g)a=a-g|0,o(j,k,r--,a);else if(a>=0)o(h,i,q--,a);else if(a<= -g){a=-a-g|0;for(var d=0;d<q;++d){var l=t(h[d],a);if(void 0!==l)return l}p(j,k,r++,a)}else{a=-a-1|0;for(var d=0;d<r;++d){var l=t(a,j[d]);if(void 0!==l)return l}p(h,i,q++,a)}}},sweepComplete:function(y,s,F,G,z,H,I,J,A,K){for(var d=0,t=2*y,B=y-1,C=t-1,a=F;a<G;++a){var q=H[a]+1<<1,D=t*a;n[d++]=z[D+B],n[d++]=-q,n[d++]=z[D+C],n[d++]=q}for(var a=I;a<J;++a){var q=K[a]+1<<1,E=t*a;n[d++]=A[E+B],n[d++]=1| -q,n[d++]=A[E+C],n[d++]=1|q}var u=d>>>1;f(n,u);for(var v=0,w=0,x=0,a=0;a<u;++a){var r=0|n[2*a+1],e=1&r;if(a<u-1&&r>>1==n[2*a+3]>>1&&(e=2,a+=1),r<0){for(var c=-(r>>1)-1,b=0;b<x;++b){var g=s(l[b],c);if(void 0!==g)return g}if(0!==e)for(var b=0;b<v;++b){var g=s(h[b],c);if(void 0!==g)return g}if(1!==e)for(var b=0;b<w;++b){var g=s(j[b],c);if(void 0!==g)return g}0===e?p(h,i,v++,c):1===e?p(j,k,w++,c):2===e&&p(l,m,x++,c)}else{var c=(r>>1)-1;0===e?o(h,i,v--,c):1===e?o(j,k,w--,c):2===e&&o(l,m,x--,c)}}},scanBipartite:function(c,d,y,m,H,I,j,J,K,L,l,M){var e=0,q=2*c,z=d,N=d+c,t=1,A=1;m?A=g:t=g;for(var a=H;a<I;++a){var b=a+t,B=q*a;n[e++]=j[B+z],n[e++]=-b,n[e++]=j[B+N],n[e++]=b}for(var a=K;a<L;++a){var b=a+A,O=q*a;n[e++]=l[O+z],n[e++]=-b}var C=e>>>1;f(n,C);for(var u=0,a=0;a<C;++a){var v=0|n[2*a+1];if(v<0){var b=-v,w=!1;if(b>=g?(w=!m,b-=g):(w=!!m,b-=1),w)p(h,i,u++,b);else{var D=M[b],r=q*b,P=l[r+d+1],Q=l[r+d+1+c];red_loop:for(var x=0;x<u;++x){var E,F=h[x],s=q*F;if(!(Q<j[s+d+1])&&!(j[s+d+1+c]<P)){for(var k=d+2;k<c;++k)if(l[r+k+c]<j[s+k]||j[s+k+c]<l[r+k])continue red_loop;var G=J[F];if(void 0!==(E=m?y(D,G):y(G,D)))return E}}}}else o(h,i,u--,v-t)}},scanComplete:function(e,i,z,A,B,k,C,D,E,l,F){for(var j=0,o=2*e,s=i,G=i+e,a=A;a<B;++a){var b=a+g,t=o*a;n[j++]=k[t+s],n[j++]=-b,n[j++]=k[t+G],n[j++]=b}for(var a=D;a<E;++a){var b=a+1,H=o*a;n[j++]=l[H+s],n[j++]=-b}var u=j>>>1;f(n,u);for(var m=0,a=0;a<u;++a){var r=0|n[2*a+1];if(r<0){var b=-r;if(b>=g)h[m++]=b-g;else{var v=F[b-=1],p=o*b,I=l[p+i+1],J=l[p+i+1+e];red_loop:for(var d=0;d<m;++d){var w=h[d],x=C[w];if(x===v)break;var q=o*w;if(!(J<k[q+i+1])&&!(k[q+i+1+e]<I)){for(var c=i+2;c<e;++c)if(l[p+c+e]<k[q+c]||k[q+c+e]<l[p+c])continue red_loop;var y=z(x,v);if(void 0!==y)return y}}}}else{for(var b=r-g,d=m-1;d>=0;--d)if(h[d]===b){for(var c=d+1;c<m;++c)h[c-1]=h[c];break}--m}}}};var a=b("typedarray-pool"),e=b("bit-twiddle"),f=b("./sort"),g=268435456,h=a.mallocInt32(1024),i=a.mallocInt32(1024),j=a.mallocInt32(1024),k=a.mallocInt32(1024),l=a.mallocInt32(1024),m=a.mallocInt32(1024),n=a.mallocDouble(8192);function o(a,b,e,f){var c=b[f],d=a[e-1];a[c]=d,b[d]=c}function p(c,d,a,b){c[a]=b,d[b]=a}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(a,b,c){"use strict";var d=a("./lib/monotone"),e=a("./lib/triangulation"),f=a("./lib/delaunay"),g=a("./lib/filter");function h(a){return[Math.min(a[0],a[1]),Math.max(a[0],a[1])]}function i(a,b){return a[0]-b[0]||a[1]-b[1]}function j(a,b,c){return b in a?a[b]:c}b.exports=function(k,a,b){Array.isArray(a)?(b=b||{},a=a||[]):(b=a||{},a=[]);var r=!!j(b,"delaunay",!0),m=!!j(b,"interior",!0),n=!!j(b,"exterior",!0),l=!!j(b,"infinity",!1);if(!m&&!n||0===k.length)return[];var o=d(k,a);if(!r&&m===n&&!l)return o;for(var c=e(k.length,a.map(h).sort(i)),p=0;p<o.length;++p){var q=o[p];c.addTriangle(q[0],q[1],q[2])}return(r&&f(k,c),n)?m?l?g(c,0,l):c.cells():g(c,1,l):g(c,-1)}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(a,b,c){"use strict";var d=a("robust-in-sphere")[4];function e(c,h,i,a,b,f){var e=h.opposite(a,b);if(!(e<0)){if(b<a){var g=a;a=b,b=g,g=f,f=e,e=g}!h.isConstraint(a,b)&&0>d(c[a],c[b],c[f],c[e])&&i.push(a,b)}}a("binary-search-bounds"),b.exports=function(a,j){for(var i=[],q=a.length,n=j.stars,b=0;b<q;++b)for(var g=n[b],k=1;k<g.length;k+=2){var c=g[k];if(!(c<b)&&!j.isConstraint(b,c)){for(var h=g[k-1],f=-1,l=1;l<g.length;l+=2)if(g[l-1]===c){f=g[l];break}!(f<0)&&0>d(a[b],a[c],a[h],a[f])&&i.push(b,c)}}for(;i.length>0;){for(var c=i.pop(),b=i.pop(),h=-1,f=-1,g=n[b],m=1;m<g.length;m+=2){var o=g[m-1],p=g[m];o===c?f=p:p===c&&(h=o)}h<0||f<0||d(a[b],a[c],a[h],a[f])>=0||(j.flip(b,c),e(a,j,i,h,b,f),e(a,j,i,b,f,h),e(a,j,i,f,c,h),e(a,j,i,c,h,f))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(a,b,f){"use strict";var c,g=a("binary-search-bounds");function d(a,b,c,d,e,f,g){this.cells=a,this.neighbor=b,this.flags=d,this.constraint=c,this.active=e,this.next=f,this.boundary=g}b.exports=function(o,l,k){var a=function(l,n){for(var g=l.cells(),i=g.length,a=0;a<i;++a){var b=g[a],c=b[0],e=b[1],j=b[2];e<j?e<c&&(b[0]=e,b[1]=j,b[2]=c):j<c&&(b[0]=j,b[1]=c,b[2]=e)}g.sort(h);for(var k=new Array(i),a=0;a<k.length;++a)k[a]=0;var o=[],p=[],q=new Array(3*i),r=new Array(3*i),m=null;n&&(m=[]);for(var s=new d(g,q,r,k,o,p,m),a=0;a<i;++a)for(var b=g[a],f=0;f<3;++f){var c=b[f],e=b[(f+1)%3],t=q[3*a+f]=s.locate(e,c,l.opposite(e,c)),u=r[3*a+f]=l.isConstraint(c,e);t<0&&(u?p.push(a):(o.push(a),k[a]=1),n&&m.push([e,c,-1]))}return s}(o,k);if(0===l)return k?a.cells.concat(a.boundary):a.cells;for(var c=1,b=a.active,e=a.next,f=a.flags,m=a.cells,p=a.constraint,q=a.neighbor;b.length>0||e.length>0;){for(;b.length>0;){var g=b.pop();if(f[g]!== -c){f[g]=c,m[g];for(var j=0;j<3;++j){var i=q[3*g+j];i>=0&&0===f[i]&&(p[3*g+j]?e.push(i):(b.push(i),f[i]=c))}}}var r=e;e=b,b=r,e.length=0,c=-c}var n=function(a,d,e){for(var c=0,b=0;b<a.length;++b)d[b]===e&&(a[c++]=a[b]);return a.length=c,a}(m,f,l);return k?n.concat(a.boundary):n};var e=d.prototype;function h(a,b){return a[0]-b[0]||a[1]-b[1]||a[2]-b[2]}e.locate=(c=[0,0,0],function(a,b,d){var e=a,f=b,i=d;return(b<d?b<a&&(e=b,f=d,i=a):d<a&&(e=d,f=a,i=b),e<0)?-1:(c[0]=e,c[1]=f,c[2]=i,g.eq(this.cells,c,h))})},{"binary-search-bounds":31}],45:[function(a,b,c){"use strict";var d=a("binary-search-bounds"),e=a("robust-orientation")[3];function f(a,b,c,d,e){this.a=a,this.b=b,this.idx=c,this.lowerIds=d,this.upperIds=e}function g(a,b,c,d){this.a=a,this.b=b,this.type=c,this.idx=d}function h(a,b){var c=a.a[0]-b.a[0]||a.a[1]-b.a[1]||a.type-b.type;return c||(0!==a.type&&(c=e(a.a,a.b,b.b))?c:a.idx-b.idx)}function i(a,b){return e(a.a,a.b,b)}function j(l,j,f,g,h){for(var n=d.lt(j,g,i),o=d.gt(j,g,i),k=n;k<o;++k){for(var m=j[k],b=m.lowerIds,a=b.length;a>1&&e(f[b[a-2]],f[b[a-1]],g)>0;)l.push([b[a-1],b[a-2],h]),a-=1;b.length=a,b.push(h);for(var c=m.upperIds,a=c.length;a>1&&0>e(f[c[a-2]],f[c[a-1]],g);)l.push([c[a-2],c[a-1],h]),a-=1;c.length=a,c.push(h)}}function k(a,b){var c;return(c=a.a[0]<b.a[0]?e(a.a,a.b,b.a):e(b.b,b.a,a.a))?c:(c=b.b[0]<a.b[0]?e(a.a,a.b,b.b):e(b.b,b.a,a.b))||a.idx-b.idx}function l(b,i,a){var e=d.le(b,a,k),g=b[e],c=g.upperIds,h=c[c.length-1];g.upperIds=[h],b.splice(e+1,0,new f(a.a,a.b,a.idx,[h],c))}function m(b,h,a){var e=a.a;a.a=a.b,a.b=e;var c=d.eq(b,a,k),f=b[c],g=b[c-1];g.upperIds=f.upperIds,b.splice(c,1)}b.exports=function(c,n){for(var s=c.length,t=n.length,b=[],a=0;a<s;++a)b.push(new g(c[a],null,0,a));for(var a=0;a<t;++a){var o=n[a],d=c[o[0]],e=c[o[1]];d[0]<e[0]?b.push(new g(d,e,2,a),new g(e,d,1,a)):d[0]>e[0]&&b.push(new g(e,d,2,a),new g(d,e,1,a))}b.sort(h);for(var p=b[0].a[0]-(1+Math.abs(b[0].a[0]))*2220446049250313e-31,k=[new f([p,1],[p,0],-1,[],[],[],[])],q=[],a=0,u=b.length;a<u;++a){var i=b[a],r=i.type;0===r?j(q,k,c,i.a,i.idx):2===r?l(k,c,i):m(k,c,i)}return q}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(b,c,e){"use strict";var f=b("binary-search-bounds");function d(a,b){this.stars=a,this.edges=b}c.exports=function(b,e){for(var c=new Array(b),a=0;a<b;++a)c[a]=[];return new d(c,e)};var a=d.prototype;function g(a,d,e){for(var b=1,c=a.length;b<c;b+=2)if(a[b-1]===d&&a[b]===e){a[b-1]=a[c-2],a[b]=a[c-1],a.length=c-2;return}}a.isConstraint=function(){var a=[0,0];function b(a,b){return a[0]-b[0]||a[1]-b[1]}return function(c,d){return a[0]=Math.min(c,d),a[1]=Math.max(c,d),f.eq(this.edges,a,b)>=0}}(),a.removeTriangle=function(a,b,c){var d=this.stars;g(d[a],b,c),g(d[b],c,a),g(d[c],a,b)},a.addTriangle=function(a,b,c){var d=this.stars;d[a].push(b,c),d[b].push(c,a),d[c].push(a,b)},a.opposite=function(c,d){for(var b=this.stars[d],a=1,e=b.length;a<e;a+=2)if(b[a]===c)return b[a-1];return -1},a.flip=function(a,b){var c=this.opposite(a,b),d=this.opposite(b,a);this.removeTriangle(a,b,c),this.removeTriangle(b,a,d),this.addTriangle(a,d,c),this.addTriangle(b,c,d)},a.edges=function(){for(var d=this.stars,e=[],b=0,f=d.length;b<f;++b)for(var c=d[b],a=0,g=c.length;a<g;a+=2)e.push([c[a],c[a+1]]);return e},a.cells=function(){for(var d=this.stars,e=[],a=0,h=d.length;a<h;++a)for(var c=d[a],b=0,i=c.length;b<i;b+=2){var f=c[b],g=c[b+1];a<Math.min(f,g)&&e.push([a,f,g])}return e}},{"binary-search-bounds":31}],47:[function(b,a,c){"use strict";a.exports=function(a){for(var d=1,b=1;b<a.length;++b)for(var c=0;c<b;++c)if(a[b]<a[c])d=-d;else if(a[c]===a[b])return 0;return d}},{}],48:[function(a,c,e){"use strict";var f=a("dup"),g=a("robust-linear-solve");function h(b,d){for(var c=0,e=b.length,a=0;a<e;++a)c+=b[a]*d[a];return c}function d(b){var d=b.length;if(0===d)return[];b[0].length;var i=f([b.length+1,b.length+1],1),j=f([b.length+1],1);i[d][d]=0;for(var a=0;a<d;++a){for(var c=0;c<=a;++c)i[c][a]=i[a][c]=2*h(b[a],b[c]);j[a]=h(b[a],b[a])}for(var k=g(i,j),l=0,e=k[d+1],a=0;a<e.length;++a)l+=e[a];for(var m=new Array(d),a=0;a<d;++a){for(var e=k[a],n=0,c=0;c<e.length;++c)n+=e[c];m[a]=n/l}return m}function b(a){if(0===a.length)return[];for(var e=a[0].length,g=f([e]),h=d(a),b=0;b<a.length;++b)for(var c=0;c<e;++c)g[c]+=a[b][c]*h[b];return g}b.barycenetric=d,c.exports=b},{dup:65,"robust-linear-solve":283}],49:[function(a,b,c){b.exports=function(a){for(var e=d(a),f=0,c=0;c<a.length;++c)for(var g=a[c],b=0;b<e.length;++b)f+=Math.pow(g[b]-e[b],2);return Math.sqrt(f/a.length)};var d=a("circumcenter")},{circumcenter:48}],50:[function(a,b,c){"use strict";b.exports=function(g,a,c){if(c){h=a;for(var h,i=new Array(a.length),b=0;b<a.length;++b){var d=a[b];i[b]=[d[0],d[1],c[b]]}a=i}for(var e,j,k,l,f=(e=g,j=a,k=!!c,r(j,l=o(e,[],n(e)),k),!!l);s(g,a,!!c);)f=!0;if(c&&f){h.length=0,c.length=0;for(var b=0;b<a.length;++b){var d=a[b];h.push([d[0],d[1]]),c.push(d[2])}}return f};var d=a("union-find"),e=a("box-intersect"),f=a("robust-segment-intersect"),g=a("big-rat"),h=a("big-rat/cmp"),i=a("big-rat/to-float"),j=a("rat-vec"),k=a("nextafter"),l=a("./lib/rat-seg-intersect");function m(b){var a=i(b);return[k(a,-1/0),k(a,1/0)]}function n(c){for(var d=new Array(c.length),a=0;a<c.length;++a){var b=c[a];d[a]=[k(b[0],-1/0),k(b[1],-1/0),k(b[0],1/0),k(b[1],1/0)]}return d}function o(b,h,r){for(var g=h.length,i=new d(g),l=[],a=0;a<h.length;++a){var n=h[a],o=m(n[0]),p=m(n[1]);l.push([k(o[0],-1/0),k(p[0],-1/0),k(o[1],1/0),k(p[1],1/0)])}e(l,function(a,b){i.link(a,b)});for(var q=!0,c=new Array(g),a=0;a<g;++a){var f=i.find(a);f!==a&&(q=!1,b[f]=[Math.min(b[a][0],b[f][0]),Math.min(b[a][1],b[f][1])])}if(q)return null;for(var j=0,a=0;a<g;++a){var f=i.find(a);f===a?(c[a]=j,b[j++]=b[a]):c[a]=-1}b.length=j;for(var a=0;a<g;++a)c[a]<0&&(c[a]=c[i.find(a)]);return c}function p(a,b){return a[0]-b[0]||a[1]-b[1]}function q(a,b){return a[0]-b[0]||a[1]-b[1]||(a[2]<b[2]?-1:a[2]>b[2]?1:0)}function r(a,g,i){if(0!==a.length){if(g)for(var b=0;b<a.length;++b){var c=a[b],d=g[c[0]],e=g[c[1]];c[0]=Math.min(d,e),c[1]=Math.max(d,e)}else for(var b=0;b<a.length;++b){var c=a[b],d=c[0],e=c[1];c[0]=Math.min(d,e),c[1]=Math.max(d,e)}i?a.sort(q):a.sort(p);for(var j=1,b=1;b<a.length;++b){var h=a[b-1],f=a[b];(f[0]!==h[0]||f[1]!==h[1]||i&&f[2]!==h[2])&&(a[j++]=f)}a.length=j}}function s(a,b,c){var v,w,d,x,y,m,p=function(e,d){for(var f=new Array(d.length),a=0;a<d.length;++a){var g=d[a],b=e[g[0]],c=e[g[1]];f[a]=[k(Math.min(b[0],c[0]),-1/0),k(Math.min(b[1],c[1]),-1/0),k(Math.max(b[0],c[0]),1/0),k(Math.max(b[1],c[1]),1/0)]}return f}(a,b),q=(v=a,w=b,d=[],e(p,function(c,e){var a=w[c],b=w[e];if(a[0]!==b[0]&&a[0]!==b[1]&&a[1]!==b[0]&&a[1]!==b[1]){var g=v[a[0]],h=v[a[1]],i=v[b[0]],j=v[b[1]];f(g,h,i,j)&&d.push([c,e])}}),d),s=n(a),t=(x=a,y=b,m=[],e(p,s,function(c,a){var b=y[c];if(b[0]!==a&&b[1]!==a){var d=x[a],e=x[b[0]],g=x[b[1]];f(e,g,d,d)&&m.push([c,a])}}),m),z=function(a,b,s,c,p){var t=a.map(function(a){return[g(a[0]),g(a[1])]});for(m=0;m<s.length;++m){var u=s[m];z=u[0];var v=u[1],w=b[z],x=b[v],k=l(j(a[w[0]]),j(a[w[1]]),j(a[x[0]]),j(a[x[1]]));if(k){var y=a.length;a.push([i(k[0]),i(k[1])]),t.push(k),c.push([z,y],[v,y])}}for(c.sort(function(a,b){if(a[0]!==b[0])return a[0]-b[0];var c=t[a[1]],d=t[b[1]];return h(c[0],d[0])||h(c[1],d[1])}),m=c.length-1;m>=0;--m){var m,z,q,n=c[m],d=b[z=n[0]],o=d[0],e=d[1],A=a[o],B=a[e];if(0>(A[0]-B[0]||A[1]-B[1])){var C=o;o=e,e=C}d[0]=o;var f=d[1]=n[1];for(p&&(q=d[2]);m>0&&c[m-1][0]===z;){var n=c[--m],r=n[1];p?b.push([f,r,q]):b.push([f,r]),f=r}p?b.push([f,e,q]):b.push([f,e])}return t}(a,b,q,t,c),u=o(a,z,s);return r(b,u,c),!!u||q.length>0||t.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(a,b,c){"use strict";b.exports=function(a,l,b,m){var c=h(l,a),d=h(m,b),f=k(c,d);if(0===g(f))return null;var n=j(c,e(k(d,h(a,b)),f)),o=i(a,n);return o};var d=a("big-rat/mul"),e=a("big-rat/div"),f=a("big-rat/sub"),g=a("big-rat/sign"),h=a("rat-vec/sub"),i=a("rat-vec/add"),j=a("rat-vec/muls");function k(a,b){return f(d(a[0],b[1]),d(a[1],b[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(b,a,c){a.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(a,b,c){"use strict";var d=a("./colorScale"),e=a("lerp");function f(a){return[a[0]/255,a[1]/255,a[2]/255,a[3]]}function g(d){for(var a,c="#",b=0;b<3;++b)c+=("00"+(a=(a=d[b]).toString(16))).substr(a.length);return c}function h(a){return"rgba("+a.join(",")+")"}b.exports=function(a){if(a||(a={}),t=(a.nshades||72)-1,o=a.format||"hex",s=a.colormap,s||(s="jet"),"string"==typeof s){if(!d[s=s.toLowerCase()])throw Error(s+" not a supported colorscale");n=d[s]}else if(Array.isArray(s))n=s.slice();else throw Error("unsupported colormap option",s);if(n.length>t+1)throw new Error(s+" map requires nshades to be at least size "+n.length);r=Array.isArray(a.alpha)?2!==a.alpha.length?[1,1]:a.alpha.slice():"number"==typeof a.alpha?[a.alpha,a.alpha]:[1,1],l=n.map(function(a){return Math.round(a.index*t)}),r[0]=Math.min(Math.max(r[0],0),1),r[1]=Math.min(Math.max(r[1],0),1);var l,i,j,m,n,s,o,t,b,r,c,q=n.map(function(d,b){var c=n[b].index,a=n[b].rgb.slice();return 4===a.length&&a[3]>=0&&a[3]<=1||(a[3]=r[0]+(r[1]-r[0])*c),a}),b=[];for(c=0;c<l.length-1;++c){m=l[c+1]-l[c],i=q[c],j=q[c+1];for(var p=0;p<m;p++){var k=p/m;b.push([Math.round(e(i[0],j[0],k)),Math.round(e(i[1],j[1],k)),Math.round(e(i[2],j[2],k)),e(i[3],j[3],k)])}}return b.push(n[n.length-1].rgb.concat(r[1])),"hex"===o?b=b.map(g):"rgbaString"===o?b=b.map(h):"float"===o&&(b=b.map(f)),b}},{"./colorScale":52,lerp:240}],54:[function(a,b,c){"use strict";b.exports=function(b,a,f,c){var j=d(a,f,c);if(0===j){var g=e(d(b,a,f)),h=e(d(b,a,c));if(g===h){if(0===g){var k=i(b,a,f);return k===i(b,a,c)?0:k?1:-1}return 0}return 0===h?g>0?-1:i(b,a,c)?-1:1:0===g?h>0?1:i(b,a,f)?1:-1:e(h-g)}var l=d(b,a,f);return l>0?j>0&&d(b,a,c)>0?1:-1:l<0?j>0||d(b,a,c)>0?1:-1:d(b,a,c)>0?1:i(b,a,f)?1:-1};var d=a("robust-orientation"),e=a("signum"),f=a("two-sum"),g=a("robust-product"),h=a("robust-sum");function i(b,a,c){var e=f(b[0],-a[0]),i=f(b[1],-a[1]),j=f(c[0],-a[0]),k=f(c[1],-a[1]),d=h(g(e,j),g(i,k));return d[d.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(b,a,c){"use strict";a.exports=function(a){return a<0?-1:a>0?1:0}},{}],56:[function(b,a,c){a.exports=function(a,b){var o=a.length,m=a.length-b.length;if(m)return m;switch(o){case 0:return 0;case 1:return a[0]-b[0];case 2:return a[0]+a[1]-b[0]-b[1]||d(a[0],a[1])-d(b[0],b[1]);case 3:var p=a[0]+a[1],q=b[0]+b[1];if(m=p+a[2]-(q+b[2]))return m;var r=d(a[0],a[1]),s=d(b[0],b[1]);return d(r,a[2])-d(s,b[2])||d(r+a[2],p)-d(s+b[2],q);case 4:var f=a[0],g=a[1],h=a[2],i=a[3],c=b[0],j=b[1],k=b[2],l=b[3];return f+g+h+i-(c+j+k+l)||d(f,g,h,i)-d(c,j,k,l,c)||d(f+g,f+h,f+i,g+h,g+i,h+i)-d(c+j,c+k,c+l,j+k,j+l,k+l)||d(f+g+h,f+g+i,f+h+i,g+h+i)-d(c+j+k,c+j+l,c+k+l,j+k+l);default:for(var t=a.slice().sort(e),u=b.slice().sort(e),n=0;n<o;++n)if(m=t[n]-u[n])return m;return 0}};var d=Math.min;function e(a,b){return a-b}},{}],57:[function(a,b,c){"use strict";var d=a("compare-cell"),e=a("cell-orientation");b.exports=function(a,b){return d(a,b)||e(a)-e(b)}},{"cell-orientation":47,"compare-cell":56}],58:[function(a,b,c){"use strict";var d=a("./lib/ch1d"),e=a("./lib/ch2d"),f=a("./lib/chnd");b.exports=function(a){var c=a.length;if(0===c)return[];if(1===c)return[[0]];var b=a[0].length;return 0===b?[]:1===b?d(a):2===b?e(a):f(a,b)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(b,a,c){"use strict";a.exports=function(d){for(var a=0,b=0,c=1;c<d.length;++c)d[c][0]<d[a][0]&&(a=c),d[c][0]>d[b][0]&&(b=c);return a<b?[[a],[b]]:a>b?[[b],[a]]:[[a]]}},{}],60:[function(a,b,c){"use strict";b.exports=function(h){var c=d(h),a=c.length;if(a<=2)return[];for(var e=new Array(a),f=c[a-1],b=0;b<a;++b){var g=c[b];e[b]=[f,g],f=g}return e};var d=a("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(a,b,c){"use strict";b.exports=function(a,c){try{return d(a,!0)}catch(f){var b=e(a);if(b.length<=c)return[];return function(d,e){for(var i=d.length,f=e.length,g=0;g<i;++g)for(var c=d[g],b=0;b<c.length;++b){var a=c[b];if(a<f)c[b]=e[a];else{a-=f;for(var h=0;h<f;++h)a>=e[h]&&(a+=1);c[b]=a}}return d}(d(function(c,b){for(var e=c.length,d=new Array(e),a=0;a<b.length;++a)d[a]=c[b[a]];for(var f=b.length,a=0;a<e;++a)0>b.indexOf(a)&&(d[f++]=c[a]);return d}(a,b),!0),b)}};var d=a("incremental-convex-hull"),e=a("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(b,a,c){"use strict";a.exports=function(c,f,g,h,b,d){var e=b-1,i=b*b,j=e*e,k=(1+2*b)*j,l=b*j,m=i*(3-2*b),n=i*e;if(c.length){d||(d=new Array(c.length));for(var a=c.length-1;a>=0;--a)d[a]=k*c[a]+l*f[a]+m*g[a]+n*h[a];return d}return k*c+l*f+m*g+n*h},a.exports.derivative=function(c,e,f,g,a,d){var h=6*a*a-6*a,i=3*a*a-4*a+1,j=-6*a*a+6*a,k=3*a*a-2*a;if(c.length){d||(d=new Array(c.length));for(var b=c.length-1;b>=0;--b)d[b]=h*c[b]+i*e[b]+j*f[b]+k*g[b];return d}return h*c+i*e+j*f[b]+k*g}},{}],63:[function(a,b,c){"use strict";var d=a("incremental-convex-hull"),e=a("uniq");function f(a,b){this.point=a,this.index=b}function g(d,e){for(var b=d.point,f=e.point,g=b.length,a=0;a<g;++a){var c=f[a]-b[a];if(c)return c}return 0}b.exports=function(k,t){var c=k.length;if(0===c)return[];var b=k[0].length;if(b<1)return[];if(1===b)return function(c,f,e){if(1===c)return e?[[-1,0]]:[];var d=f.map(function(a,b){return[a[0],b]});d.sort(function(a,b){return a[0]-b[0]});for(var a=new Array(c-1),b=1;b<c;++b){var g=d[b-1],h=d[b];a[b-1]=[g[1],h[1]]}return e&&a.push([-1,a[0][1],],[a[c-1][1],-1]),a}(c,k,t);for(var l=new Array(c),p=1,a=0;a<c;++a){for(var u=k[a],h=new Array(b+1),q=0,m=0;m<b;++m){var r=u[m];h[m]=r,q+=r*r}h[b]=q,l[a]=new f(h,a),p=Math.max(q,p)}e(l,g),c=l.length;for(var n=new Array(c+b+1),s=new Array(c+b+1),v=(b+1)*(b+1)*p,o=new Array(b+1),a=0;a<=b;++a)o[a]=0;o[b]=v,n[0]=o.slice(),s[0]=-1;for(var a=0;a<=b;++a){var h=o.slice();h[a]=1,n[a+1]=h,s[a+1]=-1}for(var a=0;a<c;++a){var i=l[a];n[a+b+1]=i.point,s[a+b+1]=i.index}var j=d(n,!1);if(j=t?j.filter(function(c){for(var e=0,a=0;a<=b;++a){var d=s[c[a]];if(d<0&& ++e>=2)return!1;c[a]=d}return!0}):j.filter(function(c){for(var a=0;a<=b;++a){var d=s[c[a]];if(d<0)return!1;c[a]=d}return!0}),1&b)for(var a=0;a<j.length;++a){var i=j[a],h=i[0];i[0]=i[1],i[1]=h}return j}},{"incremental-convex-hull":233,uniq:310}],64:[function(a,b,c){(function(a){(function(){var c=!1;if("undefined"!=typeof Float64Array){var d=new Float64Array(1),e=new Uint32Array(d.buffer);(d[0]=1,c=!0,1072693248===e[1])?(b.exports=function(a){return d[0]=a,[e[0],e[1]]},b.exports.pack=function(a,b){return e[0]=a,e[1]=b,d[0]},b.exports.lo=function(a){return d[0]=a,e[0]},b.exports.hi=function(a){return d[0]=a,e[1]}):1072693248===e[0]?(b.exports=function(a){return d[0]=a,[e[1],e[0]]},b.exports.pack=function(a,b){return e[1]=a,e[0]=b,d[0]},b.exports.lo=function(a){return d[0]=a,e[1]},b.exports.hi=function(a){return d[0]=a,e[0]}):c=!1}if(!c){var f=new a(8);b.exports=function(a){return f.writeDoubleLE(a,0,!0),[f.readUInt32LE(0,!0),f.readUInt32LE(4,!0)]},b.exports.pack=function(a,b){return f.writeUInt32LE(a,0,!0),f.writeUInt32LE(b,4,!0),f.readDoubleLE(0,!0)},b.exports.lo=function(a){return f.writeDoubleLE(a,0,!0),f.readUInt32LE(0,!0)},b.exports.hi=function(a){return f.writeDoubleLE(a,0,!0),f.readUInt32LE(4,!0)}}b.exports.sign=function(a){return b.exports.hi(a)>>>31},b.exports.exponent=function(a){return(b.exports.hi(a)<<1>>>21)-1023},b.exports.fraction=function(a){var e=b.exports.lo(a),c=b.exports.hi(a),d=1048575&c;return 2146435072&c&&(d+=1048576),[e,d]},b.exports.denormalized=function(a){return!(2146435072&b.exports.hi(a))}}).call(this)}).call(this,a("buffer").Buffer)},{buffer:3}],65:[function(b,a,c){"use strict";function d(c,g,e){var b=0|c[e];if(b<=0)return[];var a,f=new Array(b);if(e===c.length-1)for(a=0;a<b;++a)f[a]=g;else for(a=0;a<b;++a)f[a]=d(c,g,e+1);return f}a.exports=function(a,b){switch(void 0===b&&(b=0),typeof a){case"number":if(a>0)return function(c,d){var b,a;for(a=0,b=new Array(c);a<c;++a)b[a]=d;return b}(0|a,b);break;case"object":if("number"==typeof a.length)return d(a,b,0);break}return[]}},{}],66:[function(a,b,c){"use strict";b.exports=function(f,b){var h=f.length;if("number"!=typeof b){b=0;for(var a=0;a<h;++a){var c=f[a];b=Math.max(b,c[0],c[1])}b=(0|b)+1}b|=0;for(var e=new Array(b),a=0;a<b;++a)e[a]=[];for(var a=0;a<h;++a){var c=f[a];e[c[0]].push(c[1]),e[c[1]].push(c[0])}for(var g=0;g<b;++g)d(e[g],function(a,b){return a-b});return e};var d=a("uniq")},{uniq:310}],67:[function(b,a,c){"use strict";a.exports=function(a,d,e){var b=d||0,c=e||1;return[[a[12]+a[0],a[13]+a[1],a[14]+a[2],a[15]+a[3]],[a[12]-a[0],a[13]-a[1],a[14]-a[2],a[15]-a[3]],[a[12]+a[4],a[13]+a[5],a[14]+a[6],a[15]+a[7]],[a[12]-a[4],a[13]-a[5],a[14]-a[6],a[15]-a[7]],[b*a[12]+a[8],b*a[13]+a[9],b*a[14]+a[10],b*a[15]+a[11]],[c*a[12]-a[8],c*a[13]-a[9],c*a[14]-a[10],c*a[15]-a[11]]]}},{}],68:[function(b,c,e){"use strict";c.exports=function(a,b,e){switch(arguments.length){case 0:return new d([0],[0],0);case 1:if("number"!=typeof a)return new d(a,i(a.length),0);var c=i(a);return new d(c,c,0);case 2:if("number"==typeof b){var c=i(a.length);return new d(a,c,+b)}e=0;case 3:if(a.length!==b.length)throw new Error("state and velocity lengths must match");return new d(a,b,e)}};var f=b("cubic-hermite"),g=b("binary-search-bounds");function h(a,b,c){return Math.min(b,Math.max(a,c))}function d(a,c,d){this.dimension=a.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var b=0;b<this.dimension;++b)this.bounds[0][b]=-1/0,this.bounds[1][b]=1/0;this._state=a.slice().reverse(),this._velocity=c.slice().reverse(),this._time=[d],this._scratch=[a.slice(),a.slice(),a.slice(),a.slice(),a.slice()]}var a=d.prototype;function i(b){for(var c=new Array(b),a=0;a<b;++a)c[a]=0;return c}a.flush=function(b){var a=g.gt(this._time,b)-1;a<=0||(this._time.splice(0,a),this._state.splice(0,a*this.dimension),this._velocity.splice(0,a*this.dimension))},a.curve=function(m){var e=this._time,s=e.length,i=g.le(e,m),d=this._scratch[0],j=this._state,n=this._velocity,c=this.dimension,t=this.bounds;if(i<0)for(var b=c-1,a=0;a<c;++a,--b)d[a]=j[b];else if(i>=s-1)for(var b=j.length-1,v=m-e[s-1],a=0;a<c;++a,--b)d[a]=j[b]+v*n[b];else{for(var b=c*(i+1)-1,u=e[i],o=e[i+1]-u||1,k=this._scratch[1],p=this._scratch[2],l=this._scratch[3],q=this._scratch[4],r=!0,a=0;a<c;++a,--b)k[a]=j[b],l[a]=n[b]*o,p[a]=j[b+c],q[a]=n[b+c]*o,r=r&&k[a]===p[a]&&l[a]===q[a]&&0===l[a];if(r)for(var a=0;a<c;++a)d[a]=k[a];else f(k,l,p,q,(m-u)/o,d)}for(var w=t[0],x=t[1],a=0;a<c;++a)d[a]=h(w[a],x[a],d[a]);return d},a.dcurve=function(q){var d=this._time,r=d.length,h=g.le(d,q),e=this._scratch[0],k=this._state,l=this._velocity,c=this.dimension;if(h>=r-1){var b=k.length-1;d[r-1];for(var a=0;a<c;++a,--b)e[a]=l[b]}else{for(var b=c*(h+1)-1,s=d[h],i=d[h+1]-s||1,m=this._scratch[1],n=this._scratch[2],j=this._scratch[3],o=this._scratch[4],p=!0,a=0;a<c;++a,--b)m[a]=k[b],j[a]=l[b]*i,n[a]=k[b+c],o[a]=l[b+c]*i,p=p&&m[a]===n[a]&&j[a]===o[a]&&0===j[a];if(p)for(var a=0;a<c;++a)e[a]=0;else{f.derivative(m,j,n,o,(q-s)/i,e);for(var a=0;a<c;++a)e[a]/=i}}return e},a.lastT=function(){var a=this._time;return a[a.length-1]},a.stable=function(){for(var a=this._velocity,c=a.length,b=this.dimension-1;b>=0;--b)if(a[--c])return!1;return!0},a.jump=function(c){var e=this.lastT(),d=this.dimension;if(!(c<e)&&arguments.length===d+1){var b=this._state,f=this._velocity,j=b.length-this.dimension,g=this.bounds,k=g[0],l=g[1];this._time.push(e,c);for(var i=0;i<2;++i)for(var a=0;a<d;++a)b.push(b[j++]),f.push(0);this._time.push(c);for(var a=d;a>0;--a)b.push(h(k[a-1],l[a-1],arguments[a])),f.push(0)}},a.push=function(b){var d=this.lastT(),e=this.dimension;if(!(b<d)&&arguments.length===e+1){var c=this._state,j=this._velocity,k=c.length-this.dimension,f=b-d,g=this.bounds,l=g[0],m=g[1],n=f>1e-6?1/f:0;this._time.push(b);for(var a=e;a>0;--a){var i=h(l[a-1],m[a-1],arguments[a]);c.push(i),j.push((i-c[k++])*n)}}},a.set=function(b){var c=this.dimension;if(!(b<this.lastT())&&arguments.length===c+1){var e=this._state,f=this._velocity,d=this.bounds,g=d[0],i=d[1];this._time.push(b);for(var a=c;a>0;--a)e.push(h(g[a-1],i[a-1],arguments[a])),f.push(0)}},a.move=function(b){var d=this.lastT(),e=this.dimension;if(!(b<=d)&&arguments.length===e+1){var c=this._state,j=this._velocity,k=c.length-this.dimension,f=this.bounds,l=f[0],m=f[1],g=b-d,n=g>1e-6?1/g:0;this._time.push(b);for(var a=e;a>0;--a){var i=arguments[a];c.push(h(l[a-1],m[a-1],c[k++]+i)),j.push(i*n)}}},a.idle=function(b){var e=this.lastT();if(!(b<e)){var f=this.dimension,c=this._state,g=this._velocity,d=c.length-f,i=this.bounds,j=i[0],k=i[1],l=b-e;this._time.push(b);for(var a=f-1;a>=0;--a)c.push(h(j[a],k[a],c[d]+l*g[d])),g.push(0),d+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(f,c,g){"use strict";function h(a,b,c,d,e,f){this._color=a,this.key=b,this.value=c,this.left=d,this.right=e,this._count=f}function i(a){return new h(a._color,a.key,a.value,a.left,a.right,a._count)}function j(b,a){return new h(b,a.key,a.value,a.left,a.right,a._count)}function k(a){a._count=1+(a.left?a.left._count:0)+(a.right?a.right._count:0)}function d(a,b){this._compare=a,this.root=b}c.exports=function(a){return new d(a||p,null)};var a=d.prototype;function l(c,a){if(a.left){var b=l(c,a.left);if(b)return b}var b=c(a.key,a.value);return b||(a.right?l(c,a.right):void 0)}function m(c,d,e,a){if(0>=d(c,a.key)){if(a.left){var b=m(c,d,e,a.left);if(b)return b}var b=e(a.key,a.value);if(b)return b}if(a.right)return m(c,d,e,a.right)}function n(d,e,b,f,a){var c,h=b(d,a.key),g=b(e,a.key);if(h<=0){if(a.left&&(c=n(d,e,b,f,a.left)))return c;if(g>0&&(c=f(a.key,a.value)))return c}if(g>0&&a.right)return n(d,e,b,f,a.right)}function e(a,b){this.tree=a,this._stack=b}Object.defineProperty(a,"keys",{get:function(){var a=[];return this.forEach(function(b,c){a.push(b)}),a}}),Object.defineProperty(a,"values",{get:function(){var a=[];return this.forEach(function(c,b){a.push(b)}),a}}),Object.defineProperty(a,"length",{get:function(){return this.root?this.root._count:0}}),a.insert=function(l,p){for(var m=this._compare,a=this.root,f=[],n=[];a;){var o=m(l,a.key);f.push(a),n.push(o),a=o<=0?a.left:a.right}f.push(new h(0,l,p,null,null,1));for(var b=f.length-2;b>=0;--b){var a=f[b];n[b]<=0?f[b]=new h(a._color,a.key,a.value,f[b+1],a.right,a._count+1):f[b]=new h(a._color,a.key,a.value,a.left,f[b+1],a._count+1)}for(var b=f.length-1;b>1;--b){var e=f[b-1],a=f[b];if(1===e._color||1===a._color)break;var c=f[b-2];if(c.left===e)if(e.left===a){var g=c.right;if(g&&0===g._color)e._color=1,c.right=j(1,g),c._color=0,b-=1;else{if(c._color=0,c.left=e.right,e._color=1,e.right=c,f[b-2]=e,f[b-1]=a,k(c),k(e),b>=3){var i=f[b-3];i.left===c?i.left=e:i.right=e}break}}else{var g=c.right;if(g&&0===g._color)e._color=1,c.right=j(1,g),c._color=0,b-=1;else{if(e.right=a.left,c._color=0,c.left=a.right,a._color=1,a.left=e,a.right=c,f[b-2]=a,f[b-1]=e,k(c),k(e),k(a),b>=3){var i=f[b-3];i.left===c?i.left=a:i.right=a}break}}else if(e.right===a){var g=c.left;if(g&&0===g._color)e._color=1,c.left=j(1,g),c._color=0,b-=1;else{if(c._color=0,c.right=e.left,e._color=1,e.left=c,f[b-2]=e,f[b-1]=a,k(c),k(e),b>=3){var i=f[b-3];i.right===c?i.right=e:i.left=e}break}}else{var g=c.left;if(g&&0===g._color)e._color=1,c.left=j(1,g),c._color=0,b-=1;else{if(e.left=a.right,c._color=0,c.right=a.left,a._color=1,a.right=e,a.left=c,f[b-2]=a,f[b-1]=e,k(c),k(e),k(a),b>=3){var i=f[b-3];i.right===c?i.right=a:i.left=a}break}}}return f[0]._color=1,new d(m,f[0])},a.forEach=function(a,b,c){if(this.root)switch(arguments.length){case 1:return l(a,this.root);case 2:return m(b,this._compare,a,this.root);case 3:if(this._compare(b,c)>=0)return;return n(b,c,this._compare,a,this.root)}},Object.defineProperty(a,"begin",{get:function(){for(var b=[],a=this.root;a;)b.push(a),a=a.left;return new e(this,b)}}),Object.defineProperty(a,"end",{get:function(){for(var b=[],a=this.root;a;)b.push(a),a=a.right;return new e(this,b)}}),a.at=function(b){if(b<0)return new e(this,[]);for(var a=this.root,c=[];;){if(c.push(a),a.left){if(b<a.left._count){a=a.left;continue}b-=a.left._count}if(!b)return new e(this,c);if(b-=1,a.right){if(b>=a.right._count)break;a=a.right}else break}return new e(this,[])},a.ge=function(f){for(var g=this._compare,a=this.root,b=[],c=0;a;){var d=g(f,a.key);b.push(a),d<=0&&(c=b.length),a=d<=0?a.left:a.right}return b.length=c,new e(this,b)},a.gt=function(f){for(var g=this._compare,a=this.root,b=[],c=0;a;){var d=g(f,a.key);b.push(a),d<0&&(c=b.length),a=d<0?a.left:a.right}return b.length=c,new e(this,b)},a.lt=function(f){for(var g=this._compare,a=this.root,b=[],c=0;a;){var d=g(f,a.key);b.push(a),d>0&&(c=b.length),a=d<=0?a.left:a.right}return b.length=c,new e(this,b)},a.le=function(f){for(var g=this._compare,a=this.root,b=[],c=0;a;){var d=g(f,a.key);b.push(a),d>=0&&(c=b.length),a=d<0?a.left:a.right}return b.length=c,new e(this,b)},a.find=function(d){for(var f=this._compare,a=this.root,b=[];a;){var c=f(d,a.key);if(b.push(a),0===c)return new e(this,b);a=c<=0?a.left:a.right}return new e(this,[])},a.remove=function(b){var a=this.find(b);return a?a.remove():this},a.get=function(c){for(var d=this._compare,a=this.root;a;){var b=d(c,a.key);if(0===b)return a.value;a=b<=0?a.left:a.right}};var b=e.prototype;function o(a,b){a.key=b.key,a.value=b.value,a.left=b.left,a.right=b.right,a._color=b._color,a._count=b._count}function p(a,b){return a<b?-1:a>b?1:0}Object.defineProperty(b,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(b,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),b.clone=function(){return new e(this.tree,this._stack.slice())},b.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var b=new Array(e.length),a=e[e.length-1];b[b.length-1]=new h(a._color,a.key,a.value,a.left,a.right,a._count);for(var c=e.length-2;c>=0;--c){var a=e[c];a.left===e[c+1]?b[c]=new h(a._color,a.key,a.value,b[c+1],a.right,a._count):b[c]=new h(a._color,a.key,a.value,a.left,b[c+1],a._count)}if((a=b[b.length-1]).left&&a.right){var f=b.length;for(a=a.left;a.right;)b.push(a),a=a.right;var m=b[f-1];b.push(new h(a._color,m.key,m.value,a.left,a.right,a._count)),b[f-1].key=a.key,b[f-1].value=a.value;for(var c=b.length-2;c>=f;--c)a=b[c],b[c]=new h(a._color,a.key,a.value,a.left,b[c+1],a._count);b[f-1].left=b[f]}if(0===(a=b[b.length-1])._color){var g=b[b.length-2];g.left===a?g.left=null:g.right===a&&(g.right=null),b.pop();for(var c=0;c<b.length;++c)b[c]._count--;return new d(this.tree._compare,b[0])}if(a.left||a.right){a.left?o(a,a.left):a.right&&o(a,a.right),a._color=1;for(var c=0;c<b.length-1;++c)b[c]._count--;return new d(this.tree._compare,b[0])}if(1===b.length)return new d(this.tree._compare,null);for(var c=0;c<b.length;++c)b[c]._count--;var l=b[b.length-2];return function(e){for(var g,b,a,d,c=e.length-1;c>=0;--c){if(g=e[c],0===c){g._color=1;return}if((b=e[c-1]).left===g){if((a=b.right).right&&0===a.right._color){if(d=(a=b.right=i(a)).right=i(a.right),b.right=a.left,a.left=b,a.right=d,a._color=b._color,g._color=1,b._color=1,d._color=1,k(b),k(a),c>1){var f=e[c-2];f.left===b?f.left=a:f.right=a}e[c-1]=a;return}if(a.left&&0===a.left._color){if(d=(a=b.right=i(a)).left=i(a.left),b.right=d.left,a.left=d.right,d.left=b,d.right=a,d._color=b._color,b._color=1,a._color=1,g._color=1,k(b),k(a),k(d),c>1){var f=e[c-2];f.left===b?f.left=d:f.right=d}e[c-1]=d;return}if(1===a._color){if(0===b._color){b._color=1,b.right=j(0,a);return}b.right=j(0,a);continue}if(a=i(a),b.right=a.left,a.left=b,a._color=b._color,b._color=0,k(b),k(a),c>1){var f=e[c-2];f.left===b?f.left=a:f.right=a}e[c-1]=a,e[c]=b,c+1<e.length?e[c+1]=g:e.push(g),c+=2}else{if((a=b.left).left&&0===a.left._color){if(d=(a=b.left=i(a)).left=i(a.left),b.left=a.right,a.right=b,a.left=d,a._color=b._color,g._color=1,b._color=1,d._color=1,k(b),k(a),c>1){var f=e[c-2];f.right===b?f.right=a:f.left=a}e[c-1]=a;return}if(a.right&&0===a.right._color){if(d=(a=b.left=i(a)).right=i(a.right),b.left=d.right,a.right=d.left,d.right=b,d.left=a,d._color=b._color,b._color=1,a._color=1,g._color=1,k(b),k(a),k(d),c>1){var f=e[c-2];f.right===b?f.right=d:f.left=d}e[c-1]=d;return}if(1===a._color){if(0===b._color){b._color=1,b.left=j(0,a);return}b.left=j(0,a);continue}if(a=i(a),b.left=a.right,a.right=b,a._color=b._color,b._color=0,k(b),k(a),c>1){var f=e[c-2];f.right===b?f.right=a:f.left=a}e[c-1]=a,e[c]=b,c+1<e.length?e[c+1]=g:e.push(g),c+=2}}}(b),l.left===a?l.left=null:l.right=null,new d(this.tree._compare,b[0])},Object.defineProperty(b,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(b,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(b,"index",{get:function(){var c=0,a=this._stack;if(0===a.length){var d=this.tree.root;return d?d._count:0}a[a.length-1].left&&(c=a[a.length-1].left._count);for(var b=a.length-2;b>=0;--b)a[b+1]===a[b].right&&(++c,a[b].left&&(c+=a[b].left._count));return c},enumerable:!0}),b.next=function(){var a=this._stack;if(0!==a.length){var b=a[a.length-1];if(b.right)for(b=b.right;b;)a.push(b),b=b.left;else for(a.pop();a.length>0&&a[a.length-1].right===b;)b=a[a.length-1],a.pop()}},Object.defineProperty(b,"hasNext",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].right)return!0;for(var b=a.length-1;b>0;--b)if(a[b-1].left===a[b])return!0;return!1}}),b.update=function(f){var c=this._stack;if(0===c.length)throw new Error("Can't update empty node!");var e=new Array(c.length),a=c[c.length-1];e[e.length-1]=new h(a._color,a.key,f,a.left,a.right,a._count);for(var b=c.length-2;b>=0;--b)(a=c[b]).left===c[b+1]?e[b]=new h(a._color,a.key,a.value,e[b+1],a.right,a._count):e[b]=new h(a._color,a.key,a.value,a.left,e[b+1],a._count);return new d(this.tree._compare,e[0])},b.prev=function(){var a=this._stack;if(0!==a.length){var b=a[a.length-1];if(b.left)for(b=b.left;b;)a.push(b),b=b.right;else for(a.pop();a.length>0&&a[a.length-1].left===b;)b=a[a.length-1],a.pop()}},Object.defineProperty(b,"hasPrev",{get:function(){var a=this._stack;if(0===a.length)return!1;if(a[a.length-1].left)return!0;for(var b=a.length-1;b>0;--b)if(a[b-1].right===a[b])return!0;return!1}})},{}],70:[function(b,e,g){"use strict";e.exports=function(b,c){var a=new f(b);return a.update(c),a};var h=b("./lib/text.js"),i=b("./lib/lines.js"),j=b("./lib/background.js"),k=b("./lib/cube.js"),l=b("./lib/ticks.js"),c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function m(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function f(a){this.gl=a,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=j(a)}var a=f.prototype;function d(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}a.update=function(d){function k(g,b,c){if(c in d){var f,a=d[c],h=this[c];(g?Array.isArray(a)&&Array.isArray(a[0]):Array.isArray(a))?this[c]=f=[b(a[0]),b(a[1]),b(a[2])]:this[c]=f=[b(a),b(a),b(a)];for(var e=0;e<3;++e)if(f[e]!==h[e])return!0}return!1}d=d||{};var j,b=k.bind(this,!1,Number),c=k.bind(this,!1,Boolean),n=k.bind(this,!1,String),f=k.bind(this,!0,function(a){if(Array.isArray(a)){if(3===a.length)return[+a[0],+a[1],+a[2],1];if(4===a.length)return[+a[0],+a[1],+a[2],+a[3]]}return[0,0,0,1]}),e=!1,m=!1;if("bounds"in d){var o=d.bounds;i_loop:for(var a=0;a<2;++a)for(var g=0;g<3;++g)o[a][g]!==this.bounds[a][g]&&(m=!0),this.bounds[a][g]=o[a][g]}if("ticks"in d){j=d.ticks,e=!0,this.autoTicks=!1;for(var a=0;a<3;++a)this.tickSpacing[a]=0}else b("tickSpacing")&&(this.autoTicks=!0,m=!0);if(this._firstInit&&("ticks"in d||"tickSpacing"in d||(this.autoTicks=!0),m=!0,e=!0,this._firstInit=!1),m&&this.autoTicks&&(j=l.create(this.bounds,this.tickSpacing),e=!0),e){for(var a=0;a<3;++a)j[a].sort(function(a,b){return a.x-b.x});l.equal(j,this.ticks)?e=!1:this.ticks=j}c("tickEnable"),n("tickFont")&&(e=!0),b("tickSize"),b("tickAngle"),b("tickPad"),f("tickColor");var p=n("labels");n("labelFont")&&(p=!0),c("labelEnable"),b("labelSize"),b("labelPad"),f("labelColor"),c("lineEnable"),c("lineMirror"),b("lineWidth"),f("lineColor"),c("lineTickEnable"),c("lineTickMirror"),b("lineTickLength"),b("lineTickWidth"),f("lineTickColor"),c("gridEnable"),b("gridWidth"),f("gridColor"),c("zeroEnable"),f("zeroLineColor"),b("zeroLineWidth"),c("backgroundEnable"),f("backgroundColor"),this._text?this._text&&(p||e)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=h(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&e&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=i(this.gl,this.bounds,this.ticks))};var n=[new d,new d,new d];function o(b,e,f,m,n){for(var g=b.primalOffset,h=b.primalMinor,i=b.mirrorOffset,j=b.mirrorMinor,o=m[e],a=0;a<3;++a)if(e!==a){var k=g,l=i,c=h,d=j;o&1<<a&&(k=i,l=g,c=j,d=h),k[a]=f[0][a],l[a]=f[1][a],n[a]>0?(c[a]=-1,d[a]=0):(c[a]=0,d[a]=1)}}var p=[0,0,0],q={model:c,view:c,projection:c,_ortho:!1};a.isOpaque=function(){return!0},a.isTransparent=function(){return!1},a.drawTransparent=function(a){};var r=[0,0,0],s=[0,0,0],t=[0,0,0];a.draw=function(l){l=l||q;for(var d,w,x,D=this.gl,h=l.model||c,i=l.view||c,j=l.projection||c,e=this.bounds,E=l._ortho||!1,F=k(h,i,j,e,E),G=F.cubeEdges,y=F.axis,M=i[12],N=i[13],O=i[14],P=i[15],Q=E?2:1,z=Q*this.pixelRatio*(j[3]*M+j[7]*N+j[11]*O+j[15]*P)/D.drawingBufferHeight,a=0;a<3;++a)this.lastCubeProps.cubeEdges[a]=G[a],this.lastCubeProps.axis[a]=y[a];for(var g=n,a=0;a<3;++a)o(n[a],a,this.bounds,G,y);for(var D=this.gl,C=p,a=0;a<3;++a)this.backgroundEnable[a]?C[a]=y[a]:C[a]=0;this._background.draw(h,i,j,e,C,this.backgroundColor),this._lines.bind(h,i,j,this);for(var a=0;a<3;++a){var A=[0,0,0];y[a]>0?A[a]=e[1][a]:A[a]=e[0][a];for(var b=0;b<2;++b){var u=(a+1+b)%3,f=(a+1+(1^b))%3;this.gridEnable[u]&&this._lines.drawGrid(u,f,this.bounds,A,this.gridColor[u],this.gridWidth[u]*this.pixelRatio)}for(var b=0;b<2;++b){var u=(a+1+b)%3,f=(a+1+(1^b))%3;this.zeroEnable[f]&&0>=Math.min(e[0][f],e[1][f])&&Math.max(e[0][f],e[1][f])>=0&&this._lines.drawZero(u,f,this.bounds,A,this.zeroLineColor[f],this.zeroLineWidth[f]*this.pixelRatio)}}for(var a=0;a<3;++a){this.lineEnable[a]&&this._lines.drawAxisLine(a,this.bounds,g[a].primalOffset,this.lineColor[a],this.lineWidth[a]*this.pixelRatio),this.lineMirror[a]&&this._lines.drawAxisLine(a,this.bounds,g[a].mirrorOffset,this.lineColor[a],this.lineWidth[a]*this.pixelRatio);for(var H=m(r,g[a].primalMinor),I=m(s,g[a].mirrorMinor),J=this.lineTickLength,b=0;b<3;++b){var K=z/h[5*b];H[b]*=J[b]*K,I[b]*=J[b]*K}this.lineTickEnable[a]&&this._lines.drawAxisTicks(a,g[a].primalOffset,H,this.lineTickColor[a],this.lineTickWidth[a]*this.pixelRatio),this.lineTickMirror[a]&&this._lines.drawAxisTicks(a,g[a].mirrorOffset,I,this.lineTickColor[a],this.lineTickWidth[a]*this.pixelRatio)}function R(a){(x=[0,0,0])[a]=1}function S(g,h,i){var a=(g+1)%3,b=(g+2)%3,c=h[a],d=h[b],e=i[a],f=i[b];if(c>0&&f>0){R(a);return}if(c>0&&f<0){R(a);return}if(c<0&&f>0){R(a);return}if(c<0&&f<0){R(a);return}if(d>0&&e>0){R(b);return}if(d>0&&e<0){R(b);return}if(d<0&&e>0){R(b);return}if(d<0&&e<0){R(b);return}}this._lines.unbind(),this._text.bind(h,i,j,this.pixelRatio);for(var a=0;a<3;++a){for(var B=g[a].primalMinor,T=g[a].mirrorMinor,v=m(t,g[a].primalOffset),b=0;b<3;++b)this.lineTickEnable[a]&&(v[b]+=z*B[b]*Math.max(this.lineTickLength[b],0)/h[5*b]);var L=[0,0,0];if(L[a]=1,this.tickEnable[a]){-3600===this.tickAngle[a]?(this.tickAngle[a]=0,this.tickAlign[a]="auto"):this.tickAlign[a]=-1,w=1,"auto"===(d=[this.tickAlign[a],.5,w])[0]?d[0]=0:d[0]=parseInt(""+d[0]),x=[0,0,0],S(a,B,T);for(var b=0;b<3;++b)v[b]+=z*B[b]*this.tickPad[b]/h[5*b];this._text.drawTicks(a,this.tickSize[a],this.tickAngle[a],v,this.tickColor[a],L,x,d)}if(this.labelEnable[a]){w=0,x=[0,0,0],this.labels[a].length>4&&(R(a),w=1),"auto"===(d=[this.labelAlign[a],.5,w])[0]?d[0]=0:d[0]=parseInt(""+d[0]);for(var b=0;b<3;++b)v[b]+=z*B[b]*this.labelPad[b]/h[5*b];v[a]+=.5*(e[0][a]+e[1][a]),this._text.drawLabel(a,this.labelSize[a],this.labelAngle[a],v,this.labelColor[a],[0,0,0],x,d)}}this._text.unbind()},a.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(a,c,e){"use strict";c.exports=function(a){for(var q=[],r=[],b=0,c=0;c<3;++c)for(var k=(c+1)%3,l=(c+2)%3,e=[0,0,0],i=[0,0,0],j=-1;j<=1;j+=2){r.push(b,b+2,b+1,b+1,b+2,b+3),e[c]=j,i[c]=j;for(var m=-1;m<=1;m+=2){e[k]=m;for(var n=-1;n<=1;n+=2)e[l]=n,q.push(e[0],e[1],e[2],i[0],i[1],i[2]),b+=1}var s=k;k=l,l=s}var o=f(a,new Float32Array(q)),t=f(a,new Uint16Array(r),a.ELEMENT_ARRAY_BUFFER),u=g(a,[{buffer:o,type:a.FLOAT,size:3,offset:0,stride:24},{buffer:o,type:a.FLOAT,size:3,offset:12,stride:24}],t),p=h(a);return p.attributes.position.location=0,p.attributes.normal.location=1,new d(a,o,u,p)};var f=a("gl-buffer"),g=a("gl-vao"),h=a("./shaders").bg;function d(a,b,c,d){this.gl=a,this.buffer=b,this.vao=c,this.shader=d}var b=d.prototype;b.draw=function(e,f,g,h,d,i){for(var b=!1,c=0;c<3;++c)b=b||d[c];if(b){var a=this.gl;a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:e,view:f,projection:g,bounds:h,enable:d,colors:i},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),a.disable(a.POLYGON_OFFSET_FILL)}},b.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(a,b,e){"use strict";b.exports=function(N,O,P,E,Q){g(j,O,N),g(j,P,j);for(var J=0,a=0;a<2;++a){m[2]=E[a][2];for(var F=0;F<2;++F){m[1]=E[F][1];for(var G=0;G<2;++G)m[0]=E[G][0],o(k[J],m,j),J+=1}}for(var e=-1,a=0;a<8;++a){for(var K=k[a][3],C=0;C<3;++C)l[a][C]=k[a][C]/K;Q&&(l[a][2]*=-1),K<0&&(e<0?e=a:l[a][2]<l[e][2]&&(e=a))}if(e<0){e=0;for(var h=0;h<3;++h){for(var z=(h+2)%3,u=(h+1)%3,A=-1,B=-1,b=0;b<2;++b){var w=b<<h,H=w+(b<<z)+(1-b<<u),I=w+(1-b<<z)+(b<<u);0>i(l[w],l[H],l[I],n)||(b?A=1:B=1)}if(A<0||B<0){B>A&&(e|=1<<h);continue}for(var b=0;b<2;++b){var w=b<<h,H=w+(b<<z)+(1-b<<u),I=w+(1-b<<z)+(b<<u),L=q([k[w],k[H],k[I],k[w+(1<<z)+(1<<u)]]);b?A=L:B=L}if(B>A){e|=1<<h;continue}}}for(var D=7^e,s=-1,a=0;a<8;++a)a!==e&&a!==D&&(s<0?s=a:l[s][1]>l[a][1]&&(s=a));for(var t=-1,a=0;a<3;++a){var p=s^1<<a;if(p!==e&&p!==D){t<0&&(t=p);var u=l[p];u[0]<l[t][0]&&(t=p)}}for(var v=-1,a=0;a<3;++a){var p=s^1<<a;if(p!==e&&p!==D&&p!==t){v<0&&(v=p);var u=l[p];u[0]>l[v][0]&&(v=p)}}var x=c;x[0]=x[1]=x[2]=0,x[f.log2(t^s)]=s&t,x[f.log2(s^v)]=s&v;var y=7^v;y===e||y===D?(y=7^t,x[f.log2(v^y)]=y&v):x[f.log2(t^y)]=y&t;for(var M=d,R=e,h=0;h<3;++h)R&1<<h?M[h]=-1:M[h]=1;return r};var f=a("bit-twiddle"),g=a("gl-mat4/multiply"),h=a("split-polygon"),i=a("robust-orientation"),j=new Array(16),k=new Array(8),l=new Array(8),m=new Array(3),n=[0,0,0];function o(c,e,d){for(var a=0;a<4;++a){c[a]=d[12+a];for(var b=0;b<3;++b)c[a]+=e[b]*d[4*b+a]}}!function(){for(var a=0;a<8;++a)k[a]=[1,1,1,1],l[a]=[1,1,1]}();var p=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function q(b){for(var a=0;a<p.length;++a)if((b=h.positive(b,p[a])).length<3)return 0;for(var c=b[0],f=c[0]/c[3],g=c[1]/c[3],i=0,a=1;a+1<b.length;++a){var d=b[a],e=b[a+1],j=d[0]/d[3],k=d[1]/d[3],l=e[0]/e[3],m=e[1]/e[3],n=j-f,o=k-g,q=l-f,r=m-g;i+=Math.abs(n*r-o*q)}return i}var c=[1,1,1],d=[0,0,0],r={cubeEdges:c,axis:d}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(b,c,e){"use strict";c.exports=function(e,u,j){var c=[],n=[0,0,0],o=[0,0,0],p=[0,0,0],q=[0,0,0];c.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var b=0;b<3;++b){for(var i=c.length/3|0,k=0;k<j[b].length;++k){var a=+j[b][k].x;c.push(a,0,1,a,1,1,a,0,-1,a,0,-1,a,1,1,a,1,-1)}var l=c.length/3|0;n[b]=i,o[b]=l-i;for(var i=c.length/3|0,m=0;m<j[b].length;++m){var a=+j[b][m].x;c.push(a,0,1,a,1,1,a,0,-1,a,0,-1,a,1,1,a,1,-1)}var l=c.length/3|0;p[b]=i,q[b]=l-i}var r=f(e,new Float32Array(c)),t=g(e,[{buffer:r,type:e.FLOAT,size:3,stride:0,offset:0}]),s=h(e);return s.attributes.position.location=0,new d(e,r,t,s,o,n,q,p)};var f=b("gl-buffer"),g=b("gl-vao"),h=b("./shaders").line,i=[0,0,0],j=[0,0,0],k=[0,0,0],l=[0,0,0],m=[1,1];function n(a){return a[0]=a[1]=a[2]=0,a}function o(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function d(a,b,c,d,e,f,g,h){this.gl=a,this.vertBuffer=b,this.vao=c,this.shader=d,this.tickCount=e,this.tickOffset=f,this.gridCount=g,this.gridOffset=h}var a=d.prototype;a.bind=function(a,b,c){this.shader.bind(),this.shader.uniforms.model=a,this.shader.uniforms.view=b,this.shader.uniforms.projection=c,m[0]=this.gl.drawingBufferWidth,m[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=m,this.vao.bind()},a.unbind=function(){this.vao.unbind()},a.drawAxisLine=function(a,c,f,g,h){var d=n(j);this.shader.uniforms.majorAxis=j,d[a]=c[1][a]-c[0][a],this.shader.uniforms.minorAxis=d;var e=o(l,f);e[a]+=c[0][a],this.shader.uniforms.offset=e,this.shader.uniforms.lineWidth=h,this.shader.uniforms.color=g;var b=n(k);b[(a+2)%3]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,6);var b=n(k);b[(a+1)%3]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,6)},a.drawAxisTicks=function(a,d,e,f,g){if(this.tickCount[a]){var b=n(i);b[a]=1,this.shader.uniforms.majorAxis=b,this.shader.uniforms.offset=d,this.shader.uniforms.minorAxis=e,this.shader.uniforms.color=f,this.shader.uniforms.lineWidth=g;var c=n(k);c[a]=1,this.shader.uniforms.screenAxis=c,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a])}},a.drawGrid=function(a,b,c,h,m,p){if(this.gridCount[a]){var d=n(j);d[b]=c[1][b]-c[0][b],this.shader.uniforms.minorAxis=d;var e=o(l,h);e[b]+=c[0][b],this.shader.uniforms.offset=e;var f=n(i);f[a]=1,this.shader.uniforms.majorAxis=f;var g=n(k);g[a]=1,this.shader.uniforms.screenAxis=g,this.shader.uniforms.lineWidth=p,this.shader.uniforms.color=m,this.vao.draw(this.gl.TRIANGLES,this.gridCount[a],this.gridOffset[a])}},a.drawZero=function(a,f,b,g,h,i){var c=n(j);this.shader.uniforms.majorAxis=c,c[a]=b[1][a]-b[0][a],this.shader.uniforms.minorAxis=c;var d=o(l,g);d[a]+=b[0][a],this.shader.uniforms.offset=d;var e=n(k);e[f]=1,this.shader.uniforms.screenAxis=e,this.shader.uniforms.lineWidth=i,this.shader.uniforms.color=h,this.vao.draw(this.gl.TRIANGLES,6)},a.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(c,d,b){"use strict";var a=c("glslify"),e=c("gl-shader"),f=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),g=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);b.line=function(a){return e(a,f,g,null,[{name:"position",type:"vec3"}])};var h=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),i=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);b.text=function(a){return e(a,h,i,null,[{name:"position",type:"vec3"}])};var j=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),k=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);b.bg=function(a){return e(a,j,k,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(a,b,c){(function(c){(function(){"use strict";b.exports=function(a,e,i,k,l,m){var b=g(a),n=h(a,[{buffer:b,size:3}]),c=j(a);c.attributes.position.location=0;var d=new f(a,c,b,n);return d.update(e,i,k,l,m),d};var g=a("gl-buffer"),h=a("gl-vao"),i=a("vectorize-text"),j=a("./shaders").text,e=window||c.global||{},k=e.__TEXT_CACHE||{};function f(a,b,c,d){this.gl=a,this.shader=b,this.buffer=c,this.vao=d,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}e.__TEXT_CACHE={};var d=f.prototype,l=[0,0];d.bind=function(b,c,d,e){this.vao.bind(),this.shader.bind();var a=this.shader.uniforms;a.model=b,a.view=c,a.projection=d,a.pixelScale=e,l[0]=this.gl.drawingBufferWidth,l[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=l},d.unbind=function(){this.vao.unbind()},d.update=function(g,n,o,c,p){var d=[];function h(m,c,e,n,o,p){var a=k[e];a||(a=k[e]={});var b=a[c];b||(b=a[c]=function(a,b){try{return i(a,b)}catch(c){return console.warn('error vectorizing text:"'+a+'" error:',c),{cells:[],positions:[]}}}(c,{triangles:!0,font:e,textAlign:"center",textBaseline:"middle",lineSpacing:o,styletags:p}));for(var h=(n||12)/12,q=b.positions,j=b.cells,f=0,r=j.length;f<r;++f)for(var s=j[f],g=2;g>=0;--g){var l=q[s[g]];d.push(h*l[0],-h*l[1],m)}}for(var e=[0,0,0],j=[0,0,0],f=[0,0,0],l=[0,0,0],m={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},a=0;a<3;++a){f[a]=d.length/3|0,h(.5*(g[0][a]+g[1][a]),n[a],o[a],12,1.25,m),l[a]=(d.length/3|0)-f[a],e[a]=d.length/3|0;for(var b=0;b<c[a].length;++b)c[a][b].text&&h(c[a][b].x,c[a][b].text,c[a][b].font||p,c[a][b].fontSize||12,1.25,m);j[a]=(d.length/3|0)-e[a]}this.buffer.update(d),this.tickOffset=e,this.tickCount=j,this.labelOffset=f,this.labelCount=l},d.drawTicks=function(a,b,c,d,e,f,g,h){this.tickCount[a]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=e,this.shader.uniforms.angle=c,this.shader.uniforms.scale=b,this.shader.uniforms.offset=d,this.shader.uniforms.alignDir=g,this.shader.uniforms.alignOpt=h,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a]))},d.drawLabel=function(a,b,c,d,e,f,g,h){this.labelCount[a]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=e,this.shader.uniforms.angle=c,this.shader.uniforms.scale=b,this.shader.uniforms.offset=d,this.shader.uniforms.alignDir=g,this.shader.uniforms.alignOpt=h,this.vao.draw(this.gl.TRIANGLES,this.labelCount[a],this.labelOffset[a]))},d.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,a("_process"))},{"./shaders":74,"_process":5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(b,c,a){"use strict";function d(h,l){var i=h+"",j=i.indexOf("."),c=0;j>=0&&(c=i.length-j-1);var g=Math.pow(10,c),a=Math.round(h*l*g),k=a+"";if(k.indexOf("e")>=0)return k;var b=a/g,d=a%g;a<0?(b=0| -Math.ceil(b),d=0| -d):(b=0|Math.floor(b),d|=0);var e=""+b;if(a<0&&(e="-"+e),!c)return e;for(var f=""+d;f.length<c;)f="0"+f;return e+"."+f}a.create=function(e,c){for(var g=[],a=0;a<3;++a){var f=[];e[0][a]+e[1][a];for(var b=0;b*c[a]<=e[1][a];++b)f.push({x:b*c[a],text:d(c[a],b)});for(var b=-1;b*c[a]>=e[0][a];--b)f.push({x:b*c[a],text:d(c[a],b)});g.push(f)}return g},a.equal=function(e,f){for(var a=0;a<3;++a){if(e[a].length!==f[a].length)return!1;for(var d=0;d<e[a].length;++d){var b=e[a][d],c=f[a][d];if(b.x!==c.x||b.text!==c.text||b.font!==c.font||b.fontColor!==c.fontColor||b.fontSize!==c.fontSize||b.dx!==c.dx||b.dy!==c.dy)return!1}}return!0}},{}],77:[function(a,c,d){"use strict";c.exports=function(B,r,C,D,u){var v=r.model||k,w=r.view||k,x=r.projection||k,y=r._ortho||!1,s=B.bounds,u=u||g(v,w,x,s,y),E=u.axis;h(l,w,v),h(l,x,l);for(var d=p,b=0;b<3;++b)d[b].lo=1/0,d[b].hi=-1/0,d[b].pixelsPerDataUnit=1/0;var F=e(i(l,l));i(l,l);for(var j=0;j<3;++j){var z=(j+1)%3,m=(j+2)%3,t=q;i_loop:for(var b=0;b<2;++b){var n=[];if(E[j]<0!= !!b){t[j]=s[b][j];for(var c=0;c<2;++c){t[z]=s[c^b][z];for(var a=0;a<2;++a)t[m]=s[a^c^b][m],n.push(t.slice())}for(var A=y?5:4,c=A;c===A;++c){if(0===n.length)continue i_loop;n=f.positive(n,F[c])}for(var c=0;c<n.length;++c)for(var m=n[c],G=o(q,l,m,C,D),a=0;a<3;++a)d[a].lo=Math.min(d[a].lo,m[a]),d[a].hi=Math.max(d[a].hi,m[a]),a!==j&&(d[a].pixelsPerDataUnit=Math.min(d[a].pixelsPerDataUnit,Math.abs(G[a])))}}}return d};var e=a("extract-frustum-planes"),f=a("split-polygon"),g=a("./lib/cube.js"),h=a("gl-mat4/multiply"),i=a("gl-mat4/transpose"),j=a("gl-vec4/transformMat4"),k=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),l=new Float32Array(16);function b(a,b,c){this.lo=a,this.hi=b,this.pixelsPerDataUnit=c}var m=[0,0,0,1],n=[0,0,0,1];function o(e,f,i,k,l){for(var c=0;c<3;++c){for(var a=m,b=n,d=0;d<3;++d)b[d]=a[d]=i[d];b[3]=a[3]=1,b[c]+=1,j(b,b,f),b[3]<0&&(e[c]=1/0),a[c]-=1,j(a,a,f),a[3]<0&&(e[c]=1/0);var g=(a[0]/a[3]-b[0]/b[3])*k,h=(a[1]/a[3]-b[1]/b[3])*l;e[c]=.25*Math.sqrt(g*g+h*h)}return e}var p=[new b(1/0,-1/0,1/0),new b(1/0,-1/0,1/0),new b(1/0,-1/0,1/0)],q=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(b,c,e){"use strict";var f=b("typedarray-pool"),g=b("ndarray-ops"),h=b("ndarray"),i=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function d(a,b,c,d,e){this.gl=a,this.type=b,this.handle=c,this.length=d,this.usage=e}var a=d.prototype;function j(c,d,e,g,a,b){var f=a.length*a.BYTES_PER_ELEMENT;if(b<0)return c.bufferData(d,a,g),f;if(f+b>e)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return c.bufferSubData(d,b,a),e}function k(b,d){for(var c=f.malloc(b.length,d),e=b.length,a=0;a<e;++a)c[a]=b[a];return c}a.bind=function(){this.gl.bindBuffer(this.type,this.handle)},a.unbind=function(){this.gl.bindBuffer(this.type,null)},a.dispose=function(){this.gl.deleteBuffer(this.handle)},a.update=function(a,b){if("number"!=typeof b&&(b=-1),this.bind(),"object"==typeof a&& void 0!==a.shape){var d,c=a.dtype;if(0>i.indexOf(c)&&(c="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(c=gl.getExtension("OES_element_index_uint")&&"uint16"!==c?"uint32":"uint16"),c===a.dtype&&function(d,b){for(var c=1,a=b.length-1;a>=0;--a){if(b[a]!==c)return!1;c*=d[a]}return!0}(a.shape,a.stride))0===a.offset&&a.data.length===a.shape[0]?this.length=j(this.gl,this.type,this.length,this.usage,a.data,b):this.length=j(this.gl,this.type,this.length,this.usage,a.data.subarray(a.offset,a.shape[0]),b);else{var e=f.malloc(a.size,c),l=h(e,a.shape);g.assign(l,a),b<0?this.length=j(this.gl,this.type,this.length,this.usage,e,b):this.length=j(this.gl,this.type,this.length,this.usage,e.subarray(0,a.size),b),f.free(e)}}else if(Array.isArray(a))d=this.type===this.gl.ELEMENT_ARRAY_BUFFER?k(a,"uint16"):k(a,"float32"),b<0?this.length=j(this.gl,this.type,this.length,this.usage,d,b):this.length=j(this.gl,this.type,this.length,this.usage,d.subarray(0,a.length),b),f.free(d);else if("object"==typeof a&&"number"==typeof a.length)this.length=j(this.gl,this.type,this.length,this.usage,a,b);else if("number"==typeof a|| void 0===a){if(b>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(a|=0)<=0&&(a=1),this.gl.bufferData(this.type,0|a,this.usage),this.length=a}else throw new Error("gl-buffer: Invalid data type")},c.exports=function(a,f,c,b){if(c=c||a.ARRAY_BUFFER,b=b||a.DYNAMIC_DRAW,c!==a.ARRAY_BUFFER&&c!==a.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(b!==a.DYNAMIC_DRAW&&b!==a.STATIC_DRAW&&b!==a.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var g=a.createBuffer(),e=new d(a,c,g,0,b);return e.update(f),e}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(a,b,c){"use strict";var d=a("gl-vec3");b.exports=function(e,g){var q=e.positions,F=e.vectors,a={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(0===e.positions.length)return g&&(g[0]=[0,0,0],g[1]=[0,0,0]),a;for(var n=0,r=1/0,s=-1/0,t=1/0,u=-1/0,v=1/0,w=-1/0,y=null,z=null,A=[],o=1/0,x=!1,c=0;c<q.length;c++){var b=q[c];r=Math.min(b[0],r),s=Math.max(b[0],s),t=Math.min(b[1],t),u=Math.max(b[1],u),v=Math.min(b[2],v),w=Math.max(b[2],w);var p=F[c];if(d.length(p)>n&&(n=d.length(p)),c){var B=2*d.distance(y,b)/(d.length(z)+d.length(p));B?(o=Math.min(o,B),x=!1):x=!0}x||(y=b,z=p),A.push(p)}g&&(g[0]=[r,t,v],g[1]=[s,u,w]),0===n&&(n=1);var C=1/n;isFinite(o)||(o=1),a.vectorScale=o;var D=e.coneSize||.5;e.absoluteConeSize&&(D=e.absoluteConeSize*C),a.coneScale=D;for(var c=0,h=0;c<q.length;c++)for(var b=q[c],i=b[0],j=b[1],k=b[2],f=A[c],l=d.length(f)*C,E=0,G=8;E<G;E++){a.positions.push([i,j,k,h++]),a.positions.push([i,j,k,h++]),a.positions.push([i,j,k,h++]),a.positions.push([i,j,k,h++]),a.positions.push([i,j,k,h++]),a.positions.push([i,j,k,h++]),a.vectors.push(f),a.vectors.push(f),a.vectors.push(f),a.vectors.push(f),a.vectors.push(f),a.vectors.push(f),a.vertexIntensity.push(l,l,l),a.vertexIntensity.push(l,l,l);var m=a.positions.length;a.cells.push([m-6,m-5,m-4],[m-3,m-2,m-1])}return a};var e=a("./lib/shaders");b.exports.createMesh=a("./create_mesh"),b.exports.createConeMesh=function(a,c){return b.exports.createMesh(a,c,{shaders:e,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(b,c,e){"use strict";var f=b("gl-shader"),g=b("gl-buffer"),h=b("gl-vao"),i=b("gl-texture2d"),j=b("gl-mat4/multiply"),k=b("gl-mat4/invert"),l=b("ndarray"),m=b("colormap"),n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(a,b,c,d,e,f,g,h,i,j,k){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=c,this.pickShader=d,this.trianglePositions=e,this.triangleVectors=f,this.triangleColors=h,this.triangleUVs=i,this.triangleIds=g,this.triangleVAO=j,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=k,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=n,this._view=n,this._projection=n,this._resolution=[1,1]}var a=d.prototype;a.isOpaque=function(){return this.opacity>=1},a.isTransparent=function(){return this.opacity<1},a.pickSlots=1,a.setPickBase=function(a){this.pickId=a},a.update=function(a){a=a||{};var u=this.gl;this.dirty=!0,"lightPosition"in a&&(this.lightPosition=a.lightPosition),"opacity"in a&&(this.opacity=a.opacity),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),void 0!==a.tubeScale&&(this.tubeScale=a.tubeScale),void 0!==a.vectorScale&&(this.vectorScale=a.vectorScale),void 0!==a.coneScale&&(this.coneScale=a.coneScale),void 0!==a.coneOffset&&(this.coneOffset=a.coneOffset),a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=u.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=u.LINEAR,this.texture.setPixels(function(e){for(var f=m({colormap:e,nshades:256,format:"rgba"}),c=new Uint8Array(1024),a=0;a<256;++a){for(var d=f[a],b=0;b<3;++b)c[4*a+b]=d[b];c[4*a+3]=255*d[3]}return l(c,[256,256,4],[4,0,1])}(a.colormap)),this.texture.generateMipmap());var n=a.cells,e=a.positions,q=a.vectors;if(e&&n&&q){var v=[],w=[],r=[],x=[],y=[];this.cells=n,this.positions=e,this.vectors=q;var A=a.meshColor||[1,1,1,1],h=a.vertexIntensity,f=1/0,i=-1/0;if(h)if(a.vertexIntensityBounds)f=+a.vertexIntensityBounds[0],i=+a.vertexIntensityBounds[1];else for(var c=0;c<h.length;++c){var j=h[c];f=Math.min(f,j),i=Math.max(i,j)}else for(var c=0;c<e.length;++c){var j=e[c][2];f=Math.min(f,j),i=Math.max(i,j)}h?this.intensity=h:this.intensity=function(b){for(var c=b.length,d=new Array(c),a=0;a<c;++a)d[a]=b[a][2];return d}(e),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var c=0;c<e.length;++c)for(var d=e[c],b=0;b<3;++b)!isNaN(d[b])&&isFinite(d[b])&&(this.bounds[0][b]=Math.min(this.bounds[0][b],d[b]),this.bounds[1][b]=Math.max(this.bounds[1][b],d[b]));var z=0;fill_loop:for(var c=0;c<n.length;++c){var s=n[c];switch(s.length){case 3:for(var b=0;b<3;++b)for(var k=s[b],d=e[k],o=0;o<3;++o)if(isNaN(d[o])||!isFinite(d[o]))continue fill_loop;for(var b=0;b<3;++b){var t,k=s[2-b],d=e[k];v.push(d[0],d[1],d[2],d[3]);var p=q[k];w.push(p[0],p[1],p[2],p[3]||0);var g=A;3===g.length?r.push(g[0],g[1],g[2],1):r.push(g[0],g[1],g[2],g[3]),t=h?[(h[k]-f)/(i-f),0]:[(d[2]-f)/(i-f),0],x.push(t[0],t[1]),y.push(c)}z+=1;break;default:break}}this.triangleCount=z,this.trianglePositions.update(v),this.triangleVectors.update(w),this.triangleColors.update(r),this.triangleUVs.update(x),this.triangleIds.update(new Uint32Array(y))}},a.drawTransparent=a.draw=function(d){d=d||{};for(var f=this.gl,m=d.model||n,o=d.view||n,p=d.projection||n,e=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;a<3;++a)e[0][a]=Math.max(e[0][a],this.clipBounds[0][a]),e[1][a]=Math.min(e[1][a],this.clipBounds[1][a]);var c={model:m,view:o,projection:p,inverseModel:n.slice(),clipBounds:e,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};c.inverseModel=k(c.inverseModel,c.model),f.disable(f.CULL_FACE),this.texture.bind(0);var b=new Array(16);j(b,c.view,c.model),j(b,c.projection,b),k(b,b);for(var a=0;a<3;++a)c.eyePosition[a]=b[12+a]/b[15];for(var h=b[15],a=0;a<3;++a)h+=this.lightPosition[a]*b[4*a+3];for(var a=0;a<3;++a){for(var i=b[12+a],g=0;g<3;++g)i+=b[4*g+a]*this.lightPosition[g];c.lightPosition[a]=i/h}if(this.triangleCount>0){var l=this.triShader;l.bind(),l.uniforms=c,this.triangleVAO.bind(),f.drawArrays(f.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},a.drawPick=function(b){b=b||{};for(var d=this.gl,e=b.model||n,f=b.view||n,g=b.projection||n,c=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;a<3;++a)c[0][a]=Math.max(c[0][a],this.clipBounds[0][a]),c[1][a]=Math.min(c[1][a],this.clipBounds[1][a]);this._model=[].slice.call(e),this._view=[].slice.call(f),this._projection=[].slice.call(g),this._resolution=[d.drawingBufferWidth,d.drawingBufferHeight];var i={model:e,view:f,projection:g,clipBounds:c,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},h=this.pickShader;h.bind(),h.uniforms=i,this.triangleCount>0&&(this.triangleVAO.bind(),d.drawArrays(d.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},a.pick=function(c){if(!c)return null;if(c.id!==this.pickId)return null;var d=c.value[0]+256*c.value[1]+65536*c.value[2],a=this.cells[d],e=this.positions[a[1]].slice(0,3),b={position:e,dataCoordinate:e,index:Math.floor(a[1]/48)};return"cone"===this.traceType?b.index=Math.floor(a[1]/48):"streamtube"===this.traceType&&(b.intensity=this.intensity[a[1]],b.velocity=this.vectors[a[1]].slice(0,3),b.divergence=this.vectors[a[1]][3],b.index=d),b},a.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},c.exports=function(a,m,n){var j,b,o=n.shaders;1===arguments.length&&(a=(m=a).gl);var k,c,v=((b=f(a,(j=o).meshShader.vertex,j.meshShader.fragment,null,j.meshShader.attributes)).attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b.attributes.vector.location=4,b),w=((c=f(a,(k=o).pickShader.vertex,k.pickShader.fragment,null,k.pickShader.attributes)).attributes.position.location=0,c.attributes.id.location=1,c.attributes.vector.location=4,c),e=i(a,l(new Uint8Array([255,255,255,255]),[1,1,4]));e.generateMipmap(),e.minFilter=a.LINEAR_MIPMAP_LINEAR,e.magFilter=a.LINEAR;var p=g(a),q=g(a),r=g(a),s=g(a),t=g(a),x=h(a,[{buffer:p,type:a.FLOAT,size:4},{buffer:t,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:r,type:a.FLOAT,size:4},{buffer:s,type:a.FLOAT,size:2},{buffer:q,type:a.FLOAT,size:4}]),u=new d(a,e,v,w,p,q,t,r,s,x,n.traceType||"cone");return u.update(m),u}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(c,h,b){var a=c("glslify"),d=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),e=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),f=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),g=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);b.meshShader={vertex:d,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},b.pickShader={vertex:f,fragment:g,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(b,a,c){a.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(a,b,c){var d=a("./1.0/numbers");b.exports=function(a){return d[a]}},{"./1.0/numbers":82}],84:[function(b,c,e){"use strict";c.exports=function(e){var a=e.gl,b=f(a),j=g(a,[{buffer:b,type:a.FLOAT,size:3,offset:0,stride:40},{buffer:b,type:a.FLOAT,size:4,offset:12,stride:40},{buffer:b,type:a.FLOAT,size:3,offset:28,stride:40}]),c=h(a);c.attributes.position.location=0,c.attributes.color.location=1,c.attributes.offset.location=2;var i=new d(a,b,j,c);return i.update(e),i};var f=b("gl-buffer"),g=b("gl-vao"),h=b("./shaders/index"),i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(a,b,c,d){this.gl=a,this.shader=d,this.buffer=b,this.vao=c,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var a=d.prototype;function j(b,c){for(var a=0;a<3;++a)b[0][a]=Math.min(b[0][a],c[a]),b[1][a]=Math.max(b[1][a],c[a])}a.isOpaque=function(){return!this.hasAlpha},a.isTransparent=function(){return this.hasAlpha},a.drawTransparent=a.draw=function(c){var d=this.gl,b=this.shader.uniforms;this.shader.bind();var e=b.view=c.view||i,f=b.projection=c.projection||i;b.model=c.model||i,b.clipBounds=this.clipBounds,b.opacity=this.opacity;var g=e[12],h=e[13],j=e[14],k=e[15],l=c._ortho||!1,m=(l?2:1)*this.pixelRatio*(f[3]*g+f[7]*h+f[11]*j+f[15]*k)/d.drawingBufferHeight;this.vao.bind();for(var a=0;a<3;++a)d.lineWidth(this.lineWidth[a]*this.pixelRatio),b.capSize=this.capSize[a]*m,this.lineCount[a]&&d.drawArrays(d.LINES,this.lineOffset[a],this.lineCount[a]);this.vao.unbind()};var k=function(){for(var d=new Array(3),a=0;a<3;++a){for(var e=[],b=1;b<=2;++b)for(var c=-1;c<=1;c+=2){var f=[0,0,0];f[(b+a)%3]=c,e.push(f)}d[a]=e}return d}();function l(f,b,a,g){for(var c=k[g],d=0;d<c.length;++d){var e=c[d];f.push(b[0],b[1],b[2],a[0],a[1],a[2],a[3],e[0],e[1],e[2])}return c.length}a.update=function(d){"lineWidth"in(d=d||{})&&(this.lineWidth=d.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in d&&(this.capSize=d.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in d&&(this.opacity=+d.opacity,this.opacity<1&&(this.hasAlpha=!0));var f=d.color||[[0,0,0],[0,0,0],[0,0,0]],n=d.position,o=d.error;if(Array.isArray(f[0])||(f=[f,f,f]),n&&o){var h=[],p=n.length,k=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var b=0;b<3;++b){this.lineOffset[b]=k;i_loop:for(var i=0;i<p;++i){for(var e=n[i],m=0;m<3;++m)if(isNaN(e[m])||!isFinite(e[m]))continue i_loop;var g=o[i],a=f[b];if(Array.isArray(a[0])&&(a=f[i]),3===a.length?a=[a[0],a[1],a[2],1]:4===a.length&&(a=[a[0],a[1],a[2],a[3]],!this.hasAlpha&&a[3]<1&&(this.hasAlpha=!0)),!(isNaN(g[0][b])||isNaN(g[1][b]))){if(g[0][b]<0){var c=e.slice();c[b]+=g[0][b],h.push(e[0],e[1],e[2],a[0],a[1],a[2],a[3],0,0,0,c[0],c[1],c[2],a[0],a[1],a[2],a[3],0,0,0),j(this.bounds,c),k+=2+l(h,c,a,b)}if(g[1][b]>0){var c=e.slice();c[b]+=g[1][b],h.push(e[0],e[1],e[2],a[0],a[1],a[2],a[3],0,0,0,c[0],c[1],c[2],a[0],a[1],a[2],a[3],0,0,0),j(this.bounds,c),k+=2+l(h,c,a,b)}}}this.lineCount[b]=k-this.lineOffset[b]}this.buffer.update(h)}},a.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(a,c,d){"use strict";var b=a("glslify"),e=a("gl-shader"),f=b(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),g=b(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);c.exports=function(a){return e(a,f,g,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(b,c,e){"use strict";var f,g,h,i,j=b("gl-texture2d");c.exports=function(a,c,j,b){f||(f=a.FRAMEBUFFER_UNSUPPORTED,g=a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,h=a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,i=a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var l=a.getExtension("WEBGL_draw_buffers");if(!k&&l&&function(d,f){var c=d.getParameter(f.MAX_COLOR_ATTACHMENTS_WEBGL);k=new Array(c+1);for(var b=0;b<=c;++b){for(var e=new Array(c),a=0;a<b;++a)e[a]=d.COLOR_ATTACHMENT0+a;for(var a=b;a<c;++a)e[a]=d.NONE;k[b]=e}}(a,l),Array.isArray(c)&&(b=j,j=0|c[1],c=0|c[0]),"number"!=typeof c)throw new Error("gl-fbo: Missing shape parameter");var n=a.getParameter(a.MAX_RENDERBUFFER_SIZE);if(c<0||c>n||j<0||j>n)throw new Error("gl-fbo: Parameters are too large for FBO");var e=1;if("color"in(b=b||{})){if((e=Math.max(0|b.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(e>1)if(l){if(e>a.getParameter(l.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+e+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var m=a.UNSIGNED_BYTE,o=a.getExtension("OES_texture_float");if(b.float&&e>0){if(!o)throw new Error("gl-fbo: Context does not support floating point textures");m=a.FLOAT}else b.preferFloat&&e>0&&o&&(m=a.FLOAT);var p=!0;"depth"in b&&(p=!!b.depth);var q=!1;return"stencil"in b&&(q=!!b.stencil),new d(a,c,j,m,e,p,q,l)};var k=null;function l(a){var b=a.getParameter(a.FRAMEBUFFER_BINDING),c=a.getParameter(a.RENDERBUFFER_BINDING),d=a.getParameter(a.TEXTURE_BINDING_2D);return[b,c,d]}function m(a,b){a.bindFramebuffer(a.FRAMEBUFFER,b[0]),a.bindRenderbuffer(a.RENDERBUFFER,b[1]),a.bindTexture(a.TEXTURE_2D,b[2])}function n(a){switch(a){case f:throw new Error("gl-fbo: Framebuffer unsupported");case g:throw new Error("gl-fbo: Framebuffer incomplete attachment");case h:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case i:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function o(a,d,e,c,f,g){if(!c)return null;var b=j(a,d,e,f,c);return b.magFilter=a.NEAREST,b.minFilter=a.NEAREST,b.mipSamples=1,b.bind(),a.framebufferTexture2D(a.FRAMEBUFFER,g,a.TEXTURE_2D,b.handle,0),b}function p(a,c,d,e,f){var b=a.createRenderbuffer();return a.bindRenderbuffer(a.RENDERBUFFER,b),a.renderbufferStorage(a.RENDERBUFFER,e,c,d),a.framebufferRenderbuffer(a.FRAMEBUFFER,f,a.RENDERBUFFER,b),b}function d(f,b,c,g,d,h,i,j){this.gl=f,this._shape=[0|b,0|c],this._destroyed=!1,this._ext=j,this.color=new Array(d);for(var a=0;a<d;++a)this.color[a]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=g,this._useDepth=h,this._useStencil=i;var q=this,e=[0|b,0|c];Object.defineProperties(e,{0:{get:function(){return q._shape[0]},set:function(a){return q.width=a}},1:{get:function(){return q._shape[1]},set:function(a){return q.height=a}}}),this._shapeVector=e,function(b){var j=l(b.gl),a=b.gl,s=b.handle=a.createFramebuffer(),d=b._shape[0],e=b._shape[1],f=b.color.length,g=b._ext,h=b._useStencil,i=b._useDepth,t=b._colorType;a.bindFramebuffer(a.FRAMEBUFFER,s);for(var c=0;c<f;++c)b.color[c]=o(a,d,e,t,a.RGBA,a.COLOR_ATTACHMENT0+c);0===f?(b._color_rb=p(a,d,e,a.RGBA4,a.COLOR_ATTACHMENT0),g&&g.drawBuffersWEBGL(k[0])):f>1&&g.drawBuffersWEBGL(k[f]);var q=a.getExtension("WEBGL_depth_texture");q?h?b.depth=o(a,d,e,q.UNSIGNED_INT_24_8_WEBGL,a.DEPTH_STENCIL,a.DEPTH_STENCIL_ATTACHMENT):i&&(b.depth=o(a,d,e,a.UNSIGNED_SHORT,a.DEPTH_COMPONENT,a.DEPTH_ATTACHMENT)):i&&h?b._depth_rb=p(a,d,e,a.DEPTH_STENCIL,a.DEPTH_STENCIL_ATTACHMENT):i?b._depth_rb=p(a,d,e,a.DEPTH_COMPONENT16,a.DEPTH_ATTACHMENT):h&&(b._depth_rb=p(a,d,e,a.STENCIL_INDEX,a.STENCIL_ATTACHMENT));var r=a.checkFramebufferStatus(a.FRAMEBUFFER);if(r!==a.FRAMEBUFFER_COMPLETE){b._destroyed=!0,a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteFramebuffer(b.handle),b.handle=null,b.depth&&(b.depth.dispose(),b.depth=null),b._depth_rb&&(a.deleteRenderbuffer(b._depth_rb),b._depth_rb=null);for(var c=0;c<b.color.length;++c)b.color[c].dispose(),b.color[c]=null;b._color_rb&&(a.deleteRenderbuffer(b._color_rb),b._color_rb=null),m(a,j),n(r)}m(a,j)}(this)}var a=d.prototype;function q(a,c,d){if(a._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(a._shape[0]!==c||a._shape[1]!==d){var b=a.gl,f=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(c<0||c>f||d<0||d>f)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");a._shape[0]=c,a._shape[1]=d;for(var g=l(b),e=0;e<a.color.length;++e)a.color[e].shape=a._shape;a._color_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,a._color_rb),b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,a._shape[0],a._shape[1])),a.depth&&(a.depth.shape=a._shape),a._depth_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,a._depth_rb),a._useDepth&&a._useStencil?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,a._shape[0],a._shape[1]):a._useDepth?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,a._shape[0],a._shape[1]):a._useStencil&&b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX,a._shape[0],a._shape[1])),b.bindFramebuffer(b.FRAMEBUFFER,a.handle);var h=b.checkFramebufferStatus(b.FRAMEBUFFER);h!==b.FRAMEBUFFER_COMPLETE&&(a.dispose(),m(b,g),n(h)),m(b,g)}}Object.defineProperties(a,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(a){if(Array.isArray(a)||(a=[0|a,0|a]),2!==a.length)throw new Error("gl-fbo: Shape vector must be length 2");var b=0|a[0],c=0|a[1];return q(this,b,c),[b,c]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(a){return q(this,a|=0,this._shape[1]),a},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(a){return a|=0,q(this,this._shape[0],a),a},enumerable:!1}}),a.bind=function(){if(!this._destroyed){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,this.handle),a.viewport(0,0,this._shape[0],this._shape[1])}},a.dispose=function(){if(!this._destroyed){this._destroyed=!0;var b=this.gl;b.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(b.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var a=0;a<this.color.length;++a)this.color[a].dispose(),this.color[a]=null;this._color_rb&&(b.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(a,b,c){var d=a("sprintf-js").sprintf,e=a("gl-constants/lookup"),f=a("glsl-shader-name"),g=a("add-line-numbers");b.exports=function(j,k,l){"use strict";var q=f(k)||"of unknown name (see npm glsl-shader-name)",m="unknown type";void 0!==l&&(m=l===e.FRAGMENT_SHADER?"fragment":"vertex");for(var h=d("Error compiling %s shader %s:\n",m,q),r=d("%s%s",h,j),n=j.split("\n"),b={},a=0;a<n.length;a++){var c=n[a];if(""!==c&&"\0"!==c){var o=parseInt(c.split(":")[2]);if(isNaN(o))throw new Error(d("Could not parse error: %s",c));b[o]=c}}for(var p=g(k).split("\n"),a=0;a<p.length;a++)if((b[a+3]||b[a+2]||b[a+1])&&(h+=p[a]+"\n",b[a+1])){var i=b[a+1];h+=d("^^^ %s\n\n",i=i.substr(i.split(":",3).join(":").length+1).trim())}return{long:h.trim(),short:r.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(a,c,h){"use strict";c.exports=function(b,e){var a=b.gl,f=l(a,n.vertex,n.fragment),g=l(a,n.pickVertex,n.pickFragment),h=m(a),i=m(a),j=m(a),k=m(a),c=new d(b,f,g,h,i,j,k);return c.update(e),b.addObject(c),c};var i=a("binary-search-bounds"),j=a("iota-array"),k=a("typedarray-pool"),l=a("gl-shader"),m=a("gl-buffer"),n=a("./lib/shaders");function d(a,b,c,d,e,f,g){this.plot=a,this.shader=b,this.pickShader=c,this.positionBuffer=d,this.weightBuffer=e,this.colorBuffer=f,this.idBuffer=g,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var e,f,g,b=d.prototype,o=[0,0,1,0,0,1,1,0,1,1,0,1];b.draw=(e=[1,0,0,0,1,0,0,0,1],function(){var g=this.plot,d=this.shader,a=this.bounds,h=this.numVertices;if(!(h<=0)){var c=g.gl,b=g.dataBox,l=a[2]-a[0],m=a[3]-a[1],i=b[2]-b[0],j=b[3]-b[1];e[0]=2*l/i,e[4]=2*m/j,e[6]=2*(a[0]-b[0])/i-1,e[7]=2*(a[1]-b[1])/j-1,d.bind();var k=d.uniforms;k.viewTransform=e,k.shape=this.shape;var f=d.attributes;this.positionBuffer.bind(),f.position.pointer(),this.weightBuffer.bind(),f.weight.pointer(c.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),f.color.pointer(c.UNSIGNED_BYTE,!0),c.drawArrays(c.TRIANGLES,0,h)}}),b.drawPick=(f=[1,0,0,0,1,0,0,0,1],g=[0,0,0,0],function(e){var k=this.plot,h=this.pickShader,a=this.bounds,l=this.numVertices;if(!(l<=0)){var c=k.gl,b=k.dataBox,o=a[2]-a[0],p=a[3]-a[1],m=b[2]-b[0],n=b[3]-b[1];f[0]=2*o/m,f[4]=2*p/n,f[6]=2*(a[0]-b[0])/m-1,f[7]=2*(a[1]-b[1])/n-1;for(var d=0;d<4;++d)g[d]=e>>8*d&255;this.pickOffset=e,h.bind();var i=h.uniforms;i.viewTransform=f,i.pickOffset=g,i.shape=this.shape;var j=h.attributes;return this.positionBuffer.bind(),j.position.pointer(),this.weightBuffer.bind(),j.weight.pointer(c.UNSIGNED_BYTE,!1),this.idBuffer.bind(),j.pickId.pointer(c.UNSIGNED_BYTE,!1),c.drawArrays(c.TRIANGLES,0,l),e+this.shape[0]*this.shape[1]}}),b.pick=function(e,f,a){var b=this.pickOffset,d=this.shape[0]*this.shape[1];if(a<b||a>=b+d)return null;var c=a-b;return{object:this,pointId:c,dataCoord:[this.xData[c%this.shape[0]],this.yData[c/this.shape[0]|0]]}},b.update=function(h){var q=(h=h||{}).shape||[0,0],a=h.x||j(q[0]),b=h.y||j(q[1]),M=h.z||new Float32Array(q[0]*q[1]),m=!1!==h.zsmooth;this.xData=a,this.yData=b;var u=h.colorLevels||[0],e=h.colorValues||[0,0,0,1],v=u.length,l=this.bounds;m?(T=l[0]=a[0],U=l[1]=b[0],V=l[2]=a[a.length-1],W=l[3]=b[b.length-1]):(T=l[0]=a[0]+(a[1]-a[0])/2,U=l[1]=b[0]+(b[1]-b[0])/2,V=l[2]=a[a.length-1]+(a[a.length-1]-a[a.length-2])/2,W=l[3]=b[b.length-1]+(b[b.length-1]-b[b.length-2])/2);var r=1/(V-T),s=1/(W-U),f=q[0],n=q[1];this.shape=[f,n];var w=(m?(f-1)*(n-1):f*n)*(o.length>>>1);this.numVertices=w;for(var t=k.mallocUint8(4*w),y=k.mallocFloat32(2*w),z=k.mallocUint8(2*w),I=k.mallocUint32(w),g=0,N=m?f-1:f,O=m?n-1:n,c=0;c<O;++c){m?(P=s*(b[c]-U),Q=s*(b[c+1]-U)):(P=c<n-1?s*(b[c]-(b[c+1]-b[c])/2-U):s*(b[c]-(b[c]-b[c-1])/2-U),Q=c<n-1?s*(b[c]+(b[c+1]-b[c])/2-U):s*(b[c]+(b[c]-b[c-1])/2-U));for(var d=0;d<N;++d){m?(R=r*(a[d]-T),S=r*(a[d+1]-T)):(R=d<f-1?r*(a[d]-(a[d+1]-a[d])/2-T):r*(a[d]-(a[d]-a[d-1])/2-T),S=d<f-1?r*(a[d]+(a[d+1]-a[d])/2-T):r*(a[d]+(a[d]-a[d-1])/2-T));for(var A=0;A<o.length;A+=2){var T,U,V,W,P,Q,R,S,B,C,D,E,J=o[A],K=o[A+1],L=M[m?(c+K)*f+(d+J):c*f+d],p=i.le(u,L);if(p<0)B=e[0],C=e[1],D=e[2],E=e[3];else if(p===v-1)B=e[4*v-4],C=e[4*v-3],D=e[4*v-2],E=e[4*v-1];else{var x=(L-u[p])/(u[p+1]-u[p]),F=1-x,G=4*p,H=4*(p+1);B=F*e[G]+x*e[H],C=F*e[G+1]+x*e[H+1],D=F*e[G+2]+x*e[H+2],E=F*e[G+3]+x*e[H+3]}t[4*g]=255*B,t[4*g+1]=255*C,t[4*g+2]=255*D,t[4*g+3]=255*E,y[2*g]=.5*R+.5*S,y[2*g+1]=.5*P+.5*Q,z[2*g]=J,z[2*g+1]=K,I[g]=c*f+d,g+=1}}}this.positionBuffer.update(y),this.weightBuffer.update(z),this.colorBuffer.update(t),this.idBuffer.update(I),k.free(y),k.free(t),k.free(z),k.free(I)},b.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(b,c,d){"use strict";var a=b("glslify");c.exports={fragment:a(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:231}],90:[function(b,d,c){var a=b("glslify"),e=b("gl-shader"),f=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),g=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),h=a(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),i=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];c.createShader=function(a){return e(a,f,g,null,i)},c.createPickShader=function(a){return e(a,f,h,null,i)}},{"gl-shader":132,glslify:231}],91:[function(b,d,g){"use strict";d.exports=function(e){var a=e.gl||e.scene&&e.scene.gl,b=n(a);b.attributes.position.location=0,b.attributes.nextPosition.location=1,b.attributes.arcLength.location=2,b.attributes.lineWidth.location=3,b.attributes.color.location=4;var c=o(a);c.attributes.position.location=0,c.attributes.nextPosition.location=1,c.attributes.arcLength.location=2,c.attributes.lineWidth.location=3,c.attributes.color.location=4;for(var d=h(a),q=i(a,[{buffer:d,size:3,offset:0,stride:48},{buffer:d,size:3,offset:12,stride:48},{buffer:d,size:1,offset:24,stride:48},{buffer:d,size:1,offset:28,stride:48},{buffer:d,size:4,offset:32,stride:48}]),k=m(new Array(1024),[256,1,4]),g=0;g<1024;++g)k.data[g]=255;var l=j(a,k);l.wrap=a.REPEAT;var p=new f(a,b,c,d,q,l);return p.update(e),p};var h=b("gl-buffer"),i=b("gl-vao"),j=b("gl-texture2d"),e=new Uint8Array(4),k=new Float32Array(e.buffer),l=b("binary-search-bounds"),m=b("ndarray"),c=b("./lib/shaders"),n=c.createShader,o=c.createPickShader,p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function q(d,e){for(var b=0,a=0;a<3;++a){var c=d[a]-e[a];b+=c*c}return Math.sqrt(b)}function r(c){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;a<3;++a)b[0][a]=Math.max(c[0][a],b[0][a]),b[1][a]=Math.min(c[1][a],b[1][a]);return b}function s(a,b,c,d){this.arcLength=a,this.position=b,this.index=c,this.dataCoordinate=d}function f(a,b,c,d,e,f){this.gl=a,this.shader=b,this.pickShader=c,this.buffer=d,this.vao=e,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=f,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var a=f.prototype;a.isTransparent=function(){return this.hasAlpha},a.isOpaque=function(){return!this.hasAlpha},a.pickSlots=1,a.setPickBase=function(a){this.pickId=a},a.drawTransparent=a.draw=function(a){if(this.vertexCount){var b=this.gl,d=this.shader,c=this.vao;d.bind(),d.uniforms={model:a.model||p,view:a.view||p,projection:a.projection||p,clipBounds:r(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},c.bind(),c.draw(b.TRIANGLE_STRIP,this.vertexCount),c.unbind()}},a.drawPick=function(a){if(this.vertexCount){var b=this.gl,d=this.pickShader,c=this.vao;d.bind(),d.uniforms={model:a.model||p,view:a.view||p,projection:a.projection||p,pickId:this.pickId,clipBounds:r(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},c.bind(),c.draw(b.TRIANGLE_STRIP,this.vertexCount),c.unbind()}},a.update=function(g){this.dirty=!0;var z=!!g.connectGaps;"dashScale"in g&&(this.dashScale=g.dashScale),this.hasAlpha=!1,"opacity"in g&&(this.opacity=+g.opacity,this.opacity<1&&(this.hasAlpha=!0));var j=[],u=[],v=[],n=0,s=0,r=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],o=g.position||g.positions;if(o){var h=g.color||g.colors||[0,0,0,1],k=g.lineWidth||1,w=!1;fill_loop:for(b=1;b<o.length;++b){var b,a,d,f,p,c=o[b-1],e=o[b];for(u.push(n),v.push(c.slice()),a=0;a<3;++a){if(isNaN(c[a])||isNaN(e[a])||!isFinite(c[a])||!isFinite(e[a])){if(!z&&j.length>0){for(var y=0;y<24;++y)j.push(j[j.length-12]);s+=2,w=!0}continue fill_loop}r[0][a]=Math.min(r[0][a],c[a],e[a]),r[1][a]=Math.max(r[1][a],c[a],e[a])}Array.isArray(h[0])?(d=h.length>b-1?h[b-1]:h.length>0?h[h.length-1]:[0,0,0,1],f=h.length>b?h[b]:h.length>0?h[h.length-1]:[0,0,0,1]):d=f=h,3===d.length&&(d=[d[0],d[1],d[2],1]),3===f.length&&(f=[f[0],f[1],f[2],1]),!this.hasAlpha&&d[3]<1&&(this.hasAlpha=!0),p=Array.isArray(k)?k.length>b-1?k[b-1]:k.length>0?k[k.length-1]:[0,0,0,1]:k;var x=n;if(n+=q(c,e),w){for(a=0;a<2;++a)j.push(c[0],c[1],c[2],e[0],e[1],e[2],x,p,d[0],d[1],d[2],d[3]);s+=2,w=!1}j.push(c[0],c[1],c[2],e[0],e[1],e[2],x,p,d[0],d[1],d[2],d[3],c[0],c[1],c[2],e[0],e[1],e[2],x,-p,d[0],d[1],d[2],d[3],e[0],e[1],e[2],c[0],c[1],c[2],n,-p,f[0],f[1],f[2],f[3],e[0],e[1],e[2],c[0],c[1],c[2],n,p,f[0],f[1],f[2],f[3]),s+=4}}if(this.buffer.update(j),u.push(n),v.push(o[o.length-1].slice()),this.bounds=r,this.vertexCount=s,this.points=v,this.arcLength=u,"dashes"in g){var i=g.dashes.slice();for(i.unshift(0),b=1;b<i.length;++b)i[b]=i[b-1]+i[b];var t=m(new Array(1024),[256,1,4]);for(b=0;b<256;++b){for(a=0;a<4;++a)t.set(b,0,a,0);1&l.le(i,i[i.length-1]*b/255)?t.set(b,0,0,0):t.set(b,0,0,255)}this.texture.setPixels(t)}},a.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},a.pick=function(b){if(!b)return null;if(b.id!==this.pickId)return null;var g,h,i,d=(g=b.value[0],h=b.value[1],i=b.value[2],e[0]=0,e[1]=i,e[2]=h,e[3]=g,k[0]),a=l.le(this.arcLength,d);if(a<0)return null;if(a===this.arcLength.length-1)return new s(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),a);for(var n=this.points[a],o=this.points[Math.min(a+1,this.points.length-1)],f=(d-this.arcLength[a])/(this.arcLength[a+1]-this.arcLength[a]),p=1-f,j=[0,0,0],c=0;c<3;++c)j[c]=p*n[c]+f*o[c];var m=Math.min(f<.5?a:a+1,this.points.length-1);return new s(d,j,m,this.points[m])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(b,a,c){a.exports=function(b){var a=new Float32Array(16);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}},{}],93:[function(b,a,c){a.exports=function(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],94:[function(b,a,c){a.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15];return(b*g-c*f)*(l*q-m*p)-(b*h-d*f)*(k*q-m*o)+(b*i-e*f)*(k*p-l*o)+(c*h-d*g)*(j*q-m*n)-(c*i-e*g)*(j*p-l*n)+(d*i-e*h)*(j*o-k*n)}},{}],95:[function(b,a,c){a.exports=function(a,c){var f=c[0],d=c[1],b=c[2],g=c[3],e=f+f,h=d+d,i=b+b,j=f*e,k=d*e,l=d*h,m=b*e,n=b*h,o=b*i,p=g*e,q=g*h,r=g*i;return a[0]=1-l-o,a[1]=k+r,a[2]=m-q,a[3]=0,a[4]=k-r,a[5]=1-j-o,a[6]=n+p,a[7]=0,a[8]=m+q,a[9]=n-p,a[10]=1-j-l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],96:[function(b,a,c){a.exports=function(a,c,f){var b=c[0],d=c[1],g=c[2],h=c[3],j=b+b,i=d+d,e=g+g,k=b*j,l=b*i,m=b*e,n=d*i,o=d*e,p=g*e,q=h*j,r=h*i,s=h*e;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=f[0],a[13]=f[1],a[14]=f[2],a[15]=1,a}},{}],97:[function(b,a,c){a.exports=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],98:[function(b,a,c){a.exports=function(b,c){var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14],s=c[15],t=d*i-e*h,u=d*j-f*h,v=d*k-g*h,w=e*j-f*i,x=e*k-g*i,y=f*k-g*j,z=l*q-m*p,A=l*r-n*p,B=l*s-o*p,C=m*r-n*q,D=m*s-o*q,E=n*s-o*r,a=t*E-u*D+v*C+w*B-x*A+y*z;return a?(a=1/a,b[0]=(i*E-j*D+k*C)*a,b[1]=(f*D-e*E-g*C)*a,b[2]=(q*y-r*x+s*w)*a,b[3]=(n*x-m*y-o*w)*a,b[4]=(j*B-h*E-k*A)*a,b[5]=(d*E-f*B+g*A)*a,b[6]=(r*v-p*y-s*u)*a,b[7]=(l*y-n*v+o*u)*a,b[8]=(h*D-i*B+k*z)*a,b[9]=(e*B-d*D-g*z)*a,b[10]=(p*x-q*v+s*t)*a,b[11]=(m*v-l*x-o*t)*a,b[12]=(i*A-h*C-j*z)*a,b[13]=(d*C-e*A+f*z)*a,b[14]=(q*u-p*w-r*t)*a,b[15]=(l*w-m*u+n*t)*a,b):null}},{}],99:[function(a,b,c){var d=a("./identity");b.exports=function(a,p,q,r){var f,g,h,j,k,l,c,e,i,b,m=p[0],n=p[1],o=p[2],s=r[0],t=r[1],u=r[2],v=q[0],w=q[1],x=q[2];return 1e-6>Math.abs(m-v)&&1e-6>Math.abs(n-w)&&1e-6>Math.abs(o-x)?d(a):(c=m-v,e=n-w,c*=b=1/Math.sqrt(c*c+e*e+(i=o-x)*i),e*=b,i*=b,f=t*i-u*e,g=u*c-s*i,h=s*e-t*c,b=Math.sqrt(f*f+g*g+h*h),b?(f*=b=1/b,g*=b,h*=b):(f=0,g=0,h=0),j=e*h-i*g,k=i*f-c*h,l=c*g-e*f,b=Math.sqrt(j*j+k*k+l*l),b?(j*=b=1/b,k*=b,l*=b):(j=0,k=0,l=0),a[0]=f,a[1]=j,a[2]=c,a[3]=0,a[4]=g,a[5]=k,a[6]=e,a[7]=0,a[8]=h,a[9]=l,a[10]=i,a[11]=0,a[12]=-(f*m+g*n+h*o),a[13]=-(j*m+k*n+l*o),a[14]=-(c*m+e*n+i*o),a[15]=1,a)}},{"./identity":97}],100:[function(b,a,c){a.exports=function(e,f,g){var h=f[0],i=f[1],j=f[2],k=f[3],l=f[4],m=f[5],n=f[6],o=f[7],p=f[8],q=f[9],r=f[10],s=f[11],t=f[12],u=f[13],v=f[14],w=f[15],a=g[0],b=g[1],c=g[2],d=g[3];return e[0]=a*h+b*l+c*p+d*t,e[1]=a*i+b*m+c*q+d*u,e[2]=a*j+b*n+c*r+d*v,e[3]=a*k+b*o+c*s+d*w,a=g[4],b=g[5],c=g[6],d=g[7],e[4]=a*h+b*l+c*p+d*t,e[5]=a*i+b*m+c*q+d*u,e[6]=a*j+b*n+c*r+d*v,e[7]=a*k+b*o+c*s+d*w,a=g[8],b=g[9],c=g[10],d=g[11],e[8]=a*h+b*l+c*p+d*t,e[9]=a*i+b*m+c*q+d*u,e[10]=a*j+b*n+c*r+d*v,e[11]=a*k+b*o+c*s+d*w,a=g[12],b=g[13],c=g[14],d=g[15],e[12]=a*h+b*l+c*p+d*t,e[13]=a*i+b*m+c*q+d*u,e[14]=a*j+b*n+c*r+d*v,e[15]=a*k+b*o+c*s+d*w,e}},{}],101:[function(b,a,c){a.exports=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a}},{}],102:[function(b,a,c){a.exports=function(a,f,g,b,c){var d=1/Math.tan(f/2),e=1/(b-c);return a[0]=d/g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(c+b)*e,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*c*b*e,a[15]=0,a}},{}],103:[function(b,a,c){a.exports=function(a,b,F,E){var g,h,f,s,t,u,v,w,x,y,z,A,B,C,D,i,j,k,l,m,n,o,p,q,c=E[0],d=E[1],e=E[2],r=Math.sqrt(c*c+d*d+e*e);return 1e-6>Math.abs(r)?null:(c*=r=1/r,d*=r,e*=r,g=Math.sin(F),h=Math.cos(F),f=1-h,s=b[0],t=b[1],u=b[2],v=b[3],w=b[4],x=b[5],y=b[6],z=b[7],A=b[8],B=b[9],C=b[10],D=b[11],i=c*c*f+h,j=d*c*f+e*g,k=e*c*f-d*g,l=c*d*f-e*g,m=d*d*f+h,n=e*d*f+c*g,o=c*e*f+d*g,p=d*e*f-c*g,q=e*e*f+h,a[0]=s*i+w*j+A*k,a[1]=t*i+x*j+B*k,a[2]=u*i+y*j+C*k,a[3]=v*i+z*j+D*k,a[4]=s*l+w*m+A*n,a[5]=t*l+x*m+B*n,a[6]=u*l+y*m+C*n,a[7]=v*l+z*m+D*n,a[8]=s*o+w*p+A*q,a[9]=t*o+x*p+B*q,a[10]=u*o+y*p+C*q,a[11]=v*o+z*p+D*q,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)}},{}],104:[function(b,a,c){a.exports=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*d+j*c,a[5]=g*d+k*c,a[6]=h*d+l*c,a[7]=i*d+m*c,a[8]=j*d-f*c,a[9]=k*d-g*c,a[10]=l*d-h*c,a[11]=m*d-i*c,a}},{}],105:[function(b,a,c){a.exports=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*d-j*c,a[1]=g*d-k*c,a[2]=h*d-l*c,a[3]=i*d-m*c,a[8]=f*c+j*d,a[9]=g*c+k*d,a[10]=h*c+l*d,a[11]=i*c+m*d,a}},{}],106:[function(b,a,c){a.exports=function(a,b,e){var c=Math.sin(e),d=Math.cos(e),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*d+j*c,a[1]=g*d+k*c,a[2]=h*d+l*c,a[3]=i*d+m*c,a[4]=j*d-f*c,a[5]=k*d-g*c,a[6]=l*d-h*c,a[7]=m*d-i*c,a}},{}],107:[function(b,a,c){a.exports=function(a,b,f){var c=f[0],d=f[1],e=f[2];return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a[4]=b[4]*d,a[5]=b[5]*d,a[6]=b[6]*d,a[7]=b[7]*d,a[8]=b[8]*e,a[9]=b[9]*e,a[10]=b[10]*e,a[11]=b[11]*e,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}},{}],108:[function(b,a,c){a.exports=function(b,a,f){var g,h,i,j,k,l,m,n,o,p,q,r,c=f[0],d=f[1],e=f[2];return a===b?(b[12]=a[0]*c+a[4]*d+a[8]*e+a[12],b[13]=a[1]*c+a[5]*d+a[9]*e+a[13],b[14]=a[2]*c+a[6]*d+a[10]*e+a[14],b[15]=a[3]*c+a[7]*d+a[11]*e+a[15]):(g=a[0],h=a[1],i=a[2],j=a[3],k=a[4],l=a[5],m=a[6],n=a[7],o=a[8],p=a[9],q=a[10],r=a[11],b[0]=g,b[1]=h,b[2]=i,b[3]=j,b[4]=k,b[5]=l,b[6]=m,b[7]=n,b[8]=o,b[9]=p,b[10]=q,b[11]=r,b[12]=g*c+k*d+o*e+a[12],b[13]=h*c+l*d+p*e+a[13],b[14]=i*c+m*d+q*e+a[14],b[15]=j*c+n*d+r*e+a[15]),b}},{}],109:[function(b,a,c){a.exports=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}},{}],110:[function(a,b,c){"use strict";var d=a("barycentric"),e=a("polytope-closest-point/lib/closest_point_2d.js");function f(d,e){for(var c=[0,0,0,0],a=0;a<4;++a)for(var b=0;b<4;++b)c[b]+=d[4*a+b]*e[a];return c}function g(b,e,g,h,d){for(var a=f(h,f(g,f(e,[b[0],b[1],b[2],1]))),c=0;c<3;++c)a[c]/=a[3];return[.5*d[0]*(1+a[0]),.5*d[1]*(1-a[1])]}b.exports=function(b,j,n,o,p,q){if(1===b.length)return[0,b[0].slice()];for(var f=new Array(b.length),a=0;a<b.length;++a)f[a]=g(b[a],n,o,p,q);for(var k=0,l=1/0,a=0;a<f.length;++a){for(var i=0,h=0;h<2;++h)i+=Math.pow(f[a][h]-j[h],2);i<l&&(l=i,k=a)}for(var c=function(a,g){if(2===a.length){for(var b=0,c=0,f=0;f<2;++f)b+=Math.pow(g[f]-a[0][f],2),c+=Math.pow(g[f]-a[1][f],2);return(b=Math.sqrt(b),c=Math.sqrt(c),b+c<1e-6)?[1,0]:[c/(b+c),b/(c+b)]}if(3===a.length){var h=[0,0];return e(a[0],a[1],a[2],g,h),d(a,h)}return[]}(f,j),m=0,a=0;a<3;++a){if(c[a]< -0.001||c[a]>1.0001)return null;m+=c[a]}return Math.abs(m-1)>.001?null:[k,function(c,e){for(var d=[0,0,0],a=0;a<c.length;++a)for(var f=c[a],g=e[a],b=0;b<3;++b)d[b]+=g*f[b];return d}(b,c),c]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(d,o,b){var a=d("glslify"),e=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),f=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),g=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),h=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),i=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),j=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),k=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),c=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),l=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),m=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),n=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);b.meshShader={vertex:e,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},b.wireShader={vertex:g,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},b.pointShader={vertex:i,fragment:j,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},b.pickShader={vertex:k,fragment:c,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},b.pointPickShader={vertex:l,fragment:c,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},b.contourShader={vertex:m,fragment:n,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(a,d,f){"use strict";var g=1e-6,h=1e-6,i=a("gl-shader"),j=a("gl-buffer"),k=a("gl-vao"),l=a("gl-texture2d"),m=a("normals"),n=a("gl-mat4/multiply"),o=a("gl-mat4/invert"),p=a("ndarray"),q=a("colormap"),r=a("simplicial-complex-contour"),s=a("typedarray-pool"),c=a("./lib/shaders"),t=a("./lib/closest-point"),u=c.meshShader,v=c.wireShader,w=c.pointShader,x=c.pickShader,y=c.pointPickShader,z=c.contourShader,A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,B){this.gl=a,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=b,this.dirty=!0,this.triShader=c,this.lineShader=d,this.pointShader=e,this.pickShader=f,this.pointPickShader=g,this.contourShader=h,this.trianglePositions=i,this.triangleColors=k,this.triangleNormals=m,this.triangleUVs=l,this.triangleIds=j,this.triangleVAO=n,this.triangleCount=0,this.lineWidth=1,this.edgePositions=o,this.edgeColors=q,this.edgeUVs=r,this.edgeIds=p,this.edgeVAO=s,this.edgeCount=0,this.pointPositions=t,this.pointColors=v,this.pointUVs=w,this.pointSizes=x,this.pointIds=u,this.pointVAO=y,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=z,this.contourVAO=B,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=A,this._view=A,this._projection=A,this._resolution=[1,1]}var b=e.prototype;function B(c,a){if(!a)return 1;if(!a.length)return 1;for(var b=0;b<a.length;++b){if(a.length<2)return 1;if(a[b][0]===c)return a[b][1];if(a[b][0]>c&&b>0){var d=(a[b][0]-c)/(a[b][0]-a[b-1][0]);return a[b][1]*(1-d)+d*a[b-1][1]}}return 1}b.isOpaque=function(){return!this.hasAlpha},b.isTransparent=function(){return this.hasAlpha},b.pickSlots=1,b.setPickBase=function(a){this.pickId=a},b.highlight=function(i){if(!i||!this.contourEnable){this.contourCount=0;return}for(var c=r(this.cells,this.intensity,i.intensity),j=c.cells,k=c.vertexIds,n=c.vertexWeights,l=j.length,d=s.mallocFloat32(6*l),e=0,f=0;f<l;++f)for(var g=j[f],h=0;h<2;++h){var a=g[0];2===g.length&&(a=g[h]);for(var o=k[a][0],p=k[a][1],m=n[a],q=1-m,t=this.positions[o],u=this.positions[p],b=0;b<3;++b)d[e++]=m*t[b]+q*u[b]}this.contourCount=e/3|0,this.contourPositions.update(d.subarray(0,e)),s.free(d)},b.update=function(a){a=a||{};var F=this.gl;this.dirty=!0,"contourEnable"in a&&(this.contourEnable=a.contourEnable),"contourColor"in a&&(this.contourColor=a.contourColor),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"lightPosition"in a&&(this.lightPosition=a.lightPosition),this.hasAlpha=!1,"opacity"in a&&(this.opacity=a.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in a&&(this.opacityscale=a.opacityscale,this.hasAlpha=!0),"ambient"in a&&(this.ambientLight=a.ambient),"diffuse"in a&&(this.diffuseLight=a.diffuse),"specular"in a&&(this.specularLight=a.specular),"roughness"in a&&(this.roughness=a.roughness),"fresnel"in a&&(this.fresnel=a.fresnel),a.texture?(this.texture.dispose(),this.texture=l(F,a.texture)):a.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=F.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=F.LINEAR,this.texture.setPixels(function(f,d){for(var g=q({colormap:f,nshades:256,format:"rgba"}),b=new Uint8Array(1024),a=0;a<256;++a){for(var e=g[a],c=0;c<3;++c)b[4*a+c]=e[c];d?b[4*a+3]=255*B(a/255,d):b[4*a+3]=255*e[3]}return p(b,[256,256,4],[4,0,1])}(a.colormap,this.opacityscale)),this.texture.generateMipmap());var y=a.cells,n=a.positions;if(n&&y){var K=[],u=[],L=[],M=[],N=[],O=[],G=[],P=[],Q=[],R=[],H=[],S=[],I=[],T=[];this.cells=y,this.positions=n;var C=a.vertexNormals,D=a.cellNormals,Y=void 0===a.vertexNormalsEpsilon?g:a.vertexNormalsEpsilon,Z=void 0===a.faceNormalsEpsilon?h:a.faceNormalsEpsilon;a.useFacetNormals&&!D&&(D=m.faceNormals(y,n,Z)),D||C||(C=m.vertexNormals(y,n,Y));var z=a.vertexColors,v=a.cellColors,J=a.meshColor||[1,1,1,1],w=a.vertexUVs,k=a.vertexIntensity,x=a.cellUVs,o=a.cellIntensity,c=1/0,j=-1/0;if(!w&&!x)if(k)if(a.vertexIntensityBounds)c=+a.vertexIntensityBounds[0],j=+a.vertexIntensityBounds[1];else for(var d=0;d<k.length;++d){var t=k[d];c=Math.min(c,t),j=Math.max(j,t)}else if(o)if(a.cellIntensityBounds)c=+a.cellIntensityBounds[0],j=+a.cellIntensityBounds[1];else for(var d=0;d<o.length;++d){var t=o[d];c=Math.min(c,t),j=Math.max(j,t)}else for(var d=0;d<n.length;++d){var t=n[d][2];c=Math.min(c,t),j=Math.max(j,t)}k?this.intensity=k:o?this.intensity=o:this.intensity=function(b){for(var c=b.length,d=new Array(c),a=0;a<c;++a)d[a]=b[a][2];return d}(n),this.pickVertex=!(o||v);var U=a.pointSizes,$=a.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var d=0;d<n.length;++d)for(var f=n[d],e=0;e<3;++e)!isNaN(f[e])&&isFinite(f[e])&&(this.bounds[0][e]=Math.min(this.bounds[0][e],f[e]),this.bounds[1][e]=Math.max(this.bounds[1][e],f[e]));var V=0,W=0,X=0;fill_loop:for(var d=0;d<y.length;++d){var A=y[d];switch(A.length){case 1:for(var b,r,i=A[0],f=n[i],e=0;e<3;++e)if(isNaN(f[e])||!isFinite(f[e]))continue fill_loop;R.push(f[0],f[1],f[2]),b=z?z[i]:v?v[d]:J,this.opacityscale&&k?u.push(b[0],b[1],b[2],this.opacity*B((k[i]-c)/(j-c),this.opacityscale)):3===b.length?H.push(b[0],b[1],b[2],this.opacity):(H.push(b[0],b[1],b[2],b[3]*this.opacity),b[3]<1&&(this.hasAlpha=!0)),r=w?w[i]:k?[(k[i]-c)/(j-c),0]:x?x[d]:o?[(o[d]-c)/(j-c),0]:[(f[2]-c)/(j-c),0],S.push(r[0],r[1]),U?I.push(U[i]):I.push($),T.push(d),X+=1;break;case 2:for(var e=0;e<2;++e)for(var i=A[e],f=n[i],s=0;s<3;++s)if(isNaN(f[s])||!isFinite(f[s]))continue fill_loop;for(var e=0;e<2;++e){var b,r,i=A[e],f=n[i];O.push(f[0],f[1],f[2]),b=z?z[i]:v?v[d]:J,this.opacityscale&&k?u.push(b[0],b[1],b[2],this.opacity*B((k[i]-c)/(j-c),this.opacityscale)):3===b.length?G.push(b[0],b[1],b[2],this.opacity):(G.push(b[0],b[1],b[2],b[3]*this.opacity),b[3]<1&&(this.hasAlpha=!0)),r=w?w[i]:k?[(k[i]-c)/(j-c),0]:x?x[d]:o?[(o[d]-c)/(j-c),0]:[(f[2]-c)/(j-c),0],P.push(r[0],r[1]),Q.push(d)}W+=1;break;case 3:for(var e=0;e<3;++e)for(var i=A[e],f=n[i],s=0;s<3;++s)if(isNaN(f[s])||!isFinite(f[s]))continue fill_loop;for(var e=0;e<3;++e){var b,r,E,i=A[2-e],f=n[i];K.push(f[0],f[1],f[2]),(b=z?z[i]:v?v[d]:J)?this.opacityscale&&k?u.push(b[0],b[1],b[2],this.opacity*B((k[i]-c)/(j-c),this.opacityscale)):3===b.length?u.push(b[0],b[1],b[2],this.opacity):(u.push(b[0],b[1],b[2],b[3]*this.opacity),b[3]<1&&(this.hasAlpha=!0)):u.push(.5,.5,.5,1),r=w?w[i]:k?[(k[i]-c)/(j-c),0]:x?x[d]:o?[(o[d]-c)/(j-c),0]:[(f[2]-c)/(j-c),0],M.push(r[0],r[1]),E=C?C[i]:D[d],L.push(E[0],E[1],E[2]),N.push(d)}V+=1;break;default:break}}this.pointCount=X,this.edgeCount=W,this.triangleCount=V,this.pointPositions.update(R),this.pointColors.update(H),this.pointUVs.update(S),this.pointSizes.update(I),this.pointIds.update(new Uint32Array(T)),this.edgePositions.update(O),this.edgeColors.update(G),this.edgeUVs.update(P),this.edgeIds.update(new Uint32Array(Q)),this.trianglePositions.update(K),this.triangleColors.update(u),this.triangleUVs.update(M),this.triangleNormals.update(L),this.triangleIds.update(new Uint32Array(N))}},b.drawTransparent=b.draw=function(f){f=f||{};for(var c=this.gl,k=f.model||A,l=f.view||A,m=f.projection||A,g=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],a=0;a<3;++a)g[0][a]=Math.max(g[0][a],this.clipBounds[0][a]),g[1][a]=Math.min(g[1][a],this.clipBounds[1][a]);var b={model:k,view:l,projection:m,inverseModel:A.slice(),clipBounds:g,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};b.inverseModel=o(b.inverseModel,b.model),c.disable(c.CULL_FACE),this.texture.bind(0);var d=new Array(16);n(d,b.view,b.model),n(d,b.projection,d),o(d,d);for(var a=0;a<3;++a)b.eyePosition[a]=d[12+a]/d[15];for(var i=d[15],a=0;a<3;++a)i+=this.lightPosition[a]*d[4*a+3];for(var a=0;a<3;++a){for(var j=d[12+a],h=0;h<3;++h)j+=d[4*h+a]*this.lightPosition[h];b.lightPosition[a]=j/i}if(this.triangleCount>0){var e=this.triShader;e.bind(),e.uniforms=b,this.triangleVAO.bind(),c.drawArrays(c.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var e=this.lineShader;e.bind(),e.uniforms=b,this.edgeVAO.bind(),c.lineWidth(this.lineWidth*this.pixelRatio),c.drawArrays(c.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()}if(this.pointCount>0){var e=this.pointShader;e.bind(),e.uniforms=b,this.pointVAO.bind(),c.drawArrays(c.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var e=this.contourShader;e.bind(),e.uniforms=b,this.contourVAO.bind(),c.drawArrays(c.LINES,0,this.contourCount),this.contourVAO.unbind()}},b.drawPick=function(c){c=c||{};for(var a=this.gl,f=c.model||A,g=c.view||A,h=c.projection||A,d=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],b=0;b<3;++b)d[0][b]=Math.max(d[0][b],this.clipBounds[0][b]),d[1][b]=Math.min(d[1][b],this.clipBounds[1][b]);this._model=[].slice.call(f),this._view=[].slice.call(g),this._projection=[].slice.call(h),this._resolution=[a.drawingBufferWidth,a.drawingBufferHeight];var i={model:f,view:g,projection:h,clipBounds:d,pickId:this.pickId/255},e=this.pickShader;if(e.bind(),e.uniforms=i,this.triangleCount>0&&(this.triangleVAO.bind(),a.drawArrays(a.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),a.lineWidth(this.lineWidth*this.pixelRatio),a.drawArrays(a.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0){var e=this.pointPickShader;e.bind(),e.uniforms=i,this.pointVAO.bind(),a.drawArrays(a.POINTS,0,this.pointCount),this.pointVAO.unbind()}},b.pick=function(c){if(!c)return null;if(c.id!==this.pickId)return null;for(var d=c.value[0]+256*c.value[1]+65536*c.value[2],a=this.cells[d],m=this.positions,i=new Array(a.length),b=0;b<a.length;++b)i[b]=m[a[b]];var j=c.coord[0],k=c.coord[1];if(!this.pickVertex){var f=this.positions[a[0]],g=this.positions[a[1]],h=this.positions[a[2]],n=[(f[0]+g[0]+h[0])/3,(f[1]+g[1]+h[1])/3,(f[2]+g[2]+h[2])/3];return{_cellCenter:!0,position:[j,k],index:d,cell:a,cellId:d,intensity:this.intensity[d],dataCoordinate:n}}var e=t(i,[j*this.pixelRatio,this._resolution[1]-k*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!e)return null;for(var o=e[2],l=0,b=0;b<a.length;++b)l+=o[b]*this.intensity[a[b]];return{position:e[1],index:a[e[0]],cell:a,cellId:d,intensity:l,dataCoordinate:this.positions[a[e[0]]]}},b.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},d.exports=function(a,m){if(1===arguments.length&&(a=(m=a).gl),!(a.getExtension("OES_standard_derivatives")||a.getExtension("MOZ_OES_standard_derivatives")||a.getExtension("WEBKIT_OES_standard_derivatives")))throw new Error("derivatives not supported");var b,d,c,h,f,n,L=((b=i(a,u.vertex,u.fragment)).attributes.position.location=0,b.attributes.color.location=2,b.attributes.uv.location=3,b.attributes.normal.location=4,b),M=((d=i(a,v.vertex,v.fragment)).attributes.position.location=0,d.attributes.color.location=2,d.attributes.uv.location=3,d),N=((c=i(a,w.vertex,w.fragment)).attributes.position.location=0,c.attributes.color.location=2,c.attributes.uv.location=3,c.attributes.pointSize.location=4,c),O=((h=i(a,x.vertex,x.fragment)).attributes.position.location=0,h.attributes.id.location=1,h),P=((f=i(a,y.vertex,y.fragment)).attributes.position.location=0,f.attributes.id.location=1,f.attributes.pointSize.location=4,f),Q=((n=i(a,z.vertex,z.fragment)).attributes.position.location=0,n),g=l(a,p(new Uint8Array([255,255,255,255]),[1,1,4]));g.generateMipmap(),g.minFilter=a.LINEAR_MIPMAP_LINEAR,g.magFilter=a.LINEAR;var o=j(a),q=j(a),r=j(a),s=j(a),t=j(a),R=k(a,[{buffer:o,type:a.FLOAT,size:3},{buffer:t,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:q,type:a.FLOAT,size:4},{buffer:r,type:a.FLOAT,size:2},{buffer:s,type:a.FLOAT,size:3}]),A=j(a),B=j(a),C=j(a),D=j(a),S=k(a,[{buffer:A,type:a.FLOAT,size:3},{buffer:D,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:B,type:a.FLOAT,size:4},{buffer:C,type:a.FLOAT,size:2}]),E=j(a),F=j(a),G=j(a),H=j(a),I=j(a),T=k(a,[{buffer:E,type:a.FLOAT,size:3},{buffer:I,type:a.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:F,type:a.FLOAT,size:4},{buffer:G,type:a.FLOAT,size:2},{buffer:H,type:a.FLOAT,size:1}]),J=j(a),U=k(a,[{buffer:J,type:a.FLOAT,size:3}]),K=new e(a,g,L,M,N,O,P,Q,o,t,q,r,s,R,A,D,B,C,S,E,I,F,G,H,T,J,U);return K.update(m),K}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(a,c,g){"use strict";c.exports=function(a){var b=a.gl,c=h(b,[0,0,0,1,1,0,1,1]),e=i(b,j.boxVert,j.lineFrag);return new d(a,c,e)};var h=a("gl-buffer"),i=a("gl-shader"),j=a("./shaders");function d(a,b,c){this.plot=a,this.vbo=b,this.shader=c}var e,f,b=d.prototype;b.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},b.drawBox=(e=[0,0],f=[0,0],function(c,d,g,h,i){var j=this.plot,a=this.shader,b=j.gl;e[0]=c,e[1]=d,f[0]=g,f[1]=h,a.uniforms.lo=e,a.uniforms.hi=f,a.uniforms.color=i,b.drawArrays(b.TRIANGLE_STRIP,0,4)}),b.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(a,c,p){"use strict";c.exports=function(b){var a=b.gl,c=q(a),e=r(a,t.gridVert,t.gridFrag),f=r(a,t.tickVert,t.gridFrag),g=new d(b,c,e,f);return g};var q=a("gl-buffer"),r=a("gl-shader"),s=a("binary-search-bounds"),t=a("./shaders");function d(a,b,c,d){this.plot=a,this.vbo=b,this.shader=c,this.tickShader=d,this.ticks=[[],[]]}function u(a,b){return a-b}var e,f,g,h,i,j,k,l,m,n,o,b=d.prototype;b.draw=(e=[0,0],f=[0,0],g=[0,0],function(){for(var b=this.plot,o=this.vbo,c=this.shader,p=this.ticks,i=b.gl,j=b._tickBounds,d=b.dataBox,k=b.viewBox,q=b.gridLineWidth,r=b.gridLineColor,s=b.gridLineEnable,t=b.pixelRatio,a=0;a<2;++a){var l=j[a],u=j[a+2]-l,v=.5*(d[a+2]+d[a]),m=d[a+2]-d[a];f[a]=2*u/m,e[a]=2*(l-v)/m}c.bind(),o.bind(),c.attributes.dataCoord.pointer(),c.uniforms.dataShift=e,c.uniforms.dataScale=f;for(var n=0,a=0;a<2;++a){g[0]=g[1]=0,g[a]=1,c.uniforms.dataAxis=g,c.uniforms.lineWidth=q[a]/(k[a+2]-k[a])*t,c.uniforms.color=r[a];var h=6*p[a].length;s[a]&&h&&i.drawArrays(i.TRIANGLES,n,h),n+=h}}),b.drawTickMarks=(h=[0,0],i=[0,0],j=[1,0],k=[0,1],l=[0,0],m=[0,0],function(){for(var g=this.plot,I=this.vbo,z=this.tickShader,n=this.ticks,o=g.gl,c=g._tickBounds,p=g.dataBox,b=g.viewBox,q=g.pixelRatio,t=g.screenBox,d=t[2]-t[0],e=t[3]-t[1],A=b[2]-b[0],B=b[3]-b[1],f=0;f<2;++f){var C=c[f],J=c[f+2]-C,K=.5*(p[f+2]+p[f]),D=p[f+2]-p[f];i[f]=2*J/D,h[f]=2*(C-K)/D}i[0]*=A/d,h[0]*=A/d,i[1]*=B/e,h[1]*=B/e,z.bind(),I.bind(),z.attributes.dataCoord.pointer();var a=z.uniforms;a.dataShift=h,a.dataScale=i;var r=g.tickMarkLength,v=g.tickMarkWidth,w=g.tickMarkColor,L=6*n[0].length,E=Math.min(s.ge(n[0],(p[0]-c[0])/(c[2]-c[0]),u),n[0].length),M=Math.min(s.gt(n[0],(p[2]-c[0])/(c[2]-c[0]),u),n[0].length),F=0+6*E,x=6*Math.max(0,M-E),G=Math.min(s.ge(n[1],(p[1]-c[1])/(c[3]-c[1]),u),n[1].length),N=Math.min(s.gt(n[1],(p[3]-c[1])/(c[3]-c[1]),u),n[1].length),H=L+6*G,y=6*Math.max(0,N-G);l[0]=2*(b[0]-r[1])/d-1,l[1]=(b[3]+b[1])/e-1,m[0]=r[1]*q/d,m[1]=v[1]*q/e,y&&(a.color=w[1],a.tickScale=m,a.dataAxis=k,a.screenOffset=l,o.drawArrays(o.TRIANGLES,H,y)),l[0]=(b[2]+b[0])/d-1,l[1]=2*(b[1]-r[0])/e-1,m[0]=v[0]*q/d,m[1]=r[0]*q/e,x&&(a.color=w[0],a.tickScale=m,a.dataAxis=j,a.screenOffset=l,o.drawArrays(o.TRIANGLES,F,x)),l[0]=2*(b[2]+r[3])/d-1,l[1]=(b[3]+b[1])/e-1,m[0]=r[3]*q/d,m[1]=v[3]*q/e,y&&(a.color=w[3],a.tickScale=m,a.dataAxis=k,a.screenOffset=l,o.drawArrays(o.TRIANGLES,H,y)),l[0]=(b[2]+b[0])/d-1,l[1]=2*(b[3]+r[2])/e-1,m[0]=v[2]*q/d,m[1]=r[2]*q/e,x&&(a.color=w[2],a.tickScale=m,a.dataAxis=j,a.screenOffset=l,o.drawArrays(o.TRIANGLES,F,x))}),b.update=(n=[1,1,-1,-1,1,-1],o=[1,-1,1,1,-1,-1],function(g){var d=g.ticks,h=g.bounds,b=new Float32Array(18*(d[0].length+d[1].length));this.plot.zeroLineEnable;for(var e=0,i=[[],[]],a=0;a<2;++a)for(var m=i[a],j=d[a],k=h[a],p=h[a+2],f=0;f<j.length;++f){var l=(j[f].x-k)/(p-k);m.push(l);for(var c=0;c<6;++c)b[e++]=l,b[e++]=n[c],b[e++]=o[c]}this.ticks=i,this.vbo.update(b)}),b.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(a,c,g){"use strict";c.exports=function(a){var b=a.gl,c=h(b,[-1,-1,-1,1,1,-1,1,1]),e=i(b,j.lineVert,j.lineFrag),f=new d(a,c,e);return f};var h=a("gl-buffer"),i=a("gl-shader"),j=a("./shaders");function d(a,b,c){this.plot=a,this.vbo=b,this.shader=c}var e,f,b=d.prototype;b.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},b.drawLine=(e=[0,0],f=[0,0],function(d,g,h,i,j,k){var b=this.plot,a=this.shader,c=b.gl;e[0]=d,e[1]=g,f[0]=h,f[1]=i,a.uniforms.start=e,a.uniforms.end=f,a.uniforms.width=j*b.pixelRatio,a.uniforms.color=k,c.drawArrays(c.TRIANGLE_STRIP,0,4)}),b.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(c,d,e){"use strict";var a=c("glslify"),b=a(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);d.exports={lineVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:b,textVert:a(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:b,gridVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:b,boxVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:231}],117:[function(a,c,m){"use strict";c.exports=function(a){var b=a.gl,c=n(b),e=o(b,r.textVert,r.textFrag),f=new d(a,c,e);return f};var n=a("gl-buffer"),o=a("gl-shader"),p=a("text-cache"),q=a("binary-search-bounds"),r=a("./shaders");function d(a,b,c){this.plot=a,this.vbo=b,this.shader=c,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var e,f,g,h,i,j,k,l,b=d.prototype;b.drawTicks=(e=[0,0],f=[0,0],g=[0,0],function(a){var c=this.plot,b=this.shader,p=this.tickX[a],d=this.tickOffset[a],h=c.gl,l=c.viewBox,r=c.dataBox,m=c.screenBox,n=c.pixelRatio,s=c.tickEnable,t=c.tickPad,u=c.tickColor,v=c.tickAngle,w=c.labelEnable,x=c.labelPad,y=c.labelColor,z=c.labelAngle,A=this.labelOffset[a],o=this.labelCount[a],i=q.lt(p,r[a]),j=q.le(p,r[a+2]);e[0]=e[1]=0,e[a]=1,f[a]=(l[2+a]+l[a])/(m[2+a]-m[a])-1;var k=2/m[2+(1^a)]-m[1^a];f[1^a]=k*l[1^a]-1,s[a]&&(f[1^a]-=k*n*t[a],i<j&&d[j]>d[i]&&(b.uniforms.dataAxis=e,b.uniforms.screenOffset=f,b.uniforms.color=u[a],b.uniforms.angle=v[a],h.drawArrays(h.TRIANGLES,d[i],d[j]-d[i]))),w[a]&&o&&(f[1^a]-=k*n*x[a],b.uniforms.dataAxis=g,b.uniforms.screenOffset=f,b.uniforms.color=y[a],b.uniforms.angle=z[a],h.drawArrays(h.TRIANGLES,A,o)),f[1^a]=k*l[2+(1^a)]-1,s[a+2]&&(f[1^a]+=k*n*t[a+2],i<j&&d[j]>d[i]&&(b.uniforms.dataAxis=e,b.uniforms.screenOffset=f,b.uniforms.color=u[a+2],b.uniforms.angle=v[a+2],h.drawArrays(h.TRIANGLES,d[i],d[j]-d[i]))),w[a+2]&&o&&(f[1^a]+=k*n*x[a+2],b.uniforms.dataAxis=g,b.uniforms.screenOffset=f,b.uniforms.color=y[a+2],b.uniforms.angle=z[a+2],h.drawArrays(h.TRIANGLES,A,o))}),b.drawTitle=(h=[0,0],i=[0,0],function(){var b=this.plot,c=this.shader,e=b.gl,d=b.screenBox,f=b.titleCenter,g=b.titleAngle,j=b.titleColor,k=b.pixelRatio;if(this.titleCount){for(var a=0;a<2;++a)i[a]=2*(f[a]*k-d[a])/(d[2+a]-d[a])-1;c.bind(),c.uniforms.dataAxis=h,c.uniforms.screenOffset=i,c.uniforms.angle=g,c.uniforms.color=j,e.drawArrays(e.TRIANGLES,this.titleOffset,this.titleCount)}}),b.bind=(j=[0,0],k=[0,0],l=[0,0],function(){var c=this.plot,d=this.shader,f=c._tickBounds,e=c.dataBox,b=c.screenBox,g=c.viewBox;d.bind();for(var a=0;a<2;++a){var h=f[a],o=f[a+2]-h,p=.5*(e[a+2]+e[a]),i=e[a+2]-e[a],q=g[a],r=g[a+2],m=r-q,s=b[a],t=b[a+2],n=t-s;k[a]=2*o/i*m/n,j[a]=2*(h-p)/i*m/n}l[1]=2*c.pixelRatio/(b[3]-b[1]),l[0]=l[1]*(b[3]-b[1])/(b[2]-b[0]),d.uniforms.dataScale=k,d.uniforms.dataShift=j,d.uniforms.textScale=l,this.vbo.bind(),d.attributes.textCoordinate.pointer()}),b.update=function(f){var b,g,c,d,a,e=[],q=f.ticks,j=f.bounds;for(a=0;a<2;++a){var k=[Math.floor(e.length/3)],l=[-1/0],m=q[a];for(b=0;b<m.length;++b){var h=m[b],n=h.x,r=h.text,s=h.font||"sans-serif";d=h.fontSize||12;for(var t=1/(j[a+2]-j[a]),u=j[a],o=r.split("\n"),i=0;i<o.length;i++)for(g=0,c=p(s,o[i]).data;g<c.length;g+=2)e.push(c[g]*d,-c[g+1]*d-i*d*1.2,(n-u)*t);k.push(Math.floor(e.length/3)),l.push(n)}this.tickOffset[a]=k,this.tickX[a]=l}for(a=0;a<2;++a){for(b=0,this.labelOffset[a]=Math.floor(e.length/3),c=p(f.labelFont[a],f.labels[a],{textAlign:"center"}).data,d=f.labelSize[a];b<c.length;b+=2)e.push(c[b]*d,-c[b+1]*d,0);this.labelCount[a]=Math.floor(e.length/3)-this.labelOffset[a]}for(b=0,this.titleOffset=Math.floor(e.length/3),c=p(f.titleFont,f.title).data,d=f.titleSize;b<c.length;b+=2)e.push(c[b]*d,-c[b+1]*d,0);this.titleCount=Math.floor(e.length/3)-this.titleOffset,this.vbo.update(e)},b.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(b,c,e){"use strict";c.exports=function(c){var b=c.gl,e=f(b,[b.drawingBufferWidth,b.drawingBufferHeight]),a=new d(b,e);return a.grid=g(a),a.text=h(a),a.line=i(a),a.box=j(a),a.update(c),a};var f=b("gl-select-static"),g=b("./lib/grid"),h=b("./lib/text"),i=b("./lib/line"),j=b("./lib/box");function d(a,b){this.gl=a,this.pickBuffer=b,this.screenBox=[0,0,a.drawingBufferWidth,a.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var a=d.prototype;function k(c){for(var a=c.slice(),b=0;b<a.length;++b)a[b]=a[b].slice();return a}function l(a,b){return a.x-b.x}a.setDirty=function(){this.dirty=this.pickDirty=!0},a.setOverlayDirty=function(){this.dirty=!0},a.nextDepthValue=function(){return(this._depthCounter++)/65536},a.draw=function(){var a=this.gl,d=this.screenBox,b=this.viewBox,j=this.dataBox,f=this.pixelRatio,t=this.grid,g=this.line,n=this.text,p=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,a.bindFramebuffer(a.FRAMEBUFFER,null),a.enable(a.SCISSOR_TEST),a.disable(a.DEPTH_TEST),a.depthFunc(a.LESS),a.depthMask(!1),a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD,a.FUNC_ADD),a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA),this.borderColor){a.scissor(d[0],d[1],d[2]-d[0],d[3]-d[1]);var h=this.borderColor;a.clearColor(h[0]*h[3],h[1]*h[3],h[2]*h[3],h[3]),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT)}a.scissor(b[0],b[1],b[2]-b[0],b[3]-b[1]),a.viewport(b[0],b[1],b[2]-b[0],b[3]-b[1]);var i=this.backgroundColor;a.clearColor(i[0]*i[3],i[1]*i[3],i[2]*i[3],i[3]),a.clear(a.COLOR_BUFFER_BIT),t.draw();var o=this.zeroLineEnable,q=this.zeroLineColor,r=this.zeroLineWidth;if(o[0]||o[1]){g.bind();for(var c=0;c<2;++c)if(o[c]&&j[c]<=0&&j[c+2]>=0){var k=d[c]-j[c]*(d[c+2]-d[c])/(j[c+2]-j[c]);0===c?g.drawLine(k,d[1],k,d[3],r[c],q[c]):g.drawLine(d[0],k,d[2],k,r[c],q[c])}}for(var c=0;c<p.length;++c)p[c].draw();a.viewport(d[0],d[1],d[2]-d[0],d[3]-d[1]),a.scissor(d[0],d[1],d[2]-d[0],d[3]-d[1]),this.grid.drawTickMarks(),g.bind();var l=this.borderLineEnable,e=this.borderLineWidth,m=this.borderLineColor;l[1]&&g.drawLine(b[0],b[1]-.5*e[1]*f,b[0],b[3]+.5*e[3]*f,e[1],m[1]),l[0]&&g.drawLine(b[0]-.5*e[0]*f,b[1],b[2]+.5*e[2]*f,b[1],e[0],m[0]),l[3]&&g.drawLine(b[2],b[1]-.5*e[1]*f,b[2],b[3]+.5*e[3]*f,e[3],m[3]),l[2]&&g.drawLine(b[0]-.5*e[0]*f,b[3],b[2]+.5*e[2]*f,b[3],e[2],m[2]),n.bind();for(var c=0;c<2;++c)n.drawTicks(c);this.titleEnable&&n.drawTitle();for(var s=this.overlays,c=0;c<s.length;++c)s[c].draw();a.disable(a.SCISSOR_TEST),a.disable(a.BLEND),a.depthMask(!0)}},a.drawPick=function(){if(!this.static){var b=this.pickBuffer;this.gl,this._pickTimeout=null,b.begin();for(var c=1,d=this.objects,a=0;a<d.length;++a)c=d[a].drawPick(c);b.end()}},a.pick=function(j,k){if(!this.static){var c=this.pixelRatio,d=this.pickPixelRatio,e=this.viewBox,f=0|Math.round((j-e[0]/c)*d),g=0|Math.round((k-e[1]/c)*d),a=this.pickBuffer.query(f,g,this.pickRadius);if(!a)return null;for(var l=a.id+(a.value[0]<<8)+(a.value[1]<<16)+(a.value[2]<<24),h=this.objects,b=0;b<h.length;++b){var i=h[b].pick(f,g,l);if(i)return i}return null}},a.setScreenBox=function(a){var b=this.screenBox,c=this.pixelRatio;b[0]=0|Math.round(a[0]*c),b[1]=0|Math.round(a[1]*c),b[2]=0|Math.round(a[2]*c),b[3]=0|Math.round(a[3]*c),this.setDirty()},a.setDataBox=function(a){var b=this.dataBox;(b[0]!==a[0]||b[1]!==a[1]||b[2]!==a[2]||b[3]!==a[3])&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],this.setDirty())},a.setViewBox=function(a){var b=this.pixelRatio,c=this.viewBox;c[0]=0|Math.round(a[0]*b),c[1]=0|Math.round(a[1]*b),c[2]=0|Math.round(a[2]*b),c[3]=0|Math.round(a[3]*b);var d=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((a[2]-a[0])*d),0|Math.round((a[3]-a[1])*d)],this.setDirty()},a.update=function(a){a=a||{};var h=this.gl;this.pixelRatio=a.pixelRatio||1;var c=this.pixelRatio;this.pickPixelRatio=Math.max(c,1),this.setScreenBox(a.screenBox||[0,0,h.drawingBufferWidth/c,h.drawingBufferHeight/c]),this.screenBox,this.setViewBox(a.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/c,.125*(this.screenBox[3]-this.screenBox[1])/c,.875*(this.screenBox[2]-this.screenBox[0])/c,.875*(this.screenBox[3]-this.screenBox[1])/c]);var d=this.viewBox,i=(d[2]-d[0])/(d[3]-d[1]);this.setDataBox(a.dataBox||[-10,-10/i,10,10/i]),this.borderColor=!1!==a.borderColor&&(a.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(a.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(a.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(a.gridLineWidth||[1,1]).slice(),this.gridLineColor=k(a.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(a.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(a.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=k(a.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(a.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(a.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=k(a.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(a.titleCenter||[.5*(d[0]+d[2])/c,(d[3]+120)/c]).slice(),this.titleEnable=!("titleEnable"in a)||!!a.titleEnable,this.titleAngle=a.titleAngle||0,this.titleColor=(a.titleColor||[0,0,0,1]).slice(),this.labelPad=(a.labelPad||[15,15,15,15]).slice(),this.labelAngle=(a.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(a.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=k(a.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(a.tickPad||[15,15,15,15]).slice(),this.tickAngle=(a.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(a.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=k(a.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(a.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(a.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=k(a.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var g=a.ticks||[[],[]],b=this._tickBounds;b[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(var e=0;e<2;++e){var f=g[e].slice(0);0!==f.length&&(f.sort(l),b[e]=Math.min(b[e],f[0].x),b[e+2]=Math.max(b[e+2],f[f.length-1].x))}this.grid.update({bounds:b,ticks:g}),this.text.update({bounds:b,ticks:g,labels:a.labels||["x","y"],labelSize:a.labelSize||[12,12],labelFont:a.labelFont||["sans-serif","sans-serif"],title:a.title||"",titleSize:a.titleSize||18,titleFont:a.titleFont||"sans-serif"}),this.static=!!a.static,this.setDirty()},a.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var a=this.objects.length-1;a>=0;--a)this.objects[a].dispose();this.objects.length=0;for(var a=this.overlays.length-1;a>=0;--a)this.overlays[a].dispose();this.overlays.length=0,this.gl=null},a.addObject=function(a){0>this.objects.indexOf(a)&&(this.objects.push(a),this.setDirty())},a.removeObject=function(c){for(var b=this.objects,a=0;a<b.length;++a)if(b[a]===c){b.splice(a,1),this.setDirty();break}},a.addOverlay=function(a){0>this.overlays.indexOf(a)&&(this.overlays.push(a),this.setOverlayDirty())},a.removeOverlay=function(c){for(var b=this.overlays,a=0;a<b.length;++a)if(b[a]===c){b.splice(a,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(a,b,c){"use strict";b.exports=function(c,a){c=c||document.body;var j=[.01,1/0];"distanceLimits"in(a=a||{})&&(j[0]=a.distanceLimits[0],j[1]=a.distanceLimits[1]),"zoomMin"in a&&(j[0]=a.zoomMin),"zoomMax"in a&&(j[1]=a.zoomMax);var k=e({center:a.center||[0,0,0],up:a.up||[0,1,0],eye:a.eye||[0,0,10],mode:a.mode||"orbit",distanceLimits:j}),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0,n=c.clientWidth,o=c.clientHeight,b={keyBindingMode:"rotate",enableWheel:!0,view:k,element:c,delay:a.delay||16,rotateSpeed:a.rotateSpeed||1,zoomSpeed:a.zoomSpeed||1,translateSpeed:a.translateSpeed||1,flipX:!!a.flipX,flipY:!!a.flipY,modes:k.modes,_ortho:a._ortho||a.projection&&"orthographic"===a.projection.type||!1,tick:function(){var b=d(),e=this.delay;k.idle(b-e),k.recalcMatrix(b-2*e),k.flush(b-(100+2*e));for(var f=!0,g=k.computedMatrix,a=0;a<16;++a)f=f&&l[a]===g[a],l[a]=g[a];var h=c.clientWidth===n&&c.clientHeight===o;return(n=c.clientWidth,o=c.clientHeight,f)?!h:(m=Math.exp(k.computedRadius[0]),!0)},lookAt:function(a,b,c){k.lookAt(k.lastT(),a,b,c)},rotate:function(a,b,c){k.rotate(k.lastT(),a,b,c)},pan:function(a,b,c){k.pan(k.lastT(),a,b,c)},translate:function(a,b,c){k.translate(k.lastT(),a,b,c)}};return Object.defineProperties(b,{matrix:{get:function(){return k.computedMatrix},set:function(a){return k.setMatrix(k.lastT(),a),k.computedMatrix},enumerable:!0},mode:{get:function(){return k.getMode()},set:function(b){var f=k.computedUp.slice(),c=k.computedEye.slice(),e=k.computedCenter.slice();if(k.setMode(b),"turntable"===b){var a=d();k._active.lookAt(a,c,e,f),k._active.lookAt(a+500,c,e,[0,0,1]),k._active.flush(a)}return k.getMode()},enumerable:!0},center:{get:function(){return k.computedCenter},set:function(a){return k.lookAt(k.lastT(),null,a),k.computedCenter},enumerable:!0},eye:{get:function(){return k.computedEye},set:function(a){return k.lookAt(k.lastT(),a),k.computedEye},enumerable:!0},up:{get:function(){return k.computedUp},set:function(a){return k.lookAt(k.lastT(),null,null,a),k.computedUp},enumerable:!0},distance:{get:function(){return m},set:function(a){return k.setDistance(k.lastT(),a),a},enumerable:!0},distanceLimits:{get:function(){return k.getDistanceLimits(j)},set:function(a){return k.setDistanceLimits(a),a},enumerable:!0}}),c.addEventListener("contextmenu",function(a){return a.preventDefault(),!1}),b._lastX=-1,b._lastY=-1,b._lastMods={shift:!1,control:!1,alt:!1,meta:!1},b.enableMouseListeners=function(){function a(l,o,p,h){var i=b.keyBindingMode;if(!1!==i){var t="rotate"===i,u="pan"===i,v="zoom"===i,a=!!h.control,e=!!h.alt,f=!!h.shift,g=!!(1&l),w=!!(2&l),x=!!(4&l),q=1/c.clientHeight,r=q*(o-b._lastX),n=q*(p-b._lastY),y=b.flipX?1:-1,z=b.flipY?1:-1,s=Math.PI*b.rotateSpeed,j=d();if(-1!==b._lastX&& -1!==b._lastY&&((!t||!g||a||e||f)&&(!g||a||e||!f)||k.rotate(j,y*s*r,-z*s*n,0),(u&&g&&!a&&!e&&!f||w||g&&a&&!e&&!f)&&k.pan(j,-b.translateSpeed*r*m,b.translateSpeed*n*m,0),v&&g&&!a&&!e&&!f||x||g&&!a&&e&&!f)){var A=-b.zoomSpeed*n/window.innerHeight*(j-k.lastT())*100;k.pan(j,0,0,m*(Math.exp(A)-1))}return b._lastX=o,b._lastY=p,b._lastMods=h,!0}}b.mouseListener=f(c,a),c.addEventListener("touchstart",function(e){var d=h(e.changedTouches[0],c);a(0,d[0],d[1],b._lastMods),a(1,d[0],d[1],b._lastMods)},!!i&&{passive:!0}),c.addEventListener("touchmove",function(d){var e=h(d.changedTouches[0],c);a(1,e[0],e[1],b._lastMods),d.preventDefault()},!!i&&{passive:!1}),c.addEventListener("touchend",function(c){a(0,b._lastX,b._lastY,b._lastMods)},!!i&&{passive:!0}),b.wheelListener=g(c,function(c,e){if(!1!==b.keyBindingMode&&b.enableWheel){var f=b.flipX?1:-1,g=b.flipY?1:-1,a=d();if(Math.abs(c)>Math.abs(e))k.rotate(a,0,0,-c*f*Math.PI*b.rotateSpeed/window.innerWidth);else if(!b._ortho){var h=-b.zoomSpeed*g*e/window.innerHeight*(a-k.lastT())/20;k.pan(a,0,0,m*(Math.exp(h)-1))}}},!0)},b.enableMouseListeners(),b};var d=a("right-now"),e=a("3d-view"),f=a("mouse-change"),g=a("mouse-wheel"),h=a("mouse-event-offset"),i=a("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(a,c,d){var b=a("glslify"),e=a("gl-shader"),f=b(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),g=b(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);c.exports=function(a){return e(a,f,g,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(a,b,d){"use strict";var c=a("./camera.js"),e=a("gl-axes3d"),f=a("gl-axes3d/properties"),g=a("gl-spikes3d"),h=a("gl-select-static"),i=a("gl-fbo"),j=a("a-big-triangle"),k=a("mouse-change"),l=a("gl-mat4/perspective"),m=a("gl-mat4/ortho"),n=a("./lib/shader"),o=a("is-mobile")({tablet:!0,featureDetect:!0});function p(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function q(b){var c=Math.round(Math.log(Math.abs(b))/Math.log(10));if(c<0){var a=Math.round(Math.pow(10,-c));return Math.ceil(b*a)/a}if(c>0){var a=Math.round(Math.pow(10,c));return Math.ceil(b/a)*a}return Math.ceil(b)}function r(a){return"boolean"!=typeof a||a}b.exports={createScene:function(a){(a=a||{}).camera=a.camera||{};var s=a.canvas;s||((s=document.createElement("canvas"),a.container)?a.container.appendChild(s):document.body.appendChild(s));var b=a.gl;if(b||(a.glOptions&&(o=!!a.glOptions.preserveDrawingBuffer),b=function(b,c){var a=null;try{(a=b.getContext("webgl",c))||(a=b.getContext("experimental-webgl",c))}catch(d){return null}return a}(s,a.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:o})),!b)throw new Error("webgl not supported");var x=a.bounds||[[-10,-10,-10],[10,10,10]],y=new p,M=i(b,b.drawingBufferWidth,b.drawingBufferHeight,{preferFloat:!o}),N=n(b),z=a.cameraObject&& !0===a.cameraObject._ortho||a.camera.projection&&"orthographic"===a.camera.projection.type||!1,A={eye:a.camera.eye||[2,0,0],center:a.camera.center||[0,0,0],up:a.camera.up||[0,1,0],zoomMin:a.camera.zoomMax||.1,zoomMax:a.camera.zoomMin||100,mode:a.camera.mode||"turntable",_ortho:z},t=a.axes||{},u=e(b,t);u.enable=!t.disable;var B=a.spikes||{},C=g(b,B),D=[],O=[],P=[],Q=[],R=!0,E=!0,F=new Array(16),G=new Array(16),H={view:null,projection:F,model:G,_ortho:!1},E=!0,I=[b.drawingBufferWidth,b.drawingBufferHeight],J=a.cameraObject||c(s,A),d={gl:b,contextLost:!1,pixelRatio:a.pixelRatio||1,canvas:s,selection:y,camera:J,axes:u,axesPixels:null,spikes:C,bounds:x,objects:D,shape:I,aspect:a.aspectRatio||[1,1,1],pickRadius:a.pickRadius||10,zNear:a.zNear||.01,zFar:a.zFar||1e3,fovy:a.fovy||Math.PI/4,clearColor:a.clearColor||[0,0,0,0],autoResize:r(a.autoResize),autoBounds:r(a.autoBounds),autoScale:!!a.autoScale,autoCenter:r(a.autoCenter),clipToBounds:r(a.clipToBounds),snapToData:!!a.snapToData,onselect:a.onselect||null,onrender:a.onrender||null,onclick:a.onclick||null,cameraParams:H,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(a){this.aspect[0]=a.x,this.aspect[1]=a.y,this.aspect[2]=a.z,E=!0},setBounds:function(a,b){this.bounds[0][a]=b.min,this.bounds[1][a]=b.max},setClearColor:function(a){this.clearColor=a},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},S=[b.drawingBufferWidth/d.pixelRatio|0,b.drawingBufferHeight/d.pixelRatio|0];function v(){if(!d._stopped&&d.autoResize){var b=s.parentNode,c=1,e=1;b&&b!==document.body?(c=b.clientWidth,e=b.clientHeight):(c=window.innerWidth,e=window.innerHeight);var f=0|Math.ceil(c*d.pixelRatio),g=0|Math.ceil(e*d.pixelRatio);if(f!==s.width||g!==s.height){s.width=f,s.height=g;var a=s.style;a.position=a.position||"absolute",a.left="0px",a.top="0px",a.width=c+"px",a.height=e+"px",R=!0}}}function T(){for(var g=D.length,c=Q.length,a=0;a<c;++a)P[a]=0;obj_loop:for(var a=0;a<g;++a){var f=D[a],e=f.pickSlots;if(!e){O[a]=-1;continue}for(var d=0;d<c;++d)if(P[d]+e<255){O[a]=d,f.setPickBase(P[d]+1),P[d]+=e;continue obj_loop}var i=h(b,I);O[a]=c,Q.push(i),P.push(e),f.setPickBase(1),c+=1}for(;c>0&&0===P[c-1];)P.pop(),Q.pop().dispose()}function K(){if(d.contextLost)return!0;b.isContextLost()&&(d.contextLost=!0,d.mouseListener.enabled=!1,d.selection.object=null,d.oncontextloss&&d.oncontextloss())}d.autoResize&&v(),window.addEventListener("resize",v),d.update=function(a){d._stopped||(a=a||{},R=!0,E=!0)},d.add=function(a){d._stopped||(a.axes=u,D.push(a),O.push(-1),R=!0,E=!0,T())},d.remove=function(b){if(!d._stopped){var a=D.indexOf(b);a<0||(D.splice(a,1),O.pop(),R=!0,E=!0,T())}},d.dispose=function(){if(!d._stopped&&(d._stopped=!0,window.removeEventListener("resize",v),s.removeEventListener("webglcontextlost",K),d.mouseListener.enabled=!1,!d.contextLost)){u.dispose(),C.dispose();for(var a=0;a<D.length;++a)D[a].dispose();M.dispose();for(var a=0;a<Q.length;++a)Q[a].dispose();N.dispose(),b=null,u=null,C=null,D=[]}},d._mouseRotating=!1,d._prevButtons=0,d.enableMouseListeners=function(){d.mouseListener=k(s,function(e,i,j){if(!d._stopped){var l=Q.length,m=D.length,a=y.object;y.distance=1/0,y.mouse[0]=i,y.mouse[1]=j,y.object=null,y.screen=null,y.dataCoordinate=y.dataPosition=null;var h=!1;if(e&&d._prevButtons)d._mouseRotating=!0;else{d._mouseRotating&&(E=!0),d._mouseRotating=!1;for(var f=0;f<l;++f){var b=Q[f].query(i,S[1]-j-1,d.pickRadius);if(b){if(b.distance>y.distance)continue;for(var g=0;g<m;++g){var k=D[g];if(O[g]===f){var c=k.pick(b);c&&(y.buttons=e,y.screen=b.coord,y.distance=b.distance,y.object=k,y.index=c.distance,y.dataPosition=c.position,y.dataCoordinate=c.dataCoordinate,y.data=c,h=!0)}}}}}a&&a!==y.object&&(a.highlight&&a.highlight(null),R=!0),y.object&&(y.object.highlight&&y.object.highlight(y.data),R=!0),(h=h||y.object!==a)&&d.onselect&&d.onselect(y),1&e&&!(1&d._prevButtons)&&d.onclick&&d.onclick(y),d._prevButtons=e}})},s.addEventListener("webglcontextlost",K);var w=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],U=[w[0].slice(),w[1].slice()];function V(){if(!K()){v();var t=d.camera.tick();H.view=d.camera.matrix,R=R||t,E=E||t,u.pixelRatio=d.pixelRatio,C.pixelRatio=d.pixelRatio;var k=D.length,g=w[0],h=w[1];g[0]=g[1]=g[2]=1/0,h[0]=h[1]=h[2]=-1/0;for(var c=0;c<k;++c){var e=D[c];e.pixelRatio=d.pixelRatio,e.axes=d.axes,R=R||!!e.dirty,E=E||!!e.dirty;var s=e.bounds;if(s)for(var B=s[0],F=s[1],a=0;a<3;++a)g[a]=Math.min(g[a],B[a]),h[a]=Math.max(h[a],F[a])}var i=d.bounds;if(d.autoBounds)for(var a=0;a<3;++a){if(h[a]<g[a])g[a]=-1,h[a]=1;else{g[a]===h[a]&&(g[a]-=1,h[a]+=1);var x=.05*(h[a]-g[a]);g[a]=g[a]-x,h[a]=h[a]+x}i[0][a]=g[a],i[1][a]=h[a]}for(var n=!1,a=0;a<3;++a)n=n||U[0][a]!==i[0][a]||U[1][a]!==i[1][a],U[0][a]=i[0][a],U[1][a]=i[1][a];if(E=E||n,R=R||n){if(n){for(var A=[0,0,0],c=0;c<3;++c)A[c]=q((i[1][c]-i[0][c])/10);u.autoTicks?u.update({bounds:i,tickSpacing:A}):u.update({bounds:i})}var o=b.drawingBufferWidth,p=b.drawingBufferHeight;I[0]=o,I[1]=p,S[0]=0|Math.max(o/d.pixelRatio,1),S[1]=0|Math.max(p/d.pixelRatio,1),function(b,k){var c=b.bounds,e=b.cameraParams,h=e.projection,d=e.model,n=b.gl.drawingBufferWidth,o=b.gl.drawingBufferHeight,i=b.zNear,j=b.zFar,p=b.fovy,f=n/o;k?(m(h,-f,f,-1,1,i,j),e._ortho=!0):(l(h,p,f,i,j),e._ortho=!1);for(var a=0;a<16;++a)d[a]=0;d[15]=1;for(var g=0,a=0;a<3;++a)g=Math.max(g,c[1][a]-c[0][a]);for(var a=0;a<3;++a)b.autoScale?d[5*a]=b.aspect[a]/(c[1][a]-c[0][a]):d[5*a]=1/g,b.autoCenter&&(d[12+a]=-(.5*d[5*a])*(c[0][a]+c[1][a]))}(d,z);for(var c=0;c<k;++c){var e=D[c];e.axesBounds=i,d.clipToBounds&&(e.clipBounds=i)}y.object&&(d.snapToData?C.position=y.dataCoordinate:C.position=y.dataPosition,C.bounds=i),E&&(E=!1,function(){if(!K()){b.colorMask(!0,!0,!0,!0),b.depthMask(!0),b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL);for(var f=D.length,g=Q.length,a=0;a<g;++a){var d=Q[a];d.shape=S,d.begin();for(var c=0;c<f;++c)if(O[c]===a){var e=D[c];e.drawPick&&(e.pixelRatio=1,e.drawPick(H))}d.end()}}}()),d.axesPixels=f(d.axes,H,o,p),d.onrender&&d.onrender(),b.bindFramebuffer(b.FRAMEBUFFER,null),b.viewport(0,0,o,p),d.clearRGBA(),b.depthMask(!0),b.colorMask(!0,!0,!0,!0),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.disable(b.BLEND),b.disable(b.CULL_FACE);var r=!1;u.enable&&(r=r||u.isTransparent(),u.draw(H)),C.axes=u,y.object&&C.draw(H),b.disable(b.CULL_FACE);for(var c=0;c<k;++c){var e=D[c];e.axes=u,e.pixelRatio=d.pixelRatio,e.isOpaque&&e.isOpaque()&&e.draw(H),e.isTransparent&&e.isTransparent()&&(r=!0)}if(r){M.shape=I,M.bind(),b.clear(b.DEPTH_BUFFER_BIT),b.colorMask(!1,!1,!1,!1),b.depthMask(!0),b.depthFunc(b.LESS),u.enable&&u.isTransparent()&&u.drawTransparent(H);for(var c=0;c<k;++c){var e=D[c];e.isOpaque&&e.isOpaque()&&e.draw(H)}b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.colorMask(!0,!0,!0,!0),b.depthMask(!1),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),u.isTransparent()&&u.drawTransparent(H);for(var c=0;c<k;++c){var e=D[c];e.isTransparent&&e.isTransparent()&&e.drawTransparent(H)}b.bindFramebuffer(b.FRAMEBUFFER,null),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),N.bind(),M.color[0].bind(0),N.uniforms.accumBuffer=0,j(b),b.disable(b.BLEND)}R=!1;for(var c=0;c<k;++c)D[c].dirty=!1}}}function L(){d._stopped||d.contextLost||(V(),requestAnimationFrame(L))}return d.enableMouseListeners(),L(),d.redraw=function(){d._stopped||(R=!0,V())},d},createCamera:c}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(c,d,a){var b=c("glslify");a.pointVertex=b(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),a.pointFragment=b(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),a.pickVertex=b(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),a.pickFragment=b(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:231}],123:[function(b,c,g){"use strict";var d,e,h=b("gl-shader"),i=b("gl-buffer"),j=b("typedarray-pool"),k=b("./lib/shader");function f(a,b,c,d,e){this.plot=a,this.offsetBuffer=b,this.pickBuffer=c,this.shader=d,this.pickShader=e,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}c.exports=function(b,d){var a=b.gl,e=i(a),g=i(a),j=h(a,k.pointVertex,k.pointFragment),l=h(a,k.pickVertex,k.pickFragment),c=new f(b,e,g,j,l);return c.update(d),b.addObject(c),c};var a=f.prototype;a.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},a.update=function(a){function b(b,c){return b in a?a[b]:c}a=a||{},this.sizeMin=b("sizeMin",.5),this.sizeMax=b("sizeMax",20),this.color=b("color",[1,0,0,1]).slice(),this.areaRatio=b("areaRatio",1),this.borderColor=b("borderColor",[0,0,0,1]).slice(),this.blend=b("blend",!1);var c,e=a.positions.length>>>1,g=a.positions instanceof Float32Array,h=a.idToIndex instanceof Int32Array&&a.idToIndex.length>=e,d=a.positions,f=g?d:j.mallocFloat32(d.length),i=h?a.idToIndex:j.mallocInt32(e);if(g||f.set(d),!h)for(f.set(d),c=0;c<e;c++)i[c]=c;this.points=d,this.offsetBuffer.update(f),this.pickBuffer.update(i),g||j.free(f),h||j.free(i),this.pointCount=e,this.pickOffset=0},a.unifiedDraw=(d=[1,0,0,0,1,0,0,0,1],e=[0,0,0,0],function(c){var g=void 0!==c,b=g?this.pickShader:this.shader,a=this.plot.gl,f=this.plot.dataBox;if(0===this.pointCount)return c;var h=f[2]-f[0],i=f[3]-f[1],m=function(c,b){var a,d=0,g=c.length>>>1;for(a=0;a<g;a++){var e=c[2*a],f=c[2*a+1];e>=b[0]&&e<=b[2]&&f>=b[1]&&f<=b[3]&&d++}return d}(this.points,f),j=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(m,.33333)));d[0]=2/h,d[4]=2/i,d[6]=-2*f[0]/h-1,d[7]=-2*f[1]/i-1,this.offsetBuffer.bind(),b.bind(),b.attributes.position.pointer(),b.uniforms.matrix=d,b.uniforms.color=this.color,b.uniforms.borderColor=this.borderColor,b.uniforms.pointCloud=j<5,b.uniforms.pointSize=j,b.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),g&&(e[0]=255&c,e[1]=c>>8&255,e[2]=c>>16&255,e[3]=c>>24&255,this.pickBuffer.bind(),b.attributes.pickId.pointer(a.UNSIGNED_BYTE),b.uniforms.pickOffset=e,this.pickOffset=c);var k=a.getParameter(a.BLEND),l=a.getParameter(a.DITHER);return k&&!this.blend&&a.disable(a.BLEND),l&&a.disable(a.DITHER),a.drawArrays(a.POINTS,0,this.pointCount),k&&!this.blend&&a.enable(a.BLEND),l&&a.enable(a.DITHER),c+this.pointCount}),a.draw=a.unifiedDraw,a.drawPick=a.unifiedDraw,a.pick=function(f,g,a){var b=this.pickOffset,e=this.pointCount;if(a<b||a>=b+e)return null;var c=a-b,d=this.points;return{object:this,pointId:c,dataCoord:[d[2*c],d[2*c+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(b,a,c){a.exports=function(c,e,f,g){var h,d,m,a,b,n=e[0],o=e[1],p=e[2],q=e[3],i=f[0],j=f[1],k=f[2],l=f[3];return(d=n*i+o*j+p*k+q*l)<0&&(d=-d,i=-i,j=-j,k=-k,l=-l),1-d>1e-6?(h=Math.acos(d),m=Math.sin(h),a=Math.sin((1-g)*h)/m,b=Math.sin(g*h)/m):(a=1-g,b=g),c[0]=a*n+b*i,c[1]=a*o+b*j,c[2]=a*p+b*k,c[3]=a*q+b*l,c}},{}],125:[function(b,a,c){"use strict";a.exports=function(a){return a||0===a?a.toString():""}},{}],126:[function(a,b,c){"use strict";var d=a("vectorize-text");b.exports=function(f,l,i){var b,a,g=e[l];if(g||(g=e[l]={}),f in g)return g[f];var j={textAlign:"center",textBaseline:"middle",lineHeight:1,font:l,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};j.triangles=!0;var k=d(f,j);j.triangles=!1;var c=d(f,j);if(i&&1!==i){for(b=0;b<k.positions.length;++b)for(a=0;a<k.positions[b].length;++a)k.positions[b][a]/=i;for(b=0;b<c.positions.length;++b)for(a=0;a<c.positions[b].length;++a)c.positions[b][a]/=i}var h=[[1/0,1/0],[-1/0,-1/0]],n=c.positions.length;for(b=0;b<n;++b){var m=c.positions[b];for(a=0;a<2;++a)h[0][a]=Math.min(h[0][a],m[a]),h[1][a]=Math.max(h[1][a],m[a])}return g[f]=[k,c,h]};var e={}},{"vectorize-text":311}],127:[function(f,j,a){var k=f("gl-shader"),c=f("glslify"),g=c(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),h=c(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),i=c(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),d=c(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),e=c(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),b=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],l={vertex:g,fragment:d,attributes:b},m={vertex:h,fragment:d,attributes:b},n={vertex:i,fragment:d,attributes:b},o={vertex:g,fragment:e,attributes:b},p={vertex:h,fragment:e,attributes:b},q={vertex:i,fragment:e,attributes:b};function r(c,d){var b=k(c,d),a=b.attributes;return a.position.location=0,a.color.location=1,a.glyph.location=2,a.id.location=3,b}a.createPerspective=function(a){return r(a,l)},a.createOrtho=function(a){return r(a,m)},a.createProject=function(a){return r(a,n)},a.createPickPerspective=function(a){return r(a,o)},a.createPickOrtho=function(a){return r(a,p)},a.createPickProject=function(a){return r(a,q)}},{"gl-shader":132,glslify:231}],128:[function(b,c,f){"use strict";var g=b("is-string-blank"),h=b("gl-buffer"),i=b("gl-vao"),j=b("typedarray-pool"),k=b("gl-mat4/multiply"),l=b("./lib/shaders"),m=b("./lib/glyphs"),n=b("./lib/get-simple-string"),d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function o(b,a){var c=b[0],d=b[1],e=b[2],f=b[3];return b[0]=a[0]*c+a[4]*d+a[8]*e+a[12]*f,b[1]=a[1]*c+a[5]*d+a[9]*e+a[13]*f,b[2]=a[2]*c+a[6]*d+a[10]*e+a[14]*f,b[3]=a[3]*c+a[7]*d+a[11]*e+a[15]*f,b}function p(b,c,d,a){return o(a,a,d),o(a,a,c),o(a,a,b)}function q(a,b){this.index=a,this.dataCoordinate=this.position=b}function r(a){return!0===a?1:a>1?1:a}function e(a,b,c,d,e,f,g,h,i,j,k,l){this.gl=a,this.pixelRatio=1,this.shader=b,this.orthoShader=c,this.projectShader=d,this.pointBuffer=e,this.colorBuffer=f,this.glyphBuffer=g,this.idBuffer=h,this.vao=i,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=j,this.pickOrthoShader=k,this.pickProjectShader=l,this.points=[],this._selectResult=new q(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}c.exports=function(b){var a=b.gl,k=l.createPerspective(a),m=l.createOrtho(a),n=l.createProject(a),o=l.createPickPerspective(a),p=l.createPickOrtho(a),q=l.createPickProject(a),c=h(a),d=h(a),f=h(a),g=h(a),r=i(a,[{buffer:c,size:3,type:a.FLOAT},{buffer:d,size:4,type:a.FLOAT},{buffer:f,size:2,type:a.FLOAT},{buffer:g,size:4,type:a.UNSIGNED_BYTE,normalized:!0}]),j=new e(a,k,m,n,c,d,f,g,r,o,p,q);return j.update(b),j};var a=e.prototype;a.pickSlots=1,a.setPickBase=function(a){this.pickId=a},a.isTransparent=function(){if(this.hasAlpha)return!0;for(var a=0;a<3;++a)if(this.axesProject[a]&&this.projectHasAlpha)return!0;return!1},a.isOpaque=function(){if(!this.hasAlpha)return!0;for(var a=0;a<3;++a)if(this.axesProject[a]&&!this.projectHasAlpha)return!0;return!1};var s=[0,0],t=[0,0,0],u=[0,0,0],v=[0,0,0,1],w=[0,0,0,1],x=d.slice(),y=[0,0,0],z=[[0,0,0],[0,0,0]];function A(a){return a[0]=a[1]=a[2]=0,a}function B(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=1,a}function C(a,b,c,d){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[c]=d,a}var D=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function E(g,j,a,e,f,h,i){var c=a.gl;if((h===a.projectHasAlpha||i)&&function(G,a,q,H){var I,M=a.axesProject,l=a.gl,b=G.uniforms,m=q.model||d,r=q.view||d,D=q.projection||d,J=a.axesBounds,E=function(d){for(var c=z,a=0;a<2;++a)for(var b=0;b<3;++b)c[a][b]=Math.max(Math.min(d[a][b],1e8),-1e8);return c}(a.clipBounds);I=a.axes&&a.axes.lastCubeProps?a.axes.lastCubeProps.axis:[1,1,1],s[0]=2/l.drawingBufferWidth,s[1]=2/l.drawingBufferHeight,G.bind(),b.view=r,b.projection=D,b.screenSize=s,b.highlightId=a.highlightId,b.highlightScale=a.highlightScale,b.clipBounds=E,b.pickGroup=a.pickId/255,b.pixelRatio=H;for(var c=0;c<3;++c)if(M[c]){b.scale=a.projectScale[c],b.opacity=a.projectOpacity[c];for(var f=x,e=0;e<16;++e)f[e]=0;for(var e=0;e<4;++e)f[5*e]=1;f[5*c]=0,I[c]<0?f[12+c]=J[0][c]:f[12+c]=J[1][c],k(f,m,f),b.model=f;var i=(c+1)%3,j=(c+2)%3,g=A(t),h=A(u);g[i]=1,h[j]=1;var n=p(D,r,m,B(v,g)),o=p(D,r,m,B(w,h));if(Math.abs(n[1])>Math.abs(o[1])){var F=n;n=o,o=F,F=g,g=h,h=F;var N=i;i=j,j=N}n[0]<0&&(g[i]=-1),o[1]>0&&(h[j]=-1);for(var K=0,L=0,e=0;e<4;++e)K+=Math.pow(m[4*i+e],2),L+=Math.pow(m[4*j+e],2);g[i]/=Math.sqrt(K),h[j]/=Math.sqrt(L),b.axes[0]=g,b.axes[1]=h,b.fragClipBounds[0]=C(y,E[0],c,-1e8),b.fragClipBounds[1]=C(y,E[1],c,1e8),a.vao.bind(),a.vao.draw(l.TRIANGLES,a.vertexCount),a.lineWidth>0&&(l.lineWidth(a.lineWidth*H),a.vao.draw(l.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}(j,a,e,f),h===a.hasAlpha||i){g.bind();var b=g.uniforms;b.model=e.model||d,b.view=e.view||d,b.projection=e.projection||d,s[0]=2/c.drawingBufferWidth,s[1]=2/c.drawingBufferHeight,b.screenSize=s,b.highlightId=a.highlightId,b.highlightScale=a.highlightScale,b.fragClipBounds=D,b.clipBounds=a.axes.bounds,b.opacity=a.opacity,b.pickGroup=a.pickId/255,b.pixelRatio=f,a.vao.bind(),a.vao.draw(c.TRIANGLES,a.vertexCount),a.lineWidth>0&&(c.lineWidth(a.lineWidth*f),a.vao.draw(c.LINES,a.lineVertexCount,a.vertexCount)),a.vao.unbind()}}function F(a,d,f,h){b=n(b=Array.isArray(a)?d<a.length?a[d]:void 0:a);var b,e=!0;g(b)&&(b="\u25BC",e=!1);var c=m(b,f,h);return{mesh:c[0],lines:c[1],bounds:c[2],visible:e}}a.draw=function(a){E(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,a,this.pixelRatio,!1,!1)},a.drawTransparent=function(a){E(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,a,this.pixelRatio,!0,!1)},a.drawPick=function(a){E(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,a,1,!0,!0)},a.pick=function(a){if(!a)return null;if(a.id!==this.pickId)return null;var c=a.value[2]+(a.value[1]<<8)+(a.value[0]<<16);if(c>=this.pointCount||c<0)return null;var e=this.points[c],d=this._selectResult;d.index=c;for(var b=0;b<3;++b)d.position[b]=d.dataCoordinate[b]=e[b];return d},a.highlight=function(b){if(b){var a=b.index,c=255&a,d=a>>8&255,e=a>>16&255;this.highlightId=[c/255,d/255,e/255,0]}else this.highlightId=[1,1,1,1]},a.update=function(c){if("perspective"in(c=c||{})&&(this.useOrtho=!c.perspective),"orthographic"in c&&(this.useOrtho=!!c.orthographic),"lineWidth"in c&&(this.lineWidth=c.lineWidth),"project"in c)if(Array.isArray(c.project))this.axesProject=c.project;else{var S=!!c.project;this.axesProject=[S,S,S]}if("projectScale"in c)if(Array.isArray(c.projectScale))this.projectScale=c.projectScale.slice();else{var m=+c.projectScale;this.projectScale=[m,m,m]}if(this.projectHasAlpha=!1,"projectOpacity"in c){if(Array.isArray(c.projectOpacity))this.projectOpacity=c.projectOpacity.slice();else{var m=+c.projectOpacity;this.projectOpacity=[m,m,m]}for(var b=0;b<3;++b)this.projectOpacity[b]=r(this.projectOpacity[b]),this.projectOpacity[b]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in c&&(this.opacity=r(c.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var n=c.position,Z=c.font||"normal",s=c.alignment||[0,0];if(2===s.length)y=s[0],z=s[1];else{y=[],z=[];for(var b=0;b<s.length;++b)y[b]=s[b][0],z[b]=s[b][1]}var A=[1/0,1/0,1/0],B=[-1/0,-1/0,-1/0],$=c.glyph,t=c.color,C=c.size,D=c.angle,u=c.lineColor,T=-1,I=0,U=0,V=0;if(n.length){V=n.length;count_loop:for(var b=0;b<V;++b){for(var e=n[b],a=0;a<3;++a)if(isNaN(e[a])||!isFinite(e[a]))continue count_loop;var k=F($,b,Z,this.pixelRatio),J=k.mesh,K=k.lines,E=k.bounds;I+=3*J.cells.length,U+=2*K.edges.length}}var G=I+U,L=j.mallocFloat(3*G),M=j.mallocFloat(4*G),v=j.mallocFloat(2*G),N=j.mallocUint32(G);if(G>0){var w=0,x=I,g=[0,0,0,1],h=[0,0,0,1],_=Array.isArray(t)&&Array.isArray(t[0]),aa=Array.isArray(u)&&Array.isArray(u[0]);fill_loop:for(var b=0;b<V;++b){T+=1;for(var y,z,f,f,e=n[b],a=0;a<3;++a){if(isNaN(e[a])||!isFinite(e[a]))continue fill_loop;B[a]=Math.max(B[a],e[a]),A[a]=Math.min(A[a],e[a])}var k=F($,b,Z,this.pixelRatio),J=k.mesh,K=k.lines,E=k.bounds,W=k.visible;if(W)if(Array.isArray(t)){if(3===(f=_?b<t.length?t[b]:[0,0,0,0]:t).length){for(var a=0;a<3;++a)g[a]=f[a];g[3]=1}else if(4===f.length){for(var a=0;a<4;++a)g[a]=f[a];!this.hasAlpha&&f[3]<1&&(this.hasAlpha=!0)}}else g[0]=g[1]=g[2]=0,g[3]=1;else g=[1,1,1,0];if(W)if(Array.isArray(u)){if(3===(f=aa?b<u.length?u[b]:[0,0,0,0]:u).length){for(var a=0;a<3;++a)h[a]=f[a];h[a]=1}else if(4===f.length){for(var a=0;a<4;++a)h[a]=f[a];!this.hasAlpha&&f[3]<1&&(this.hasAlpha=!0)}}else h[0]=h[1]=h[2]=0,h[3]=1;else h=[1,1,1,0];var l=.5;W?Array.isArray(C)?l=b<C.length?+C[b]:12:C?l=+C:this.useOrtho&&(l=12):l=0;var O=0;Array.isArray(D)?O=b<D.length?+D[b]:0:D&&(O=+D);for(var P=Math.cos(O),Q=Math.sin(O),e=n[b],a=0;a<3;++a)B[a]=Math.max(B[a],e[a]),A[a]=Math.min(A[a],e[a]);var o=y,p=z,o=0;Array.isArray(y)?o=b<y.length?y[b]:0:y&&(o=y);var p=0;Array.isArray(z)?p=b<z.length?z[b]:0:z&&(p=z),o*=o>0?1-E[0][0]:o<0?1+E[1][0]:1,p*=p>0?1-E[0][1]:p<0?1+E[1][1]:1;for(var R=[o,p],H=J.cells||[],X=J.positions||[],a=0;a<H.length;++a)for(var Y=H[a],q=0;q<3;++q){for(var d=0;d<3;++d)L[3*w+d]=e[d];for(var d=0;d<4;++d)M[4*w+d]=g[d];N[w]=T;var i=X[Y[q]];v[2*w]=l*(P*i[0]-Q*i[1]+R[0]),v[2*w+1]=l*(Q*i[0]+P*i[1]+R[1]),w+=1}for(var H=K.edges,X=K.positions,a=0;a<H.length;++a)for(var Y=H[a],q=0;q<2;++q){for(var d=0;d<3;++d)L[3*x+d]=e[d];for(var d=0;d<4;++d)M[4*x+d]=h[d];N[x]=T;var i=X[Y[q]];v[2*x]=l*(P*i[0]-Q*i[1]+R[0]),v[2*x+1]=l*(Q*i[0]+P*i[1]+R[1]),x+=1}}}this.bounds=[A,B],this.points=n,this.pointCount=n.length,this.vertexCount=I,this.lineVertexCount=U,this.pointBuffer.update(L),this.colorBuffer.update(M),this.glyphBuffer.update(v),this.idBuffer.update(N),j.free(L),j.free(M),j.free(v),j.free(N)},a.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(c,d,a){"use strict";var b=c("glslify");a.boxVertex=b(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),a.boxFragment=b(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:231}],130:[function(a,c,e){"use strict";var f=a("gl-shader"),g=a("gl-buffer"),h=a("./lib/shaders");function d(a,b,c){this.plot=a,this.boxBuffer=b,this.boxShader=c,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}c.exports=function(a,e){var c=a.gl,i=g(c,[0,0,0,1,1,0,1,1]),j=f(c,h.boxVertex,h.boxFragment),b=new d(a,i,j);return b.update(e),a.addOverlay(b),b};var b=d.prototype;b.draw=function(){if(this.enabled){var i=this.plot,j=this.selectBox,o=this.borderWidth;this.innerFill;var p=this.innerColor;this.outerFill;var k=this.outerColor,l=this.borderColor,f=i.box,m=i.screenBox,c=i.dataBox,a=i.viewBox,q=i.pixelRatio,g=(j[0]-c[0])*(a[2]-a[0])/(c[2]-c[0])+a[0],d=(j[1]-c[1])*(a[3]-a[1])/(c[3]-c[1])+a[1],h=(j[2]-c[0])*(a[2]-a[0])/(c[2]-c[0])+a[0],e=(j[3]-c[1])*(a[3]-a[1])/(c[3]-c[1])+a[1];if(g=Math.max(g,a[0]),d=Math.max(d,a[1]),h=Math.min(h,a[2]),e=Math.min(e,a[3]),!(h<g)&&!(e<d)){f.bind();var n=m[2]-m[0],r=m[3]-m[1];if(this.outerFill&&(f.drawBox(0,0,n,d,k),f.drawBox(0,d,g,e,k),f.drawBox(0,e,n,r,k),f.drawBox(h,d,n,e,k)),this.innerFill&&f.drawBox(g,d,h,e,p),o>0){var b=o*q;f.drawBox(g-b,d-b,h+b,d+b,l),f.drawBox(g-b,e-b,h+b,e+b,l),f.drawBox(g-b,d-b,g+b,e+b,l),f.drawBox(h-b,d-b,h+b,e+b,l)}}}},b.update=function(a){a=a||{},this.innerFill=!!a.innerFill,this.outerFill=!!a.outerFill,this.innerColor=(a.innerColor||[0,0,0,.5]).slice(),this.outerColor=(a.outerColor||[0,0,0,.5]).slice(),this.borderColor=(a.borderColor||[0,0,0,1]).slice(),this.borderWidth=a.borderWidth||0,this.selectBox=(a.selectBox||this.selectBox).slice()},b.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(b,c,e){"use strict";c.exports=function(a,b){var c=b[0],e=b[1],h=f(a,c,e,{}),i=g.mallocUint8(c*e*4);return new d(a,h,i)};var f=b("gl-fbo"),g=b("typedarray-pool"),h=b("ndarray"),i=b("bit-twiddle").nextPow2,j=function(c,j,k){for(var d=1e8,e=-1,f=-1,l=c.shape[0],m=c.shape[1],a=0;a<l;a++)for(var b=0;b<m;b++){var n=c.get(a,b,0),o=c.get(a,b,1),p=c.get(a,b,2),q=c.get(a,b,3);if(n<255||o<255||p<255||q<255){var g=j-a,h=k-b,i=g*g+h*h;i<d&&(d=i,e=a,f=b)}}return[e,f,d]};function k(a,b,c,d,e){this.coord=[a,b],this.id=c,this.value=d,this.distance=e}function d(a,b,c){this.gl=a,this.fbo=b,this.buffer=c,this._readTimeout=null;var d=this;this._readCallback=function(){d.gl&&(b.bind(),a.readPixels(0,0,b.shape[0],b.shape[1],a.RGBA,a.UNSIGNED_BYTE,d.buffer),d._readTimeout=null)}}var a=d.prototype;Object.defineProperty(a,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(d){if(this.gl){this.fbo.shape=d;var a=this.fbo.shape[0],b=this.fbo.shape[1];if(b*a*4>this.buffer.length){g.free(this.buffer);for(var e=this.buffer=g.mallocUint8(i(b*a*4)),c=0;c<b*a*4;++c)e[c]=255}return d}}}),a.begin=function(){var a=this.gl;this.shape,a&&(this.fbo.bind(),a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT))},a.end=function(){var a=this.gl;a&&(a.bindFramebuffer(a.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},a.query=function(n,m,a){if(!this.gl)return null;var b=this.fbo.shape.slice();m|=0,"number"!=typeof a&&(a=1);var f=0|Math.min(Math.max((n|=0)-a,0),b[0]),o=0|Math.min(Math.max(n+a,0),b[0]),g=0|Math.min(Math.max(m-a,0),b[1]),p=0|Math.min(Math.max(m+a,0),b[1]);if(o<=f||p<=g)return null;var i=[o-f,p-g],d=h(this.buffer,[i[0],i[1],4],[4,4*b[0],1],4*(f+b[0]*g)),l=j(d.hi(i[0],i[1],1),a,a),c=l[0],e=l[1];if(c<0||Math.pow(this.radius,2)<l[2])return null;var q=d.get(c,e,0),r=d.get(c,e,1),s=d.get(c,e,2),t=d.get(c,e,3);return new k(c+f|0,e+g|0,q,[r,s,t],Math.sqrt(l[2]))},a.dispose=function(){this.gl&&(this.fbo.dispose(),g.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(a,c,e){"use strict";var f=a("./lib/create-uniforms"),g=a("./lib/create-attributes"),h=a("./lib/reflect"),i=a("./lib/shader-cache"),j=a("./lib/runtime-reflect"),k=a("./lib/GLError");function d(a){this.gl=a,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var b=d.prototype;function l(a,b){return a.name<b.name?-1:1}b.bind=function(){this.program||this._relink();var a,b=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),c=this.gl.lastAttribCount;if(b>c)for(a=c;a<b;a++)this.gl.enableVertexAttribArray(a);else if(c>b)for(a=b;a<c;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=b,this.gl.useProgram(this.program)},b.dispose=function(){for(var b=this.gl.lastAttribCount,a=0;a<b;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},b.update=function(r,s,o,e){if(!s||1===arguments.length){var m,q=r;r=q.vertex,s=q.fragment,o=q.uniforms,e=q.attributes}var b=this,c=b.gl,w=b._vref;b._vref=i.shader(c,c.VERTEX_SHADER,r),w&&w.dispose(),b.vertShader=b._vref.shader;var x=this._fref;if(b._fref=i.shader(c,c.FRAGMENT_SHADER,s),x&&x.dispose(),b.fragShader=b._fref.shader,!o||!e){var n=c.createProgram();if(c.attachShader(n,b.fragShader),c.attachShader(n,b.vertShader),c.linkProgram(n),!c.getProgramParameter(n,c.LINK_STATUS)){var y=c.getProgramInfoLog(n);throw new k(y,"Error linking program:"+y)}o=o||j.uniforms(c,n),e=e||j.attributes(c,n),c.deleteProgram(n)}(e=e.slice()).sort(l);var t=[],z=[],d=[];for(m=0;m<e.length;++m){var a=e[m];if(a.type.indexOf("mat")>=0){for(var u=0|a.type.charAt(a.type.length-1),A=new Array(u),p=0;p<u;++p)A[p]=d.length,z.push(a.name+"["+p+"]"),"number"==typeof a.location?d.push(a.location+p):Array.isArray(a.location)&&a.location.length===u&&"number"==typeof a.location[p]?d.push(0|a.location[p]):d.push(-1);t.push({name:a.name,type:a.type,locations:A})}else t.push({name:a.name,type:a.type,locations:[d.length]}),z.push(a.name),"number"==typeof a.location?d.push(0|a.location):d.push(-1)}var v=0;for(m=0;m<d.length;++m)if(d[m]<0){for(;d.indexOf(v)>=0;)v+=1;d[m]=v}var C=new Array(o.length);function B(){b.program=i.program(c,b._vref,b._fref,z,d);for(var a=0;a<o.length;++a)C[a]=c.getUniformLocation(b.program,o[a].name)}B(),b._relink=B,b.types={uniforms:h(o),attributes:h(e)},b.attributes=g(c,b,t,d),Object.defineProperty(b,"uniforms",f(c,b,o,C))},c.exports=function(b,c,e,f,g){var a=new d(b);return a.update(c,e,f,g),a}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(c,b,d){function a(b,c,a){this.shortMessage=c||"",this.longMessage=a||"",this.rawError=b||"",this.message="gl-shader: "+(c||b||"")+(a?"\n"+a:""),this.stack=new Error().stack}a.prototype=new Error,a.prototype.name="GLError",a.prototype.constructor=a,b.exports=a},{}],134:[function(b,c,e){"use strict";c.exports=function(e,g,n,j){for(var d={},k=0,o=n.length;k<o;++k){var l=n[k],c=l.name,a=l.type,m=l.locations;switch(a){case"bool":case"int":case"float":h(e,g,m[0],j,1,d,c);break;default:if(a.indexOf("vec")>=0){var b=a.charCodeAt(a.length-1)-48;if(b<2||b>4)throw new f("","Invalid data type for attribute "+c+": "+a);h(e,g,m[0],j,b,d,c)}else if(a.indexOf("mat")>=0){var b=a.charCodeAt(a.length-1)-48;if(b<2||b>4)throw new f("","Invalid data type for attribute "+c+": "+a);i(e,g,m,j,b,d,c)}else throw new f("","Unknown data type for attribute "+c+": "+a);break}}return d};var f=b("./GLError");function d(a,b,c,d,e,f){this._gl=a,this._wrapper=b,this._index=c,this._locations=d,this._dimension=e,this._constFunc=f}var a=d.prototype;a.pointer=function(c,d,e,f){var a=this._gl,b=this._locations[this._index];a.vertexAttribPointer(b,this._dimension,c||a.FLOAT,!!d,e||0,f||0),a.enableVertexAttribArray(b)},a.set=function(a,b,c,d){return this._constFunc(this._locations[this._index],a,b,c,d)},Object.defineProperty(a,"location",{get:function(){return this._locations[this._index]},set:function(a){return a!==this._locations[this._index]&&(this._locations[this._index]=0|a,this._wrapper.program=null),0|a}});var g=[function(b,c,a){return void 0===a.length?b.vertexAttrib1f(c,a):b.vertexAttrib1fv(c,a)},function(b,c,a,d){return void 0===a.length?b.vertexAttrib2f(c,a,d):b.vertexAttrib2fv(c,a)},function(b,c,a,d,e){return void 0===a.length?b.vertexAttrib3f(c,a,d,e):b.vertexAttrib3fv(c,a)},function(b,c,a,d,e,f){return void 0===a.length?b.vertexAttrib4f(c,a,d,e,f):b.vertexAttrib4fv(c,a)}];function h(b,c,e,f,a,h,i){var j=g[a],k=new d(b,c,e,f,a,j);Object.defineProperty(h,i,{set:function(a){return b.disableVertexAttribArray(f[e]),j(b,f[e],a),a},get:function(){return k},enumerable:!0})}function i(d,e,f,g,a,i,j){for(var c=new Array(a),k=new Array(a),b=0;b<a;++b)h(d,e,f[b],g,a,c,b),k[b]=c[b];Object.defineProperty(c,"location",{set:function(c){if(Array.isArray(c))for(var b=0;b<a;++b)k[b].location=c[b];else for(var b=0;b<a;++b)k[b].location=c+b;return c},get:function(){for(var c=new Array(a),b=0;b<a;++b)c[b]=g[f[b]];return c},enumerable:!0}),c.pointer=function(c,e,h,i){c=c||d.FLOAT,e=!!e,h=h||a*a,i=i||0;for(var b=0;b<a;++b){var j=g[f[b]];d.vertexAttribPointer(j,a,c,e,h,i+b*a),d.enableVertexAttribArray(j)}};var l=new Array(a),m=d["vertexAttrib"+a+"fv"];Object.defineProperty(i,j,{set:function(c){for(var b=0;b<a;++b){var h=g[f[b]];if(d.disableVertexAttribArray(h),Array.isArray(c[0]))m.call(d,h,c[b]);else{for(var e=0;e<a;++e)l[e]=c[a*b+e];m.call(d,h,l)}}return c},get:function(){return c},enumerable:!0})}},{"./GLError":133}],135:[function(a,b,c){"use strict";var d=a("./reflect"),e=a("./GLError");function f(a){return function(){return a}}function g(b,d){for(var c=new Array(b),a=0;a<b;++a)c[a]=d;return c}b.exports=function(i,j,b,k){function c(a){return function(m){for(var p=l("",a),n=0;n<p.length;++n){var q=p[n],j=q[0],f=q[1];if(k[f]){var g,h=m;if("string"==typeof j&&(0===j.indexOf(".")||0===j.indexOf("["))){var d=j;if(0===j.indexOf(".")&&(d=j.slice(1)),d.indexOf("]")===d.length-1){var r=d.indexOf("["),s=d.slice(0,r),t=d.slice(r+1,d.length-1);h=s?m[s][t]:m[t]}else h=m[d]}var c=b[f].type;switch(c){case"bool":case"int":case"sampler2D":case"samplerCube":i.uniform1i(k[f],h);break;case"float":i.uniform1f(k[f],h);break;default:var o=c.indexOf("vec");if(0<=o&&o<=1&&c.length===4+o){if((g=c.charCodeAt(c.length-1)-48)<2||g>4)throw new e("","Invalid data type");switch(c.charAt(0)){case"b":case"i":i["uniform"+g+"iv"](k[f],h);break;case"v":i["uniform"+g+"fv"](k[f],h);break;default:throw new e("","Unrecognized data type for vector "+name+": "+c)}}else if(0===c.indexOf("mat")&&4===c.length){if((g=c.charCodeAt(c.length-1)-48)<2||g>4)throw new e("","Invalid uniform dimension type for matrix "+name+": "+c);i["uniformMatrix"+g+"fv"](k[f],!1,h);break}else throw new e("","Unknown uniform data type for "+name+": "+c)}}}}}function l(f,b){if("object"!=typeof b)return[[f,b]];var c=[];for(var a in b){var e=b[a],d=f;parseInt(a)+""===a?d+="["+a+"]":d+="."+a,"object"==typeof e?c.push.apply(c,l(d,e)):c.push([d,e])}return c}function m(d,i,a){if("object"==typeof a){var j,l=h(a);Object.defineProperty(d,i,{get:f(l),set:c(a),enumerable:!0,configurable:!1})}else k[a]?Object.defineProperty(d,i,{get:(j=a,function(a,b,c){return a.getUniform(b.program,c[j])}),set:c(a),enumerable:!0,configurable:!1}):d[i]=function(a){switch(a){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var c=a.indexOf("vec");if(0<=c&&c<=1&&a.length===4+c){var b=a.charCodeAt(a.length-1)-48;if(b<2||b>4)throw new e("","Invalid data type");if("b"===a.charAt(0))return g(b,!1);return g(b,0)}if(0===a.indexOf("mat")&&4===a.length){var b=a.charCodeAt(a.length-1)-48;if(b<2||b>4)throw new e("","Invalid uniform dimension type for matrix "+name+": "+a);return g(b*b,0)}throw new e("","Unknown uniform data type for "+name+": "+a)}}(b[a].type)}function h(a){var b;if(Array.isArray(a)){b=new Array(a.length);for(var c=0;c<a.length;++c)m(b,c,a[c])}else for(var d in b={},a)m(b,d,a[d]);return b}var a=d(b,!0);return{get:f(h(a)),set:c(a),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(b,a,c){"use strict";a.exports=function(g,i){for(var j={},c=0;c<g.length;++c)for(var h=g[c].name.split("."),a=j,e=0;e<h.length;++e){var b=h[e].split("[");if(b.length>1){b[0]in a||(a[b[0]]=[]),a=a[b[0]];for(var f=1;f<b.length;++f){var d=parseInt(b[f]);f<b.length-1||e<h.length-1?(d in a||(f<b.length-1?a[d]=[]:a[d]={}),a=a[d]):i?a[d]=c:a[d]=g[c].type}}else e<h.length-1?(b[0]in a||(a[b[0]]={}),a=a[b[0]]):i?a[b[0]]=c:a[b[0]]=g[c].type}return j}},{}],137:[function(b,c,a){"use strict";a.uniforms=function(b,g){for(var i=b.getProgramParameter(g,b.ACTIVE_UNIFORMS),c=[],d=0;d<i;++d){var a=b.getActiveUniform(g,d);if(a){var h=f(b,a.type);if(a.size>1)for(var e=0;e<a.size;++e)c.push({name:a.name.replace("[0]","["+e+"]"),type:h});else c.push({name:a.name,type:h})}}return c},a.attributes=function(a,d){for(var g=a.getProgramParameter(d,a.ACTIVE_ATTRIBUTES),e=[],b=0;b<g;++b){var c=a.getActiveAttrib(d,b);c&&e.push({name:c.name,type:f(a,c.type)})}return e};var d={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},e=null;function f(f,g){if(!e){var b=Object.keys(d);e={};for(var a=0;a<b.length;++a){var c=b[a];e[f[c]]=d[c]}}return e[g]}},{}],138:[function(a,f,b){"use strict";b.shader=function(a,b,c){return k(a).getShaderReference(b,c)},b.program=function(a,b,c,d,e){return k(a).getProgram(b,c,d,e)};var g=a("./GLError"),h=a("gl-format-compiler-error"),i=new("undefined"==typeof WeakMap?a("weakmap-shim"):WeakMap),j=0;function d(a,b,c,d,g,e,f){this.id=a,this.src=b,this.type=c,this.shader=d,this.count=e,this.programs=[],this.cache=f}function e(a){this.gl=a,this.shaders=[{},{}],this.programs={}}d.prototype.dispose=function(){if(0== --this.count){for(var a=this.cache,c=a.gl,d=this.programs,b=0,f=d.length;b<f;++b){var e=a.programs[d[b]];e&&(delete a.programs[b],c.deleteProgram(e))}c.deleteShader(this.shader),delete a.shaders[this.type===c.FRAGMENT_SHADER|0][this.src]}};var c=e.prototype;function k(b){var a=i.get(b);return a||(a=new e(b),i.set(b,a)),a}c.getShaderReference=function(c,b){var e=this.gl,f=this.shaders[c===e.FRAGMENT_SHADER|0],a=f[b];if(a&&e.isShader(a.shader))a.count+=1;else{var i=function(a,d,e){var b=a.createShader(d);if(a.shaderSource(b,e),a.compileShader(b),!a.getShaderParameter(b,a.COMPILE_STATUS)){var c=a.getShaderInfoLog(b);try{var f=h(c,e,d)}catch(i){throw console.warn("Failed to format compiler error: "+i),new g(c,"Error compiling shader:\n"+c)}throw new g(c,f.short,f.long)}return b}(e,c,b);a=f[b]=new d(j++,b,c,i,[],1,this)}return a},c.getProgram=function(c,d,e,f){var a=[c.id,d.id,e.join(":"),f.join(":")].join("@"),b=this.programs[a];return b&&this.gl.isProgram(b)||(this.programs[a]=b=function(a,f,h,d,i){var b=a.createProgram();a.attachShader(b,f),a.attachShader(b,h);for(var c=0;c<d.length;++c)a.bindAttribLocation(b,i[c],d[c]);if(a.linkProgram(b),!a.getProgramParameter(b,a.LINK_STATUS)){var e=a.getProgramInfoLog(b);throw new g(e,"Error linking program: "+e)}return b}(this.gl,c.shader,d.shader,e,f),c.programs.push(a),d.programs.push(a)),b}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(d,b,e){"use strict";function c(a){this.plot=a,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}b.exports=function(b,d){var a=new c(b);return a.update(d),b.addOverlay(a),a};var a=c.prototype;a.update=function(a){a=a||{},this.enable=(a.enable||[!0,!0,!1,!1]).slice(),this.width=(a.width||[1,1,1,1]).slice(),this.color=(a.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(a){return a.slice()}),this.center=(a.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},a.draw=function(){var g=this.enable,h=this.width,i=this.color,c=this.center,j=this.plot,f=j.line,a=j.dataBox,b=j.viewBox;if(f.bind(),a[0]<=c[0]&&c[0]<=a[2]&&a[1]<=c[1]&&c[1]<=a[3]){var d=b[0]+(c[0]-a[0])/(a[2]-a[0])*(b[2]-b[0]),e=b[1]+(c[1]-a[1])/(a[3]-a[1])*(b[3]-b[1]);g[0]&&f.drawLine(d,e,b[0],e,h[0],i[0]),g[1]&&f.drawLine(d,e,d,b[1],h[1],i[1]),g[2]&&f.drawLine(d,e,b[2],e,h[2],i[2]),g[3]&&f.drawLine(d,e,d,b[3],h[3],i[3])}},a.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(a,c,d){"use strict";var b=a("glslify"),e=a("gl-shader"),f=b(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),g=b(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);c.exports=function(a){return e(a,f,g,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(b,c,e){"use strict";var f=b("gl-buffer"),g=b("gl-vao"),h=b("./shaders/index");c.exports=function(b,j){var k=[];function a(d,e,f,b,c,g){var a=[d,e,f,0,0,0,1];a[b+3]=1,a[b]=c,k.push.apply(k,a),a[6]=-1,k.push.apply(k,a),a[b]=g,k.push.apply(k,a),k.push.apply(k,a),a[6]=1,k.push.apply(k,a),a[b]=c,k.push.apply(k,a)}a(0,0,0,0,0,1),a(0,0,0,1,0,1),a(0,0,0,2,0,1),a(1,0,0,1,-1,1),a(1,0,0,2,-1,1),a(0,1,0,0,-1,1),a(0,1,0,2,-1,1),a(0,0,1,0,-1,1),a(0,0,1,1,-1,1);var c=f(b,k),l=g(b,[{type:b.FLOAT,buffer:c,size:3,offset:0,stride:28},{type:b.FLOAT,buffer:c,size:3,offset:12,stride:28},{type:b.FLOAT,buffer:c,size:1,offset:24,stride:28}]),e=h(b);e.attributes.position.location=0,e.attributes.color.location=1,e.attributes.weight.location=2;var i=new d(b,c,l,e);return i.update(j),i};var i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(a,b,c,d){this.gl=a,this.buffer=b,this.vao=c,this.shader=d,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var a=d.prototype,j=[0,0,0],k=[0,0,0],l=[0,0];a.isTransparent=function(){return!1},a.drawTransparent=function(a){},a.draw=function(e){var f,c=this.gl,d=this.vao,b=this.shader;d.bind(),b.bind();var m=e.model||i,n=e.view||i,o=e.projection||i;this.axes&&(f=this.axes.lastCubeProps.axis);for(var g=j,h=k,a=0;a<3;++a)f&&f[a]<0?(g[a]=this.bounds[0][a],h[a]=this.bounds[1][a]):(g[a]=this.bounds[1][a],h[a]=this.bounds[0][a]);l[0]=c.drawingBufferWidth,l[1]=c.drawingBufferHeight,b.uniforms.model=m,b.uniforms.view=n,b.uniforms.projection=o,b.uniforms.coordinates=[this.position,g,h],b.uniforms.colors=this.colors,b.uniforms.screenShape=l;for(var a=0;a<3;++a)b.uniforms.lineWidth=this.lineWidth[a]*this.pixelRatio,this.enabled[a]&&(d.draw(c.TRIANGLES,6,6*a),this.drawSides[a]&&d.draw(c.TRIANGLES,12,18+12*a));d.unbind()},a.update=function(a){a&&("bounds"in a&&(this.bounds=a.bounds),"position"in a&&(this.position=a.position),"lineWidth"in a&&(this.lineWidth=a.lineWidth),"colors"in a&&(this.colors=a.colors),"enabled"in a&&(this.enabled=a.enabled),"drawSides"in a&&(this.drawSides=a.drawSides))},a.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(c,h,b){var a=c("glslify"),d=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),e=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),f=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),g=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);b.meshShader={vertex:d,fragment:e,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},b.pickShader={vertex:f,fragment:g,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(a,b,c){"use strict";var d=a("gl-vec3"),e=a("gl-vec4"),f=["xyz","xzy","yxz","yzx","zxy","zyx"],g=function(l,v,w,x){for(var p=l.points,y=l.velocities,z=l.divergences,m=[],q=[],r=[],c=[],f=[],s=[],i=0,g=0,b=e.create(),j=e.create(),k=0;k<p.length;k++){var n=p[k],t=y[k],u=z[k];0===v&&(u=.05*w),g=d.length(t)/x,b=e.create(),d.copy(b,t),b[3]=u;for(var a=0;a<8;a++)f[a]=[n[0],n[1],n[2],a];if(c.length>0)for(var a=0;a<8;a++){var o=(a+1)%8;m.push(c[a],f[a],f[o],f[o],c[o],c[a]),r.push(j,b,b,b,j,j),s.push(i,g,g,g,i,i);var h=m.length;q.push([h-6,h-5,h-4],[h-3,h-2,h-1])}var A=c;c=f,f=A;var B=j;j=b,b=B;var C=i;i=g,g=C}return{positions:m,cells:q,vectors:r,vertexIntensity:s}},h=function(f,q,s,t){for(var k=0,a=0;a<f.length;a++)for(var l=f[a].velocities,b=0;b<l.length;b++)k=Math.max(k,d.length(l[b]));for(var m=f.map(function(a){return g(a,s,t,k)}),e=[],n=[],h=[],i=[],a=0;a<m.length;a++){var c=m[a],r=e.length;e=e.concat(c.positions),h=h.concat(c.vectors),i=i.concat(c.vertexIntensity);for(var b=0;b<c.cells.length;b++){var o=c.cells[b],p=[];n.push(p);for(var j=0;j<o.length;j++)p.push(o[j]+r)}}return{positions:e,cells:n,vectors:h,vertexIntensity:i,colormap:q}},i=function(b,c){var a,e=b.length;for(a=0;a<e;a++){var d=b[a];if(d===c)return a;if(d>c)return a-1}return a},j=function(a,b,c){return a<b?b:a>c?c:a},k=function(x,z,v){var n,o,p,q,r,s,t=z.vectors,h=z.meshgrid,A=x[0],B=x[1],C=x[2],a=h[0].length,b=h[1].length,c=h[2].length,e=i(h[0],A),f=i(h[1],B),g=i(h[2],C),k=e+1,l=f+1,m=g+1;if(e=j(e,0,a-1),k=j(k,0,a-1),f=j(f,0,b-1),l=j(l,0,b-1),g=j(g,0,c-1),m=j(m,0,c-1),e<0||f<0||g<0||k>a-1||l>b-1||m>c-1)return d.create();var D=h[0][e],N=h[0][k],E=h[1][f],O=h[1][l],F=h[2][g],P=h[2][m],u=(A-D)/(N-D),w=(B-E)/(O-E),y=(C-F)/(P-F);switch(isFinite(u)||(u=.5),isFinite(w)||(w=.5),isFinite(y)||(y=.5),v.reversedX&&(e=a-1-e,k=a-1-k),v.reversedY&&(f=b-1-f,l=b-1-l),v.reversedZ&&(g=c-1-g,m=c-1-m),v.filled){case 5:r=g,s=m,p=f*c,q=l*c,n=e*c*b,o=k*c*b;break;case 4:r=g,s=m,n=e*c,o=k*c,p=f*c*a,q=l*c*a;break;case 3:p=f,q=l,r=g*b,s=m*b,n=e*b*c,o=k*b*c;break;case 2:p=f,q=l,n=e*b,o=k*b,r=g*b*a,s=m*b*a;break;case 1:n=e,o=k,r=g*a,s=m*a,p=f*a*c,q=l*a*c;break;default:n=e,o=k,p=f*a,q=l*a,r=g*a*b,s=m*a*b;break}var Q=t[n+p+r],R=t[n+p+s],S=t[n+q+r],T=t[n+q+s],U=t[o+p+r],V=t[o+p+s],W=t[o+q+r],X=t[o+q+s],G=d.create(),H=d.create(),I=d.create(),J=d.create();d.lerp(G,Q,U,u),d.lerp(H,R,V,u),d.lerp(I,S,W,u),d.lerp(J,T,X,u);var K=d.create(),L=d.create();d.lerp(K,G,I,w),d.lerp(L,H,J,w);var M=d.create();return d.lerp(M,K,L,y),M},l=function(a){var c=1/0;a.sort(function(a,b){return a-b});for(var e=a.length,b=1;b<e;b++){var d=Math.abs(a[b]-a[b-1]);d<c&&(c=d)}return c},m=function(f){for(var g=[],h=[],i=[],j={},k={},m={},o=f.length,a=0;a<o;a++){var b=f[a],c=b[0],d=b[1],e=b[2];j[c]||(g.push(c),j[c]=!0),k[d]||(h.push(d),k[d]=!0),m[e]||(i.push(e),m[e]=!0)}var p=l(g),q=l(h),r=l(i),n=Math.min(p,q,r);return isFinite(n)?n:1};b.exports=function(c,e){var o=c.startingPositions,p=c.maxLength||1e3,H=c.tubeSize||1,A=c.absoluteTubeSize,l=c.gridFill||"+x+y+z",n={};-1!==l.indexOf("-x")&&(n.reversedX=!0),-1!==l.indexOf("-y")&&(n.reversedY=!0),-1!==l.indexOf("-z")&&(n.reversedZ=!0),n.filled=f.indexOf(l.replace(/-/g,"").replace(/\+/g,""));var B=c.getVelocity||function(a){return k(a,c,n)},C=c.getDivergence||function(f,g){var a=d.create();d.add(a,f,[1e-4,0,0]);var b=B(a);d.subtract(b,b,g),d.scale(b,b,1e4),d.add(a,f,[0,1e-4,0]);var c=B(a);d.subtract(c,c,g),d.scale(c,c,1e4),d.add(a,f,[0,0,1e-4]);var e=B(a);return d.subtract(e,e,g),d.scale(e,e,1e4),d.add(a,b,c),d.add(a,a,e),a},D=[],I=e[0][0],J=e[0][1],K=e[0][2],L=e[1][0],M=e[1][1],N=e[1][2],q=10*d.distance(e[0],e[1])/p,r=q*q,s=1,g=0,E=o.length;E>1&&(s=m(o));for(var t=0;t<E;t++){var i=d.create();d.copy(i,o[t]);var u=[i],v=[],j=B(i),F=i;v.push(j);var w=[],x=C(i,j),b=d.length(x);isFinite(b)&&b>g&&(g=b),w.push(b),D.push({points:u,velocities:v,divergences:w});for(var G=0;G<100*p&&u.length<p&&function(a){var b=a[0],c=a[1],d=a[2];return!(b<I||b>L||c<J||c>M||d<K||d>N)}(i);){G++;var a=d.clone(j),y=d.squaredLength(a);if(0===y)break;if(y>r&&d.scale(a,a,q/Math.sqrt(y)),d.add(a,a,i),j=B(a),d.squaredDistance(F,a)-r> -0.0001*r){u.push(a),F=a,v.push(j);var x=C(a,j),b=d.length(x);isFinite(b)&&b>g&&(g=b),w.push(b)}i=a}}var z=h(D,c.colormap,g,s);return A?z.tubeScale=A:(0===g&&(g=1),z.tubeScale=.5*H*s/g),z};var n=a("./lib/shaders"),o=a("gl-cone3d").createMesh;b.exports.createTubeMesh=function(a,b){return o(a,b,{shaders:n,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(c,d,a){var e=c("gl-shader"),b=c("glslify"),f=b(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),g=b(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),h=b(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),i=b(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);a.createShader=function(b){var a=e(b,f,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a.attributes.normal.location=2,a},a.createPickShader=function(b){var a=e(b,f,i,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a.attributes.normal.location=2,a},a.createContourShader=function(b){var a=e(b,h,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a},a.createPickContourShader=function(b){var a=e(b,h,i,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a}},{"gl-shader":132,glslify:231}],145:[function(a,e,g){"use strict";e.exports=function(d){var a=d.gl,n=v(a),o=x(a),p=w(a),q=y(a),b=i(a),r=j(a,[{buffer:b,size:4,stride:40,offset:0},{buffer:b,size:3,stride:40,offset:16},{buffer:b,size:3,stride:40,offset:28}]),e=i(a),s=j(a,[{buffer:e,size:4,stride:20,offset:0},{buffer:e,size:1,stride:20,offset:16}]),h=i(a),t=j(a,[{buffer:h,size:2,type:a.FLOAT}]),g=k(a,1,256,a.RGBA,a.UNSIGNED_BYTE);g.minFilter=a.LINEAR,g.magFilter=a.LINEAR;var l=new f(a,[0,0],[[0,0,0],[0,0,0]],n,o,b,r,g,p,q,e,s,h,t,[0,0,0]),c={levels:[[],[],[]]};for(var m in d)c[m]=d[m];return c.colormap=c.colormap||"jet",l.update(c),l};var h=a("bit-twiddle"),i=a("gl-buffer"),j=a("gl-vao"),k=a("gl-texture2d"),l=a("typedarray-pool"),m=a("colormap"),n=a("ndarray-ops"),o=a("ndarray-pack"),p=a("ndarray"),q=a("surface-nets"),r=a("gl-mat4/multiply"),s=a("gl-mat4/invert"),t=a("binary-search-bounds"),u=a("ndarray-gradient"),d=a("./lib/shaders"),v=d.createShader,w=d.createContourShader,x=d.createPickShader,y=d.createPickContourShader,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],z=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function B(a,b,c,d,e){this.position=a,this.index=b,this.uv=c,this.level=d,this.dataCoordinate=e}function f(a,b,c,d,e,f,g,h,i,j,k,m,n,o,q){this.gl=a,this.shape=b,this.bounds=c,this.objectOffset=q,this.intensityBounds=[],this._shader=d,this._pickShader=e,this._coordinateBuffer=f,this._vao=g,this._colorMap=h,this._contourShader=i,this._contourPickShader=j,this._contourBuffer=k,this._contourVAO=m,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new B([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=n,this._dynamicVAO=o,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[p(l.mallocFloat(1024),[0,0]),p(l.mallocFloat(1024),[0,0]),p(l.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}!function(){for(var a=0;a<3;++a){var b=A[a],c=(a+1)%3,d=(a+2)%3;b[c+0]=1,b[d+3]=1,b[a+6]=1}}();var b=f.prototype;b.genColormap=function(b,d){var c=!1,a=o([m({colormap:b,nshades:256,format:"rgba"}).map(function(a,e){var b=d?function(c,a){if(!a)return 1;if(!a.length)return 1;for(var b=0;b<a.length;++b){if(a.length<2)return 1;if(a[b][0]===c)return a[b][1];if(a[b][0]>c&&b>0){var d=(a[b][0]-c)/(a[b][0]-a[b-1][0]);return a[b][1]*(1-d)+d*a[b-1][1]}}return 1}(e/255,d):a[3];return b<1&&(c=!0),[a[0],a[1],a[2],255*b]})]);return n.divseq(a,255),this.hasAlphaScale=c,a},b.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},b.isOpaque=function(){return!this.isTransparent()},b.pickSlots=1,b.setPickBase=function(a){this.pickId=a};var C=[0,0,0],D={showSurface:!1,showContour:!1,projections:[c.slice(),c.slice(),c.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function E(i,c){var b,a,e,j=c.axes&&c.axes.lastCubeProps.axis||C,f=c.showSurface,g=c.showContour;for(b=0;b<3;++b)for(a=0,f=f||c.surfaceProject[b];a<3;++a)g=g||c.contourProject[b][a];for(b=0;b<3;++b){var d=D.projections[b];for(a=0;a<16;++a)d[a]=0;for(a=0;a<4;++a)d[5*a]=1;d[5*b]=0,d[12+b]=c.axesBounds[+(j[b]>0)][b],r(d,i.model,d);var h=D.clipBounds[b];for(e=0;e<2;++e)for(a=0;a<3;++a)h[e][a]=i.clipBounds[e][a];h[0][b]=-1e8,h[1][b]=1e8}return D.showSurface=f,D.showContour=g,D}var F={model:c,view:c,projection:c,inverseModel:c.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-0.0001,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},G=c.slice(),H=[1,0,0,0,1,0,0,0,1];function I(k,o){k=k||{};var f=this.gl;f.disable(f.CULL_FACE),this._colorMap.bind(0);var d=F;d.model=k.model||c,d.view=k.view||c,d.projection=k.projection||c,d.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],d.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],d.objectOffset=this.objectOffset,d.contourColor=this.contourColor[0],d.inverseModel=s(d.inverseModel,d.model);for(var a=0;a<2;++a)for(var n=d.clipBounds[a],b=0;b<3;++b)n[b]=Math.min(Math.max(this.clipBounds[a][b],-1e8),1e8);d.kambient=this.ambientLight,d.kdiffuse=this.diffuseLight,d.kspecular=this.specularLight,d.roughness=this.roughness,d.fresnel=this.fresnel,d.opacity=this.opacity,d.height=0,d.permutation=H,d.vertexColor=this.vertexColor;var g=G;for(r(g,d.view,d.model),r(g,d.projection,g),s(g,g),a=0;a<3;++a)d.eyePosition[a]=g[12+a]/g[15];var l=g[15];for(a=0;a<3;++a)l+=this.lightPosition[a]*g[4*a+3];for(a=0;a<3;++a){var m=g[12+a];for(b=0;b<3;++b)m+=g[4*b+a]*this.lightPosition[b];d.lightPosition[a]=m/l}var i=E(d,this);if(i.showSurface){for(this._shader.bind(),this._shader.uniforms=d,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(f.TRIANGLES,this._vertexCount),a=0;a<3;++a)this.surfaceProject[a]&&this.vertexCount&&(this._shader.uniforms.model=i.projections[a],this._shader.uniforms.clipBounds=i.clipBounds[a],this._vao.draw(f.TRIANGLES,this._vertexCount));this._vao.unbind()}if(i.showContour){var e=this._contourShader;d.kambient=1,d.kdiffuse=0,d.kspecular=0,d.opacity=1,e.bind(),e.uniforms=d;var j=this._contourVAO;for(j.bind(),a=0;a<3;++a)for(e.uniforms.permutation=A[a],f.lineWidth(this.contourWidth[a]*this.pixelRatio),b=0;b<this.contourLevels[a].length;++b)b===this.highlightLevel[a]?(e.uniforms.contourColor=this.highlightColor[a],e.uniforms.contourTint=this.highlightTint[a]):(0===b||b-1===this.highlightLevel[a])&&(e.uniforms.contourColor=this.contourColor[a],e.uniforms.contourTint=this.contourTint[a]),this._contourCounts[a][b]&&(e.uniforms.height=this.contourLevels[a][b],j.draw(f.LINES,this._contourCounts[a][b],this._contourOffsets[a][b]));for(a=0;a<3;++a)for(b=0,e.uniforms.model=i.projections[a],e.uniforms.clipBounds=i.clipBounds[a];b<3;++b)if(this.contourProject[a][b]){e.uniforms.permutation=A[b],f.lineWidth(this.contourWidth[b]*this.pixelRatio);for(var h=0;h<this.contourLevels[b].length;++h)h===this.highlightLevel[b]?(e.uniforms.contourColor=this.highlightColor[b],e.uniforms.contourTint=this.highlightTint[b]):(0===h||h-1===this.highlightLevel[b])&&(e.uniforms.contourColor=this.contourColor[b],e.uniforms.contourTint=this.contourTint[b]),this._contourCounts[b][h]&&(e.uniforms.height=this.contourLevels[b][h],j.draw(f.LINES,this._contourCounts[b][h],this._contourOffsets[b][h]))}for(j.unbind(),(j=this._dynamicVAO).bind(),a=0;a<3;++a)if(0!==this._dynamicCounts[a])for(e.uniforms.model=d.model,e.uniforms.clipBounds=d.clipBounds,e.uniforms.permutation=A[a],f.lineWidth(this.dynamicWidth[a]*this.pixelRatio),e.uniforms.contourColor=this.dynamicColor[a],e.uniforms.contourTint=this.dynamicTint[a],e.uniforms.height=this.dynamicLevel[a],j.draw(f.LINES,this._dynamicCounts[a],this._dynamicOffsets[a]),b=0;b<3;++b)this.contourProject[b][a]&&(e.uniforms.model=i.projections[b],e.uniforms.clipBounds=i.clipBounds[b],j.draw(f.LINES,this._dynamicCounts[a],this._dynamicOffsets[a]));j.unbind()}}b.draw=function(a){return I.call(this,a,!1)},b.drawTransparent=function(a){return I.call(this,a,!0)};var J={model:c,view:c,projection:c,inverseModel:c,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function K(a,b){return Array.isArray(a)?[b(a[0]),b(a[1]),b(a[2])]:[b(a),b(a),b(a)]}function L(a){return Array.isArray(a)?3===a.length?[a[0],a[1],a[2],1]:[a[0],a[1],a[2],a[3]]:[0,0,0,1]}function M(a){if(Array.isArray(a)){if(Array.isArray(a))return[L(a[0]),L(a[1]),L(a[2])];var b=L(a);return[b.slice(),b.slice(),b.slice()]}}b.drawPick=function(i){i=i||{};var e=this.gl;e.disable(e.CULL_FACE);var d=J;d.model=i.model||c,d.view=i.view||c,d.projection=i.projection||c,d.shape=this._field[2].shape,d.pickId=this.pickId/255,d.lowerBound=this.bounds[0],d.upperBound=this.bounds[1],d.objectOffset=this.objectOffset,d.permutation=H;for(var b=0;b<2;++b)for(var k=d.clipBounds[b],a=0;a<3;++a)k[a]=Math.min(Math.max(this.clipBounds[b][a],-1e8),1e8);var g=E(d,this);if(g.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=d,this._vao.bind(),this._vao.draw(e.TRIANGLES,this._vertexCount),b=0;b<3;++b)this.surfaceProject[b]&&(this._pickShader.uniforms.model=g.projections[b],this._pickShader.uniforms.clipBounds=g.clipBounds[b],this._vao.draw(e.TRIANGLES,this._vertexCount));this._vao.unbind()}if(g.showContour){var f=this._contourPickShader;f.bind(),f.uniforms=d;var j=this._contourVAO;for(j.bind(),a=0;a<3;++a)for(e.lineWidth(this.contourWidth[a]*this.pixelRatio),f.uniforms.permutation=A[a],b=0;b<this.contourLevels[a].length;++b)this._contourCounts[a][b]&&(f.uniforms.height=this.contourLevels[a][b],j.draw(e.LINES,this._contourCounts[a][b],this._contourOffsets[a][b]));for(b=0;b<3;++b)for(a=0,f.uniforms.model=g.projections[b],f.uniforms.clipBounds=g.clipBounds[b];a<3;++a)if(this.contourProject[b][a]){f.uniforms.permutation=A[a],e.lineWidth(this.contourWidth[a]*this.pixelRatio);for(var h=0;h<this.contourLevels[a].length;++h)this._contourCounts[a][h]&&(f.uniforms.height=this.contourLevels[a][h],j.draw(e.LINES,this._contourCounts[a][h],this._contourOffsets[a][h]))}j.unbind()}},b.pick=function(f){if(!f)return null;if(f.id!==this.pickId)return null;var i=this._field[2].shape,b=this._pickResult,l=i[0]*(f.value[0]+(f.value[2]>>4)/16)/255,g=Math.floor(l),m=l-g,n=i[1]*(f.value[1]+(15&f.value[2])/16)/255,h=Math.floor(n),o=n-h;g+=1,h+=1;var d=b.position;d[0]=d[1]=d[2]=0;for(var j=0;j<2;++j)for(var p=j?m:1-m,k=0;k<2;++k)for(var q=k?o:1-o,r=g+j,s=h+k,u=p*q,c=0;c<3;++c)d[c]+=this._field[c].get(r,s)*u;for(var e=this._pickResult.level,a=0;a<3;++a)if(e[a]=t.le(this.contourLevels[a],d[a]),e[a]<0)this.contourLevels[a].length>0&&(e[a]=0);else if(e[a]<this.contourLevels[a].length-1){var v=this.contourLevels[a][e[a]],w=this.contourLevels[a][e[a]+1];Math.abs(v-d[a])>Math.abs(w-d[a])&&(e[a]+=1)}for(c=0,b.index[0]=m<.5?g:g+1,b.index[1]=o<.5?h:h+1,b.uv[0]=l/i[0],b.uv[1]=n/i[1];c<3;++c)b.dataCoordinate[c]=this._field[c].get(b.index[0],b.index[1]);return b},b.padField=function(b,c){var a=c.shape.slice(),d=b.shape.slice();n.assign(b.lo(1,1).hi(a[0],a[1]),c),n.assign(b.lo(1).hi(a[0],1),c.hi(a[0],1)),n.assign(b.lo(1,d[1]-1).hi(a[0],1),c.lo(0,a[1]-1).hi(a[0],1)),n.assign(b.lo(0,1).hi(1,a[1]),c.hi(1)),n.assign(b.lo(d[0]-1,1).hi(1,a[1]),c.lo(a[0]-1)),b.set(0,0,c.get(0,0)),b.set(0,d[1]-1,c.get(0,a[1]-1)),b.set(d[0]-1,0,c.get(a[0]-1,0)),b.set(d[0]-1,d[1]-1,c.get(a[0]-1,a[1]-1))},b.update=function(b){b=b||{},this.objectOffset=b.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in b&&(this.contourWidth=K(b.contourWidth,Number)),"showContour"in b&&(this.showContour=K(b.showContour,Boolean)),"showSurface"in b&&(this.showSurface=!!b.showSurface),"contourTint"in b&&(this.contourTint=K(b.contourTint,Boolean)),"contourColor"in b&&(this.contourColor=M(b.contourColor)),"contourProject"in b&&(this.contourProject=K(b.contourProject,function(a){return K(a,Boolean)})),"surfaceProject"in b&&(this.surfaceProject=b.surfaceProject),"dynamicColor"in b&&(this.dynamicColor=M(b.dynamicColor)),"dynamicTint"in b&&(this.dynamicTint=K(b.dynamicTint,Number)),"dynamicWidth"in b&&(this.dynamicWidth=K(b.dynamicWidth,Number)),"opacity"in b&&(this.opacity=b.opacity),"opacityscale"in b&&(this.opacityscale=b.opacityscale),"colorBounds"in b&&(this.colorBounds=b.colorBounds),"vertexColor"in b&&(this.vertexColor=b.vertexColor?1:0),"colormap"in b&&this._colorMap.setPixels(this.genColormap(b.colormap,this.opacityscale));var o=b.field||b.coords&&b.coords[2]||null,L=!1;if(o||(o=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in b||"coords"in b){var X=(o.shape[0]+2)*(o.shape[1]+2);X>this._field[2].data.length&&(l.freeFloat(this._field[2].data),this._field[2].data=l.mallocFloat(h.nextPow2(X))),this._field[2]=p(this._field[2].data,[o.shape[0]+2,o.shape[1]+2]),this.padField(this._field[2],o),this.shape=o.shape.slice();for(var d=this.shape,a=0;a<2;++a)this._field[2].size>this._field[a].data.length&&(l.freeFloat(this._field[a].data),this._field[a].data=l.mallocFloat(this._field[2].size)),this._field[a]=p(this._field[a].data,[d[0]+2,d[1]+2]);if(b.coords){var P=b.coords;if(!Array.isArray(P)||3!==P.length)throw new Error("gl-surface: invalid coordinates for x/y");for(a=0;a<2;++a){var Y=P[a];for(c=0;c<2;++c)if(Y.shape[c]!==d[c])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[a],Y)}}else if(b.ticks){var Q=b.ticks;if(!Array.isArray(Q)||2!==Q.length)throw new Error("gl-surface: invalid ticks");for(a=0;a<2;++a){var v=Q[a];if((Array.isArray(v)||v.length)&&(v=p(v)),v.shape[0]!==d[a])throw new Error("gl-surface: invalid tick length");var R=p(v.data,d);R.stride[a]=v.stride[0],R.stride[1^a]=0,this.padField(this._field[a],R)}}else{for(a=0;a<2;++a){var Z=[0,0];Z[a]=1,this._field[a]=p(this._field[a].data,[d[0]+2,d[1]+2],Z,0)}this._field[0].set(0,0,0);for(var c=0;c<d[0];++c)this._field[0].set(c+1,0,c);for(this._field[0].set(d[0]+1,0,d[0]-1),this._field[1].set(0,0,0),c=0;c<d[1];++c)this._field[1].set(0,c+1,c);this._field[1].set(0,d[1]+1,d[1]-1)}var N=this._field,r=p(l.mallocFloat(6*N[2].size),[3,d[0]+2,d[1]+2,2]);for(a=0;a<3;++a)u(r.pick(a),N[a],"mirror");var w=p(l.mallocFloat(3*N[2].size),[d[0]+2,d[1]+2,3]);for(a=0;a<d[0]+2;++a)for(c=0;c<d[1]+2;++c){var $=r.get(0,a,c,0),_=r.get(0,a,c,1),aa=r.get(1,a,c,0),ab=r.get(1,a,c,1),ac=r.get(2,a,c,0),ad=r.get(2,a,c,1),x=aa*ad-ab*ac,y=ac*_-ad*$,A=$*ab-_*aa,m=Math.sqrt(x*x+y*y+A*A);m<1e-8?(m=Math.max(Math.abs(x),Math.abs(y),Math.abs(A)))<1e-8?(A=1,y=x=0,m=1):m=1/m:m=1/Math.sqrt(m),w.set(a,c,0,x*m),w.set(a,c,1,y*m),w.set(a,c,2,A*m)}l.free(r.data);var B=[1/0,1/0,1/0],C=[-1/0,-1/0,-1/0],D=1/0,F=-1/0,ap=(d[0]-1)*(d[1]-1)*6,e=l.mallocFloat(h.nextPow2(10*ap)),i=0,G=0;for(a=0;a<d[0]-1;++a)j_loop:for(c=0;c<d[1]-1;++c){for(var s=0;s<2;++s)for(var t=0;t<2;++t)for(var f=0;f<3;++f){var n=this._field[f].get(1+a+s,1+c+t);if(isNaN(n)||!isFinite(n))continue j_loop}for(f=0;f<6;++f){var j=a+z[f][0],k=c+z[f][1],S=this._field[0].get(j+1,k+1),T=this._field[1].get(j+1,k+1);n=this._field[2].get(j+1,k+1),x=w.get(j+1,k+1,0),y=w.get(j+1,k+1,1),A=w.get(j+1,k+1,2),b.intensity&&(U=b.intensity.get(j,k));var U=b.intensity?b.intensity.get(j,k):n+this.objectOffset[2];e[i++]=j,e[i++]=k,e[i++]=S,e[i++]=T,e[i++]=n,e[i++]=0,e[i++]=U,e[i++]=x,e[i++]=y,e[i++]=A,B[0]=Math.min(B[0],S+this.objectOffset[0]),B[1]=Math.min(B[1],T+this.objectOffset[1]),B[2]=Math.min(B[2],n+this.objectOffset[2]),D=Math.min(D,U),C[0]=Math.max(C[0],S+this.objectOffset[0]),C[1]=Math.max(C[1],T+this.objectOffset[1]),C[2]=Math.max(C[2],n+this.objectOffset[2]),F=Math.max(F,U),G+=1}}for(b.intensityBounds&&(D=+b.intensityBounds[0],F=+b.intensityBounds[1]),a=6;a<i;a+=10)e[a]=(e[a]-D)/(F-D);this._vertexCount=G,this._coordinateBuffer.update(e.subarray(0,i)),l.freeFloat(e),l.free(w.data),this.bounds=[B,C],this.intensity=b.intensity||this._field[2],(this.intensityBounds[0]!==D||this.intensityBounds[1]!==F)&&(L=!0),this.intensityBounds=[D,F]}if("levels"in b){var g=b.levels;for(a=0,g=Array.isArray(g[0])?g.slice():[[],[],g];a<3;++a)g[a]=g[a].slice(),g[a].sort(function(a,b){return a-b});for(a=0;a<3;++a)for(c=0;c<g[a].length;++c)g[a][c]-=this.objectOffset[a];change_test:for(a=0;a<3;++a){if(g[a].length!==this.contourLevels[a].length){L=!0;break}for(c=0;c<g[a].length;++c)if(g[a][c]!==this.contourLevels[a][c]){L=!0;break change_test}}this.contourLevels=g}if(L){N=this._field,d=this.shape;for(var H=[],E=0;E<3;++E){var ae=this.contourLevels[E],af=[],ag=[],J=[0,0,0];for(a=0;a<ae.length;++a){var V=q(this._field[E],ae[a]);af.push(H.length/5|0),G=0;edge_loop:for(c=0;c<V.cells.length;++c){var aq=V.cells[c];for(f=0;f<2;++f){var O=V.positions[aq[f]],ah=O[0],ai=0|Math.floor(ah),aj=ah-ai,ak=O[1],al=0|Math.floor(ak),am=ak-al,an=!1;axis_loop:for(var I=0;I<3;++I){J[I]=0;var ar=(E+I+1)%3;for(s=0;s<2;++s){var as=s?aj:1-aj;for(t=0,j=0|Math.min(Math.max(ai+s,0),d[0]);t<2;++t){var at=t?am:1-am;if(k=0|Math.min(Math.max(al+t,0),d[1]),!isFinite(n=I<2?this._field[ar].get(j,k):(this.intensity.get(j,k)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]))||isNaN(n)){an=!0;break axis_loop}var au=as*at;J[I]+=au*n}}}if(an){if(f>0){for(var ao=0;ao<5;++ao)H.pop();G-=1}continue edge_loop}H.push(J[0],J[1],O[0],O[1],J[2]),G+=1}}ag.push(G)}this._contourOffsets[E]=af,this._contourCounts[E]=ag}var W=l.mallocFloat(H.length);for(a=0;a<H.length;++a)W[a]=H[a];this._contourBuffer.update(W),l.freeFloat(W)}},b.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var a=0;a<3;++a)l.freeFloat(this._field[a].data)},b.highlight=function(e){if(!e){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(f=0;f<3;++f)this.enableHighlight[f]?this.highlightLevel[f]=e.level[f]:this.highlightLevel[f]=-1;for(f=0,r=this.snapToData?e.dataCoordinate:e.position;f<3;++f)r[f]-=this.objectOffset[f];if(this.enableDynamic[0]&&r[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&r[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&r[2]!==this.dynamicLevel[2]){for(var f,r,b=0,g=this.shape,h=l.mallocFloat(12*g[0]*g[1]),a=0;a<3;++a){if(!this.enableDynamic[a]){this.dynamicLevel[a]=NaN,this._dynamicCounts[a]=0;continue}this.dynamicLevel[a]=r[a];var F=(a+1)%3,G=(a+2)%3,H=this._field[a],i=this._field[F],j=this._field[G],s=q(H,r[a]),t=s.cells,I=s.positions;for(f=0,this._dynamicOffsets[a]=b;f<t.length;++f)for(var J=t[f],k=0;k<2;++k){var u=I[J[k]],v=+u[0],c=0|v,m=0|Math.min(c+1,g[0]),o=v-c,w=1-o,x=+u[1],d=0|x,n=0|Math.min(d+1,g[1]),p=x-d,y=1-p,z=w*y,A=w*p,B=o*y,C=o*p,D=z*i.get(c,d)+A*i.get(c,n)+B*i.get(m,d)+C*i.get(m,n),E=z*j.get(c,d)+A*j.get(c,n)+B*j.get(m,d)+C*j.get(m,n);if(isNaN(D)||isNaN(E)){k&&(b-=1);break}h[2*b+0]=D,h[2*b+1]=E,b+=1}this._dynamicCounts[a]=b-this._dynamicOffsets[a]}this._dynamicBuffer.update(h.subarray(0,2*b)),l.freeFloat(h)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(b,c,e){"use strict";var f=b("ndarray"),g=b("ndarray-ops"),h=b("typedarray-pool");c.exports=function(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(!i){var a;i=[(a=b).LINEAR,a.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_NEAREST,a.LINEAR_MIPMAP_NEAREST],j=[a.NEAREST,a.LINEAR,a.NEAREST_MIPMAP_NEAREST,a.NEAREST_MIPMAP_LINEAR,a.LINEAR_MIPMAP_NEAREST,a.LINEAR_MIPMAP_LINEAR],k=[a.REPEAT,a.CLAMP_TO_EDGE,a.MIRRORED_REPEAT]}if("number"==typeof arguments[1])return q(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return q(b,0|arguments[1][0],0|arguments[1][1],arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var e,s,t,u,n,r,v,c=arguments[1],w=l(c)?c:c.raw;if(w)return e=b,s=w,t=0|c.width,u=0|c.height,n=arguments[2]||b.RGBA,r=arguments[3]||b.UNSIGNED_BYTE,v=p(e),e.texImage2D(e.TEXTURE_2D,0,n,n,r,s),new d(e,v,t,u,n,r);if(c.shape&&c.data&&c.stride)return function(b,c){var n,q,i=c.dtype,a=c.shape.slice(),r=b.getParameter(b.MAX_TEXTURE_SIZE);if(a[0]<0||a[0]>r||a[1]<0||a[1]>r)throw new Error("gl-texture2d: Invalid texture size");var k=o(a,c.stride.slice()),e=0;"float32"===i?e=b.FLOAT:"float64"===i?(e=b.FLOAT,k=!1,i="float32"):"uint8"===i?e=b.UNSIGNED_BYTE:(e=b.UNSIGNED_BYTE,k=!1,i="uint8");var j=0;if(2===a.length)j=b.LUMINANCE,a=[a[0],a[1],1],c=f(c.data,a,[c.stride[0],c.stride[1],1],c.offset);else if(3===a.length)if(1===a[2])j=b.ALPHA;else if(2===a[2])j=b.LUMINANCE_ALPHA;else if(3===a[2])j=b.RGB;else if(4===a[2])j=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");e!==b.FLOAT||b.getExtension("OES_texture_float")||(e=b.UNSIGNED_BYTE,k=!1);var l=c.size;if(k)n=0===c.offset&&c.data.length===l?c.data:c.data.subarray(c.offset,c.offset+l);else{var t=[a[2],a[2]*a[0],1],s=f(q=h.malloc(l,i),a,t,0);("float32"===i||"float64"===i)&&e===b.UNSIGNED_BYTE?m(s,c):g.assign(s,c),n=q.subarray(0,l)}var u=p(b);return b.texImage2D(b.TEXTURE_2D,0,j,a[0],a[1],0,j,e,n),k||h.free(q),new d(b,u,a[0],a[1],j,e)}(b,c)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var i=null,j=null,k=null;function l(a){return"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&a instanceof ImageData}var m=function(a,b){g.muls(a,b,255)};function n(a,b,c){var d=a.gl,e=d.getParameter(d.MAX_TEXTURE_SIZE);if(b<0||b>e||c<0||c>e)throw new Error("gl-texture2d: Invalid texture size");return a._shape=[b,c],a.bind(),d.texImage2D(d.TEXTURE_2D,0,a.format,b,c,0,a.format,a.type,null),a._mipLevels=[0],a}function d(a,d,e,f,g,h){this.gl=a,this.handle=d,this.format=g,this.type=h,this._shape=[e,f],this._mipLevels=[0],this._magFilter=a.NEAREST,this._minFilter=a.NEAREST,this._wrapS=a.CLAMP_TO_EDGE,this._wrapT=a.CLAMP_TO_EDGE,this._anisoSamples=1;var i=this,b=[this._wrapS,this._wrapT];Object.defineProperties(b,[{get:function(){return i._wrapS},set:function(a){return i.wrapS=a}},{get:function(){return i._wrapT},set:function(a){return i.wrapT=a}}]),this._wrapVector=b;var c=[this._shape[0],this._shape[1]];Object.defineProperties(c,[{get:function(){return i._shape[0]},set:function(a){return i.width=a}},{get:function(){return i._shape[1]},set:function(a){return i.height=a}}]),this._shapeVector=c}var a=d.prototype;function o(a,b){return 3===a.length?1===b[2]&&b[1]===a[0]*a[2]&&b[0]===a[2]:1===b[0]&&b[1]===a[0]}function p(a){var b=a.createTexture();return a.bindTexture(a.TEXTURE_2D,b),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),b}function q(a,b,c,e,f){var g=a.getParameter(a.MAX_TEXTURE_SIZE);if(b<0||b>g||c<0||c>g)throw new Error("gl-texture2d: Invalid texture shape");if(f===a.FLOAT&&!a.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var h=p(a);return a.texImage2D(a.TEXTURE_2D,0,e,b,c,0,e,f,null),new d(a,h,b,c,e,f)}Object.defineProperties(a,{minFilter:{get:function(){return this._minFilter},set:function(a){this.bind();var b=this.gl;if(this.type===b.FLOAT&&i.indexOf(a)>=0&&(b.getExtension("OES_texture_float_linear")||(a=b.NEAREST)),0>j.indexOf(a))throw new Error("gl-texture2d: Unknown filter mode "+a);return b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a),this._minFilter=a}},magFilter:{get:function(){return this._magFilter},set:function(a){this.bind();var b=this.gl;if(this.type===b.FLOAT&&i.indexOf(a)>=0&&(b.getExtension("OES_texture_float_linear")||(a=b.NEAREST)),0>j.indexOf(a))throw new Error("gl-texture2d: Unknown filter mode "+a);return b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a),this._magFilter=a}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var c=this._anisoSamples;if(this._anisoSamples=0|Math.max(b,1),c!==this._anisoSamples){var a=this.gl.getExtension("EXT_texture_filter_anisotropic");a&&this.gl.texParameterf(this.gl.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(a){if(this.bind(),0>k.indexOf(a))throw new Error("gl-texture2d: Unknown wrap mode "+a);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,a),this._wrapS=a}},wrapT:{get:function(){return this._wrapT},set:function(a){if(this.bind(),0>k.indexOf(a))throw new Error("gl-texture2d: Unknown wrap mode "+a);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,a),this._wrapT=a}},wrap:{get:function(){return this._wrapVector},set:function(a){if(Array.isArray(a)||(a=[a,a]),2!==a.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var c=0;c<2;++c)if(0>k.indexOf(a[c]))throw new Error("gl-texture2d: Unknown wrap mode "+a);this._wrapS=a[0],this._wrapT=a[1];var b=this.gl;return this.bind(),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,this._wrapS),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,this._wrapT),a}},shape:{get:function(){return this._shapeVector},set:function(a){if(Array.isArray(a)){if(2!==a.length)throw new Error("gl-texture2d: Invalid texture shape")}else a=[0|a,0|a];return n(this,0|a[0],0|a[1]),[0|a[0],0|a[1]]}},width:{get:function(){return this._shape[0]},set:function(a){return n(this,a|=0,this._shape[1]),a}},height:{get:function(){return this._shape[1]},set:function(a){return a|=0,n(this,this._shape[0],a),a}}}),a.bind=function(b){var a=this.gl;return(void 0!==b&&a.activeTexture(a.TEXTURE0+(0|b)),a.bindTexture(a.TEXTURE_2D,this.handle),void 0!==b)?0|b:a.getParameter(a.ACTIVE_TEXTURE)-a.TEXTURE0},a.dispose=function(){this.gl.deleteTexture(this.handle)},a.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),a=0;b>0;++a,b>>>=1)0>this._mipLevels.indexOf(a)&&this._mipLevels.push(a)},a.setPixels=function(a,b,d,c){var e=this.gl;this.bind(),Array.isArray(b)?(c=d,d=0|b[1],b=0|b[0]):(b=b||0,d=d||0),c=c||0;var i=l(a)?a:a.raw;if(i)0>this._mipLevels.indexOf(c)?(e.texImage2D(e.TEXTURE_2D,0,this.format,this.format,this.type,i),this._mipLevels.push(c)):e.texSubImage2D(e.TEXTURE_2D,c,b,d,this.format,this.type,i);else if(a.shape&&a.stride&&a.data){if(a.shape.length<2||b+a.shape[1]>this._shape[1]>>>c||d+a.shape[0]>this._shape[0]>>>c||b<0||d<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(b,r,s,j,d,e,u,c){var n=c.dtype,a=c.shape.slice();if(a.length<2||a.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var l=0,i=0,t=o(a,c.stride.slice());if("float32"===n?l=b.FLOAT:"float64"===n?(l=b.FLOAT,t=!1,n="float32"):"uint8"===n?l=b.UNSIGNED_BYTE:(l=b.UNSIGNED_BYTE,t=!1,n="uint8"),2===a.length)i=b.LUMINANCE,a=[a[0],a[1],1],c=f(c.data,a,[c.stride[0],c.stride[1],1],c.offset);else if(3===a.length){if(1===a[2])i=b.ALPHA;else if(2===a[2])i=b.LUMINANCE_ALPHA;else if(3===a[2])i=b.RGB;else if(4===a[2])i=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");a[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((i===b.LUMINANCE||i===b.ALPHA)&&(d===b.LUMINANCE||d===b.ALPHA)&&(i=d),i!==d)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var k=c.size,q=0>u.indexOf(j);if(q&&u.push(j),l===e&&t)0===c.offset&&c.data.length===k?q?b.texImage2D(b.TEXTURE_2D,j,d,a[0],a[1],0,d,e,c.data):b.texSubImage2D(b.TEXTURE_2D,j,r,s,a[0],a[1],d,e,c.data):q?b.texImage2D(b.TEXTURE_2D,j,d,a[0],a[1],0,d,e,c.data.subarray(c.offset,c.offset+k)):b.texSubImage2D(b.TEXTURE_2D,j,r,s,a[0],a[1],d,e,c.data.subarray(c.offset,c.offset+k));else{var p,v=f(p=e===b.FLOAT?h.mallocFloat32(k):h.mallocUint8(k),a,[a[2],a[2]*a[0],1]);l===b.FLOAT&&e===b.UNSIGNED_BYTE?m(v,c):g.assign(v,c),q?b.texImage2D(b.TEXTURE_2D,j,d,a[0],a[1],0,d,e,p.subarray(0,k)):b.texSubImage2D(b.TEXTURE_2D,j,r,s,a[0],a[1],d,e,p.subarray(0,k)),e===b.FLOAT?h.freeFloat32(p):h.freeUint8(p)}})(e,b,d,c,this.format,this.type,this._mipLevels,a)}else throw new Error("gl-texture2d: Unsupported data type")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(b,a,c){"use strict";a.exports=function(c,f,d){f?f.bind():c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,null);var e=0|c.getParameter(c.MAX_VERTEX_ATTRIBS);if(d){if(d.length>e)throw new Error("gl-vao: Too many vertex attributes");for(var b=0;b<d.length;++b){var a=d[b];if(a.buffer){var g=a.buffer,h=a.size||4,i=a.type||c.FLOAT,j=!!a.normalized,k=a.stride||0,l=a.offset||0;g.bind(),c.enableVertexAttribArray(b),c.vertexAttribPointer(b,h,i,j,k,l)}else{if("number"==typeof a)c.vertexAttrib1f(b,a);else if(1===a.length)c.vertexAttrib1f(b,a[0]);else if(2===a.length)c.vertexAttrib2f(b,a[0],a[1]);else if(3===a.length)c.vertexAttrib3f(b,a[0],a[1],a[2]);else if(4===a.length)c.vertexAttrib4f(b,a[0],a[1],a[2],a[3]);else throw new Error("gl-vao: Invalid vertex attribute");c.disableVertexAttribArray(b)}}for(;b<e;++b)c.disableVertexAttribArray(b)}else{c.bindBuffer(c.ARRAY_BUFFER,null);for(var b=0;b<e;++b)c.disableVertexAttribArray(b)}}},{}],148:[function(b,c,d){"use strict";var e=b("./do-bind.js");function a(a){this.gl=a,this._elements=null,this._attributes=null,this._elementsType=a.UNSIGNED_SHORT}a.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},a.prototype.update=function(a,b,c){this._elements=b,this._attributes=a,this._elementsType=c||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(b,c,a){a=a||0;var d=this.gl;this._elements?d.drawElements(b,c,this._elementsType,a):d.drawArrays(b,a,c)},c.exports=function(b){return new a(b)}},{"./do-bind.js":147}],149:[function(b,c,e){"use strict";var f=b("./do-bind.js");function d(a,b,c,d,e,f){this.location=a,this.dimension=b,this.a=c,this.b=d,this.c=e,this.d=f}function a(a,b,c){this.gl=a,this._ext=b,this.handle=c,this._attribs=[],this._useElements=!1,this._elementsType=a.UNSIGNED_SHORT}d.prototype.bind=function(a){switch(this.dimension){case 1:a.vertexAttrib1f(this.location,this.a);break;case 2:a.vertexAttrib2f(this.location,this.a,this.b);break;case 3:a.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:a.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}},a.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var a=0;a<this._attribs.length;++a)this._attribs[a].bind(this.gl)},a.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},a.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},a.prototype.update=function(c,e,g){if(this.bind(),f(this.gl,e,c),this.unbind(),this._attribs.length=0,c)for(var b=0;b<c.length;++b){var a=c[b];"number"==typeof a?this._attribs.push(new d(b,1,a)):Array.isArray(a)&&this._attribs.push(new d(b,a.length,a[0],a[1],a[2],a[3]))}this._useElements=!!e,this._elementsType=g||this.gl.UNSIGNED_SHORT},a.prototype.draw=function(b,c,a){a=a||0;var d=this.gl;this._useElements?d.drawElements(b,c,this._elementsType,a):d.drawArrays(b,a,c)},c.exports=function(c,b){return new a(c,b,b.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(a,b,c){"use strict";var d=a("./lib/vao-native.js"),e=a("./lib/vao-emulated.js");function f(a){this.bindVertexArrayOES=a.bindVertexArray.bind(a),this.createVertexArrayOES=a.createVertexArray.bind(a),this.deleteVertexArrayOES=a.deleteVertexArray.bind(a)}b.exports=function(a,g,h,i){var b,c=a.createVertexArray?new f(a):a.getExtension("OES_vertex_array_object");return(b=c?d(a,c):e(a)).update(g,h,i),b}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a}},{}],152:[function(a,b,c){b.exports=function(a,b){var c=d(a[0],a[1],a[2]),g=d(b[0],b[1],b[2]);e(c,c),e(g,g);var h=f(c,g);return h>1?0:Math.acos(h)};var d=a("./fromValues"),e=a("./normalize"),f=a("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(b,a,c){a.exports=function(a,b){return a[0]=Math.ceil(b[0]),a[1]=Math.ceil(b[1]),a[2]=Math.ceil(b[2]),a}},{}],154:[function(b,a,c){a.exports=function(b){var a=new Float32Array(3);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}},{}],155:[function(b,a,c){a.exports=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}},{}],156:[function(b,a,c){a.exports=function(){var a=new Float32Array(3);return a[0]=0,a[1]=0,a[2]=0,a}},{}],157:[function(b,a,c){a.exports=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];return a[0]=e*i-f*h,a[1]=f*g-d*i,a[2]=d*h-e*g,a}},{}],158:[function(a,b,c){b.exports=a("./distance")},{"./distance":159}],159:[function(b,a,c){a.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}},{}],160:[function(a,b,c){b.exports=a("./divide")},{"./divide":161}],161:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a}},{}],162:[function(b,a,c){a.exports=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}},{}],163:[function(b,a,c){a.exports=1e-6},{}],164:[function(a,b,c){b.exports=function(a,b){var c=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2];return Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(e-h)<=d*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(f-i)<=d*Math.max(1,Math.abs(f),Math.abs(i))};var d=a("./epsilon")},{"./epsilon":163}],165:[function(b,a,c){a.exports=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}},{}],166:[function(b,a,c){a.exports=function(a,b){return a[0]=Math.floor(b[0]),a[1]=Math.floor(b[1]),a[2]=Math.floor(b[2]),a}},{}],167:[function(a,b,c){b.exports=function(a,c,e,f,h,i){var b,g;for(c||(c=3),e||(e=0),g=f?Math.min(f*c+e,a.length):a.length,b=e;b<g;b+=c)d[0]=a[b],d[1]=a[b+1],d[2]=a[b+2],h(d,d,i),a[b]=d[0],a[b+1]=d[1],a[b+2]=d[2];return a};var d=a("./create")()},{"./create":156}],168:[function(b,a,c){a.exports=function(b,c,d){var a=new Float32Array(3);return a[0]=b,a[1]=c,a[2]=d,a}},{}],169:[function(a,b,c){b.exports={EPSILON:a("./epsilon"),create:a("./create"),clone:a("./clone"),angle:a("./angle"),fromValues:a("./fromValues"),copy:a("./copy"),set:a("./set"),equals:a("./equals"),exactEquals:a("./exactEquals"),add:a("./add"),subtract:a("./subtract"),sub:a("./sub"),multiply:a("./multiply"),mul:a("./mul"),divide:a("./divide"),div:a("./div"),min:a("./min"),max:a("./max"),floor:a("./floor"),ceil:a("./ceil"),round:a("./round"),scale:a("./scale"),scaleAndAdd:a("./scaleAndAdd"),distance:a("./distance"),dist:a("./dist"),squaredDistance:a("./squaredDistance"),sqrDist:a("./sqrDist"),length:a("./length"),len:a("./len"),squaredLength:a("./squaredLength"),sqrLen:a("./sqrLen"),negate:a("./negate"),inverse:a("./inverse"),normalize:a("./normalize"),dot:a("./dot"),cross:a("./cross"),lerp:a("./lerp"),random:a("./random"),transformMat4:a("./transformMat4"),transformMat3:a("./transformMat3"),transformQuat:a("./transformQuat"),rotateX:a("./rotateX"),rotateY:a("./rotateY"),rotateZ:a("./rotateZ"),forEach:a("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(b,a,c){a.exports=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a}},{}],171:[function(a,b,c){b.exports=a("./length")},{"./length":172}],172:[function(b,a,c){a.exports=function(a){var b=a[0],c=a[1],d=a[2];return Math.sqrt(b*b+c*c+d*d)}},{}],173:[function(b,a,c){a.exports=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a}},{}],174:[function(b,a,c){a.exports=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a}},{}],175:[function(b,a,c){a.exports=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a}},{}],176:[function(a,b,c){b.exports=a("./multiply")},{"./multiply":177}],177:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a}},{}],178:[function(b,a,c){a.exports=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a}},{}],179:[function(b,a,c){a.exports=function(c,a){var d=a[0],e=a[1],f=a[2],b=d*d+e*e+f*f;return b>0&&(b=1/Math.sqrt(b),c[0]=a[0]*b,c[1]=a[1]*b,c[2]=a[2]*b),c}},{}],180:[function(b,a,c){a.exports=function(a,b){var d=2*Math.random()*Math.PI,c=2*Math.random()-1,e=Math.sqrt(1-c*c)*(b=b||1);return a[0]=Math.cos(d)*e,a[1]=Math.sin(d)*e,a[2]=c*b,a}},{}],181:[function(b,a,c){a.exports=function(a,b,c,d){var e=c[1],f=c[2],g=b[1]-e,h=b[2]-f,i=Math.sin(d),j=Math.cos(d);return a[0]=b[0],a[1]=e+g*j-h*i,a[2]=f+g*i+h*j,a}},{}],182:[function(b,a,c){a.exports=function(a,b,c,d){var e=c[0],f=c[2],g=b[0]-e,h=b[2]-f,i=Math.sin(d),j=Math.cos(d);return a[0]=e+h*i+g*j,a[1]=b[1],a[2]=f+h*j-g*i,a}},{}],183:[function(b,a,c){a.exports=function(a,b,c,d){var e=c[0],f=c[1],g=b[0]-e,h=b[1]-f,i=Math.sin(d),j=Math.cos(d);return a[0]=e+g*j-h*i,a[1]=f+g*i+h*j,a[2]=b[2],a}},{}],184:[function(b,a,c){a.exports=function(a,b){return a[0]=Math.round(b[0]),a[1]=Math.round(b[1]),a[2]=Math.round(b[2]),a}},{}],185:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a}},{}],186:[function(b,a,c){a.exports=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a}},{}],187:[function(b,a,c){a.exports=function(a,b,c,d){return a[0]=b,a[1]=c,a[2]=d,a}},{}],188:[function(a,b,c){b.exports=a("./squaredDistance")},{"./squaredDistance":190}],189:[function(a,b,c){b.exports=a("./squaredLength")},{"./squaredLength":191}],190:[function(b,a,c){a.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e}},{}],191:[function(b,a,c){a.exports=function(a){var b=a[0],c=a[1],d=a[2];return b*b+c*c+d*d}},{}],192:[function(a,b,c){b.exports=a("./subtract")},{"./subtract":193}],193:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a}},{}],194:[function(b,a,c){a.exports=function(b,c,a){var d=c[0],e=c[1],f=c[2];return b[0]=d*a[0]+e*a[3]+f*a[6],b[1]=d*a[1]+e*a[4]+f*a[7],b[2]=d*a[2]+e*a[5]+f*a[8],b}},{}],195:[function(b,a,c){a.exports=function(c,g,a){var d=g[0],e=g[1],f=g[2],b=a[3]*d+a[7]*e+a[11]*f+a[15];return b=b||1,c[0]=(a[0]*d+a[4]*e+a[8]*f+a[12])/b,c[1]=(a[1]*d+a[5]*e+a[9]*f+a[13])/b,c[2]=(a[2]*d+a[6]*e+a[10]*f+a[14])/b,c}},{}],196:[function(b,a,c){a.exports=function(e,j,f){var g=j[0],h=j[1],i=j[2],a=f[0],b=f[1],c=f[2],d=f[3],k=d*g+b*i-c*h,l=d*h+c*g-a*i,m=d*i+a*h-b*g,n=-a*g-b*h-c*i;return e[0]=k*d+ -(n*a)+ -(l*c)- -(m*b),e[1]=l*d+ -(n*b)+ -(m*a)- -(k*c),e[2]=m*d+ -(n*c)+ -(k*b)- -(l*a),e}},{}],197:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a}},{}],198:[function(b,a,c){a.exports=function(b){var a=new Float32Array(4);return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a}},{}],199:[function(b,a,c){a.exports=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a}},{}],200:[function(b,a,c){a.exports=function(){var a=new Float32Array(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}},{}],201:[function(b,a,c){a.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)}},{}],202:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a[3]=b[3]/c[3],a}},{}],203:[function(b,a,c){a.exports=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}},{}],204:[function(b,a,c){a.exports=function(b,c,d,e){var a=new Float32Array(4);return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a}},{}],205:[function(a,b,c){b.exports={create:a("./create"),clone:a("./clone"),fromValues:a("./fromValues"),copy:a("./copy"),set:a("./set"),add:a("./add"),subtract:a("./subtract"),multiply:a("./multiply"),divide:a("./divide"),min:a("./min"),max:a("./max"),scale:a("./scale"),scaleAndAdd:a("./scaleAndAdd"),distance:a("./distance"),squaredDistance:a("./squaredDistance"),length:a("./length"),squaredLength:a("./squaredLength"),negate:a("./negate"),inverse:a("./inverse"),normalize:a("./normalize"),dot:a("./dot"),lerp:a("./lerp"),random:a("./random"),transformMat4:a("./transformMat4"),transformQuat:a("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(b,a,c){a.exports=function(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a[3]=1/b[3],a}},{}],207:[function(b,a,c){a.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)}},{}],208:[function(b,a,c){a.exports=function(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a[3]=h+d*(c[3]-h),a}},{}],209:[function(b,a,c){a.exports=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a[3]=Math.max(b[3],c[3]),a}},{}],210:[function(b,a,c){a.exports=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a[3]=Math.min(b[3],c[3]),a}},{}],211:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a[3]=b[3]*c[3],a}},{}],212:[function(b,a,c){a.exports=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a}},{}],213:[function(b,a,c){a.exports=function(b,c){var d=c[0],e=c[1],f=c[2],g=c[3],a=d*d+e*e+f*f+g*g;return a>0&&(a=1/Math.sqrt(a),b[0]=d*a,b[1]=e*a,b[2]=f*a,b[3]=g*a),b}},{}],214:[function(a,b,c){var d=a("./normalize"),e=a("./scale");b.exports=function(a,b){return b=b||1,a[0]=Math.random(),a[1]=Math.random(),a[2]=Math.random(),a[3]=Math.random(),d(a,a),e(a,a,b),a}},{"./normalize":213,"./scale":215}],215:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a}},{}],216:[function(b,a,c){a.exports=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a[3]=b[3]+c[3]*d,a}},{}],217:[function(b,a,c){a.exports=function(a,b,c,d,e){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a}},{}],218:[function(b,a,c){a.exports=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f}},{}],219:[function(b,a,c){a.exports=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b*b+c*c+d*d+e*e}},{}],220:[function(b,a,c){a.exports=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a}},{}],221:[function(b,a,c){a.exports=function(b,c,a){var d=c[0],e=c[1],f=c[2],g=c[3];return b[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*g,b[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*g,b[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*g,b[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*g,b}},{}],222:[function(b,a,c){a.exports=function(e,f,g){var h=f[0],i=f[1],j=f[2],a=g[0],b=g[1],c=g[2],d=g[3],k=d*h+b*j-c*i,l=d*i+c*h-a*j,m=d*j+a*i-b*h,n=-a*h-b*i-c*j;return e[0]=k*d+ -(n*a)+ -(l*c)- -(m*b),e[1]=l*d+ -(n*b)+ -(m*a)- -(k*c),e[2]=m*d+ -(n*c)+ -(k*b)- -(l*a),e[3]=f[3],e}},{}],223:[function(a,b,c){var d=a("glsl-tokenizer"),e=a("atob-lite");b.exports=function(b){for(var f=Array.isArray(b)?b:d(b),c=0;c<f.length;c++){var g=f[c];if("preprocessor"===g.type){var a=g.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(a&&a[2]){var i=a[1],h=a[2];return(i?e(h):h).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(a,b,c){b.exports=function(j){var m,n,o,a=0,p=0,q=999,r=[],s=[],t=1,u=0,v=0,w=!1,x=!1,y="",b=f,c=d;"300 es"===(j=j||{}).version&&(b=h,c=g);for(var k={},l={},a=0;a<b.length;a++)k[b[a]]=!0;for(var a=0;a<c.length;a++)l[c[a]]=!0;return function(a){return(s=[],null!==a)?A(a):B()};function z(a){a.length&&s.push({type:i[q],data:a,position:v,line:t,column:u})}function A(b){var c;for(a=0,b.toString&&(b=b.toString()),y+=b.replace(/\r\n/g,"\n"),o=y.length;m=y[a],a<o;){switch(c=a,q){case 0:a=G();break;case 1:a=F();break;case 2:a=E();break;case 3:a=H();break;case 4:a=K();break;case 11:a=J();break;case 5:a=L();break;case 9999:a=M();break;case 9:a=D();break;case 999:a=C();break}if(c!==a)switch(y[c]){case"\n":u=0,++t;break;default:++u;break}}return p+=a,y=y.slice(a),s}function B(a){return r.length&&z(r.join("")),q=10,z("(eof)"),s}function C(){return(r=r.length?[]:r,"/"===n&&"*"===m)?(v=p+a-1,q=0,n=m,a+1):"/"===n&&"/"===m?(v=p+a-1,q=1,n=m,a+1):"#"===m?(q=2,v=p+a,a):/\s/.test(m)?(q=9,v=p+a,a):(w=/\d/.test(m),x=/[^\w_]/.test(m),v=p+a,q=w?4:x?3:9999,a)}function D(){return/[^\s]/g.test(m)?(z(r.join("")),q=999,a):(r.push(m),n=m,a+1)}function E(){return("\r"===m||"\n"===m)&&"\\"!==n?(z(r.join("")),q=999,a):(r.push(m),n=m,a+1)}function F(){return E()}function G(){return"/"===m&&"*"===n?(r.push(m),z(r.join("")),q=999,a+1):(r.push(m),n=m,a+1)}function H(){if("."===n&&/\d/.test(m))return q=5,a;if("/"===n&&"*"===m)return q=0,a;if("/"===n&&"/"===m)return q=1,a;if("."===m&&r.length){for(;I(r););return q=5,a}if(";"===m||")"===m||"("===m){if(r.length)for(;I(r););return z(m),q=999,a+1}var b=2===r.length&&"="!==m;if(/[\w_\d\s]/.test(m)||b){for(;I(r););return q=999,a}return r.push(m),n=m,a+1}function I(b){for(var c,a,d=0;;){if(c=e.indexOf(b.slice(0,b.length+d).join("")),a=e[c],-1===c){if((d--)+b.length>0)continue;a=b.slice(0,1).join("")}return z(a),v+=a.length,(r=r.slice(a.length)).length}}function J(){return/[^a-fA-F0-9]/.test(m)?(z(r.join("")),q=999,a):(r.push(m),n=m,a+1)}function K(){return"."===m?(r.push(m),q=5,n=m,a+1):/[eE]/.test(m)?(r.push(m),q=5,n=m,a+1):"x"===m&&1===r.length&&"0"===r[0]?(q=11,r.push(m),n=m,a+1):/[^\d]/.test(m)?(z(r.join("")),q=999,a):(r.push(m),n=m,a+1)}function L(){return("f"===m&&(r.push(m),n=m,a+=1),/[eE]/.test(m))?(r.push(m),n=m,a+1):("-"===m||"+"===m)&&/[eE]/.test(n)?(r.push(m),n=m,a+1):/[^\d]/.test(m)?(z(r.join("")),q=999,a):(r.push(m),n=m,a+1)}function M(){if(/[^\d\w_]/.test(m)){var b=r.join("");return q=l[b]?8:k[b]?7:6,z(r.join("")),q=999,a}return r.push(m),n=m,a+1}};var d=a("./lib/literals"),e=a("./lib/operators"),f=a("./lib/builtins"),g=a("./lib/literals-300es"),h=a("./lib/builtins-300es"),i=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(b,c,d){var a=b("./builtins");a=a.slice().filter(function(a){return!/^(gl\_|texture)/.test(a)}),c.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(b,a,c){a.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(a,b,d){var c=a("./literals");b.exports=c.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(b,a,c){a.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(b,a,c){a.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(a,b,c){var d=a("./index");b.exports=function(c,e){var b=d(e),a=[];return a=(a=a.concat(b(c))).concat(b(null))}},{"./index":224}],231:[function(b,a,c){a.exports=function(a){"string"==typeof a&&(a=[a]);for(var d=[].slice.call(arguments,1),c=[],b=0;b<a.length-1;b++)c.push(a[b],d[b]||"");return c.push(a[b]),c.join("")}},{}],232:[function(a,b,d){"use strict";var c=a("is-browser");b.exports=c&&function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b),window.removeEventListener("test",null,b)}catch(c){a=!1}return a}()},{"is-browser":236}],233:[function(b,c,f){"use strict";c.exports=function(j,u){var l=j.length;if(0===l)throw new Error("Must have at least d+1 points");var b=j[0].length;if(l<=b)throw new Error("Must input at least d+1 points");var o=j.slice(0,b+1),p=g.apply(void 0,o);if(0===p)throw new Error("Input not in general position");for(var h=new Array(b+1),a=0;a<=b;++a)h[a]=a;p<0&&(h[0]=1,h[1]=0);for(var m=new d(h,new Array(b+1),!1),i=m.adjacent,n=new Array(b+2),a=0;a<=b;++a){for(var f=h.slice(),c=0;c<=b;++c)c===a&&(f[c]=-1);var v=f[0];f[0]=f[1],f[1]=v;var q=new d(f,new Array(b+1),!0);i[a]=q,n[a]=q}n[b+1]=m;for(var a=0;a<=b;++a)for(var f=i[a].vertices,r=i[a].adjacent,c=0;c<=b;++c){var s=f[c];if(s<0){r[c]=m;continue}for(var k=0;k<=b;++k)0>i[k].vertices.indexOf(s)&&(r[c]=i[k])}for(var t=new e(b,o,n),w=!!u,a=b+1;a<l;++a)t.insert(j[a],w);return t.boundary()};var g=b("robust-orientation"),h=b("simplicial-complex").compareCells;function d(a,b,c){this.vertices=a,this.adjacent=b,this.boundary=c,this.lastVisited=-1}function i(a,b,c){this.vertices=a,this.cell=b,this.index=c}function j(a,b){return h(a.vertices,b.vertices)}d.prototype.flip=function(){var a=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=a;var b=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=b};var k=[];function e(a,f,e){this.dimension=a,this.vertices=f,this.simplices=e,this.interior=e.filter(function(a){return!a.boundary}),this.tuple=new Array(a+1);for(var c,h,b=0;b<=a;++b)this.tuple[b]=this.vertices[b];var d=k[a];d||(d=k[a]=((c=g[a+1])||(c=g),h=c,function(){var a=this.tuple;return h.apply(this,a)})),this.orient=d}var a=e.prototype;a.handleBoundaryDegeneracy=function(c,k){var g=this.dimension,d=this.vertices.length-1,h=this.tuple,l=this.vertices,e=[c];for(c.lastVisited=-d;e.length>0;)for(var m=(c=e.pop()).adjacent,f=0;f<=g;++f){var a=m[f];if(a.boundary&&!(a.lastVisited<= -d)){for(var n=a.vertices,b=0;b<=g;++b){var i=n[b];i<0?h[b]=k:h[b]=l[i]}var j=this.orient();if(j>0)return a;a.lastVisited=-d,0===j&&e.push(a)}}return null},a.walk=function(g,h){var d=this.vertices.length-1,f=this.dimension,i=this.vertices,e=this.tuple,j=h?this.interior.length*Math.random()|0:this.interior.length-1,b=this.interior[j];outerLoop:for(;!b.boundary;){for(var k=b.vertices,l=b.adjacent,a=0;a<=f;++a)e[a]=i[k[a]];b.lastVisited=d;for(var a=0;a<=f;++a){var c=l[a];if(!(c.lastVisited>=d)){var m=e[a];e[a]=g;var n=this.orient();if(e[a]=m,n<0){b=c;continue outerLoop}c.boundary?c.lastVisited=-d:c.lastVisited=d}}return}return b},a.addPeaks=function(D,c){var f=this.vertices.length-1,g=this.dimension,E=this.vertices,u=this.tuple,v=this.interior,F=this.simplices,p=[c];c.lastVisited=f,c.vertices[c.vertices.indexOf(-1)]=f,c.boundary=!1,v.push(c);for(var h=[];p.length>0;){var c=p.pop(),w=c.vertices,q=c.adjacent,r=w.indexOf(f);if(!(r<0)){for(var b=0;b<=g;++b)if(b!==r){var e=q[b];if(e.boundary&&!(e.lastVisited>=f)){var s=e.vertices;if(e.lastVisited!== -f){for(var x=0,a=0;a<=g;++a)s[a]<0?(x=a,u[a]=D):u[a]=E[s[a]];if(this.orient()>0){s[x]=f,e.boundary=!1,v.push(e),p.push(e),e.lastVisited=f;continue}e.lastVisited=-f}var y=e.adjacent,l=w.slice(),t=q.slice(),k=new d(l,t,!0);F.push(k);var z=y.indexOf(c);if(!(z<0)){y[z]=k,t[r]=e,l[b]=-1,t[b]=c,q[b]=k,k.flip();for(var a=0;a<=g;++a){var A=l[a];if(!(A<0)&&A!==f){for(var B=new Array(g-1),G=0,m=0;m<=g;++m){var C=l[m];C<0||m===a||(B[G++]=C)}h.push(new i(B,k,a))}}}}}}}h.sort(j);for(var b=0;b+1<h.length;b+=2){var n=h[b],o=h[b+1],H=n.index,I=o.index;H<0||I<0||(n.cell.adjacent[n.index]=o.cell,o.cell.adjacent[o.index]=n.cell)}},a.insert=function(a,h){var e=this.vertices;e.push(a);var b=this.walk(a,h);if(b){for(var i=this.dimension,d=this.tuple,c=0;c<=i;++c){var f=b.vertices[c];f<0?d[c]=a:d[c]=e[f]}var g=this.orient(d);!(g<0)&&(0!==g||(b=this.handleBoundaryDegeneracy(b,a)))&&this.addPeaks(a,b)}},a.boundary=function(){for(var c=this.dimension,e=[],f=this.simplices,j=f.length,d=0;d<j;++d){var g=f[d];if(g.boundary){for(var a=new Array(c),h=g.vertices,k=0,i=0,b=0;b<=c;++b)h[b]>=0?a[k++]=h[b]:i=1&b;if(i===(1&c)){var l=a[0];a[0]=a[1],a[1]=l}e.push(a)}}return e}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(c,d,g){"use strict";var h=c("binary-search-bounds");function e(d,a,b,c,e){this.mid=d,this.left=a,this.right=b,this.leftPoints=c,this.rightPoints=e,this.count=(a?a.count:0)+(b?b.count:0)+c.length}d.exports=function(a){return new f(a&&0!==a.length?s(a):null)};var b=e.prototype;function i(a,b){a.mid=b.mid,a.left=b.left,a.right=b.right,a.leftPoints=b.leftPoints,a.rightPoints=b.rightPoints,a.count=b.count}function j(a,c){var b=s(c);a.mid=b.mid,a.left=b.left,a.right=b.right,a.leftPoints=b.leftPoints,a.rightPoints=b.rightPoints,a.count=b.count}function k(a,c){var b=a.intervals([]);b.push(c),j(a,b)}function l(b,d){var a=b.intervals([]),c=a.indexOf(d);return c<0?0:(a.splice(c,1),j(b,a),1)}function m(b,d,e){for(var a=0;a<b.length&&b[a][0]<=d;++a){var c=e(b[a]);if(c)return c}}function n(b,d,e){for(var a=b.length-1;a>=0&&b[a][1]>=d;--a){var c=e(b[a]);if(c)return c}}function o(b,d){for(var a=0;a<b.length;++a){var c=d(b[a]);if(c)return c}}function p(a,b){return a-b}function q(a,b){return a[0]-b[0]||a[1]-b[1]}function r(a,b){return a[1]-b[1]||a[0]-b[0]}function s(b){if(0===b.length)return null;for(var d=[],a=0;a<b.length;++a)d.push(b[a][0],b[a][1]);d.sort(p);for(var f=d[d.length>>1],h=[],i=[],g=[],a=0;a<b.length;++a){var c=b[a];c[1]<f?h.push(c):f<c[0]?i.push(c):g.push(c)}var j=g,k=g.slice();return j.sort(q),k.sort(r),new e(f,s(h),s(i),j,k)}function f(a){this.root=a}b.intervals=function(a){return a.push.apply(a,this.leftPoints),this.left&&this.left.intervals(a),this.right&&this.right.intervals(a),a},b.insert=function(a){var b=this.count-this.leftPoints.length;if(this.count+=1,a[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?k(this,a):this.left.insert(a):this.left=s([a]);else if(a[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?k(this,a):this.right.insert(a):this.right=s([a]);else{var c=h.ge(this.leftPoints,a,q),d=h.ge(this.rightPoints,a,r);this.leftPoints.splice(c,0,a),this.rightPoints.splice(d,0,a)}},b.remove=function(b){var f=this.count-this.leftPoints;if(b[1]<this.mid){if(!this.left)return 0;if(4*(this.right?this.right.count:0)>3*(f-1))return l(this,b);var a=this.left.remove(b);return 2===a?(this.left=null,this.count-=1,1):(1===a&&(this.count-=1),a)}if(b[0]>this.mid){if(!this.right)return 0;if(4*(this.left?this.left.count:0)>3*(f-1))return l(this,b);var a=this.right.remove(b);return 2===a?(this.right=null,this.count-=1,1):(1===a&&(this.count-=1),a)}if(1===this.count)return this.leftPoints[0]===b?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===b){if(this.left&&this.right){for(var e=this,c=this.left;c.right;)e=c,c=c.right;if(e===this)c.right=this.right;else{var d=this.left,a=this.right;e.count-=c.count,e.right=c.left,c.left=d,c.right=a}i(this,c),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?i(this,this.left):i(this,this.right);return 1}for(var d=h.ge(this.leftPoints,b,q);d<this.leftPoints.length&&this.leftPoints[d][0]===b[0];++d)if(this.leftPoints[d]===b){this.count-=1,this.leftPoints.splice(d,1);for(var a=h.ge(this.rightPoints,b,r);a<this.rightPoints.length&&this.rightPoints[a][1]===b[1];++a)if(this.rightPoints[a]===b)return this.rightPoints.splice(a,1),1}return 0},b.queryPoint=function(a,b){if(a<this.mid){if(this.left){var c=this.left.queryPoint(a,b);if(c)return c}return m(this.leftPoints,a,b)}if(!(a>this.mid))return o(this.leftPoints,b);if(this.right){var c=this.right.queryPoint(a,b);if(c)return c}return n(this.rightPoints,a,b)},b.queryInterval=function(a,b,c){if(a<this.mid&&this.left){var d=this.left.queryInterval(a,b,c);if(d)return d}if(b>this.mid&&this.right){var d=this.right.queryInterval(a,b,c);if(d)return d}return b<this.mid?m(this.leftPoints,b,c):a>this.mid?n(this.rightPoints,a,c):o(this.leftPoints,c)};var a=f.prototype;a.insert=function(a){this.root?this.root.insert(a):this.root=new e(a[0],null,null,[a],[a])},a.remove=function(b){if(this.root){var a=this.root.remove(b);return 2===a&&(this.root=null),0!==a}return!1},a.queryPoint=function(a,b){if(this.root)return this.root.queryPoint(a,b)},a.queryInterval=function(a,b,c){if(a<=b&&this.root)return this.root.queryInterval(a,b,c)},Object.defineProperty(a,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(a,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(b,a,c){"use strict";a.exports=function(b){for(var c=new Array(b),a=0;a<b;++a)c[a]=a;return c}},{}],236:[function(b,a,c){a.exports=!0},{}],237:[function(b,a,c){function d(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}a.exports=function(a){var b;return null!=a&&(d(a)||"function"==typeof(b=a).readFloatLE&&"function"==typeof b.slice&&d(b.slice(0,0))||!!a._isBuffer)}},{}],238:[function(b,a,c){"use strict";a.exports=f,a.exports.isMobile=f,a.exports.default=f;var d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function f(b){b||(b={});var a=b.ua;if(a||"undefined"==typeof navigator||(a=navigator.userAgent),a&&a.headers&&"string"==typeof a.headers["user-agent"]&&(a=a.headers["user-agent"]),"string"!=typeof a)return!1;var c=b.tablet?e.test(a):d.test(a);return!c&&b.tablet&&b.featureDetect&&navigator&&navigator.maxTouchPoints>1&& -1!==a.indexOf("Macintosh")&& -1!==a.indexOf("Safari")&&(c=!0),c}},{}],239:[function(b,a,c){"use strict";a.exports=function(c){for(var a,d=c.length,b=0;b<d;b++)if(((a=c.charCodeAt(b))<9||a>13)&&32!==a&&133!==a&&160!==a&&5760!==a&&6158!==a&&(a<8192||a>8205)&&8232!==a&&8233!==a&&8239!==a&&8287!==a&&8288!==a&&12288!==a&&65279!==a)return!1;return!0}},{}],240:[function(b,a,c){a.exports=function(b,c,a){return b*(1-a)+c*a}},{}],241:[function(a,c,d){var e=a("./normalize"),b=a("gl-mat4/create"),f=a("gl-mat4/clone"),g=a("gl-mat4/determinant"),h=a("gl-mat4/invert"),i=a("gl-mat4/transpose"),j={length:a("gl-vec3/length"),normalize:a("gl-vec3/normalize"),dot:a("gl-vec3/dot"),cross:a("gl-vec3/cross")},k=b(),l=b(),m=[0,0,0,0],n=[[0,0,0],[0,0,0],[0,0,0]],o=[0,0,0];function p(a,b,c,d,e){a[0]=b[0]*d+c[0]*e,a[1]=b[1]*d+c[1]*e,a[2]=b[2]*d+c[2]*e}c.exports=function(E,u,r,c,s,b){if(u||(u=[0,0,0]),r||(r=[0,0,0]),c||(c=[0,0,0]),s||(s=[0,0,0,1]),b||(b=[0,0,0,1]),!e(k,E))return!1;if(f(l,k),l[3]=0,l[7]=0,l[11]=0,l[15]=1,Math.abs(1e-8>g(l)))return!1;var v,w,a,x,y,z,A,d,q,B=k[3],C=k[7],D=k[11],F=k[12],G=k[13],H=k[14],I=k[15];if(0!==B||0!==C||0!==D){if(m[0]=B,m[1]=C,m[2]=D,m[3]=I,!h(l,l))return!1;i(l,l),v=s,w=m,a=l,x=w[0],y=w[1],z=w[2],A=w[3],v[0]=a[0]*x+a[4]*y+a[8]*z+a[12]*A,v[1]=a[1]*x+a[5]*y+a[9]*z+a[13]*A,v[2]=a[2]*x+a[6]*y+a[10]*z+a[14]*A,v[3]=a[3]*x+a[7]*y+a[11]*z+a[15]*A}else s[0]=s[1]=s[2]=0,s[3]=1;if(u[0]=F,u[1]=G,u[2]=H,d=n,q=k,d[0][0]=q[0],d[0][1]=q[1],d[0][2]=q[2],d[1][0]=q[4],d[1][1]=q[5],d[1][2]=q[6],d[2][0]=q[8],d[2][1]=q[9],d[2][2]=q[10],r[0]=j.length(n[0]),j.normalize(n[0],n[0]),c[0]=j.dot(n[0],n[1]),p(n[1],n[1],n[0],1,-c[0]),r[1]=j.length(n[1]),j.normalize(n[1],n[1]),c[0]/=r[1],c[1]=j.dot(n[0],n[2]),p(n[2],n[2],n[0],1,-c[1]),c[2]=j.dot(n[1],n[2]),p(n[2],n[2],n[1],1,-c[2]),r[2]=j.length(n[2]),j.normalize(n[2],n[2]),c[1]/=r[2],c[2]/=r[2],j.cross(o,n[1],n[2]),0>j.dot(n[0],o))for(var t=0;t<3;t++)r[t]*=-1,n[t][0]*=-1,n[t][1]*=-1,n[t][2]*=-1;return b[0]=.5*Math.sqrt(Math.max(1+n[0][0]-n[1][1]-n[2][2],0)),b[1]=.5*Math.sqrt(Math.max(1-n[0][0]+n[1][1]-n[2][2],0)),b[2]=.5*Math.sqrt(Math.max(1-n[0][0]-n[1][1]+n[2][2],0)),b[3]=.5*Math.sqrt(Math.max(1+n[0][0]+n[1][1]+n[2][2],0)),n[2][1]>n[1][2]&&(b[0]=-b[0]),n[0][2]>n[2][0]&&(b[1]=-b[1]),n[1][0]>n[0][1]&&(b[2]=-b[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(b,a,c){a.exports=function(d,b){var c=b[15];if(0===c)return!1;for(var e=1/c,a=0;a<16;a++)d[a]=b[a]*e;return!0}},{}],243:[function(a,b,c){var d=a("gl-vec3/lerp"),e=a("mat4-recompose"),f=a("mat4-decompose"),g=a("gl-mat4/determinant"),h=a("quat-slerp"),i=l(),j=l(),k=l();function l(){return{translate:m(),scale:m(1),skew:m(),perspective:n(),quaternion:n()}}function m(a){return[a||0,a||0,a||0]}function n(){return[0,0,0,1]}b.exports=function(l,b,c,a){if(0===g(b)||0===g(c))return!1;var m=f(b,i.translate,i.scale,i.skew,i.perspective,i.quaternion),n=f(c,j.translate,j.scale,j.skew,j.perspective,j.quaternion);return!!m&&!!n&&(d(k.translate,i.translate,j.translate,a),d(k.skew,i.skew,j.skew,a),d(k.scale,i.scale,j.scale,a),d(k.perspective,i.perspective,j.perspective,a),h(k.quaternion,i.quaternion,j.quaternion,a),e(l,k.translate,k.scale,k.skew,k.perspective,k.quaternion),!0)}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(a,c,d){var b={identity:a("gl-mat4/identity"),translate:a("gl-mat4/translate"),multiply:a("gl-mat4/multiply"),create:a("gl-mat4/create"),scale:a("gl-mat4/scale"),fromRotationTranslation:a("gl-mat4/fromRotationTranslation")};b.create();var e=b.create();c.exports=function(a,f,g,c,d,h){return b.identity(a),b.fromRotationTranslation(a,h,f),a[3]=d[0],a[7]=d[1],a[11]=d[2],a[15]=d[3],b.identity(e),0!==c[2]&&(e[9]=c[2],b.multiply(a,a,e)),0!==c[1]&&(e[9]=0,e[8]=c[1],b.multiply(a,a,e)),0!==c[0]&&(e[8]=0,e[4]=c[0],b.multiply(a,a,e)),b.scale(a,a,g),a}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(b,c,e){"use strict";var f=b("binary-search-bounds"),g=b("mat4-interpolate"),h=b("gl-mat4/invert"),i=b("gl-mat4/rotateX"),j=b("gl-mat4/rotateY"),k=b("gl-mat4/rotateZ"),l=b("gl-mat4/lookAt"),m=b("gl-mat4/translate");b("gl-mat4/scale");var n=b("gl-vec3/normalize"),o=[0,0,0];function d(a){this._components=a.slice(),this._time=[0],this.prevMatrix=a.slice(),this.nextMatrix=a.slice(),this.computedMatrix=a.slice(),this.computedInverse=a.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}c.exports=function(a){var b=(a=a||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new d(b)};var a=d.prototype;a.recalcMatrix=function(r){var d=this._time,c=f.le(d,r),b=this.computedMatrix;if(!(c<0)){var m=this._components;if(c===d.length-1)for(var j=16*c,a=0;a<16;++a)b[a]=m[j++];else{for(var s=d[c+1]-d[c],j=16*c,k=this.prevMatrix,o=!0,a=0;a<16;++a)k[a]=m[j++];for(var p=this.nextMatrix,a=0;a<16;++a)p[a]=m[j++],o=o&&k[a]===p[a];if(s<1e-6||o)for(var a=0;a<16;++a)b[a]=k[a];else g(b,k,p,(r-d[c])/s)}var e=this.computedUp;e[0]=b[1],e[1]=b[5],e[2]=b[9],n(e,e);var i=this.computedInverse;h(i,b);var l=this.computedEye,q=i[15];l[0]=i[12]/q,l[1]=i[13]/q,l[2]=i[14]/q;for(var t=this.computedCenter,u=Math.exp(this.computedRadius[0]),a=0;a<3;++a)t[a]=l[a]-b[2+4*a]*u}},a.idle=function(b){if(!(b<this.lastT())){for(var a=this._components,d=a.length-16,c=0;c<16;++c)a.push(a[d++]);this._time.push(b)}},a.flush=function(b){var a=f.gt(this._time,b)-2;a<0||(this._time.splice(0,a),this._components.splice(0,16*a))},a.lastT=function(){return this._time[this._time.length-1]},a.lookAt=function(f,a,b,e){this.recalcMatrix(f),a=a||this.computedEye,b=b||o,e=e||this.computedUp,this.setMatrix(f,l(this.computedMatrix,a,b,e));for(var c=0,d=0;d<3;++d)c+=Math.pow(b[d]-a[d],2);c=Math.log(Math.sqrt(c)),this.computedRadius[0]=c},a.rotate=function(b,c,d,e){this.recalcMatrix(b);var a=this.computedInverse;c&&j(a,a,c),d&&i(a,a,d),e&&k(a,a,e),this.setMatrix(b,h(this.computedMatrix,a))};var p=[0,0,0];a.pan=function(b,c,d,e){p[0]=-(c||0),p[1]=-(d||0),p[2]=-(e||0),this.recalcMatrix(b);var a=this.computedInverse;m(a,a,p),this.setMatrix(b,h(a,a))},a.translate=function(b,c,d,e){p[0]=c||0,p[1]=d||0,p[2]=e||0,this.recalcMatrix(b);var a=this.computedMatrix;m(a,a,p),this.setMatrix(b,a)},a.setMatrix=function(b,c){if(!(b<this.lastT())){this._time.push(b);for(var a=0;a<16;++a)this._components.push(c[a])}},a.setDistance=function(b,a){this.computedRadius[0]=a},a.setDistanceLimits=function(b,c){var a=this._limits;a[0]=b,a[1]=c},a.getDistanceLimits=function(a){var b=this._limits;return a?(a[0]=b[0],a[1]=b[1],a):b}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(a,b,c){"use strict";b.exports=function(b){var g=b.length;if(g<3){for(var i=new Array(g),a=0;a<g;++a)i[a]=a;return 2===g&&b[0][0]===b[1][0]&&b[0][1]===b[1][1]?[0]:i}for(var h=new Array(g),a=0;a<g;++a)h[a]=a;h.sort(function(a,c){return b[a][0]-b[c][0]||b[a][1]-b[c][1]});for(var e=[h[0],h[1]],f=[h[0],h[1]],a=2;a<g;++a){for(var j=h[a],l=b[j],c=e.length;c>1&&0>=d(b[e[c-2]],b[e[c-1]],l);)c-=1,e.pop();for(e.push(j),c=f.length;c>1&&d(b[f[c-2]],b[f[c-1]],l)>=0;)c-=1,f.pop();f.push(j)}for(var i=new Array(f.length+e.length-2),m=0,a=0,n=e.length;a<n;++a)i[m++]=e[a];for(var k=f.length-2;k>0;--k)i[m++]=f[k];return i};var d=a("robust-orientation")[3]},{"robust-orientation":284}],247:[function(a,b,c){"use strict";b.exports=function(a,b){b||(b=a,a=window);var f=0,g=0,h=0,i={shift:!1,alt:!1,control:!1,meta:!1},j=!1;function k(a){var b=!1;return"altKey"in a&&(b=b||a.altKey!==i.alt,i.alt=!!a.altKey),"shiftKey"in a&&(b=b||a.shiftKey!==i.shift,i.shift=!!a.shiftKey),"ctrlKey"in a&&(b=b||a.ctrlKey!==i.control,i.control=!!a.ctrlKey),"metaKey"in a&&(b=b||a.metaKey!==i.meta,i.meta=!!a.metaKey),b}function l(c,a){var e=d.x(a),j=d.y(a);"buttons"in a&&(c=0|a.buttons),(c!==f||e!==g||j!==h||k(a))&&(f=0|c,g=e||0,h=j||0,b&&b(f,g,h,i))}function m(a){l(0,a)}function n(){(f||g||h||i.shift||i.alt||i.meta||i.control)&&(g=h=0,f=0,i.shift=i.alt=i.control=i.meta=!1,b&&b(0,0,0,i))}function o(a){k(a)&&b&&b(f,g,h,i)}function p(a){0===d.buttons(a)?l(0,a):l(f,a)}function q(a){l(f|d.buttons(a),a)}function r(a){l(f& ~d.buttons(a),a)}function e(){j||(j=!0,a.addEventListener("mousemove",p),a.addEventListener("mousedown",q),a.addEventListener("mouseup",r),a.addEventListener("mouseleave",m),a.addEventListener("mouseenter",m),a.addEventListener("mouseout",m),a.addEventListener("mouseover",m),a.addEventListener("blur",n),a.addEventListener("keyup",o),a.addEventListener("keydown",o),a.addEventListener("keypress",o),a!==window&&(window.addEventListener("blur",n),window.addEventListener("keyup",o),window.addEventListener("keydown",o),window.addEventListener("keypress",o)))}e();var c={element:a};return Object.defineProperties(c,{enabled:{get:function(){return j},set:function(b){b?e():j&&(j=!1,a.removeEventListener("mousemove",p),a.removeEventListener("mousedown",q),a.removeEventListener("mouseup",r),a.removeEventListener("mouseleave",m),a.removeEventListener("mouseenter",m),a.removeEventListener("mouseout",m),a.removeEventListener("mouseover",m),a.removeEventListener("blur",n),a.removeEventListener("keyup",o),a.removeEventListener("keydown",o),a.removeEventListener("keypress",o),a!==window&&(window.removeEventListener("blur",n),window.removeEventListener("keyup",o),window.removeEventListener("keydown",o),window.removeEventListener("keypress",o)))},enumerable:!0},buttons:{get:function(){return f},enumerable:!0},x:{get:function(){return g},enumerable:!0},y:{get:function(){return h},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),c};var d=a("mouse-event")},{"mouse-event":249}],248:[function(b,a,c){var d={left:0,top:0};a.exports=function(b,e,a){e=e||b.currentTarget||b.srcElement,Array.isArray(a)||(a=[0,0]);var c,g=b.clientX||0,h=b.clientY||0,f=(c=e)===window||c===document||c===document.body?d:c.getBoundingClientRect();return a[0]=g-f.left,a[1]=h-f.top,a}},{}],249:[function(c,d,a){"use strict";function b(a){return a.target||a.srcElement||window}a.buttons=function(b){if("object"==typeof b){if("buttons"in b)return b.buttons;if("which"in b){var a=b.which;if(2===a)return 4;if(3===a)return 2;if(a>0)return 1<<a-1}else if("button"in b){var a=b.button;if(1===a)return 4;if(2===a)return 2;if(a>=0)return 1<<a}}return 0},a.element=b,a.x=function(a){if("object"==typeof a){if("offsetX"in a)return a.offsetX;var c=b(a).getBoundingClientRect();return a.clientX-c.left}return 0},a.y=function(a){if("object"==typeof a){if("offsetY"in a)return a.offsetY;var c=b(a).getBoundingClientRect();return a.clientY-c.top}return 0}},{}],250:[function(a,b,c){"use strict";var d=a("to-px");b.exports=function(a,b,e){"function"==typeof a&&(e=!!b,b=a,a=window);var f=d("ex",a),c=function(a){e&&a.preventDefault();var d=a.deltaX||0,g=a.deltaY||0,h=a.deltaZ||0,i=a.deltaMode,c=1;switch(i){case 1:c=f;break;case 2:c=window.innerHeight;break}if(d*=c,g*=c,h*=c,d||g||h)return b(d,g,h,a)};return a.addEventListener("wheel",c),c}},{"to-px":304}],251:[function(a,b,c){"use strict";var d=a("typedarray-pool");b.exports=function(a){function b(a){throw new Error("ndarray-extract-contour: "+a)}"object"!=typeof a&&b("Must specify arguments");var h,i,j,k,l,m=a.order;Array.isArray(m)||b("Must specify order");var f=a.arrayArguments||1;f<1&&b("Must have at least one array argument"),0>(a.scalarArguments||0)&&b("Scalar arg count must be > 0"),"function"!=typeof a.vertex&&b("Must specify vertex creation function"),"function"!=typeof a.cell&&b("Must specify cell creation function"),"function"!=typeof a.phase&&b("Must specify phase function");for(var n=a.getters||[],g=new Array(f),c=0;c<f;++c)n.indexOf(c)>=0?g[c]=!0:g[c]=!1;return h=a.vertex,i=a.cell,j=a.phase,k=m,l=g,(0,e[[l,k].join(",")])(h,i,j,d.mallocUint32,d.freeUint32)};var e={"false,0,1":function(a,b,c,d,e){return function(E,n,o,p){var r,u=0|E.shape[0],P=0|E.shape[1],k=E.data,R=0|E.offset,F=0|E.stride[0],N=0|E.stride[1],g=R,G=0| -F,v=0,H=0| -N,w=0,I=-F-N|0,s=0,D=0|F,O=N-F*u|0,q=0,z=0,J=0,Q=2*u|0,h=d(Q),A=d(Q),f=0,i=0,x=-1,K=-1,l=0,y=0| -u,L=0|u,m=0,B=-u-1|0,M=u-1|0,j=0,C=0,t=0;for(q=0;q<u;++q)h[f++]=c(k[g],n,o,p),g+=D;if(g+=O,P>0){if(z=1,h[f++]=c(k[g],n,o,p),g+=D,u>0)for(q=1,r=k[g],i=h[f]=c(r,n,o,p),l=h[f+x],m=h[f+y],j=h[f+B],(i!==l||i!==m||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(q,z,r,v,w,s,i,l,m,j,n,o,p),C=A[f]=J++),f+=1,g+=D,q=2;q<u;++q)r=k[g],i=h[f]=c(r,n,o,p),l=h[f+x],m=h[f+y],j=h[f+B],(i!==l||i!==m||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(q,z,r,v,w,s,i,l,m,j,n,o,p),C=A[f]=J++,j!==l&&b(A[f+x],C,s,v,j,l,n,o,p)),f+=1,g+=D;for(g+=O,f=0,t=x,x=K,K=t,t=y,y=L,L=t,t=B,B=M,M=t,z=2;z<P;++z){if(h[f++]=c(k[g],n,o,p),g+=D,u>0)for(q=1,r=k[g],i=h[f]=c(r,n,o,p),l=h[f+x],m=h[f+y],j=h[f+B],(i!==l||i!==m||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(q,z,r,v,w,s,i,l,m,j,n,o,p),C=A[f]=J++,j!==m&&b(A[f+y],C,w,s,m,j,n,o,p)),f+=1,g+=D,q=2;q<u;++q)r=k[g],i=h[f]=c(r,n,o,p),l=h[f+x],m=h[f+y],j=h[f+B],(i!==l||i!==m||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(q,z,r,v,w,s,i,l,m,j,n,o,p),C=A[f]=J++,j!==m&&b(A[f+y],C,w,s,m,j,n,o,p),j!==l&&b(A[f+x],C,s,v,j,l,n,o,p)),f+=1,g+=D;1&z&&(f=0),t=x,x=K,K=t,t=y,y=L,L=t,t=B,B=M,M=t,g+=O}}e(A),e(h)}},"false,1,0":function(a,b,c,d,e){return function(E,n,o,p){var r,P=0|E.shape[0],u=0|E.shape[1],k=E.data,R=0|E.offset,N=0|E.stride[0],F=0|E.stride[1],g=R,G=0| -N,v=0,H=0| -F,w=0,I=-N-F|0,s=0,D=0|F,O=N-F*u|0,z=0,q=0,J=0,Q=2*u|0,h=d(Q),A=d(Q),f=0,i=0,x=-1,K=-1,l=0,y=0| -u,L=0|u,m=0,B=-u-1|0,M=u-1|0,j=0,C=0,t=0;for(q=0;q<u;++q)h[f++]=c(k[g],n,o,p),g+=D;if(g+=O,P>0){if(z=1,h[f++]=c(k[g],n,o,p),g+=D,u>0)for(q=1,r=k[g],i=h[f]=c(r,n,o,p),m=h[f+y],l=h[f+x],j=h[f+B],(i!==m||i!==l||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(z,q,r,v,w,s,i,m,l,j,n,o,p),C=A[f]=J++),f+=1,g+=D,q=2;q<u;++q)r=k[g],i=h[f]=c(r,n,o,p),m=h[f+y],l=h[f+x],j=h[f+B],(i!==m||i!==l||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(z,q,r,v,w,s,i,m,l,j,n,o,p),C=A[f]=J++,j!==l&&b(A[f+x],C,w,s,l,j,n,o,p)),f+=1,g+=D;for(g+=O,f=0,t=y,y=L,L=t,t=x,x=K,K=t,t=B,B=M,M=t,z=2;z<P;++z){if(h[f++]=c(k[g],n,o,p),g+=D,u>0)for(q=1,r=k[g],i=h[f]=c(r,n,o,p),m=h[f+y],l=h[f+x],j=h[f+B],(i!==m||i!==l||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(z,q,r,v,w,s,i,m,l,j,n,o,p),C=A[f]=J++,j!==m&&b(A[f+y],C,s,v,j,m,n,o,p)),f+=1,g+=D,q=2;q<u;++q)r=k[g],i=h[f]=c(r,n,o,p),m=h[f+y],l=h[f+x],j=h[f+B],(i!==m||i!==l||i!==j)&&(v=k[g+G],w=k[g+H],s=k[g+I],a(z,q,r,v,w,s,i,m,l,j,n,o,p),C=A[f]=J++,j!==l&&b(A[f+x],C,w,s,l,j,n,o,p),j!==m&&b(A[f+y],C,s,v,j,m,n,o,p)),f+=1,g+=D;1&z&&(f=0),t=y,y=L,L=t,t=x,x=K,K=t,t=B,B=M,M=t,g+=O}}e(A),e(h)}}}},{"typedarray-pool":308}],252:[function(b,c,d){"use strict";var e=b("dup"),f={zero:function(c,d,e,a){var f=c[0],g=e[0];a|=0;var b=0,h=g;for(b=0;b<f;++b)d[a]=0,a+=h},fdTemplate1:function(f,e,g,a,h,i,b){var j=f[0],c=g[0],k=i[0],l=-1*c,m=c;a|=0,b|=0;var d=0,n=c,o=k;for(d=0;d<j;++d)h[b]=.5*(e[a+l]-e[a+m]),a+=n,b+=o},fdTemplate2:function(j,b,k,a,p,l,c,q,m,d){var r=j[0],e=j[1],g=k[0],f=k[1],s=l[0],n=l[1],t=m[0],o=m[1],u=-1*g,v=g,w=-1*f,x=f;a|=0,c|=0,d|=0;var h=0,i=0,y=f,z=g-e*f,A=n,B=s-e*n,C=o,D=t-e*o;for(i=0;i<r;++i){for(h=0;h<e;++h)p[c]=.5*(b[a+u]-b[a+v]),q[d]=.5*(b[a+w]-b[a+x]),a+=y,c+=A,d+=C;a+=z,c+=B,d+=D}}},g={cdiff:function(a){var b={};return function(c,d,e){var g=c.dtype,h=c.order,i=d.dtype,j=d.order,k=e.dtype,l=e.order,m=[g,h.join(),i,j.join(),k,l.join()].join(),f=b[m];return f||(b[m]=f=a([g,h,i,j,k,l])),f(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset,e.data,e.stride,0|e.offset)}},zero:function(a){var b={};return function(c){var e=c.dtype,f=c.order,g=[e,f.join()].join(),d=b[g];return d||(b[g]=d=a([e,f])),d(c.shape.slice(0),c.data,c.stride,0|c.offset)}},fdTemplate1:function(a){var b={};return function(c,d){var f=c.dtype,g=c.order,h=d.dtype,i=d.order,j=[f,g.join(),h,i.join()].join(),e=b[j];return e||(b[j]=e=a([f,g,h,i])),e(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset)}},fdTemplate2:function(a){var b={};return function(c,d,e){var g=c.dtype,h=c.order,i=d.dtype,j=d.order,k=e.dtype,l=e.order,m=[g,h.join(),i,j.join(),k,l.join()].join(),f=b[m];return f||(b[m]=f=a([g,h,i,j,k,l])),f(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset,e.data,e.stride,0|e.offset)}}};function h(a){return f[a.funcName]}function a(b){var a;return(0,g[(a={funcName:b.funcName}).funcName])(h.bind(void 0,a))}var i={},j={},k=a({funcName:"cdiff"}),l=a({funcName:"zero"});function m(b){return b in i?i[b]:i[b]=a({funcName:"fdTemplate"+b})}function n(a,b,c,d){return function(e,f){var a=f.shape.slice();return a[0]>2&&a[1]>2&&d(f.pick(-1,-1).lo(1,1).hi(a[0]-2,a[1]-2),e.pick(-1,-1,0).lo(1,1).hi(a[0]-2,a[1]-2),e.pick(-1,-1,1).lo(1,1).hi(a[0]-2,a[1]-2)),a[1]>2&&(c(f.pick(0,-1).lo(1).hi(a[1]-2),e.pick(0,-1,1).lo(1).hi(a[1]-2)),b(e.pick(0,-1,0).lo(1).hi(a[1]-2))),a[1]>2&&(c(f.pick(a[0]-1,-1).lo(1).hi(a[1]-2),e.pick(a[0]-1,-1,1).lo(1).hi(a[1]-2)),b(e.pick(a[0]-1,-1,0).lo(1).hi(a[1]-2))),a[0]>2&&(c(f.pick(-1,0).lo(1).hi(a[0]-2),e.pick(-1,0,0).lo(1).hi(a[0]-2)),b(e.pick(-1,0,1).lo(1).hi(a[0]-2))),a[0]>2&&(c(f.pick(-1,a[1]-1).lo(1).hi(a[0]-2),e.pick(-1,a[1]-1,0).lo(1).hi(a[0]-2)),b(e.pick(-1,a[1]-1,1).lo(1).hi(a[0]-2))),e.set(0,0,0,0),e.set(0,0,1,0),e.set(a[0]-1,0,0,0),e.set(a[0]-1,0,1,0),e.set(0,a[1]-1,0,0),e.set(0,a[1]-1,1,0),e.set(a[0]-1,a[1]-1,0,0),e.set(a[0]-1,a[1]-1,1,0),e}}c.exports=function(c,a,b){return(Array.isArray(b)||(b="string"==typeof b?e(a.dimension,b):e(a.dimension,"clamp")),0===a.size)?c:0===a.dimension?(c.set(0),c):(function(c){var d=c.join(),a=j[d];if(a)return a;for(var f=c.length,e=[k,l],b=1;b<=f;++b)e.push(m(b));var a=n.apply(void 0,e);return j[d]=a,a})(b)(c,a)}},{dup:65}],253:[function(e,a,f){"use strict";function b(b,c){var a=Math.floor(c),d=c-a,e=0<=a&&a<b.shape[0],f=0<=a+1&&a+1<b.shape[0],g=e?+b.get(a):0,h=f?+b.get(a+1):0;return(1-d)*g+d*h}function c(c,e,f){var a=Math.floor(e),d=e-a,g=0<=a&&a<c.shape[0],h=0<=a+1&&a+1<c.shape[0],b=Math.floor(f),i=f-b,j=0<=b&&b<c.shape[1],k=0<=b+1&&b+1<c.shape[1],l=g&&j?c.get(a,b):0,m=g&&k?c.get(a,b+1):0,n=h&&j?c.get(a+1,b):0,o=h&&k?c.get(a+1,b+1):0;return(1-i)*((1-d)*l+d*n)+i*((1-d)*m+d*o)}function d(a,m,n,o){var b=Math.floor(m),e=m-b,f=0<=b&&b<a.shape[0],g=0<=b+1&&b+1<a.shape[0],c=Math.floor(n),h=n-c,i=0<=c&&c<a.shape[1],j=0<=c+1&&c+1<a.shape[1],d=Math.floor(o),p=o-d,k=0<=d&&d<a.shape[2],l=0<=d+1&&d+1<a.shape[2],q=f&&i&&k?a.get(b,c,d):0,r=f&&j&&k?a.get(b,c+1,d):0,s=g&&i&&k?a.get(b+1,c,d):0,t=g&&j&&k?a.get(b+1,c+1,d):0,u=f&&i&&l?a.get(b,c,d+1):0,v=f&&j&&l?a.get(b,c+1,d+1):0,w=g&&i&&l?a.get(b+1,c,d+1):0,x=g&&j&&l?a.get(b+1,c+1,d+1):0;return(1-p)*((1-h)*((1-e)*q+e*s)+h*((1-e)*r+e*t))+p*((1-h)*((1-e)*u+e*w)+h*((1-e)*v+e*x))}function g(d){var a,h,e=0|d.shape.length,c=new Array(e),i=new Array(e),j=new Array(e),k=new Array(e);for(a=0;a<e;++a)h=+arguments[a+1],c[a]=Math.floor(h),i[a]=h-c[a],j[a]=0<=c[a]&&c[a]<d.shape[a],k[a]=0<=c[a]+1&&c[a]+1<d.shape[a];var b,f,g,l=0;i_loop:for(a=0;a<1<<e;++a){for(b=0,f=1,g=d.offset;b<e;++b)if(a&1<<b){if(!k[b])continue i_loop;f*=i[b],g+=d.stride[b]*(c[b]+1)}else{if(!j[b])continue i_loop;f*=1-i[b],g+=d.stride[b]*c[b]}l+=f*d.data[g]}return l}a.exports=function(a,e,f,h){switch(a.shape.length){case 0:return 0;case 1:return b(a,e);case 2:return c(a,e,f);case 3:return d(a,e,f,h);default:return g.apply(void 0,arguments)}},a.exports.d1=b,a.exports.d2=c,a.exports.d3=d},{}],254:[function(c,d,a){"use strict";var e={"float64,2,1,0":function(){return function(b,k,c,a,l){var m=b[0],g=b[1],h=b[2],n=c[0],i=c[1],j=c[2];a|=0;var d=0,e=0,f=0,o=j,p=i-h*j,q=n-g*i;for(f=0;f<m;++f){for(e=0;e<g;++e){for(d=0;d<h;++d)k[a]/=l,a+=o;a+=p}a+=q}}},"uint8,2,0,1,float64,2,1,0":function(){return function(e,t,g,c,u,h,d,v){for(var f=e[0],i=e[1],j=e[2],k=g[0],p=g[1],q=g[2],l=h[0],r=h[1],s=h[2],w=c|=0,x=d|=0,a=0|e[0];a>0;){a<64?(f=a,a=0):(f=64,a-=64);for(var b=0|e[1];b>0;){b<64?(i=b,b=0):(i=64,b-=64),c=w+a*k+b*p,d=x+a*l+b*r;var m=0,n=0,o=0,y=q,z=k-j*q,A=p-f*k,B=s,C=l-j*s,D=r-f*l;for(o=0;o<i;++o){for(n=0;n<f;++n){for(m=0;m<j;++m)t[c]=u[d]*v,c+=y,d+=B;c+=z,d+=C}c+=A,d+=D}}}}},"float32,1,0,float32,1,0":function(){return function(f,k,g,a,l,h,b){var m=f[0],c=f[1],n=g[0],i=g[1],o=h[0],j=h[1];a|=0,b|=0;var d=0,e=0,p=i,q=n-c*i,r=j,s=o-c*j;for(e=0;e<m;++e){for(d=0;d<c;++d)k[a]=l[b],a+=p,b+=r;a+=q,b+=s}}},"float32,1,0,float32,0,1":function(){return function(f,p,l,c,q,m,d){for(var g=f[0],e=f[1],n=l[0],h=l[1],o=m[0],i=m[1],r=c|=0,s=d|=0,a=0|f[1];a>0;){a<64?(e=a,a=0):(e=64,a-=64);for(var b=0|f[0];b>0;){b<64?(g=b,b=0):(g=64,b-=64),c=r+a*h+b*n,d=s+a*i+b*o;var j=0,k=0,t=h,u=n-e*h,v=i,w=o-e*i;for(k=0;k<g;++k){for(j=0;j<e;++j)p[c]=q[d],c+=t,d+=v;c+=u,d+=w}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(d,u,i,e,v,j,f){for(var g=d[0],k=d[1],h=d[2],l=i[0],s=i[1],m=i[2],n=j[0],t=j[1],o=j[2],w=e|=0,x=f|=0,a=0|d[2];a>0;){a<64?(h=a,a=0):(h=64,a-=64);for(var b=0|d[0];b>0;){b<64?(g=b,b=0):(g=64,b-=64);for(var c=0|d[1];c>0;){c<64?(k=c,c=0):(k=64,c-=64),e=w+a*m+b*l+c*s,f=x+a*o+b*n+c*t;var p=0,q=0,r=0,y=m,z=l-h*m,A=s-g*l,B=o,C=n-h*o,D=t-g*n;for(r=0;r<k;++r){for(q=0;q<g;++q){for(p=0;p<h;++p)u[e]=v[f],e+=y,f+=B;e+=z,f+=C}e+=A,f+=D}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(c,o,d,a,p,e,b){var f=c[0],q=c[1],g=c[2],k=d[0],r=d[1],l=d[2],m=e[0],s=e[1],n=e[2];a|=0,b|=0;var h=0,i=0,j=0,t=l,u=k-g*l,v=r-f*k,w=n,x=m-g*n,y=s-f*m;for(j=0;j<q;++j){for(i=0;i<f;++i){for(h=0;h<g;++h)o[a]=p[b],a+=t,b+=w;a+=u,b+=x}a+=v,b+=y}}}},f={mul:function(a){var b={};return function(c,d,e){var g=c.dtype,h=c.order,i=d.dtype,j=d.order,k=e.dtype,l=e.order,m=[g,h.join(),i,j.join(),k,l.join()].join(),f=b[m];return f||(b[m]=f=a([g,h,i,j,k,l])),f(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset,e.data,e.stride,0|e.offset)}},muls:function(a){var b={};return function(c,d,k){var f=c.dtype,g=c.order,h=d.dtype,i=d.order,j=[f,g.join(),h,i.join()].join(),e=b[j];return e||(b[j]=e=a([f,g,h,i])),e(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset,k)}},mulseq:function(a){var b={};return function(c,h){var e=c.dtype,f=c.order,g=[e,f.join()].join(),d=b[g];return d||(b[g]=d=a([e,f])),d(c.shape.slice(0),c.data,c.stride,0|c.offset,h)}},div:function(a){var b={};return function(c,d,e){var g=c.dtype,h=c.order,i=d.dtype,j=d.order,k=e.dtype,l=e.order,m=[g,h.join(),i,j.join(),k,l.join()].join(),f=b[m];return f||(b[m]=f=a([g,h,i,j,k,l])),f(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset,e.data,e.stride,0|e.offset)}},divs:function(a){var b={};return function(c,d,k){var f=c.dtype,g=c.order,h=d.dtype,i=d.order,j=[f,g.join(),h,i.join()].join(),e=b[j];return e||(b[j]=e=a([f,g,h,i])),e(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset,k)}},divseq:function(a){var b={};return function(c,h){var e=c.dtype,f=c.order,g=[e,f.join()].join(),d=b[g];return d||(b[g]=d=a([e,f])),d(c.shape.slice(0),c.data,c.stride,0|c.offset,h)}},assign:function(a){var b={};return function(c,d){var f=c.dtype,g=c.order,h=d.dtype,i=d.order,j=[f,g.join(),h,i.join()].join(),e=b[j];return e||(b[j]=e=a([f,g,h,i])),e(c.shape.slice(0),c.data,c.stride,0|c.offset,d.data,d.stride,0|d.offset)}}};function b(b){var a;return(0,f[(a={funcName:b.funcName}).funcName])((function(b,a){return(0,e[a.join(",")])()}).bind(void 0,a))}var g={mul:"*",div:"/"};!function(){for(var c in g)a[c]=b({funcName:c}),a[c+"s"]=b({funcName:c+"s"}),a[c+"seq"]=b({funcName:c+"seq"})}(),a.assign=b({funcName:"assign"})},{}],255:[function(a,b,c){"use strict";var d=a("ndarray"),e=a("./doConvert.js");b.exports=function(f,b){for(var c=[],a=f,g=1;Array.isArray(a);)c.push(a.length),g*=a.length,a=a[0];return 0===c.length?d():(b||(b=d(new Float64Array(g),c)),e(b,f),b)}},{"./doConvert.js":256,ndarray:259}],256:[function(e,b,f){"use strict";var a,c,d;b.exports=(a={funcName:"convert"},c=(function(){return function(d,n,e,b,o){var p=d[0],f=d[1],g=d[2],q=e[0],l=e[1],m=e[2],a=[0,0,0];b|=0;var h=0,i=0,j=0,r=m,s=l-g*m,t=q-f*l;for(j=0;j<p;++j){for(i=0;i<f;++i){for(h=0;h<g;++h){var c,k=o;for(c=0;c<a.length-1;++c)k=k[a[c]];n[b]=k[a[a.length-1]],b+=r,++a[2]}b+=s,a[2]-=g,++a[1]}b+=t,a[1]-=f,++a[0]}}}).bind(void 0,a),d={},function(a,h){var e=a.dtype,f=a.order,g=[e,f.join()].join(),b=d[g];return b||(d[g]=b=c([e,f])),b(a.shape.slice(0),a.data,a.stride,0|a.offset,h)})},{}],257:[function(a,b,c){"use strict";var d=a("typedarray-pool");function e(a){switch(a){case"uint32":return[d.mallocUint32,d.freeUint32];default:return null}}var f={"uint32,1,0":function(a,b){return function(m,r,g,s,h,v,w,i,j,t,u){var k,o,f,c,d,e,p,q,n=m*h+s,l=a(i);for(k=m+1;k<=r;++k){for(o=k,n+=h,f=n,d=0,e=n,c=0;c<i;++c)l[d++]=g[e],e+=j;__g:for(;(o--)>m;){d=0,e=f-h;__l:for(c=0;c<i;++c){if((p=g[e])<(q=l[d]))break __g;if(p>q)break __l;e+=t,d+=u}for(c=0,d=f,e=f-h;c<i;++c)g[d]=g[e],d+=j,e+=j;f-=h}for(c=0,d=f,e=0;c<i;++c)g[d]=l[e++],d+=j}b(l)}}},g={"uint32,1,0":function(a,b,c){return function P(F,G,f,m,h,I,J,n,t,s,w){var u,v,S,T,U,q,g,i,B,d,k,l,H,V,W,X,Y,Z,$,_,aa,ab,ac,j,e,K=(G-F+1)/6|0,Q=F+K,R=G-K,L=F+G>>1,ad=L-K,ae=L+K,C=Q,x=ad,y=L,z=ae,D=R,r=F+1,p=G-1,M=!0,N=0,O=0,o=0,af=n,A=b(af),E=b(af);k=h*C,l=h*x,e=m;__l1:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=C,C=x,x=v;break __l1}if(o<0)break __l1;e+=s}k=h*z,l=h*D,e=m;__l2:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=z,z=D,D=v;break __l2}if(o<0)break __l2;e+=s}k=h*C,l=h*y,e=m;__l3:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=C,C=y,y=v;break __l3}if(o<0)break __l3;e+=s}k=h*x,l=h*y,e=m;__l4:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=x,x=y,y=v;break __l4}if(o<0)break __l4;e+=s}k=h*C,l=h*z,e=m;__l5:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=C,C=z,z=v;break __l5}if(o<0)break __l5;e+=s}k=h*y,l=h*z,e=m;__l6:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=y,y=z,z=v;break __l6}if(o<0)break __l6;e+=s}k=h*x,l=h*D,e=m;__l7:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=x,x=D,D=v;break __l7}if(o<0)break __l7;e+=s}k=h*x,l=h*y,e=m;__l8:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=x,x=y,y=v;break __l8}if(o<0)break __l8;e+=s}k=h*z,l=h*D,e=m;__l9:for(d=0;d<n;++d){if(g=k+e,i=l+e,o=f[g]-f[i],o>0){v=z,z=D,D=v;break __l9}if(o<0)break __l9;e+=s}for(d=0,k=h*C,l=h*x,H=h*y,V=h*z,W=h*D,X=h*Q,Y=h*L,Z=h*R,j=0,e=m;d<n;++d)g=k+e,i=l+e,B=H+e,$=V+e,_=W+e,aa=X+e,ab=Y+e,ac=Z+e,A[j]=f[i],E[j]=f[$],M=M&&A[j]===E[j],S=f[g],T=f[B],U=f[_],f[aa]=S,f[ab]=T,f[ac]=U,++j,e+=t;for(d=0,k=h*ad,l=h*F,e=m;d<n;++d)g=k+e,i=l+e,f[g]=f[i],e+=t;for(d=0,k=h*ae,l=h*G,e=m;d<n;++d)g=k+e,i=l+e,f[g]=f[i],e+=t;if(M)for(q=r;q<=p;++q){g=m+q*h,j=0;__l10:for(d=0;d<n;++d){if(0!=(o=f[g]-A[j]))break __l10;j+=w,g+=s}if(0!==o)if(o<0){if(q!==r)for(d=0,k=h*q,l=h*r,e=m;d<n;++d)g=k+e,i=l+e,u=f[g],f[g]=f[i],f[i]=u,e+=t;++r}else for(;;){g=m+p*h,j=0;__l11:for(d=0;d<n;++d){if(0!=(o=f[g]-A[j]))break __l11;j+=w,g+=s}if(o>0)p--;else if(o<0){for(d=0,k=h*q,l=h*r,H=h*p,e=m;d<n;++d)g=k+e,i=l+e,B=H+e,u=f[g],f[g]=f[i],f[i]=f[B],f[B]=u,e+=t;++r,--p;break}else{for(d=0,k=h*q,l=h*p,e=m;d<n;++d)g=k+e,i=l+e,u=f[g],f[g]=f[i],f[i]=u,e+=t;--p;break}}}else for(q=r;q<=p;++q){g=m+q*h,j=0;__l12:for(d=0;d<n;++d){if(0!=(N=f[g]-A[j]))break __l12;j+=w,g+=s}if(N<0){if(q!==r)for(d=0,k=h*q,l=h*r,e=m;d<n;++d)g=k+e,i=l+e,u=f[g],f[g]=f[i],f[i]=u,e+=t;++r}else{g=m+q*h,j=0;__l13:for(d=0;d<n;++d){if(0!=(O=f[g]-E[j]))break __l13;j+=w,g+=s}if(O>0)for(;;){g=m+p*h,j=0;__l14:for(d=0;d<n;++d){if(0!=(o=f[g]-E[j]))break __l14;j+=w,g+=s}if(o>0){if(--p<q)break;continue}g=m+p*h,j=0;__l15:for(d=0;d<n;++d){if(0!=(o=f[g]-A[j]))break __l15;j+=w,g+=s}if(o<0){for(d=0,k=h*q,l=h*r,H=h*p,e=m;d<n;++d)g=k+e,i=l+e,B=H+e,u=f[g],f[g]=f[i],f[i]=f[B],f[B]=u,e+=t;++r,--p}else{for(d=0,k=h*q,l=h*p,e=m;d<n;++d)g=k+e,i=l+e,u=f[g],f[g]=f[i],f[i]=u,e+=t;--p}break}}}for(d=0,k=h*F,l=h*(r-1),j=0,e=m;d<n;++d)g=k+e,i=l+e,f[g]=f[i],f[i]=A[j],++j,e+=t;for(d=0,k=h*G,l=h*(p+1),j=0,e=m;d<n;++d)g=k+e,i=l+e,f[g]=f[i],f[i]=E[j],++j,e+=t;if(r-2-F<=32?a(F,r-2,f,m,h,I,J,n,t,s,w):P(F,r-2,f,m,h,I,J,n,t,s,w),G-(p+2)<=32?a(p+2,G,f,m,h,I,J,n,t,s,w):P(p+2,G,f,m,h,I,J,n,t,s,w),M){c(A),c(E);return}if(r<Q&&p>R){__l16:for(;;){for(d=0,g=m+r*h,j=0,e=m;d<n;++d){if(f[g]!==A[j])break __l16;++j,g+=t}++r}__l17:for(;;){for(d=0,g=m+p*h,j=0,e=m;d<n;++d){if(f[g]!==E[j])break __l17;++j,g+=t}--p}for(q=r;q<=p;++q){g=m+q*h,j=0;__l18:for(d=0;d<n;++d){if(0!=(N=f[g]-A[j]))break __l18;j+=w,g+=s}if(0===N){if(q!==r)for(d=0,k=h*q,l=h*r,e=m;d<n;++d)g=k+e,i=l+e,u=f[g],f[g]=f[i],f[i]=u,e+=t;++r}else{g=m+q*h,j=0;__l19:for(d=0;d<n;++d){if(0!=(O=f[g]-E[j]))break __l19;j+=w,g+=s}if(0===O)for(;;){g=m+p*h,j=0;__l20:for(d=0;d<n;++d){if(0!=(o=f[g]-E[j]))break __l20;j+=w,g+=s}if(0===o){if(--p<q)break;continue}g=m+p*h,j=0;__l21:for(d=0;d<n;++d){if(0!=(o=f[g]-A[j]))break __l21;j+=w,g+=s}if(o<0){for(d=0,k=h*q,l=h*r,H=h*p,e=m;d<n;++d)g=k+e,i=l+e,B=H+e,u=f[g],f[g]=f[i],f[i]=f[B],f[B]=u,e+=t;++r,--p}else{for(d=0,k=h*q,l=h*p,e=m;d<n;++d)g=k+e,i=l+e,u=f[g],f[g]=f[i],f[i]=u,e+=t;--p}break}}}}c(A),c(E),p-r<=32?a(r,p,f,m,h,I,J,n,t,s,w):P(r,p,f,m,h,I,J,n,t,s,w)}}},h={"uint32,1,0":function(a,b){return function(d){var f=d.data,g=0|d.offset,h=d.shape,i=d.stride,j=0|i[0],c=0|h[0],e=0|i[1],k=0|h[1],l=e,m=e;c<=32?a(0,c-1,f,g,j,e,c,k,l,m,1):b(0,c-1,f,g,j,e,c,k,l,m,1)}}};b.exports=function(c,d){var n,o,a,i,j,k,l,b,m,q=h[[d,c].join(",")],p=(n=c,a=e(o=d),i=f[[o,n].join(",")],a?i(a[0],a[1]):i()),r=(j=c,k=d,l=p,b=e(k),m=g[[k,j].join(",")],j.length>1&&b?m(l,b[0],b[1]):m(l));return q(p,r)}},{"typedarray-pool":308}],258:[function(a,b,c){"use strict";var d=a("./lib/compile_sort.js"),e={};b.exports=function(a){var c=a.order,f=a.dtype,g=[c,f].join(":"),b=e[g];return b||(e[g]=b=d(c,f)),b(a),a}},{"./lib/compile_sort.js":257}],259:[function(a,b,c){var d=a("is-buffer"),e="undefined"!=typeof Float64Array;function f(a,b){return a[0]-b[0]}function g(){var a,d=this.stride,b=new Array(d.length);for(a=0;a<b.length;++a)b[a]=[Math.abs(d[a]),a];b.sort(f);var c=new Array(b.length);for(a=0;a<c.length;++a)c[a]=b[a][1];return c}var h={T:function(b){function c(a){this.data=a}var a=c.prototype;return a.dtype=b,a.index=function(){return -1},a.size=0,a.dimension=-1,a.shape=a.stride=a.order=[],a.lo=a.hi=a.transpose=a.step=function(){return new c(this.data)},a.get=a.set=function(){},a.pick=function(){return null},function(a){return new c(a)}},0:function(b,d){function c(a,b){this.data=a,this.offset=b}var a=c.prototype;return a.dtype=b,a.index=function(){return this.offset},a.dimension=0,a.size=1,a.shape=a.stride=a.order=[],a.lo=a.hi=a.transpose=a.step=function(){return new c(this.data,this.offset)},a.pick=function(){return d(this.data)},a.valueOf=a.get=function(){return"generic"===b?this.data.get(this.offset):this.data[this.offset]},a.set=function(a){return"generic"===b?this.data.set(this.offset,a):this.data[this.offset]=a},function(a,d,e,b){return new c(a,b)}},1:function(b,d,e){function c(a,b,c,d){this.data=a,this.shape=[b],this.stride=[c],this.offset=0|d}var a=c.prototype;return a.dtype=b,a.dimension=1,Object.defineProperty(a,"size",{get:function(){return this.shape[0]}}),a.order=[0],a.set=function(a,c){return"generic"===b?this.data.set(this.offset+this.stride[0]*a,c):this.data[this.offset+this.stride[0]*a]=c},a.get=function(a){return"generic"===b?this.data.get(this.offset+this.stride[0]*a):this.data[this.offset+this.stride[0]*a]},a.index=function(a){return this.offset+this.stride[0]*a},a.hi=function(a){return new c(this.data,"number"!=typeof a||a<0?this.shape[0]:0|a,this.stride[0],this.offset)},a.lo=function(a){var b=this.offset,d=0,e=this.shape[0],f=this.stride[0];return"number"==typeof a&&a>=0&&(b+=f*(d=0|a),e-=d),new c(this.data,e,f,b)},a.step=function(e){var a=this.shape[0],d=this.stride[0],f=this.offset,b=0,g=Math.ceil;return"number"==typeof e&&((b=0|e)<0?(f+=d*(a-1),a=g(-a/b)):a=g(a/b),d*=b),new c(this.data,a,d,f)},a.transpose=function(a){a=void 0===a?0:0|a;var b=this.shape,d=this.stride;return new c(this.data,b[a],d[a],this.offset)},a.pick=function(a){var b=[],e=[],c=this.offset;return"number"==typeof a&&a>=0?c=c+this.stride[0]*a|0:(b.push(this.shape[0]),e.push(this.stride[0])),(0,d[b.length+1])(this.data,b,e,c)},function(a,b,d,e){return new c(a,b[0],d[0],e)}},2:function(b,d,e){function c(a,b,c,d,e,f){this.data=a,this.shape=[b,c],this.stride=[d,e],this.offset=0|f}var a=c.prototype;return a.dtype=b,a.dimension=2,Object.defineProperty(a,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(a,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),a.set=function(a,c,d){return"generic"===b?this.data.set(this.offset+this.stride[0]*a+this.stride[1]*c,d):this.data[this.offset+this.stride[0]*a+this.stride[1]*c]=d},a.get=function(a,c){return"generic"===b?this.data.get(this.offset+this.stride[0]*a+this.stride[1]*c):this.data[this.offset+this.stride[0]*a+this.stride[1]*c]},a.index=function(a,b){return this.offset+this.stride[0]*a+this.stride[1]*b},a.hi=function(a,b){return new c(this.data,"number"!=typeof a||a<0?this.shape[0]:0|a,"number"!=typeof b||b<0?this.shape[1]:0|b,this.stride[0],this.stride[1],this.offset)},a.lo=function(b,d){var e=this.offset,a=0,f=this.shape[0],g=this.shape[1],h=this.stride[0],i=this.stride[1];return"number"==typeof b&&b>=0&&(e+=h*(a=0|b),f-=a),"number"==typeof d&&d>=0&&(e+=i*(a=0|d),g-=a),new c(this.data,f,g,h,i,e)},a.step=function(i,j){var b=this.shape[0],d=this.shape[1],f=this.stride[0],g=this.stride[1],h=this.offset,a=0,e=Math.ceil;return"number"==typeof i&&((a=0|i)<0?(h+=f*(b-1),b=e(-b/a)):b=e(b/a),f*=a),"number"==typeof j&&((a=0|j)<0?(h+=g*(d-1),d=e(-d/a)):d=e(d/a),g*=a),new c(this.data,b,d,f,g,h)},a.transpose=function(a,b){a=void 0===a?0:0|a,b=void 0===b?1:0|b;var d=this.shape,e=this.stride;return new c(this.data,d[a],d[b],e[a],e[b],this.offset)},a.pick=function(c,e){var b=[],f=[],a=this.offset;return"number"==typeof c&&c>=0?a=a+this.stride[0]*c|0:(b.push(this.shape[0]),f.push(this.stride[0])),"number"==typeof e&&e>=0?a=a+this.stride[1]*e|0:(b.push(this.shape[1]),f.push(this.stride[1])),(0,d[b.length+1])(this.data,b,f,a)},function(d,a,b,e){return new c(d,a[0],a[1],b[0],b[1],e)}},3:function(b,d,e){function c(a,b,c,d,e,f,g,h){this.data=a,this.shape=[b,c,d],this.stride=[e,f,g],this.offset=0|h}var a=c.prototype;return a.dtype=b,a.dimension=3,Object.defineProperty(a,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(a,"order",{get:function(){var b=Math.abs(this.stride[0]),c=Math.abs(this.stride[1]),a=Math.abs(this.stride[2]);return b>c?c>a?[2,1,0]:b>a?[1,2,0]:[1,0,2]:b>a?[2,0,1]:a>c?[0,1,2]:[0,2,1]}}),a.set=function(a,c,d,e){return"generic"===b?this.data.set(this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d,e):this.data[this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d]=e},a.get=function(a,c,d){return"generic"===b?this.data.get(this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d):this.data[this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d]},a.index=function(a,b,c){return this.offset+this.stride[0]*a+this.stride[1]*b+this.stride[2]*c},a.hi=function(a,b,d){return new c(this.data,"number"!=typeof a||a<0?this.shape[0]:0|a,"number"!=typeof b||b<0?this.shape[1]:0|b,"number"!=typeof d||d<0?this.shape[2]:0|d,this.stride[0],this.stride[1],this.stride[2],this.offset)},a.lo=function(d,e,f){var b=this.offset,a=0,g=this.shape[0],h=this.shape[1],i=this.shape[2],j=this.stride[0],k=this.stride[1],l=this.stride[2];return"number"==typeof d&&d>=0&&(b+=j*(a=0|d),g-=a),"number"==typeof e&&e>=0&&(b+=k*(a=0|e),h-=a),"number"==typeof f&&f>=0&&(b+=l*(a=0|f),i-=a),new c(this.data,g,h,i,j,k,l,b)},a.step=function(k,l,m){var b=this.shape[0],d=this.shape[1],e=this.shape[2],h=this.stride[0],i=this.stride[1],j=this.stride[2],g=this.offset,a=0,f=Math.ceil;return"number"==typeof k&&((a=0|k)<0?(g+=h*(b-1),b=f(-b/a)):b=f(b/a),h*=a),"number"==typeof l&&((a=0|l)<0?(g+=i*(d-1),d=f(-d/a)):d=f(d/a),i*=a),"number"==typeof m&&((a=0|m)<0?(g+=j*(e-1),e=f(-e/a)):e=f(e/a),j*=a),new c(this.data,b,d,e,h,i,j,g)},a.transpose=function(a,b,d){a=void 0===a?0:0|a,b=void 0===b?1:0|b,d=void 0===d?2:0|d;var e=this.shape,f=this.stride;return new c(this.data,e[a],e[b],e[d],f[a],f[b],f[d],this.offset)},a.pick=function(e,f,g){var b=[],c=[],a=this.offset;return"number"==typeof e&&e>=0?a=a+this.stride[0]*e|0:(b.push(this.shape[0]),c.push(this.stride[0])),"number"==typeof f&&f>=0?a=a+this.stride[1]*f|0:(b.push(this.shape[1]),c.push(this.stride[1])),"number"==typeof g&&g>=0?a=a+this.stride[2]*g|0:(b.push(this.shape[2]),c.push(this.stride[2])),(0,d[b.length+1])(this.data,b,c,a)},function(d,a,b,e){return new c(d,a[0],a[1],a[2],b[0],b[1],b[2],e)}},4:function(b,e,c){function d(a,b,c,d,e,f,g,h,i,j){this.data=a,this.shape=[b,c,d,e],this.stride=[f,g,h,i],this.offset=0|j}var a=d.prototype;return a.dtype=b,a.dimension=4,Object.defineProperty(a,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(a,"order",{get:c}),a.set=function(a,c,d,e,f){return"generic"===b?this.data.set(this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e,f):this.data[this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e]=f},a.get=function(a,c,d,e){return"generic"===b?this.data.get(this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e):this.data[this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e]},a.index=function(a,b,c,d){return this.offset+this.stride[0]*a+this.stride[1]*b+this.stride[2]*c+this.stride[3]*d},a.hi=function(a,b,c,e){return new d(this.data,"number"!=typeof a||a<0?this.shape[0]:0|a,"number"!=typeof b||b<0?this.shape[1]:0|b,"number"!=typeof c||c<0?this.shape[2]:0|c,"number"!=typeof e||e<0?this.shape[3]:0|e,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},a.lo=function(c,e,f,g){var b=this.offset,a=0,h=this.shape[0],i=this.shape[1],j=this.shape[2],k=this.shape[3],l=this.stride[0],m=this.stride[1],n=this.stride[2],o=this.stride[3];return"number"==typeof c&&c>=0&&(b+=l*(a=0|c),h-=a),"number"==typeof e&&e>=0&&(b+=m*(a=0|e),i-=a),"number"==typeof f&&f>=0&&(b+=n*(a=0|f),j-=a),"number"==typeof g&&g>=0&&(b+=o*(a=0|g),k-=a),new d(this.data,h,i,j,k,l,m,n,o,b)},a.step=function(m,n,o,p){var c=this.shape[0],e=this.shape[1],f=this.shape[2],g=this.shape[3],i=this.stride[0],j=this.stride[1],k=this.stride[2],l=this.stride[3],h=this.offset,a=0,b=Math.ceil;return"number"==typeof m&&((a=0|m)<0?(h+=i*(c-1),c=b(-c/a)):c=b(c/a),i*=a),"number"==typeof n&&((a=0|n)<0?(h+=j*(e-1),e=b(-e/a)):e=b(e/a),j*=a),"number"==typeof o&&((a=0|o)<0?(h+=k*(f-1),f=b(-f/a)):f=b(f/a),k*=a),"number"==typeof p&&((a=0|p)<0?(h+=l*(g-1),g=b(-g/a)):g=b(g/a),l*=a),new d(this.data,c,e,f,g,i,j,k,l,h)},a.transpose=function(a,b,c,e){a=void 0===a?0:0|a,b=void 0===b?1:0|b,c=void 0===c?2:0|c,e=void 0===e?3:0|e;var f=this.shape,g=this.stride;return new d(this.data,f[a],f[b],f[c],f[e],g[a],g[b],g[c],g[e],this.offset)},a.pick=function(d,f,g,h){var b=[],c=[],a=this.offset;return"number"==typeof d&&d>=0?a=a+this.stride[0]*d|0:(b.push(this.shape[0]),c.push(this.stride[0])),"number"==typeof f&&f>=0?a=a+this.stride[1]*f|0:(b.push(this.shape[1]),c.push(this.stride[1])),"number"==typeof g&&g>=0?a=a+this.stride[2]*g|0:(b.push(this.shape[2]),c.push(this.stride[2])),"number"==typeof h&&h>=0?a=a+this.stride[3]*h|0:(b.push(this.shape[3]),c.push(this.stride[3])),(0,e[b.length+1])(this.data,b,c,a)},function(c,a,b,e){return new d(c,a[0],a[1],a[2],a[3],b[0],b[1],b[2],b[3],e)}},5:function(b,e,c){function d(a,b,c,d,e,f,g,h,i,j,k,l){this.data=a,this.shape=[b,c,d,e,f],this.stride=[g,h,i,j,k],this.offset=0|l}var a=d.prototype;return a.dtype=b,a.dimension=5,Object.defineProperty(a,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(a,"order",{get:c}),a.set=function(a,c,d,e,f,g){return"generic"===b?this.data.set(this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e+this.stride[4]*f,g):this.data[this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e+this.stride[4]*f]=g},a.get=function(a,c,d,e,f){return"generic"===b?this.data.get(this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e+this.stride[4]*f):this.data[this.offset+this.stride[0]*a+this.stride[1]*c+this.stride[2]*d+this.stride[3]*e+this.stride[4]*f]},a.index=function(a,b,c,d,e){return this.offset+this.stride[0]*a+this.stride[1]*b+this.stride[2]*c+this.stride[3]*d+this.stride[4]*e},a.hi=function(a,b,c,e,f){return new d(this.data,"number"!=typeof a||a<0?this.shape[0]:0|a,"number"!=typeof b||b<0?this.shape[1]:0|b,"number"!=typeof c||c<0?this.shape[2]:0|c,"number"!=typeof e||e<0?this.shape[3]:0|e,"number"!=typeof f||f<0?this.shape[4]:0|f,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},a.lo=function(c,e,f,g,h){var b=this.offset,a=0,i=this.shape[0],j=this.shape[1],k=this.shape[2],l=this.shape[3],m=this.shape[4],n=this.stride[0],o=this.stride[1],p=this.stride[2],q=this.stride[3],r=this.stride[4];return"number"==typeof c&&c>=0&&(b+=n*(a=0|c),i-=a),"number"==typeof e&&e>=0&&(b+=o*(a=0|e),j-=a),"number"==typeof f&&f>=0&&(b+=p*(a=0|f),k-=a),"number"==typeof g&&g>=0&&(b+=q*(a=0|g),l-=a),"number"==typeof h&&h>=0&&(b+=r*(a=0|h),m-=a),new d(this.data,i,j,k,l,m,n,o,p,q,r,b)},a.step=function(o,p,q,r,s){var c=this.shape[0],e=this.shape[1],f=this.shape[2],g=this.shape[3],h=this.shape[4],j=this.stride[0],k=this.stride[1],l=this.stride[2],m=this.stride[3],n=this.stride[4],i=this.offset,a=0,b=Math.ceil;return"number"==typeof o&&((a=0|o)<0?(i+=j*(c-1),c=b(-c/a)):c=b(c/a),j*=a),"number"==typeof p&&((a=0|p)<0?(i+=k*(e-1),e=b(-e/a)):e=b(e/a),k*=a),"number"==typeof q&&((a=0|q)<0?(i+=l*(f-1),f=b(-f/a)):f=b(f/a),l*=a),"number"==typeof r&&((a=0|r)<0?(i+=m*(g-1),g=b(-g/a)):g=b(g/a),m*=a),"number"==typeof s&&((a=0|s)<0?(i+=n*(h-1),h=b(-h/a)):h=b(h/a),n*=a),new d(this.data,c,e,f,g,h,j,k,l,m,n,i)},a.transpose=function(a,b,c,e,f){a=void 0===a?0:0|a,b=void 0===b?1:0|b,c=void 0===c?2:0|c,e=void 0===e?3:0|e,f=void 0===f?4:0|f;var g=this.shape,h=this.stride;return new d(this.data,g[a],g[b],g[c],g[e],g[f],h[a],h[b],h[c],h[e],h[f],this.offset)},a.pick=function(d,f,g,h,i){var b=[],c=[],a=this.offset;return"number"==typeof d&&d>=0?a=a+this.stride[0]*d|0:(b.push(this.shape[0]),c.push(this.stride[0])),"number"==typeof f&&f>=0?a=a+this.stride[1]*f|0:(b.push(this.shape[1]),c.push(this.stride[1])),"number"==typeof g&&g>=0?a=a+this.stride[2]*g|0:(b.push(this.shape[2]),c.push(this.stride[2])),"number"==typeof h&&h>=0?a=a+this.stride[3]*h|0:(b.push(this.shape[3]),c.push(this.stride[3])),"number"==typeof i&&i>=0?a=a+this.stride[4]*i|0:(b.push(this.shape[4]),c.push(this.stride[4])),(0,e[b.length+1])(this.data,b,c,a)},function(c,a,b,e){return new d(c,a[0],a[1],a[2],a[3],a[4],b[0],b[1],b[2],b[3],b[4],e)}}};function i(a,b){var c=h[-1===b?"T":String(b)];return -1===b?c(a):0===b?c(a,j[a][0]):c(a,j[a],g)}var j={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};b.exports=function(b,c,f,h){if(void 0===b){var l=j.array[0];return l([])}"number"==typeof b&&(b=[b]),void 0===c&&(c=[b.length]);var g=c.length;if(void 0===f){f=new Array(g);for(var a=g-1,m=1;a>=0;--a)f[a]=m,m*=c[a]}if(void 0===h){h=0;for(var a=0;a<g;++a)f[a]<0&&(h-=(c[a]-1)*f[a])}for(var n=function(a){if(d(a))return"buffer";if(e)switch(Object.prototype.toString.call(a)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(a)?"array":"generic"}(b),k=j[n];k.length<=g+1;)k.push(i(n,k.length-1));var l=k[g+1];return l(b,c,f,h)}},{"is-buffer":237}],260:[function(a,b,c){"use strict";var d=a("double-bits");b.exports=function(a,c){if(isNaN(a)||isNaN(c))return NaN;if(a===c)return a;if(0===a)return c<0?-0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005:5e-324;var e=d.hi(a),b=d.lo(a);return c>a==a>0?4294967295===b?(e+=1,b=0):b+=1:0===b?(b=4294967295,e-=1):b-=1,d.pack(b,e)}},{"double-bits":64}],261:[function(b,c,a){a.vertexNormals=function(q,g,r){for(var j=g.length,h=new Array(j),s=void 0===r?1e-6:r,b=0;b<j;++b)h[b]=[0,0,0];for(var b=0;b<q.length;++b)for(var c=q[b],t=0,i=c[c.length-1],k=c[0],l=0;l<c.length;++l){t=i,i=k,k=c[(l+1)%c.length];for(var x=g[t],u=g[i],y=g[k],e=new Array(3),m=0,f=new Array(3),n=0,a=0;a<3;++a)e[a]=x[a]-u[a],m+=e[a]*e[a],f[a]=y[a]-u[a],n+=f[a]*f[a];if(m*n>s)for(var d=h[i],o=1/Math.sqrt(m*n),a=0;a<3;++a){var v=(a+1)%3,w=(a+2)%3;d[a]+=o*(f[v]*e[w]-f[w]*e[v])}}for(var b=0;b<j;++b){for(var d=h[b],p=0,a=0;a<3;++a)p+=d[a]*d[a];if(p>s)for(var o=1/Math.sqrt(p),a=0;a<3;++a)d[a]*=o;else for(var a=0;a<3;++a)d[a]=0}return h},a.faceNormals=function(h,n,i){for(var j=h.length,k=new Array(j),o=void 0===i?1e-6:i,e=0;e<j;++e){for(var p=h[e],b=new Array(3),a=0;a<3;++a)b[a]=n[p[a]];for(var f=new Array(3),g=new Array(3),a=0;a<3;++a)f[a]=b[1][a]-b[0][a],g[a]=b[2][a]-b[0][a];for(var c=new Array(3),d=0,a=0;a<3;++a){var l=(a+1)%3,m=(a+2)%3;c[a]=f[l]*g[m]-f[m]*g[l],d+=c[a]*c[a]}d=d>o?1/Math.sqrt(d):0;for(var a=0;a<3;++a)c[a]*=d;k[e]=c}return k}},{}],262:[function(b,a,c){"use strict";a.exports=function(a,i,c,d,j,e,f,g,h,l){var m=i+e+l;if(b>0){var b=Math.sqrt(m+1);a[0]=.5*(f-h)/b,a[1]=.5*(g-d)/b,a[2]=.5*(c-e)/b,a[3]=.5*b}else{var k=Math.max(i,e,l),b=Math.sqrt(2*k-m+1);i>=k?(a[0]=.5*b,a[1]=.5*(j+c)/b,a[2]=.5*(g+d)/b,a[3]=.5*(f-h)/b):e>=k?(a[0]=.5*(c+j)/b,a[1]=.5*b,a[2]=.5*(h+f)/b,a[3]=.5*(g-d)/b):(a[0]=.5*(d+g)/b,a[1]=.5*(f+h)/b,a[2]=.5*b,a[3]=.5*(c-j)/b)}return a}},{}],263:[function(b,c,e){"use strict";c.exports=function(a){var c=(a=a||{}).center||[0,0,0],b=a.rotation||[0,0,0,1],f=a.radius||1;c=[].slice.call(c,0,3),m(b=[].slice.call(b,0,4),b);var e=new d(b,c,Math.log(f));return e.setDistanceLimits(a.zoomMin,a.zoomMax),("eye"in a||"up"in a)&&e.lookAt(0,a.eye,a.center,a.up),e};var f=b("filtered-vector"),g=b("gl-mat4/lookAt"),h=b("gl-mat4/fromQuat"),i=b("gl-mat4/invert"),j=b("./lib/quatFromFrame");function k(a,b,c){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2))}function l(a,b,c,d){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2)+Math.pow(d,2))}function m(a,c){var d=c[0],e=c[1],f=c[2],g=c[3],b=l(d,e,f,g);b>1e-6?(a[0]=d/b,a[1]=e/b,a[2]=f/b,a[3]=g/b):(a[0]=a[1]=a[2]=0,a[3]=1)}function d(a,b,c){this.radius=f([c]),this.center=f(b),this.rotation=f(a),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var a=d.prototype;a.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},a.recalcMatrix=function(e){this.radius.curve(e),this.center.curve(e),this.rotation.curve(e);var f=this.computedRotation;m(f,f);var a=this.computedMatrix;h(a,f);var g=this.computedCenter,b=this.computedEye,i=this.computedUp,j=Math.exp(this.computedRadius[0]);b[0]=g[0]+j*a[2],b[1]=g[1]+j*a[6],b[2]=g[2]+j*a[10],i[0]=a[1],i[1]=a[5],i[2]=a[9];for(var c=0;c<3;++c){for(var k=0,d=0;d<3;++d)k+=a[c+4*d]*b[d];a[12+c]=-k}},a.getMatrix=function(d,b){this.recalcMatrix(d);var c=this.computedMatrix;if(b){for(var a=0;a<16;++a)b[a]=c[a];return b}return c},a.idle=function(a){this.center.idle(a),this.radius.idle(a),this.rotation.idle(a)},a.flush=function(a){this.center.flush(a),this.radius.flush(a),this.rotation.flush(a)},a.pan=function(n,h,i,o){h=h||0,i=i||0,o=o||0,this.recalcMatrix(n);var a=this.computedMatrix,b=a[1],c=a[5],d=a[9],p=k(b,c,d);b/=p,c/=p,d/=p;var e=a[0],f=a[4],g=a[8],q=e*b+f*c+g*d,r=k(e-=b*q,f-=c*q,g-=d*q);e/=r,f/=r,g/=r;var j=a[2],l=a[6],m=a[10],s=j*b+l*c+m*d,t=j*e+l*f+m*g,u=k(j-=s*b+t*e,l-=s*c+t*f,m-=s*d+t*g);j/=u,l/=u,m/=u,this.center.move(n,e*h+b*i,f*h+c*i,g*h+d*i);var v=Math.exp(this.computedRadius[0]);v=Math.max(1e-4,v+o),this.radius.set(n,Math.log(v))},a.rotate=function(y,j,m,z){this.recalcMatrix(y),j=j||0,m=m||0;var e=this.computedMatrix,D=e[0],E=e[4],F=e[8],G=e[1],H=e[5],I=e[9],u=e[2],v=e[6],w=e[10],A=j*D+m*G,B=j*E+m*H,C=j*F+m*I,a=-(v*C-w*B),b=-(w*A-u*C),c=-(u*B-v*A),d=Math.sqrt(Math.max(0,1-Math.pow(a,2)-Math.pow(b,2)-Math.pow(c,2))),n=l(a,b,c,d);n>1e-6?(a/=n,b/=n,c/=n,d/=n):(a=b=c=0,d=1);var p=this.computedRotation,q=p[0],r=p[1],s=p[2],t=p[3],f=q*d+t*a+r*c-s*b,g=r*d+t*b+s*a-q*c,h=s*d+t*c+q*b-r*a,i=t*d-q*a-r*b-s*c;if(z){var x=Math.sin(z)/k(a=u,b=v,c=w);a*=x,b*=x,c*=x,d=Math.cos(j),f=f*d+i*a+g*c-h*b,g=g*d+i*b+h*a-f*c,h=h*d+i*c+f*b-g*a,i=i*d-f*a-g*b-h*c}var o=l(f,g,h,i);o>1e-6?(f/=o,g/=o,h/=o,i/=o):(f=g=h=0,i=1),this.rotation.set(y,f,g,h,i)},a.lookAt=function(d,e,b,h){this.recalcMatrix(d),b=b||this.computedCenter,e=e||this.computedEye,h=h||this.computedUp;var a=this.computedMatrix;g(a,e,b,h);var c=this.computedRotation;j(c,a[0],a[1],a[2],a[4],a[5],a[6],a[8],a[9],a[10]),m(c,c),this.rotation.set(d,c[0],c[1],c[2],c[3]);for(var i=0,f=0;f<3;++f)i+=Math.pow(b[f]-e[f],2);this.radius.set(d,.5*Math.log(Math.max(i,1e-6))),this.center.set(d,b[0],b[1],b[2])},a.translate=function(a,b,c,d){this.center.move(a,b||0,c||0,d||0)},a.setMatrix=function(d,a){var c=this.computedRotation;j(c,a[0],a[1],a[2],a[4],a[5],a[6],a[8],a[9],a[10]),m(c,c),this.rotation.set(d,c[0],c[1],c[2],c[3]);var b=this.computedMatrix;i(b,a);var e=b[15];if(Math.abs(e)>1e-6){var g=b[12]/e,h=b[13]/e,k=b[14]/e;this.recalcMatrix(d);var f=Math.exp(this.computedRadius[0]);this.center.set(d,g-b[2]*f,h-b[6]*f,k-b[10]*f),this.radius.idle(d)}else this.center.idle(d),this.radius.idle(d)},a.setDistance=function(b,a){a>0&&this.radius.set(b,Math.log(a))},a.setDistanceLimits=function(b,a){b=b>0?Math.log(b):-1/0,a=a>0?Math.log(a):1/0,a=Math.max(a,b),this.radius.bounds[0][0]=b,this.radius.bounds[1][0]=a},a.getDistanceLimits=function(a){var b=this.radius.bounds;return a?(a[0]=Math.exp(b[0][0]),a[1]=Math.exp(b[1][0]),a):[Math.exp(b[0][0]),Math.exp(b[1][0])]},a.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},a.fromJSON=function(a){var d=this.lastT(),c=a.center;c&&this.center.set(d,c[0],c[1],c[2]);var b=a.rotation;b&&this.rotation.set(d,b[0],b[1],b[2],b[3]);var e=a.distance;e&&e>0&&this.radius.set(d,Math.log(e)),this.setDistanceLimits(a.zoomMin,a.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(a,b,c){"use strict";var d=a("repeat-string");b.exports=function(b,c,a){return d(a=void 0!==a?a+"":" ",c)+b}},{"repeat-string":277}],265:[function(b,a,c){a.exports=function(b,a){a||(a=[0,""]);var c=parseFloat(b=String(b),10);return a[0]=c,a[1]=b.match(/[\d.\-\+]*\s*(.*)/)[1]||"",a}},{}],266:[function(a,b,c){"use strict";b.exports=function(j,k){for(var e=0|k.length,l=j.length,b=[new Array(e),new Array(e)],a=0;a<e;++a)b[0][a]=[],b[1][a]=[];for(var a=0;a<l;++a){var f=j[a];b[0][f[0]].push(f),b[1][f[1]].push(f)}for(var g=[],a=0;a<e;++a)b[0][a].length+b[1][a].length===0&&g.push([a]);function o(a,c){var d=b[c][a[c]];d.splice(d.indexOf(a),1)}function p(n,f,p){for(var a,g,h,c=0;c<2;++c)if(b[c][f].length>0){a=b[c][f][0],h=c;break}g=a[1^h];for(var e=0;e<2;++e)for(var j=b[e][f],i=0;i<j.length;++i){var l=j[i],m=l[1^e];d(k[n],k[f],k[g],k[m])>0&&(a=l,g=m,h=e)}return p||a&&o(a,h),g}function m(c,f){var i=b[f][c][0],a=[c];o(i,f);for(var e=i[1^f];;){for(;e!==c;)a.push(e),e=p(a[a.length-2],e,!1);if(b[0][c].length+b[1][c].length===0)break;var g=a[a.length-1],h=c,j=a[1],l=p(g,h,!0);if(0>d(k[g],k[h],k[j],k[l]))break;a.push(c),e=p(g,h)}return a}function n(b,a){return a[1]===a[a.length-1]}for(var a=0;a<e;++a)for(var h=0;h<2;++h){for(var c=[];b[h][a].length>0;){b[0][a].length;var i=m(a,h);n(c,i)?c.push.apply(c,i):(c.length>0&&g.push(c),c=i)}c.length>0&&g.push(c)}return g};var d=a("compare-angle")},{"compare-angle":54}],267:[function(a,b,c){"use strict";b.exports=function(i,b){for(var k=d(i,b.length),c=new Array(b.length),l=new Array(b.length),e=[],a=0;a<b.length;++a){var m=k[a].length;l[a]=m,c[a]=!0,m<=1&&e.push(a)}for(;e.length>0;){var f=e.pop();c[f]=!1;for(var n=k[f],a=0;a<n.length;++a){var o=n[a];0== --l[o]&&e.push(o)}}for(var g=new Array(b.length),j=[],a=0;a<b.length;++a)if(c[a]){var f=j.length;g[a]=f,j.push(b[a])}else g[a]=-1;for(var p=[],a=0;a<i.length;++a){var h=i[a];c[h[0]]&&c[h[1]]&&p.push([g[h[0]],g[h[1]]])}return[p,j]};var d=a("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(a,b,c){"use strict";b.exports=function(p,q){var r=j(p,q);p=r[0];var J=(q=r[1]).length;p.length;for(var O=d(p,q.length),a=0;a<J;++a)if(O[a].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");for(var n=e(p,q),c=(n=n.filter(function(e){for(var f=e.length,a=[0],b=0;b<f;++b){var c=q[e[b]],d=q[e[(b+1)%f]],i=g(-c[0],c[1]),j=g(-c[0],d[1]),k=g(d[0],c[1]),l=g(d[0],d[1]);a=h(a,h(h(i,j),h(k,l)))}return a[a.length-1]>0})).length,s=new Array(c),z=new Array(c),a=0;a<c;++a){s[a]=a;var o=new Array(c),P=f([n[a].map(function(a){return q[a]})]),A=0;outer:for(var b=0;b<c;++b)if(o[b]=0,a!==b){for(var m=n[b],v=m.length,B=0;B<v;++B){var K=P(q[m[B]]);if(0!==K){K<0&&(o[b]=1,A+=1);continue outer}}o[b]=1,A+=1}z[a]=[A,a,o]}z.sort(function(a,b){return b[0]-a[0]});for(var a=0;a<c;++a)for(var o=z[a],Q=o[1],R=o[2],b=0;b<c;++b)R[b]&&(s[b]=Q);for(var t=l(c),a=0;a<c;++a)t[a].push(s[a]),t[s[a]].push(a);for(var C={},L=k(J,!1),a=0;a<c;++a)for(var m=n[a],v=m.length,b=0;b<v;++b){var D=m[b],E=m[(b+1)%v],F=Math.min(D,E)+":"+Math.max(D,E);if(F in C){var M=C[F];t[M].push(a),t[a].push(M),L[D]=L[E]=!0}else C[F]=a}function N(b){for(var c=b.length,a=0;a<c;++a)if(!L[b[a]])return!1;return!0}for(var w=[],u=k(c,-1),a=0;a<c;++a)s[a]!==a||N(n[a])?u[a]=-1:(w.push(a),u[a]=0);for(var r=[];w.length>0;){var G,H=w.pop(),I=t[H];i(I,function(a,b){return a-b});var S=I.length,x=u[H];if(0===x){var m=n[H];G=[m]}for(var a=0;a<S;++a){var y=I[a];if(!(u[y]>=0)&&(u[y]=1^x,w.push(y),0===x)){var m=n[y];N(m)||(m.reverse(),G.push(m))}}0===x&&r.push(G)}return r};var d=a("edges-to-adjacency-list"),e=a("planar-dual"),f=a("point-in-big-polygon"),g=a("two-product"),h=a("robust-sum"),i=a("uniq"),j=a("./lib/trim-leaves");function k(b,d){for(var c=new Array(b),a=0;a<b;++a)c[a]=d;return c}function l(b){for(var c=new Array(b),a=0;a<b;++a)c[a]=[];return c}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(a,b,c){b.exports=function(l){for(var q,r,s=l.length,b=[],a=[],c=0;c<s;++c)for(var f=l[c],m=f.length,n=m-1,h=0;h<m;n=h++){var j=f[n],k=f[h];j[0]===k[0]?a.push([j,k]):b.push([j,k])}if(0===b.length)return 0===a.length?function(a){return 1}:(v=i(a),function(a){return v(a[0],a[1])?0:1});var v,t,u,o=e(b),p=(t=o.slabs,u=o.coordinates,function(f){var b=g.le(u,f[0]);if(b<0)return 1;var a=t[b];if(!a){if(!(b>0)||u[b]!==f[0])return 1;a=t[b-1]}for(var h=1;a;){var c=a.key,e=d(f,c[0],c[1]);if(c[0][0]<c[1][0])if(e<0)a=a.left;else{if(!(e>0))return 0;h=-1,a=a.right}else if(e>0)a=a.left;else{if(!(e<0))return 0;h=1,a=a.right}}return h});return 0===a.length?p:(q=i(a),r=p,function(a){return q(a[0],a[1])?0:r(a)})};var d=a("robust-orientation")[3],e=a("slab-decomposition"),f=a("interval-tree-1d"),g=a("binary-search-bounds");function h(){return!0}function i(g){for(var m,b={},a=0;a<g.length;++a){var c=g[a],d=c[0][0],i=c[0][1],j=c[1][1],k=[Math.min(i,j),Math.max(i,j)];d in b?b[d].push(k):b[d]=[k]}for(var l={},e=Object.keys(b),a=0;a<e.length;++a){var n=b[e[a]];l[e[a]]=f(n)}return m=l,function(b,c){var a=m[b];return!!a&&!!a.queryPoint(c,h)}}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(b,a,c){"use strict";var d=new Float64Array(4),e=new Float64Array(4),f=new Float64Array(4);a.exports=function(s,w,x,n,A){d.length<n.length&&(d=new Float64Array(n.length),e=new Float64Array(n.length),f=new Float64Array(n.length));for(var g,p,q,o,r,h=0;h<n.length;++h)d[h]=s[h]-n[h],e[h]=w[h]-s[h],f[h]=x[h]-s[h];for(var j=0,l=0,m=0,c=0,k=0,i=0,h=0;h<n.length;++h){var t=e[h],u=f[h],v=d[h];j+=t*t,l+=t*u,m+=u*u,c+=v*t,k+=v*u,i+=v*v}var y=Math.abs(j*m-l*l),a=l*k-m*c,b=l*c-j*k;if(a+b<=y)if(a<0)b<0&&c<0?(b=0,-c>=j?(a=1,g=j+2*c+i):(a=-c/j,g=c*a+i)):(a=0,k>=0?(b=0,g=i):-k>=m?(b=1,g=m+2*k+i):(b=-k/m,g=k*b+i));else if(b<0)b=0,c>=0?(a=0,g=i):-c>=j?(a=1,g=j+2*c+i):(a=-c/j,g=c*a+i);else{var z=1/y;a*=z,b*=z,g=a*(j*a+l*b+2*c)+b*(l*a+m*b+2*k)+i}else a<0?(p=l+c,(q=m+k)>p?(o=q-p)>=(r=j-2*l+m)?(a=1,b=0,g=j+2*c+i):(b=1-(a=o/r),g=a*(j*a+l*b+2*c)+b*(l*a+m*b+2*k)+i):(a=0,q<=0?(b=1,g=m+2*k+i):k>=0?(b=0,g=i):(b=-k/m,g=k*b+i))):b<0?(p=l+k,(q=j+c)>p?(o=q-p)>=(r=j-2*l+m)?(b=1,a=0,g=m+2*k+i):g=(a=1-(b=o/r))*(j*a+l*b+2*c)+b*(l*a+m*b+2*k)+i:(b=0,q<=0?(a=1,g=j+2*c+i):c>=0?(a=0,g=i):(a=-c/j,g=c*a+i))):(o=m+k-l-c)<=0?(a=0,b=1,g=m+2*k+i):o>=(r=j-2*l+m)?(a=1,b=0,g=j+2*c+i):(b=1-(a=o/r),g=a*(j*a+l*b+2*c)+b*(l*a+m*b+2*k)+i);for(var B=1-a-b,h=0;h<n.length;++h)A[h]=B*s[h]+a*w[h]+b*x[h];return g<0?0:g}},{}],271:[function(a,b,c){b.exports=a("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(a,b,c){"use strict";var d=a("big-rat/add");b.exports=function(b,f){for(var c=b.length,e=new Array(c),a=0;a<c;++a)e[a]=d(b[a],f[a]);return e}},{"big-rat/add":15}],273:[function(a,b,c){"use strict";b.exports=function(b){for(var c=new Array(b.length),a=0;a<b.length;++a)c[a]=d(b[a]);return c};var d=a("big-rat")},{"big-rat":18}],274:[function(a,b,c){"use strict";var d=a("big-rat"),e=a("big-rat/mul");b.exports=function(b,g){for(var h=d(g),c=b.length,f=new Array(c),a=0;a<c;++a)f[a]=e(b[a],h);return f}},{"big-rat":18,"big-rat/mul":27}],275:[function(a,b,c){"use strict";var d=a("big-rat/sub");b.exports=function(b,f){for(var c=b.length,e=new Array(c),a=0;a<c;++a)e[a]=d(b[a],f[a]);return e}},{"big-rat/sub":29}],276:[function(a,b,c){"use strict";var d=a("compare-cell"),e=a("compare-oriented-cell"),f=a("cell-orientation");b.exports=function(a){a.sort(e);for(var j=a.length,b=0,c=0;c<j;++c){var g=a[c],h=f(g);if(0!==h){if(b>0){var i=a[b-1];if(0===d(g,i)&&f(i)!==h){b-=1;continue}}a[b++]=g}}return a.length=b,a}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(b,a,c){"use strict";var d,e="";a.exports=function(a,b){if("string"!=typeof a)throw new TypeError("expected a string");if(1===b)return a;if(2===b)return a+a;var c=a.length*b;if(d!==a|| void 0===d)d=a,e="";else if(e.length>=c)return e.substr(0,c);for(;c>e.length&&b>1;)1&b&&(e+=a),b>>=1,a+=a;return e+=a,e=e.substr(0,c)}},{}],278:[function(a,b,d){(function(a){(function(){b.exports=a.performance&&a.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,void 0!==c?c:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],279:[function(b,a,c){"use strict";a.exports=function(a){for(var g=a.length,b=a[a.length-1],j=g,c=g-2;c>=0;--c){var d=b,e=a[c],h=(b=d+e)-d,f=e-h;f&&(a[--j]=b,b=f)}for(var i=0,c=j;c<g;++c){var d=a[c],e=b,h=(b=d+e)-d,f=e-h;f&&(a[i++]=f)}return a[i++]=b,a.length=i,a}},{}],280:[function(a,b,c){"use strict";var d=a("two-product"),e=a("robust-sum"),f=a("robust-scale"),g=a("robust-compress");function h(a,b,c,d){return function(b){return d(a(c(b[0][0],b[1][1]),c(-b[0][1],b[1][0])))}}function i(a,b,c,d){return function(e){return d(a(b(a(c(e[1][1],e[2][2]),c(-e[1][2],e[2][1])),e[0][0]),a(b(a(c(e[1][0],e[2][2]),c(-e[1][2],e[2][0])),-e[0][1]),b(a(c(e[1][0],e[2][1]),c(-e[1][1],e[2][0])),e[0][2]))))}}function j(a,b,c,d){return function(e){return d(a(a(b(a(b(a(c(e[2][2],e[3][3]),c(-e[2][3],e[3][2])),e[1][1]),a(b(a(c(e[2][1],e[3][3]),c(-e[2][3],e[3][1])),-e[1][2]),b(a(c(e[2][1],e[3][2]),c(-e[2][2],e[3][1])),e[1][3]))),e[0][0]),b(a(b(a(c(e[2][2],e[3][3]),c(-e[2][3],e[3][2])),e[1][0]),a(b(a(c(e[2][0],e[3][3]),c(-e[2][3],e[3][0])),-e[1][2]),b(a(c(e[2][0],e[3][2]),c(-e[2][2],e[3][0])),e[1][3]))),-e[0][1])),a(b(a(b(a(c(e[2][1],e[3][3]),c(-e[2][3],e[3][1])),e[1][0]),a(b(a(c(e[2][0],e[3][3]),c(-e[2][3],e[3][0])),-e[1][1]),b(a(c(e[2][0],e[3][1]),c(-e[2][1],e[3][0])),e[1][3]))),e[0][2]),b(a(b(a(c(e[2][1],e[3][2]),c(-e[2][2],e[3][1])),e[1][0]),a(b(a(c(e[2][0],e[3][2]),c(-e[2][2],e[3][0])),-e[1][1]),b(a(c(e[2][0],e[3][1]),c(-e[2][1],e[3][0])),e[1][2]))),-e[0][3]))))}}function k(a,b,c,d){return function(e){return d(a(a(b(a(a(b(a(b(a(c(e[3][3],e[4][4]),c(-e[3][4],e[4][3])),e[2][2]),a(b(a(c(e[3][2],e[4][4]),c(-e[3][4],e[4][2])),-e[2][3]),b(a(c(e[3][2],e[4][3]),c(-e[3][3],e[4][2])),e[2][4]))),e[1][1]),b(a(b(a(c(e[3][3],e[4][4]),c(-e[3][4],e[4][3])),e[2][1]),a(b(a(c(e[3][1],e[4][4]),c(-e[3][4],e[4][1])),-e[2][3]),b(a(c(e[3][1],e[4][3]),c(-e[3][3],e[4][1])),e[2][4]))),-e[1][2])),a(b(a(b(a(c(e[3][2],e[4][4]),c(-e[3][4],e[4][2])),e[2][1]),a(b(a(c(e[3][1],e[4][4]),c(-e[3][4],e[4][1])),-e[2][2]),b(a(c(e[3][1],e[4][2]),c(-e[3][2],e[4][1])),e[2][4]))),e[1][3]),b(a(b(a(c(e[3][2],e[4][3]),c(-e[3][3],e[4][2])),e[2][1]),a(b(a(c(e[3][1],e[4][3]),c(-e[3][3],e[4][1])),-e[2][2]),b(a(c(e[3][1],e[4][2]),c(-e[3][2],e[4][1])),e[2][3]))),-e[1][4]))),e[0][0]),b(a(a(b(a(b(a(c(e[3][3],e[4][4]),c(-e[3][4],e[4][3])),e[2][2]),a(b(a(c(e[3][2],e[4][4]),c(-e[3][4],e[4][2])),-e[2][3]),b(a(c(e[3][2],e[4][3]),c(-e[3][3],e[4][2])),e[2][4]))),e[1][0]),b(a(b(a(c(e[3][3],e[4][4]),c(-e[3][4],e[4][3])),e[2][0]),a(b(a(c(e[3][0],e[4][4]),c(-e[3][4],e[4][0])),-e[2][3]),b(a(c(e[3][0],e[4][3]),c(-e[3][3],e[4][0])),e[2][4]))),-e[1][2])),a(b(a(b(a(c(e[3][2],e[4][4]),c(-e[3][4],e[4][2])),e[2][0]),a(b(a(c(e[3][0],e[4][4]),c(-e[3][4],e[4][0])),-e[2][2]),b(a(c(e[3][0],e[4][2]),c(-e[3][2],e[4][0])),e[2][4]))),e[1][3]),b(a(b(a(c(e[3][2],e[4][3]),c(-e[3][3],e[4][2])),e[2][0]),a(b(a(c(e[3][0],e[4][3]),c(-e[3][3],e[4][0])),-e[2][2]),b(a(c(e[3][0],e[4][2]),c(-e[3][2],e[4][0])),e[2][3]))),-e[1][4]))),-e[0][1])),a(b(a(a(b(a(b(a(c(e[3][3],e[4][4]),c(-e[3][4],e[4][3])),e[2][1]),a(b(a(c(e[3][1],e[4][4]),c(-e[3][4],e[4][1])),-e[2][3]),b(a(c(e[3][1],e[4][3]),c(-e[3][3],e[4][1])),e[2][4]))),e[1][0]),b(a(b(a(c(e[3][3],e[4][4]),c(-e[3][4],e[4][3])),e[2][0]),a(b(a(c(e[3][0],e[4][4]),c(-e[3][4],e[4][0])),-e[2][3]),b(a(c(e[3][0],e[4][3]),c(-e[3][3],e[4][0])),e[2][4]))),-e[1][1])),a(b(a(b(a(c(e[3][1],e[4][4]),c(-e[3][4],e[4][1])),e[2][0]),a(b(a(c(e[3][0],e[4][4]),c(-e[3][4],e[4][0])),-e[2][1]),b(a(c(e[3][0],e[4][1]),c(-e[3][1],e[4][0])),e[2][4]))),e[1][3]),b(a(b(a(c(e[3][1],e[4][3]),c(-e[3][3],e[4][1])),e[2][0]),a(b(a(c(e[3][0],e[4][3]),c(-e[3][3],e[4][0])),-e[2][1]),b(a(c(e[3][0],e[4][1]),c(-e[3][1],e[4][0])),e[2][3]))),-e[1][4]))),e[0][2]),a(b(a(a(b(a(b(a(c(e[3][2],e[4][4]),c(-e[3][4],e[4][2])),e[2][1]),a(b(a(c(e[3][1],e[4][4]),c(-e[3][4],e[4][1])),-e[2][2]),b(a(c(e[3][1],e[4][2]),c(-e[3][2],e[4][1])),e[2][4]))),e[1][0]),b(a(b(a(c(e[3][2],e[4][4]),c(-e[3][4],e[4][2])),e[2][0]),a(b(a(c(e[3][0],e[4][4]),c(-e[3][4],e[4][0])),-e[2][2]),b(a(c(e[3][0],e[4][2]),c(-e[3][2],e[4][0])),e[2][4]))),-e[1][1])),a(b(a(b(a(c(e[3][1],e[4][4]),c(-e[3][4],e[4][1])),e[2][0]),a(b(a(c(e[3][0],e[4][4]),c(-e[3][4],e[4][0])),-e[2][1]),b(a(c(e[3][0],e[4][1]),c(-e[3][1],e[4][0])),e[2][4]))),e[1][2]),b(a(b(a(c(e[3][1],e[4][2]),c(-e[3][2],e[4][1])),e[2][0]),a(b(a(c(e[3][0],e[4][2]),c(-e[3][2],e[4][0])),-e[2][1]),b(a(c(e[3][0],e[4][1]),c(-e[3][1],e[4][0])),e[2][2]))),-e[1][4]))),-e[0][3]),b(a(a(b(a(b(a(c(e[3][2],e[4][3]),c(-e[3][3],e[4][2])),e[2][1]),a(b(a(c(e[3][1],e[4][3]),c(-e[3][3],e[4][1])),-e[2][2]),b(a(c(e[3][1],e[4][2]),c(-e[3][2],e[4][1])),e[2][3]))),e[1][0]),b(a(b(a(c(e[3][2],e[4][3]),c(-e[3][3],e[4][2])),e[2][0]),a(b(a(c(e[3][0],e[4][3]),c(-e[3][3],e[4][0])),-e[2][2]),b(a(c(e[3][0],e[4][2]),c(-e[3][2],e[4][0])),e[2][3]))),-e[1][1])),a(b(a(b(a(c(e[3][1],e[4][3]),c(-e[3][3],e[4][1])),e[2][0]),a(b(a(c(e[3][0],e[4][3]),c(-e[3][3],e[4][0])),-e[2][1]),b(a(c(e[3][0],e[4][1]),c(-e[3][1],e[4][0])),e[2][3]))),e[1][2]),b(a(b(a(c(e[3][1],e[4][2]),c(-e[3][2],e[4][1])),e[2][0]),a(b(a(c(e[3][0],e[4][2]),c(-e[3][2],e[4][0])),-e[2][1]),b(a(c(e[3][0],e[4][1]),c(-e[3][1],e[4][0])),e[2][2]))),-e[1][3]))),e[0][4])))))}}function l(a){return(2===a?h:3===a?i:4===a?j:5===a?k:void 0)(e,f,d,g)}var m=[function(){return[0]},function(a){return[a[0][0]]}];function n(a,b,c,d,e,f,g,h){return function(i){switch(i.length){case 0:return a(i);case 1:return b(i);case 2:return c(i);case 3:return d(i);case 4:return e(i);case 5:return f(i)}var j=g[i.length];return j||(j=g[i.length]=h(i.length)),j(i)}}!function(){for(;m.length<6;)m.push(l(m.length));b.exports=n.apply(void 0,m.concat([m,l]));for(var a=0;a<m.length;++a)b.exports[a]=m[a]}()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(a,b,c){"use strict";var d=a("two-product"),e=a("robust-sum");b.exports=function(b,f){for(var c=d(b[0],f[0]),a=1;a<b.length;++a)c=e(c,d(b[a],f[a]));return c}},{"robust-sum":289,"two-product":306}],282:[function(a,b,c){"use strict";var d=a("two-product"),e=a("robust-sum"),f=a("robust-subtract"),g=a("robust-scale");function h(a){return(3===a?i:4===a?j:5===a?k:l)(e,f,d,g)}function i(a,b,c,d){return function(e,f,g){var h=c(e[0],e[0]),l=d(h,f[0]),m=d(h,g[0]),i=c(f[0],f[0]),n=d(i,e[0]),o=d(i,g[0]),j=c(g[0],g[0]),p=d(j,e[0]),q=d(j,f[0]),r=a(b(q,o),b(n,l)),s=b(p,m),k=b(r,s);return k[k.length-1]}}function j(a,b,c,d){return function(e,f,g,h){var i=a(c(e[0],e[0]),c(e[1],e[1])),m=d(i,f[0]),n=d(i,g[0]),o=d(i,h[0]),j=a(c(f[0],f[0]),c(f[1],f[1])),p=d(j,e[0]),q=d(j,g[0]),r=d(j,h[0]),k=a(c(g[0],g[0]),c(g[1],g[1])),s=d(k,e[0]),t=d(k,f[0]),u=d(k,h[0]),l=a(c(h[0],h[0]),c(h[1],h[1])),v=d(l,e[0]),w=d(l,f[0]),x=d(l,g[0]),z=a(a(d(b(x,u),f[1]),a(d(b(w,r),-g[1]),d(b(t,q),h[1]))),a(d(b(w,r),e[1]),a(d(b(v,o),-f[1]),d(b(p,m),h[1])))),A=a(a(d(b(x,u),e[1]),a(d(b(v,o),-g[1]),d(b(s,n),h[1]))),a(d(b(t,q),e[1]),a(d(b(s,n),-f[1]),d(b(p,m),g[1])))),y=b(z,A);return y[y.length-1]}}function k(a,b,c,d){return function(e,f,g,h,i){var D=a(c(e[0],e[0]),a(c(e[1],e[1]),c(e[2],e[2]))),j=d(D,f[0]),k=d(D,g[0]),l=d(D,h[0]),m=d(D,i[0]),E=a(c(f[0],f[0]),a(c(f[1],f[1]),c(f[2],f[2]))),n=d(E,e[0]),o=d(E,g[0]),p=d(E,h[0]),q=d(E,i[0]),F=a(c(g[0],g[0]),a(c(g[1],g[1]),c(g[2],g[2]))),r=d(F,e[0]),s=d(F,f[0]),t=d(F,h[0]),u=d(F,i[0]),G=a(c(h[0],h[0]),a(c(h[1],h[1]),c(h[2],h[2]))),v=d(G,e[0]),w=d(G,f[0]),x=d(G,g[0]),y=d(G,i[0]),H=a(c(i[0],i[0]),a(c(i[1],i[1]),c(i[2],i[2]))),z=d(H,e[0]),A=d(H,f[0]),B=d(H,g[0]),C=d(H,h[0]),J=a(a(a(d(a(d(b(C,y),g[1]),a(d(b(B,u),-h[1]),d(b(x,t),i[1]))),f[2]),a(d(a(d(b(C,y),f[1]),a(d(b(A,q),-h[1]),d(b(w,p),i[1]))),-g[2]),d(a(d(b(B,u),f[1]),a(d(b(A,q),-g[1]),d(b(s,o),i[1]))),h[2]))),a(d(a(d(b(x,t),f[1]),a(d(b(w,p),-g[1]),d(b(s,o),h[1]))),-i[2]),a(d(a(d(b(C,y),f[1]),a(d(b(A,q),-h[1]),d(b(w,p),i[1]))),e[2]),d(a(d(b(C,y),e[1]),a(d(b(z,m),-h[1]),d(b(v,l),i[1]))),-f[2])))),a(a(d(a(d(b(A,q),e[1]),a(d(b(z,m),-f[1]),d(b(n,j),i[1]))),h[2]),a(d(a(d(b(w,p),e[1]),a(d(b(v,l),-f[1]),d(b(n,j),h[1]))),-i[2]),d(a(d(b(x,t),f[1]),a(d(b(w,p),-g[1]),d(b(s,o),h[1]))),e[2]))),a(d(a(d(b(x,t),e[1]),a(d(b(v,l),-g[1]),d(b(r,k),h[1]))),-f[2]),a(d(a(d(b(w,p),e[1]),a(d(b(v,l),-f[1]),d(b(n,j),h[1]))),g[2]),d(a(d(b(s,o),e[1]),a(d(b(r,k),-f[1]),d(b(n,j),g[1]))),-h[2]))))),K=a(a(a(d(a(d(b(C,y),g[1]),a(d(b(B,u),-h[1]),d(b(x,t),i[1]))),e[2]),d(a(d(b(C,y),e[1]),a(d(b(z,m),-h[1]),d(b(v,l),i[1]))),-g[2])),a(d(a(d(b(B,u),e[1]),a(d(b(z,m),-g[1]),d(b(r,k),i[1]))),h[2]),d(a(d(b(x,t),e[1]),a(d(b(v,l),-g[1]),d(b(r,k),h[1]))),-i[2]))),a(a(d(a(d(b(B,u),f[1]),a(d(b(A,q),-g[1]),d(b(s,o),i[1]))),e[2]),d(a(d(b(B,u),e[1]),a(d(b(z,m),-g[1]),d(b(r,k),i[1]))),-f[2])),a(d(a(d(b(A,q),e[1]),a(d(b(z,m),-f[1]),d(b(n,j),i[1]))),g[2]),d(a(d(b(s,o),e[1]),a(d(b(r,k),-f[1]),d(b(n,j),g[1]))),-i[2])))),I=b(J,K);return I[I.length-1]}}function l(a,b,c,d){return function(e,f,g,h,i,j){var O=a(a(c(e[0],e[0]),c(e[1],e[1])),a(c(e[2],e[2]),c(e[3],e[3]))),k=d(O,f[0]),l=d(O,g[0]),m=d(O,h[0]),n=d(O,i[0]),o=d(O,j[0]),P=a(a(c(f[0],f[0]),c(f[1],f[1])),a(c(f[2],f[2]),c(f[3],f[3]))),p=d(P,e[0]),q=d(P,g[0]),r=d(P,h[0]),s=d(P,i[0]),t=d(P,j[0]),Q=a(a(c(g[0],g[0]),c(g[1],g[1])),a(c(g[2],g[2]),c(g[3],g[3]))),u=d(Q,e[0]),v=d(Q,f[0]),w=d(Q,h[0]),x=d(Q,i[0]),y=d(Q,j[0]),R=a(a(c(h[0],h[0]),c(h[1],h[1])),a(c(h[2],h[2]),c(h[3],h[3]))),z=d(R,e[0]),A=d(R,f[0]),B=d(R,g[0]),C=d(R,i[0]),D=d(R,j[0]),S=a(a(c(i[0],i[0]),c(i[1],i[1])),a(c(i[2],i[2]),c(i[3],i[3]))),E=d(S,e[0]),F=d(S,f[0]),G=d(S,g[0]),H=d(S,h[0]),I=d(S,j[0]),T=a(a(c(j[0],j[0]),c(j[1],j[1])),a(c(j[2],j[2]),c(j[3],j[3]))),J=d(T,e[0]),K=d(T,f[0]),L=d(T,g[0]),M=d(T,h[0]),N=d(T,i[0]),V=a(a(a(d(a(a(d(a(d(b(N,I),h[1]),a(d(b(M,D),-i[1]),d(b(H,C),j[1]))),g[2]),d(a(d(b(N,I),g[1]),a(d(b(L,y),-i[1]),d(b(G,x),j[1]))),-h[2])),a(d(a(d(b(M,D),g[1]),a(d(b(L,y),-h[1]),d(b(B,w),j[1]))),i[2]),d(a(d(b(H,C),g[1]),a(d(b(G,x),-h[1]),d(b(B,w),i[1]))),-j[2]))),f[3]),a(d(a(a(d(a(d(b(N,I),h[1]),a(d(b(M,D),-i[1]),d(b(H,C),j[1]))),f[2]),d(a(d(b(N,I),f[1]),a(d(b(K,t),-i[1]),d(b(F,s),j[1]))),-h[2])),a(d(a(d(b(M,D),f[1]),a(d(b(K,t),-h[1]),d(b(A,r),j[1]))),i[2]),d(a(d(b(H,C),f[1]),a(d(b(F,s),-h[1]),d(b(A,r),i[1]))),-j[2]))),-g[3]),d(a(a(d(a(d(b(N,I),g[1]),a(d(b(L,y),-i[1]),d(b(G,x),j[1]))),f[2]),d(a(d(b(N,I),f[1]),a(d(b(K,t),-i[1]),d(b(F,s),j[1]))),-g[2])),a(d(a(d(b(L,y),f[1]),a(d(b(K,t),-g[1]),d(b(v,q),j[1]))),i[2]),d(a(d(b(G,x),f[1]),a(d(b(F,s),-g[1]),d(b(v,q),i[1]))),-j[2]))),h[3]))),a(a(d(a(a(d(a(d(b(M,D),g[1]),a(d(b(L,y),-h[1]),d(b(B,w),j[1]))),f[2]),d(a(d(b(M,D),f[1]),a(d(b(K,t),-h[1]),d(b(A,r),j[1]))),-g[2])),a(d(a(d(b(L,y),f[1]),a(d(b(K,t),-g[1]),d(b(v,q),j[1]))),h[2]),d(a(d(b(B,w),f[1]),a(d(b(A,r),-g[1]),d(b(v,q),h[1]))),-j[2]))),-i[3]),d(a(a(d(a(d(b(H,C),g[1]),a(d(b(G,x),-h[1]),d(b(B,w),i[1]))),f[2]),d(a(d(b(H,C),f[1]),a(d(b(F,s),-h[1]),d(b(A,r),i[1]))),-g[2])),a(d(a(d(b(G,x),f[1]),a(d(b(F,s),-g[1]),d(b(v,q),i[1]))),h[2]),d(a(d(b(B,w),f[1]),a(d(b(A,r),-g[1]),d(b(v,q),h[1]))),-i[2]))),j[3])),a(d(a(a(d(a(d(b(N,I),h[1]),a(d(b(M,D),-i[1]),d(b(H,C),j[1]))),f[2]),d(a(d(b(N,I),f[1]),a(d(b(K,t),-i[1]),d(b(F,s),j[1]))),-h[2])),a(d(a(d(b(M,D),f[1]),a(d(b(K,t),-h[1]),d(b(A,r),j[1]))),i[2]),d(a(d(b(H,C),f[1]),a(d(b(F,s),-h[1]),d(b(A,r),i[1]))),-j[2]))),e[3]),d(a(a(d(a(d(b(N,I),h[1]),a(d(b(M,D),-i[1]),d(b(H,C),j[1]))),e[2]),d(a(d(b(N,I),e[1]),a(d(b(J,o),-i[1]),d(b(E,n),j[1]))),-h[2])),a(d(a(d(b(M,D),e[1]),a(d(b(J,o),-h[1]),d(b(z,m),j[1]))),i[2]),d(a(d(b(H,C),e[1]),a(d(b(E,n),-h[1]),d(b(z,m),i[1]))),-j[2]))),-f[3])))),a(a(a(d(a(a(d(a(d(b(N,I),f[1]),a(d(b(K,t),-i[1]),d(b(F,s),j[1]))),e[2]),d(a(d(b(N,I),e[1]),a(d(b(J,o),-i[1]),d(b(E,n),j[1]))),-f[2])),a(d(a(d(b(K,t),e[1]),a(d(b(J,o),-f[1]),d(b(p,k),j[1]))),i[2]),d(a(d(b(F,s),e[1]),a(d(b(E,n),-f[1]),d(b(p,k),i[1]))),-j[2]))),h[3]),d(a(a(d(a(d(b(M,D),f[1]),a(d(b(K,t),-h[1]),d(b(A,r),j[1]))),e[2]),d(a(d(b(M,D),e[1]),a(d(b(J,o),-h[1]),d(b(z,m),j[1]))),-f[2])),a(d(a(d(b(K,t),e[1]),a(d(b(J,o),-f[1]),d(b(p,k),j[1]))),h[2]),d(a(d(b(A,r),e[1]),a(d(b(z,m),-f[1]),d(b(p,k),h[1]))),-j[2]))),-i[3])),a(d(a(a(d(a(d(b(H,C),f[1]),a(d(b(F,s),-h[1]),d(b(A,r),i[1]))),e[2]),d(a(d(b(H,C),e[1]),a(d(b(E,n),-h[1]),d(b(z,m),i[1]))),-f[2])),a(d(a(d(b(F,s),e[1]),a(d(b(E,n),-f[1]),d(b(p,k),i[1]))),h[2]),d(a(d(b(A,r),e[1]),a(d(b(z,m),-f[1]),d(b(p,k),h[1]))),-i[2]))),j[3]),d(a(a(d(a(d(b(M,D),g[1]),a(d(b(L,y),-h[1]),d(b(B,w),j[1]))),f[2]),d(a(d(b(M,D),f[1]),a(d(b(K,t),-h[1]),d(b(A,r),j[1]))),-g[2])),a(d(a(d(b(L,y),f[1]),a(d(b(K,t),-g[1]),d(b(v,q),j[1]))),h[2]),d(a(d(b(B,w),f[1]),a(d(b(A,r),-g[1]),d(b(v,q),h[1]))),-j[2]))),e[3]))),a(a(d(a(a(d(a(d(b(M,D),g[1]),a(d(b(L,y),-h[1]),d(b(B,w),j[1]))),e[2]),d(a(d(b(M,D),e[1]),a(d(b(J,o),-h[1]),d(b(z,m),j[1]))),-g[2])),a(d(a(d(b(L,y),e[1]),a(d(b(J,o),-g[1]),d(b(u,l),j[1]))),h[2]),d(a(d(b(B,w),e[1]),a(d(b(z,m),-g[1]),d(b(u,l),h[1]))),-j[2]))),-f[3]),d(a(a(d(a(d(b(M,D),f[1]),a(d(b(K,t),-h[1]),d(b(A,r),j[1]))),e[2]),d(a(d(b(M,D),e[1]),a(d(b(J,o),-h[1]),d(b(z,m),j[1]))),-f[2])),a(d(a(d(b(K,t),e[1]),a(d(b(J,o),-f[1]),d(b(p,k),j[1]))),h[2]),d(a(d(b(A,r),e[1]),a(d(b(z,m),-f[1]),d(b(p,k),h[1]))),-j[2]))),g[3])),a(d(a(a(d(a(d(b(L,y),f[1]),a(d(b(K,t),-g[1]),d(b(v,q),j[1]))),e[2]),d(a(d(b(L,y),e[1]),a(d(b(J,o),-g[1]),d(b(u,l),j[1]))),-f[2])),a(d(a(d(b(K,t),e[1]),a(d(b(J,o),-f[1]),d(b(p,k),j[1]))),g[2]),d(a(d(b(v,q),e[1]),a(d(b(u,l),-f[1]),d(b(p,k),g[1]))),-j[2]))),-h[3]),d(a(a(d(a(d(b(B,w),f[1]),a(d(b(A,r),-g[1]),d(b(v,q),h[1]))),e[2]),d(a(d(b(B,w),e[1]),a(d(b(z,m),-g[1]),d(b(u,l),h[1]))),-f[2])),a(d(a(d(b(A,r),e[1]),a(d(b(z,m),-f[1]),d(b(p,k),h[1]))),g[2]),d(a(d(b(v,q),e[1]),a(d(b(u,l),-f[1]),d(b(p,k),g[1]))),-h[2]))),j[3]))))),W=a(a(a(d(a(a(d(a(d(b(N,I),h[1]),a(d(b(M,D),-i[1]),d(b(H,C),j[1]))),g[2]),d(a(d(b(N,I),g[1]),a(d(b(L,y),-i[1]),d(b(G,x),j[1]))),-h[2])),a(d(a(d(b(M,D),g[1]),a(d(b(L,y),-h[1]),d(b(B,w),j[1]))),i[2]),d(a(d(b(H,C),g[1]),a(d(b(G,x),-h[1]),d(b(B,w),i[1]))),-j[2]))),e[3]),a(d(a(a(d(a(d(b(N,I),h[1]),a(d(b(M,D),-i[1]),d(b(H,C),j[1]))),e[2]),d(a(d(b(N,I),e[1]),a(d(b(J,o),-i[1]),d(b(E,n),j[1]))),-h[2])),a(d(a(d(b(M,D),e[1]),a(d(b(J,o),-h[1]),d(b(z,m),j[1]))),i[2]),d(a(d(b(H,C),e[1]),a(d(b(E,n),-h[1]),d(b(z,m),i[1]))),-j[2]))),-g[3]),d(a(a(d(a(d(b(N,I),g[1]),a(d(b(L,y),-i[1]),d(b(G,x),j[1]))),e[2]),d(a(d(b(N,I),e[1]),a(d(b(J,o),-i[1]),d(b(E,n),j[1]))),-g[2])),a(d(a(d(b(L,y),e[1]),a(d(b(J,o),-g[1]),d(b(u,l),j[1]))),i[2]),d(a(d(b(G,x),e[1]),a(d(b(E,n),-g[1]),d(b(u,l),i[1]))),-j[2]))),h[3]))),a(a(d(a(a(d(a(d(b(M,D),g[1]),a(d(b(L,y),-h[1]),d(b(B,w),j[1]))),e[2]),d(a(d(b(M,D),e[1]),a(d(b(J,o),-h[1]),d(b(z,m),j[1]))),-g[2])),a(d(a(d(b(L,y),e[1]),a(d(b(J,o),-g[1]),d(b(u,l),j[1]))),h[2]),d(a(d(b(B,w),e[1]),a(d(b(z,m),-g[1]),d(b(u,l),h[1]))),-j[2]))),-i[3]),d(a(a(d(a(d(b(H,C),g[1]),a(d(b(G,x),-h[1]),d(b(B,w),i[1]))),e[2]),d(a(d(b(H,C),e[1]),a(d(b(E,n),-h[1]),d(b(z,m),i[1]))),-g[2])),a(d(a(d(b(G,x),e[1]),a(d(b(E,n),-g[1]),d(b(u,l),i[1]))),h[2]),d(a(d(b(B,w),e[1]),a(d(b(z,m),-g[1]),d(b(u,l),h[1]))),-i[2]))),j[3])),a(d(a(a(d(a(d(b(N,I),g[1]),a(d(b(L,y),-i[1]),d(b(G,x),j[1]))),f[2]),d(a(d(b(N,I),f[1]),a(d(b(K,t),-i[1]),d(b(F,s),j[1]))),-g[2])),a(d(a(d(b(L,y),f[1]),a(d(b(K,t),-g[1]),d(b(v,q),j[1]))),i[2]),d(a(d(b(G,x),f[1]),a(d(b(F,s),-g[1]),d(b(v,q),i[1]))),-j[2]))),e[3]),d(a(a(d(a(d(b(N,I),g[1]),a(d(b(L,y),-i[1]),d(b(G,x),j[1]))),e[2]),d(a(d(b(N,I),e[1]),a(d(b(J,o),-i[1]),d(b(E,n),j[1]))),-g[2])),a(d(a(d(b(L,y),e[1]),a(d(b(J,o),-g[1]),d(b(u,l),j[1]))),i[2]),d(a(d(b(G,x),e[1]),a(d(b(E,n),-g[1]),d(b(u,l),i[1]))),-j[2]))),-f[3])))),a(a(a(d(a(a(d(a(d(b(N,I),f[1]),a(d(b(K,t),-i[1]),d(b(F,s),j[1]))),e[2]),d(a(d(b(N,I),e[1]),a(d(b(J,o),-i[1]),d(b(E,n),j[1]))),-f[2])),a(d(a(d(b(K,t),e[1]),a(d(b(J,o),-f[1]),d(b(p,k),j[1]))),i[2]),d(a(d(b(F,s),e[1]),a(d(b(E,n),-f[1]),d(b(p,k),i[1]))),-j[2]))),g[3]),d(a(a(d(a(d(b(L,y),f[1]),a(d(b(K,t),-g[1]),d(b(v,q),j[1]))),e[2]),d(a(d(b(L,y),e[1]),a(d(b(J,o),-g[1]),d(b(u,l),j[1]))),-f[2])),a(d(a(d(b(K,t),e[1]),a(d(b(J,o),-f[1]),d(b(p,k),j[1]))),g[2]),d(a(d(b(v,q),e[1]),a(d(b(u,l),-f[1]),d(b(p,k),g[1]))),-j[2]))),-i[3])),a(d(a(a(d(a(d(b(G,x),f[1]),a(d(b(F,s),-g[1]),d(b(v,q),i[1]))),e[2]),d(a(d(b(G,x),e[1]),a(d(b(E,n),-g[1]),d(b(u,l),i[1]))),-f[2])),a(d(a(d(b(F,s),e[1]),a(d(b(E,n),-f[1]),d(b(p,k),i[1]))),g[2]),d(a(d(b(v,q),e[1]),a(d(b(u,l),-f[1]),d(b(p,k),g[1]))),-i[2]))),j[3]),d(a(a(d(a(d(b(H,C),g[1]),a(d(b(G,x),-h[1]),d(b(B,w),i[1]))),f[2]),d(a(d(b(H,C),f[1]),a(d(b(F,s),-h[1]),d(b(A,r),i[1]))),-g[2])),a(d(a(d(b(G,x),f[1]),a(d(b(F,s),-g[1]),d(b(v,q),i[1]))),h[2]),d(a(d(b(B,w),f[1]),a(d(b(A,r),-g[1]),d(b(v,q),h[1]))),-i[2]))),e[3]))),a(a(d(a(a(d(a(d(b(H,C),g[1]),a(d(b(G,x),-h[1]),d(b(B,w),i[1]))),e[2]),d(a(d(b(H,C),e[1]),a(d(b(E,n),-h[1]),d(b(z,m),i[1]))),-g[2])),a(d(a(d(b(G,x),e[1]),a(d(b(E,n),-g[1]),d(b(u,l),i[1]))),h[2]),d(a(d(b(B,w),e[1]),a(d(b(z,m),-g[1]),d(b(u,l),h[1]))),-i[2]))),-f[3]),d(a(a(d(a(d(b(H,C),f[1]),a(d(b(F,s),-h[1]),d(b(A,r),i[1]))),e[2]),d(a(d(b(H,C),e[1]),a(d(b(E,n),-h[1]),d(b(z,m),i[1]))),-f[2])),a(d(a(d(b(F,s),e[1]),a(d(b(E,n),-f[1]),d(b(p,k),i[1]))),h[2]),d(a(d(b(A,r),e[1]),a(d(b(z,m),-f[1]),d(b(p,k),h[1]))),-i[2]))),g[3])),a(d(a(a(d(a(d(b(G,x),f[1]),a(d(b(F,s),-g[1]),d(b(v,q),i[1]))),e[2]),d(a(d(b(G,x),e[1]),a(d(b(E,n),-g[1]),d(b(u,l),i[1]))),-f[2])),a(d(a(d(b(F,s),e[1]),a(d(b(E,n),-f[1]),d(b(p,k),i[1]))),g[2]),d(a(d(b(v,q),e[1]),a(d(b(u,l),-f[1]),d(b(p,k),g[1]))),-i[2]))),-h[3]),d(a(a(d(a(d(b(B,w),f[1]),a(d(b(A,r),-g[1]),d(b(v,q),h[1]))),e[2]),d(a(d(b(B,w),e[1]),a(d(b(z,m),-g[1]),d(b(u,l),h[1]))),-f[2])),a(d(a(d(b(A,r),e[1]),a(d(b(z,m),-f[1]),d(b(p,k),h[1]))),g[2]),d(a(d(b(v,q),e[1]),a(d(b(u,l),-f[1]),d(b(p,k),g[1]))),-h[2]))),i[3]))))),U=b(V,W);return U[U.length-1]}}var m=[function(){return 0},function(){return 0},function(){return 0}];function n(a){var b=m[a.length];return b||(b=m[a.length]=h(a.length)),b.apply(void 0,a)}function o(a,b,c,d,e,f,g,h){return function(b,c,i,k,l,n){switch(arguments.length){case 0:case 1:return 0;case 2:return d(b,c);case 3:return e(b,c,i);case 4:return f(b,c,i,k);case 5:return g(b,c,i,k,l);case 6:return h(b,c,i,k,l,n)}for(var m=new Array(arguments.length),j=0;j<arguments.length;++j)m[j]=arguments[j];return a(m)}}!function(){for(;m.length<=6;)m.push(h(m.length));b.exports=o.apply(void 0,[n].concat(m));for(var a=0;a<=6;++a)b.exports[a]=m[a]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(a,b,c){"use strict";var d=a("robust-determinant");function e(a){return(2===a?f:3===a?g:4===a?h:5===a?i:j)(a<6?d[a]:d)}function f(a){return function(b,c){return[a([[+c[0],+b[0][1]],[+c[1],+b[1][1]]]),a([[+b[0][0],+c[0]],[+b[1][0],+c[1]]]),a(b)]}}function g(a){return function(b,c){return[a([[+c[0],+b[0][1],+b[0][2]],[+c[1],+b[1][1],+b[1][2]],[+c[2],+b[2][1],+b[2][2]]]),a([[+b[0][0],+c[0],+b[0][2]],[+b[1][0],+c[1],+b[1][2]],[+b[2][0],+c[2],+b[2][2]]]),a([[+b[0][0],+b[0][1],+c[0]],[+b[1][0],+b[1][1],+c[1]],[+b[2][0],+b[2][1],+c[2]]]),a(b)]}}function h(a){return function(b,c){return[a([[+c[0],+b[0][1],+b[0][2],+b[0][3]],[+c[1],+b[1][1],+b[1][2],+b[1][3]],[+c[2],+b[2][1],+b[2][2],+b[2][3]],[+c[3],+b[3][1],+b[3][2],+b[3][3]]]),a([[+b[0][0],+c[0],+b[0][2],+b[0][3]],[+b[1][0],+c[1],+b[1][2],+b[1][3]],[+b[2][0],+c[2],+b[2][2],+b[2][3]],[+b[3][0],+c[3],+b[3][2],+b[3][3]]]),a([[+b[0][0],+b[0][1],+c[0],+b[0][3]],[+b[1][0],+b[1][1],+c[1],+b[1][3]],[+b[2][0],+b[2][1],+c[2],+b[2][3]],[+b[3][0],+b[3][1],+c[3],+b[3][3]]]),a([[+b[0][0],+b[0][1],+b[0][2],+c[0]],[+b[1][0],+b[1][1],+b[1][2],+c[1]],[+b[2][0],+b[2][1],+b[2][2],+c[2]],[+b[3][0],+b[3][1],+b[3][2],+c[3]]]),a(b)]}}function i(a){return function(b,c){return[a([[+c[0],+b[0][1],+b[0][2],+b[0][3],+b[0][4]],[+c[1],+b[1][1],+b[1][2],+b[1][3],+b[1][4]],[+c[2],+b[2][1],+b[2][2],+b[2][3],+b[2][4]],[+c[3],+b[3][1],+b[3][2],+b[3][3],+b[3][4]],[+c[4],+b[4][1],+b[4][2],+b[4][3],+b[4][4]]]),a([[+b[0][0],+c[0],+b[0][2],+b[0][3],+b[0][4]],[+b[1][0],+c[1],+b[1][2],+b[1][3],+b[1][4]],[+b[2][0],+c[2],+b[2][2],+b[2][3],+b[2][4]],[+b[3][0],+c[3],+b[3][2],+b[3][3],+b[3][4]],[+b[4][0],+c[4],+b[4][2],+b[4][3],+b[4][4]]]),a([[+b[0][0],+b[0][1],+c[0],+b[0][3],+b[0][4]],[+b[1][0],+b[1][1],+c[1],+b[1][3],+b[1][4]],[+b[2][0],+b[2][1],+c[2],+b[2][3],+b[2][4]],[+b[3][0],+b[3][1],+c[3],+b[3][3],+b[3][4]],[+b[4][0],+b[4][1],+c[4],+b[4][3],+b[4][4]]]),a([[+b[0][0],+b[0][1],+b[0][2],+c[0],+b[0][4]],[+b[1][0],+b[1][1],+b[1][2],+c[1],+b[1][4]],[+b[2][0],+b[2][1],+b[2][2],+c[2],+b[2][4]],[+b[3][0],+b[3][1],+b[3][2],+c[3],+b[3][4]],[+b[4][0],+b[4][1],+b[4][2],+c[4],+b[4][4]]]),a([[+b[0][0],+b[0][1],+b[0][2],+b[0][3],+c[0]],[+b[1][0],+b[1][1],+b[1][2],+b[1][3],+c[1]],[+b[2][0],+b[2][1],+b[2][2],+b[2][3],+c[2]],[+b[3][0],+b[3][1],+b[3][2],+b[3][3],+c[3]],[+b[4][0],+b[4][1],+b[4][2],+b[4][3],+c[4]]]),a(b)]}}function j(a){return function(b,c){return[a([[+c[0],+b[0][1],+b[0][2],+b[0][3],+b[0][4],+b[0][5]],[+c[1],+b[1][1],+b[1][2],+b[1][3],+b[1][4],+b[1][5]],[+c[2],+b[2][1],+b[2][2],+b[2][3],+b[2][4],+b[2][5]],[+c[3],+b[3][1],+b[3][2],+b[3][3],+b[3][4],+b[3][5]],[+c[4],+b[4][1],+b[4][2],+b[4][3],+b[4][4],+b[4][5]],[+c[5],+b[5][1],+b[5][2],+b[5][3],+b[5][4],+b[5][5]]]),a([[+b[0][0],+c[0],+b[0][2],+b[0][3],+b[0][4],+b[0][5]],[+b[1][0],+c[1],+b[1][2],+b[1][3],+b[1][4],+b[1][5]],[+b[2][0],+c[2],+b[2][2],+b[2][3],+b[2][4],+b[2][5]],[+b[3][0],+c[3],+b[3][2],+b[3][3],+b[3][4],+b[3][5]],[+b[4][0],+c[4],+b[4][2],+b[4][3],+b[4][4],+b[4][5]],[+b[5][0],+c[5],+b[5][2],+b[5][3],+b[5][4],+b[5][5]]]),a([[+b[0][0],+b[0][1],+c[0],+b[0][3],+b[0][4],+b[0][5]],[+b[1][0],+b[1][1],+c[1],+b[1][3],+b[1][4],+b[1][5]],[+b[2][0],+b[2][1],+c[2],+b[2][3],+b[2][4],+b[2][5]],[+b[3][0],+b[3][1],+c[3],+b[3][3],+b[3][4],+b[3][5]],[+b[4][0],+b[4][1],+c[4],+b[4][3],+b[4][4],+b[4][5]],[+b[5][0],+b[5][1],+c[5],+b[5][3],+b[5][4],+b[5][5]]]),a([[+b[0][0],+b[0][1],+b[0][2],+c[0],+b[0][4],+b[0][5]],[+b[1][0],+b[1][1],+b[1][2],+c[1],+b[1][4],+b[1][5]],[+b[2][0],+b[2][1],+b[2][2],+c[2],+b[2][4],+b[2][5]],[+b[3][0],+b[3][1],+b[3][2],+c[3],+b[3][4],+b[3][5]],[+b[4][0],+b[4][1],+b[4][2],+c[4],+b[4][4],+b[4][5]],[+b[5][0],+b[5][1],+b[5][2],+c[5],+b[5][4],+b[5][5]]]),a([[+b[0][0],+b[0][1],+b[0][2],+b[0][3],+c[0],+b[0][5]],[+b[1][0],+b[1][1],+b[1][2],+b[1][3],+c[1],+b[1][5]],[+b[2][0],+b[2][1],+b[2][2],+b[2][3],+c[2],+b[2][5]],[+b[3][0],+b[3][1],+b[3][2],+b[3][3],+c[3],+b[3][5]],[+b[4][0],+b[4][1],+b[4][2],+b[4][3],+c[4],+b[4][5]],[+b[5][0],+b[5][1],+b[5][2],+b[5][3],+c[5],+b[5][5]]]),a([[+b[0][0],+b[0][1],+b[0][2],+b[0][3],+b[0][4],+c[0]],[+b[1][0],+b[1][1],+b[1][2],+b[1][3],+b[1][4],+c[1]],[+b[2][0],+b[2][1],+b[2][2],+b[2][3],+b[2][4],+c[2]],[+b[3][0],+b[3][1],+b[3][2],+b[3][3],+b[3][4],+c[3]],[+b[4][0],+b[4][1],+b[4][2],+b[4][3],+b[4][4],+c[4]],[+b[5][0],+b[5][1],+b[5][2],+b[5][3],+b[5][4],+c[5]]]),a(b)]}}var k=[function(){return[[0]]},function(a,b){return[[b[0]],[a[0][0]]]}];function l(a,b,c,d,e,f,g,h){return function(i,j){switch(i.length){case 0:return a(i,j);case 1:return b(i,j);case 2:return c(i,j);case 3:return d(i,j);case 4:return e(i,j);case 5:return f(i,j)}var k=g[i.length];return k||(k=g[i.length]=h(i.length)),k(i,j)}}!function(){for(;k.length<6;)k.push(e(k.length));b.exports=l.apply(void 0,k.concat([k,e]));for(var a=0;a<6;++a)b.exports[a]=k[a]}()},{"robust-determinant":280}],284:[function(a,c,d){"use strict";var e=a("two-product"),f=a("robust-sum"),g=a("robust-scale"),h=a("robust-subtract");function i(a,b,c,d){return function(c,e,f){var h=a(a(b(e[1],f[0]),b(-f[1],e[0])),a(b(c[1],e[0]),b(-e[1],c[0]))),i=a(b(c[1],f[0]),b(-f[1],c[0])),g=d(h,i);return g[g.length-1]}}function j(a,b,c,d){return function(e,f,g,h){var j=a(a(c(a(b(g[1],h[0]),b(-h[1],g[0])),f[2]),a(c(a(b(f[1],h[0]),b(-h[1],f[0])),-g[2]),c(a(b(f[1],g[0]),b(-g[1],f[0])),h[2]))),a(c(a(b(f[1],h[0]),b(-h[1],f[0])),e[2]),a(c(a(b(e[1],h[0]),b(-h[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),h[2])))),k=a(a(c(a(b(g[1],h[0]),b(-h[1],g[0])),e[2]),a(c(a(b(e[1],h[0]),b(-h[1],e[0])),-g[2]),c(a(b(e[1],g[0]),b(-g[1],e[0])),h[2]))),a(c(a(b(f[1],g[0]),b(-g[1],f[0])),e[2]),a(c(a(b(e[1],g[0]),b(-g[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),g[2])))),i=d(j,k);return i[i.length-1]}}function k(a,b,c,d){return function(e,f,g,h,i){var k=a(a(a(c(a(c(a(b(h[1],i[0]),b(-i[1],h[0])),g[2]),a(c(a(b(g[1],i[0]),b(-i[1],g[0])),-h[2]),c(a(b(g[1],h[0]),b(-h[1],g[0])),i[2]))),f[3]),a(c(a(c(a(b(h[1],i[0]),b(-i[1],h[0])),f[2]),a(c(a(b(f[1],i[0]),b(-i[1],f[0])),-h[2]),c(a(b(f[1],h[0]),b(-h[1],f[0])),i[2]))),-g[3]),c(a(c(a(b(g[1],i[0]),b(-i[1],g[0])),f[2]),a(c(a(b(f[1],i[0]),b(-i[1],f[0])),-g[2]),c(a(b(f[1],g[0]),b(-g[1],f[0])),i[2]))),h[3]))),a(c(a(c(a(b(g[1],h[0]),b(-h[1],g[0])),f[2]),a(c(a(b(f[1],h[0]),b(-h[1],f[0])),-g[2]),c(a(b(f[1],g[0]),b(-g[1],f[0])),h[2]))),-i[3]),a(c(a(c(a(b(h[1],i[0]),b(-i[1],h[0])),f[2]),a(c(a(b(f[1],i[0]),b(-i[1],f[0])),-h[2]),c(a(b(f[1],h[0]),b(-h[1],f[0])),i[2]))),e[3]),c(a(c(a(b(h[1],i[0]),b(-i[1],h[0])),e[2]),a(c(a(b(e[1],i[0]),b(-i[1],e[0])),-h[2]),c(a(b(e[1],h[0]),b(-h[1],e[0])),i[2]))),-f[3])))),a(a(c(a(c(a(b(f[1],i[0]),b(-i[1],f[0])),e[2]),a(c(a(b(e[1],i[0]),b(-i[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),i[2]))),h[3]),a(c(a(c(a(b(f[1],h[0]),b(-h[1],f[0])),e[2]),a(c(a(b(e[1],h[0]),b(-h[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),h[2]))),-i[3]),c(a(c(a(b(g[1],h[0]),b(-h[1],g[0])),f[2]),a(c(a(b(f[1],h[0]),b(-h[1],f[0])),-g[2]),c(a(b(f[1],g[0]),b(-g[1],f[0])),h[2]))),e[3]))),a(c(a(c(a(b(g[1],h[0]),b(-h[1],g[0])),e[2]),a(c(a(b(e[1],h[0]),b(-h[1],e[0])),-g[2]),c(a(b(e[1],g[0]),b(-g[1],e[0])),h[2]))),-f[3]),a(c(a(c(a(b(f[1],h[0]),b(-h[1],f[0])),e[2]),a(c(a(b(e[1],h[0]),b(-h[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),h[2]))),g[3]),c(a(c(a(b(f[1],g[0]),b(-g[1],f[0])),e[2]),a(c(a(b(e[1],g[0]),b(-g[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),g[2]))),-h[3]))))),l=a(a(a(c(a(c(a(b(h[1],i[0]),b(-i[1],h[0])),g[2]),a(c(a(b(g[1],i[0]),b(-i[1],g[0])),-h[2]),c(a(b(g[1],h[0]),b(-h[1],g[0])),i[2]))),e[3]),c(a(c(a(b(h[1],i[0]),b(-i[1],h[0])),e[2]),a(c(a(b(e[1],i[0]),b(-i[1],e[0])),-h[2]),c(a(b(e[1],h[0]),b(-h[1],e[0])),i[2]))),-g[3])),a(c(a(c(a(b(g[1],i[0]),b(-i[1],g[0])),e[2]),a(c(a(b(e[1],i[0]),b(-i[1],e[0])),-g[2]),c(a(b(e[1],g[0]),b(-g[1],e[0])),i[2]))),h[3]),c(a(c(a(b(g[1],h[0]),b(-h[1],g[0])),e[2]),a(c(a(b(e[1],h[0]),b(-h[1],e[0])),-g[2]),c(a(b(e[1],g[0]),b(-g[1],e[0])),h[2]))),-i[3]))),a(a(c(a(c(a(b(g[1],i[0]),b(-i[1],g[0])),f[2]),a(c(a(b(f[1],i[0]),b(-i[1],f[0])),-g[2]),c(a(b(f[1],g[0]),b(-g[1],f[0])),i[2]))),e[3]),c(a(c(a(b(g[1],i[0]),b(-i[1],g[0])),e[2]),a(c(a(b(e[1],i[0]),b(-i[1],e[0])),-g[2]),c(a(b(e[1],g[0]),b(-g[1],e[0])),i[2]))),-f[3])),a(c(a(c(a(b(f[1],i[0]),b(-i[1],f[0])),e[2]),a(c(a(b(e[1],i[0]),b(-i[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),i[2]))),g[3]),c(a(c(a(b(f[1],g[0]),b(-g[1],f[0])),e[2]),a(c(a(b(e[1],g[0]),b(-g[1],e[0])),-f[2]),c(a(b(e[1],f[0]),b(-f[1],e[0])),g[2]))),-i[3])))),j=d(k,l);return j[j.length-1]}}function b(a){return(3===a?i:4===a?j:k)(f,e,g,h)}var l=b(3),m=b(4),n=[function(){return 0},function(){return 0},function(a,b){return b[0]-a[0]},function(e,f,b){var g,c=(e[1]-b[1])*(f[0]-b[0]),d=(e[0]-b[0])*(f[1]-b[1]),a=c-d;if(c>0){if(d<=0)return a;g=c+d}else{if(!(c<0))return a;if(d>=0)return a;g=-(c+d)}var h=33306690738754716e-32*g;return a>=h||a<= -h?a:l(e,f,b)},function(b,c,d,a){var f=b[0]-a[0],g=c[0]-a[0],h=d[0]-a[0],i=b[1]-a[1],j=c[1]-a[1],k=d[1]-a[1],l=b[2]-a[2],n=c[2]-a[2],o=d[2]-a[2],p=g*k,q=h*j,r=h*i,s=f*k,t=f*j,u=g*i,e=l*(p-q)+n*(r-s)+o*(t-u),v=7771561172376103e-31*((Math.abs(p)+Math.abs(q))*Math.abs(l)+(Math.abs(r)+Math.abs(s))*Math.abs(n)+(Math.abs(t)+Math.abs(u))*Math.abs(o));return e>v|| -e>v?e:m(b,c,d,a)}];function o(a){var c=n[a.length];return c||(c=n[a.length]=b(a.length)),c.apply(void 0,a)}function p(a,b,c,d,e,f,g){return function(b,c,i,j,l){switch(arguments.length){case 0:case 1:return 0;case 2:return d(b,c);case 3:return e(b,c,i);case 4:return f(b,c,i,j);case 5:return g(b,c,i,j,l)}for(var k=new Array(arguments.length),h=0;h<arguments.length;++h)k[h]=arguments[h];return a(k)}}!function(){for(;n.length<=5;)n.push(b(n.length));c.exports=p.apply(void 0,[o].concat(n));for(var a=0;a<=5;++a)c.exports[a]=n[a]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(a,b,c){"use strict";var d=a("robust-sum"),e=a("robust-scale");b.exports=function(a,b){if(1===a.length)return e(b,a[0]);if(1===b.length)return e(a,b[0]);if(0===a.length||0===b.length)return[0];var f=[0];if(a.length<b.length)for(var c=0;c<a.length;++c)f=d(f,e(b,a[c]));else for(var c=0;c<b.length;++c)f=d(f,e(a,b[c]));return f}},{"robust-scale":286,"robust-sum":289}],286:[function(a,b,c){"use strict";var d=a("two-product"),e=a("two-sum");b.exports=function(f,g){var h=f.length;if(1===h){var i=d(f[0],g);return i[0]?i:[i[1]]}var b=new Array(2*h),a=[.1,.1],j=[.1,.1],c=0;d(f[0],g,a),a[0]&&(b[c++]=a[0]);for(var k=1;k<h;++k){d(f[k],g,j),e(a[1],j[0],a),a[0]&&(b[c++]=a[0]);var l=j[1],m=a[1],n=l+m,o=m-(n-l);a[1]=n,o&&(b[c++]=o)}return a[1]&&(b[c++]=a[1]),0===c&&(b[c++]=0),b.length=c,b}},{"two-product":306,"two-sum":307}],287:[function(a,b,c){"use strict";b.exports=function(a,b,c,e){var f=d(a,c,e),g=d(b,c,e);if(f>0&&g>0||f<0&&g<0)return!1;var h=d(c,a,b),i=d(e,a,b);return(!(h>0)||!(i>0))&&(!(h<0)||!(i<0))&&(0!==f||0!==g||0!==h||0!==i||function(f,g,h,i){for(var a=0;a<2;++a){var b=f[a],c=g[a],j=Math.min(b,c),k=Math.max(b,c),d=h[a],e=i[a],l=Math.min(d,e),m=Math.max(d,e);if(m<j||k<l)return!1}return!0}(a,b,c,e))};var d=a("robust-orientation")[3]},{"robust-orientation":284}],288:[function(b,a,c){"use strict";a.exports=function(r,s){var A,D,z,B,C,d,g,e,i,u,v,w,j=0|r.length,k=0|s.length;if(1===j&&1===k)return B=(z=(A=r[0])+(D=-s[0]))-A,C=A-(z-B)+(D-B),C?[C,z]:[z];var n=new Array(j+k),o=0,b=0,c=0,p=Math.abs,l=r[b],x=p(l),m=-s[c],y=p(m);x<y?(g=l,(b+=1)<j&&(x=p(l=r[b]))):(g=m,(c+=1)<k&&(y=p(m=-s[c]))),b<j&&x<y||c>=k?(d=l,(b+=1)<j&&(x=p(l=r[b]))):(d=m,(c+=1)<k&&(y=p(m=-s[c])));for(var f=d+g,t=f-d,h=g-t,q=h,a=f;b<j&&c<k;)x<y?(d=l,(b+=1)<j&&(x=p(l=r[b]))):(d=m,(c+=1)<k&&(y=p(m=-s[c]))),t=(f=d+(g=q))-d,h=g-t,h&&(n[o++]=h),e=a+f,i=e-a,u=e-i,v=f-i,w=a-u,q=w+v,a=e;for(;b<j;)t=(f=(d=l)+(g=q))-d,h=g-t,h&&(n[o++]=h),e=a+f,i=e-a,u=e-i,v=f-i,w=a-u,q=w+v,a=e,b+=1,b<j&&(l=r[b]);for(;c<k;)t=(f=(d=m)+(g=q))-d,h=g-t,h&&(n[o++]=h),e=a+f,i=e-a,u=e-i,v=f-i,w=a-u,q=w+v,a=e,c+=1,c<k&&(m=-s[c]);return q&&(n[o++]=q),a&&(n[o++]=a),o||(n[o++]=0),n.length=o,n}},{}],289:[function(b,a,c){"use strict";a.exports=function(r,s){var A,D,z,B,C,d,g,e,i,u,v,w,j=0|r.length,k=0|s.length;if(1===j&&1===k)return B=(z=(A=r[0])+(D=s[0]))-A,C=A-(z-B)+(D-B),C?[C,z]:[z];var n=new Array(j+k),o=0,b=0,c=0,p=Math.abs,l=r[b],x=p(l),m=s[c],y=p(m);x<y?(g=l,(b+=1)<j&&(x=p(l=r[b]))):(g=m,(c+=1)<k&&(y=p(m=s[c]))),b<j&&x<y||c>=k?(d=l,(b+=1)<j&&(x=p(l=r[b]))):(d=m,(c+=1)<k&&(y=p(m=s[c])));for(var f=d+g,t=f-d,h=g-t,q=h,a=f;b<j&&c<k;)x<y?(d=l,(b+=1)<j&&(x=p(l=r[b]))):(d=m,(c+=1)<k&&(y=p(m=s[c]))),t=(f=d+(g=q))-d,h=g-t,h&&(n[o++]=h),e=a+f,i=e-a,u=e-i,v=f-i,w=a-u,q=w+v,a=e;for(;b<j;)t=(f=(d=l)+(g=q))-d,h=g-t,h&&(n[o++]=h),e=a+f,i=e-a,u=e-i,v=f-i,w=a-u,q=w+v,a=e,b+=1,b<j&&(l=r[b]);for(;c<k;)t=(f=(d=m)+(g=q))-d,h=g-t,h&&(n[o++]=h),e=a+f,i=e-a,u=e-i,v=f-i,w=a-u,q=w+v,a=e,c+=1,c<k&&(m=s[c]);return q&&(n[o++]=q),a&&(n[o++]=a),o||(n[o++]=0),n.length=o,n}},{}],290:[function(a,b,c){"use strict";b.exports=function(a){return e(d(a))};var d=a("boundary-cells"),e=a("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(a,b,c){"use strict";b.exports=function(c,i,h,a){if(h=h||0,void 0===a&&(a=function(c){for(var d=c.length,a=0,b=0;b<d;++b)a=0|Math.max(a,c[b].length);return a-1}(c)),0===c.length||a<1)return{cells:[],vertexIds:[],vertexWeights:[]};var j=function(b,f){for(var c=b.length,d=e.mallocUint8(c),a=0;a<c;++a)d[a]=b[a]<f|0;return d}(i,+h),b=function(l,c){for(var m=l.length,p=c*(c+1)/2*m|0,a=e.mallocUint32(2*p),g=0,b=0;b<m;++b)for(var i=l[b],c=i.length,h=0;h<c;++h)for(var j=0;j<h;++j){var n=i[j],o=i[h];a[g++]=0|Math.min(n,o),a[g++]=0|Math.max(n,o)}f(d(a,[g/2|0,2]));for(var k=2,b=2;b<g;b+=2)(a[b-2]!==a[b]||a[b-1]!==a[b+1])&&(a[k++]=a[b],a[k++]=a[b+1]);return d(a,[k/2|0,2])}(c,a),k=function(f,i,j,n){for(var b=f.data,k=f.shape[0],l=e.mallocDouble(k),a=0,c=0;c<k;++c){var g=b[2*c],h=b[2*c+1];if(j[g]!==j[h]){var o=i[g],m=i[h];b[2*a]=g,b[2*a+1]=h,l[a++]=(m-n)/(m-o)}}return f.shape[0]=a,d(l,[a])}(b,i,j,+h),l=function(f,g){var b=e.mallocInt32(2*g),d=f.shape[0],i=f.data;b[0]=0;for(var a=0,c=0;c<d;++c){var h=i[2*c];if(h!==a){for(b[2*a+1]=c;++a<h;)b[2*a]=c,b[2*a+1]=c;b[2*a]=c}}for(b[2*a+1]=d;++a<g;)b[2*a]=b[2*a+1]=d;return b}(b,0|i.length),m=g(a)(c,b.data,l,j),n=function(b){for(var c=0|b.shape[0],d=b.data,e=new Array(c),a=0;a<c;++a)e[a]=[d[2*a],d[2*a+1]];return e}(b),o=[].slice.call(k.data,0,k.shape[0]);return e.free(j),e.free(b.data),e.free(k.data),e.free(l),{cells:m,vertexIds:n,vertexWeights:o}};var d=a("ndarray"),e=a("typedarray-pool"),f=a("ndarray-sort"),g=a("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(b,a,c){"use strict";a.exports=function(a){return d[a]()};var d=[function(){return function(b,d,e,f){for(var c=b.length,a=0;a<c;++a)b[a].length;return[]}},function(){function a(d,j,e,f){for(var g=0|Math.min(e,f),h=0|Math.max(e,f),a=d[2*g],c=d[2*g+1];a<c;){var b=a+c>>1,i=j[2*b+1];if(i===h)return b;h<i?c=b:a=b+1}return a}return function(f,g,h,i){for(var j=f.length,c=[],d=0;d<j;++d){var b=f[d];if(2===b.length){var e=(i[b[0]]<<0)+(i[b[1]]<<1);if(0===e||3===e)continue;switch(e){case 0:break;case 1:c.push([a(h,g,b[0],b[1])]);break;case 2:c.push([a(h,g,b[1],b[0])]);break;case 3:break}}}return c}},function(){function a(d,j,e,f){for(var g=0|Math.min(e,f),h=0|Math.max(e,f),a=d[2*g],c=d[2*g+1];a<c;){var b=a+c>>1,i=j[2*b+1];if(i===h)return b;h<i?c=b:a=b+1}return a}return function(i,c,d,g){for(var k=i.length,e=[],h=0;h<k;++h){var b=i[h],j=b.length;if(3===j){var f=(g[b[0]]<<0)+(g[b[1]]<<1)+(g[b[2]]<<2);if(0===f||7===f)continue;switch(f){case 0:break;case 1:e.push([a(d,c,b[0],b[2]),a(d,c,b[0],b[1])]);break;case 2:e.push([a(d,c,b[1],b[0]),a(d,c,b[1],b[2])]);break;case 3:e.push([a(d,c,b[0],b[2]),a(d,c,b[1],b[2])]);break;case 4:e.push([a(d,c,b[2],b[1]),a(d,c,b[2],b[0])]);break;case 5:e.push([a(d,c,b[2],b[1]),a(d,c,b[0],b[1])]);break;case 6:e.push([a(d,c,b[1],b[0]),a(d,c,b[2],b[0])]);break;case 7:break}}else if(2===j){var f=(g[b[0]]<<0)+(g[b[1]]<<1);if(0===f||3===f)continue;switch(f){case 0:break;case 1:e.push([a(d,c,b[0],b[1])]);break;case 2:e.push([a(d,c,b[1],b[0])]);break;case 3:break}}}return e}},function(){function a(d,j,e,f){for(var g=0|Math.min(e,f),h=0|Math.max(e,f),a=d[2*g],c=d[2*g+1];a<c;){var b=a+c>>1,i=j[2*b+1];if(i===h)return b;h<i?c=b:a=b+1}return a}return function(j,c,d,g){for(var k=j.length,e=[],h=0;h<k;++h){var b=j[h],i=b.length;if(4===i){var f=(g[b[0]]<<0)+(g[b[1]]<<1)+(g[b[2]]<<2)+(g[b[3]]<<3);if(0===f||15===f)continue;switch(f){case 0:break;case 1:e.push([a(d,c,b[0],b[1]),a(d,c,b[0],b[2]),a(d,c,b[0],b[3])]);break;case 2:e.push([a(d,c,b[1],b[2]),a(d,c,b[1],b[0]),a(d,c,b[1],b[3])]);break;case 3:e.push([a(d,c,b[1],b[2]),a(d,c,b[0],b[2]),a(d,c,b[0],b[3])],[a(d,c,b[1],b[3]),a(d,c,b[1],b[2]),a(d,c,b[0],b[3])]);break;case 4:e.push([a(d,c,b[2],b[0]),a(d,c,b[2],b[1]),a(d,c,b[2],b[3])]);break;case 5:e.push([a(d,c,b[0],b[1]),a(d,c,b[2],b[1]),a(d,c,b[0],b[3])],[a(d,c,b[2],b[1]),a(d,c,b[2],b[3]),a(d,c,b[0],b[3])]);break;case 6:e.push([a(d,c,b[2],b[0]),a(d,c,b[1],b[0]),a(d,c,b[1],b[3])],[a(d,c,b[2],b[3]),a(d,c,b[2],b[0]),a(d,c,b[1],b[3])]);break;case 7:e.push([a(d,c,b[0],b[3]),a(d,c,b[1],b[3]),a(d,c,b[2],b[3])]);break;case 8:e.push([a(d,c,b[3],b[1]),a(d,c,b[3],b[0]),a(d,c,b[3],b[2])]);break;case 9:e.push([a(d,c,b[3],b[1]),a(d,c,b[0],b[1]),a(d,c,b[0],b[2])],[a(d,c,b[3],b[2]),a(d,c,b[3],b[1]),a(d,c,b[0],b[2])]);break;case 10:e.push([a(d,c,b[1],b[0]),a(d,c,b[3],b[0]),a(d,c,b[1],b[2])],[a(d,c,b[3],b[0]),a(d,c,b[3],b[2]),a(d,c,b[1],b[2])]);break;case 11:e.push([a(d,c,b[1],b[2]),a(d,c,b[0],b[2]),a(d,c,b[3],b[2])]);break;case 12:e.push([a(d,c,b[3],b[0]),a(d,c,b[2],b[0]),a(d,c,b[2],b[1])],[a(d,c,b[3],b[1]),a(d,c,b[3],b[0]),a(d,c,b[2],b[1])]);break;case 13:e.push([a(d,c,b[0],b[1]),a(d,c,b[2],b[1]),a(d,c,b[3],b[1])]);break;case 14:e.push([a(d,c,b[2],b[0]),a(d,c,b[1],b[0]),a(d,c,b[3],b[0])]);break;case 15:break}}else if(3===i){var f=(g[b[0]]<<0)+(g[b[1]]<<1)+(g[b[2]]<<2);if(0===f||7===f)continue;switch(f){case 0:break;case 1:e.push([a(d,c,b[0],b[2]),a(d,c,b[0],b[1])]);break;case 2:e.push([a(d,c,b[1],b[0]),a(d,c,b[1],b[2])]);break;case 3:e.push([a(d,c,b[0],b[2]),a(d,c,b[1],b[2])]);break;case 4:e.push([a(d,c,b[2],b[1]),a(d,c,b[2],b[0])]);break;case 5:e.push([a(d,c,b[2],b[1]),a(d,c,b[0],b[1])]);break;case 6:e.push([a(d,c,b[1],b[0]),a(d,c,b[2],b[0])]);break;case 7:break}}else if(2===i){var f=(g[b[0]]<<0)+(g[b[1]]<<1);if(0===f||3===f)continue;switch(f){case 0:break;case 1:e.push([a(d,c,b[0],b[1])]);break;case 2:e.push([a(d,c,b[1],b[0])]);break;case 3:break}}}return e}}]},{}],293:[function(b,i,a){"use strict";"use restrict";var j=b("bit-twiddle"),k=b("union-find");function c(a,b){var g=a.length,e=a.length-b.length,c=Math.min;if(e)return e;switch(g){case 0:return 0;case 1:return a[0]-b[0];case 2:var d=a[0]+a[1]-b[0]-b[1];if(d)return d;return c(a[0],a[1])-c(b[0],b[1]);case 3:var h=a[0]+a[1],i=b[0]+b[1];if(d=h+a[2]-(i+b[2]))return d;var j=c(a[0],a[1]),k=c(b[0],b[1]),d=c(j,a[2])-c(k,b[2]);if(d)return d;return c(j+a[2],h)-c(k+b[2],i);default:var l=a.slice(0);l.sort();var m=b.slice(0);m.sort();for(var f=0;f<g;++f)if(e=l[f]-m[f])return e;return 0}}function l(a,b){return c(a[0],b[0])}function d(b,e){if(!e)return b.sort(c),b;for(var f=b.length,d=new Array(f),a=0;a<f;++a)d[a]=[b[a],e[a]];d.sort(l);for(var a=0;a<f;++a)b[a]=d[a][0],e[a]=d[a][1];return b}function e(a){if(0===a.length)return[];for(var d=1,f=a.length,b=1;b<f;++b){var e=a[b];if(c(e,a[b-1])){if(b===d){d++;continue}a[d++]=e}}return a.length=d,a}function f(f,h){for(var b=0,d=f.length-1,g=-1;b<=d;){var a=b+d>>1,e=c(f[a],h);e<=0?(0===e&&(g=a),b=a+1):e>0&&(d=a-1)}return g}function g(b,k){for(var d=new Array(b.length),a=0,n=d.length;a<n;++a)d[a]=[];for(var e=[],a=0,o=k.length;a<o;++a)for(var l=k[a],m=l.length,g=1,p=1<<m;g<p;++g){e.length=j.popCount(g);for(var q=0,h=0;h<m;++h)g&1<<h&&(e[q++]=l[h]);var i=f(b,e);if(!(i<0))for(;d[i++].push(a),!(i>=b.length)&&0===c(b[i],e););}return d}function h(g,c){if(c<0)return[];for(var h=[],k=(1<<c+1)-1,e=0;e<g.length;++e)for(var f=g[e],a=k;a<1<<f.length;a=j.nextCombination(a)){for(var i=new Array(c+1),l=0,b=0;b<f.length;++b)a&1<<b&&(i[l++]=f[b]);h.push(i)}return d(h)}a.dimension=function(c){for(var a=0,d=Math.max,b=0,e=c.length;b<e;++b)a=d(a,c[b].length);return a-1},a.countVertices=function(d){for(var a=-1,f=Math.max,b=0,g=d.length;b<g;++b)for(var e=d[b],c=0,h=e.length;c<h;++c)a=f(a,e[c]);return a+1},a.cloneCells=function(b){for(var c=new Array(b.length),a=0,d=b.length;a<d;++a)c[a]=b[a].slice(0);return c},a.compareCells=c,a.normalize=d,a.unique=e,a.findCell=f,a.incidence=g,a.dual=function(b,c){if(!c)return g(e(h(b,0)),b,0);for(var d=new Array(c),a=0;a<c;++a)d[a]=[];for(var a=0,j=b.length;a<j;++a)for(var i=b[a],f=0,k=i.length;f<k;++f)d[i[f]].push(a);return d},a.explode=function(e){for(var f=[],b=0,j=e.length;b<j;++b)for(var g=e[b],h=0|g.length,c=1,k=1<<h;c<k;++c){for(var i=[],a=0;a<h;++a)c>>>a&1&&i.push(g[a]);f.push(i)}return d(f)},a.skeleton=h,a.boundary=function(f){for(var g=[],b=0,j=f.length;b<j;++b)for(var c=f[b],e=0,h=c.length;e<h;++e){for(var i=new Array(c.length-1),a=0,k=0;a<h;++a)a!==e&&(i[k++]=c[a]);g.push(i)}return d(g)},a.connectedComponents=function(a,b){return b?function(b,j){for(var g=new k(j),a=0;a<b.length;++a)for(var d=b[a],e=0;e<d.length;++e)for(var h=e+1;h<d.length;++h)g.link(d[e],d[h]);for(var f=[],c=g.ranks,a=0;a<c.length;++a)c[a]=-1;for(var a=0;a<b.length;++a){var i=g.find(b[a][0]);c[i]<0?(c[i]=f.length,f.push([b[a].slice(0)])):f[c[i]].push(b[a].slice(0))}return f}(a,b):function(b){for(var g=e(d(h(b,0))),m=new k(g.length),a=0;a<b.length;++a)for(var i=b[a],j=0;j<i.length;++j)for(var p=f(g,[i[j]]),n=j+1;n<i.length;++n)m.link(p,f(g,[i[n]]));for(var l=[],c=m.ranks,a=0;a<c.length;++a)c[a]=-1;for(var a=0;a<b.length;++a){var o=m.find(f(g,[b[a][0]]));c[o]<0?(c[o]=l.length,l.push([b[a].slice(0)])):l[c[o]].push(b[a].slice(0))}return l}(a)}},{"bit-twiddle":32,"union-find":309}],294:[function(b,c,a){arguments[4][32][0].apply(a,arguments)},{dup:32}],295:[function(b,c,a){arguments[4][293][0].apply(a,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(c,b,d){"use strict";"use restrict";function a(b){this.roots=new Array(b),this.ranks=new Array(b);for(var a=0;a<b;++a)this.roots[a]=a,this.ranks[a]=0}b.exports=a,a.prototype.length=function(){return this.roots.length},a.prototype.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},a.prototype.find=function(a){for(var b=this.roots;b[a]!==a;){var c=b[a];b[a]=b[c],a=c}return a},a.prototype.link=function(g,h){var a=this.find(g),b=this.find(h);if(a!==b){var c=this.ranks,d=this.roots,e=c[a],f=c[b];e<f?d[a]=b:f<e?d[b]=a:(d[b]=a,++c[a])}}},{}],297:[function(a,b,c){"use strict";b.exports=function(j,p,s){for(var b=p.length,t=j.length,c=new Array(b),f=new Array(b),k=new Array(b),q=new Array(b),a=0;a<b;++a)c[a]=f[a]=-1,k[a]=1/0,q[a]=!1;for(var a=0;a<t;++a){var l=j[a];if(2!==l.length)throw new Error("Input must be a graph");var g=l[1],h=l[0];-1!==f[h]?f[h]=-2:f[h]=g,-1!==c[g]?c[g]=-2:c[g]=h}function u(a){if(q[a])return 1/0;var g,b,e,h,i,j=c[a],k=f[a];return j<0||k<0?1/0:(g=p[a],b=p[j],e=p[k],h=Math.abs(d(g,b,e)),i=Math.sqrt(Math.pow(b[0]-e[0],2)+Math.pow(b[1]-e[1],2)),h/i)}function z(a,b){var c=m[a],d=m[b];m[a]=d,m[b]=c,n[c]=b,n[d]=a}function A(a){return k[m[a]]}function B(a){return 1&a?a-1>>1:(a>>1)-1}function v(a){for(var g=A(a);;){var c=g,d=2*a+1,e=2*(a+1),b=a;if(d<y){var f=A(d);f<c&&(b=d,c=f)}if(e<y&&A(e)<c&&(b=e),b===a)return a;z(a,b),a=b}}function C(a){for(var c=A(a);a>0;){var b=B(a);if(b>=0&&c<A(b)){z(a,b),a=b;continue}return a}}function w(){if(y>0){var a=m[0];return z(0,y-1),y-=1,v(0),a}return -1}function D(a,c){var b=m[a];return k[b]===c?a:(k[b]=-1/0,C(a),w(),k[b]=c,C((y+=1)-1))}function x(d){if(!q[d]){q[d]=!0;var a=c[d],b=f[d];c[b]>=0&&(c[b]=a),f[a]>=0&&(f[a]=b),n[a]>=0&&D(n[a],u(a)),n[b]>=0&&D(n[b],u(b))}}for(var m=[],n=new Array(b),a=0;a<b;++a)(k[a]=u(a))<1/0?(n[a]=m.length,m.push(a)):n[a]=-1;for(var y=m.length,a=y>>1;a>=0;--a)v(a);for(;;){var o=w();if(o<0||k[o]>s)break;x(o)}for(var i=[],a=0;a<b;++a)q[a]||(n[a]=i.length,i.push(p[a].slice()));function E(c,d){if(c[d]<0)return d;var f=d,a=d;do{var b=c[a];if(!q[a]||b<0||b===a)break;if(b=c[a=b],!q[a]||b<0||b===a)break;a=b,f=c[f]}while(f!==a)for(var e=d;e!==a;e=c[e])c[e]=a;return a}i.length;var r=[];return j.forEach(function(d){var a=E(c,d[0]),b=E(f,d[1]);if(a>=0&&b>=0&&a!==b){var e=n[a],g=n[b];e!==g&&r.push([e,g])}}),e.unique(e.normalize(r)),{positions:i,edges:r}};var d=a("robust-orientation"),e=a("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(a,b,c){"use strict";b.exports=function(a,b){if(b[0][0]<b[1][0])i=b[0],g=b[1];else{if(!(b[0][0]>b[1][0]))return e(b,a);i=b[1],g=b[0]}if(a[0][0]<a[1][0])j=a[0],h=a[1];else{if(!(a[0][0]>a[1][0]))return-e(a,b);j=a[1],h=a[0]}var i,g,j,h,c=d(i,g,h),f=d(i,g,j);if(c<0){if(f<=0)return c}else if(c>0){if(f>=0)return c}else if(f)return f;if(c=d(h,j,g),f=d(h,j,i),c<0){if(f<=0)return c}else if(c>0){if(f>=0)return c}else if(f)return f;return g[0]-h[0]};var d=a("robust-orientation");function e(b,a){if(a[0][0]<a[1][0])j=a[0],e=a[1];else if(a[0][0]>a[1][0])j=a[1],e=a[0];else{var j,e,f,c,k=Math.min(b[0][1],b[1][1]),g=Math.max(b[0][1],b[1][1]),l=Math.min(a[0][1],a[1][1]),h=Math.max(a[0][1],a[1][1]);return g<l?g-l:k>h?k-h:g-h}b[0][1]<b[1][1]?(f=b[0],c=b[1]):(f=b[1],c=b[0]);var i=d(e,j,f);return i||((i=d(e,j,c))?i:c-e)}},{"robust-orientation":284}],299:[function(a,b,e){"use strict";b.exports=function(k){for(var n=k.length,j=2*n,e=new Array(j),b=0;b<n;++b){var d=k[b],o=d[0][0]<d[1][0];e[2*b]=new m(d[0][0],d,o,b),e[2*b+1]=new m(d[1][0],d,!o,b)}e.sort(function(a,b){var c=a.x-b.x;return c||((c=a.create-b.create)?c:Math.min(a.segment[0][1],a.segment[1][1])-Math.min(b.segment[0][1],b.segment[1][1]))});for(var h=g(i),p=[],q=[],r=[],b=0;b<j;){for(var s=e[b].x,f=[];b<j;){var a=e[b];if(a.x!==s)break;b+=1,a.segment[0][0]===a.x&&a.segment[1][0]===a.x?a.create&&(a.segment[0][1]<a.segment[1][1]?(f.push(new l(a.segment[0][1],a.index,!0,!0)),f.push(new l(a.segment[1][1],a.index,!1,!1))):(f.push(new l(a.segment[1][1],a.index,!0,!1)),f.push(new l(a.segment[0][1],a.index,!1,!0)))):h=a.create?h.insert(a.segment,a.index):h.remove(a.segment)}p.push(h.root),q.push(s),r.push(f)}return new c(p,q,r)};var f=a("binary-search-bounds"),g=a("functional-red-black-tree"),h=a("robust-orientation"),i=a("./lib/order-segments");function c(a,b,c){this.slabs=a,this.coordinates=b,this.horizontal=c}var d=c.prototype;function j(a,b){return a.y-b}function k(a,c){for(var g=null;a;){var e,f,b=a.key;b[0][0]<b[1][0]?(e=b[0],f=b[1]):(e=b[1],f=b[0]);var i=h(e,f,c);if(i<0)a=a.left;else if(i>0)if(c[0]!==b[1][0])g=a,a=a.right;else{var d=k(a.right,c);if(d)return d;a=a.left}else{if(c[0]!==b[1][0])return a;var d=k(a.right,c);if(d)return d;a=a.left}}return g}function l(a,b,c,d){this.y=a,this.index=b,this.start=c,this.closed=d}function m(a,b,c,d){this.x=a,this.segment=b,this.create=c,this.index=d}d.castUp=function(b){var l=f.le(this.coordinates,b[0]);if(l<0)return -1;this.slabs[l];var n=k(this.slabs[l],b),e=-1;if(n&&(e=n.value),this.coordinates[l]===b[0]){var c=null;if(n&&(c=n.key),l>0){var m=k(this.slabs[l-1],b);m&&(c?i(m.key,c)>0&&(c=m.key,e=m.value):(e=m.value,c=m.key))}var d=this.horizontal[l];if(d.length>0){var g=f.ge(d,b[1],j);if(g<d.length){var a=d[g];if(b[1]===a.y){if(a.closed)return a.index;for(;g<d.length-1&&d[g+1].y===b[1];)if(g+=1,(a=d[g]).closed)return a.index;if(a.y===b[1]&&!a.start){if((g+=1)>=d.length)return e;a=d[g]}}if(a.start)if(c){var o=h(c[0],c[1],[b[0],a.y]);c[0][0]>c[1][0]&&(o=-o),o>0&&(e=a.index)}else e=a.index;else a.y!==b[1]&&(e=a.index)}}}return e}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(b,a,c){"use strict";var d=b("robust-dot-product"),e=b("robust-sum");function f(c,a){var b=e(d(c,a),[a[a.length-1]]);return b[b.length-1]}function g(c,d,g,h){var a=-d/(h-d);a<0?a=0:a>1&&(a=1);for(var i=1-a,e=c.length,f=new Array(e),b=0;b<e;++b)f[b]=a*c[b]+i*g[b];return f}a.exports=function(a,j){for(var d=[],e=[],h=f(a[a.length-1],j),k=a[a.length-1],b=a[0],i=0;i<a.length;++i,k=b){var c=f(b=a[i],j);if(h<0&&c>0||h>0&&c<0){var l=g(k,c,b,h);d.push(l),e.push(l.slice())}c<0?e.push(b.slice()):c>0?d.push(b.slice()):(d.push(b.slice()),e.push(b.slice())),h=c}return{positive:d,negative:e}},a.exports.positive=function(a,i){for(var e=[],c=f(a[a.length-1],i),j=a[a.length-1],d=a[0],h=0;h<a.length;++h,j=d){var b=f(d=a[h],i);(c<0&&b>0||c>0&&b<0)&&e.push(g(j,b,d,c)),b>=0&&e.push(d.slice()),c=b}return e},a.exports.negative=function(a,i){for(var e=[],c=f(a[a.length-1],i),j=a[a.length-1],d=a[0],h=0;h<a.length;++h,j=d){var b=f(d=a[h],i);(c<0&&b>0||c>0&&b<0)&&e.push(g(j,b,d,c)),b<=0&&e.push(d.slice()),c=b}return e}},{"robust-dot-product":281,"robust-sum":289}],301:[function(b,c,d){!function(){"use strict";function b(a){return e(g(a),arguments)}function c(a,c){return b.apply(null,[a].concat(c||[]))}function e(g,j){var a,d,e,c,h,k,l,m,f,n=1,o=g.length,i="";for(d=0;d<o;d++)if("string"==typeof g[d])i+=g[d];else if("object"==typeof g[d]){if((c=g[d]).keys)for(e=0,a=j[n];e<c.keys.length;e++){if(void 0==a)throw new Error(b('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[e],c.keys[e-1]));a=a[c.keys[e]]}else a=c.param_no?j[c.param_no]:j[n++];if(/[^T]/.test(c.type)&&/[^v]/.test(c.type)&&a instanceof Function&&(a=a()),/[bcdiefguxX]/.test(c.type)&&"number"!=typeof a&&isNaN(a))throw new TypeError(b("[sprintf] expecting number but found %T",a));switch(/[diefg]/.test(c.type)&&(m=a>=0),c.type){case"b":a=parseInt(a,10).toString(2);break;case"c":a=String.fromCharCode(parseInt(a,10));break;case"d":case"i":a=parseInt(a,10);break;case"j":a=JSON.stringify(a,null,c.width?parseInt(c.width):0);break;case"e":a=c.precision?parseFloat(a).toExponential(c.precision):parseFloat(a).toExponential();break;case"f":a=c.precision?parseFloat(a).toFixed(c.precision):parseFloat(a);break;case"g":a=c.precision?String(Number(a.toPrecision(c.precision))):parseFloat(a);break;case"o":a=(parseInt(a,10)>>>0).toString(8);break;case"s":a=String(a),a=c.precision?a.substring(0,c.precision):a;break;case"t":a=String(!!a),a=c.precision?a.substring(0,c.precision):a;break;case"T":a=Object.prototype.toString.call(a).slice(8,-1).toLowerCase(),a=c.precision?a.substring(0,c.precision):a;break;case"u":a=parseInt(a,10)>>>0;break;case"v":a=a.valueOf(),a=c.precision?a.substring(0,c.precision):a;break;case"x":a=(parseInt(a,10)>>>0).toString(16);break;case"X":a=(parseInt(a,10)>>>0).toString(16).toUpperCase();break}/[j]/.test(c.type)?i+=a:(/[diefg]/.test(c.type)&&(!m||c.sign)?(f=m?"+":"-",a=a.toString().replace(/^[+-]/,"")):f="",k=c.pad_char?"0"===c.pad_char?"0":c.pad_char.charAt(1):" ",l=c.width-(f+a).length,h=c.width&&l>0?k.repeat(l):"",i+=c.align?f+a+h:"0"===k?f+h+a:h+f+a)}return i}var f=Object.create(null);function g(e){if(f[e])return f[e];for(var a,c=e,g=[],i=0;c;){if(null!==(a=/^[^\x25]+/.exec(c)))g.push(a[0]);else if(null!==(a=/^\x25{2}/.exec(c)))g.push("%");else if(null!==(a=/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/.exec(c))){if(a[2]){i|=1;var h=[],d=a[2],b=[];if(null!==(b=/^([a-z_][a-z_\d]*)/i.exec(d)))for(h.push(b[1]);""!==(d=d.substring(b[0].length));)if(null!==(b=/^\.([a-z_][a-z_\d]*)/i.exec(d)))h.push(b[1]);else if(null!==(b=/^\[(\d+)\]/.exec(d)))h.push(b[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");a[2]=h}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");g.push({placeholder:a[0],param_no:a[1],keys:a[2],sign:a[3],pad_char:a[4],align:a[5],width:a[6],precision:a[7],type:a[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");c=c.substring(a[0].length)}return f[e]=g}void 0!==d&&(d.sprintf=b,d.vsprintf=c),"undefined"!=typeof window&&(window.sprintf=b,window.vsprintf=c,"function"==typeof a&&a.amd&&a(function(){return{sprintf:b,vsprintf:c}}))}()},{}],302:[function(a,b,c){"use strict";b.exports=function(a,b){if(a.dimension<=0)return{positions:[],cells:[]};if(1===a.dimension)return function(g,h){for(var c=e(g,h),b=c.length,d=new Array(b),f=new Array(b),a=0;a<b;++a)d[a]=[c[a]],f[a]=[a];return{positions:d,cells:f}}(a,b);var h=a.order.join()+"-"+a.dtype,c=g[h],b=+b||0;return c||(c=g[h]=function(a,c){var b=f[a.length+"d"];if(b)return b(d,a,c)}(a.order,a.dtype)),c(a,b)};var d=a("ndarray-extract-contour"),e=a("zero-crossings"),f={"2d":function(a,b,c){var d=a({order:b,scalarArguments:3,getters:"generic"===c?[0]:void 0,phase:function(a,c,d,b){return a>b|0},vertex:function(f,g,a,b,c,d,j,k,l,m,h,n,e){var i=(j<<0)+(k<<1)+(l<<2)+(m<<3)|0;if(0!==i&&15!==i)switch(i){case 0:h.push([f-.5,g-.5]);break;case 1:h.push([f-.25-.25*(b+a-2*e)/(a-b),g-.25-.25*(c+a-2*e)/(a-c)]);break;case 2:h.push([f-.75-.25*(-b-a+2*e)/(b-a),g-.25-.25*(d+b-2*e)/(b-d)]);break;case 3:h.push([f-.5,g-.5-.5*(c+a+d+b-4*e)/(a-c+b-d)]);break;case 4:h.push([f-.25-.25*(d+c-2*e)/(c-d),g-.75-.25*(-c-a+2*e)/(c-a)]);break;case 5:h.push([f-.5-.5*(b+a+d+c-4*e)/(a-b+c-d),g-.5]);break;case 6:h.push([f-.5-.25*(-b-a+d+c)/(b-a+c-d),g-.5-.25*(-c-a+d+b)/(c-a+b-d)]);break;case 7:h.push([f-.75-.25*(d+c-2*e)/(c-d),g-.75-.25*(d+b-2*e)/(b-d)]);break;case 8:h.push([f-.75-.25*(-d-c+2*e)/(d-c),g-.75-.25*(-d-b+2*e)/(d-b)]);break;case 9:h.push([f-.5-.25*(b+a+ -d-c)/(a-b+d-c),g-.5-.25*(c+a+ -d-b)/(a-c+d-b)]);break;case 10:h.push([f-.5-.5*(-b-a+ -d-c+4*e)/(b-a+d-c),g-.5]);break;case 11:h.push([f-.25-.25*(-d-c+2*e)/(d-c),g-.75-.25*(c+a-2*e)/(a-c)]);break;case 12:h.push([f-.5,g-.5-.5*(-c-a+ -d-b+4*e)/(c-a+d-b)]);break;case 13:h.push([f-.75-.25*(b+a-2*e)/(a-b),g-.25-.25*(-d-b+2*e)/(d-b)]);break;case 14:h.push([f-.25-.25*(-b-a+2*e)/(b-a),g-.25-.25*(-c-a+2*e)/(c-a)]);break;case 15:h.push([f-.5,g-.5]);break}},cell:function(a,b,e,f,d,g,h,c,i){d?c.push([a,b]):c.push([b,a])}});return function(c,e){var a=[],b=[];return d(c,a,b,e),{positions:a,cells:b}}}},g={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(a,b,c){(function(c){(function(){"use strict";b.exports=g;var e=a("vectorize-text"),d=window||c.global||{},f=d.__TEXT_CACHE||{};function g(h,b,l){var l=l||{},d=f[h];d||(d=f[h]={" ":{data:new Float32Array(0),shape:.2}});var i=d[b];if(!i)if(b.length<=1||!/\d/.test(b))i=d[b]=function(g){for(var a=g.cells,i=g.positions,b=new Float32Array(6*a.length),h=0,c=0,d=0;d<a.length;++d)for(var j=a[d],e=0;e<3;++e){var f=i[j[e]];b[h++]=f[0],b[h++]=f[1]+1.4,c=Math.max(f[0],c)}return{data:b,shape:c}}(e(b,{triangles:!0,font:h,textAlign:l.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var m=b.split(/(\d|\s)/),c=new Array(m.length),p=0,j=0,a=0;a<m.length;++a)c[a]=g(h,m[a]),p+=c[a].data.length,j+=c[a].shape,a>0&&(j+=.02);for(var n=new Float32Array(p),q=0,r=-0.5*j,a=0;a<c.length;++a){for(var o=c[a].data,k=0;k<o.length;k+=2)n[q++]=o[k]+r,n[q++]=o[k+1];r+=c[a].shape+.02}i=d[b]={data:n,shape:j}}return i}d.__TEXT_CACHE={}}).call(this)}).call(this,a("_process"))},{"_process":5,"vectorize-text":311}],304:[function(a,b,d){"use strict";var e=a("parse-unit");function f(a,d){var b=e(getComputedStyle(a).getPropertyValue(d));return b[0]*c(b[1],a)}function c(b,a){switch(a=a||document.body,b=(b||"px").trim().toLowerCase(),(a===window||a===document)&&(a=document.body),b){case"%":return a.clientHeight/100;case"ch":case"ex":var e,d,c,g;return e=b,d=a,(c=document.createElement("div")).style["font-size"]="128"+e,d.appendChild(c),g=f(c,"font-size")/128,d.removeChild(c),g;case"em":return f(a,"font-size");case"rem":return f(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 37.79527559055118;case"mm":return 3.7795275590551185;case"pt":return 1.3333333333333333;case"pc":return 16}return 1}b.exports=c},{"parse-unit":265}],305:[function(b,c,e){"use strict";c.exports=function(b){var e=(b=b||{}).center||[0,0,0],c=b.up||[0,1,0],a=b.right||n(c),f=b.radius||1,m=b.theta||0,o=b.phi||0;if(e=[].slice.call(e,0,3),j(c=[].slice.call(c,0,3),c),j(a=[].slice.call(a,0,3),a),"eye"in b){var h=b.eye,g=[h[0]-e[0],h[1]-e[1],h[2]-e[2]];i(a,g,c),1e-6>l(a[0],a[1],a[2])?a=n(c):j(a,a),f=l(g[0],g[1],g[2]);var p=k(c,g)/f,q=k(a,g)/f;o=Math.acos(p),m=Math.acos(q)}return f=Math.log(f),new d(b.zoomMin,b.zoomMax,e,c,a,f,m,o)};var f=b("filtered-vector"),g=b("gl-mat4/invert"),h=b("gl-mat4/rotate"),i=b("gl-vec3/cross"),j=b("gl-vec3/normalize"),k=b("gl-vec3/dot");function l(a,b,c){return Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2))}function m(a){return Math.min(1,Math.max(-1,a))}function n(c){var d=Math.abs(c[0]),e=Math.abs(c[1]),f=Math.abs(c[2]),b=[0,0,0];d>Math.max(e,f)?b[2]=1:e>Math.max(d,f)?b[0]=1:b[1]=1;for(var g=0,h=0,a=0;a<3;++a)g+=c[a]*c[a],h+=b[a]*c[a];for(var a=0;a<3;++a)b[a]-=h/g*c[a];return j(b,b),b}function d(b,c,d,e,g,h,i,j){this.center=f(d),this.up=f(e),this.right=f(g),this.radius=f([h]),this.angle=f([i,j]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(b,c),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var a=0;a<16;++a)this.computedMatrix[a]=.5;this.recalcMatrix(0)}var a=d.prototype;a.setDistanceLimits=function(b,a){b=b>0?Math.log(b):-1/0,a=a>0?Math.log(a):1/0,a=Math.max(a,b),this.radius.bounds[0][0]=b,this.radius.bounds[1][0]=a},a.getDistanceLimits=function(a){var b=this.radius.bounds[0];return a?(a[0]=Math.exp(b[0][0]),a[1]=Math.exp(b[1][0]),a):[Math.exp(b[0][0]),Math.exp(b[1][0])]},a.recalcMatrix=function(e){this.center.curve(e),this.up.curve(e),this.right.curve(e),this.radius.curve(e),this.angle.curve(e);for(var c=this.computedUp,d=this.computedRight,k=0,s=0,a=0;a<3;++a)s+=c[a]*d[a],k+=c[a]*c[a];for(var E=Math.sqrt(k),f=0,a=0;a<3;++a)d[a]-=c[a]*s/k,f+=d[a]*d[a],c[a]/=E;for(var F=Math.sqrt(f),a=0;a<3;++a)d[a]/=F;var g=this.computedToward;i(g,c,d),j(g,g);for(var G=Math.exp(this.computedRadius[0]),t=this.computedAngle[0],u=this.computedAngle[1],v=Math.cos(t),w=Math.sin(t),m=Math.cos(u),n=Math.sin(u),H=this.computedCenter,I=v*m,J=w*m,K=n,L=-v*n,M=-w*n,N=m,x=this.computedEye,b=this.computedMatrix,a=0;a<3;++a){var O=I*d[a]+J*g[a]+K*c[a];b[4*a+1]=L*d[a]+M*g[a]+N*c[a],b[4*a+2]=O,b[4*a+3]=0}var y=b[1],z=b[5],A=b[9],B=b[2],C=b[6],D=b[10],o=z*D-A*C,p=A*B-y*D,q=y*C-z*B,r=l(o,p,q);o/=r,p/=r,q/=r,b[0]=o,b[4]=p,b[8]=q;for(var a=0;a<3;++a)x[a]=H[a]+b[2+4*a]*G;for(var a=0;a<3;++a){for(var f=0,h=0;h<3;++h)f+=b[a+4*h]*x[h];b[12+a]=-f}b[15]=1},a.getMatrix=function(d,b){this.recalcMatrix(d);var c=this.computedMatrix;if(b){for(var a=0;a<16;++a)b[a]=c[a];return b}return c};var o=[0,0,0];a.rotate=function(e,g,i,f){if(this.angle.move(e,g,i),f){this.recalcMatrix(e);var b=this.computedMatrix;o[0]=b[2],o[1]=b[6],o[2]=b[10];for(var c=this.computedUp,d=this.computedRight,j=this.computedToward,a=0;a<3;++a)b[4*a]=c[a],b[4*a+1]=d[a],b[4*a+2]=j[a];h(b,b,f,o);for(var a=0;a<3;++a)c[a]=b[4*a],d[a]=b[4*a+1];this.up.set(e,c[0],c[1],c[2]),this.right.set(e,d[0],d[1],d[2])}},a.pan=function(j,b,c,k){b=b||0,c=c||0,k=k||0,this.recalcMatrix(j);var a=this.computedMatrix;Math.exp(this.computedRadius[0]);var d=a[1],e=a[5],f=a[9],m=l(d,e,f);d/=m,e/=m,f/=m;var g=a[0],h=a[4],i=a[8],n=g*d+h*e+i*f,o=l(g-=d*n,h-=e*n,i-=f*n);g/=o,h/=o,i/=o,this.center.move(j,g*b+d*c,h*b+e*c,i*b+f*c);var p=Math.exp(this.computedRadius[0]);p=Math.max(1e-4,p+k),this.radius.set(j,Math.log(p))},a.translate=function(a,b,c,d){this.center.move(a,b||0,c||0,d||0)},a.setMatrix=function(f,a,C,J){var q,r,e=1;"number"==typeof C&&(e=0|C),(e<0||e>3)&&(e=1);var s=(e+2)%3,W=(e+1)%3;a||(this.recalcMatrix(f),a=this.computedMatrix);var b=a[e],c=a[e+4],d=a[e+8];if(J){var D=Math.abs(b),K=Math.abs(c),E=Math.abs(d),F=Math.max(D,K,E);D===F?(b=b<0?-1:1,c=d=0):E===F?(d=d<0?-1:1,b=c=0):(c=c<0?-1:1,b=d=0)}else{var t=l(b,c,d);b/=t,c/=t,d/=t}var h=a[s],i=a[s+4],j=a[s+8],u=h*b+i*c+j*d,v=l(h-=b*u,i-=c*u,j-=d*u);h/=v,i/=v;var n=c*(j/=v)-d*i,o=d*h-b*j,p=b*i-c*h,w=l(n,o,p);if(n/=w,o/=w,p/=w,this.center.jump(f,T,U,V),this.radius.idle(f),this.up.jump(f,b,c,d),this.right.jump(f,h,i,j),2===e){var G=a[1],H=a[5],I=a[9],L=G*h+H*i+I*j,M=G*n+H*o+I*p;q=N<0?-Math.PI/2:Math.PI/2,r=Math.atan2(M,L)}else{var x=a[2],y=a[6],z=a[10],N=x*b+y*c+z*d,O=x*h+y*i+z*j,P=x*n+y*o+z*p;q=Math.asin(m(N)),r=Math.atan2(P,O)}this.angle.jump(f,r,q),this.recalcMatrix(f);var Q=a[2],R=a[6],S=a[10],k=this.computedMatrix;g(k,a);var A=k[15],T=k[12]/A,U=k[13]/A,V=k[14]/A,B=Math.exp(this.computedRadius[0]);this.center.jump(f,T-Q*B,U-R*B,V-S*B)},a.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},a.idle=function(a){this.center.idle(a),this.up.idle(a),this.right.idle(a),this.radius.idle(a),this.angle.idle(a)},a.flush=function(a){this.center.flush(a),this.up.flush(a),this.right.flush(a),this.radius.flush(a),this.angle.flush(a)},a.setDistance=function(b,a){a>0&&this.radius.set(b,Math.log(a))},a.lookAt=function(n,p,g,r){this.recalcMatrix(n),p=p||this.computedEye,g=g||this.computedCenter;var a=(r=r||this.computedUp)[0],b=r[1],c=r[2],s=l(a,b,c);if(!(s<1e-6)){a/=s,b/=s,c/=s;var h=p[0]-g[0],i=p[1]-g[1],j=p[2]-g[2],q=l(h,i,j);if(!(q<1e-6)){h/=q,i/=q,j/=q;var v=this.computedRight,d=v[0],e=v[1],f=v[2],w=a*d+b*e+c*f,o=l(d-=w*a,e-=w*b,f-=w*c);if(!(o<.01)||(d=b*j-c*i,e=c*h-a*j,f=a*i-b*h,o=l(d,e,f),!(o<1e-6))){d/=o,e/=o,f/=o,this.up.set(n,a,b,c),this.right.set(n,d,e,f),this.center.set(n,g[0],g[1],g[2]),this.radius.set(n,Math.log(q));var x=b*f-c*e,y=c*d-a*f,z=a*e-b*d,A=l(x,y,z);x/=A,y/=A,z/=A;var C=Math.asin(m(a*h+b*i+c*j)),t=Math.atan2(x*h+y*i+z*j,d*h+e*i+f*j),u=this.angle._state,k=u[u.length-1],D=u[u.length-2];k%=2*Math.PI;var B=Math.abs(k-t);Math.abs(k+2*Math.PI-t)<B&&(k+=2*Math.PI),Math.abs(k-2*Math.PI-t)<B&&(k-=2*Math.PI),this.angle.jump(this.angle.lastT(),k,D),this.angle.set(n,t,C)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(b,a,c){"use strict";a.exports=function(a,b,c){var e=a*b,h=d*a,f=h-(h-a),i=a-f,j=d*b,g=j-(j-b),k=b-g,l=i*k-(e-f*g-i*g-f*k);return c?(c[0]=l,c[1]=e,c):[l,e]};var d=134217729},{}],307:[function(b,a,c){"use strict";a.exports=function(c,d,a){var b=c+d,e=b-c,f=d-e,g=c-(b-e);return a?(a[0]=g+f,a[1]=b,a):[g+f,b]}},{}],308:[function(a,b,d){(function(b){(function(){"use strict";var u=a("bit-twiddle"),c=a("dup"),v=a("buffer").Buffer;b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:c([32,0]),UINT16:c([32,0]),UINT32:c([32,0]),BIGUINT64:c([32,0]),INT8:c([32,0]),INT16:c([32,0]),INT32:c([32,0]),BIGINT64:c([32,0]),FLOAT:c([32,0]),DOUBLE:c([32,0]),DATA:c([32,0]),UINT8C:c([32,0]),BUFFER:c([32,0])});var w="undefined"!=typeof Uint8ClampedArray,x="undefined"!=typeof BigUint64Array,y="undefined"!=typeof BigInt64Array,e=b.__TYPEDARRAY_POOL;e.UINT8C||(e.UINT8C=c([32,0])),e.BIGUINT64||(e.BIGUINT64=c([32,0])),e.BIGINT64||(e.BIGINT64=c([32,0])),e.BUFFER||(e.BUFFER=c([32,0]));var z=e.DATA,A=e.BUFFER;function f(a){if(a){var b=a.length||a.byteLength;z[u.log2(b)].push(a)}}function g(a){var a=u.nextPow2(a),b=z[u.log2(a)];return b.length>0?b.pop():new ArrayBuffer(a)}function h(a){return new Uint8Array(g(a),0,a)}function i(a){return new Uint16Array(g(2*a),0,a)}function j(a){return new Uint32Array(g(4*a),0,a)}function k(a){return new Int8Array(g(a),0,a)}function l(a){return new Int16Array(g(2*a),0,a)}function m(a){return new Int32Array(g(4*a),0,a)}function n(a){return new Float32Array(g(4*a),0,a)}function o(a){return new Float64Array(g(8*a),0,a)}function p(a){return w?new Uint8ClampedArray(g(a),0,a):h(a)}function q(a){return x?new BigUint64Array(g(8*a),0,a):null}function r(a){return y?new BigInt64Array(g(8*a),0,a):null}function s(a){return new DataView(g(a),0,a)}function t(a){a=u.nextPow2(a);var c=u.log2(a),b=A[c];return b.length>0?b.pop():new v(a)}d.free=function(a){if(v.isBuffer(a))A[u.log2(a.length)].push(a);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),!a)return;var b=a.length||a.byteLength;z[0|u.log2(b)].push(a)}},d.freeUint8=d.freeUint16=d.freeUint32=d.freeBigUint64=d.freeInt8=d.freeInt16=d.freeInt32=d.freeBigInt64=d.freeFloat32=d.freeFloat=d.freeFloat64=d.freeDouble=d.freeUint8Clamped=d.freeDataView=function(a){f(a.buffer)},d.freeArrayBuffer=f,d.freeBuffer=function(a){A[u.log2(a.length)].push(a)},d.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return g(a);switch(b){case"uint8":return h(a);case"uint16":return i(a);case"uint32":return j(a);case"int8":return k(a);case"int16":return l(a);case"int32":return m(a);case"float":case"float32":return n(a);case"double":case"float64":return o(a);case"uint8_clamped":return p(a);case"bigint64":return r(a);case"biguint64":return q(a);case"buffer":return t(a);case"data":case"dataview":return s(a);default:return null}return null},d.mallocArrayBuffer=g,d.mallocUint8=h,d.mallocUint16=i,d.mallocUint32=j,d.mallocInt8=k,d.mallocInt16=l,d.mallocInt32=m,d.mallocFloat32=d.mallocFloat=n,d.mallocFloat64=d.mallocDouble=o,d.mallocUint8Clamped=p,d.mallocBigUint64=q,d.mallocBigInt64=r,d.mallocDataView=s,d.mallocBuffer=t,d.clearCache=function(){for(var a=0;a<32;++a)e.UINT8[a].length=0,e.UINT16[a].length=0,e.UINT32[a].length=0,e.INT8[a].length=0,e.INT16[a].length=0,e.INT32[a].length=0,e.FLOAT[a].length=0,e.DOUBLE[a].length=0,e.BIGUINT64[a].length=0,e.BIGINT64[a].length=0,e.UINT8C[a].length=0,z[a].length=0,A[a].length=0}}).call(this)}).call(this,void 0!==c?c:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(d,c,e){"use strict";"use restrict";function b(b){this.roots=new Array(b),this.ranks=new Array(b);for(var a=0;a<b;++a)this.roots[a]=a,this.ranks[a]=0}c.exports=b;var a=b.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},a.find=function(a){for(var c=a,b=this.roots;b[a]!==a;)a=b[a];for(;b[c]!==a;){var d=b[c];b[c]=a,c=d}return a},a.link=function(g,h){var a=this.find(g),b=this.find(h);if(a!==b){var c=this.ranks,d=this.roots,e=c[a],f=c[b];e<f?d[a]=b:f<e?d[b]=a:(d[b]=a,++c[a])}}},{}],310:[function(b,a,c){"use strict";a.exports=function(a,b,c){return 0===a.length?a:b?(c||a.sort(b),function(a,f){for(var b=1,g=a.length,d=a[0],e=a[0],c=1;c<g;++c)if(e=d,f(d=a[c],e)){if(c===b){b++;continue}a[b++]=d}return a.length=b,a}(a,b)):(c||a.sort(),function(a){for(var b=1,f=a.length,c=a[0],e=a[0],d=1;d<f;++d,e=c)if(e=c,(c=a[d])!==e){if(d===b){b++;continue}a[b++]=c}return a.length=b,a}(a))}},{}],311:[function(b,c,e){"use strict";c.exports=function(c,b){return("object"!=typeof b||null===b)&&(b={}),f(c,b.canvas||a,b.context||d,b)};var f=b("./lib/vtext"),a=null,d=null;"undefined"!=typeof document&&((a=document.createElement("canvas")).width=8192,a.height=1024,d=a.getContext("2d"))},{"./lib/vtext":312}],312:[function(a,b,c){b.exports=function(g,h,c,a){var d=64,f=1.25,b={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return a&&(a.size&&a.size>0&&(d=a.size),a.lineSpacing&&a.lineSpacing>0&&(f=a.lineSpacing),a.styletags&&a.styletags.breaklines&&(b.breaklines=!!a.styletags.breaklines),a.styletags&&a.styletags.bolds&&(b.bolds=!!a.styletags.bolds),a.styletags&&a.styletags.italics&&(b.italics=!!a.styletags.italics),a.styletags&&a.styletags.subscripts&&(b.subscripts=!!a.styletags.subscripts),a.styletags&&a.styletags.superscripts&&(b.superscripts=!!a.styletags.superscripts)),c.font=[a.fontStyle,a.fontVariant,a.fontWeight,d+"px",a.font].filter(function(a){return a}).join(" "),c.textAlign="start",c.textBaseline="alphabetic",c.direction="ltr",l(function(h,i,b,k,C,d){b=b.replace(/\n/g,""),b=!0===d.breaklines?b.replace(/\<br\>/g,"\n"):b.replace(/\<br\>/g," ");var f,a,t,D,E,l="",c=[];for(a=0;a<b.length;++a)c[a]=l;!0===d.bolds&&(c=j("b","b|",b,c)),!0===d.italics&&(c=j("i","i|",b,c)),!0===d.superscripts&&(c=j("sup","+1",b,c)),!0===d.subscripts&&(c=j("sub","-1",b,c));var g=[],u="";for(a=0;a<b.length;++a)null!==c[a]&&(u+=b[a],g.push(c[a]));var v=u.split("\n"),o=v.length,p=Math.round(C*k),F=k,w=2*k,q=0,x=o*p+w;h.height<x&&(h.height=x),i.fillStyle="#000",i.fillRect(0,0,h.width,h.height),i.fillStyle="#fff";var r=0,s="";function y(){if(""!==s){var a=i.measureText(s).width;i.fillText(s,F+t,w+D),t+=a}}function H(){return""+Math.round(E)+"px "}function G(b,c){var a=""+i.font;if(!0===d.subscripts){var j=b.indexOf("-"),k=c.indexOf("-"),e=j> -1?parseInt(b[1+j]):0,f=k> -1?parseInt(c[1+k]):0;e!==f&&(a=a.replace(H(),"?px "),E*=Math.pow(.75,f-e),a=a.replace("?px ",H())),D+=.25*p*(f-e)}if(!0===d.superscripts){var l=b.indexOf("+"),m=c.indexOf("+"),g=l> -1?parseInt(b[1+l]):0,h=m> -1?parseInt(c[1+m]):0;g!==h&&(a=a.replace(H(),"?px "),E*=Math.pow(.75,h-g),a=a.replace("?px ",H())),D-=.25*p*(h-g)}if(!0===d.bolds){var n=b.indexOf("b|")> -1,o=c.indexOf("b|")> -1;!n&&o&&(a=q?a.replace("italic ","italic bold "):"bold "+a),n&&!o&&(a=a.replace("bold ",""))}if(!0===d.italics){var q=b.indexOf("i|")> -1,r=c.indexOf("i|")> -1;!q&&r&&(a="italic "+a),q&&!r&&(a=a.replace("italic ",""))}i.font=a}for(f=0;f<o;++f){var m=v[f]+"\n";for(a=0,t=0,D=f*p,E=k,s="";a<m.length;++a){var n=a+r<g.length?g[a+r]:g[g.length-1];l===n?s+=m[a]:(y(),s=m[a],void 0!==n&&(G(l,n),l=n))}y(),r+=m.length;var z=0|Math.round(t+2*F);q<z&&(q=z)}var A=q,B=w+p*o;return e(i.getImageData(0,0,A,B).data,[B,A,4]).pick(-1,-1,0).transpose(1,0)}(h,c,g,d,f,b),a,d)},b.exports.processPixels=l;var d=a("surface-nets"),e=a("ndarray"),f=a("simplify-planar-graph"),g=a("clean-pslg"),h=a("cdt2d"),i=a("planar-graph-to-polyline");function j(k,f,d,b){for(var h="<"+k+">",l="</"+k+">",i=h.length,j=l.length,o="+"===f[0]||"-"===f[0],c=0,e=-j;c> -1&& -1!==(c=d.indexOf(h,c))&& -1!==(e=d.indexOf(l,c+i))&&!(e<=c);){for(var a=c;a<e+j;++a)if(a<c+i||a>=e)b[a]=null,d=d.substr(0,a)+" "+d.substr(a+1);else if(null!==b[a]){var g=b[a].indexOf(f[0]);-1===g?b[a]+=f:o&&(b[a]=b[a].substr(0,g+1)+(1+parseInt(b[a][g+1]))+b[a].substr(g+2))}var m=c+i,n=d.substr(m,e-m).indexOf(h);c=-1!==n?n:e+j}return b}function k(v,a,w,x){var q,r,c,s=(q=v,r=x,c=d(q,128),r?f(c.cells,c.positions,.25):{edges:c.cells,positions:c.positions}),b=function(f,a,j){for(var k=a.textAlign||"start",l=a.textBaseline||"alphabetic",b=[1073741824,1073741824],c=[0,0],n=f.length,g=0;g<n;++g)for(var m=f[g],d=0;d<2;++d)b[d]=0|Math.min(b[d],m[d]),c[d]=0|Math.max(c[d],m[d]);var h=0;switch(k){case"center":h=-0.5*(b[0]+c[0]);break;case"right":case"end":h=-c[0];break;case"left":case"start":h=-b[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+k+"'")}var e=0;switch(l){case"hanging":case"top":e=-b[1];break;case"middle":e=-0.5*(b[1]+c[1]);break;case"alphabetic":case"ideographic":e=-3*j;break;case"bottom":e=-c[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+l+"'")}var i=1/j;return"lineHeight"in a?i*=+a.lineHeight:"width"in a?i=a.width/(c[0]-b[0]):"height"in a&&(i=a.height/(c[1]-b[1])),f.map(function(a){return[i*(a[0]+h),i*(a[1]+e)]})}(s.positions,a,w),e=s.edges,y="ccw"===a.orientation;if(g(b,e),a.polygons||a.polygon||a.polyline){for(var m=i(e,b),t=new Array(m.length),j=0;j<m.length;++j){for(var n=m[j],u=new Array(n.length),k=0;k<n.length;++k){for(var o=n[k],p=new Array(o.length),l=0;l<o.length;++l)p[l]=b[o[l]].slice();y&&p.reverse(),u[k]=p}t[j]=u}return t}return a.triangles||a.triangulate||a.triangle?{cells:h(b,e,{delaunay:!1,exterior:!1,interior:!0}),positions:b}:{edges:e,positions:b}}function l(b,a,c){try{return k(b,a,c,!0)}catch(d){}try{return k(b,a,c,!1)}catch(e){}return a.polygons||a.polyline||a.polygon?[]:a.triangles||a.triangulate||a.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(a,b,c){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=t);var i,j,k,l=!1;if("function"==typeof WeakMap){var c=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var d=new c,e=Object.freeze({});if(d.set(e,1),1!==d.get(e))l=!0;else{b.exports=WeakMap;return}}}Object.prototype.hasOwnProperty;var o=Object.getOwnPropertyNames,a=Object.defineProperty,p=Object.isExtensible,f="weakmap:",m=f+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var n=new ArrayBuffer(25),g=new Uint8Array(n);crypto.getRandomValues(g),m=f+"rand:"+Array.prototype.map.call(g,function(a){return(a%36).toString(36)}).join("")+"___"}if(a(Object,"getOwnPropertyNames",{value:function(a){return o(a).filter(u)}}),"getPropertyNames"in Object){var q=Object.getPropertyNames;a(Object,"getPropertyNames",{value:function(a){return q(a).filter(u)}})}i=Object.freeze,a(Object,"freeze",{value:function(a){return v(a),i(a)}}),j=Object.seal,a(Object,"seal",{value:function(a){return v(a),j(a)}}),k=Object.preventExtensions,a(Object,"preventExtensions",{value:function(a){return v(a),k(a)}});var r=!1,s=0,h=function(){this instanceof h||x();var a=[],b=[],c=s++;return Object.create(h.prototype,{get___:{value:w(function(e,f){var g,d=v(e);return d?c in d?d[c]:f:(g=a.indexOf(e))>=0?b[g]:f})},has___:{value:w(function(b){var d=v(b);return d?c in d:a.indexOf(b)>=0})},set___:{value:w(function(e,f){var d,g=v(e);return g?g[c]=f:(d=a.indexOf(e))>=0?b[d]=f:(b[d=a.length]=f,a[d]=e),this})},delete___:{value:w(function(g){var e,d,f=v(g);return f?c in f&&delete f[c]:!((e=a.indexOf(g))<0)&&(d=a.length-1,a[e]=void 0,b[e]=b[d],a[e]=a[d],a.length=d,b.length=d,!0)})}})};h.prototype=Object.create(Object.prototype,{get:{value:function(a,b){return this.get___(a,b)},writable:!0,configurable:!0},has:{value:function(a){return this.has___(a)},writable:!0,configurable:!0},set:{value:function(a,b){return this.set___(a,b)},writable:!0,configurable:!0},"delete":{value:function(a){return this.delete___(a)},writable:!0,configurable:!0}}),"function"==typeof c?function(){function a(){this instanceof h||x();var a,b=new c,d=void 0,e=!1;return a=l?function(a,c){return b.set(a,c),b.has(a)||(d||(d=new h),d.set(a,c)),this}:function(a,c){if(e)try{b.set(a,c)}catch(f){d||(d=new h),d.set___(a,c)}else b.set(a,c);return this},Object.create(h.prototype,{get___:{value:w(function(a,c){return d?b.has(a)?b.get(a):d.get___(a,c):b.get(a,c)})},has___:{value:w(function(a){return b.has(a)|| !!d&&d.has___(a)})},set___:{value:w(a)},delete___:{value:w(function(a){var c=!!b.delete(a);return d?d.delete___(a)||c:c})},permitHostObjects___:{value:w(function(a){if(a===t)e=!0;else throw new Error("bogus call to permitHostObjects___")})}})}l&&"undefined"!=typeof Proxy&&(Proxy=void 0),a.prototype=h.prototype,b.exports=a,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),b.exports=h)}function t(a){a.permitHostObjects___&&a.permitHostObjects___(t)}function u(a){return!(a.substr(0,f.length)==f&&"___"===a.substr(a.length-3))}function v(b){if(b!==Object(b))throw new TypeError("Not an object: "+b);var c=b[m];if(c&&c.key===b)return c;if(p(b)){c={key:b};try{return a(b,m,{value:c,writable:!1,enumerable:!1,configurable:!1}),c}catch(d){return}}}function w(a){return a.prototype=null,Object.freeze(a)}function x(){r||"undefined"==typeof console||(r=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],314:[function(a,b,c){var d=a("./hidden-store.js");b.exports=function(){var a={};return function(b){if(("object"!=typeof b||null===b)&&"function"!=typeof b)throw new Error("Weakmap-shim: Key must be object");var c=b.valueOf(a);return c&&c.identity===a?c:d(b,a)}}},{"./hidden-store.js":315}],315:[function(b,a,c){a.exports=function(a,b){var c={identity:b},d=a.valueOf;return Object.defineProperty(a,"valueOf",{value:function(a){return a!==b?d.apply(this,arguments):c},writable:!0}),c}},{}],316:[function(a,b,c){var d=a("./create-store.js");b.exports=function(){var a=d();return{get:function(c,d){var b=a(c);return b.hasOwnProperty("value")?b.value:d},set:function(b,c){return a(b).value=c,this},has:function(b){return"value"in a(b)},"delete":function(b){return delete a(b).value}}}},{"./create-store.js":314}],317:[function(e,b,f){"use strict";var a,c,d;b.exports=(a={funcName:"zeroCrossings"},c=(function(){return function(i,e,j,a,k,f){var l=i[0],g=j[0],h=[0],m=g;a|=0;var b=0,n=g;for(b=0;b<l;++b){var c=e[a]-f,d=e[a+m]-f;c>=0!=d>=0&&k.push(h[0]+.5+.5*(c+d)/(c-d)),a+=n,++h[0]}}}).bind(void 0,a),d={},function(a,h,i){var e=a.dtype,f=a.order,g=[e,f.join()].join(),b=d[g];return b||(d[g]=b=c([e,f])),b(a.shape.slice(0),a.data,a.stride,0|a.offset,h,i)})},{}],318:[function(a,b,c){"use strict";b.exports=function(b,a){var c=[];return a=+a||0,d(b.hi(b.shape[0]-1),c,a),c};var d=a("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,void 0!==c.g?c.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[27])(27)})}}])